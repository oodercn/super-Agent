// 引入CodeBuddy图标库

    if (!window.CONF) window.CONF = {};


   // 替换整个 ood.builtinFontIcon 对象 - 升级为ri格式
ood.builtinFontIcon = {
    // 文件相关图标
    'ood-file': 'ri-file-line',
    'ood-folder-open': 'ri-folder-open-line',
    'ood-folder': 'ri-folder-line',
    // 操作图标
    'ood-trash-can': 'ri-delete-bin-line',
    'ood-star': 'ri-star-line',
    'ood-bold': 'ri-bold',
    'ood-italic': 'ri-italic',
    'ood-underline': 'ri-underline',
    'ood-strikethrough': 'ri-strikethrough',
    'ood-link': 'ri-link',
    'ood-unlink': 'ri-link-unlink',
    'ood-search': 'ri-search-line',
    'ood-print': 'ri-printer-line',
    'ood-upload': 'ri-upload-line',
    'ood-delete': 'ri-delete-bin-line',
    'ood-edit': 'ri-edit-line',
    'ood-save': 'ri-save-line',
    'ood-file-plus': 'ri-file-add-line',
    'ood-folder-plus': 'ri-folder-add-line',

    // 方向图标
    'ood-left-long': 'ri-arrow-left-line',
    'ood-right-long': 'ri-arrow-right-line',
    'ood-up-long': 'ri-arrow-up-line',
    'ood-down-long': 'ri-arrow-down-line',
    'ood-arrow-left': 'ri-arrow-left-line',
    'ood-arrow-right': 'ri-arrow-right-line',
    'ood-arrow-up': 'ri-arrow-up-line',
    'ood-arrow-down': 'ri-arrow-down-line',

    // 三角形图标
    'ood-chevron-down': 'ri-arrow-down-s-line',
    'ood-chevron-left': 'ri-arrow-left-s-line',
    'ood-chevron-right': 'ri-arrow-right-s-line',
    'ood-chevron-up': 'ri-arrow-up-s-line',

    // 状态图标
    'ood-circle-exclamation': 'ri-error-warning-line',
    'ood-circle-info': 'ri-information-line',
    'ood-question-circle': 'ri-question-line',
    'ood-spinner': 'ri-loader-2-fill',

    // 其他常用图标
    'ood-bars': 'ri-menu-line',
    'ood-check': 'ri-check-line',
    'ood-plus': 'ri-add-line',
    'ood-minus': 'ri-subtract-line',
    'ood-sort': 'ri-sort-asc',
    'ood-rotate': 'ri-refresh-line',
    'ood-undo': 'ri-refresh-line',
    'ood-repeat': 'ri-refresh-line',
    'ood-search-minus': 'ri-search-2-line',
    'ood-search-plus': 'ri-search-2-line',

    // 数据和功能图标
    'ood-database': 'ri-database-line',
    'ood-bug': 'ri-bug-line',
    'ood-palette': 'ri-palette-line',
    'ood-file-lines': 'ri-file-text-line',
    'ood-house': 'ri-home-line',
    'ood-columns': 'ri-layout-grid-line',
    'ood-brain': 'ri-brain-line',
    'ood-magnifying-glass': 'ri-search-line',
    'ood-chart-simple': 'ri-bar-chart-2-line',
    'ood-gavel': 'ri-hammer-line',
    'ood-server': 'ri-server-line',
    'ood-comment-sms': 'ri-chat-1-line',
    'ood-table': 'ri-table-line',
    'ood-eye': 'ri-eye-line',
    'ood-sitemap': 'ri-network-line',
    'ood-play': 'ri-play-line',
    'ood-times': 'ri-close-line',
    'ood-code': 'ri-code-box-line',
    'ood-copy': 'ri-file-copy-line',
    'ood-cut': 'ri-scissors-line',
    'ood-calculator': 'ri-calculator-line',
    'ood-paste': 'ri-file-copy-line',
    'ood-image': 'ri-image-line',
    'ood-mouse-pointer': 'ri-mouse-line',
    'ood-cog': 'ri-settings-2-line',
    'ood-tools': 'ri-tools-line',

    // 组件相关图标
    'ood-square': 'ri-square-line',
    'ood-check-square': 'ri-check-square-line',
    'ood-calendar': 'ri-calendar-line',
    'ood-list': 'ri-list-unordered',
    'ood-dot-circle': 'ri-radio-button-line',

    // 用户相关图标
    'ood-user': 'ri-user-line',
    'ood-user-circle': 'ri-user-line',
    'ood-user-group': 'ri-group-line',
    'ood-user-plus': 'ri-user-add-line',
    'ood-user-minus': 'ri-user-remove-line',
    'ood-user-edit': 'ri-user-settings-line',
    'ood-user-shield': 'ri-shield-user-line',
    'ood-user-shared': 'ri-user-shared-line',
    'ood-users': 'ri-group-line',

    // 品牌图标 - 保留Fab图标
    'ood-html5': 'fab ood-html5',
    'ood-css3': 'fab ood-css3',
    'ood-js': 'fab ood-js',
    'ood-file-code': 'ri-file-code-line',
    'ood-file-json': 'ri-file-code-line',
    'ood-film': 'ri-video-line',
    'ood-music': 'ri-music-line',
    'ood-video': 'ri-video-line',
    'ood-mobile-screen': 'ri-smartphone-line',
    'ood-question-circle': 'ri-question-line-line',
    'ood-rotate-left': 'ri-refresh-line',
    'ood-rotate-right': 'ri-refresh-line',
    'ood-floppy-disk': 'ri-save-line',
    'ood-file-circle-plus': 'ri-file-add-line',
    'ood-arrow-right': 'ri-arrow-right-line',
    'ood-align-left': 'ri-align-left',
    'ood-pen-to-square': 'ri-edit-box-line',
    'ood-window-minimize': 'ri-window-minimize-line',
    'ood-window-maximize': 'ri-fullscreen-line',
    'ood-xmark': 'ri-close-line',
    'ood-window-restore': 'ri-window-2-line',
    'ood-arrow-up-from-bracket': 'ri-upload-line',
    'ood-circle': 'ri-circle-line',
    'ood-circle-dot': 'ri-radio-button-line',
    'ood-arrow-up-right-from-square': 'ri-external-link-line',
    'ood-toggle-off': 'ri-toggle-line',
    'ood-toggle-on': 'ri-toggle-line',
    'ood-calendar-clock': 'ri-calendar-event-line',
    'ood-location-dot': 'ri-map-pin-line',
    'ood-clock': 'ri-time-line',
    'ood-terminal': 'ri-terminal-line',
    'ood-indent': 'ri-indent-increase',
    'ood-outdent': 'ri-indent-decrease',
    'ood-backward-fast': 'ri-skip-back-line',
    'ood-forward-fast': 'ri-skip-forward-line',
    'ood-backward': 'ri-skip-back-line',
    'ood-forward': 'ri-skip-forward-line',
    'ood-sort-down': 'ri-sort-desc',
    'ood-triangle-down': 'ri-arrow-down-s-line',
    'ood-triangle-up': 'ri-arrow-up-s-line',
    'ood-triangle-left': 'ri-arrow-left-s-line',
    'ood-triangle-right': 'ri-arrow-right-s-line',
    'ood-arrows-move': 'ri-drag-move-line',
    'ood-hand': 'ri-hand-coin-line'

};
ood.merge(window.CONF, {
    enable_codeEdtor: 1,
    enable_openAPI: 1,
    enable_preview: 1,
    enable_editSandboxTheme: 1,
    enable_fontAwesome: 1,

    productName: "JDSEasy Front-End Builder",
    canvas_svg: false,
    DefaultXUIClassCode: "ood.Class('App','ood.Module',{\n    Instance:{\n    }\n});",

//        ignoreAnnouncement:true,
    version: '0.9',
    versionTag: 'Release',
    dftLang: 'cn',
    serviceType: "remote",
    
    // 组件分类配置 - 解决硬编码问题
    componentCategories: {
        // 媒体组件配置
        mediaComponents: [
            'ood.UI.Image',
            'ood.UI.Flash', 
            'ood.UI.Audio',
            'ood.UI.Video',
            'ood.svg.image'
        ],
        
        // Canvas组件配置
        canvasComponents: {
            svg: 'ood.UI.SVGPaper',
            normal: 'ood.UI.Pane'
        },
        
        // 支持特殊配置的组件
        configurableComponents: [
            'ood.UI.Image',
            'ood.UI.Flash', 
            'ood.UI.Audio',
            'ood.UI.Video'
        ],
        
        // 移动端组件
        mobileComponents: [
            'ood.Mobile.Button',
            'ood.Mobile.Input',
            'ood.Mobile.List',
            'ood.Mobile.Switch',
            'ood.Mobile.Panel',
            'ood.Mobile.Layout',
            'ood.Mobile.Grid',
            'ood.Mobile.NavBar',
            'ood.Mobile.TabBar',
            'ood.Mobile.Drawer',
            'ood.Mobile.Toast',
            'ood.Mobile.Modal',
            'ood.Mobile.ActionSheet',
            'ood.Mobile.Form',
            'ood.Mobile.Picker',
            'ood.Mobile.Card',
            'ood.Mobile.Avatar',
            'ood.Mobile.Badge'
        ],
        
        // 移动端媒体组件
        mobileMediaComponents: [
            'ood.Mobile.Image',
            'ood.Mobile.Video',
            'ood.Mobile.Audio'
        ]
    },
    openProjectService: ood.ini.appPath + 'openProject',
    remoteService: ood.ini.appPath + 'request',
    saveFile: ood.ini.appPath + 'saveContent',
    saveAsJson: ood.ini.appPath + 'saveAsJson',
    getFileContent: ood.ini.appPath + 'getFileContent',
    getProjectListService: '/admin/getProjectList',
    getProjectVersionListService: '/admin/getProjectVersionList',
    getProjectTemp: '/admin/getTempProjectList',
    getProjectTempType: '/admin/getTempType',

    openActionsService: ood.ini.appPath + 'openActions',
    openFolderService: ood.ini.appPath + 'openFolder',
    importFileService: ood.ini.appPath + 'importFile',
    //  getProjectAll:ood.ini.appPath + 'getProjectAll',
    /*************** tools API******************************/

    getLocalServiceToolBoxService: ood.ini.appPath + "api/getLocalServiceToolBox",
    getPageServiceToolBoxService: ood.ini.appPath + "api/getPageServiceToolBox",

    getProjectServiceToolBoxService: ood.ini.appPath + "api/getProjectServiceToolBox",


    getAllServerToolBoxService: ood.ini.appPath + "api/getAllServerToolBox",
    getRemoteServiceByKeyService: ood.ini.appPath + "api/getRemoteServiceByKey",
    getAPIService: ood.ini.appPath + "api/getAPIService",

    /*************** tools API******************************/

    getAllComponentsByPath: ood.ini.appPath + "plugs/getAllComponentsByPath",
    GetAllPackages: ood.ini.appPath + "plugs/getAllPackages",
    getAllProjectTreeSrvice: ood.ini.appPath + "plugs/getAllProjectTree",

    getAllClasses: ood.ini.appPath + "plugs/getAllClasses",

    getAllComponentsByClass: ood.ini.appPath + "plugs/getAllComponentsByClass",

    GetTableComponentsService: ood.ini.appPath + 'plugs/GetTableComponents',
    GetAllProjectTreeService: ood.ini.appPath + 'plugs/getAllProjectTree',
    GetExtComProjectTreeService: ood.ini.appPath + 'plugs/getExtComProjectTree',
    GetExtModuleProjectTreeService: ood.ini.appPath + 'plugs/getExtModuleProjectTree',


    getSelFontServcie: ood.ini.appPath + "plugs/getSelFont",
    getSelImgServcie: ood.ini.appPath + "plugs/getSelImg",

    getInnerImgServcie: ood.ini.appPath + "plugs/getInnerImg",
    getTableTreesService: ood.ini.appPath + 'plugs/fdt/GetTableTrees',
    GetAllTableByNameServcie: ood.ini.appPath + "plugs/fdt/GetAllTableByName",
    getSelImgByPathServcie: ood.ini.appPath + "plugs/getSelImgByPath",
    /*************** tools API******************************/


    /*************** DataBase API******************************/
    getDbTreesService: ood.ini.appPath + 'fdt/GetDbTrees',
    getColTreeService: ood.ini.appPath + 'fdt/GetColTree',
    AddColServcie: ood.ini.appPath + "fdt/AddCol",
    CreateViewServcie: ood.ini.appPath + "fdt/CreateView",
    CreateModuleServcie: ood.ini.appPath + "fdt/CreateModule",
    GetFolderTreeServcie: ood.ini.appPath + "fdt/GetFolderTree",

    GetAllCollByTableNameServcie: ood.ini.appPath + "fdt/GetAllCollByTableName",

    DropTableServcie: ood.ini.appPath + "fdt/DropTable",
    AddTableServcie: ood.ini.appPath + "fdt/AddTable",
    /*************** DataBase API******************************/

    getAllFileVersionService: ood.ini.appPath + "getAllFileVersion",
    delFileVersionService: ood.ini.appPath + "delFileVersion",
    getFileVersionService: ood.ini.appPath + "getFileVersionService",

    addFolder: ood.ini.appPath + 'addFolder',
    getAllClass: ood.ini.appPath + 'plugs/getAllClass',
    //getProjectConfigService: ood.ini.appPath + 'getProjectConfig',
    getProjectConfigService: 'oodconf.jsx',

    addTextFile: ood.ini.appPath + 'addTextFile',
    addClass: ood.ini.appPath + 'addClass',
    addFromTpl: ood.ini.appPath + 'addFromTpl',
    addModule: ood.ini.appPath + 'addModule',
    addFile: ood.ini.appPath + 'addFile',
    delFile: ood.ini.appPath + 'delFile',
    upload: ood.ini.appPath + 'uploadFiles',
    copy: ood.ini.appPath + 'copy',
    copyClass: ood.ini.appPath + 'copyClass',
    copyFolder: ood.ini.appPath + 'copyFolder',
    copyFile: ood.ini.appPath + 'copyFolder',
    paste: ood.ini.appPath + 'paste',
    getTemp: ood.ini.appPath + 'paste',
    reName: ood.ini.appPath + 'reName',

    newProject: '/admin/createProject',
    uploadPath: "/plugins/fileupload/uploadgrid.html",
    openOtherFolderService: 'openFolder',
    testPath: ood.ini.appPath + 'debug.jsp',

    clientMode: 'project',

    getClientMode: function () {
        return 'project'
    },//ONF.clientMode},

    nonASCII: new RegExp("[\\u00DF\\u0590-\\u05F4\\u0600-\\u06FF\\u3040-\\u309F\\u30A0-\\u30FF\\u3400-\\u4DB5\\u4E00-\\u9FCC\\uAC00-\\uD7AF]"),

    fileNames: /^[^\\\/:*?"<>|\r\n]+$/im,
    fileNames2: /^[a-z][\w. ]*[0-9a-z]$/im,
    sizeFormat: /^(([1-9]\d*\.\d+)|([1-9]\d*)|(\.\d\d*))\s*(px|em)?$/,
    //defaultWS:'XUIWorkSpace',
    //wsPath:'XUIWorkSpace',

    defaultWS: 'form/userspace',
    wsPath: 'form/userspace',

    requestKey: 'RAD',
    requestKey2: 'RAD2',

    ood_page_tpl_tag: "ood_page_tpl",
    ood_project_tpl_tag: "ood_project_tpl",
    ood_module_tpl_tag: "ood_module_tpl",

    localGalleryPath: 'template/gallery',
    localTempalteLibPath: 'template/example/pages/',
    localProjectLibPath: 'template/example/projects/',
    localModlueLibPath: "template/modules",

    localWidgetLibPath: "RAD/widgets",

    myTempalteLibPath: 'template/example/pages/',
    myProjectLibPath: 'template/example/projects/',
    myModuleLibPath: "assets_mine/modules",

// can be csutomized
    onlineGalleryPath: 'http://www.itjds.net/services/assets_online/',
    onlineTempalteLibPath: 'http://www.itjds.net/services/assets_online/ver2/', // for 2 and upper version
    versionCheckingURL: 'http://www.itjds.net/services/latestversion.js',
    systemMessageURL: 'http://www.itjds.net/services/message.js',

    path_website: "http://www.itjds.net",
    path_forum: 'http://www.itjds.net/Forum/',
    path_download: 'http://www.itjds.net/download.html',
    path_licence: 'http://www.itjds.net/license.html',
    path_video: "http://www.itjds.net/videos/index.html",
    path_codesnipurl: "http://www.itjds.net/CodeSnip/Classes/",

    fileExts: /\.(jpg|png|gif|bmp|css|txt|swf|js|json|txt|html|htm|woff2|eot|svg|woff|ttf)$/,
    fileAccept: ".jpg,.png,.gif,.bmp,.css,.txt,.swf,.js,.json,.txt,.html,.htm,.woff2,.eot,.svg,.woff,.ttf",
    picExts: /\.(jpg|png|gif|bmp)$/,
    picAccept: ".jpg,.png,.gif,.bmp",

    img_widgets: ood.getPath('/RAD/img/', 'widgets.png'),

    img_dft: "{ood.ini.img_pic}",
    img_class: "ri-image-line",
    svg_dft: "http://www.itjds.net/RAD/img/svg_demo.svg",
    img_progress: ood.getPath('/RAD/img/', 'progress.gif'),
    
    // 组件类型检测方法 - 解决硬编码问题
    isMediaComponent: function(component) {
        if (!CONF.componentCategories || !CONF.componentCategories.mediaComponents) {
            // 降级处理：使用默认的媒体组件列表
            var defaultMediaComponents = ['ood.UI.Image', 'ood.UI.Flash', 'ood.UI.Audio', 'ood.UI.Video', 'ood.svg.image'];
            var key = typeof component === 'string' ? component : component.key;
            return defaultMediaComponents.indexOf(key) !== -1;
        }
        var key = typeof component === 'string' ? component : component.key;
        return CONF.componentCategories.mediaComponents.indexOf(key) !== -1;
    },
    
    hasSpecialConfig: function(component) {
        if (!CONF.componentCategories || !CONF.componentCategories.configurableComponents) {
            // 降级处理：使用默认的可配置组件列表
            var defaultConfigurableComponents = ['ood.UI.Image', 'ood.UI.Flash', 'ood.UI.Audio', 'ood.UI.Video'];
            var key = typeof component === 'string' ? component : component.key;
            return defaultConfigurableComponents.indexOf(key) !== -1 || 
                   (component.box && component.box.SINGLE_NODE_IMAGE);
        }
        var key = typeof component === 'string' ? component : component.key;
        return CONF.componentCategories.configurableComponents.indexOf(key) !== -1 || 
               (component.box && component.box.SINGLE_NODE_IMAGE);
    },
    
    getCanvasClass: function() {
        var config = CONF.componentCategories && CONF.componentCategories.canvasComponents;
        if (!config) {
            // 降级处理：如果配置不存在，使用默认值
            config = {
                svg: 'ood.UI.SVGPaper',
                normal: 'ood.UI.Pane'
            };
        }
        var className = (CONF.canvas_svg || (window.ARGS && window.ARGS.svg)) ? 
                       config.svg : config.normal;
        try {
            return ood.getClass(className);
        } catch (e) {
            // 如果动态获取失败，回退到传统方式
            console.warn('Failed to get class dynamically, falling back to traditional method:', e);
            return (CONF.canvas_svg || (window.ARGS && window.ARGS.svg)) ? ood.UI.SVGPaper : ood.UI.Pane;
        }
    },
    
    // 组件配置管理器
    ComponentManager: {
        // 注册组件类型
        registerComponentType: function(typeName, components) {
            if (!CONF.componentCategories[typeName]) {
                CONF.componentCategories[typeName] = [];
            }
            CONF.componentCategories[typeName] = CONF.componentCategories[typeName].concat(components);
        },
        
        // 检查组件是否属于某个类型
        isComponentType: function(component, typeName) {
            var key = typeof component === 'string' ? component : component.key;
            var category = CONF.componentCategories[typeName];
            return category && category.indexOf(key) !== -1;
        },
        
        // 获取组件类型
        getComponentTypes: function(component) {
            var key = typeof component === 'string' ? component : component.key;
            var types = [];
            
            for (var typeName in CONF.componentCategories) {
                if (this.isComponentType(key, typeName)) {
                    types.push(typeName);
                }
            }
            
            return types;
        },
        
        // 动态添加组件到分类
        addToCategory: function(componentKey, category) {
            if (!CONF.componentCategories[category]) {
                CONF.componentCategories[category] = [];
            }
            
            if (CONF.componentCategories[category].indexOf(componentKey) === -1) {
                CONF.componentCategories[category].push(componentKey);
            }
        }
    },

});

ood.merge(window.CONF, {
    localeItems: [{"id": "en", "caption": "$RAD.en"}, {"id": "cn", "caption": "$RAD.cn"}, {
        "id": "tw",
        "caption": "$RAD.tw"
    }, {"id": "ja", "caption": "$RAD.ja"}, {"id": "ru", "caption": "$RAD.ru"}],
    designer_list_class: ['ood-uisyle-mobile', 'ood-cursor-touch', 'ood-uiborder-circle', 'ood-uigradient', 'ood-ui-shadow', 'ood-css-noscroll'],
    designer_list_imageclass: (function () {
        var items = [];
        ood.arr.each(ood.toArr(ood.builtinFontIcon, true), function (i) {
            items.push({id: ood.builtinFontIcon[i], imageClass: ood.builtinFontIcon[i]})
        });
        return items;
    })(),
    designer_list_imageclass2: (function () {
        var items = [];
        ood.arr.each(ood.toArr(ood.builtinFontIcon, true), function (i) {
            items.push({id: i, imageClass: i})
        });
        return items;
    })(),
    designer_data_fontfamily: [
        {
            caption: "<span style='font-family:arial,helvetica,sans-serif'>Arial</span>",
            id: "arial,helvetica,sans-serif"
        },
        {
            caption: "<span style='font-family:arial black,avant garde'>Arial Black</span>",
            id: "arial black,avant garde"
        },
        {
            caption: "<span style='font-family:comic sans ms,cursive'>Comic Sans MS</span>",
            id: "comic sans ms,cursive"
        },
        {
            caption: "<span style='font-family:courier new,courier,monospace'>Courier New</span>",
            id: "courier new,courier,monospace"
        },
        {caption: "<span style='font-family:georgia,serif'>Georgia</span>", id: "georgia,serif"},
        {caption: "<span style='font-family:impact,chicago'>impact</span>", id: "impact,chicago"},
        {
            caption: "<span style='font-family:lucida sans unicode,lucida grande,sans-serif'>Lucida Sans Unicode</span>",
            id: "lucida sans unicode,lucida grande,sans-serif"
        },
        {
            caption: "<span style='font-family:tahoma,geneva,sans-serif'>Tahoma</span>",
            id: "tahoma,geneva,sans-serif"
        },
        {
            caption: "<span style='font-family:times new roman,times,serif'>Times New Roman</span>",
            id: "times new roman,times,serif"
        },
        {
            caption: "<span style='font-family:trebuchet ms,helvetica,sans-serif'>Trebuchet MS</span>",
            id: "trebuchet ms,helvetica,sans-serif"
        },
        {
            caption: "<span style='font-family:verdana,geneva,sans-serif'>Verdana</span>",
            id: "verdana,geneva,sans-serif"
        },
        {caption: "<span style='font-family:wingdings'>WingDings</span>", id: "wingdings"}
    ],
    designer_zoom: ["", "width", "height", "contain", "cover", "width-resize", "height-resize", "contain-resize", "cover-resize", "1", "2", "3", "4", "0.75", "0.5", "0.25"],
    designer_themes: ["", "light", "dark", "moonify", "lightblue", "darkblue"],
    designer_background_position: ["", "top left", "top center", "top right", "center left", "center center", "center right", "bottom left", "bottom center", "bottom right", "0% 0%", "-0px -0px"],
    designer_background_repeat: ["", "repeat", "repeat-x", "repeat-y", "no-repeat"],
    designer_background_attachment: ["", "scroll", "fixed"],
    designer_background_size: ["", "cover", "contain", "100% 100%", "50%", "0px 0px", "0px"],
    designer_background_origin: ["", "padding-box", "border-box", "content-box"],
    designer_background_clip: ["", "border-box", "padding-box", "content-box"],
    designer_data_fontsize: ["", "12px", "14px", "16px", "20px", "28px"],
    designer_data_fontweight: ["", "normal", "bolder", "bold", "lighter", "100", "200", "300", "400", "500", "600", "700", "800", "900"],
    designer_data_fontstyle: ["", "normal", "italic", "oblique"],
    designer_data_textdecoration: ["", "none", "underline", "overline", "line-through", "blink"],
    designer_data_textalign: ["", "left", "right", "center", "justify"],
    designer_data_textanchor: ["", "start", "middle", "end"],
    designer_data_target: ["", "_blank"],
    designer_data_strokelinecap: ["", "butt", "square", "round"],
    designer_data_strokelinejoin: ["", "bevel", "round", "miter"],
    designer_data_strokedasharray: ["", "-", ".", "-.", "-..", ". ", "- ", "--", "- .", "--.", "--.."],
    designer_data_cursor: ["", "default", "text", "pointer", "move", "crosshair", "wait", "help", "e-resize", "ne-resize", "nw-resize", "n-resize", "se-resize", "sw-resize", "s-resize", "w-resize"],
    designer_data_overflow: ['', 'visible', 'hidden', 'scroll', 'auto', 'overflow-x:hidden;overflow-y:auto', 'overflow-x:auto;overflow-y:hidden']
});
var tagVar = {
        id: 'tagVar',
        type: "button",
        cellRenderer: function () {
            return ood.adjustRes("[ $RAD.designer.conf.Object ]")
        },
        event: function (profile, cell, pro) {
            var ns = profile.host,
                node = profile.getSubNode('CELL', cell._serialId),
                text = cell.obj || {},
                _cb = function (obj) {
                    cell.obj = typeof(obj) == 'string' ? ood.unserialize(obj) : obj;
                    cell.needCollect = 1;
                    ns._dirty = 1;
                    node.focus();
                };

            if (window.SPA && false === SPA.fe("beforeObjectEditorPop", [
                "jsonEditor", "tagVar", text, _cb,
                "conf", ood.stringify(text), node.get(0), profile.boxing(), pro && pro.boxing()])) return;

            ood.ModuleFactory.getCom('jsonEditor', function () {
                this.setProperties({
                    caption: 'tagVar',
                    imageClass: 'ri-braces-line',
                    text: text,
                    onOK: function (obj, txt) {
                        _cb(ood.clone(obj.properties.object));
                    }
                });
                this.show();
            });
        }
    },
    tagCmds = {
        id: 'tagCmds',
        type: "button",
        cellRenderer: function () {
            return ood.adjustRes("[ $RAD.designer.conf.Object ]")
        },
        event: function (profile, cell, editorprf) {
            var ns = profile.host,
                node = profile.getSubNode('CELL', cell._serialId),
                obj = cell.obj || [];
            RAD.Designer.prototype._showMixedEditor(profile._targetProfile, "ood.UI.List", profile._targetPropKey + "." + cell._col.id, "tagCmds", obj, node, function (items) {
                cell.obj = ood.clone(items, true);
                cell.needCollect = 1;
                ns._dirty = 1;
                node.focus();
            }, true);
        }
    }
;

ood.merge(window.CONF, {
    adjustRelativePath: function (path) {
        if (!path) return '';
        var t;
        path = path.replace(/\\/g, "/");

        if (t = window['/']) {
            t = t.replace(/\\/g, "/") + "/";
            if (ood.str.startWith(path, t))
                path = path.replace(t, "{/}");
        }

        if (t = SPA.curProjectPath) {
            t = t.replace(/\\/g, "/") + "/";
            if (ood.str.startWith(path, t))
                path = path.replace(t, "{/}");
        }
        return path;
    },
    getAPIPath: function () {
        return "API/";
    },
    propBinder: false,
    PropBinderBlackList: null,
    PropBinderWhiteList: null,
    widgets_xprops: {
        'ood.Module': ["onReady", "onRender", "onModulePropChange", "onMessage", "onFragmentChanged"],
        'ood.APICaller': ["name", "queryURL", "requestType", "responseType", "queryMethod", "queryOptions", "queryArgs", "responseCallback", "beforeData", "onError", "onData", "proxyInvoker"],
        'ood.MQTT': ["server", "useSSL", "port", "path", "clientId", "userName", "password", "subscribers", "onMsgArrived"],
        'ood.Timer': ['interval', 'autoStart', 'onTime'],
        'ood.AnimBinder': ['type', 'frames'],
        'ood.MessageService': ['msgType', 'asynReceive', 'onMessageReceived'],
        'ood.UI.CSSBox': ['html', 'className', 'customCss', 'sandbox', 'normalStatus', 'hoverStatus', 'activeStatus'],
        'ood.UI.Element': ['html', 'nodeName', 'position', 'className', 'attributes'],
        'ood.UI.Icon': ['imageClass', 'dock', 'iconFontSize', 'iconColor', 'onClick'],
        'ood.UI.Span': ['html', 'position', 'className', 'dock'],
        'ood.UI.Label': ['caption', 'clock', 'fontSize', 'fontWeight', 'fontColor', 'fontFamily', 'imageClass', 'iconFontCode', 'hAlign', 'className', 'dock', 'onClick'],
        'ood.UI.Link': ['caption', 'dock', 'target', 'onClick'],
        'ood.UI.HTMLButton': ['caption', 'fontSize', 'visibility', 'fontWeight', 'fontColor', 'fontFamily', 'position', 'className', 'attributes', 'onClick'],
        'ood.UI.Button': ['type', 'value', 'caption', 'visibility', 'fontSize', 'fontWeight', 'fontColor', 'fontFamily', 'imageClass', 'iconFontCode', 'dirtyMark', 'onClick', 'onChange'],
        'ood.UI.CheckBox': ['value', 'caption', 'readonly', 'disabled', 'imageClass', 'iconFontCode', 'dock', 'dirtyMark', 'onChange'],
        'ood.UI.Input': ['value', 'readonly', 'disabled', 'type', 'valueFormat', 'labelPos', 'labelSize', 'labelCaption', 'dock', 'dirtyMark', 'onChange'],
        'ood.UI.HiddenInput': ['value'],
        'ood.UI.RichEditor': ['value', 'dock', 'readonly', 'disabled', 'dirtyMark', 'onChange'],
        'ood.UI.List': ['items', 'value', 'readonly', 'disabled', 'dock', 'dirtyMark', 'onItemSelected', 'onChange'],
        'ood.UI.ComboInput': ['type', 'imageClass', 'readonly', 'disabled', 'iconFontCode', 'commandBtn', 'value', 'labelSize', 'labelCaption', 'dock', 'dirtyMark', 'items', 'onClick', 'onCommand', 'onChange', 'beforeComboPop', 'beforePopShow'],
        'ood.UI.ProgressBar': ['value', 'captionTpl', 'type', 'fillBG', 'dock', 'dirtyMark', 'onChange'],
        'ood.UI.Slider': ['value', 'dock', 'dirtyMark', 'onChange'],
        'ood.UI.RadioBox': ['items', 'value', 'readonly', 'disabled', 'dock', 'dirtyMark', 'onItemSelected', 'onChange'],
        'ood.UI.DatePicker': ['value', 'dock', 'readonly', 'disabled', 'dirtyMark', 'onChange'],
        'ood.UI.TimePicker': ['value', 'dock', 'dirtyMark', 'onChange'],
        'ood.UI.ColorPicker': ['value', 'dock', 'dirtyMark', 'onChange'],
        'ood.UI.StatusButtons': ['items', 'value', 'onItemSelected'],
        'ood.UI.FoldingList': ['items', 'activeLast', 'onItemSelected'],
        'ood.UI.Gallery': ['items', 'value', 'autoFontColor','iconList', 'dock', 'onItemSelected'],
        'ood.UI.ButtonLayout': ['items', 'value', 'iconList', 'dock', 'onItemSelected'],
        'ood.UI.Opinion': ['items', 'value', 'iconGalleryList', 'dock', 'onItemSelected'],
        'ood.UI.TitleBlock': ['items', 'value', 'iconTitleBlockList', 'dock', 'onItemSelected','onClickMore','onClickTitle'],
        'ood.UI.ContentBlock': ['items', 'value',  'dock', 'onItemSelected','onClickTitle'],

        'ood.UI.PageBar': ['caption', 'value', 'textTpl', 'prevMark', 'nextMark', 'onPageSet'],
        'ood.UI.PopMenu': ['items', 'onMenuSelected', 'onClick'],
        'ood.UI.MenuBar': ['items', 'dock', 'valueSeparator', 'onMenuSelected', 'onMenuBtnClick', 'onClick'],

        'ood.UI.SystemMenu': ['items', 'value', 'dock', 'onItemSelected', 'onChange'],
        'ood.UI.TreeBar': ['items', 'value', 'dock', 'onItemSelected', 'onChange'],

        'ood.UI.ToolBar': ['items', 'dock', 'onClick'],

        'ood.UI.TreeView': ['items', 'value', 'dock', 'onItemSelected', 'onChange'],
        'ood.UI.MTreeView': ['items', 'value', 'dock', 'onItemSelected', 'onChange'],
        'ood.UI.TreeGrid': ['header', 'uidColumn', 'rows', 'value', 'expression', 'dock', 'altRowsBg', 'headerHeight', 'selMode', 'rowNumbered', 'onClickRow', 'onDblclickRow', 'onRowSelected', 'afterRowActive'],
        'ood.UI.MTreeGrid': ['header', 'uidColumn', 'rows', 'value', 'expression', 'dock', 'altRowsBg', 'headerHeight', 'selMode', 'rowNumbered', 'onClickRow', 'onDblclickRow', 'onRowSelected', 'afterRowActive'],

        'ood.UI.Image': ['src', 'items', 'activeItem', 'cursor', 'dock', 'onClick'],
        'ood.UI.Flash': ['src', 'parameters', 'flashvars', 'dock'],
        'ood.UI.FormLayout': ['floatHandler', 'dock', 'solidGridlines', 'stretchH', 'stretchHeight', 'layoutData'],
        'ood.UI.MFormLayout': ['floatHandler', 'dock', 'solidGridlines', 'stretchH', 'stretchHeight', 'layoutData'],
        'ood.UI.Audio': ['src', 'onMediaEvent'],


        'ood.UI.FileUpload': ['params', 'prepareFormData', 'dock', 'uploadUrl', 'uploadfail', 'uploadcomplete'],
        'ood.UI.Video': ['src', 'onMediaEvent'],
        'ood.UI.ECharts': ['chartOption', 'dataset', 'chartRenderer', 'expression', 'chartTheme', 'onMouseEvent', 'onChartEvent'],
        'ood.UI.FusionChartsXT': ['chartType', 'JSONData', 'expression', 'configure', 'onDataClick', 'onLabelClick', 'onAnnotationClick'],
// container
        'ood.UI.Div': ['html', 'dropKeys', 'conLayoutColumns', 'dock', 'overflow', 'dataBinder', 'sandboxTheme'],
        'ood.UI.Block': ['html', 'dropKeys', 'borderType', 'background', 'conLayoutColumns', 'dock', 'overflow', 'dataBinder', 'sandboxTheme'],
        'ood.UI.Group': ['caption', 'html', 'dropKeys', 'conLayoutColumns', 'dock', 'overflow', 'dataBinder', 'sandboxTheme', 'beforeExpand', 'afterFold', 'onIniPanelView'],
        'ood.UI.Panel': ['caption', 'html', 'imageClass', 'dropKeys', 'conLayoutColumns', 'dock', 'overflow', 'dataBinder', 'sandboxTheme', 'beforeExpand', 'afterFold', 'onIniPanelView'],
        'ood.UI.Tabs': ['items', 'value', 'conLayoutColumns', 'dock', 'overflow', 'dataBinder', 'sandboxTheme', 'onItemSelected', 'onIniPanelView'],
        'ood.UI.MTabs': ['items', 'value', 'conLayoutColumns', 'dock', 'overflow', 'dataBinder', 'sandboxTheme', 'onItemSelected', 'onIniPanelView'],
        'ood.UI.Stacks': ['items', 'value', 'conLayoutColumns', 'dock', 'overflow', 'dataBinder', 'sandboxTheme', 'onItemSelected', 'onIniPanelView'],
        'ood.UI.ButtonViews': ['items', 'value', 'conLayoutColumns', 'dock', 'overflow', 'dataBinder', 'sandboxTheme', 'barLocation', 'barHAlign', 'barVAlign', 'barSize', 'sideBarStatus', 'onItemSelected', 'onIniPanelView'],
        'ood.UI.FoldingTabs': ['items', 'value', 'conLayoutColumns', 'dock', 'overflow', 'dataBinder', 'sandboxTheme', 'onItemSelected', 'onIniPanelView'],
        'ood.UI.Layout': ['type', 'items', 'conLayoutColumns', 'dock', 'overflow', 'dataBinder', 'sandboxTheme', 'onGetContent'],

        'ood.UI.Dialog': ['caption', 'modal', 'minBtn', 'imageClass', 'maxBtn', 'dock', 'html', 'overflow', 'sandboxTheme', 'beforeClose'],
        'ood.UI.SVGPaper': ['conLayoutColumns', 'dock', 'dropKeys', 'overflow', 'dataBinder', 'sandboxTheme'],
//svg
        'ood.svg.circle': ['attr', 'animDraw', 'offsetFlow', 'onClick'],
        'ood.svg.ellipse': ['attr', 'animDraw', 'offsetFlow', 'onClick'],
        'ood.svg.rect': ['attr', 'animDraw', 'offsetFlow', 'onClick'],
        'ood.svg.image': ['attr', 'onClick'],
        'ood.svg.text': ['attr', 'onClick'],
        'ood.svg.path': ['attr', 'animDraw', 'offsetFlow', 'onClick'],
        'ood.svg.rectComb': ['attr', 'animDraw', 'offsetFlow', 'hAlign', 'vAlign', 'onClick'],
        'ood.svg.circleComb': ['attr', 'animDraw', 'offsetFlow', 'hAlign', 'vAlign', 'onClick'],
        'ood.svg.ellipseComb': ['attr', 'animDraw', 'offsetFlow', 'hAlign', 'vAlign', 'onClick'],
        'ood.svg.pathComb': ['attr', 'animDraw', 'offsetFlow', 'hAlign', 'vAlign', 'onClick'],
        'ood.svg.imageComb': ['attr', 'hAlign', 'vAlign', 'onClick'],
        'ood.svg.connector': ['attr', 'animDraw', 'offsetFlow', 'hAlign', 'vAlign', 'onClick'],

        // ====== 移动端组件 DataModule 属性注册 ======
        // 基础组件
        'ood.Mobile.Button': ['text', 'type', 'size', 'disabled', 'loading', 'theme', 'responsive', 'accessibility', 'onClick'],
        'ood.Mobile.Input': ['value', 'type', 'placeholder', 'maxLength', 'disabled', 'readonly', 'clearable', 'showPassword', 'autoFocus', 'theme', 'responsive', 'accessibility', 'validation', 'errorMessage', 'onChange', 'onFocus', 'onBlur'],
        'ood.Mobile.List': ['data', 'pullRefresh', 'infiniteScroll', 'selectable', 'theme', 'responsive', 'accessibility', 'onItemClick'],
        'ood.Mobile.Switch': ['value', 'disabled', 'size', 'theme', 'responsive', 'accessibility', 'onChange'],
        
        // 布局组件
        'ood.Mobile.Panel': ['title', 'collapsible', 'collapsed', 'theme', 'responsive', 'accessibility'],
        'ood.Mobile.Layout': ['direction', 'wrap', 'justify', 'align', 'gap', 'theme', 'responsive', 'accessibility'],
        'ood.Mobile.Grid': ['columns', 'gap', 'theme', 'responsive', 'accessibility'],
        
        // 导航组件
        'ood.Mobile.NavBar': ['title', 'showBack', 'backText', 'rightText', 'fixed', 'theme', 'responsive', 'accessibility', 'onBack', 'onRightClick'],
        'ood.Mobile.TabBar': ['items', 'activeTab', 'position', 'theme', 'responsive', 'accessibility', 'onTabChange'],
        'ood.Mobile.Drawer': ['visible', 'placement', 'width', 'height', 'mask', 'maskClosable', 'theme', 'responsive', 'accessibility', 'onClose'],
        
        // 反馈组件
        'ood.Mobile.Toast': ['message', 'type', 'duration', 'position', 'theme', 'responsive', 'accessibility'],
        'ood.Mobile.Modal': ['visible', 'title', 'content', 'showCancel', 'cancelText', 'confirmText', 'mask', 'maskClosable', 'theme', 'responsive', 'accessibility', 'onCancel', 'onConfirm'],
        'ood.Mobile.ActionSheet': ['visible', 'actions', 'cancelText', 'title', 'theme', 'responsive', 'accessibility', 'onSelect', 'onCancel'],
        
        // 表单组件
        'ood.Mobile.Form': ['fields', 'layout', 'labelPosition', 'theme', 'responsive', 'accessibility', 'onSubmit', 'onReset'],
        'ood.Mobile.Picker': ['visible', 'options', 'value', 'placeholder', 'title', 'multiple', 'searchable', 'clearable', 'maxSelected', 'theme', 'responsive', 'accessibility', 'onChange', 'onConfirm', 'onCancel'],
        
        // 展示组件
        'ood.Mobile.Card': ['title', 'content', 'extra', 'bordered', 'shadow', 'theme', 'responsive', 'accessibility', 'onClick'],
        'ood.Mobile.Avatar': ['src', 'alt', 'size', 'shape', 'fallback', 'theme', 'responsive', 'accessibility', 'onClick'],
        'ood.Mobile.Badge': ['count', 'maxCount', 'showZero', 'dot', 'color', 'theme', 'responsive', 'accessibility']
    },
    widgets_prop_cat: [
        {
            id: "Data & Form",
            items: ['value', 'attributes', 'readonly', 'disabled', 'tag', 'tagVar', 'formMethod', 'formTarget', 'formAction', 'formEnctype', 'formDataPath']
        },
        {
            id: "Visibility, Size and Dimensions",
            items: ['visibility', 'position', 'zIndex', 'width', 'height', 'align', 'hAlign', 'vAlign']
        },

        {
            id: 'Caption & Tips',
            items: ['caption', 'fontSize', 'fontWeight', 'fontColor', 'fontFamily', 'imageClass', 'labelCaption', 'labelHAlign']
        },

        {
            id: "Container",
            items: ['sandboxTheme', 'overflow', 'panelBgClr', 'panelBgImg', 'iframeAutoLoad']
        },
        {
            id: "Items",
            items: ['listKey', 'items', 'header', 'rows', 'grpCols', 'rawData', 'tagCmds', 'tagCmdsAlign']
        },
        {
            id: "Other Prop",
            items: ['className', 'selectable', 'defaultFocus']
        },
        // ====== 移动端组件属性分类 ======
        {
            id: "Mobile Basic",
            items: ['text', 'type', 'size', 'value', 'placeholder', 'maxLength', 'data']
        },
        {
            id: "Mobile State & Behavior", 
            items: ['disabled', 'readonly', 'loading', 'clearable', 'showPassword', 'autoFocus', 'visible', 'collapsible', 'collapsed']
        },
        {
            id: "Mobile Layout & Style",
            items: ['direction', 'wrap', 'justify', 'align', 'gap', 'columns', 'position', 'placement', 'width', 'height', 'bordered', 'shadow']
        },
        {
            id: "Mobile Navigation",
            items: ['title', 'showBack', 'backText', 'rightText', 'fixed', 'items', 'activeTab']
        },
        {
            id: "Mobile Feedback",
            items: ['message', 'duration', 'content', 'showCancel', 'cancelText', 'confirmText', 'mask', 'maskClosable', 'actions']
        },
        {
            id: "Mobile Display",
            items: ['src', 'alt', 'shape', 'fallback', 'count', 'maxCount', 'showZero', 'dot', 'color', 'extra']
        },
        {
            id: "Mobile Accessibility & Theme",
            items: ['theme', 'responsive', 'accessibility', 'validation', 'errorMessage']
        }
    ],
    widgets_events_cat: [
        {
            id: "Layout",
            items: ['beforeRender', 'onRender']
        },

        {
            id: "Keyboard",
            items: ['beforeKeypress']
        },

        {
            id: "swipe",
            items: [
                'swipe', 'swipeleft', 'swiperight', 'swipeup', 'swipedown'
            ]
        },
        {
            id: "pan",
            items: [
                'pan', 'panstart','panmove','panend','pancancel','panleft','panright','panup','pandown'
            ]
        },
        {
            id: "pinch",
            items: [
                'pinch', 'pinchstart','pinchmove', 'pinchend', 'pinchcancel', 'pinchin', 'pinchout'
            ]
        },
        {
            id: "press",
            items: [
                'press', 'pressup'
            ]
        },
        {
            id: "rotate",
            items: [
                'rotate','rotatestart', 'rotatemove','rotateend', 'rotatecancel',
            ]
        },


        {
            id: "Mouse & Touch",
            items: ['onClick', 'onDblclick', 'onCmd', 'onContextmenu','touchstart','touchmove','touchend','touchcancel',
                'pan', 'panstart','panmove','panend','pancancel','panleft','panright','panup','pandown',
                'pinch', 'pinchstart','pinchmove', 'pinchend', 'pinchcancel', 'pinchin', 'pinchout',
                'press', 'pressup',
                'rotate','rotatestart', 'rotatemove','rotateend', 'rotatecancel',
                'swipe', 'swipeleft', 'swiperight', 'swipeup', 'swipedown'
            ]
            //

        },
        {

            id: 'Editor',
            items: ['onEditorClick', 'onEndEdit']
        },
        {
            id: "Items",
            items: ['onIniPanelView', 'onGetContent', 'beforeFold', 'afterFold', 'beforeExpand', 'afterExpand']
        },
        {
            id: "XUI Module Events",
            items: ['onReady', 'onFragmentChanged', 'onMessage', 'afterIniComponents', 'afterShow']
        },
        {
            id: "Other Events",
            items: ['onBlur', 'onFocus', 'afterPropertyChanged', 'onShow']
        },
        // ====== 移动端组件事件分类 ======
        {
            id: "Mobile Form Events",
            items: ['onChange', 'onFocus', 'onBlur', 'onSubmit', 'onReset']
        },
        {
            id: "Mobile Interaction Events", 
            items: ['onClick', 'onItemClick', 'onTabChange', 'onSelect', 'onConfirm', 'onCancel']
        },
        {
            id: "Mobile Navigation Events",
            items: ['onBack', 'onRightClick', 'onClose']
        }
    ],
    lock_hidden_prop: {
        zIndex: 1,
        tabindex: 1,
        position: 1,
        left: 1,
        top: 1,
        bottom: 1,
        right: 1,
        width: 1,
        height: 1,
        rotate: 1,
        CC: 1,
        CS: 1,
        dock: 1,
        dockMargin: 1,
        dockOrder: 1,
        dockMinW: 1,
        dockMinH: 1,
        dockMaxW: 1,
        dockMaxH: 1,
        dockFloat: 1,
        dockIgnore: 1,
        dockIgnoreFlexFill: 1,
        dockStretch: 1,
        conDockPadding: 1,
        conDockSpacing: 1,
        conDockFlexFill: 1,
        conDockStretch: 1,
        conDockRelative: 1,
        conLayoutColumns: 1,
        visibility: 1,
        display: 1,
        overflow: 1
    },

    widgets_itemsProp: {
        items_conf: {
            id: {type: "input"},
            path: {type: "input"},
            target: {type: "input"},
            childname: {type: "childname"},
            caption: {type: "input"},
            title: {type: "input"},
            text: {type: "textarea"},
            url: {type: "input"},
            height: {type: "number"},
            creatorName: {type: "input"},
            createDateStr: {type: "input"},
            capDisplay: {type: "checkbox"},
            add: {type: "input"},
            comment: {type: "input"},
            type: {type: "listbox", editorListItems: ["", "split", "button", "checkbox", "radiobox"]},
            value: {type: "checkbox"},
            handler: {type: "checkbox"},
            size: {type: "spin", precision: 0, increment: 1, min: 0, max: 10000},
            maxlength: {id: "maxlength", type: "spin", precision: 0, increment: 1, min: 0, max: 10000},
            min: {type: "spin", precision: 0, increment: 1, min: 0, max: 10000},
            max: {type: "spin", precision: 0, increment: 1, min: 0, max: 10000},
            locked: {type: "checkbox"},
            folded: {type: "checkbox"},
            cmd: {type: "checkbox"},
            renderer: {type: "input"},
            imageClass: {
                type: "combobox",
                editorCommandBtn: 'pop',
                editorDropListWidth: '18em',
                editorListItems: CONF.designer_list_imageclass,
                tagVar: {
                    prop: 'imageClass'
                }
            },
            flagClass: {
                type: "combobox",
                editorCommandBtn: 'pop',
                editorDropListWidth: '18em',
                editorListItems: CONF.designer_list_imageclass,
                tagVar: {
                    prop: 'imageClass'
                }
            },
            autoFontColor: {type: 'checkbox'},
            iconFontCode: {type: 'input'},
            fontColor: {type: 'color'},
            iconColor: {type: 'color'},
            itemColor: {type: 'color'},
            iconFontSize: {type: "combobox", editorListItems: CONF.designer_data_fontsize},
            iconStyle: {type: 'input'},
            itemClass: {type: "input"},
            itemStyle: {type: "input"},
            image: {
                type: CONF.getClientMode() == 'singlepage' ? "input" : "popbox",
                event: function (profile, cell, editorprf) {
                    var node = profile.getSubNode('CELL', cell._serialId),
                        _cb = function (path) {
                            editorprf.boxing().setUIValue(CONF.adjustRelativePath(path));
                            node.focus();
                        };
                    var t = profile._targetProfile,
                        k = profile._targetPropKey;
                    if (window.SPA && false === SPA.fe("beforeURISelectorPop", [
                        k + ':item:image', cell.value, _cb,
                        'conf', t && t['ood.absProfile'] ? t.boxing() : t, node.get(0), cell, profile.boxing(), editorprf && editorprf.boxing()
                    ])) return;

                    if (CONF.getClientMode() != 'singlepage') {
                        ood.ModuleFactory.getCom('RAD.ImageSelector', function () {
                            this.setProperties({
                                fromRegion: node.cssRegion(true),
                                onOK: function (obj, path) {
                                    _cb(path);
                                }
                            });
                            this.show();
                        });
                    }
                }
            },
            imagePos: {type: "combobox", editorListItems: CONF.designer_background_repeat},
            imageBgSize: {type: "combobox", editorListItems: CONF.designer_background_size},
            imageRepeat: {type: "combobox", editorListItems: CONF.designer_background_repeat},
            itemMargin: {type: "input"},
            itemWidth: {
                type: "input",
                editorHAlign: 'right',
                cellStyle: "text-align:right",
                editorFormat: CONF.sizeFormat
            },
            itemHeight: {
                type: "input",
                editorHAlign: 'right',
                cellStyle: "text-align:right",
                editorFormat: CONF.sizeFormat
            },
            itemAlign: {type: "listbox", editorListItems: ["", "left", "center", "right"]},
            group: {type: "checkbox"},
            closeBtn: {type: "checkbox"},
            optBtn: {type: "checkbox"},
            popBtn: {type: "checkbox"},
            panelBgClr: {type: "color"},
            panelBgImg: {
                type: CONF.getClientMode() == 'singlepage' ? "input" : "popbox",
                event: function (profile, cell, editorprf) {
                    var node = profile.getSubNode('CELL', cell._serialId),
                        _cb = function (path) {
                            editorprf.boxing().setUIValue(CONF.adjustRelativePath(path));
                            node.focus();
                        };
                    var t = profile._targetProfile,
                        k = profile._targetPropKey;
                    if (window.SPA && false === SPA.fe("beforeURISelectorPop", [
                        k + ':item:panelBgImg', cell.value, _cb,
                        'conf', t && t['ood.absProfile'] ? t.boxing() : t, node.get(0), cell, profile.boxing(), editorprf && editorprf.boxing()
                    ])) return;

                    if (CONF.getClientMode() != 'singlepage') {
                        ood.ModuleFactory.getCom('RAD.ImageSelector', function () {
                            this.setProperties({
                                fromRegion: node.cssRegion(true),
                                onOK: function (obj, path) {
                                    _cb(path);
                                }
                            });
                            this.show();
                        });
                    }
                }
            },
            panelBgImgPos: {type: "combobox", editorListItems: CONF.designer_background_position},
            panelBgImgRepeat: {type: "combobox", editorListItems: CONF.designer_background_repeat},
            panelBgImgAttachment: {type: "combobox", editorListItems: CONF.designer_background_attachment},
            overflow: {type: "combobox", editorListItems: CONF.designer_data_overflow},
            iconFontSize: {type: "combobox", editorListItems: CONF.designer_data_fontsize},
            fontSize: {type: "combobox", editorListItems: CONF.designer_data_fontsize},
            fontWeight: {type: "combobox", editorListItems: CONF.designer_data_fontweight},
            html: {type: "textarea"},
            iframeAutoLoad: {type: "input"},//{url:/*String*/, query:/*String or Oject*/, method/*"get" or "set"*/, enctype:/*String*/},
            ajaxAutoLoad: {type: "input"},//{url:/*String*/, query:/*String or Oject*/,options:/*Obejct*/, refer to ood.Ajax function arguments},
            disabled: {type: "checkbox"},
            readonly: {type: "checkbox"},
            hidden: {type: "checkbox"},
            initFold: {type: "checkbox", dftValue: true},
            showMark: {type: "checkbox"},
            noIcon: {type: "checkbox"},
            tag: {type: "input"},
            tagCmdsAlign: {id: "tagCmdsAlign", type: "combobox", editorListItems: ["left", "right", "floatright"]},
            buttonType: {id: "buttonType", type: "combobox", editorListItems: ["button", "image", "text", "split"]},
            tagVar: tagVar,
            tagCmds: tagCmds,
            
            // ====== 移动端组件属性配置 ======
            // 移动端主题配置
            theme: {
                type: "listbox", 
                editorListItems: ["light", "dark", "light-hc", "dark-hc"],
                caption: "主题模式"
            },
            responsive: {
                type: "checkbox",
                caption: "响应式布局"
            },
            accessibility: {
                type: "checkbox", 
                caption: "可访问性支持"
            },
            
            // 基础属性
            text: {
                type: "input",
                caption: "按钮文本"
            },
            placeholder: {
                type: "input",
                caption: "占位符文本"
            },
            maxLength: {
                type: "spin",
                precision: 0,
                increment: 1,
                min: 0,
                caption: "最大长度"
            },
            clearable: {
                type: "checkbox",
                caption: "显示清除按钮"
            },
            showPassword: {
                type: "checkbox", 
                caption: "显示密码切换"
            },
            autoFocus: {
                type: "checkbox",
                caption: "自动获取焦点"
            },
            
            // 布局属性
            direction: {
                type: "listbox",
                editorListItems: ["horizontal", "vertical"],
                caption: "排列方向"
            },
            wrap: {
                type: "checkbox",
                caption: "允许换行"
            },
            justify: {
                type: "listbox",
                editorListItems: ["start", "end", "center", "space-between", "space-around"],
                caption: "主轴对齐"
            },
            align: {
                type: "listbox", 
                editorListItems: ["start", "end", "center", "stretch"],
                caption: "交叉轴对齐"
            },
            gap: {
                type: "input",
                caption: "间距"
            },
            columns: {
                type: "spin",
                precision: 0,
                increment: 1,
                min: 1,
                caption: "列数"
            },
            
            // 导航属性
            showBack: {
                type: "checkbox",
                caption: "显示返回按钮"
            },
            backText: {
                type: "input",
                caption: "返回按钮文本"
            },
            rightText: {
                type: "input",
                caption: "右侧按钮文本"
            },
            fixed: {
                type: "checkbox",
                caption: "固定定位"
            },
            activeTab: {
                type: "input",
                caption: "当前活跃标签"
            },
            position: {
                type: "listbox",
                editorListItems: ["top", "bottom", "left", "right"],
                caption: "位置"
            },
            placement: {
                type: "listbox",
                editorListItems: ["left", "right", "top", "bottom"],
                caption: "弹出位置"
            },
            
            // 反馈组件属性
            message: {
                type: "input",
                caption: "提示消息"
            },
            duration: {
                type: "spin",
                precision: 0,
                increment: 1000,
                min: 0,
                caption: "显示时间(毫秒)"
            },
            content: {
                type: "textarea",
                caption: "内容"
            },
            showCancel: {
                type: "checkbox",
                caption: "显示取消按钮"
            },
            cancelText: {
                type: "input",
                caption: "取消按钮文本"
            },
            confirmText: {
                type: "input",
                caption: "确认按钮文本"
            },
            mask: {
                type: "checkbox",
                caption: "显示遮罩层"
            },
            maskClosable: {
                type: "checkbox",
                caption: "点击遮罩层关闭"
            },
            
            // 表单属性
            fields: {
                type: "button",
                cellRenderer: function () {
                    return ood.adjustRes("[ $RAD.designer.conf.Object ]")
                },
                caption: "表单字段"
            },
            layout: {
                type: "listbox",
                editorListItems: ["horizontal", "vertical"],
                caption: "表单布局"
            },
            labelPosition: {
                type: "listbox",
                editorListItems: ["left", "top"],
                caption: "标签位置"
            },
            options: {
                type: "button",
                cellRenderer: function () {
                    return ood.adjustRes("[ $RAD.designer.conf.Object ]")
                },
                caption: "选项数据"
            },
            placeholder: {
                type: "input",
                caption: "占位符文本"
            },
            multiple: {
                type: "checkbox",
                caption: "多选模式"
            },
            searchable: {
                type: "checkbox",
                caption: "可搜索"
            },
            clearable: {
                type: "checkbox",
                caption: "可清除"
            },
            maxSelected: {
                type: "spin",
                precision: 0,
                increment: 1,
                min: 0,
                caption: "最大选择数"
            },
            
            // 展示组件属性
            src: {
                type: "input",
                caption: "图片地址"
            },
            alt: {
                type: "input",
                caption: "替代文本"
            },
            shape: {
                type: "listbox",
                editorListItems: ["circle", "square"],
                caption: "头像形状"
            },
            fallback: {
                type: "input",
                caption: "加载失败显示"
            },
            count: {
                type: "spin",
                precision: 0,
                increment: 1,
                min: 0,
                caption: "徽标数量"
            },
            maxCount: {
                type: "spin",
                precision: 0,
                increment: 1,
                min: 1,
                caption: "最大显示数量"
            },
            showZero: {
                type: "checkbox",
                caption: "显示零值"
            },
            dot: {
                type: "checkbox",
                caption: "显示点状徽标"
            },
            color: {
                type: "color",
                caption: "徽标颜色"
            },
            extra: {
                type: "input",
                caption: "额外内容"
            },
            bordered: {
                type: "checkbox",
                caption: "显示边框"
            },
            shadow: {
                type: "checkbox",
                caption: "显示阴影"
            },
            
            // 状态属性
            loading: {
                type: "checkbox",
                caption: "加载状态"
            },
            collapsible: {
                type: "checkbox",
                caption: "可折叠"
            },
            collapsed: {
                type: "checkbox",
                caption: "默认折叠"
            },
            
            // 验证属性
            validation: {
                type: "button",
                cellRenderer: function () {
                    return ood.adjustRes("[ $RAD.designer.conf.Object ]")
                },
                caption: "验证规则"
            },
            errorMessage: {
                type: "input",
                caption: "错误消息"
            }
        },



        items: {
            "ood.UI.List": {
                header: ["id", {
                    id: 'type',
                    type: "listbox",
                    editorListItems: ["", "split"]
                }, "caption", "imageClass", "disabled", "hidden", "tagCmds", "tips", "tag", "tagVar"],
                uniqueKey: "id"
            },
            "ood.UI.RadioBox": {
                header: ["id", "caption", "itemClass", "iconStyle", "disabled", "hidden", "tips", "tag", "tagVar"],
                uniqueKey: "id"
            },
            "ood.UI.FoldingList": {
                header: ["id", "caption", 'className', "iconColor","fontColor","itemColor", "title", "text", "imageClass", "disabled", "hidden", "tag", "tagVar", "tagCmds", "tips"],
                uniqueKey: "id"
            },
            "ood.UI.ComboInput": {
                header: ["id", "caption", "imageClass", "iconFontSize", "disabled", "hidden", "tagCmds", "tips", "tag", "tagVar"],
                uniqueKey: "id"
            },
            "ood.UI.StatusButtons": {
                header: ["id", "caption", "iconColor","fontColor","itemColor", "renderer", {
                    id: 'itemType',
                    type: "listbox",
                    editorListItems: ["text", "button", "dropButton"]
                }, "imageClass", "disabled", "hidden", "tag", "tagVar", "tips"],
                uniqueKey: "id"
            },
            "ood.UI.Tabs": {
                header: ["id", "caption",  'euClassName',"iconColor","fontColor","itemColor", "url",'className', "imageClass", "closeBtn", "optBtn", "popBtn", "panelBgClr", "panelBgImg", "overflow", "html", "iframeAutoLoad", "ajaxAutoLoad", "disabled", "hidden", "tag", "tagVar", "tagCmds", "tips"],
                uniqueKey: "id"
            },
            "ood.UI.Stacks": {
                header: ["id", "caption", 'euClassName', "imageClass", "iconFontCode", "closeBtn", "optBtn", "popBtn", "panelBgClr", "panelBgImg", "overflow", "html", 'className',"iframeAutoLoad", "ajaxAutoLoad", "disabled", "hidden", "tag", "tagVar", "tagCmds", "tips"],
                uniqueKey: "id"
            },
            "ood.UI.ButtonViews": {
                header: ["id", "caption", 'euClassName', "iconColor","fontColor","itemColor", "imageClass", 'className',"iconFontCode", "closeBtn", "optBtn", "popBtn", "panelBgClr", "panelBgImg", "overflow", "html", "iframeAutoLoad", "ajaxAutoLoad", "disabled", "hidden", "tag", "tagVar", "tagCmds", "tips"],
                uniqueKey: "id"
            },
            "ood.UI.FoldingTabs": {
                header: ["id", "caption",'euClassName', 'className', "iconColor","fontColor","itemColor", "height", "imageBgSize", "imageRepeat", "imageClass", "iconFontCode", "iconFontSize", "iconStyle", "closeBtn", "optBtn", "popBtn", "panelBgClr", "panelBgImg", "overflow", "html", "iframeAutoLoad", "ajaxAutoLoad", "disabled", "hidden", "tag", "tagVar", "tagCmds", "tips"],
                uniqueKey: "id"
            },
            "ood.UI.Gallery": {
                header: ["id", "caption", "className","iconColor","fontColor","itemColor",  "capDisplay", "renderer", "comment", "itemClass", "itemStyle", "image", "imageClass", "iconFontCode", "iconFontSize", "iconStyle", "disabled", "hidden", "itemWidth", "itemHeight", "itemPadding", "itemMargin", "flagText", "flagClass", "flagStyle", "tag", "tagVar", "tips"],
                uniqueKey: "id"
            },
            "ood.UI.Opinion": {
                header: ["id", "caption", "creatorName", "createDateStr", "capDisplay", "renderer", "comment", "itemClass", "itemStyle", "image", "imageClass", "iconFontCode", "iconFontSize", "iconStyle", "disabled", "hidden", "itemWidth", "itemHeight", "itemPadding", "itemMargin", "flagText", "flagClass", "flagStyle", "tag", "tagVar", "tips"],
                uniqueKey: "id"
            },
            "ood.UI.TitleBlock": {
                header: ["id", "title",  "more", "msgnum","iconColor","fontColor","itemColor",  "moreBgColor", "bgColor", "itemClass", "itemStyle","disabled", "hidden", "itemWidth", "itemHeight", "itemPadding", "itemMargin", "flagText", "flagClass", "flagStyle", "tag", "tagVar", "tips"],
                uniqueKey: "id"
            },
            "ood.UI.ContentBlock": {
                header: ["id", "title",  "more", "datetime","iconColor","fontColor","itemColor",  "moreBgColor", "bgColor", "itemClass", "itemStyle","disabled", "hidden", "itemWidth", "itemHeight", "itemPadding", "itemMargin", "flagText", "flagClass", "flagStyle", "tag", "tagVar", "tips"],
                uniqueKey: "id"
            },
            "ood.UI.ButtonLayout": {
                header: ["id", "caption", "className","iconColor","fontColor","itemColor",  "capDisplay", "renderer", "comment", "itemClass", "itemStyle", "image", "imageClass", "iconFontCode", "iconFontSize", "iconStyle", "disabled", "hidden", "itemWidth", "itemHeight", "itemPadding", "itemMargin", "flagText", "flagClass", "flagStyle", "tag", "tagVar", "tips"],
                uniqueKey: "id"
            },
            "ood.UI.Image": {
                header: ["id", "image", "alt", "tips"],
                uniqueKey: "id"
            },
            "ood.UI.TreeBar": {
                header: ["id", {
                    id: 'type',
                    type: "listbox",
                    editorListItems: ["", "split"]
                }, "caption", 'entityClass',"bindClass","imageClass", "iconColor","fontColor","itemColor",'className',  "group", "disabled", "hidden", "tag", "tagVar", "initFold", "tips"],
                uniqueKey: "id",
                hasSub: true
            },

            "ood.UI.TreeView": {
                header: ["id", {
                    id: 'type',
                    type: "listbox",
                    editorListItems: ["", "split"]
                }, "caption", ' ',"bindClass","imageClass", "group", "iconColor","fontColor","itemColor", "className", "disabled", "hidden", "tag", "tagVar", "tagCmds", "initFold", "tips"],
                uniqueKey: "id",
                hasSub: true
            },
            "ood.UI.MTreeView": {
                header: ["id", {
                    id: 'type',
                    type: "listbox",
                    editorListItems: ["", "split"]
                }, "caption", "className", "imageClass", "group", "iconColor","fontColor","itemColor", "disabled", "hidden", "tag", "tagVar", "tagCmds", "initFold", "tips"],
                uniqueKey: "id",
                hasSub: true
            },
            "ood.UI.PopMenu": {
                header: ["id", "caption", 'className', "group", "type", "value", "iconColor","fontColor","itemColor", "add", "imageClass", "disabled", "hidden", "tag", "tagVar", "tips"],
                uniqueKey: "id",
                hasSub: 1
            },
            "ood.UI.MenuBar": {
                header: ["id", "caption", 'className', "group", "type","iconColor","fontColor","itemColor", "value", "add", "imageClass", "iconFontCode", "disabled", "hidden", "tag", "tagVar", "tips"],
                uniqueKey: "id",
                hasSub: 1
            },
            "ood.UI.ToolBar": {
                header: ["id", "hidden","iconColor","fontColor","itemColor",  "handler"],
                subheader: ["id", "caption", "label", {
                    id: 'type',
                    type: "listbox",
                    editorListItems: ["", "button", "dropButton", "statusButton", "profile", "split"]
                }, "value", "renderer", "imageClass", "iconFontCode", "disabled", "hidden", "tag", "tagVar", "tips"],
                uniqueKey: "id",
                subFixedRows: false,
                innerKey: 'sub'
            },
            "ood.UI.Layout": {
                header: ["id", "size", "min", "max", {id:"pos",  type: "listbox", editorListItems: ["before", "main", "after"]},"locked", "folded", "hidden", "cmd", "panelBgClr", "panelBgImg", "panelBgImgPos", "overflow", "html", "itemClass", "itemStyle", "tag"],
                rows: {
//                        'before':[{type:'label'},{type:'label'}],
                    'main': {
                        tag: 'candel',
                        cells: [{type: 'label'}, {}, {}, {type: 'label', value: "-"}, {
                            type: 'label',
                            value: "-"
                        }, {type: 'label', value: "-"}, {type: 'label', value: "-"}, {type: 'label', value: "-"}]
                    }
//                        'after':[{type:'label'},{type:'label'}]
                }
            }
        },
        header: {
            "ood.UI.TreeGrid": {
                header: [
                    {id: "id", type: 'input'},
                    {id: "caption", type: 'input'},
                    {
                        id: 'type',
                        type: "listbox",
                        editorListItems: ',label,input,textarea,combobox,listbox,file,getter,helpinput,button,dropbutton,cmdbox,popbox,date,time,datetime,color,spin,counter,currency,number,checkbox,progress,cmd'.split(',')
                    },
                    {
                        id: "formula", type: 'input', editorEvents: {
                            _onChange: function (p, ov, v) {
                                if (false === ood.ExcelFormula.validate(v)) {
                                    ood.alert("It's not a valid formula");
                                }
                            }
                        }
                    },
                    {id: "defaultValue", type: "input"},
                    {id: "flexSize", type: "checkbox"},
                    {
                        id: "width",
                        type: "input",
                        editorHAlign: 'right',
                        cellStyle: "text-align:right",
                        editorFormat: CONF.sizeFormat
                    },
                    {
                        id: "minWidth",
                        type: "input",
                        editorHAlign: 'right',
                        cellStyle: "text-align:right",
                        editorFormat: CONF.sizeFormat
                    },
                    {
                        id: "maxWidth",
                        type: "input",
                        editorHAlign: 'right',
                        cellStyle: "text-align:right",
                        editorFormat: CONF.sizeFormat0
                    },
                    {id: "colResizer", type: "checkbox"},
                    {id: "headerStyle", type: 'input'},
                    {id: "headerClass", type: 'input'},
                    {id: "colRenderer", type: "input"},
                    {id: "hidden", type: 'checkbox'},
//sortby : Function(x,y){return -1:0:1;}, custom sortby function
                    {id: "cellRenderer", type: "input"},
                    {id: "cellCapTpl", type: 'input'},
                    {id: 'cellClass', type: 'input'},
                    {id: 'cellStyle', type: 'input'},
                    {id: "disabled", type: "checkbox"},
                    {id: "readonly", type: "checkbox"},
                    {id: "editable", type: "checkbox"},
                    {id: "editMode", type: "listbox", editorListItems: ["focus", "sharp", "hover", "inline"]},
                    {
                        id: "editorListItems",
                        cellRenderer: function () {
                            return ood.adjustRes("[ $RAD.designer.conf.Object ]")
                        },
                        type: "button",
                        event: function (profile, cell, editorprf) {
                            var ns = profile.host,
                                node = profile.getSubNode('CELL', cell._serialId),
                                obj = cell.obj || [];
                            RAD.Designer.prototype._showMixedEditor(profile._targetProfile, "ood.UI.List", "header." + cell._col.id, "items", obj, node, function (items) {
                                cell.obj = ood.clone(items, true);
                                cell.needCollect = 1;
                                ns._dirty = 1;
                                node.focus();
                            }, true);
                        }
                    },
                    {
                        id: "editorDropListWidth",
                        type: "input",
                        editorHAlign: 'right',
                        cellStyle: "text-align:right",
                        editorFormat: CONF.sizeFormat
                    },
                    {
                        id: "editorDropListHeight",
                        type: "input",
                        editorHAlign: 'right',
                        cellStyle: "text-align:right",
                        editorFormat: CONF.sizeFormat
                    },
                    {id: "precision", type: "spin", precision: 0, increment: 1, min: 0, max: 100},
                    {id: "increment", type: "number", precision: 2, increment: 0.01},
                    {id: "min", type: "number", precision: 2, increment: 0.01},
                    {id: "max", type: "number", precision: 2, increment: 0.01},
                    {id: "maxlength", type: "spin", precision: 0, increment: 1, min: 0, max: 10000},
                    {id: "groupingSeparator", type: "input", maxlength: 1},
                    {id: "decimalSeparator", type: "input", maxlength: 1},
                    {id: "forceFillZero", type: "checkbox"},
                    {id: "numberTpl", type: "input"},
                    {id: "currencyTpl", type: "input"},
                    {id: "dateEditorTpl", type: "input"},
                    {id: "tips", type: "input"},
                    {id: "tag", type: "input"},
                    tagVar
                ],
                uniqueKey: "id"
            }
        },
        grpCols: {
            "ood.UI.TreeGrid": {
                header: [
                    {id: "id", type: 'input'},
                    {id: "caption", type: 'input'},
                    {id: "from", type: "spin", precision: 0, increment: 1, min: 0},
                    {id: "to", type: "spin", precision: 0, increment: 1, min: 0},
                    {id: "colResizer", type: "checkbox"},
                    {id: "headerStyle", type: 'input'},
                    {id: "headerClass", type: 'input'},
                    {id: "tips", type: "input"},
                    {id: "tag", type: "input"},
                    tagVar
                ],
                uniqueKey: "id"
            }
        },
        rows: {
            "ood.UI.TreeGrid": {
                header: [

                    //cells : Array, row's cells data
                    //sub : Array or [true], sub rows data

                    {id: "id", type: 'input'},
                    {id: "caption", type: 'input'},
                    {
                        id: 'type',
                        type: "listbox",
                        editorListItems: ',label,input,textarea,combobox,listbox,file,getter,helpinput,button,dropbutton,cmdbox,popbox,date,time,datetime,color,spin,counter,currency,number,checkbox,progress,cmd'.split(',')
                    },
                    {
                        id: "formula", type: 'input', editorEvents: {
                            _onChange: function (p, ov, v) {
                                if (false === ood.ExcelFormula.validate(v)) {
                                    ood.alert("It's not a valid formula");
                                }
                            }
                        }
                    },
                    {
                        id: "height",
                        type: "input",
                        editorHAlign: 'right',
                        cellStyle: "text-align:right",
                        editorFormat: CONF.sizeFormat
                    },
                    {id: "rowStyle", type: 'input'},
                    {id: "rowClass", type: 'input'},
                    {id: "firstCellStyle", type: 'input'},
                    {id: "firstCellClass", type: 'input'},
                    {id: "group", type: "checkbox"},
                    {id: "hidden", type: 'checkbox'},
                    {id: "rowResizer", type: "checkbox"},
                    {id: "rowRenderer", type: "input"},
//sortby : Function(x,y){return -1:0:1;}, custom sortby function
                    {id: "cellRenderer", type: "input"},
                    {id: "cellCapTpl", type: 'input'},
                    {id: 'cellClass', type: 'input'},
                    {id: 'cellStyle', type: 'input'},
                    {id: "disabled", type: "checkbox"},
                    {id: "readonly", type: "checkbox"},
                    {id: "editable", type: "checkbox"},

                    {id: "editMode", type: "listbox", editorListItems: ["focus", "sharp", "hover", "inline"]},
                    {
                        id: "editorListItems",
                        cellRenderer: function () {
                            return ood.adjustRes("[ $RAD.designer.conf.Object ]")
                        },
                        type: "button",
                        event: function (profile, cell, editorprf) {
                            var ns = profile.host,
                                node = profile.getSubNode('CELL', cell._serialId),
                                obj = cell.obj || [];
                            RAD.Designer.prototype._showMixedEditor(profile._targetProfile, "ood.UI.List", "rows." + cell._col.id, "items", obj, node, function (items) {
                                cell.obj = ood.clone(items, true);
                                cell.needCollect = 1;
                                ns._dirty = 1;
                                node.focus();
                            }, true);
                        }
                    },
                    {
                        id: "editorDropListWidth",
                        type: "input",
                        editorHAlign: 'right',
                        cellStyle: "text-align:right",
                        editorFormat: CONF.sizeFormat
                    },
                    {
                        id: "editorDropListHeight",
                        type: "input",
                        editorHAlign: 'right',
                        cellStyle: "text-align:right",
                        editorFormat: CONF.sizeFormat
                    },
                    {id: "precision", type: "spin", precision: 0, increment: 1, min: 0, max: 100},
                    {id: "increment", type: "number"},
                    {id: "min", type: "number"},
                    {id: "max", type: "number"},
                    {id: "maxlength", type: "spin", precision: 0, increment: 1, min: 0, max: 10000},
                    {id: "groupingSeparator", type: "input", maxlength: 1},
                    {id: "decimalSeparator", type: "input", maxlength: 1},
                    {id: "forceFillZero", type: "checkbox"},
                    {id: "numberTpl", type: "input"},
                    {id: "currencyTpl", type: "input"},
                    {id: "dateEditorTpl", type: "input"},
                    {id: "initFold", type: "checkbox"},
                    {id: "tips", type: "input"},
                    {id: "tag", type: "input"},
                    tagVar,
                    tagCmds
                ],
                subheader: [
//                        {id:"id",type:'input'},
                    {id: "value", type: 'input'},
                    {id: "caption", type: 'input'},
                    {id: "cellRenderer", type: "input"},
                    {id: "cellCapTpl", type: 'input'},
                    {
                        id: 'type',
                        type: "listbox",
                        editorListItems: ',label,input,textarea,combobox,listbox,file,getter,helpinput,button,dropbutton,cmdbox,popbox,date,time,datetime,color,spin,counter,currency,number,checkbox,progress,cmd'.split(',')
                    },
                    {
                        id: "formula", type: 'input', editorEvents: {
                            _onChange: function (p, ov, v) {
                                if (false === ood.ExcelFormula.validate(v)) {
                                    ood.alert("It's not a valid formula");
                                }
                            }
                        }
                    },
                    {id: "tag", type: 'input'},
                    tagVar,
                    {id: 'cellClass', type: 'input'},
                    {id: 'cellStyle', type: 'input'},
                    {id: "disabled", type: "checkbox"},
                    {id: "readonly", type: "checkbox"},
                    {id: "editable", type: "checkbox"},
                    {id: "editMode", type: "listbox", editorListItems: ["focus", "sharp", "hover", "inline"]},
                    {
                        id: "editorListItems",
                        cellRenderer: function () {
                            return ood.adjustRes("[ $RAD.designer.conf.Object ]")
                        },
                        type: "button",
                        event: function (profile, cell, editorprf) {
                            var ns = profile.host,
                                node = profile.getSubNode('CELL', cell._serialId),
                                obj = cell.obj || [];
                            RAD.Designer.prototype._showMixedEditor(profile._targetProfile, "ood.UI.List", "rows.cell." + cell._col.id, "items", obj, node, function (items) {
                                cell.obj = ood.clone(items, true);
                                cell.needCollect = 1;
                                ns._dirty = 1;
                                node.focus();
                            }, true);
                        }
                    },
                    {
                        id: "editorDropListWidth",
                        type: "input",
                        editorHAlign: 'right',
                        cellStyle: "text-align:right",
                        editorFormat: CONF.sizeFormat
                    },
                    {
                        id: "editorDropListHeight",
                        type: "input",
                        editorHAlign: 'right',
                        cellStyle: "text-align:right",
                        editorFormat: CONF.sizeFormat
                    },
                    {id: "precision", type: "spin", precision: 0, increment: 1, min: 0, max: 100},
                    {id: "increment", type: "number"},
                    {id: "min", type: "number"},
                    {id: "max", type: "number"},
                    {id: "maxlength", type: "spin", precision: 0, increment: 1, min: 0, max: 10000},
                    {id: "groupingSeparator", type: "input", maxlength: 1},
                    {id: "decimalSeparator", type: "input", maxlength: 1},
                    {id: "forceFillZero", type: "checkbox"},
                    {id: "numberTpl", type: "input"},
                    {id: "currencyTpl", type: "input"},
                    {id: "dateEditorTpl", type: "input"},
                    {id: "tips", type: "input"},
                    tagCmds
                ],
                // dont set it , id will be auto set
                uniqueKey: null,
                hasSub: 1,
                innerKey: 'cells',
                subrowfixed: 1
            }
        },
        tagCmds: {
            "all": {
                header: [
                    {id: "id", type: "input"},
                    {id: "tagCmdsAlign", type: "combobox", editorListItems: ["left", "right", "floatright"]},
                    {id: "buttonType", type: "combobox", editorListItems: ["button", "image", "text", "split"]},
                    {id: "pos", type: "combobox", editorListItems: ["", "row", "header"]},
                    {id: "caption", type: "input"},
                    {
                        id: "itemClass",
                        type: "combobox",
                        editorCommandBtn: 'pop',
                        editorDropListWidth: '18em',
                        editorListItems: CONF.designer_list_imageclass2,
                        tagVar: {
                            prop: 'imageClass'
                        }
                    },
                    {id: "itemStyle", type: "input"},
                    {
                        id: "image",
                        type: CONF.getClientMode() == 'singlepage' ? "input" : "popbox",
                        event: function (profile, cell, editorprf) {
                            var node = profile.getSubNode('CELL', cell._serialId),
                                _cb = function (path) {
                                    editorprf.boxing().setUIValue(CONF.adjustRelativePath(path));
                                    node.focus();
                                };
                            var t = profile._targetProfile,
                                k = profile._targetPropKey;
                            if (window.SPA && false === SPA.fe("beforeURISelectorPop", [
                                k + ':item:image', cell.value, _cb,
                                'conf', t && t['ood.absProfile'] ? t.boxing() : t, node.get(0), cell, profile.boxing(), editorprf && editorprf.boxing()
                            ])) return;

                            if (CONF.getClientMode() != 'singlepage') {
                                ood.ModuleFactory.getCom('RAD.ImageSelector', function () {
                                    this.setProperties({
                                        fromRegion: node.cssRegion(true),
                                        onOK: function (obj, path) {
                                            _cb();
                                        }
                                    });
                                    this.show();
                                });
                            }
                        }
                    },
                    {id: "tips", type: "input"},
                    tagVar
                ]
            }
        }
    },
    widgets_mapProp: {
        dockMargin: {
            all: {
                cells: [
                    {id: "left", type: "spin", precision: 0, increment: 1},
                    {id: "top", type: "spin", precision: 0, increment: 1},
                    {id: "right", type: "spin", precision: 0, increment: 1},
                    {id: "bottom", type: "spin", precision: 0, increment: 1}
                ]
            }
        },
        conDockPadding: {
            all: {
                cells: [
                    {id: "left", type: "spin", precision: 0, increment: 1},
                    {id: "top", type: "spin", precision: 0, increment: 1},
                    {id: "right", type: "spin", precision: 0, increment: 1},
                    {id: "bottom", type: "spin", precision: 0, increment: 1}
                ]
            }
        },
        conDockSpacing: {
            all: {
                cells: [
                    {id: "width", type: "spin", precision: 0, increment: 1},
                    {id: "height", type: "spin", precision: 0, increment: 1}
                ]
            }
        },
        rowOptions: {
            "ood.UI.TreeGrid": {
                cells: [
                    {
                        id: 'type',
                        type: "listbox",
                        editorListItems: ',label,input,textarea,combobox,listbox,file,getter,helpinput,button,dropbutton,cmdbox,popbox,date,time,datetime,color,spin,counter,currency,number,checkbox,progress,cmd'.split(',')
                    },
                    {
                        id: "formula", type: 'input', editorEvents: {
                            _onChange: function (p, ov, v) {
                                if (false === ood.ExcelFormula.validate(v)) {
                                    ood.alert("It's not a valid formula");
                                }
                            }
                        }
                    },
                    {id: "rowRenderer", type: "input"},
                    {id: "cellRenderer", type: "input"},
                    {id: 'cellClass', type: 'input'},
                    {id: 'cellStyle', type: 'input'},
                    {id: "disabled", type: "checkbox"},
                    {id: "readonly", type: "checkbox"},
                    {id: "editable", type: "checkbox"},
                    {id: "editMode", type: "listbox", editorListItems: ["focus", "sharp", "hover", "inline"]},
                    {id: "precision", type: "spin", precision: 0, increment: 1, min: 0, max: 100},
                    {id: "increment", type: "number"},
                    {id: "min", type: "number"},
                    {id: "max", type: "number"},
                    {id: "maxlength", type: "spin", precision: 0, increment: 1, min: 0, max: 10000},
                    {id: "groupingSeparator", type: "input", maxlength: 1},
                    {id: "decimalSeparator", type: "input", maxlength: 1},
                    {id: "forceFillZero", type: "checkbox"},
                    {id: "numberTpl", type: "input"},
                    {id: "currencyTpl", type: "input"},
                    {id: "dateEditorTpl", type: "input"}
                ]
            }
        },
        colOptions: {
            "ood.UI.TreeGrid": {
                cells: [
                    {
                        id: 'type',
                        type: "listbox",
                        editorListItems: ',label,input,textarea,combobox,listbox,file,getter,helpinput,button,dropbutton,cmdbox,popbox,date,time,datetime,color,spin,counter,currency,number,checkbox,progress,cmd'.split(',')
                    },
                    {
                        id: "formula", type: 'input', editorEvents: {
                            _onChange: function (p, ov, v) {
                                if (false === ood.ExcelFormula.validate(v)) {
                                    ood.alert("It's not a valid formula");
                                }
                            }
                        }
                    },
                    {id: "colRenderer", type: "input"},
                    {id: "cellRenderer", type: "input"},
                    {id: 'cellClass', type: 'input'},
                    {id: 'cellStyle', type: 'input'},
                    {id: "disabled", type: "checkbox"},
                    {id: "readonly", type: "checkbox"},
                    {id: "editable", type: "checkbox"},
                    {id: "editMode", type: "listbox", editorListItems: ["focus", "sharp", "hover", "inline"]},
                    {id: "precision", type: "spin", precision: 0, increment: 1, min: 0, max: 100},
                    {id: "increment", type: "number"},
                    {id: "min", type: "number"},
                    {id: "max", type: "number"},
                    {id: "maxlength", type: "spin", precision: 0, increment: 1, min: 0, max: 10000},
                    {id: "groupingSeparator", type: "input", maxlength: 1},
                    {id: "decimalSeparator", type: "input", maxlength: 1},
                    {id: "forceFillZero", type: "checkbox"},
                    {id: "numberTpl", type: "input"},
                    {id: "currencyTpl", type: "input"},
                    {id: "dateEditorTpl", type: "input"}
                ]
            }
        }
    },
    widgets_attrProp: {
        dockMargin: {
            all: {
                header: ["key", "value"],
                rows: [
                    [{value: 'left'}],
                    [{value: 'top'}],
                    [{value: 'right'}],
                    [{value: 'bottom'}]
                ],
                fix: 1
            }
        }
    },
    widgets_customCellOptions: {
        'ood.UI.Input': {
            maxlength: {
                precision: 0
            }
        },
        'ood.UI.ComboInput': {
            maxlength: {
                precision: 0
            },
            min: {
                precision: 2
            },
            max: {
                precision: 2
            },
            increment: {
                precision: 2
            }
        },
        'ood.UI.ColorPicker': {
            value: {
                type: 'color'
            }
        },
        'ood.UI.Audio': {
            volume: {type: "spin", precision: 2, min: 0, max: 1}
        },
        'ood.UI.Video': {
            volume: {type: "spin", precision: 2, min: 0, max: 1}
        }
    },
    ModuleFactoryProfile: {
        about: {
            cls: 'RAD.About'
        },
        delFile: {
            cls: 'RAD.DelFile'
        },
        prjPro: {
            cls: 'RAD.ProjectPro'
        },
        prjSel: {
            cls: 'RAD.ProjectSelector'
        },
        prjVersionSel: {
            cls: 'RAD.ProjectVersionSelector'
        },
        funEditor: {
            cls: 'RAD.FunEditor'
        },
        jsonEditor: {
            cls: 'RAD.JSONEditor'
        },
        HTMLEditor: {
            cls: 'RAD.HTMLEditor'
        },
        FileSelector: {
            cls: 'RAD.FileSelector'
        },
        MobileInstruction: {
            cls: 'RAD.MobileInstruction'
        },
        RegisterForm: {
            cls: 'RAD.RegisterForm'
        }
    },
    inplaceedit: {
        "ood.UI.Link": {
            KEY: [0, 'getCaption', 'setCaption']
        },
        "ood.UI.Label": {
            KEY: [0, 'getCaption', 'setCaption']
        },
        "ood.UI.CheckBox": {
            CAPTION: [0, 'getCaption', 'setCaption']
        },
        "ood.UI.Span": {
            KEY: [0, 'getHtml', 'setHtml']
        },
        /*"ood.UI.Div":{
            KEY:[0,'getHtml','setHtml']
        },*/
        "ood.UI.HTMLButton": {
            KEY: [0, 'getCaption', 'setCaption']
        },
        "ood.UI.Button": {
            KEY: [0, 'getCaption', 'setCaption']
        },
        "ood.UI.Group": {
            CAPTION: [0, 'getCaption', 'setCaption']
        },
        "ood.UI.Input": {
            INPUT: [0, 'getValue', 'setValue'],
            LABEL: [0, 'getLabelCaption', 'setLabelCaption']
        },
        "ood.UI.ComboInput": {
            INPUT: [0, 'getValue', 'setValue'],
            LABEL: [0, 'getLabelCaption', 'setLabelCaption']
        },
        "ood.UI.RichEditor": {
            LABEL: [0, 'getLabelCaption', 'setLabelCaption']
        },
        "ood.UI.Slider": {
            LABEL: [0, 'getLabelCaption', 'setLabelCaption']
        },
        "ood.UI.PageBar": {
            LABEL: [0, 'getCaption', 'setCaption']
        },
        "ood.UI.Dialog": {
            CAPTION: [0, 'getCaption', 'setCaption']
        },
        "ood.UI.Panel": {
            CAPTION: [0, 'getCaption', 'setCaption']
        },
        "ood.UI.Slider": {
            LABEL: [0, 'getLabelCaption', 'setLabelCaption']
        },

        "ood.UI.List": {
            ITEM: [1, 'getItemByDom', 'updateItem'],
            LABEL: [0, 'getLabelCaption', 'setLabelCaption']
        },
        "ood.UI.RadioBox": {
            CAPTION: [1, 'getItemByDom', 'updateItem'],
            LABEL: [0, 'getLabelCaption', 'setLabelCaption']
        },
        "ood.UI.StatusButtons": {
            CAPTION: [1, 'getItemByDom', 'updateItem'],
            LABEL: [0, 'getLabelCaption', 'setLabelCaption']
        },
        "ood.UI.Gallery": {
            CAPTION: [1, 'getItemByDom', 'updateItem'],
            COMMENT: [1, 'getItemByDom', 'updateItem', 'comment']
        },
        "ood.UI.ButtonLayout": {
            CAPTION: [1, 'getItemByDom', 'updateItem'],
            COMMENT: [1, 'getItemByDom', 'updateItem', 'comment']
        },
        "ood.UI.Tabs": {
            CAPTION: [1, 'getItemByDom', 'updateItem']
        },
        "ood.UI.Stacks": {
            CAPTION: [1, 'getItemByDom', function (prf, item, itemKey, nv) {
                prf.boxing().updateItem(item.id, {caption: nv});
                prf.boxing().reLayout(true);
            }]
        },
        "ood.UI.ButtonViews": {
            CAPTION: [1, 'getItemByDom', 'updateItem']
        },
        "ood.UI.MenuBar": {
            ITEM: [1, 'getItemByDom', 'updateItem']
        },
        "ood.UI.TreeBar": {
            ITEMCAPTION: [1, 'getItemByDom', 'updateItem']
        },
        "ood.UI.TreeView": {
            ITEMCAPTION: [1, 'getItemByDom', 'updateItem']
        },
        "ood.UI.MTreeView": {
            ITEMCAPTION: [1, 'getItemByDom', 'updateItem']
        },
        "ood.UI.ToolBar": {
            LABEL: [1, function (prf, node) {
                return prf.SubSerialIdMapItem[prf.getSubId(node.id)];
            }, 'updateItem', 'label'],
            BTN: [1, function (prf, node) {
                return prf.SubSerialIdMapItem[prf.getSubId(node.id)];
            }, 'updateItem']
        },
        "ood.UI.TreeGrid": {
            CELLA: [1, function (prf, node) {
                var subId = prf.getSubId(node.id), o, item = {};
                if (subId.charAt(0) == '-' && subId.charAt(1) == 'r') {
                    o = prf.rowMap[subId];
                    item.id = o.id;
                    item.caption = o.caption;
                    item.isRow = true;
                } else {
                    o = prf.cellMap[subId];
                    item.id = o.id;
                    item.caption = o.value;
                }
                return item;
            }, function (prf, item, itemKey, nv) {
                if (item.isRow)
                    prf.boxing().updateRow(item.id, {caption: nv});
                else
                    prf.boxing().updateCell(item.id, {value: nv});
            }],
            HCELLA: [1, function (prf, node) {
                var subId = prf.getSubId(node.id);
                return subId ? prf.colMap[subId] : {
                    id: ' X ',
                    caption: prf.boxing().getGridHandlerCaption()
                };
            }, function (prf, item, itemKey, nv) {
                if (item.id != ' X ')
                    prf.boxing().updateHeader(item.id, {caption: nv});
                else
                    prf.boxing().setGridHandlerCaption(nv);
            }]
        },
        "ood.UI.FormLayout": {
            ITEM: [1, null, null, null, null, null, function (page, prf, node) {
                if (prf.$htable) {
                    var cellMeta = prf.getItemByDom(node.id());
                    prf.$htable.selectCell(cellMeta.row, cellMeta.col);
                }
            }]
        },
        "ood.UI.FoldingTabs": {
            CAPTION: [1, 'getItemByDom', 'updateItem'],
            MESSAGE: [1, 'getItemByDom', 'updateItem', 'message']
        },
        "ood.svg.text": {
            KEY: [0, function (prf) {
                return prf.properties.attr.text;
            }, function (prf, nv) {
                prf.boxing().setAttr({text: nv}, null, false);
            }, 'KEY', true]
        },
        "ood.svg.rectComb": {
            TEXT: [0, function (prf) {
                return ood.get(prf.properties.attr, ["TEXT", "text"]);
            }, function (prf, nv) {
                prf.boxing().setAttr("TEXT", {text: nv}, false);
            }, 'KEY', true]
        },
        "ood.svg.circleComb": {
            TEXT: [0, function (prf) {
                return ood.get(prf.properties.attr, ["TEXT", "text"]);
            }, function (prf, nv) {
                prf.boxing().setAttr("TEXT", {text: nv}, false);
            }, 'KEY', true]
        },
        "ood.svg.ellipseComb": {
            TEXT: [0, function (prf) {
                return ood.get(prf.properties.attr, ["TEXT", "text"]);
            }, function (prf, nv) {
                prf.boxing().setAttr("TEXT", {text: nv}, false);
            }, 'KEY', true]
        },
        "ood.svg.pathComb": {
            TEXT: [0, function (prf) {
                return ood.get(prf.properties.attr, ["TEXT", "text"]);
            }, function (prf, nv) {
                prf.boxing().setAttr("TEXT", {text: nv}, false);
            }, 'KEY', true]
        },
        "ood.svg.imageComb": {
            TEXT: [0, function (prf) {
                return ood.get(prf.properties.attr, ["TEXT", "text"]);
            }, function (prf, nv) {
                prf.boxing().setAttr("TEXT", {text: nv}, false);
            }, 'KEY', true]
        },
        "ood.svg.connector": {
            TEXT: [0, function (prf) {
                return ood.get(prf.properties.attr, ["TEXT", "text"]);
            }, function (prf, nv) {
                prf.boxing().setAttr("TEXT", {text: nv}, false);
            }, 'KEY', true]
        }
    }
});
ood.setAppLangKey("RAD");

// special setting for ood.UI.FormLayout
CONF._$initForDesign = {
    'ood.UI.FormLayout': function (page, prf) {
        var capMap = {
            'row_above': '$(RAD.FormLayout.Insert row above)',
            'row_below': '$(RAD.FormLayout.Insert row below)',
            'col_left': '$(RAD.FormLayout.Insert column left)',
            'col_right': '$(RAD.FormLayout.Insert column right)',
            'clear_column': '$(RAD.FormLayout.Clear selected column)',
            'remove_row': '$(RAD.FormLayout.Remove row)',
            'remove_col': '$(RAD.FormLayout.Remove column)',
            'alignment': '$(RAD.FormLayout.Alignment)',
            'alignment:left': '$(RAD.FormLayout.Left)',
            'alignment:top': '$(RAD.FormLayout.Top)',
            'alignment:right': '$(RAD.FormLayout.Right)',
            'alignment:bottom': '$(RAD.FormLayout.Bottom)',
            'alignment:middle': '$(RAD.FormLayout.Middle)',
            'alignment:center': '$(RAD.FormLayout.Center)',
            'alignment:justify': '$(RAD.FormLayout.Justify)',
            'mergeCells': '$(RAD.FormLayout.Merge cells)',
            'color': '$(RAD.FormLayout.Foreground color)',
            'bgcolor': '$(RAD.FormLayout.Background color)',
            'border': '$(RAD.FormLayout.Border)',
            'font': '$(RAD.FormLayout.Font)',
            'font:font-family': '$(RAD.FormLayout.Font family)',
            'font:font-size': '$(RAD.FormLayout.Font size)',
            'font:font-weight': '$(RAD.FormLayout.Font weight)',
            'font:font-style': '$(RAD.FormLayout.Font style)',
            'font:text-decoration': '$(RAD.FormLayout.Text decoration)'
        };
        prf.$onLayoutChanged = function (profile, odata, ndata) {
            var redo;
            var alias = profile.alias;

            odata = ood.clone(odata);
            ndata = ood.clone(ndata);

            page.markDirty(function () {
                page.getByAlias(alias).setLayoutData(odata, true);
            }, redo = function () {
                page.getByAlias(alias).setLayoutData(ndata, true);
            }, 'set properties');
            //prf.properties.layoutData = ood.clone(ndata);
        };
        prf.$onClick=function(prf, oodmenu, _menu){

        };
        prf.$onPopMenu = function (prf, oodmenu, _menu) {
            var ignoreMap = {cut: 1, copy: 1, make_read_only: 1, undo: 1, redo: 1};
            var htable = _menu.hot;
            var mapArr = function (arr, key) {
                var mapArr = [];
                ood.arr.each(arr, function (item) {
                    var t = {}
                    if (ood.isHash(item)) {
                        t = ood.copy(item);
                    } else if (item) {
                        t = {};
                        t.id = t.value = item;
                    } else {
                        return;
                    }
                    t.cat = key;
                    mapArr.push(t);
                });
                return mapArr;
            };
            if (oodmenu) {
                ood.each(_menu.menuItems, function (item) {
                    if (item.name != '---------') {
                        oodmenu.updateItem(item.key, {disabled: item.disabled ? item.disabled.call(htable) : false});
                    }
                });
            } else {
                oodmenu = CONF._FormLayout_PopMenu;
                if (!oodmenu || oodmenu.isDestroyed()) {
                    oodmenu = new ood.UI.PopMenu();
                    var mapMenu = function (items) {
                            var nitems = [], lastSplit;
                            ood.each(items, function (item) {
                                if (ignoreMap[item.key]) return;
                                if (item.name == '---------') {
                                    if (!lastSplit) {
                                        lastSplit = 1;
                                        nitems.push({type: 'split'});
                                    }
                                } else {
                                    lastSplit = 0;
                                    nitems.push({
                                        id: item.key,
                                        disabled: item.disabled ? item.disabled.call(htable) : false,
                                        caption: capMap && capMap[item.key] || item.name.call(htable),
                                        sub: item.submenu ? mapMenu(item.submenu.items) : null,
                                        _cb: item.callback
                                    });
                                }
                            });
                            return nitems;
                        },
                        normalizeSelection = function (selRanges) {
                            var arr = [];
                            for (var i = 0, l = selRanges.length; i < l; i++) {
                                arr.push({
                                    start: selRanges[i].getTopLeftCorner(),
                                    end: selRanges[i].getBottomRightCorner()
                                });
                            }
                            return arr;
                        },
                        nitems = mapMenu(_menu.menuItems);
                    nitems.push({type: 'split'});
                    nitems.push({
                        id: 'color',
                        caption: capMap && capMap.color || 'color',
                        sub: true
                    });
                    nitems.push({
                        id: 'bgcolor',
                        caption: capMap && capMap.bgcolor || 'bgcolor',
                        sub: true
                    });
                    nitems.push({
                        id: 'font',
                        caption: capMap && capMap.font || 'font',
                        sub: [
                            {
                                id: 'font:font-family',
                                caption: capMap && capMap['font:font-family'] || 'font-family',
                                sub: mapArr(CONF.designer_data_fontfamily, 'family')
                            },
                            {
                                id: 'font:font-size',
                                caption: capMap && capMap['font:font-size'] || 'font-size',
                                sub: mapArr(CONF.designer_data_fontsize, 'size')
                            },
                            {
                                id: 'font:font-weight',
                                caption: capMap && capMap['font:font-weight'] || 'font-weight',
                                sub: mapArr(CONF.designer_data_fontweight, 'weight')
                            },
                            {
                                id: 'font:font-style',
                                caption: capMap && capMap['font:font-style'] || 'font-style',
                                sub: mapArr(CONF.designer_data_fontstyle, 'style')
                            },
                            {
                                id: 'font:text-decoration',
                                caption: capMap && capMap['font:text-decoration'] || 'text-decoration',
                                sub: mapArr(CONF.designer_data_textdecoration, 'decoration')
                            }
                        ]
                    });
                    nitems.push({
                        id: 'border',
                        caption: capMap && capMap.border || 'border',
                        sub: true
                    })
                    oodmenu.setItems(nitems);

                    oodmenu.onMenuSelected(function (p, item) {
                        var setStyle = function (key, value) {
                            ood.each(htable.getSelectedRange(), function (selection) {
                                var fromRow = Math.min(selection.from.row, selection.to.row),
                                    toRow = Math.max(selection.from.row, selection.to.row),
                                    fromCol = Math.min(selection.from.col, selection.to.col),
                                    toCol = Math.max(selection.from.col, selection.to.col);

                                for (var row = fromRow; row <= toRow; row++) {
                                    for (var col = fromCol; col <= toCol; col++) {
                                        var cellMeta = htable.getCellMeta(row, col),
                                            TD = htable.getCell(row, col);

                                        TD.style[key] = (cellMeta.style || (cellMeta.style = {}))[key] = value;


                                    }
                                }
                            });
                            prf.box._layoutChanged(prf);
                        };
                        switch (item.id) {
                            case 'bgcolor':
                                setStyle('backgroundColor', "#" + item.value);
                                break;
                            case 'color':
                                setStyle('color', "#" + item.value);
                                break;
                            case 'alignment:left':
                                setStyle('textAlign', "left");
                                break;
                            case 'alignment:center':
                                setStyle('textAlign', "center");
                                break;
                            case 'alignment:right':
                                setStyle('textAlign', "right");
                                break;
                            case 'alignment:justify':
                                setStyle('textAlign', "justify");
                                break;
                            case 'alignment:top':
                                setStyle('verticalAlign', "top");
                                break;
                            case 'alignment:middle':
                                setStyle('verticalAlign', "middle");
                                break;
                            case 'alignment:bottom':
                                setStyle('verticalAlign', "bottom");
                                break;
                            default:
                                if (item._cb) {
                                    item._cb.call(htable, item.id, normalizeSelection(htable.getSelectedRange()));
                                } else {
                                    switch (item.cat) {
                                        case "family":
                                            setStyle('fontFamily', item.id);
                                            break;
                                        case "weight":
                                            setStyle('fontWeight', item.id);
                                            break;
                                        case "size":
                                            setStyle('fontSize', item.id);
                                            break;
                                        case "decoration":
                                            setStyle('textDecoration', item.id);
                                            break;
                                        case "style":
                                            setStyle('fontStyle', item.id);
                                            break;
                                    }
                                }
                        }
                    })
                        .onShowSubMenu(function (profile, item, src) {
                            var menubar = profile.boxing(), obj;
                            switch (item.id) {
                                case 'color':
                                case 'bgcolor':
                                    obj = (new ood.UI.ColorPicker).render(true);
                                    obj.setCloseBtn(false);
                                    obj.afterUIValueSet(function (p, old, n) {
                                        menubar.hide(false);
                                        menubar.onMenuSelected(profile, {
                                            id: item.id,
                                            value: n
                                        });
                                    });
                                    obj.get(0).$parentPopMenu = profile;
                                    break;
                                case 'border':
                                    var module = (new RAD.GridBorder()).render(true);
                                    module.fillBtns();
                                    module.setEvents("onApplyBorder", function (type, style, width, color) {
                                        var value = (style || 'solid') + ' ' + (width ? (width + 'px') : '') + ' ' + (color || '');
                                        value = ood.str.trim(value).replace(/ +/g, ' ');

                                        var customBordersPlugin = htable.getPlugin('customBorders');
                                        var customBordersT = [], customBordersL = [];
                                        ood.each(htable.getSelectedRange(), function (selection) {
                                            var fromRow = Math.min(selection.from.row, selection.to.row),
                                                toRow = Math.max(selection.from.row, selection.to.row),
                                                fromCol = Math.min(selection.from.col, selection.to.col),
                                                toCol = Math.max(selection.from.col, selection.to.col);

                                            var l = 'borderLeft', r = 'borderRight', t = 'borderTop',
                                                b = 'borderBottom';
                                            // clear custom
                                            customBordersPlugin.clearBorders([[fromRow, fromCol, toRow + 1, toCol + 1]]);
                                            // clear td border
                                            for (var row = fromRow; row <= toRow; row++) {
                                                for (var col = fromCol; col <= toCol; col++) {
                                                    var cellMeta = htable.getCellMeta(row, col),
                                                        TD = htable.getCell(row, col),
                                                        prevCellMeta, prevTD;
                                                    cellMeta.style = cellMeta.style || {};
                                                    delete cellMeta.style[l];
                                                    delete cellMeta.style[r];
                                                    delete cellMeta.style[t];
                                                    delete cellMeta.style[b];
                                                    ood(TD).css('border', '');
                                                    if (TD.previousElementSibling && TD.previousElementSibling.tagName.toUpperCase() == 'TD') {
                                                        // find the prev one
                                                        prevCellMeta = htable.getCellMeta(row, col - 1);
                                                        prevTD = htable.getCell(row, col - 1);
                                                        if (!prevCellMeta.hidden) {
                                                            delete prevCellMeta.style[r];
                                                            ood(prevTD).css('borderRight', '');
                                                        }
                                                    }
                                                    if (TD.parentElement.previousElementSibling && TD.parentElement.previousElementSibling.tagName.toUpperCase() == 'TR') {
                                                        // find the prev one
                                                        prevCellMeta = htable.getCellMeta(row - 1, col);
                                                        prevTD = htable.getCell(row - 1, col);
                                                        if (!prevCellMeta.hidden) {
                                                            delete prevCellMeta.style[b];
                                                            ood(prevTD).css('borderBottom', '');
                                                        }
                                                    }
                                                }
                                            }
                                            // set one by one
                                            var isLeft, isRight, isTop, isBottom, isInner, isOuter;
                                            for (var row = fromRow; row <= toRow; row++) {
                                                for (var col = fromCol; col <= toCol; col++) {
                                                    var cellMeta = htable.getCellMeta(row, col),
                                                        TD = htable.getCell(row, col),
                                                        prevCellMeta, prevTD;
                                                    isLeft = col == fromCol;
                                                    isRight = col == toCol;
                                                    isTop = row == fromRow;
                                                    isBottom = row == toRow;
                                                    isOuter = isLeft || isRight || isTop || isBottom;
                                                    isInner = !isOuter;

                                                    if (cellMeta.spanned) {
                                                        isOuter = isLeft = isRight = isTop = isBottom = true;
                                                        isInner = !isOuter;
                                                    }

                                                    if (type == 'all' || type == 'inner') {
                                                        if (isInner) {
                                                            TD.style[r] = cellMeta.style[r] = value;
                                                            TD.style[b] = cellMeta.style[b] = value;
                                                        } else {
                                                            if (isLeft || isRight) {
                                                                if (isLeft) {
                                                                    TD.style[r] = cellMeta.style[r] = value;
                                                                }
                                                                if (!isBottom) {
                                                                    TD.style[b] = cellMeta.style[b] = value;
                                                                }
                                                            }
                                                            if (isTop || isBottom) {
                                                                if (isTop) {
                                                                    TD.style[b] = cellMeta.style[b] = value;
                                                                }
                                                                if (!isRight) {
                                                                    TD.style[r] = cellMeta.style[r] = value;
                                                                }
                                                            }
                                                        }
                                                    }
                                                    if (isRight && (type == 'right' || type == 'outer' || type == 'all')) {
                                                        TD.style[r] = cellMeta.style[r] = value;
                                                    }
                                                    if (isLeft && (type == 'left' || type == 'outer' || type == 'all')) {
                                                        // first
                                                        if (!TD.previousElementSibling || TD.previousElementSibling.tagName.toUpperCase() != 'TD') {
                                                            TD.style[l] = cellMeta.style[l] = value;
                                                        } else {
                                                            // find the prev one
                                                            prevCellMeta = htable.getCellMeta(row, col - 1);
                                                            prevTD = htable.getCell(row, col - 1);
                                                            if (!prevCellMeta.hidden) {
                                                                prevTD.style[r] = prevCellMeta.style[r] = value;
                                                            } else {
                                                                //var first = prf.getItemByDom(prevTD);
                                                                //if(!ood.get(first,['style','borderR'])){
                                                                //    TD.style[l] = cellMeta.style[l] =  value;
                                                                //}
                                                                // draw customBorders
                                                                customBordersL.push([row, col, row, col]);
                                                            }
                                                        }
                                                    }
                                                    if (isBottom && (type == 'bottom' || type == 'outer' || type == 'all')) {
                                                        TD.style[b] = cellMeta.style[b] = value;
                                                    }
                                                    if (isTop && (type == 'top' || type == 'outer' || type == 'all')) {
                                                        // first
                                                        if (!TD.parentElement.previousElementSibling || TD.parentElement.previousElementSibling.tagName.toUpperCase() != 'TR') {
                                                            TD.style[t] = cellMeta.style[t] = value;
                                                        } else {
                                                            // find the prev one
                                                            prevCellMeta = htable.getCellMeta(row - 1, col);
                                                            prevTD = htable.getCell(row - 1, col);
                                                            if (!prevCellMeta.hidden) {
                                                                prevTD.style[b] = prevCellMeta.style[b] = value;
                                                            } else {
                                                                //var first = prf.getItemByDom(prevTD);
                                                                //if(!ood.get(first,['style','borderB'])){
                                                                //   TD.style[t] = cellMeta.style[t] =  value;
                                                                //}
                                                                // draw customBorders
                                                                customBordersT.push([row, col, row, col]);
                                                            }
                                                        }
                                                    }
                                                }
                                            }
                                        });
                                        // Use customBorders plugin for patch merged cell's small sibling's left/top border
                                        if (customBordersT.length) customBordersPlugin.setBorders(customBordersT, {
                                            top: {
                                                color: color,
                                                width: width
                                            }
                                        });
                                        if (customBordersL.length) customBordersPlugin.setBorders(customBordersL, {
                                            left: {
                                                color: color,
                                                width: width
                                            }
                                        });

                                        prf.box._layoutChanged(prf);
                                        profile.boxing().hide();
                                    });
                                    obj = module.getRoot(true).boxing();
                                    module.getAllComponents().each(function (prf) {
                                        prf.$parentPopMenu = profile;
                                    });
                                    break;
                            }
                            return obj;
                        });

                    CONF._FormLayout_PopMenu = oodmenu;
                }
            }
            oodmenu.pop(prf.$lastMousePos);
            return oodmenu;
        };
        prf.$handleCustomVars = function (d) {
            if (d) {
                for (var i in d) if (d[i]) this[i] = d[i];
            } else {
                return {
                    $onLayoutChanged: prf.$onLayoutChanged,
                    $onPopMenu: prf.$onPopMenu
                }
            }
        }
    }
};

CONF.openProject = function (projectName, onOK1, onOK2, callback, host, openMain) {
    var openRoot = function (projectName, onOK1, onOK2, callback, host, openMain) {
            var action = 'open';
            if (!onOK2) {
                action = 'refresh'
            }
            ood.Ajax(CONF.openProjectService,
                {
                    hashCode: ood.id(),
                    projectName: projectName
                }, function (txt) {
                    var obj = txt;
                    if (!obj || obj.error) {
                        switch (obj.error.id) {
                            case 3005:
                                ood.alert(ood.adjustRes('$(RAD.msg.$0 dones not exit-' + projectName + ')'));
                                break;
                            default:
                                ood.message(ood.get(obj, ['error', 'message']) || obj || 'no response!');
                        }
                    } else {
                        openCls(projectName, onOK1, onOK2, callback, host, openMain, obj.data);
                    }
                }).start();
        },
        openCls = function (projectName, onOK1, onOK2, callback, host, openMain, ok1data) {
            var finalFun = function (projectName, projectRootClass, onOK1, onOK2, callback, host, ok1data) {
                if (onOK1) {
                    ood.tryF(onOK1, [projectName, ok1data, openMain, projectRootClass], host);
                }
                if (onOK2) {
                    getXUIClasses(projectName, projectRootClass, onOK2, openMain, callback, host);
                } else {
                    ood.tryF(callback);
                }
            };
            var simProjectName=projectName;
            if (projectName && projectName.indexOf("VVVERSION") > -1) {
                simProjectName=projectName.substring(0,projectName.indexOf("VVVERSION"));
            }

            finalFun(projectName, simProjectName, onOK1, onOK2, callback, host, ok1data);
        },
        getXUIClasses = function (projectName, rootCls, onOK2, openMain, callback, host) {
            var simProjectName=projectName;
            if (projectName && projectName.indexOf("VVVERSION") > -1) {
                simProjectName=projectName.substring(0,projectName.indexOf("VVVERSION"));
            }
            if (!rootCls) rootCls = simProjectName;

            ood.Ajax(CONF.getAllClass, {projectName: projectName}, function (txt) {
                var obj = txt;
                if (!obj || obj.error)
                    ood.message(ood.get(obj, ['error', 'errdes']) || 'no response!');
                else {
                    ood.tryF(onOK2, [projectName, obj.data.files || obj.data, openMain, rootCls], host);
                }
                ood.tryF(callback);
            }).start();
        };

    if (onOK1) openRoot(projectName, onOK1, onOK2, callback, host, openMain);
    else if (onOK2) openCls(projectName, null, onOK2, callback, host, openMain);
};


CONF.showToolBox = function (show) {
    if (show) {
        if (CONF._toolbox) {
            CONF._toolbox.show();
        } else {
            CONF._toolbox = ood.showCom("RAD.ToolBox");
        }
    } else {
        if (CONF._toolbo) CONF._toolbox.hide();
    }
};
CONF.callService = function (query, onSuccess, onFail, threadid, options, observable) {
    var request;
    request = function () {
        var args = ood.toArr(arguments);

        args.unshift(CONF.remoteService);
        return ood.request.apply(ood, args);
    };

    if (!options) options = {};
    var token = ood.Cookies.get('access_token') || '';
    if (token) {
        options.exData = {access_token: token};
    }
    options.beforeSuccess = function (response, rspType) {
        if (response && response.error && (response.error.code + "") == "-100") {
            window.onbeforeunload = null;
            window.location = CONF.loginPage;
        }
    };

    if (!observable)
        request(query, onSuccess, onFail, threadid, options);
    else
        ood.observableRun(function (threadid) {
            request(query, onSuccess, onFail, threadid, options);
        }, null, threadid);
};
CONF.mapServerPath = function (path) {
    return path;
};


CONF.getLocalFile = function (path, onSuccess, onFail, sync) {

    ood.Ajax(path, '', onSuccess, onFail, null, {rspType: "text", asy: !sync}).start();
};
CONF.downloadFile = function (params, onSuccess, onFail, threadid, options, observable) {
    request = function () {
        var args = ood.toArr(arguments);
        args.unshift(CONF.remoteService);
        args.curProjectPath = SPA.curProjectPath;
        return ood.XDMI.apply(ood.IAjax, args).start();
    };

    if (!observable)
        request(query, onSuccess, onFail, threadid, options);
    else
        ood.observableRun(function (threadid) {
            request(query, onSuccess, onFail, threadid, options);
        }, null, threadid);

};

CONF.debugApp = function (appPath, debugFile, data, newinstance, method, uselocalfile) {
    data = data || {};
    data.dir = appPath;
    data.debug = 1;

    var url = appPath + debugFile;

    if (method == 'post')
        ood.Dom.submit(url, data, method);
    else {
        var hash = '';
        if (data) hash = '?' + ood.urlEncode(data);
        ood.Dom.submit(url + hash);
    }
};
CONF.openAPI = function (para) {
    ood.Dom.submit(CONF.getAPIPath() + '#!' + (para || ""));

};
CONF.openJSONEditor = function () {
    CONF.openURL("http://www.itjds.net/JSONEditor");
};
CONF.previewPage2 = function (SPA, path) {
    var code = SPA.getJSONCode(SPA.getAllWidgets()), size = SPA.getViewSize();
    code = code.replace(/^ood.create\(/, '');
    code = code.replace(/\)\.get\(\);$/, '');
    window.__classCode = code;
    if (window.__preview) {
        window.__preview.opener = null;
        window.__preview.close();
        window.__preview = void(0);
    }
    window.__preview = window.open((path || "preview.html") + "#" + ood.urlEncode({
        rand: ood.rand(),
        theme: SPA.$curTheme || 'default',
        lang: ood.getLang()
    }), "preview", "height=" + size.height + ",width=" + size.width + ",toolbar=no,menubar=no,scrollbars=yes, resizable=yes,location=no,status=no,center=yes");
}
CONF.openURL = function (url) {
    ood.Dom.submit(url);
};
CONF.openFile = function (url) {
    ood.Dom.submit(url);
};


CONF.saveAS = function (path, hash, method) {
    var ifrid = 'ifr_for_download';
    if (!ood.Dom.byId(ifrid))
        ood('body').append(ood.create('<iframe id="' + ifrid + '" name="' + ifrid + '" style="display:none;"/>'));
    ood.Dom.submit(path, hash, method, ifrid);

};


CONF.saveFiles = function (collections) {
    var hash = {};
    ood.each(collections, function (o) {
        ood.Ajax(CONF.saveFile, o.paras, o.onSuccess, o.onFail,
            null, {
                rspType: 'json',
                method: 'POST'
            }).start();
    });
};

// for local file in browser
CONF.adjustProtocol = function (path) {
    return path;
};
CONF.adjustFileAbsPath = function (path) {
    return "/" + SPA.curProjectName + "/" + path;
}

CONF.getPrjPath = function (path, encode) {
    var exepath = ood.ini.appPath;

    if (encode) {
        path = encodeURI(path).replace(/\(/g, escape("(")).replace(/\)/g, escape(")"))
        exepath = encodeURI(exepath).replace(/\(/g, escape("(")).replace(/\)/g, escape(")"));
    }
    if (ood.str.startWith(path, exepath)) {
        return path;
    } else {
        return exepath + path;
    }
};
CONF.isZipURL = function (url) {
    return (new RegExp(
        '^((https|http|ftp|rtsp|mms)?://)'
        + '?(([0-9a-z_!~*\'().&=+$%-]+: )?[0-9a-z_!~*\'().&=+$%-]+@)?' //ftp user@
        + '(([0-9]{1,3}.){3}[0-9]{1,3}' // IP URL- 199.194.52.184
        + '|' //  IP or DOMAIN
        + '([0-9a-z_!~*\'()-]+.)*' // - www.
        + '([0-9a-z][0-9a-z-]{0,61})?[0-9a-z].' // sub domain
        + '[a-z]{2,6})' // first level domain- .com or .museum
        + '(:[0-9]{1,4})?' // port- :80
        + '((/?)|' // a slash isn't required if there is no file name
        + '(/[0-9a-z_\\[\\]!~*\'().;?:@&=+$,%#-]+)+/?)$'
    )).test(url.toLowerCase()) && /\.zip$/i.test(url);
};
CONF.isURL = function (url) {
    return /^(?:(?:https?|ftp):\/\/)(?:\S+(?::\S*)?@)?(?:(?!(?:10|127)(?:\.\d{1,3}){3})(?!(?:169\.254|192\.168)(?:\.\d{1,3}){2})(?!172\.(?:1[6-9]|2\d|3[0-1])(?:\.\d{1,3}){2})(?:[1-9]\d?|1\d\d|2[01]\d|22[0-3])(?:\.(?:1?\d{1,2}|2[0-4]\d|25[0-5])){2}(?:\.(?:[1-9]\d?|1\d\d|2[0-4]\d|25[0-4]))|(?:(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)(?:\.(?:[a-z\u00a1-\uffff0-9]-*)*[a-z\u00a1-\uffff0-9]+)*(?:\.(?:[a-z\u00a1-\uffff]{2,}))\.?)(?::\d{2,5})?(?:[/?#]\S*)?$/i.test(url.toLowerCase());
};

CONF.saveStatus = function (obj, filename) {
    filename = CONF.mapServerPath(filename || "status.json");
    ood.Cookies.set(filename, ood.serialize(obj), 100);
};
CONF.getStatus = function (filename) {
    filename = CONF.mapServerPath(filename || "status.json");
    var str = ood.Cookies.get(filename);
    return ood.unserialize(str) || {};
};
CONF.setWidgetDftTheme = function (cls, theme, all) {
    var clsObj = ood.SC(cls);
    if (clsObj) {
        CONF.WidgetDftTheme = CONF.WidgetDftTheme || {};
        CONF.WidgetDftTheme[cls] = theme;
        var nodes = [];
        clsObj.getAll().each(function (prf) {
            if (prf.$inDesign && (all || !prf.theme)) {
                nodes.push(prf);
            }
        });
        if (nodes.length)
            clsObj.pack(nodes).setTheme(theme);
    }
};
(function () {
    // codemirror mode
    var codemirror_map = {
        'APL': "as3 asf",
        'Asterisk': "agi",
        'C': "c",
        'C++': "cpp cp cxx c__",
        'Cobol': "cbl cob cobol cpy",
        'Java': "j jav java mash",
        'C#': "c# cs csx",
        'Scala': "scala sca scb",
        'Clojure': "clj",
        'CoffeeScript': "coffee",
        'Common Lisp': "cl gc3 gcl kcl",
        'Cypher': "cyp",
        'CSS': "css styl",
        'D': "d",
        'diff': "diff dif",
        'DTD': "dtd",
        'Dylan': "Dylan",
        'ECL': "ecl",
        'Eiffel': "e",
        'Erlang': "erl",
        'Fortran': "f f77 f90 f95 for fpp ftn hpf mod lng",
        'F#': "mli fsscript fsx",
        'Gas': "gas",
        'Gherkin': "feature",
        'GitHub Flavored Markdown': "gfm",
        'Go': "go",
        'Groovy': "Groovy",
        'HAML': "haml",
        'Haskell': "hs has lhs gs lit",
        'Haxe': "hx",
        'ASP.NET': "aspx asp+ asax armx",
        'Embedded Javascript': "ejs",
        'JavaServer Pages': "jsp",
        'HTML': "hhs hlm ht3 htm html html5 htmls uhtml adiumhtmllog nclk hhc xhtm",
        'HTTP': "cgx",
        'Jade': "Jade",
        'JavaScript': 'js jsfl jsxinc hbs vv module cls',
        'JSON': "json jsonp",
        'TypeScript': "ts",
        'Julia': "julia",
        'Julia2': "julia2",
        'LESS': "less",
        'LiveScript': "ls",
        'Lua': "lua luca",
        'Markdown (GitHub-flavour)': "md markdown",
        'mIRC': "mrc",
        "Mathematica": "m nb",
        "Modelica": "mo",
        "MUMPS": "mps",
        "mbox": "mbox",
        'Nginx': "nginx",
        'NTriples': "nt",
        'OCaml': "ml",
        'Octave': "m",
        'Pascal': "dfm dpk dpr p pp tpx vpi",
        'PEG.js': "pegjs",
        'Perl': "cgi Perl ph ipb m2r pdl pl pls plx pm prl",
        'PHP': "ctp phl mod php php1 php2 php3 php4 php5 phps phpt phs inc",
        'PHP(HTML)': "phtml",
        'Pig': "pig",
        'Plain Text': "$00 $01 $02 $04 $05 $o1 $ol 001 12da 1st 7 82t 92t abl ac adiumlog adl adt adw aiml alx aml android annot ans ansi application aprj aqt ass awd awh awp axt ba1 bad bas bbs bbxt bcr bdp bdr bea bel bep big big5 bk blm bln blw bmtp bna bnx bog box box bpdx brf bsdl bss bt bzw cag cas cascii cc cd2 charset cho chord cif cil ckn clg cli clix cmd cmtx cof conf coo crash crd cs csassembly csmanifest csv ctd ctf ctl ctl ctx dat dcd dce ddd ddt de dectest des desc dfe dii diskdefines diz dk dkz dmr dne dok dp dpv dqy drp dsc dsml dtd dwl ecsv edml edt efm eia emulecollection en enc enf eng err es esw etf etx euc ext extra faq fff ffp fin first flr fmr fnx fon fr fra frm fsa full gbf gdt gen ger gnu gpl gs gthr gtx guide hdr hlx hp8 hs hsk htx hvc hwl hz id31 id32 idc idt idx iem igv igy iif ill inc inc inc ini inuse ion ion ipr iqy isr it ivp ja jad jam jeb jis jp1 jss jtx kahl kar kch kix klg kor la label las lay lin linux linx lisp lnc log lo_ lrc lst ltr ltt ltx lue luf lwd lyr lyt man manifest map mar markdown mathml maxFR mcw md mdl mdle mdown mdtext mdtxt mdwn me mez mf mib mit mkd mkdn mno mnu modd mpsub mss mtx mtx mtxt mvg mw nbr ncm new nfo nlc nmbd nokogiri not notes now npdt nt nwctxt ocr odc oh ojp omn oogl oot opc openbsd opml ort osi p3x panic pbd pc5 pcl pd pdu pfs pgw pjs pla pla plf plg plk pln pml pmo pod prc prn pro prr ps psb psi2 pt3 pts pvj pvw q&a qdt qud rbdf rdf rea readme reg rel rep resp rest rff ris rml rqy rst rt rtf rtl rtx ru rus rzk rzn s19 s2k sami sbv sct sdnf sen seq set sfb sgp sha1 sha512 skcard skv sls smali smf smi sms snw soap soundscript spa spec spg spn spx srt srt ssa ssf st1 stf stq strings sub syn t t2t tab tbd tbl tbx tce tcm tdf ted text text text textclipping tfw tgf thml thp tlb tle tlx tlx tm tml tmprtf tmx tnef tph tpl trn trt tsv tt ttbl tte ttf ttpl ttxt tx8 tx? txa txa txd txe txh txt txt txt u3i uax uk unauth uni unx us usa user usf usg utf8 utx utxt ver vet vfk vhd vhdl vis vkp vmg vna vsmproj vw vw3 wer wir wkf wn wrd wrl wsc wsf wsh wst wtf wtl wtx x20 x60 x70 x80 x90 xb0 xc0 xct xd0 xff xht xlf xsr xwp xwp xy: xy3 xyp xyw xyz zanebug zed zhp zib zw zxe _me",
        'Properties files': "properties",
        'Python': "py pyw rpy pyx",
        'Puppet': "Puppet",
        'R': "r",
        'reStructuredText': "rst rest",
        'Ruby': "irbrc rb rbw rbx",
        'Rust': "rust",
        'Sass': "Sass",
        'Scheme': "fasl lap scm smd ss",
        'SCSS': "scss",
        'Shell': "bash bsh csh sh ksh ucsh psc1 psc2 psm1",
        'Sieve': "sieve",
        'Smalltalk': "st",
        'Solr': "solr",
        'SPARQL': "srx",
        'SQL': 'db2 eql sql',
        'sTeX': "stex",
        'SystemVerilog': "verilog",
        'Tcl': "glf tcl itcl rvt",
        'TiddlyWiki': "tiddlywiki",
        'Tiki wiki': "tiki",
        'TOML': "toml",
        'Turtle': "turtle",
        'VB.NET': "vb vbx aspx",
        'VBScript': "vba dvb vbi vbs vbscript",
        'Verilog': "v",
        XML: "apx arxml bxml ccxml cxe cxs dxl mlsxml vxml lxfml plist vxml xdl xdp xfd xml xsd xsl xslt yml wxs ptxml pxml txml",
        'XQuery': "xq xquery",
        'YAML': "yaml",
        'Z80': "Z80"
    };
    var codemirror_hash;
    CONF.getRenderMode = function (key) {
        if (!codemirror_hash) {
            codemirror_hash = {};
            ood.each(codemirror_map, function (o, i) {
                var index = ood.arr.subIndexOf(CodeMirror.modeInfo, "name", i);
                if (index != -1) {
                    var mode = CodeMirror.modeInfo[index];
                    ood.arr.each(o.split(' '), function (k) {
                        codemirror_hash[k.toLowerCase()] = mode;
                    });
                }
            });
        }
        return CodeMirror.findModeByExtension(key) || codemirror_hash[key];
    };
    CONF.getImageTag = function (ext, ood) {
        var imagePos, mime;
        if (ext.indexOf(".") != -1) {
            var filearr = ext.split(".");
            ext = filearr[filearr.length - 1];
        }
        ext = ext.toLowerCase();

        if (ood) {
            imagePos = "ri-file-list-line";
        } else {
            switch (ext) {
                case 'html':
                case 'htm':
                    imagePos = 'ri-html5-line';
                    break;
                case 'css':
                    imagePos = 'ri-css3-line';
                    break;
                case 'js':
                    imagePos = 'ri-javascript-line';
                    break;
                case 'cls':
                    imagePos = 'ri-file-list-line';
                    break;
                case 'json':
                    imagePos = 'ri-braces-line';
                    break;
                case 'xml':
                    imagePos = 'ri-code-line';
                    break;
                case 'swf':
                case 'fla':
                case 'flv':
                    imagePos = 'ri-movie-line';
                    break;
                    break;
                case 'jpg':
                case 'png':
                case 'gif':
                case 'bmp':
                    imagePos = 'ri-image-line';
                    break;
                default:
                    if (mime) {
                        if (mime == "audio") {
                            imagePos = 'ri-music-line';
                        } else if (mime == "video") {
                            imagePos = 'ri-video-line';
                        } else if (mime == "image") {
                            imagePos = 'ri-image-line';
                        } else if (mime == "application") {
                            imagePos = 'ri-apps-line';
                        }
                    }
                    if (!imagePos) {
                        var mode = CONF.getRenderMode(ext);
                        if (mode) {
                            imagePos = mode.mode == "null" ? 'ri-file-damage-line' : "ri-file-line";
                        } else
                            imagePos = 'ri-question-line';
                    }
            }
        }
        return imagePos;
    };
}());

(function () {
    var m = CONF.mixed_prop = {},
        n = CONF.widgets_itemsProp,
        t = n.items,
        k, h;
    for (var i in t) {
        h = {};
        k = t[i].header;
        for (var j = 0, l = k.length; j < l; j++)
            h[k[j].id || k[j]] = "";
        m[i.replace(/\./g, "_") + "_item"] = h;
    }
    k = n.header['ood.UI.TreeGrid'].header;
    h = {};
    for (var j = 0, l = k.length; j < l; j++)
        h[k[j].id] = "";
    m["ood_UI_TreeGrid_col"] = h;

    k = n.rows['ood.UI.TreeGrid'].header;
    h = {};
    for (var j = 0, l = k.length; j < l; j++)
        h[k[j].id] = "";
    m["ood_UI_TreeGrid_row"] = h;

    k = n.rows['ood.UI.TreeGrid'].subheader;
    h = {};
    for (var j = 0, l = k.length; j < l; j++)
        h[k[j].id] = "";
    m["ood_UI_TreeGrid_cell"] = h;
}());




﻿﻿new function () {
    if (!window.CONF) window.CONF = {};
    ood.merge(window.CONF, {
        items: [{id: 'a', caption: 'item 1', imageClass: 'ri-number-1'}, {
            id: 'b',
            caption: 'item 2',
            imageClass: 'ri-number-2'
        }, {id: 'c', caption: 'item 3', imageClass: 'ri-number-3'}, {
            id: 'd',
            caption: 'item 4',
            imageClass: 'ri-number-4',
            disabled: true
        }],
        items2: [{id: 'a', caption: 'status 1'}, {id: 'b', caption: 'status 2'}, {
            id: 'c',
            caption: 'status 3'
        }, {id: 'd', caption: 'status 4'}],
        items3: [{id: 'a', caption: 'page1', imageClass: CONF.img_class}, {id: 'b', caption: 'page2'}, {
            id: 'c',
            caption: 'page3'
        }, {id: 'd', caption: 'page4', closeBtn: true, optBtn: 'ood-uicmd-opt', popBtn: true}]
    }, 'all');

    // To hide widgets / prop / event
    ood.merge(window.CONF, {
        // To hide widgets in the left Tool Box region
        widgets_hidden: {},
        widgets_hidden_filter: null,// function(ctrlKey){return false;}

        // To hide prop in the right Component Config region
        widgets_hiddenProps: {},
        widgets_hiddenProps_filter: function (ctrlKey, propKey, target) {
            var p = ood.get(target.properties, ['$hiddenProp']) || ood.get(target.properties.tagVar, ['$hiddenProp']);
            if (p && p[propKey])
                return false;
        },

        // To hide events in the right Component Config region
        widgets_hiddenEvents: {
            "beforePrepareItem": 1,
            "beforePrepareRow": 1,
            "beforePrepareCol": 1
        },
        widgets_hiddenEvents_filter: function (ctrlKey, propKey, target) {
            if (!target) {
                return false;
            }
            var p = ood.get(target.properties, ['$hiddenEvents']) || ood.get(target.properties.tagVar, ['$hiddenEvents']);
            if (p && p[propKey]) {
                return false;
            }
        },
        page_hiddenPropEvents: {},
        page_hiddenPropEvents_filter: null
    }, 'all');



// To set tips for widgets in the left Tool Box
    (function (items, hash) {
        var self = arguments.callee;
        ood.arr.each(items, function (o) {
            hash[o.id] = o;
            if (o.sub && o.sub.length) {
                self(o.sub, hash);
                //  o.tips = "$RAD.designer.openwidgets";
                o.tips = o.caption || "$RAD.designer.openwidgets";
            } else if (o.key && ood.str.startWith(o.key, 'ood.svg')) {
                o.tips = "<div class='ood-uiborder-b' style='padding:4px'>" + o.caption + "</div><div style='text-align:right'><em>$RAD.designer.dragwidget2</em></div>";
            } else
                o.tips = "<div class='ood-uiborder-b' style='padding:4px'>" + o.caption + "</div><div style='text-align:right'><em>$RAD.designer.dragwidget1</em></div>";
        });
    }(CONF.widgets, CONF.mapWidgets = {}));

    CONF.mapWidgets = {
        "ood.UI.PopMenu": {imageClass: "ri-more-fill"},
        "ood.DataBinder": {imageClass: "ri-link"},
        "ood.Timer": {imageClass: "ri-timer-line"},
        "ood.AnimBinder": {imageClass: "ri-movie-line"},
        'ood.APICaller': {imageClass: 'ri ri-cloud-line'},
        'ood.MessageService': {imageClass: 'ri ri-repeat-line'},
        'ood.MQTT': {imageClass: 'ri ri-rss-line',}
    };
}
new function () {
    if (!window.CONF) window.CONF = {};
    ood.merge(window.CONF, {

        tompmenu: [
                {
                    id: 'file',
                    caption: "文件(F)",
                    sub: [
                        {
                            id: 'newfile',
                            caption: "新建文件",
                            iconColor: '#777777',
                            imageClass: 'ri-file-add-line',
                            tips: '创建新文件'
                        },
                        {
                            id: 'openfile',
                            caption: "打开文件",
                            imageClass: 'ri-folder-open-line',
                            tips: '打开现有文件'
                        },
                        {type: 'split'},
                        {
                            id: 'save',
                            caption: "保存",
                            iconColor: '#777777',
                            imageClass: 'ri-save-line',
                            tips: '保存当前文件'
                        },
                        {
                            id: 'saveall',
                            caption: "保存所有",
                            imageClass: 'ri-save-fill',
                            tips: '保存所有打开的文件'
                        },
                        {type: 'split'},
                        {
                            id: 'close',
                            caption: "关闭",
                            imageClass: 'ri-close-line',
                            tips: '关闭当前文件'
                        },
                        {
                            id: 'closeall',
                            caption: "关闭所有",
                            imageClass: 'ri-close-circle-line',
                            tips: '关闭所有文件'
                        }
                    ]
                },
                {
                    id: 'edit',
                    caption: "编辑(E)",
                    sub: [
                        {
                            id: 'undo',
                            caption: "撤销",
                            imageClass: 'ri-arrow-go-back-line',
                            tips: '撤销上一步操作'
                        },
                        {
                            id: 'redo',
                            caption: "重做",
                            imageClass: 'ri-arrow-go-forward-line',
                            tips: '重做上一步操作'
                        },
                        {type: 'split'},
                        {
                            id: 'cut',
                            caption: "剪切",
                            imageClass: 'ri-scissors-line',
                            tips: '剪切选中内容'
                        },
                        {
                            id: 'copy',
                            caption: "复制",
                            imageClass: 'ri-file-copy-line',
                            tips: '复制选中内容'
                        },
                        {
                            id: 'paste',
                            caption: "粘贴",
                            imageClass: 'ri-clipboard-line',
                            tips: '粘贴内容'
                        }
                    ]
                },
                {
                    id: 'view',
                    caption: "视图(V)",
                    sub: [
                        {
                            id: 'explorer',
                            caption: "资源管理器",
                            imageClass: 'ri-folder-line',
                            tips: '显示/隐藏资源管理器'
                        },
                        {
                            id: 'terminal',
                            caption: "终端",
                            imageClass: 'ri-terminal-line',
                            tips: '显示/隐藏终端'
                        },
                        {
                            id: 'problems',
                            caption: "问题面板",
                            imageClass: 'ri-error-warning-line',
                            tips: '显示/隐藏问题面板'
                        },
                        {type: 'split'},
                        {
                            id: 'zoomIn',
                            caption: "放大",
                            imageClass: 'ri-zoom-in-line',
                            tips: '放大视图'
                        },
                        {
                            id: 'zoomOut',
                            caption: "缩小",
                            imageClass: 'ri-zoom-out-line',
                            tips: '缩小视图'
                        },
                        {
                            id: 'resetZoom',
                            caption: "重置缩放",
                            imageClass: 'ri-zoom-in-line',
                            tips: '重置视图缩放'
                        }
                    ]
                },
                {
                    id: 'tools',
                    caption: "工具(T)",
                    sub: [
                        {
                            id: 'build',
                            caption: "构建项目",
                            imageClass: 'ri-hammer-line',
                            tips: '构建当前项目'
                        },
                        {
                            id: 'run',
                            caption: "运行项目",
                            imageClass: 'ri-play-line',
                            tips: '运行当前项目'
                        },
                        {type: 'split'},
                        {
                            id: 'debug',
                            caption: "调试",
                            imageClass: 'ri-bug-line',
                            tips: '启动调试模式'
                        },
                        {
                            id: 'test',
                            caption: "测试",
                            imageClass: 'ri-flask-line',
                            tips: '运行测试'
                        }
                    ]
                },
                {
                    id: 'help',
                    caption: "帮助(H)",
                    sub: [
                        {
                            id: 'documentation',
                            caption: "文档",
                            imageClass: 'ri-book-line',
                            tips: '查看帮助文档'
                        },
                        {
                            id: 'about',
                            caption: "关于",
                            imageClass: 'ri-information-line',
                            tips: '关于CodeBuddy CN'
                        }
                    ]
                },
                {
                    id: 'resourceManager',
                    caption: '资源管理(E)',
                    sub: [
                        {
                            id: 'csstool',
                            caption: '图标字体',
                            color: "#777777"
                        },
                        {type: 'split'},
                        {id: 'localicon', caption: '导入图标', imageClass: "ri-file-code-line"},
                        {id: 'iconfont.cn', caption: '阿里站点', imageClass: 'ri-video-line'},
                        {type: 'split'},
                        {
                            id: 'imgtool', iconColor: '#777777', caption: '图片库', imageClass: "ri-image-line"
                        },
                        {type: 'split'},
                        {id: 'imgmanager', caption: '图片维护', imageClass: "ri-brush-line"},
                        {id: 'imgimport', caption: '导入图片', imageClass: "ri-file-code-line"},
                        {type: 'split'},
                        {id: 'serviceImport', caption: '服务导入'},
                        {id: 'serviceManager', caption: '服务维护'},
                        {type: 'split'},
                        {
                            id: 'mangager',
                            add: '',
                            iconColor: '#777777',
                            caption: '数据库',
                            imageClass: "ri-database-2-line"
                        },
                        {type: 'split'},
                        {id: 'DBProviderList', caption: '数据源', imageClass: 'ri-database-2-line'},
                        {id: 'importTable', caption: '导入库表', imageClass: 'ri-upload-line'},
                        {id: 'SqlConsole', caption: '数据库监控', imageClass: "ri-bar-chart-line"}
                    ]
                },
                {
                    id: 'releasegroup',
                    add: '', caption: '服务器(S)',
                    sub: [
                        {
                            id: 'server', add: '', caption: '服务器', iconColor: '#777777', imageClass: "ri-server-line"
                        },
                        {type: 'split'},
                        {id: 'RemoteServerList', caption: '远程配置', imageClass: "ri-plug-line"},
                        {id: 'ProxyHostList', caption: '代理配置', imageClass: "ri-server-line"},
                        {type: 'split'},
                        {
                            id: 'startServer',
                            caption: "启动服务",
                            imageClass: 'ri-play-line',
                            tips: '启动服务器'
                        },
                        {
                            id: "stopServer",
                            caption: "关闭服务",
                            imageClass: "ri-stop-line",
                            tips: "关闭服务器"
                        },
                        {type: 'split'},
                        {id: 'ESDServerList', caption: '服务配置', imageClass: "ri-cpu-line"}
                    ]
                }
            ],
            tompmenu: [
                {
                    id: 'file',
                    caption: "文件(F)",
                    sub: [
                        {
                            id: 'save',
                            caption: "保存",
                            iconColor: '#777777',
                            imageClass: 'ri-save-line',
                            tips: '$RAD.tool.save'
                        }, {
                            id: 'saveall',
                            caption: "保存所有",
                            imageClass: 'ri-save-fill',
                            tips: '$RAD.tool.saveall'
                        },

                        {type: 'split'},

                        {
                            id: 'closeall',
                            itemStyle: "width:120px",
                            caption: "关闭所有",
                            imageClass: 'ri-close-circle-line',
                            tips: '关闭所有l'
                        },

                        {type: 'split'},

                        {
                            id: 'setproject',
                            caption: "工程配置",
                            iconColor: '#777777',
                           // imageClass: 'ri-settings-3-line',
                            tips: '$(RAD.menu.Project Setting)',
                            sub: [
                                {
                                    id: 'newProject',
                                    caption: '$(RAD.esdmenu.newProject)'
                                },
                                {
                                    id: 'openProject', caption: '$(RAD.esdmenu.openProject)'
                                }, {
                                    id: 'theme',
                                    caption: "皮肤样式",
                                    dropButton: true,
                                    imageClass: 'ri ri-palette-line',
                                    tips: '$RAD.builder.dftThemeTips'
                                },
                                {id: 'ec', caption: "切换语言", tips: '$RAD.tool.ec'}
                            ]
                        },
                    ]
                },


                {
                    id: 'resourceManager',
                    caption: '资源管理(E)',
                    sub: [
                        {
                            id: 'csstool',
                            caption: '图标字体',
                            color: "#777777",
                         //   imageClass: "ri ri-font-size-2"
                        },
                        {type: 'split'},
                        {id: 'localicon', caption: '导入图标', imageClass: "ri ri-file-code-line"},
                        {id: 'iconfont.cn', caption: '阿里站点', imageClass: 'ri ri-video-line'},
                        {type: 'split'},
                        {
                            id: 'imgtool', iconColor: '#777777', caption: '图片库', image: "ri ri-image-line"
                        },
                        {type: 'split'},
                        {id: 'imgmanager', caption: '图片维护', imageClass: "ri ri-brush-line"},
                        {id: 'imgimport', caption: '导入图片', imageClass: "ri ri-file-code-line"},
                        {type: 'split'},
                        {id: 'serviceImport', caption: '服务导入'},
                        {id: 'serviceManager', caption: '服务维护'},
                        {type: 'split'},
                        {
                            id: 'mangager',
                            add: '',
                            iconColor: '#777777',
                            caption: '数据库',
                            imageClass: "ri ri-database-2-line"
                        },
                        {type: 'split'},
                        {id: 'DBProviderList', caption: '数据源', imageClass: 'ri ri-database-2-line'},
                        {id: 'importTable', caption: '导入库表', imageClass: 'ri ri-upload-line'},
                        {id: 'SqlConsole', caption: '数据库监控', imageClass: "ri ri-bar-chart-line"}
                    ]
                },


                {
                    id: 'releasegroup',
                    add: '', caption: '服务器(S)',
                    sub: [
                        {
                            id: 'server', add: '', caption: '服务器', iconColor: '#777777', imageClass: "ri ri-server-line"

                        },

                        {type: 'split'},
                        {id: 'RemoteServerList', caption: '远程配置', imageClass: "ri ri-plug-line"},
                        {id: 'ProxyHostList', caption: '代理配置', imageClass: "ri ri-server-line"},
                        {type: 'split'},
                        {
                            id: 'startServer',
                            caption: "启动服务",

                            imageClass: 'ri ri-play-line',
                            tips: '$(RAD.esdmenu.startSrver)'
                        },
                        {
                            id: "stopServer",
                            caption: "关闭服务",

                            imageClass: "ri ri-stop-line",
                            "tips": "$(RAD.esdmenu.stopServer)"
                        },
                        {type: 'split'},

                        {id: 'ESDServerList', caption: '服务配置', imageClass: "ri ri-cpu-line"}

                    ]
                }
            ]

        }
    )
    ;


    ood.merge(window.CONF, {

            SPATomMenu: function () {
                var spaMenu = [

                    {
                        id: 'file', add: '', caption: '$RAD.menu.file',
                        sub: CONF.toolbarItems
                    },

                    // { 原有注释部分保持不变 },

                    {
                        id: 'tools', caption: '$RAD.menu.tools', sub: CONF.tools
                    },


                    {
                        id: 'expression', add: '', caption: '切面公式',
                        server: {
                            baseUrl: "/action/spatoolbar/Formula",
                            params: {
                                "engineType": 'CUSTOM',
                                "currentClassName": SPA.getCurrentClassName()
                            },
                        }

                    },
                    // { 原有注释部分保持不变 },
                    {
                        id: 'oneStart', caption: '快速开始', sub: CONF.oneStart
                    },
                    {
                        id: 'serverConfig', caption: '服务配置', sub: CONF.serverConfig
                    }
                    // { 原有注释部分保持不变 },
                    ,
                    {
                        id: 'plugins', add: '', caption: '插件',
                        plugins: {
                            baseUrl: "/action/spatoolbar/getPluginBar",
                            params: {menuType: 'TOP'},
                        }

                    }

                    ,
                    {
                        id: 'dsmplugin', add: '', caption: '领域插件',
                        plugins: {
                            baseUrl: "/action/spatoolbar/getComponentBar",
                            params: {menuType: 'COMPONENT'},
                        }

                    }

                ]
                return spaMenu;
            }
        }
    );


    ood.merge(window.CONF, {
        projecttool: [{
            id: 'any', sub: [
                {id: 'refresh', imageClass: 'ri ri-refresh-line', caption: '', tips: '$RAD.tool2.refresh'},
                {id: 'del2', imageClass: 'ri ri-subtract-line', caption: '', tips: '$RAD.tool2.del2'},
                {
                    id: 'themeToggle',
                    imageClass: 'ri ri-palette-line',
                    caption: '',
                    tips: '$RAD.builder.dftThemeTips'
                },
                {
                    id: 'copy2',
                    hidden: true,
                    imageClass: 'ri ri-file-copy-line',
                    caption: '',
                    tips: '$RAD.tool2.copy2'
                },
                {
                    id: 'paste',
                    hidden: true,
                    imageClass: 'ri ri-file-copy-line',
                    caption: '$RAD.esdmenu.paste',
                    tips: '$RAD.esdmenu.paste'
                },

                {
                    id: 'newClass',
                    imageClass: 'ri ri-add-line',
                    caption: '',
                    tips: '$RAD.esdmenu.newClass'
                },

                {
                    id: 'newFolder',
                    imageClass: 'ri ri-folder-line',
                    caption: '',
                    tips: '$RAD.esdmenu.newFolder'
                },

                {
                    id: 'upload',
                    imageClass: 'ri ri-file-line',
                    caption: '',
                    tips: '$RAD.esdmenu.upload'
                },

                {
                    id: 'rename',
                    hidden: true,
                    imageClass: 'ri ri-edit-2-line',
                    caption: '',
                    tips: '$RAD.tool2.modify'
                }
            ]
        },
            {
                id: 'editastext',
                hidden: true,
                imageClass: 'ri ri-code-line',
                caption: '',
                tips: '$RAD.tool2.editastext'
            }
        ]
    })

}
;
﻿// for version 3.6
window.FCCONF = {
    gridAttr: {
        numVisiblePlot: {type: "spin", precision: 2, increment: 0.1, min: 2, max: 100},
        animate3D: {type: "checkbox"},
        animation: {type: "checkbox"},
        exeTime: {type: "spin", precision: 2, increment: 0.1, min: 0, max: 10},
        palette: {type: "spin", precision: 0, increment: 1, min: 1, max: 5},
        paletteThemeColor: {type: "color"},
        annRenderDelay: {type: "spin", precision: 0, increment: 1, min: 0, max: 5000},
        showPrintMenuItem: {type: "checkbox"},
        manageResize: {type: "checkbox"},
        paletteColors: {type: "input"},
        showRTMenuItem: {type: "checkbox"},
        showAboutMenuItem: {type: "checkbox"},
        refreshInstantly: {type: "checkbox"},
        aboutMenuItemLabel: {type: "input"},
        aboutMenuItemLink: {type: "input"},
        clipBubbles: {type: "checkbox"},
        negativeColor: {type: "color"},
        bubbleScale: {type: "checkbox"},
        connectNullData: {type: "checkbox"},
        areaOverColumns: {type: "checkbox"},
        showLabels: {type: "checkbox"},
        showLabelsAtCenter: {type: "checkbox"},
        maxLabelHeight: {type: "spin", precision: 0, increment: 1, min: 0},
        labelDisplay: {type: "listbox", editorListItems: ["", "AUTO", "WRAP", "STAGGER", "ROTATE", "NONE"]},
        useEllipsesWhenOverflow: {type: "checkbox"},
        rotateLabels: {type: "checkbox"},
        slantLabels: {type: "checkbox"},
        labelStep: {type: "spin", precision: 0, increment: 1, min: 1},
        xAxisLabelMode: {type: "listbox", editorListItems: ["", "AUTO", "CATEGORIES", "MIXED"]},
        maxLabelWidthPercent: {type: "spin", precision: 0, increment: 1, min: 1, max: 100},
        staggerLines: {type: "spin", precision: 0, increment: 1, min: 2},
        autoScale: {type: "checkbox"},
        origW: {type: "spin", precision: 0, increment: 1, min: 0},
        origH: {type: "spin", precision: 0, increment: 1, min: 0},
        valuePosition: {type: "listbox", editorListItems: ["", "ABOVE", "BELOW", "AUTO"]},
        rotateValues: {type: "checkbox"},
        placeValuesInside: {type: "checkbox"},
        showYAxisValues: {type: "checkbox"},
        showXAxisValues: {type: "checkbox"},
        showLimits: {type: "checkbox"},
        showVLimits: {type: "checkbox"},
        showDivLineValues: {type: "checkbox"},
        showVDivLineValues: {type: "checkbox"},
        showSecondaryLimits: {type: "checkbox"},
        showDivLineSecondaryValue: {type: "checkbox"},
        xAxisValuesStep: {type: "spin", precision: 0, increment: 1, min: 1},
        yAxisValuesStep: {type: "spin", precision: 0, increment: 1, min: 1},
        showShadow: {type: "checkbox"},
        adjustDiv: {type: "checkbox"},
        adjustVDiv: {type: "checkbox"},
        clickURL: {type: "input"},
        sYAxisMinValue: {type: "spin", precision: 0, increment: 1, min: 0},
        sYAxisMaxValue: {type: "spin", precision: 0, increment: 1, min: 0},
        setAdaptiveSYMin: {type: "checkbox"},
        setAdaptiveXMin: {type: "checkbox"},
        showRegressionLine: {type: "checkbox"},
        RegressionLineColor: {type: "color"},
        RegressionLineThickness: {type: "spin", precision: 0, increment: 1, min: 0, max: 5},
        RegressionLineAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        showYOnX: {type: "checkbox"},
        maxColWidth: {type: "spin", precision: 0, increment: 1, min: 0},
        showSum: {type: "checkbox"},
        usePercentDistribution: {type: "checkbox"},
        showXAxisPercentValues: {type: "checkbox"},
        use3DLighting: {type: "checkbox"},
        defaultAnimation: {type: "checkbox"},
        xAxisMinValue: {type: "spin", precision: 0, increment: 1, min: 0},
        xAxisMaxValue: {type: "spin", precision: 0, increment: 1, min: 0},
        yAxisMinValue: {type: "spin", precision: 0, increment: 1, min: 0},
        yAxisMaxValue: {type: "spin", precision: 0, increment: 1, min: 0},
        stack100Percent: {type: "checkbox"},
        setAdaptiveYMin: {type: "checkbox"},
        useDataPlotColorForLabels: {type: "checkbox"},
        scrollToEnd: {type: "checkbox"},
        syncAxisLimits: {type: "checkbox"},
        compactDataMode: {type: "checkbox"},
        dataSeparator: {type: "input", maxlength: 1},
        axis: {type: "listbox", editorListItems: ["", "linear", "log"]},
        logBase: {type: "spin", precision: 0, increment: 1, min: 1},
        dynamicAxis: {type: "checkbox"},
        divIntervalHints: {type: "input"},
        allowPinMode: {type: "checkbox"},
        numVisibleLabels: {type: "spin", precision: 0, increment: 1, min: 0},
        anchorMinRenderDistance: {type: "spin", precision: 0, increment: 1, min: 0},
        showVDivLines: {type: "checkbox"},
        displayStartIndex: {type: "spin", precision: 0, increment: 1, min: 0},
        displayEndIndex: {type: "spin", precision: 0, increment: 1, min: 0},
        drawToolbarButtons: {type: "checkbox"},
        pixelsPerPoint: {type: "spin", precision: 0, increment: 1, min: 0},
        numMinorLogDivLines: {type: "spin", precision: 0, increment: 1, min: 0},
        xAxisTickColor: {type: "color"},
        xAxisTickAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        xAxisTickThickness: {type: "spin", precision: 0, increment: 1, min: 0, max: 5},
        showZeroPies: {type: "checkbox"},
        showPercentValues: {type: "checkbox"},
        percentOfPrevious: {type: "checkbox"},
        showPercentInToolTip: {type: "checkbox"},
        labelSepChar: {type: "input", maxlength: 1},
        pYAxisMaxValue: {type: "spin", precision: 0, increment: 1, min: 0},
        pYAxisMinValue: {type: "spin", precision: 0, increment: 1, min: 0},
        showCumulativeLine: {type: "checkbox"},
        showLineValues: {type: "checkbox"},
        primaryAxisOnLeft: {type: "checkbox"},
        maxBarHeight: {type: "spin", precision: 0, increment: 1, min: 0},
        barDepth: {type: "spin", precision: 0, increment: 1, min: 0},
        use3DLineShift: {type: "checkbox"},
        streamlinedData: {type: "checkbox"},
        isHollow: {type: "checkbox"},
        useSameSlantAngle: {type: "checkbox"},
        funnelYScale: {type: "spin", precision: 0, increment: 1, min: 0, max: 40},
        pyramidYScale: {type: "spin", precision: 0, increment: 1, min: 0, max: 40},
        unescapeLinks: {type: "checkbox"},
        radarRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        captionAlignment: {type: "listbox", editorListItems: ["", "left", "center", "right"]},
        captionOnTop: {type: "checkbox"},
        captionFontSize: {type: "spin", precision: 0, increment: 1, min: 0, max: 256},
        subCaptionFontSize: {type: "spin", precision: 0, increment: 1, min: 0, max: 256},
        captionFont: {type: "helpinput", editorListItems: CONF.designer_data_fontfamily},
        subCaptionFont: {type: "helpinput", editorListItems: CONF.designer_data_fontfamily},
        captionFontColor: {type: "color"},
        subCaptionFontColor: {type: "color"},
        captionFontBold: {type: "checkbox"},
        subCaptionFontBold: {type: "checkbox"},
        alignCaptionWithCanvas: {type: "checkbox"},
        captionHorizontalPadding: {type: "spin", precision: 0, increment: 1, min: 0},
        xAxisNameFontColor: {type: "color"},
        xAxisNameFontSize: {type: "spin", precision: 0, increment: 1, min: 0, max: 256},
        xAxisNameFontBold: {type: "checkbox"},
        xAxisNameFontItalic: {type: "checkbox"},
        xAxisNameBgColor: {type: "color"},
        xAxisNameBorderColor: {type: "color"},
        xAxisNameAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        xAxisNameFontAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        xAxisNameBgAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        xAxisNameBorderAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        xAxisNameBorderPadding: {type: "spin", precision: 0, increment: 1, min: 0},
        xAxisNameBorderRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        xAxisNameBorderThickness: {type: "spin", precision: 0, increment: 1, min: 0, max: 5},
        xAxisNameBorderDashed: {type: "checkbox"},
        xAxisNameBorderDashLen: {type: "spin", precision: 0, increment: 1, min: 0},
        xAxisNameBorderDashGap: {type: "spin", precision: 0, increment: 1, min: 0},
        yAxisNameFont: {type: "helpinput", editorListItems: CONF.designer_data_fontfamily},
        yAxisNameFontColor: {type: "color"},
        yAxisNameFontSize: {type: "spin", precision: 0, increment: 1, min: 0, max: 256},
        yAxisNameFontBold: {type: "checkbox"},
        yAxisNameFontItalic: {type: "checkbox"},
        yAxisNameBgColor: {type: "color"},
        yAxisNameBorderColor: {type: "color"},
        yAxisNameAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        yAxisNameFontAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        yAxisNameBgAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        yAxisNameBorderAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        yAxisNameBorderPadding: {type: "spin", precision: 0, increment: 1, min: 0},
        yAxisNameBorderRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        yAxisNameBorderThickness: {type: "spin", precision: 0, increment: 1, min: 0, max: 5},
        yAxisNameBorderDashed: {type: "checkbox"},
        yAxisNameBorderDashLen: {type: "spin", precision: 0, increment: 1, min: 0},
        yAxisNameBorderDashGap: {type: "spin", precision: 0, increment: 1, min: 0},
        pYAxisNameFont: {type: "helpinput", editorListItems: CONF.designer_data_fontfamily},
        pYAxisNameFontColor: {type: "color"},
        pYAxisNameFontSize: {type: "spin", precision: 0, increment: 1, min: 0, max: 256},
        pYAxisNameFontBold: {type: "checkbox"},
        pYAxisNameFontItalic: {type: "checkbox"},
        pYAxisNameBgColor: {type: "color"},
        pYAxisNameBorderColor: {type: "color"},
        pYAxisNameAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        pYAxisNameFontAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        pYAxisNameBgAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        pYAxisNameBorderAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        pYAxisNameBorderPadding: {type: "spin", precision: 0, increment: 1, min: 0},
        pYAxisNameBorderRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        pYAxisNameBorderThickness: {type: "spin", precision: 0, increment: 1, min: 0, max: 5},
        pYAxisNameBorderDashed: {type: "checkbox"},
        pYAxisNameBorderDashLen: {type: "spin", precision: 0, increment: 1, min: 0},
        pYAxisNameBorderDashGap: {type: "spin", precision: 0, increment: 1, min: 0},
        sYAxisNameFont: {type: "helpinput", editorListItems: CONF.designer_data_fontfamily},
        sYAxisNameFontColor: {type: "color"},
        sYAxisNameFontSize: {type: "spin", precision: 0, increment: 1, min: 0, max: 256},
        sYAxisNameFontBold: {type: "checkbox"},
        sYAxisNameFontItalic: {type: "checkbox"},
        sYAxisNameBgColor: {type: "color"},
        sYAxisNameBorderColor: {type: "color"},
        sYAxisNameAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        sYAxisNameFontAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        sYAxisNameBgAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        sYAxisNameBorderAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        sYAxisNameBorderPadding: {type: "spin", precision: 0, increment: 1, min: 0},
        sYAxisNameBorderRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        sYAxisNameBorderThickness: {type: "spin", precision: 0, increment: 1, min: 0, max: 5},
        sYAxisNameBorderDashed: {type: "checkbox"},
        sYAxisNameBorderDashLen: {type: "spin", precision: 0, increment: 1, min: 0},
        sYAxisNameBorderDashGap: {type: "spin", precision: 0, increment: 1, min: 0},
        color: {type: "color"},
        caption: {type: "input"},
        subCaption: {type: "input"},
        xAxisName: {type: "input"},
        yAxisName: {type: "input"},
        centerYaxisName: {type: "checkbox"},
        centerXaxisName: {type: "checkbox"},
        rotateYAxisName: {type: "checkbox"},
        yAxisNameWidth: {type: "spin", precision: 0, increment: 1, min: 0},
        rotateXAxisName: {type: "checkbox"},
        xAxisNameWidth: {type: "spin", precision: 0, increment: 1, min: 0},
        sYAxisName: {type: "input"},
        pYAxisName: {type: "input"},
        pYAxisNameWidth: {type: "spin", precision: 0, increment: 1, min: 0},
        sYAxisNameWidth: {type: "spin", precision: 0, increment: 1, min: 0},
        bgColor: {type: "color"},
        bgAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        bgRatio: {type: "spin", precision: 0, increment: 1, min: 0, max: 100},
        bgAngle: {type: "spin", precision: 0, increment: 1, min: 0, max: 360},
        bgImage: {type: "input"},
        bgImageAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        bgImageDisplayMode: {
            type: "listbox",
            editorListItems: ["", "stretch", "tile", "fit", "fill", "center", "none"]
        },
        bgImageVAlign: {type: "listbox", editorListItems: ["", "top", "middle", "bottom"]},
        bgImageHAlign: {type: "listbox", editorListItems: ["", "left", "middle", "right"]},
        bgImageScale: {type: "spin", precision: 0, increment: 1, min: 0, max: 300},
        xAxisLineColor: {type: "color"},
        canvasBgColor: {type: "color"},
        canvasBgAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        canvasBgRatio: {type: "spin", precision: 0, increment: 1, min: 0, max: 100},
        canvasBgAngle: {type: "spin", precision: 0, increment: 1, min: 0, max: 360},
        canvasBorderColor: {type: "color"},
        canvasBorderThickness: {type: "spin", precision: 0, increment: 1, min: 0, max: 5},
        canvasBorderAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        canvasBaseColor: {type: "color"},
        showCanvasBg: {type: "checkbox"},
        showCanvasBase: {type: "checkbox"},
        canvasBaseDepth: {type: "spin", precision: 0, increment: 1, min: 0, max: 100},
        canvasBgDepth: {type: "spin", precision: 0, increment: 1, min: 0, max: 100},
        showBorder: {type: "checkbox"},
        borderColor: {type: "color"},
        borderAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        showVLineLabelBorder: {type: "checkbox"},
        yAxisLineColor: {type: "color"},
        logoURL: {type: "input"},
        logoPosition: {type: "listbox", editorListItems: ["", "TL", "TR", "BL", "BR", "CC"]},
        logoAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        logoScale: {type: "spin", precision: 0, increment: 1, min: 0, max: 300},
        logoLink: {type: "input"},
        toolbarButtonColor: {type: "color"},
        toolbarButtonFontColor: {type: "color"},
        zoomPaneBorderColor: {type: "color"},
        zoomPaneBgColor: {type: "color"},
        zoomPaneBgAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        pinLineThicknessDelta: {type: "spin", precision: 0, increment: 1, min: -1000, max: 1000},
        pinPaneBorderColor: {type: "color"},
        pinPaneBgColor: {type: "color"},
        pinPaneBgAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        toolTipColor: {type: "color"},
        toolTipBarColor: {type: "color"},
        useCrossLine: {type: "checkbox"},
        mouseCursorColor: {type: "color"},
        btnResetChartTitle: {type: "input"},
        btnZoomOutTitle: {type: "input"},
        btnSwitchtoZoomModeTitle: {type: "input"},
        btnSwitchToPinModeTitle: {type: "input"},
        showToolBarButtonTooltext: {type: "checkbox"},
        btnResetChartTooltext: {type: "input"},
        btnSwitchToPinModeTooltext: {type: "input"},
        zoomOutMenuItemLabel: {type: "input"},
        resetChartMenuItemLabel: {type: "input"},
        zoomModeMenuItemLabel: {type: "input"},
        pinModeMenuItemLabel: {type: "input"},
        toolBarBtnTextVMargin: {type: "spin", precision: 0, increment: 1, min: 0},
        toolBarBtnTextHMargin: {type: "spin", precision: 0, increment: 1, min: 0},
        toolBarBtnHPadding: {type: "spin", precision: 0, increment: 1, min: 0},
        toolBarBtnVPadding: {type: "spin", precision: 0, increment: 1, min: 0},
        xAxisTickColor: {type: "color"},
        is2D: {type: "checkbox"},
        clustered: {type: "checkbox"},
        chartOrder: {type: "input"},
        chartOnTop: {type: "checkbox"},
        autoScaling: {type: "checkbox"},
        allowScaling: {type: "checkbox"},
        startAngX: {type: "spin", precision: 0, increment: 1, min: 0, max: 360},
        startAngY: {type: "spin", precision: 0, increment: 1, min: 0, max: 360},
        endAngX: {type: "spin", precision: 0, increment: 1, min: 0, max: 360},
        endAngY: {type: "spin", precision: 0, increment: 1, min: 0, max: 360},
        cameraAngX: {type: "spin", precision: 0, increment: 1, min: 0, max: 360},
        cameraAngY: {type: "spin", precision: 0, increment: 1, min: 0, max: 360},
        lightAngX: {type: "spin", precision: 0, increment: 1, min: 0, max: 360},
        lightAngY: {type: "spin", precision: 0, increment: 1, min: 0, max: 360},
        intensity: {type: "spin", precision: 0, increment: 1, min: 0, max: 10},
        dynamicShading: {type: "checkbox"},
        bright2D: {type: "checkbox"},
        allowRotation: {type: "checkbox"},
        constrainVerticalRotation: {type: "checkbox"},
        minVerticalRotAngle: {type: "spin", precision: 0, increment: 1, min: 0, max: 360},
        maxVerticalRotAngle: {type: "spin", precision: 0, increment: 1, min: 0, max: 360},
        constrainHorizontalRotation: {type: "checkbox"},
        minHorizontalRotAngle: {type: "spin", precision: 0, increment: 1, min: 0, max: 360},
        maxHorizontalRotAngle: {type: "spin", precision: 0, increment: 1, min: 0, max: 360},
        zDepth: {type: "spin", precision: 0, increment: 1, min: 0},
        zGapPlot: {type: "spin", precision: 0, increment: 1, min: 0},
        yzWallDepth: {type: "spin", precision: 0, increment: 1, min: 0},
        zxWallDepth: {type: "spin", precision: 0, increment: 1, min: 0},
        xyWallDepth: {type: "spin", precision: 0, increment: 1, min: 0},
        drawAnchors: {type: "checkbox"},
        anchorRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        anchorBorderColor: {type: "color"},
        anchorBorderThickness: {type: "spin", precision: 0, increment: 1, min: 0},
        anchorBgColor: {type: "color"},
        anchorAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        anchorBgAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        anchorMinRenderDistance: {type: "spin", precision: 0, increment: 1, min: 0},
        scrollColor: {type: "color"},
        scrollHeight: {type: "spin", precision: 0, increment: 1, min: 0},
        scrollPadding: {type: "spin", precision: 0, increment: 1, min: 0},
        scrollBtnWidth: {type: "spin", precision: 0, increment: 1, min: 0},
        scrollBtnPadding: {type: "spin", precision: 0, increment: 1, min: 0},
        dataStreamURL: {type: "input"},
        refreshInterval: {type: "spin", precision: 0, increment: 1, min: 0},
        clearChartInterval: {type: "spin", precision: 0, increment: 1, min: 0},
        updateInterval: {type: "spin", precision: 0, increment: 1, min: 0},
        numDisplaySets: {type: "spin", precision: 0, increment: 1, min: 1},
        dataStamp: {type: "input"},
        showRealTimeValue: {type: "checkbox"},
        realTimeValueSep: {type: "input"},
        useMessageLog: {type: "checkbox"},
        messageLogWPercent: {type: "spin", precision: 0, increment: 1, min: 0, max: 100},
        messageLogHPercent: {type: "spin", precision: 0, increment: 1, min: 0, max: 100},
        messageLogShowTitle: {type: "checkbox"},
        messageLogTitle: {type: "input"},
        messageLogColor: {type: "color"},
        messageGoesToLog: {type: "checkbox"},
        messageGoesToJS: {type: "checkbox"},
        messageJSHandler: {type: "input"},
        messagePassAllToJS: {type: "checkbox"},
        numDivLines: {type: "spin", precision: 0, increment: 1, min: 1},
        numVDivLines: {type: "spin", precision: 0, increment: 1, min: 1},
        divLineEffect: {type: "listbox", editorListItems: ["", "EMBOSS", "BEVEL", "NONE"]},
        divLineColor: {type: "color"},
        vDivLineColor: {type: "color"},
        divLineThickness: {type: "spin", precision: 0, increment: 1, min: 0, max: 5},
        vDivLineThickness: {type: "spin", precision: 0, increment: 1, min: 0, max: 5},
        divLineAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        vDivLineAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        zeroPlaneMesh: {type: "checkbox"},
        divLineDashed: {type: "checkbox"},
        vDivLineDashed: {type: "checkbox"},
        divLineIsDashed: {type: "checkbox"},
        vDivLineIsDashed: {type: "checkbox"},
        divLineDashLen: {type: "spin", precision: 0, increment: 1, min: 0},
        vDivLineDashLen: {type: "spin", precision: 0, increment: 1, min: 0},
        divLineDashGap: {type: "spin", precision: 0, increment: 1, min: 0},
        vDivLineDashGap: {type: "spin", precision: 0, increment: 1, min: 0},
        zeroPlaneColor: {type: "color"},
        zeroPlaneThickness: {type: "spin", precision: 0, increment: 1, min: 0},
        zeroPlaneAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        showVZeroPlane: {type: "checkbox"},
        vZeroPlaneColor: {type: "color"},
        vZeroPlaneThickness: {type: "spin", precision: 0, increment: 1, min: 0, max: 5},
        vZeroPlaneAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        showPZeroPlaneValue: {type: "checkbox"},
        showSZeroPlaneValue: {type: "checkbox"},
        showZeroPlaneValue: {type: "checkbox"},
        showAlternateHGridColor: {type: "checkbox"},
        alternateHGridColor: {type: "color"},
        alternateHGridAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        showAlternateVGridColor: {type: "checkbox"},
        alternateVGridColor: {type: "color"},
        alternateVGridAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        showZeroPlane: {type: "checkbox"},
        zeroPlaneShowBorder: {type: "checkbox"},
        zeroPlaneBorderColor: {type: "color"},
        drawQuadrant: {type: "checkbox"},
        quadrantXVal: {type: "spin", precision: 0, increment: 1, min: 0},
        quadrantYVal: {type: "spin", precision: 0, increment: 1, min: 0},
        quadrantLineColor: {type: "color"},
        quadrantLineThickness: {type: "spin", precision: 0, increment: 1, min: 0},
        quadrantLineAlpha: {type: "spin", precision: 2, increment: 1, min: 0},
        quadrantLineDashed: {type: "checkbox"},
        quadrantLineDashLen: {type: "spin", precision: 0, increment: 1, min: 0},
        quadrantLineDashGap: {type: "spin", precision: 0, increment: 1, min: 0},
        quadrantLabelTL: {type: "input"},
        quadrantLabelTR: {type: "input"},
        quadrantLabelBL: {type: "input"},
        quadrantLabelBR: {type: "input"},
        quadrantLabelPadding: {type: "spin", precision: 0, increment: 1, min: -5000, max: 5000},
        showLegend: {type: "checkbox"},
        legendPosition: {type: "listbox", editorListItems: ["", "BOTTOM", "RIGHT"]},
        legendCaption: {type: "input"},
        legendItemFontBold: {type: "checkbox"},
        legendItemFont: {type: "helpinput", editorListItems: CONF.designer_data_fontfamily},
        legendItemFontSize: {type: "spin", precision: 0, increment: 1, min: 0, max: 256},
        legendItemFontColor: {type: "color"},
        legendItemHoverFontColor: {type: "color"},
        legendItemHiddenColor: {type: "color"},
        legendCaptionAlignment: {type: "listbox", editorListItems: ["", "left", "center", "right"]},
        legendCaptionBold: {type: "checkbox"},
        legendCaptionFont: {type: "helpinput", editorListItems: CONF.designer_data_fontfamily},
        legendCaptionFontSize: {type: "spin", precision: 0, increment: 1, min: 0, max: 256},
        legendCaptionFontColor: {type: "color"},
        legendIconScale: {type: "spin", precision: 0, increment: 1, min: 1, max: 5},
        legendBgColor: {type: "color"},
        legendBgAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        legendBorderColor: {type: "color"},
        legendBorderThickness: {type: "spin", precision: 0, increment: 1, min: 0},
        legendBorderAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        legendShadow: {type: "checkbox"},
        legendAllowDrag: {type: "checkbox"},
        legendScrollBgColor: {type: "color"},
        legendScrollBarColor: {type: "color"},
        legendScrollBtnColor: {type: "color"},
        reverseLegend: {type: "checkbox"},
        interactiveLegend: {type: "checkbox"},
        legendNumColumns: {type: "spin", precision: 0, increment: 1, min: 0},
        minimiseWrappingInLegend: {type: "checkbox"},
        radius3D: {type: "spin", precision: 0, increment: 1, min: 0, max: 100},
        slicingDistance: {type: "spin", precision: 0, increment: 1, min: 0},
        pieRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        doughnutRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        startingAngle: {type: "spin", precision: 0, increment: 1, min: 0, max: 360},
        enableRotation: {type: "checkbox"},
        pieInnerFaceAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        pieOuterFaceAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        pieYScale: {type: "spin", precision: 0, increment: 1, min: 30, max: 80},
        pieSliceDepth: {type: "spin", precision: 0, increment: 1, min: 0},
        enableSmartLabels: {type: "checkbox"},
        skipOverlapLabels: {type: "checkbox"},
        isSmartLineSlanted: {type: "checkbox"},
        smartLineColor: {type: "color"},
        smartLineThickness: {type: "spin", precision: 0, increment: 1, min: 0},
        smartLineAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        labelDistance: {type: "spin", precision: 0, increment: 1, min: 0},
        smartLabelClearance: {type: "spin", precision: 0, increment: 1, min: 0},
        manageLabelOverflow: {type: "checkbox"},
        showToolTip: {type: "checkbox"},
        toolTipBgColor: {type: "color"},
        toolTipBorderColor: {type: "color"},
        toolTipSepChar: {type: "input", maxlength: 1},
        seriesNameInToolTip: {type: "checkbox"},
        showToolTipShadow: {type: "checkbox"},
        scaleRecursively: {type: "checkbox"},
        scaleSeparator: {type: "input", maxlength: 1},
        forceDecimals: {type: "checkbox"},
        forceYAxisValueDecimals: {type: "checkbox"},
        yAxisValueDecimals: {type: "spin", precision: 0, increment: 1, min: 0, max: 10},
        sYAxisValueDecimals: {type: "spin", precision: 0, increment: 1, min: 0, max: 10},
        canvasPadding: {type: "spin", precision: 0, increment: 1, min: 0, max: 100},
        captionPadding: {type: "spin", precision: 0, increment: 1, min: 0},
        yLabelGap: {type: "spin", precision: 0, increment: 1, min: 0},
        xLabelGap: {type: "spin", precision: 0, increment: 1, min: 0},
        xAxisNamePadding: {type: "spin", precision: 0, increment: 1, min: 0},
        yAxisNamePadding: {type: "spin", precision: 0, increment: 1, min: 0},
        yAxisValuesPadding: {type: "spin", precision: 0, increment: 1, min: 0},
        labelPadding: {type: "spin", precision: 0, increment: 1, min: 0},
        valuePadding: {type: "spin", precision: 0, increment: 1, min: 0},
        realTimeValuePadding: {type: "spin", precision: 0, increment: 1, min: 0},
        plotSpacePercent: {type: "spin", precision: 0, increment: 1, min: 0, max: 80},
        legendPadding: {type: "spin", precision: 0, increment: 1, min: 0},
        chartLeftMargin: {type: "spin", precision: 0, increment: 1, min: 0},
        chartRightMargin: {type: "spin", precision: 0, increment: 1, min: 0},
        chartTopMargin: {type: "spin", precision: 0, increment: 1, min: 0},
        chartBottomMargin: {type: "spin", precision: 0, increment: 1, min: 0},
        canvasLeftMargin: {type: "spin", precision: 0, increment: 1, min: 0},
        canvasRightMargin: {type: "spin", precision: 0, increment: 1, min: 0},
        canvasTopMargin: {type: "spin", precision: 0, increment: 1, min: 0},
        canvasBottomMargin: {type: "spin", precision: 0, increment: 1, min: 0},
        valueFont: {type: "helpinput", editorListItems: CONF.designer_data_fontfamily},
        valueFontColor: {type: "color"},
        valueFontSize: {type: "spin", precision: 0, increment: 1, min: 0, max: 256},
        valueFontBold: {type: "checkbox"},
        valueFontItalic: {type: "checkbox"},
        valueBgColor: {type: "color"},
        valueBorderColor: {type: "color"},
        valueAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        valueFontAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        valueBgAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        valueBorderAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        valueBorderThickness: {type: "spin", precision: 0, increment: 1, min: 0, max: 5},
        valueBorderRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        valueBorderDashed: {type: "checkbox"},
        valueBorderDashGap: {type: "spin", precision: 0, increment: 1, min: 0},
        valueBorderDashLen: {type: "spin", precision: 0, increment: 1, min: 0},
        valueHoverAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        valueFontHoverAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        valueBgHoverAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        valueBorderHoverAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        showValuesOnHover: {type: "checkbox"},
        labelFont: {type: "helpinput", editorListItems: CONF.designer_data_fontfamily},
        labelFontColor: {type: "color"},
        labelFontSize: {type: "spin", precision: 0, increment: 1, min: 0, max: 256},
        labelFontBold: {type: "checkbox"},
        labelFontItalic: {type: "checkbox"},
        labelBgColor: {type: "color"},
        labelBorderColor: {type: "color"},
        labelAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        labelBgAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        labelBorderAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        labelBorderPadding: {type: "spin", precision: 0, increment: 1, min: 0},
        labelBorderRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        labelBorderThickness: {type: "spin", precision: 0, increment: 1, min: 0, max: 5},
        labelBorderDashed: {type: "checkbox"},
        labelBorderDashLen: {type: "spin", precision: 0, increment: 1, min: 0},
        labelBorderDashGap: {type: "spin", precision: 0, increment: 1, min: 0},
        labelLink: {type: "input"},
        showHoverEffect: {type: "checkbox"},
        plotHoverEffect: {type: "checkbox"},
        plotFillHoverColor: {type: "color"},
        plotFillHoverAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        lineThickness: {type: "spin", precision: 0, increment: 1, min: 0, max: 5},
        useRoundEdges: {type: "checkbox"},
        overlapBars: {type: "checkbox"},
        showPlotBorder: {type: "checkbox"},
        plotBorderColor: {type: "color"},
        plotBorderThickness: {type: "spin", precision: 0, increment: 1, min: 0, max: 5},
        plotBorderAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        plotBorderDashed: {type: "checkbox"},
        plotBorderDashLen: {type: "spin", precision: 0, increment: 1, min: 0},
        plotBorderDashGap: {type: "spin", precision: 0, increment: 1, min: 0},
        plotFillAngle: {type: "spin", precision: 0, increment: 1, min: 0, max: 360},
        plotFillRatio: {type: "spin", precision: 0, increment: 1, min: 0, max: 100},
        plotFillAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        plotGradientColor: {type: "color"},
        plotFillColor: {type: "color"},
        overlapColumns: {type: "checkbox"},
        showRadarBorder: {type: "checkbox"},
        radarBorderColor: {type: "color"},
        radarBorderThickness: {type: "spin", precision: 0, increment: 1, min: 0, max: 5},
        radarBorderAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        radarFillColor: {type: "color"},
        radarFillAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        radarSpikeColor: {type: "color"},
        radarSpikeThickness: {type: "spin", precision: 0, increment: 1, min: 0, max: 5},
        radarSpikeAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        formatNumber: {type: "checkbox"},
        yFormatNumber: {type: "checkbox"},
        xFormatNumber: {type: "checkbox"},
        formatNumberScale: {type: "checkbox"},
        yFormatNumberScale: {type: "checkbox"},
        xFormatNumberScale: {type: "checkbox"},
        defaultNumberScale: {type: "input"},
        yDefaultNumberScale: {type: "input"},
        xDefaultNumberScale: {type: "input"},
        numberScaleUnit: {type: "input"},
        yNumberScaleUnit: {type: "input"},
        xNumberScaleUnit: {type: "input"},
        NumberScaleUnit: {type: "input"},
        numberScaleValue: {type: "input"},
        yNumberScaleValue: {type: "input"},
        xNumberScaleValue: {type: "input"},
        sNumberScaleValue: {type: "input"},
        xScaleRecursively: {type: "checkbox"},
        maxScaleRecursion: {type: "spin", precision: 0, increment: 1, min: 0},
        xMaxScaleRecursion: {type: "spin", precision: 0, increment: 1, min: 0},
        numberPrefix: {type: "input", maxlength: 1},
        numberSuffix: {type: "input", maxlength: 1},
        yNumberPrefix: {type: "input", maxlength: 1},
        xNumberPrefix: {type: "input", maxlength: 1},
        yNumberSuffix: {type: "input", maxlength: 1},
        xNumberSuffix: {type: "input", maxlength: 1},
        decimalSeparator: {type: "input", maxlength: 1},
        thousandSeparator: {type: "input", maxlength: 1},
        thousandSeparatorPosition: {type: "spin", precision: 0, increment: 1, min: 0},
        inDecimalSeparator: {type: "input", maxlength: 1},
        inThousandSeparator: {type: "input", maxlength: 1},
        decimals: {type: "spin", precision: 0, increment: 1, min: 0, max: 10},
        forceYAxisValueDecimals: {type: "checkbox"},
        forceXAxisValueDecimals: {type: "checkbox"},
        forceYAxisDecimals: {type: "checkbox"},
        forcePYAxisDecimals: {type: "checkbox"},
        forceSYAxisDecimals: {type: "checkbox"},
        yAxisValueDecimals: {type: "spin", precision: 0, increment: 1, min: 0, max: 10},
        xAxisValueDecimals: {type: "spin", precision: 0, increment: 1, min: 0, max: 10},
        sFormatNumber: {type: "checkbox"},
        sFormatNumberScale: {type: "checkbox"},
        sDefaultNumberScale: {type: "input"},
        sNumberScaleUnit: {type: "input"},
        xScaleSeparator: {type: "input", maxlength: 1},
        sDecimals: {type: "spin", precision: 0, increment: 1, min: 0, max: 10},
        sForceDecimals: {type: "checkbox"},
        sYAxisValueDecimals: {type: "spin", precision: 0, increment: 1, min: 0, max: 10},
        sScaleRecursively: {type: "checkbox"},
        sMaxScaleRecursion: {type: "spin", precision: 0, increment: 1, min: 0},
        sScaleSeparator: {type: "input", maxlength: 1},
        sNumberPrefix: {type: "input", maxlength: 1},
        sNumberSuffix: {type: "input", maxlength: 1},
        forceSYAxisValueDecimals: {type: "checkbox"},
        baseFont: {type: "helpinput", editorListItems: CONF.designer_data_fontfamily},
        baseFontSize: {type: "spin", precision: 0, increment: 1, min: 0, max: 256},
        baseFontColor: {type: "color"},
        outCnvBaseFont: {type: "helpinput", editorListItems: CONF.designer_data_fontfamily},
        outCnvBaseFontSize: {type: "spin", precision: 0, increment: 1, min: 0, max: 256},
        outCnvBaseFontColor: {type: "color"},
        realTimeValueFont: {type: "helpinput", editorListItems: CONF.designer_data_fontfamily},
        realTimeValueFontSize: {type: "spin", precision: 0, increment: 1, min: 0, max: 256},
        realTimeValueFontColor: {type: "color"},
        minValue: {type: "spin", precision: 2},
        maxValue: {type: "spin", precision: 2},
        code: {type: "color"},
        setAdaptiveMin: {type: "checkbox"},
        upperLimit: {type: "spin", precision: 0, increment: 2},
        lowerLimit: {type: "spin", precision: 0, increment: 2},
        lowerLimitDisplay: {type: "checkbox"},
        upperLimitDisplay: {type: "checkbox"},
        showTickMarks: {type: "checkbox"},
        showTickValues: {type: "checkbox"},
        adjustTM: {type: "checkbox"},
        ticksOnRight: {type: "checkbox"},
        ticksBelowGauge: {type: "checkbox"},
        placeTicksInside: {type: "checkbox"},
        trendValueDistance: {type: "spin", precision: 0, increment: 1, min: 0},
        showGaugeLabels: {type: "checkbox"},
        gaugeRoundRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        gaugeFillMix: {type: "input"},
        gaugeFillRatio: {type: "input"},
        majorTMNumber: {type: "spin", precision: 2},
        majorTMColor: {type: "color"},
        majorTMAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        majorTMHeight: {type: "spin", precision: 2, increment: 1, min: 0},
        majorTMThickness: {type: "spin", precision: 0, increment: 1, min: 0},
        minorTMNumber: {type: "spin", precision: 2, increment: 1},
        minorTMColor: {type: "color"},
        minorTMAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        minorTMHeight: {type: "spin", precision: 2, increment: 1, min: 0},
        minorTMThickness: {type: "spin", precision: 0, increment: 1, min: 0},
        tickMarkDistance: {type: "spin", precision: 0, increment: 1, min: 0},
        tickValueDistance: {type: "spin", precision: 0, increment: 1, min: 0},
        tickValueStep: {type: "spin", precision: 0, increment: 1, min: 0},
        tickValueDecimals: {type: "checkbox"},
        forceTickValueDecimals: {type: "checkbox"},
        gaugeFillColor: {type: "color"},
        showGaugeBorder: {type: "checkbox"},
        gaugeBorderColor: {type: "color"},
        gaugeBorderThickness: {type: "spin", precision: 0, increment: 1, min: 0},
        gaugeBorderAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        ledSize: {type: "spin", precision: 0, increment: 1, min: 0},
        ledGap: {type: "spin", precision: 0, increment: 1, min: 0},
        useSameFillColor: {type: "color"},
        useSameFillBgColor: {type: "color"},
        cylOriginX: {type: "spin", precision: 0, increment: 1, min: 0},
        cylOriginY: {type: "spin", precision: 0, increment: 1, min: 0},
        cylRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        cylHeight: {type: "spin", precision: 0, increment: 1, min: 0},
        cylYScale: {type: "spin", precision: 0, increment: 1, min: 0, max: 50},
        cylFillColor: {type: "color"},
        thmBulbRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        thmHeight: {type: "spin", precision: 0, increment: 1, min: 0},
        gaugeFillAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        pivotRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        pivotFillColor: {type: "color"},
        pivotFillAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        pivotFillAngle: {type: "spin", precision: 2, increment: 1, min: 0, max: 360},
        pivotFillType: {type: "listbox", editorListItems: ["", "linear", "radial"]},
        pivotFillMix: {type: "input"},
        pivotFillRatio: {type: "input"},
        showPivotBorder: {type: "checkbox"},
        pivotBorderThickness: {type: "spin", precision: 0, increment: 1, min: 0},
        pivotBorderColor: {type: "color"},
        pivotBorderAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        editMode: {type: "checkbox"},
        pointerRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        pointerBgColor: {type: "color"},
        pointerBgAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        pointerSides: {type: "spin", precision: 0, increment: 1, min: 3, max: 15},
        pointerBorderThickness: {type: "spin", precision: 0, increment: 1, min: 0},
        pointerBorderColor: {type: "color"},
        pointerBorderAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        valueAbovePointer: {type: "checkbox"},
        pointerOnTop: {type: "checkbox"},
        useMarker: {type: "checkbox"},
        markerColor: {type: "color"},
        markerBorderColor: {type: "color"},
        markerRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        markerTooltext: {type: "input"},
        id: {type: "input"},
        radius: {type: "spin", precision: 0, increment: 1, min: 0},
        sides: {type: "spin", precision: 0, increment: 1, min: 3, max: 15},
        valueBelowPivot: {type: "checkbox"},
        autoAlignTickValues: {type: "checkbox"},
        gaugeStartAngle: {type: "spin", precision: 2, increment: 1, min: 0, max: 360},
        gaugeEndAngle: {type: "spin", precision: 2, increment: 1, min: 0, max: 360},
        gaugeOriginX: {type: "spin", precision: 0, increment: 1, min: 0},
        gaugeOriginY: {type: "spin", precision: 0, increment: 1, min: 0},
        gaugeOuterRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        gaugeInnerRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        valueInside: {type: "checkbox"},
        innerRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        valueX: {type: "spin", precision: 0, increment: 1, min: 0},
        valueY: {type: "spin", precision: 0, increment: 1, min: 0},
        baseWidth: {type: "spin", precision: 0, increment: 1, min: 0},
        baseRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        topWidth: {type: "spin", precision: 0, increment: 1, min: 0},
        rearExtension: {type: "spin", precision: 0, increment: 1, min: 0},
        thickness: {type: "spin", precision: 0, increment: 1, min: 0},
        alpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        dashed: {type: "checkbox"},
        dashLen: {type: "spin", precision: 0, increment: 1, min: 0},
        dashGap: {type: "spin", precision: 0, increment: 1, min: 0},
        label: {type: "input"},
        showLabelBorder: {type: "checkbox"},
        linePosition: {type: "spin", precision: 2, increment: 0.1, min: 0, max: 1},
        labelPosition: {type: "spin", precision: 2, increment: 0.1, min: 0, max: 1},
        labelHAlign: {type: "listbox", editorListItems: ["", "left", "center", "right"]},
        labelVAlign: {type: "listbox", editorListItems: ["", "top", "middle", "bottom"]},
        displayValue: {type: "input"},
        isTrendZone: {type: "checkbox"},
        showOnTop: {type: "checkbox"},
        valueOnRight: {type: "checkbox"},
        parentYAxis: {type: "listbox", editorListItems: ["", "P", "S"]},
        startValue: {type: "spin", precision: 2, increment: 1, headerStyle: "font-weight:bold"},
        endValue: {type: "spin", precision: 2, increment: 1},
        startIndex: {type: "spin", precision: 0, increment: 1, min: 0, headerStyle: "font-weight:bold"},
        endIndex: {type: "spin", precision: 0, increment: 1, min: 0},
        displayAlways: {type: "checkbox"},
        displayWhenCount: {type: "spin", precision: 0, increment: 1, min: 0, headerStyle: "font-weight:bold"},
        valueOnTop: {type: "input"},
        toolText: {type: "input"},
        font: {type: "helpinput", editorListItems: CONF.designer_data_fontfamily},
        fontSize: {type: "spin", precision: 0, increment: 1, min: 0, max: 256},
        fontColor: {type: "color"},
        verticalLineColor: {type: "color"},
        verticalLineThickness: {type: "spin", precision: 0, increment: 1, min: 0, max: 5},
        verticalLineAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        verticalLineDashed: {type: "checkbox"},
        verticalLineDashLen: {type: "spin", precision: 0, increment: 1, min: 0},
        verticalLineDashGap: {type: "spin", precision: 0, increment: 1, min: 0},
        showLabel: {type: "checkbox"},
        showVerticalLine: {type: "checkbox"},
        lineDashed: {type: "checkbox"},
        widthPercent: {type: "spin", precision: 0, increment: 1, min: 1, max: 100},
        labelBorderThickness: {type: "spin", precision: 0, increment: 1, min: 0},
        seriesName: {type: "input"},
        checkForAlerts: {type: "checkbox"},
        plotFillAlpha: {type: "input"},
        ratio: {type: "input"},
        showValues: {type: "checkbox"},
        anchorBorderAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        drawLine: {type: "checkbox"},
        lineColor: {type: "color"},
        lineAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        anchorSides: {type: "spin", precision: 0, increment: 1, min: 3, max: 20},
        lineDashGap: {type: "spin", precision: 0, increment: 1, min: 0},
        includeInLegend: {type: "checkbox"},
        renderAs: {type: "listbox", editorListItems: ["", "COLUMN", "AREA", "LINE"]},
        regressionLineColor: {type: "color"},
        regressionLineThickness: {type: "spin", precision: 0, increment: 1, min: 0},
        regressionLineAlpha: {type: "spin", precision: 2, increment: 1, min: 0, max: 100},
        lineDashLen: {type: "spin", precision: 0, increment: 1, min: 0},
        isSliced: {type: "checkbox"},
        x: {type: 'number', precision: 2, increment: 0.1},
        y: {type: 'number', precision: 2, increment: 0.1},
        z: {type: 'number', precision: 2, increment: 0.1},
        name: {type: 'input'},
        fontBold: {type: "checkbox"},
        fontItalic: {type: "checkbox"},
        borderPadding: {type: "spin", precision: 0, increment: 1, min: 0},
        borderRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        borderThickness: {type: "spin", precision: 0, increment: 1, min: 0},
        borderDashed: {type: "checkbox"},
        borderDashLen: {type: "spin", precision: 0, increment: 1, min: 0},
        borderDashGap: {type: "spin", precision: 0, increment: 1, min: 0},
        link: {type: "input"},
        "value": {type: "number", precision: 2, increment: 0.1, headerStyle: "font-weight:bold"},
        showValue: {type: "checkbox"},
        constrainScale: {type: "checkbox"},
        scaleText: {type: "checkbox"},
        scaleImages: {type: "checkbox"},
        xShift: {type: "spin", precision: 0, increment: 1},
        yShift: {type: "spin", precision: 0, increment: 1},
        grpXShift: {type: "spin", precision: 0, increment: 1},
        grpYShift: {type: "spin", precision: 0, increment: 1},
        showBelow: {type: "checkbox"},
        'visible': {type: "checkbox"},
        textAlign: {type: "listbox", editorListItems: ["", 'left', 'right', 'center']},
        textVAlign: {type: "listbox", editorListItems: ["", 'top', 'bottom', 'middle']},
        rotateText: {type: "checkbox"},
        wrapText: {type: "checkbox"},

        fillPattern: {type: "listbox", editorListItems: ["", "linear", "radial"]},
        yRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        startAngle: {type: "spin", precision: 2, increment: 1, min: 0, max: 360},
        endAngle: {type: "spin", precision: 2, increment: 1, min: 0, max: 360},
        innerRadius: {type: "spin", precision: 0, increment: 1, min: 0},
        url: {type: "input"},
        path: {type: "input"},
        align: {type: "listbox", editorListItems: ["", 'left', 'right', 'center']},
        vAlign: {type: "listbox", editorListItems: ["", 'top', 'bottom', 'middle']},
        bold: {type: "checkbox"},
        italic: {type: "checkbox"},
        leftMargin: {type: "spin", precision: 0, increment: 1, min: 0},
        wrapWidth: {type: "spin", precision: 0, increment: 1, min: 0},
        wrapHeight: {type: "spin", precision: 0, increment: 1, min: 0},
        wrap: {type: "checkbox"},
        annotations: {
            type: {type: 'label', disabled: true},
            x: {type: 'input'},
            y: {type: 'input'},
            toX: {type: 'input'},
            toY: {type: 'input'},
            fillColor: {type: "input"},
            fillRatio: {type: "input"},
            fillAlpha: {type: "input"},
            fillAngle: {type: "input"}
        }
    },
    attrCat: {
        Column2D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "rotateValues", "placeValuesInside", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateYAxisName", "yAxisNameWidth", "clickURL", "yAxisMinValue", "yAxisMaxValue", "setAdaptiveYMin", "useDataPlotColorForLabels"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "xAxisLineColor", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showBorder", "borderColor", "borderThickness", "borderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineIsDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["useRoundEdges", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillRatio", "plotFillAlpha", "plotGradientColor"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "set": ["label", "value", "displayValue", "color", "link", "toolText", "showLabel", "showValue", "dashed", "alpha", "labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        Column3D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {
                            id: "Titles (Axis) Names",
                            prop: ["caption", "subCaption", "xAxisName", "yAxisName", "rotateYAxisName", "yAxisNameWidth", "centerYaxisName"]
                        },
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "rotateValues", "placeValuesInside", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateYAxisName", "yAxisNameWidth", "clickURL", "yAxisMinValue", "yAxisMaxValue", "setAdaptiveYMin", "useDataPlotColorForLabels"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "canvasBgColor", "canvasBgAlpha", "canvasBaseColor", "showCanvasBg", "xAxisLineColor", "showCanvasBase", "canvasBaseDepth", "canvasBgDepth", "showBorder", "borderColor", "borderThickness", "borderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineIsDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showPlotBorder", "plotBorderColor", "plotBorderAlpha", "plotFillAlpha", "overlapColumns"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "set": ["label", "value", "displayValue", "color", "link", "toolText", "showLabel", "showValue", "dashed", "alpha", "labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        Pie2D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showZeroPies", "showPercentValues", "showPercentInToolTip", "showLabels", "showValues", "labelSepChar", "clickURL", "useDataPlotColorForLabels"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendPosition", "legendCaption", "legendIconScale", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "legendScrollBarColor", "legendScrollBtnColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Pie / Doughnut Properties",
                            prop: ["radius3D", "slicingDistance", "pieRadius", "startingAngle", "enableRotation"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Smart Labels & Lines",
                            prop: ["enableSmartLabels", "skipOverlapLabels", "isSmartLineSlanted", "smartLineColor", "smartLineThickness", "smartLineAlpha", "labelDistance", "smartLabelClearance", "manageLabelOverflow", "useEllipsesWhenOverflow"]
                        },
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotFillAlpha", "showShadow", "use3DLighting"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals"]
                        },
                        {id: "Font Properties", prop: ["baseFont", "baseFontSize", "baseFontColor"]}
                    ]
                }
            ],
            "set": ["label", "value", "borderColor", "borderAlpha", "isSliced", "displayValue", "color", "link", "toolText", "dashed", "alpha", "showLabel", "showValue", "labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
        },
        Pie3D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showZeroPies", "showPercentValues", "showPercentInToolTip", "showLabels", "showValues", "labelSepChar", "clickURL", "useDataPlotColorForLabels"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendPosition", "legendCaption", "legendIconScale", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "legendScrollBarColor", "legendScrollBtnColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Pie / Doughnut Properties",
                            prop: ["slicingDistance", "pieRadius", "startingAngle", "enableRotation", "pieInnerFaceAlpha", "pieOuterFaceAlpha", "pieYScale", "pieSliceDepth"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Smart Labels & Lines",
                            prop: ["enableSmartLabels", "skipOverlapLabels", "isSmartLineSlanted", "smartLineColor", "smartLineThickness", "smartLineAlpha", "labelDistance", "smartLabelClearance", "manageLabelOverflow", "useEllipsesWhenOverflow"]
                        },
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotFillAlpha", "use3DLighting"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals"]
                        },
                        {id: "Font Properties", prop: ["baseFont", "baseFontSize", "baseFontColor"]}
                    ]
                }
            ],
            "set": ["label", "value", "borderColor", "borderAlpha", "isSliced", "displayValue", "color", "link", "toolText", "dashed", "alpha", "showLabel", "showValue", "labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
        },
        Line: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "connectNullData", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "valuePosition", "rotateValues", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "adjustDiv", "rotateYAxisName", "yAxisNameWidth", "clickURL", "yAxisMinValue", "yAxisMaxValue", "setAdaptiveYMin"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "xAxisLineColor", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showBorder", "borderColor", "borderThickness", "borderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineIsDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha", "numVDivLines", "vDivLineColor", "vDivLineThickness", "vDivLineAlpha", "vDivLineIsDashed", "vDivLineDashLen", "vDivLineDashGap", "showAlternateVGridColor", "alternateVGridColor", "alternateVGridAlpha", "showZeroPlane"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showShadow", "lineColor", "lineThickness", "lineAlpha", "lineDashed", "lineDashLen", "lineDashGap"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "set": ["label", "value", "displayValue", "color", "link", "toolText", "showLabel", "showValue", "valuePosition", "dashed", "alpha", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha", "labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        Bar2D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showLabels", "labelStep", "maxLabelWidthPercent", "useEllipsesWhenOverflow", "showValues", "placeValuesInside", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateXAxisName", "xAxisNameWidth", "clickURL", "yAxisMinValue", "yAxisMaxValue", "setAdaptiveYMin", "centerXaxisName", "useDataPlotColorForLabels"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateVGridColor", "alternateVGridColor", "alternateVGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["useRoundEdges", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillRatio", "plotFillAlpha", "plotGradientColor"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "set": ["label", "value", "displayValue", "color", "link", "toolText", "showLabel", "showValue", "dashed", "alpha", "labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        Bar3D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showLabels", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "rotateValues", "placeValuesInside", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateYAxisName", "yAxisNameWidth", "clickURL", "maxColWidth", "use3DLighting", "yAxisMinValue", "yAxisMaxValue", "setAdaptiveYMin"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "canvasBgColor", "canvasBgAlpha", "canvasBaseColor", "showCanvasBg", "xAxisLineColor", "showCanvasBase", "canvasBaseDepth", "canvasBgDepth", "showBorder", "borderColor", "borderThickness", "borderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneAlpha", "zeroPlaneShowBorder", "showZeroPlaneValue", "zeroPlaneBorderColor"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showPlotBorder", "plotBorderColor", "plotBorderAlpha", "plotFillAlpha"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "set": ["label", "value", "displayValue", "color", "link", "toolText", "showLabel", "showValue", "dashed", "alpha", "labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        Area2D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "connectNullData", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "rotateValues", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "adjustDiv", "rotateYAxisName", "yAxisNameWidth", "clickURL", "yAxisMinValue", "yAxisMaxValue", "setAdaptiveYMin"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "xAxisLineColor", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showBorder", "borderColor", "borderThickness", "borderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha", "numVDivLines", "vDivLineColor", "vDivLineThickness", "vDivLineAlpha", "vDivLineDashed", "vDivLineDashLen", "vDivLineDashGap", "showAlternateVGridColor", "alternateVGridColor", "alternateVGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillRatio", "plotFillAlpha", "plotGradientColor", "showShadow", "plotFillColor"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "set": ["label", "value", "displayValue", "link", "toolText", "showLabel", "showValue", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha", "labelFont", "labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        Doughnut2D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showZeroPies", "showPercentValues", "showPercentInToolTip", "showLabels", "showValues", "labelSepChar", "clickURL", "useDataPlotColorForLabels"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendPosition", "legendCaption", "legendIconScale", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "legendScrollBarColor", "legendScrollBtnColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Pie / Doughnut Properties",
                            prop: ["radius3D", "slicingDistance", "pieRadius", "doughnutRadius", "startingAngle", "enableRotation"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Smart Labels & Lines",
                            prop: ["enableSmartLabels", "skipOverlapLabels", "isSmartLineSlanted", "smartLineColor", "smartLineThickness", "smartLineAlpha", "labelDistance", "smartLabelClearance", "manageLabelOverflow", "useEllipsesWhenOverflow"]
                        },
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotFillAlpha", "showShadow", "use3DLighting"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals"]
                        },
                        {id: "Font Properties", prop: ["baseFont", "baseFontSize", "baseFontColor"]}
                    ]
                }
            ],
            "set": ["label", "value", "displayValue", "color", "link", "toolText", "dashed", "alpha", "borderColor", "borderAlpha", "isSliced", "showLabel", "showValue", "labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
        },
        Doughnut3D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showZeroPies", "showPercentValues", "showPercentInToolTip", "showLabels", "showValues", "labelSepChar", "clickURL", "useDataPlotColorForLabels"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendPosition", "legendCaption", "legendIconScale", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "legendScrollBarColor", "legendScrollBtnColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Pie / Doughnut Properties",
                            prop: ["slicingDistance", "pieRadius", "doughnutRadius", "startingAngle", "enableRotation"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Smart Labels & Lines",
                            prop: ["enableSmartLabels", "skipOverlapLabels", "isSmartLineSlanted", "smartLineColor", "smartLineThickness", "smartLineAlpha", "labelDistance", "smartLabelClearance", "manageLabelOverflow", "useEllipsesWhenOverflow"]
                        },
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotFillAlpha", "use3DLighting"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals"]
                        },
                        {id: "Font Properties", prop: ["baseFont", "baseFontSize", "baseFontColor"]}
                    ]
                }
            ],
            "set": ["label", "value", "displayValue", "color", "link", "toolText", "dashed", "alpha", "borderColor", "borderAlpha", "isSliced", "showLabel", "showValue", "labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
        },
        Pareto2D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {
                            id: "Titles (Axis) Names",
                            prop: ["caption", "subCaption", "xAxisName", "sYAxisName", "pYAxisName"]
                        },
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "valuePosition", "rotateValues", "placeValuesInside", "showYAxisValues", "showLimits", "showDivLineValues", "showSecondaryLimits", "showDivLineSecondaryValue", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateYAxisName", "yAxisNameWidth", "clickURL", "pYAxisMaxValue", "pYAxisMinValue", "setAdaptiveYMin", "pYAxisNameWidth", "sYAxisNameWidth", "showCumulativeLine", "showLineValues", "useDataPlotColorForLabels"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Primary Y-axis Name Cosmetics",
                            prop: ["pYAxisNameFont", "pYAxisNameFontColor", "pYAxisNameFontSize", "pYAxisNameFontBold", "pYAxisNameFontItalic", "pYAxisNameBgColor", "pYAxisNameBorderColor", "pYAxisNameAlpha", "pYAxisNameFontAlpha", "pYAxisNameBgAlpha", "pYAxisNameBorderAlpha", "pYAxisNameBorderPadding", "pYAxisNameBorderRadius", "pYAxisNameBorderThickness", "pYAxisNameBorderDashed", "pYAxisNameBorderDashLen", "pYAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "showAlternateVGridColor", "alternateVGridColor", "alternateVGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["useRoundEdges", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillRatio", "plotFillAlpha", "plotGradientColor", "lineColor", "lineThickness", "lineAlpha", "lineDashed", "lineDashLen", "lineDashGap"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "set": ["label", "value", "displayValue", "color", "link", "toolText", "showLabel", "showValue", "dashed", "alpha", "labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"],
            "Vertical data separator lines": ["color", "thickness", "alpha", "dashed", "dashLen", "dashGap", "label", "showLabelBorder", "linePosition", "labelPosition", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        Pareto3D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {
                            id: "Titles (Axis) Names",
                            prop: ["caption", "subCaption", "xAxisName", "sYAxisName", "pYAxisName"]
                        },
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "valuePosition", "rotateValues", "placeValuesInside", "showYAxisValues", "showLimits", "showDivLineValues", "showSecondaryLimits", "showDivLineSecondaryValue", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateYAxisName", "yAxisNameWidth", "clickURL", "maxColWidth", "use3DLighting", "pYAxisMaxValue", "pYAxisMinValue", "setAdaptiveYMin", "pYAxisNameWidth", "sYAxisNameWidth", "showCumulativeLine", "showLineValues", "primaryAxisOnLeft", "use3DLineShift", "useDataPlotColorForLabels"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Primary Y-axis Name Cosmetics",
                            prop: ["pYAxisNameFont", "pYAxisNameFontColor", "pYAxisNameFontSize", "pYAxisNameFontBold", "pYAxisNameFontItalic", "pYAxisNameBgColor", "pYAxisNameBorderColor", "pYAxisNameAlpha", "pYAxisNameFontAlpha", "pYAxisNameBgAlpha", "pYAxisNameBorderAlpha", "pYAxisNameBorderPadding", "pYAxisNameBorderRadius", "pYAxisNameBorderThickness", "pYAxisNameBorderDashed", "pYAxisNameBorderDashLen", "pYAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "canvasBgColor", "canvasBgAlpha", "canvasBaseColor", "showCanvasBg", "xAxisLineColor", "showCanvasBase", "canvasBaseDepth", "canvasBgDepth", "showBorder", "borderColor", "borderThickness", "borderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneShowBorder", "zeroPlaneBorderColor"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showPlotBorder", "plotBorderColor", "plotBorderAlpha", "plotFillAlpha", "lineColor", "lineThickness", "lineAlpha", "lineDashed", "lineDashLen", "lineDashGap", "overlapColumns"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "set": ["label", "value", "displayValue", "color", "link", "toolText", "showLabel", "showValue", "dashed", "alpha", "labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"],
            "Vertical data separator lines": ["color", "thickness", "alpha", "dashed", "dashLen", "dashGap", "label", "showLabelBorder", "linePosition", "labelPosition", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        MSColumn2D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "rotateValues", "placeValuesInside", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateYAxisName", "yAxisNameWidth", "clickURL", "yAxisMinValue", "yAxisMaxValue", "setAdaptiveYMin"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendItemHoverFontColor", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendIconScale", "legendItemHiddenColor", "legendPosition", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineIsDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["useRoundEdges", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillRatio", "plotFillAlpha", "plotGradientColor"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "ratio", "showValues", "dashed", "includeInLegend"],
            "set": ["label", "value", "displayValue", "color", "link", "toolText", "showLabel", "showValue", "dashed", "alpha"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        MSColumn3D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "rotateValues", "placeValuesInside", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateYAxisName", "yAxisNameWidth", "clickURL", "maxColWidth", "use3DLighting", "yAxisMinValue", "yAxisMaxValue", "setAdaptiveYMin"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendItemHoverFontColor", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendIconScale", "legendItemHiddenColor", "legendPosition", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneAlpha", "zeroPlaneShowBorder", "showZeroPlaneValue", "zeroPlaneBorderColor"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showPlotBorder", "plotBorderColor", "plotBorderAlpha", "plotFillAlpha", "overlapColumns"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "ratio", "showValues", "dashed", "includeInLegend"],
            "set": ["label", "value", "displayValue", "color", "link", "toolText", "showLabel", "showValue", "alpha"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        MSLine: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "connectNullData", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "valuePosition", "rotateValues", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateYAxisName", "yAxisNameWidth", "clickURL", "yAxisMinValue", "yAxisMaxValue", "setAdaptiveYMin"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendItemHoverFontColor", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendIconScale", "legendItemHiddenColor", "legendPosition", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numVDivLines", "vDivLineColor", "vDivLineThickness", "vDivLineAlpha", "vDivLineDashed", "vDivLineDashLen", "vDivLineDashGap", "showAlternateVGridColor", "alternateVGridColor", "alternateVGridAlpha", "numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha", "showZeroPlane"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["lineColor", "lineThickness", "lineAlpha", "lineDashed", "lineDashLen", "lineDashGap"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["includeInLegend", "seriesName", "color", "alpha", "showValues", "valuePosition", "dashed", "drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha", "lineThickness", "lineDashLen", "lineDashGap"],
            "set": ["value", "displayValue", "color", "link", "toolText", "showValue", "valuePosition", "alpha", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha", "dashed"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        ZoomLine: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["palette", "paletteColors", "connectNullData", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "showValues", "valuePosition", "rotateValues", "yAxisMaxValue", "yAxisMinValue", "yAxisNameWidth", "showShadow", "rotateYAxisName", "setAdaptiveYMin", "compactDataMode", "dataSeparator", "numMinorLogDivLines", "allowPinMode", "numVisibleLabels", "anchorMinRenderDistance", "displayStartIndex", "displayEndIndex", "pixelsPerPoint"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink", "paletteThemeColor", "toolbarButtonColor", "zoomPaneBorderColor", "zoomPaneBgColor", "zoomPaneBgAlpha", "pinLineThicknessDelta", "pinPaneBgColor", "pinPaneBgAlpha", "btnZoomOutTitle", "btnSwitchtoZoomModeTitle", "btnSwitchToPinModeTitle", "showToolBarButtonTooltext", "btnResetChartTooltext", "btnSwitchToPinModeTooltext", "resetChartMenuItemLabel", "zoomModeMenuItemLabel", "pinModeMenuItemLabel", "toolBarBtnTextHMargin", "toolBarBtnHPadding", "toolBarBtnVPadding"]
                        },
                        {id: "Scroll Properties", prop: ["scrollColor", "scrollHeight"]},
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorBgAlpha", "anchorMinRenderDistance"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendPosition", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendCaptionFontColor", "legendItemHiddenColor", "legendIconScale", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "useCrossLine"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {id: "Data Plot Cosmetics", prop: ["lineColor", "lineThickness", "lineAlpha"]},
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "showValues", "valuePosition", "drawAnchors", "anchorRadius", "lineThickness", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorBgAlpha", "includeInLegend", "dashed"],
            "set": ["value", "displayValue", "toolText"],
            "Vertical Trend Lines": ["startIndex", "endIndex", "displayValue", "displayAlways", "displayWhenCount", "color", "showOnTop", "thickness", "alpha", "valueOnTop"],
            "Trend Lines": ["valueOnRight", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "startValue", "endValue", "displayValue", "toolText"]
        },
        MSArea: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "connectNullData", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "valuePosition", "rotateValues", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateYAxisName", "yAxisNameWidth", "clickURL", "yAxisMinValue", "yAxisMaxValue", "setAdaptiveYMin"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendItemHoverFontColor", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendIconScale", "legendItemHiddenColor", "legendPosition", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha", "numVDivLines", "vDivLineColor", "vDivLineThickness", "vDivLineAlpha", "vDivLineDashed", "vDivLineDashLen", "vDivLineDashGap", "showAlternateVGridColor", "alternateVGridColor", "alternateVGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillAlpha", "plotGradientColor", "plotFillColor"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "showValues", "dashed", "includeInLegend", "drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha"],
            "set": ["value", "displayValue", "link", "toolText", "showValue", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        MSBar2D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showLabels", "labelStep", "maxLabelWidthPercent", "useEllipsesWhenOverflow", "showValues", "placeValuesInside", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "showShadow", "adjustDiv", "clickURL", "rotateXAxisName", "xAxisNameWidth", "yAxisMinValue", "yAxisMaxValue", "setAdaptiveYMin", "centerXaxisName"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendItemHoverFontColor", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendIconScale", "legendItemHiddenColor", "legendPosition", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineIsDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["useRoundEdges", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillRatio", "plotFillAlpha", "plotGradientColor"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "ratio", "showValues", "dashed", "includeInLegend"],
            "set": ["label", "value", "displayValue", "color", "link", "toolText", "showLabel", "showValue", "dashed", "alpha"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        MSBar3D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showLabels", "labelStep", "maxLabelWidthPercent", "useEllipsesWhenOverflow", "showValues", "placeValuesInside", "showYAxisValues", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateXAxisName", "xAxisNameWidth", "clickURL", "yAxisMaxValue", "yAxisMinValue", "maxBarHeight", "use3DLighting", "setAdaptiveYMin", "centerXaxisName"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBaseColor", "showCanvasBg", "showCanvasBase", "canvasBaseDepth", "canvasBgDepth", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendItemHoverFontColor", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendIconScale", "legendItemHiddenColor", "legendPosition", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneAlpha", "zeroPlaneShowBorder", "showZeroPlaneValue", "zeroPlaneBorderColor"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showPlotBorder", "plotBorderColor", "plotBorderAlpha", "plotFillAlpha", "overlapBars"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "ratio", "showValues", "dashed", "includeInLegend"],
            "set": ["label", "value", "displayValue", "color", "link", "toolText", "showLabel", "showValue", "alpha"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        Marimekko: {
            chart: [

                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "rotateValues", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "showShadow", "adjustDiv", "clickURL", "rotateYAxisName", "yAxisNameWidth", "yAxisMaxValue", "yAxisMinValue", "showSum", "usePercentDistribution", "showXAxisPercentValues"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendPosition", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendCaptionFontColor", "legendItemHiddenColor", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "legendIconScale", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineIsDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillRatio", "plotFillAlpha", "plotGradientColor"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "widthPercent", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "ratio", "showValues", "dashed", "includeInLegend"],
            "set": ["label", "value", "displayValue", "color", "link", "toolText", "showLabel", "showValue", "dashed", "alpha"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        StackedColumn2D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "rotateValues", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateYAxisName", "yAxisNameWidth", "clickURL", "showSum", "yAxisMinValue", "yAxisMaxValue", "stack100Percent", "showPercentValues", "showPercentInToolTip"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendItemHoverFontColor", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendIconScale", "legendItemHiddenColor", "legendPosition", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineIsDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["useRoundEdges", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillRatio", "plotFillAlpha", "plotGradientColor"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "ratio", "showValues", "dashed", "includeInLegend"],
            "set": ["label", "value", "displayValue", "color", "link", "toolText", "showLabel", "showValue", "dashed", "alpha"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        StackedColumn3D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "rotateValues", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateYAxisName", "yAxisNameWidth", "clickURL", "maxColWidth", "use3DLighting", "showSum", "yAxisMinValue", "yAxisMaxValue", "stack100Percent", "showPercentValues", "showPercentInToolTip"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendItemHoverFontColor", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendIconScale", "legendItemHiddenColor", "legendPosition", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneAlpha", "zeroPlaneShowBorder", "showZeroPlaneValue", "zeroPlaneBorderColor"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["legendPadding", "captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showPlotBorder", "plotBorderColor", "plotBorderAlpha", "plotFillAlpha", "overlapColumns"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "ratio", "showValues", "dashed", "includeInLegend"],
            "set": ["label", "value", "displayValue", "color", "link", "toolText", "showLabel", "showValue", "alpha"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        StackedArea2D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["numVDivLines", "vDivLineColor", "vDivLineThickness", "vDivLineAlpha", "vDivLineDashed", "vDivLineDashLen", "vDivLineDashGap", "showAlternateVGridColor", "alternateVGridColor", "alternateVGridAlpha", "numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendItemHoverFontColor", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendIconScale", "legendItemHiddenColor", "legendPosition", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha", "numVDivLines", "vDivLineColor", "vDivLineThickness", "vDivLineAlpha", "vDivLineDashed", "vDivLineDashLen", "vDivLineDashGap", "showAlternateVGridColor", "alternateVGridColor", "alternateVGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillAlpha", "plotGradientColor", "plotFillColor"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "showValues", "dashed", "includeInLegend", "drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha"],
            "set": ["value", "displayValue", "link", "toolText", "showValue", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        StackedBar2D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showLabels", "labelStep", "maxLabelWidthPercent", "useEllipsesWhenOverflow", "showValues", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "showShadow", "adjustDiv", "clickURL", "rotateXAxisName", "xAxisNameWidth", "showSum", "yAxisMinValue", "yAxisMaxValue", "stack100Percent", "showPercentValues", "showPercentInToolTip", "centerXaxisName"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendItemHoverFontColor", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendIconScale", "legendItemHiddenColor", "legendPosition", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateVGridColor", "alternateVGridColor", "alternateVGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "captionPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["useRoundEdges", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillRatio", "plotFillAlpha", "plotGradientColor"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "ratio", "showValues", "dashed", "includeInLegend"],
            "set": ["label", "value", "displayValue", "color", "link", "toolText", "showLabel", "showValue", "dashed", "alpha"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        StackedBar3D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showLabels", "labelStep", "maxLabelWidthPercent", "useEllipsesWhenOverflow", "showValues", "showYAxisValues", "yAxisMinValue", "yAxisMaxValue", "maxBarHeight", "xAxisNameWidth", "clickURL", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateXAxisName", "use3DLighting", "showSum", "stack100Percent", "showPercentValues", "showPercentInToolTip", "centerXaxisName"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBaseColor", "showCanvasBg", "showCanvasBase", "canvasBaseDepth", "canvasBgDepth", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendItemHoverFontColor", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendIconScale", "legendItemHiddenColor", "legendPosition", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneAlpha", "zeroPlaneShowBorder", "showZeroPlaneValue", "zeroPlaneBorderColor"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showPlotBorder", "plotBorderColor", "plotBorderAlpha", "plotFillAlpha", "overlapBars"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "ratio", "showValues", "dashed", "includeInLegend"],
            "set": ["label", "value", "displayValue", "color", "link", "toolText", "showLabel", "showValue", "alpha"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        MSStackedColumn2D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "rotateValues", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateYAxisName", "yAxisNameWidth", "clickURL", "showSum", "yAxisMinValue", "yAxisMaxValue", "stack100Percent", "showPercentValues", "showPercentInToolTip"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendItemHoverFontColor", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendIconScale", "legendItemHiddenColor", "legendPosition", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineIsDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["useRoundEdges", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillRatio", "plotFillAlpha", "plotGradientColor"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "ratio", "showValues", "dashed", "includeInLegend"],
            "set": ["label", "value", "displayValue", "color", "link", "toolText", "showLabel", "showValue", "dashed", "alpha"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        MSCombi2D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "connectNullData", "areaOverColumns", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "valuePosition", "rotateValues", "placeValuesInside", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateYAxisName", "yAxisNameWidth", "clickURL", "yAxisMinValue", "yAxisMaxValue", "setAdaptiveYMin"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendPosition", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendCaptionFontColor", "legendItemHiddenColor", "legendIconScale", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["useRoundEdges", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillAlpha", "plotGradientColor", "lineColor", "lineThickness", "lineAlpha", "lineDashed", "lineDashLen", "lineDashGap"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["renderAs", "parentYAxis", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "seriesName", "color", "alpha", "showValues", "valuePosition", "dashed", "includeInLegend", "drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "lineThickness", "lineDashLen", "lineDashGap"],
            "set": ["value", "displayValue", "color", "link", "toolText", "showValue", "valuePosition", "dashed", "alpha", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        MSCombi3D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "animate3D", "exeTime", "palette", "paletteColors", "connectNullData", "showLabels", "maxLabelHeight", "showValues", "labelStep", "yAxisValuesStep", "showYAxisValues", "showLimits", "showDivLineValues", "adjustDiv", "clickURL", "yAxisMinValue", "yAxisMaxValue", "setAdaptiveYMin", "xAxisTickColor", "xAxisTickAlpha", "xAxisTickThickness"]
                        },
                        {
                            id: "3D Functional Attributes",
                            prop: ["is2D", "clustered", "chartOrder", "chartOnTop", "autoScaling", "allowScaling"]
                        },
                        {
                            id: "3D Camera Light & Rotation",
                            prop: ["startAngX", "startAngY", "endAngX", "endAngY", "cameraAngX", "cameraAngY", "lightAngX", "lightAngY", "intensity", "dynamicShading", "bright2D", "allowRotation", "constrainVerticalRotation", "minVerticalRotAngle", "maxVerticalRotAngle", "constrainHorizontalRotation", "minHorizontalRotAngle", "maxHorizontalRotAngle"]
                        },
                        {id: "3D Plot Cosmetics", prop: ["showPlotBorder", "zDepth", "zGapPlot"]},
                        {id: "3D Canvas Walls Attributes", prop: ["yzWallDepth", "zxWallDepth", "xyWallDepth"]},
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink", "xAxisTickColor", "xAxisTickAlpha", "xAxisTickThickness"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendItemHoverFontColor", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendPosition", "legendItemHiddenColor", "legendCaption", "legendIconScale", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineEffect", "divLineColor", "divLineThickness", "divLineAlpha", "zeroPlaneMesh", "zeroPlaneColor", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["useRoundEdges", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillRatio", "plotFillAlpha", "plotGradientColor"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["renderAs", "seriesName", "color", "showValues", "includeInLegend"],
            "set": ["value", "displayValue", "link", "toolText"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        MSColumnLine3D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "connectNullData", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "valuePosition", "rotateValues", "placeValuesInside", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateYAxisName", "yAxisNameWidth", "clickURL", "maxColWidth", "use3DLighting", "yAxisMinValue", "yAxisMaxValue", "setAdaptiveYMin", "use3DLineShift"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBaseColor", "showCanvasBg", "showCanvasBase", "canvasBaseDepth", "canvasBgDepth", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendItemHoverFontColor", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendIconScale", "legendItemHiddenColor", "legendPosition", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneAlpha", "zeroPlaneShowBorder", "zeroPlaneBorderColor", "showZeroPlaneValue"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["overlapColumns", "showPlotBorder", "plotBorderColor", "plotBorderAlpha", "plotFillAlpha", "lineColor", "lineThickness", "lineAlpha", "lineDashed", "lineDashLen", "lineDashGap"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["renderAs", "parentYAxis", "seriesName", "color", "alpha", "showValues", "valuePosition", "includeInLegend", "drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha", "lineThickness", "dashed", "lineDashLen", "lineDashGap"],
            "set": ["value", "displayValue", "color", "link", "toolText", "showValue", "valuePosition", "alpha", "dashed", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"],
            "Vertical data separator lines": ["color", "thickness", "alpha", "dashed", "dashLen", "dashGap", "label", "showLabelBorder", "linePosition", "labelPosition", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        StackedColumn2DLine: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "connectNullData", "showValues", "valuePosition", "rotateValues", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateYAxisName", "yAxisNameWidth", "clickURL", "showSum", "yAxisMinValue", "yAxisMaxValue"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendItemHoverFontColor", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendIconScale", "legendItemHiddenColor", "legendPosition", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["useRoundEdges", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillRatio", "plotFillAlpha", "plotGradientColor"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["renderAs", "seriesName", "color", "alpha", "ratio", "showValues", "valuePosition", "dashed", "includeInLegend"],
            "set": ["value", "displayValue", "color", "link", "toolText", "showValue", "valuePosition", "dashed", "alpha"],
            "Vertical data separator lines": ["color", "thickness", "alpha", "dashed", "dashLen", "dashGap", "label", "showLabelBorder", "linePosition", "labelPosition", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        StackedColumn3DLine: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "connectNullData", "showValues", "valuePosition", "rotateValues", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateYAxisName", "yAxisNameWidth", "clickURL", "maxColWidth", "use3DLighting", "showSum", "yAxisMinValue", "yAxisMaxValue"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBaseColor", "showCanvasBg", "showCanvasBase", "canvasBaseDepth", "canvasBgDepth", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendItemHoverFontColor", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendIconScale", "legendItemHiddenColor", "legendPosition", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneAlpha", "showZeroPlaneValue", "zeroPlaneShowBorder", "zeroPlaneBorderColor"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["overlapColumns", "showPlotBorder", "plotBorderColor", "plotBorderAlpha", "plotFillAlpha"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["renderAs", "seriesName", "color", "alpha", "showValues", "valuePosition", "includeInLegend"],
            "set": ["value", "displayValue", "color", "link", "toolText", "showValue", "valuePosition", "alpha"],
            "Vertical data separator lines": ["color", "thickness", "alpha", "dashed", "dashLen", "dashGap", "label", "showLabelBorder", "linePosition", "labelPosition", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        MSCombiDY2D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {
                            id: "Titles (Axis) Names",
                            prop: ["caption", "subCaption", "xAxisName", "sYAxisName", "pYAxisName"]
                        },
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "connectNullData", "areaOverColumns", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "valuePosition", "rotateValues", "placeValuesInside", "showYAxisValues", "showLimits", "showDivLineValues", "showSecondaryLimits", "showDivLineSecondaryValue", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateYAxisName", "clickURL", "pYAxisMaxValue", "sYAxisMinValue", "sYAxisMaxValue", "pYAxisMinValue", "setAdaptiveYMin", "setAdaptiveSYMin", "syncAxisLimits", "pYAxisNameWidth", "sYAxisNameWidth"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["pYAxisNameFont", "pYAxisNameFontColor", "pYAxisNameFontSize", "pYAxisNameFontBold", "pYAxisNameFontItalic", "pYAxisNameBgColor", "pYAxisNameBorderColor", "pYAxisNameAlpha", "pYAxisNameFontAlpha", "pYAxisNameBgAlpha", "pYAxisNameBorderAlpha", "pYAxisNameBorderPadding", "pYAxisNameBorderRadius", "pYAxisNameBorderThickness", "pYAxisNameBorderDashed", "pYAxisNameBorderDashLen", "pYAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendPosition", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendCaptionFontColor", "legendItemHiddenColor", "legendIconScale", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showPZeroPlaneValue", "showSZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["useRoundEdges", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillAlpha", "plotGradientColor", "lineColor", "lineThickness", "lineAlpha", "lineDashed", "lineDashLen", "lineDashGap"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "sScaleRecursively", "maxScaleRecursion", "sMaxScaleRecursion", "scaleSeparator", "sScaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "forceSYAxisValueDecimals", "yAxisValueDecimals", "sFormatNumber", "sFormatNumberScale", "sDefaultNumberScale", "sNumberScaleUnit", "sNumberScaleValue", "sNumberPrefix", "sNumberSuffix", "sDecimals", "sYAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["renderAs", "parentYAxis", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "seriesName", "color", "alpha", "showValues", "valuePosition", "dashed", "includeInLegend", "drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "lineThickness", "lineDashLen", "lineDashGap"],
            "set": ["anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha", "value", "displayValue", "color", "link", "toolText", "showValue", "valuePosition", "dashed", "alpha"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["parentYAxis", "startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "toolText"]
        },
        MSColumn3DLineDY: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {
                            id: "Titles (Axis) Names",
                            prop: ["caption", "subCaption", "xAxisName", "pYAxisName", "sYAxisName"]
                        },
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "connectNullData", "showValues", "valuePosition", "rotateValues", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "adjustDiv", "showSecondaryLimits", "showDivLineSecondaryValue", "clickURL", "maxColWidth", "use3DLighting", "showShadow", "pYAxisMaxValue", "pYAxisMinValue", "sYAxisMinValue", "sYAxisMaxValue", "setAdaptiveYMin", "setAdaptiveSYMin", "syncAxisLimits", "rotateYAxisName", "pYAxisNameWidth", "sYAxisNameWidth", "use3DLineShift", "primaryAxisOnLeft"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["pYAxisNameFont", "pYAxisNameFontColor", "pYAxisNameFontSize", "pYAxisNameFontBold", "pYAxisNameFontItalic", "pYAxisNameBgColor", "pYAxisNameBorderColor", "pYAxisNameAlpha", "pYAxisNameFontAlpha", "pYAxisNameBgAlpha", "pYAxisNameBorderAlpha", "pYAxisNameBorderPadding", "pYAxisNameBorderRadius", "pYAxisNameBorderThickness", "pYAxisNameBorderDashed", "pYAxisNameBorderDashLen", "pYAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBaseColor", "showCanvasBg", "showCanvasBase", "canvasBaseDepth", "canvasBgDepth", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendPosition", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendCaptionFontColor", "legendItemHiddenColor", "legendIconScale", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneAlpha", "showPZeroPlaneValue", "showSZeroPlaneValue", "zeroPlaneShowBorder", "zeroPlaneBorderColor"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["overlapColumns", "showPlotBorder", "plotBorderColor", "plotBorderAlpha", "plotFillAlpha", "lineColor", "lineThickness", "lineAlpha", "lineDashed", "lineDashLen", "lineDashGap"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "sScaleRecursively", "maxScaleRecursion", "sMaxScaleRecursion", "scaleSeparator", "sScaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "forceSYAxisValueDecimals", "yAxisValueDecimals", "sFormatNumber", "sFormatNumberScale", "sDefaultNumberScale", "sNumberScaleUnit", "sNumberScaleValue", "sNumberPrefix", "sNumberSuffix", "sDecimals", "sYAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["parentYAxis", "seriesName", "color", "alpha", "showValues", "valuePosition", "includeInLegend", "drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha", "lineThickness", "dashed", "lineDashLen", "lineDashGap"],
            "set": ["dashed", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha", "value", "displayValue", "color", "link", "toolText", "showValue", "valuePosition", "alpha"],
            "Vertical data separator lines": ["color", "thickness", "alpha", "dashed", "dashLen", "dashGap", "label", "showLabelBorder", "linePosition", "labelPosition", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["parentYAxis", "startValue", "endValue", "displayValue", "color", "isTrendZone", "thickness", "alpha", "dashed", "dashLen", "dashGap", "toolText"]
        },
        StackedColumn3DLineDY: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {
                            id: "Titles (Axis) Names",
                            prop: ["caption", "subCaption", "xAxisName", "pYAxisName", "sYAxisName"]
                        },
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "connectNullData", "showValues", "valuePosition", "rotateValues", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "adjustDiv", "showSecondaryLimits", "showDivLineSecondaryValue", "clickURL", "maxColWidth", "use3DLighting", "showShadow", "pYAxisMinValue", "pYAxisMaxValue", "sYAxisMinValue", "sYAxisMaxValue", "setAdaptiveSYMin", "syncAxisLimits", "rotateYAxisName", "pYAxisNameWidth", "sYAxisNameWidth", "use3DLineShift", "primaryAxisOnLeft"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["pYAxisNameFont", "pYAxisNameFontColor", "pYAxisNameFontSize", "pYAxisNameFontBold", "pYAxisNameFontItalic", "pYAxisNameBgColor", "pYAxisNameBorderColor", "pYAxisNameAlpha", "pYAxisNameFontAlpha", "pYAxisNameBgAlpha", "pYAxisNameBorderAlpha", "pYAxisNameBorderPadding", "pYAxisNameBorderRadius", "pYAxisNameBorderThickness", "pYAxisNameBorderDashed", "pYAxisNameBorderDashLen", "pYAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showSum", "showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "xAxisLineColor", "bgImageScale", "canvasBgColor", "canvasBgAlpha", "canvasBaseColor", "showCanvasBg", "showCanvasBase", "canvasBaseDepth", "canvasBgDepth", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendPosition", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendCaptionFontColor", "legendItemHiddenColor", "legendIconScale", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneAlpha", "showPZeroPlaneValue", "showSZeroPlaneValue", "zeroPlaneShowBorder", "zeroPlaneBorderColor"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["legendPadding", "captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["overlapColumns", "showPlotBorder", "plotBorderColor", "plotBorderAlpha", "plotFillAlpha", "lineColor", "lineThickness", "lineAlpha", "lineDashed", "lineDashLen", "lineDashGap"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "sScaleRecursively", "maxScaleRecursion", "sMaxScaleRecursion", "scaleSeparator", "sScaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "forceSYAxisValueDecimals", "yAxisValueDecimals", "sFormatNumber", "sFormatNumberScale", "sDefaultNumberScale", "sNumberScaleUnit", "sNumberScaleValue", "sNumberPrefix", "sNumberSuffix", "sDecimals", "sYAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["parentYAxis", "seriesName", "color", "alpha", "showValues", "valuePosition", "includeInLegend", "drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha", "lineThickness", "dashed", "lineDashLen", "lineDashGap"],
            "set": ["dashed", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha", "value", "displayValue", "color", "link", "toolText", "showValue", "valuePosition", "alpha"],
            "Vertical data separator lines": ["color", "thickness", "alpha", "dashed", "dashLen", "dashGap", "label", "showLabelBorder", "linePosition", "labelPosition", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["parentYAxis", "startValue", "endValue", "displayValue", "color", "isTrendZone", "thickness", "alpha", "dashed", "dashLen", "dashGap", "toolText"]
        },
        MSStackedColumn2DLineDY: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {
                            id: "Titles (Axis) Names",
                            prop: ["caption", "subCaption", "xAxisName", "pYAxisName", "sYAxisName"]
                        },
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "connectNullData", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "valuePosition", "showYAxisValues", "showLimits", "showDivLineValues", "showSecondaryLimits", "showDivLineSecondaryValue", "showSum", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateYAxisName", "rotateValues", "clickURL", "pYAxisMinValue", "pYAxisMaxValue", "sYAxisMinValue", "sYAxisMaxValue", "setAdaptiveSYMin", "syncAxisLimits", "pYAxisNameWidth", "sYAxisNameWidth"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["pYAxisNameFont", "pYAxisNameFontColor", "pYAxisNameFontSize", "pYAxisNameFontBold", "pYAxisNameFontItalic", "pYAxisNameBgColor", "pYAxisNameBorderColor", "pYAxisNameAlpha", "pYAxisNameFontAlpha", "pYAxisNameBgAlpha", "pYAxisNameBorderAlpha", "pYAxisNameBorderPadding", "pYAxisNameBorderRadius", "pYAxisNameBorderThickness", "pYAxisNameBorderDashed", "pYAxisNameBorderDashLen", "pYAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendPosition", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendCaptionFontColor", "legendItemHiddenColor", "legendIconScale", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showPZeroPlaneValue", "showSZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["legendPadding", "captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["useRoundEdges", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillRatio", "plotFillAlpha", "plotGradientColor", "lineColor", "lineThickness", "lineAlpha", "lineDashed", "lineDashLen", "lineDashGap"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "sScaleRecursively", "maxScaleRecursion", "sMaxScaleRecursion", "scaleSeparator", "sScaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "forceSYAxisValueDecimals", "yAxisValueDecimals", "sFormatNumber", "sFormatNumberScale", "sDefaultNumberScale", "sNumberScaleUnit", "sNumberScaleValue", "sNumberPrefix", "sNumberSuffix", "sDecimals", "sYAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["includeInLegend", "seriesName", "color", "alpha", "ratio", "showValues", "valuePosition", "dashed"],
            "set": ["value", "displayValue", "color", "link", "toolText", "showValue", "valuePosition", "alpha", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha", "dashed"],
            "lineset": ["includeInLegend", "seriesName", "color", "alpha", "showValues", "valuePosition", "dashed", "lineDashLen", "lineDashGap", "lineThickness", "drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorBgAlpha", "anchorAlpha"],
            "line": ["value", "displayValue", "color", "link", "toolText", "showValue", "valuePosition", "alpha", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha", "dashed"],
            "Vertical data separator lines": ["color", "thickness", "alpha", "dashed", "dashLen", "dashGap", "label", "showLabelBorder", "linePosition", "labelPosition", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["parentYAxis", "startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "toolText"]
        },
        Scatter: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "xAxisLabelMode", "staggerLines", "showValues", "showYAxisValues", "showXAxisValues", "rotateValues", "showLimits", "showVLimits", "showDivLineValues", "showVDivLineValues", "xAxisMinValue", "xAxisMaxValue", "yAxisMinValue", "yAxisMaxValue", "yAxisValuesStep", "xAxisValuesStep", "adjustDiv", "adjustVDiv", "rotateYAxisName", "yAxisNameWidth", "clickURL", "setAdaptiveYMin", "setAdaptiveXMin", "showRegressionLine", "showYOnX", "regressionLineColor", "regressionLineThickness", "regressionLineAlpha"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Quadrants",
                            prop: ["drawQuadrant", "quadrantXVal", "quadrantYVal", "quadrantLineColor", "quadrantLineThickness", "quadrantLineAlpha", "quadrantLineDashed", "quadrantLineDashLen", "quadrantLineDashGap", "quadrantLabelTL", "quadrantLabelTR", "quadrantLabelBL", "quadrantLabelBR", "quadrantLabelPadding"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendPosition", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendCaptionFontColor", "legendItemHiddenColor", "legendIconScale", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha", "numVDivLines", "vDivLineColor", "vDivLineThickness", "vDivLineAlpha", "vDivLineDashed", "vDivLineDashLen", "vDivLineDashGap", "showAlternateVGridColor", "alternateVGridColor", "alternateVGridAlpha", "showZeroPlane", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showVZeroPlane", "vZeroPlaneColor", "vZeroPlaneThickness", "vZeroPlaneAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "valuePadding", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["lineThickness", "lineAlpha", "lineDashed", "lineDashLen", "lineDashGap"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "yFormatNumber", "xFormatNumber", "formatNumberScale", "yFormatNumberScale", "xFormatNumberScale", "defaultNumberScale", "yDefaultNumberScale", "xDefaultNumberScale", "numberScaleUnit", "yNumberScaleUnit", "xNumberScaleUnit", "numberScaleValue", "scaleRecursively", "xScaleRecursively", "maxScaleRecursion", "xMaxScaleRecursion", "scaleSeparator", "xScaleSeparator", "yNumberScaleValue", "numberPrefix", "yNumberPrefix", "xNumberPrefix", "numberSuffix", "yNumberSuffix", "xNumberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "forceXAxisValueDecimals", "yAxisValueDecimals", "xAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor", "verticalLineColor", "verticalLineThickness", "verticalLineAlpha", "verticalLineDashed", "verticalLineDashLen", "verticalLineDashGap"],
            "category": ["x", "label", "showLabel", "showVerticalLine", "lineDashed", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "showValues", "includeInLegend", "drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha", "drawLine", "lineColor", "lineAlpha", "lineThickness", "lineDashed", "lineDashLen", "lineDashGap", "showRegressionLine", "showYOnX", "regressionLineColor", "regressionLineThickness", "regressionLineAlpha"],
            "set": ["x", "y", "displayValue", "link", "toolText", "showValue"],
            "Vertical Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "thickness", "alpha", "dashed", "dashLen", "dashGap", "toolText"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight"]
        },
        Bubble: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "clipBubbles", "negativeColor", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "xAxisLabelMode", "staggerLines", "showValues", "showYAxisValues", "showXAxisValues", "showLimits", "showVLimits", "showDivLineValues", "showVDivLineValues", "xAxisMinValue", "xAxisMaxValue", "yAxisMinValue", "yAxisMaxValue", "use3DLighting", "bubbleScale", "yAxisValuesStep", "xAxisValuesStep", "adjustDiv", "adjustVDiv", "rotateYAxisName", "yAxisNameWidth", "clickURL", "setAdaptiveYMin", "setAdaptiveXMin", "showRegressionLine", "showYOnX", "regressionLineColor", "regressionLineThickness", "regressionLineAlpha"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Quadrants",
                            prop: ["drawQuadrant", "quadrantXVal", "quadrantYVal", "quadrantLineColor", "quadrantLineThickness", "quadrantLineAlpha", "quadrantLineDashed", "quadrantLineDashLen", "quadrantLineDashGap", "quadrantLabelTL", "quadrantLabelTR", "quadrantLabelBL", "quadrantLabelBR", "quadrantLabelPadding"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendPosition", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendCaptionFontColor", "legendItemHiddenColor", "legendIconScale", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha", "numVDivLines", "vDivLineColor", "vDivLineThickness", "vDivLineAlpha", "vDivLineDashed", "vDivLineDashLen", "vDivLineDashGap", "showAlternateVGridColor", "alternateVGridColor", "alternateVGridAlpha", "showZeroPlane", "showZeroPlaneValue", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showVZeroPlane", "vZeroPlaneColor", "vZeroPlaneThickness", "vZeroPlaneAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotFillAlpha"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "yFormatNumber", "xFormatNumber", "formatNumberScale", "yFormatNumberScale", "xFormatNumberScale", "defaultNumberScale", "yDefaultNumberScale", "xDefaultNumberScale", "numberScaleUnit", "yNumberScaleUnit", "xNumberScaleUnit", "numberScaleValue", "scaleRecursively", "xScaleRecursively", "maxScaleRecursion", "xMaxScaleRecursion", "scaleSeparator", "xScaleSeparator", "yNumberScaleValue", "numberPrefix", "yNumberPrefix", "xNumberPrefix", "numberSuffix", "yNumberSuffix", "xNumberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "forceXAxisValueDecimals", "yAxisValueDecimals", "xAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor", "verticalLineColor", "verticalLineThickness", "verticalLineAlpha", "verticalLineDashed", "verticalLineDashLen", "verticalLineDashGap"],
            "category": ["x", "label", "showLabel", "showVerticalLine", "lineDashed", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "plotFillAlpha", "showValues", "includeInLegend", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "showRegressionLine", "showYOnX", "regressionLineColor", "regressionLineThickness", "regressionLineAlpha"],
            "set": ["x", "y", "z", "displayValue", "name", "color", "link", "toolText", "showValue", "alpha"],
            "Vertical Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "thickness", "alpha", "dashed", "dashLen", "dashGap", "toolText"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight"]
        },
        ScrollColumn2D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {
                            id: "Titles (Axis) Names",
                            prop: ["caption", "subCaption", "xAxisName", "yAxisName", "rotateYAxisName", "yAxisNameWidth", "centerYaxisName"]
                        },
                        {
                            id: "Functional Attributes",
                            prop: ["numVisiblePlot", "animation", "palette", "paletteColors", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "rotateValues", "placeValuesInside", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "showShadow", "adjustDiv", "clickURL", "rotateYAxisName", "yAxisNameWidth", "yAxisMaxValue", "yAxisMinValue", "setAdaptiveYMin", "scrollToEnd"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Scroll Bar Properties",
                            prop: ["scrollColor", "scrollHeight", "scrollPadding", "scrollBtnWidth", "scrollBtnPadding"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineIsDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendPosition", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendCaptionFontColor", "legendItemHiddenColor", "legendIconScale", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["useRoundEdges", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillRatio", "plotFillAlpha", "plotGradientColor"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "ratio", "showValues", "dashed", "includeInLegend"],
            "set": ["alpha", "showValue", "dashed", "value", "displayValue", "color", "link", "toolText"],
            "Vertical data separator lines": ["color", "thickness", "alpha", "dashed", "dashLen", "dashGap", "label", "showLabelBorder", "linePosition", "labelPosition", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "dashGap", "valueOnRight", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "toolText"]
        },
        ScrollLine2D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["numVisiblePlot", "animation", "palette", "paletteColors", "connectNullData", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "valuePosition", "rotateValues", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisMaxValue", "yAxisMinValue", "yAxisNameWidth", "clickURL", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateYAxisName", "setAdaptiveYMin", "scrollToEnd"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendPosition", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendCaptionFontColor", "legendItemHiddenColor", "legendIconScale", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Scroll Bar Properties",
                            prop: ["scrollColor", "scrollHeight", "scrollPadding", "scrollBtnWidth", "scrollBtnPadding"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["showZeroPlane", "numVDivLines", "vDivLineColor", "vDivLineThickness", "vDivLineAlpha", "vDivLineDashed", "vDivLineDashLen", "vDivLineDashGap", "showAlternateVGridColor", "alternateVGridColor", "alternateVGridAlpha", "numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["lineColor", "lineThickness", "lineAlpha", "lineDashed", "lineDashLen", "lineDashGap"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "showValues", "valuePosition", "dashed", "includeInLegend", "drawAnchors", "anchorSides", "anchorRadius", "lineThickness", "lineDashLen", "lineDashGap", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"],
            "set": ["value", "displayValue", "color", "link", "toolText", "showValue", "valuePosition", "dashed", "alpha", "anchorBgAlpha", "anchorBgColor", "anchorAlpha", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        ScrollArea2D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["numVisiblePlot", "animation", "palette", "paletteColors", "connectNullData", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "rotateValues", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisMaxValue", "yAxisMinValue", "yAxisNameWidth", "clickURL", "yAxisValuesStep", "showShadow", "adjustDiv", "rotateYAxisName", "setAdaptiveYMin", "scrollToEnd"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendPosition", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendCaptionFontColor", "legendItemHiddenColor", "legendIconScale", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Scroll Bar Properties",
                            prop: ["scrollColor", "scrollHeight", "scrollPadding", "scrollBtnWidth", "scrollBtnPadding"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numVDivLines", "vDivLineColor", "vDivLineThickness", "vDivLineAlpha", "vDivLineDashed", "vDivLineDashLen", "vDivLineDashGap", "showAlternateVGridColor", "alternateVGridColor", "alternateVGridAlpha", "numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillAlpha", "plotGradientColor", "plotFillColor"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "showValues", "dashed", "includeInLegend", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"],
            "set": ["value", "displayValue", "link", "toolText", "showValue", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        ScrollStackedColumn2D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["numVisiblePlot", "animation", "palette", "paletteColors", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "rotateValues", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "showShadow", "yAxisMinValue", "yAxisMaxValue", "showSum", "adjustDiv", "rotateYAxisName", "yAxisNameWidth", "clickURL", "scrollToEnd", "stack100Percent", "showPercentValues", "showPercentInToolTip"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Scroll Bar Properties",
                            prop: ["scrollColor", "scrollHeight", "scrollPadding", "scrollBtnWidth", "scrollBtnPadding"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendItemHoverFontColor", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendIconScale", "legendItemHiddenColor", "legendPosition", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Anchors",
                            prop: ["anchorAlpha", "anchorBgAlpha", "drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineIsDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["useRoundEdges", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillRatio", "plotFillAlpha", "plotGradientColor"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "ratio", "showValues", "dashed", "includeInLegend"],
            "set": ["label", "value", "displayValue", "color", "link", "toolText", "showLabel", "showValue", "dashed", "alpha"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        ScrollCombi2D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption", "xAxisName", "yAxisName"]},
                        {
                            id: "Functional Attributes",
                            prop: ["numVisiblePlot", "animation", "palette", "paletteColors", "connectNullData", "areaOverColumns", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "valuePosition", "rotateValues", "placeValuesInside", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "showShadow", "adjustDiv", "clickURL", "rotateYAxisName", "yAxisNameWidth", "yAxisMaxValue", "yAxisMinValue", "setAdaptiveYMin", "scrollToEnd"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Scroll Bar Properties",
                            prop: ["scrollColor", "scrollHeight", "scrollPadding", "scrollBtnWidth", "scrollBtnPadding"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendItemHoverFontColor", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendIconScale", "legendItemHiddenColor", "legendPosition", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["useRoundEdges", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillAlpha", "plotGradientColor", "lineColor", "lineThickness", "lineAlpha", "lineDashed", "lineDashLen", "lineDashGap"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["renderAs", "parentYAxis", "plotBorderThickness", "showPlotBorder", "seriesName", "color", "alpha", "showValues", "valuePosition", "dashed", "includeInLegend", "drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "lineThickness", "plotBorderAlpha", "plotBorderColor", "lineDashLen", "lineDashGap"],
            "set": ["anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgAlpha", "anchorBgColor", "anchorAlpha", "value", "displayValue", "color", "link", "toolText", "showValue", "valuePosition", "dashed", "alpha"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "valueOnRight", "toolText"]
        },
        ScrollCombiDY2D: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {
                            id: "Titles (Axis) Names",
                            prop: ["caption", "subCaption", "xAxisName", "sYAxisName", "pYAxisName"]
                        },
                        {
                            id: "Functional Attributes",
                            prop: ["numVisiblePlot", "animation", "palette", "paletteColors", "connectNullData", "areaOverColumns", "showLabels", "maxLabelHeight", "labelDisplay", "useEllipsesWhenOverflow", "rotateLabels", "slantLabels", "labelStep", "staggerLines", "showValues", "valuePosition", "rotateValues", "placeValuesInside", "showYAxisValues", "showLimits", "showDivLineValues", "showSecondaryLimits", "showDivLineSecondaryValue", "clickURL", "adjustDiv", "rotateYAxisName", "yAxisValuesStep", "showShadow", "pYAxisMaxValue", "sYAxisMinValue", "sYAxisMaxValue", "pYAxisMinValue", "setAdaptiveYMin", "setAdaptiveSYMin", "syncAxisLimits", "pYAxisNameWidth", "sYAxisNameWidth", "scrollToEnd"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["pYAxisNameFont", "pYAxisNameFontColor", "pYAxisNameFontSize", "pYAxisNameFontBold", "pYAxisNameFontItalic", "pYAxisNameBgColor", "pYAxisNameBorderColor", "pYAxisNameAlpha", "pYAxisNameFontAlpha", "pYAxisNameBgAlpha", "pYAxisNameBorderAlpha", "pYAxisNameBorderPadding", "pYAxisNameBorderRadius", "pYAxisNameBorderThickness", "pYAxisNameBorderDashed", "pYAxisNameBorderDashLen", "pYAxisNameBorderDashGap"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha", "showVLineLabelBorder", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Scroll Bar Properties",
                            prop: ["scrollColor", "scrollHeight", "scrollPadding", "scrollBtnWidth", "scrollBtnPadding"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendPosition", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendCaptionFontColor", "legendItemHiddenColor", "legendIconScale", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showPZeroPlaneValue", "showSZeroPlaneValue", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "plotSpacePercent", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["useRoundEdges", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillAlpha", "plotGradientColor", "lineColor", "lineThickness", "lineAlpha", "lineDashed", "lineDashLen", "lineDashGap"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "sScaleRecursively", "maxScaleRecursion", "sMaxScaleRecursion", "scaleSeparator", "sScaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "forceSYAxisValueDecimals", "yAxisValueDecimals", "sFormatNumber", "sFormatNumberScale", "sDefaultNumberScale", "sNumberScaleUnit", "sNumberScaleValue", "sNumberPrefix", "sNumberSuffix", "sDecimals", "sYAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["renderAs", "parentYAxis", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "seriesName", "color", "alpha", "showValues", "valuePosition", "dashed", "includeInLegend", "drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "lineThickness", "lineDashLen", "lineDashGap"],
            "set": ["anchorSides", "alpha", "link", "toolText", "showValue", "valuePosition", "dashed", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha", "value", "displayValue", "color"],
            "Vertical data separator lines": ["linePosition", "color", "thickness", "showLabelBorder", "label", "labelPosition", "alpha", "dashed", "dashLen", "dashGap", "labelHAlign", "labelVAlign"],
            "Trend Lines": ["parentYAxis", "startValue", "endValue", "displayValue", "color", "isTrendZone", "showOnTop", "thickness", "alpha", "dashed", "dashLen", "dashGap", "toolText"]
        },
        Funnel: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "clickURL", "palette", "paletteThemeColor", "annRenderDelay", "showPrintMenuItem", "manageResize", "useEllipsesWhenOverflow"]
                        },
                        {
                            id: "Funnel Functional Properties",
                            prop: ["streamlinedData", "is2D", "isSliced", "isHollow", "useSameSlantAngle", "funnelYScale"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["bgColor", "bgAlpha", "bgRatio", "bgAngle", "showBorder", "borderColor", "borderThickness", "borderAlpha", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendPosition", "legendCaption", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendItemHiddenColor", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendCaptionFontColor", "legendIconScale", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "legendScrollBarColor", "legendScrollBtnColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "showPercentInToolTip", "toolTipBgColor", "toolTipColor", "toolTipBorderColor", "toolTipSepChar", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotFillAlpha"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Chart Labels and Values",
                            prop: ["showLabels", "showLabelsAtCenter", "labelDistance", "labelSepChar", "enableSmartLabels", "smartLineColor", "smartLineThickness", "smartLineAlpha", "showValues", "showPercentValues", "percentOfPrevious"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "numberPrefix", "numberSuffix", "decimals", "forceDecimals", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator"]
                        },
                        {id: "Font Properties", prop: ["baseFont", "baseFontSize", "baseFontColor"]}
                    ]
                }
            ],
            "set": ["label", "value", "link", "toolText", "color", "alpha", "showValue", "borderColor", "borderAlpha", "isSliced", "labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
        },
        Pyramid: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "clickURL", "palette", "paletteThemeColor", "annRenderDelay", "showPrintMenuItem", "manageResize", "useEllipsesWhenOverflow"]
                        },
                        {id: "Pyramid Functional Properties", prop: ["is2D", "isSliced", "pyramidYScale"]},
                        {
                            id: "Charts Cosmetics",
                            prop: ["bgColor", "bgAlpha", "bgRatio", "bgAngle", "showBorder", "borderColor", "borderThickness", "borderAlpha", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendPosition", "legendCaption", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendItemHiddenColor", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendCaptionFontColor", "legendIconScale", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "legendScrollBarColor", "legendScrollBtnColor", "reverseLegend", "interactiveLegend", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "showPercentInToolTip", "toolTipBgColor", "toolTipColor", "toolTipBorderColor", "toolTipSepChar", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotFillAlpha"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Chart Labels and Values",
                            prop: ["showLabels", "showLabelsAtCenter", "labelDistance", "labelSepChar", "enableSmartLabels", "smartLineColor", "smartLineThickness", "smartLineAlpha", "showValues", "showPercentValues"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "numberPrefix", "numberSuffix", "decimals", "forceDecimals", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator"]
                        },
                        {id: "Font Properties", prop: ["baseFont", "baseFontSize", "baseFontColor"]}
                    ]
                }
            ],
            "set": ["label", "value", "link", "toolText", "color", "alpha", "showValue", "borderColor", "borderAlpha", "isSliced", "labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
        },
        Radar: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption"]},
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "palette", "paletteColors", "showLabels", "labelStep", "showValues", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "adjustDiv", "showPrintMenuItem", "unescapeLinks", "showZeroPlaneValue", "clickURL", "yAxisMinValue", "yAxisMaxValue", "radarRadius", "setAdaptiveYMin"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["showBorder", "borderColor", "borderThickness", "borderAlpha", "bgColor", "bgAlpha", "bgRatio", "bgAngle", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendPosition", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendCaptionFontColor", "legendItemHiddenColor", "legendIconScale", "legendBgColor", "legendBgAlpha", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "interactiveLegend", "legendNumColumns"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "labelPadding", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "legendPadding"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotFillAlpha", "plotFillColor", "showRadarBorder", "radarBorderColor", "radarBorderThickness", "radarBorderAlpha", "radarFillColor", "radarFillAlpha", "radarSpikeColor", "radarSpikeThickness", "radarSpikeAlpha"]
                        },
                        {
                            id: "Data Value Cosmetics",
                            prop: ["valueFont", "valueFontColor", "valueFontSize", "valueFontBold", "valueFontItalic", "valueBgColor", "valueBorderColor", "valueAlpha", "valueFontAlpha", "valueBgAlpha", "valueBorderAlpha", "valueBorderThickness", "valueBorderRadius", "valueBorderDashed", "valueBorderDashGap", "valueBorderDashLen", "valueHoverAlpha", "valueFontHoverAlpha", "valueBgHoverAlpha", "valueBorderHoverAlpha", "showValuesOnHover"]
                        },
                        {
                            id: "Data Label Cosmetics",
                            prop: ["labelFont", "labelFontColor", "labelFontSize", "labelFontBold", "labelFontItalic", "labelBgColor", "labelBorderColor", "labelAlpha", "labelBgAlpha", "labelBorderAlpha", "labelBorderPadding", "labelBorderRadius", "labelBorderThickness", "labelBorderDashed", "labelBorderDashLen", "labelBorderDashGap", "labelLink"]
                        },
                        {
                            id: "Data Plot Hover Effects",
                            prop: ["showHoverEffect", "plotHoverEffect", "plotFillHoverColor", "plotFillHoverAlpha"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "numberPrefix", "numberSuffix", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator", "decimals", "forceDecimals", "forceYAxisValueDecimals", "yAxisValueDecimals"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "showValues", "includeInLegend", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"],
            "set": ["value", "color", "displayValue", "link", "toolText", "showValue", "alpha", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
        },
        RealTimeLine: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {
                            id: "Titles (Axis) Names",
                            prop: ["caption", "subCaption", "xAxisName", "yAxisName", "rotateYAxisName", "yAxisNameWidth"]
                        },
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "connectNullData", "clickURL", "palette", "paletteThemeColor", "paletteColors", "showRTMenuItem", "showPrintMenuItem", "refreshInstantly", "valuePosition", "manageResize", "useEllipsesWhenOverflow"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Chart Y-Axis",
                            prop: ["setAdaptiveYMin", "yAxisMinValue", "yAxisMaxValue", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "yAxisValueDecimals", "forceYAxisDecimals"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["bgColor", "bgAlpha", "bgRatio", "bgAngle", "showBorder", "borderColor", "borderThickness", "borderAlpha", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Canvas Cosmetics",
                            prop: ["canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha", "numVDivLines", "vDivLineColor", "vDivLineThickness", "vDivLineAlpha", "vDivLineDashed", "vDivLineDashLen", "vDivLineDashGap", "showAlternateVGridColor", "alternateVGridColor", "alternateVGridAlpha"]
                        },
                        {
                            id: "Zero Plane Properties",
                            prop: ["showZeroPlane", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendPosition", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendCaptionFontColor", "legendItemHiddenColor", "legendCaption", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendBgColor", "legendBgAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "legendIconScale", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "canvasPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "realTimeValuePadding", "legendPadding", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showShadow", "lineColor", "lineThickness", "lineAlpha", "lineDashed", "lineDashLen", "lineDashGap"]
                        },
                        {
                            id: "Chart Labels and Values",
                            prop: ["showLabels", "maxLabelHeight", "labelDisplay", "slantLabels", "labelStep", "staggerLines", "showValues", "rotateValues"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Real-time Properties",
                            prop: ["dataStreamURL", "refreshInterval", "clearChartInterval", "updateInterval", "numDisplaySets", "dataStamp", "showRealTimeValue", "realTimeValueSep"]
                        },
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "numberPrefix", "numberSuffix", "decimals", "forceDecimals", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor", "realTimeValueFont", "realTimeValueFontSize", "realTimeValueFontColor"]
                        },
                        {
                            id: "Message Logger",
                            prop: ["useMessageLog", "messageLogWPercent", "messageLogHPercent", "messageLogShowTitle", "messageLogTitle", "messageLogColor", "messageGoesToLog", "messageGoesToJS", "messageJSHandler", "messagePassAllToJS"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "showValues", "includeInLegend", "checkForAlerts", "dashed", "lineDashLen", "lineDashGap", "lineThickness", "drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha", "valuePosition"],
            "set": ["value", "link", "toolText", "color", "alpha", "showValue", "dashed", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha", "valuePosition"],
            "Vertical data separator lines": ["label", "color", "thickness", "alpha", "dashed", "dashLen", "dashGap"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "thickness", "isTrendZone", "alpha", "showOnTop", "dashed", "dashLen", "dashGap", "valueOnRight"]
        },
        RealTimeLineDY: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {
                            id: "Titles (Axis) Names",
                            prop: ["caption", "subCaption", "xAxisName", "pYAxisName", "sYAxisName", "rotateYAxisName", "pYAxisNameWidth", "sYAxisNameWidth"]
                        },
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "connectNullData", "clickURL", "palette", "paletteThemeColor", "paletteColors", "showRTMenuItem", "showPrintMenuItem", "refreshInstantly", "valuePosition", "manageResize", "useEllipsesWhenOverflow"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Primary Y-axis Name Cosmetics",
                            prop: ["pYAxisNameFont", "pYAxisNameFontColor", "pYAxisNameFontSize", "pYAxisNameFontBold", "pYAxisNameFontItalic", "pYAxisNameBgColor", "pYAxisNameBorderColor", "pYAxisNameAlpha", "pYAxisNameFontAlpha", "pYAxisNameBgAlpha", "pYAxisNameBorderAlpha", "pYAxisNameBorderPadding", "pYAxisNameBorderRadius", "pYAxisNameBorderThickness", "pYAxisNameBorderDashed", "pYAxisNameBorderDashLen", "pYAxisNameBorderDashGap"]
                        },
                        {
                            id: "Secondary Y-axis Name Cosmetics",
                            prop: ["sYAxisNameFont", "sYAxisNameFontColor", "sYAxisNameFontSize", "sYAxisNameFontBold", "sYAxisNameFontItalic", "sYAxisNameBgColor", "sYAxisNameBorderColor", "sYAxisNameAlpha", "sYAxisNameFontAlpha", "sYAxisNameBgAlpha", "sYAxisNameBorderAlpha", "sYAxisNameBorderPadding", "sYAxisNameBorderRadius", "sYAxisNameBorderThickness", "sYAxisNameBorderDashed", "sYAxisNameBorderDashLen", "sYAxisNameBorderDashGap"]
                        },
                        {
                            id: "Chart Y-Axis",
                            prop: ["setAdaptiveYMin", "setAdaptiveSYMin", "pYAxisMinValue", "pYAxisMaxValue", "sYAxisMinValue", "sYAxisMaxValue", "showYAxisValues", "showLimits", "showDivLineValues", "showSecondaryLimits", "showDivLineSecondaryValue", "yAxisValuesStep", "yAxisValueDecimals", "sYAxisValueDecimals", "forceYAxisDecimals", "forceSYAxisDecimals"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["bgColor", "bgAlpha", "bgRatio", "bgAngle", "showBorder", "borderColor", "borderThickness", "borderAlpha", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Canvas Cosmetics",
                            prop: ["canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha", "numVDivLines", "vDivLineColor", "vDivLineThickness", "vDivLineAlpha", "vDivLineDashed", "vDivLineDashLen", "vDivLineDashGap", "showAlternateVGridColor", "alternateVGridColor", "alternateVGridAlpha"]
                        },
                        {
                            id: "Zero Plane Properties",
                            prop: ["showZeroPlane", "zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendPosition", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendCaptionFontColor", "legendItemHiddenColor", "legendCaption", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendBgColor", "legendBgAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "legendIconScale", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "canvasPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "realTimeValuePadding", "legendPadding", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showShadow", "lineColor", "lineThickness", "lineAlpha", "lineDashed", "lineDashLen", "lineDashGap"]
                        },
                        {
                            id: "Chart Labels and Values",
                            prop: ["showLabels", "maxLabelHeight", "labelDisplay", "slantLabels", "labelStep", "staggerLines", "showValues", "rotateValues"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Real-time Properties",
                            prop: ["dataStreamURL", "refreshInterval", "clearChartInterval", "updateInterval", "numDisplaySets", "dataStamp", "showRealTimeValue", "realTimeValueSep"]
                        },
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "numberPrefix", "numberSuffix", "decimals", "forceDecimals", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator"]
                        },
                        {
                            id: "Number Formatting (Secondary axis)",
                            prop: ["sFormatNumber", "sNumberPrefix", "sNumberSuffix", "sDecimals", "sForceDecimals", "sFormatNumberScale", "sDefaultNumberScale", "sNumberScaleUnit", "sNumberScaleValue", "sScaleRecursively", "sMaxScaleRecursion", "sScaleSeparator"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor", "realTimeValueFont", "realTimeValueFontSize", "realTimeValueFontColor"]
                        },
                        {
                            id: "Message Logger",
                            prop: ["useMessageLog", "messageLogWPercent", "messageLogHPercent", "messageLogShowTitle", "messageLogTitle", "messageLogColor", "messageGoesToLog", "messageGoesToJS", "messageJSHandler", "messagePassAllToJS"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["parentYAxis", "seriesName", "color", "alpha", "showValues", "includeInLegend", "checkForAlerts", "dashed", "lineDashLen", "lineDashGap", "lineThickness", "drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha", "valuePosition"],
            "set": ["value", "link", "toolText", "color", "alpha", "showValue", "dashed", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha", "valuePosition"],
            "Vertical data separator lines": ["label", "color", "thickness", "alpha", "dashed", "dashLen", "dashGap"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "thickness", "isTrendZone", "alpha", "showOnTop", "dashed", "dashLen", "dashGap", "valueOnRight"]
        },
        RealTimeArea: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {
                            id: "Titles (Axis) Names",
                            prop: ["caption", "subCaption", "xAxisName", "yAxisName", "rotateYAxisName", "yAxisNameWidth"]
                        },
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "connectNullData", "clickURL", "palette", "paletteThemeColor", "paletteColors", "showRTMenuItem", "showPrintMenuItem", "refreshInstantly", "manageResize", "useEllipsesWhenOverflow"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Chart Y-Axis",
                            prop: ["setAdaptiveYMin", "yAxisMinValue", "yAxisMaxValue", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "yAxisValueDecimals", "forceYAxisDecimals"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["bgColor", "bgAlpha", "bgRatio", "bgAngle", "showBorder", "borderColor", "borderThickness", "borderAlpha", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Canvas Cosmetics",
                            prop: ["canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha", "numVDivLines", "vDivLineColor", "vDivLineThickness", "vDivLineAlpha", "vDivLineDashed", "vDivLineDashLen", "vDivLineDashGap", "showAlternateVGridColor", "alternateVGridColor", "alternateVGridAlpha"]
                        },
                        {
                            id: "Zero Plane Properties",
                            prop: ["zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendPosition", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendCaptionFontColor", "legendItemHiddenColor", "legendCaption", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendBgColor", "legendBgAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "legendIconScale", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "canvasPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "realTimeValuePadding", "legendPadding", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showShadow", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillColor", "plotFillAlpha", "plotGradientColor", "plotFillAngle"]
                        },
                        {
                            id: "Chart Labels and Values",
                            prop: ["showLabels", "maxLabelHeight", "labelDisplay", "slantLabels", "labelStep", "staggerLines", "showValues", "rotateValues"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Real-time Properties",
                            prop: ["dataStreamURL", "refreshInterval", "clearChartInterval", "updateInterval", "numDisplaySets", "dataStamp", "showRealTimeValue", "realTimeValueSep"]
                        },
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "numberPrefix", "numberSuffix", "decimals", "forceDecimals", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor", "realTimeValueFont", "realTimeValueFontSize", "realTimeValueFontColor"]
                        },
                        {
                            id: "Message Logger",
                            prop: ["useMessageLog", "messageLogWPercent", "messageLogHPercent", "messageLogShowTitle", "messageLogTitle", "messageLogColor", "messageGoesToLog", "messageGoesToJS", "messageJSHandler", "messagePassAllToJS"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "showValues", "includeInLegend", "checkForAlerts", "dashed", "drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha"],
            "set": ["value", "link", "toolText", "color", "alpha", "showValue", "dashed", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"],
            "Vertical data separator lines": ["label", "color", "thickness", "alpha", "dashed", "dashLen", "dashGap"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "thickness", "isTrendZone", "alpha", "showOnTop", "dashed", "dashLen", "dashGap", "valueOnRight"]
        },
        RealTimeStackedArea: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {
                            id: "Titles (Axis) Names",
                            prop: ["caption", "subCaption", "xAxisName", "yAxisName", "rotateYAxisName", "yAxisNameWidth"]
                        },
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "connectNullData", "clickURL", "palette", "paletteThemeColor", "paletteColors", "showRTMenuItem", "showPrintMenuItem", "refreshInstantly", "stack100Percent", "showPercentValues", "showPercentInToolTip", "manageResize", "useEllipsesWhenOverflow"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Chart Y-Axis",
                            prop: ["setAdaptiveYMin", "yAxisMinValue", "yAxisMaxValue", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "yAxisValueDecimals", "forceYAxisDecimals"]
                        },
                        {
                            id: "Anchors",
                            prop: ["drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["bgColor", "bgAlpha", "bgRatio", "bgAngle", "showBorder", "borderColor", "borderThickness", "borderAlpha", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Canvas Cosmetics",
                            prop: ["canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha", "numVDivLines", "vDivLineColor", "vDivLineThickness", "vDivLineAlpha", "vDivLineDashed", "vDivLineDashLen", "vDivLineDashGap", "showAlternateVGridColor", "alternateVGridColor", "alternateVGridAlpha"]
                        },
                        {
                            id: "Zero Plane Properties",
                            prop: ["zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendPosition", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendCaptionFontColor", "legendItemHiddenColor", "legendCaption", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendBgColor", "legendBgAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "legendIconScale", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "canvasPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "realTimeValuePadding", "legendPadding", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showShadow", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillColor", "plotFillAlpha", "plotGradientColor", "plotFillAngle"]
                        },
                        {
                            id: "Chart Labels and Values",
                            prop: ["showLabels", "maxLabelHeight", "labelDisplay", "slantLabels", "labelStep", "staggerLines", "showValues", "rotateValues"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Real-time Properties",
                            prop: ["dataStreamURL", "refreshInterval", "clearChartInterval", "updateInterval", "numDisplaySets", "dataStamp", "showRealTimeValue", "realTimeValueSep"]
                        },
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "numberPrefix", "numberSuffix", "decimals", "forceDecimals", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor", "realTimeValueFont", "realTimeValueFontSize", "realTimeValueFontColor"]
                        },
                        {
                            id: "Message Logger",
                            prop: ["useMessageLog", "messageLogWPercent", "messageLogHPercent", "messageLogShowTitle", "messageLogTitle", "messageLogColor", "messageGoesToLog", "messageGoesToJS", "messageJSHandler", "messagePassAllToJS"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "showValues", "includeInLegend", "checkForAlerts", "dashed", "drawAnchors", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha"],
            "set": ["value", "link", "toolText", "color", "alpha", "showValue", "dashed", "anchorSides", "anchorRadius", "anchorBorderColor", "anchorBorderThickness", "anchorBgColor", "anchorAlpha", "anchorBgAlpha"],
            "Vertical data separator lines": ["label", "color", "thickness", "alpha", "dashed", "dashLen", "dashGap"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "thickness", "isTrendZone", "alpha", "showOnTop", "dashed", "dashLen", "dashGap", "valueOnRight"]
        },
        RealTimeColumn: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {
                            id: "Titles (Axis) Names",
                            prop: ["caption", "subCaption", "xAxisName", "yAxisName", "rotateYAxisName", "yAxisNameWidth"]
                        },
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "clickURL", "palette", "paletteThemeColor", "paletteColors", "showRTMenuItem", "showPrintMenuItem", "useRoundEdges", "refreshInstantly", "manageResize", "useEllipsesWhenOverflow"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Chart Y-Axis",
                            prop: ["setAdaptiveYMin", "yAxisMinValue", "yAxisMaxValue", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "yAxisValueDecimals", "forceYAxisDecimals"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["bgColor", "bgAlpha", "bgRatio", "bgAngle", "showBorder", "borderColor", "borderThickness", "borderAlpha", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Canvas Cosmetics",
                            prop: ["canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha", "numVDivLines", "vDivLineColor", "vDivLineThickness", "vDivLineAlpha", "vDivLineDashed", "vDivLineDashLen", "vDivLineDashGap", "showAlternateVGridColor", "alternateVGridColor", "alternateVGridAlpha"]
                        },
                        {
                            id: "Zero Plane Properties",
                            prop: ["zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendPosition", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendCaptionFontColor", "legendItemHiddenColor", "legendCaption", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendBgColor", "legendBgAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "legendIconScale", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "canvasPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "realTimeValuePadding", "legendPadding", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showShadow", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillRatio", "plotFillAlpha", "plotGradientColor"]
                        },
                        {
                            id: "Chart Labels and Values",
                            prop: ["showLabels", "maxLabelHeight", "labelDisplay", "slantLabels", "labelStep", "staggerLines", "showValues", "placeValuesInside", "rotateValues"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Real-time Properties",
                            prop: ["dataStreamURL", "refreshInterval", "clearChartInterval", "updateInterval", "numDisplaySets", "dataStamp", "showRealTimeValue", "realTimeValueSep"]
                        },
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "numberPrefix", "numberSuffix", "decimals", "forceDecimals", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor", "realTimeValueFont", "realTimeValueFontSize", "realTimeValueFontColor"]
                        },
                        {
                            id: "Message Logger",
                            prop: ["useMessageLog", "messageLogWPercent", "messageLogHPercent", "messageLogShowTitle", "messageLogTitle", "messageLogColor", "messageGoesToLog", "messageGoesToJS", "messageJSHandler", "messagePassAllToJS"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "showValues", "includeInLegend", "checkForAlerts", "dashed"],
            "set": ["value", "link", "toolText", "color", "alpha", "showValue", "dashed"],
            "Vertical data separator lines": ["label", "color", "thickness", "alpha", "dashed", "dashLen", "dashGap"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "thickness", "isTrendZone", "alpha", "showOnTop", "dashed", "dashLen", "dashGap", "valueOnRight"]
        },
        RealTimeStackedColumn: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {
                            id: "Titles (Axis) Names",
                            prop: ["caption", "subCaption", "xAxisName", "yAxisName", "rotateYAxisName", "yAxisNameWidth"]
                        },
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "clickURL", "palette", "paletteThemeColor", "paletteColors", "showRTMenuItem", "showPrintMenuItem", "useRoundEdges", "refreshInstantly", "stack100Percent", "showPercentValues", "showPercentInToolTip", "manageResize", "useEllipsesWhenOverflow"]
                        },
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "X-axis Name Cosmetics",
                            prop: ["xAxisNameFontColor", "xAxisNameFontSize", "xAxisNameFontBold", "xAxisNameFontItalic", "xAxisNameBgColor", "xAxisNameBorderColor", "xAxisNameAlpha", "xAxisNameFontAlpha", "xAxisNameBgAlpha", "xAxisNameBorderAlpha", "xAxisNameBorderPadding", "xAxisNameBorderRadius", "xAxisNameBorderThickness", "xAxisNameBorderDashed", "xAxisNameBorderDashLen", "xAxisNameBorderDashGap"]
                        },
                        {
                            id: "Y-axis Name Cosmetics",
                            prop: ["yAxisNameFont", "yAxisNameFontColor", "yAxisNameFontSize", "yAxisNameFontBold", "yAxisNameFontItalic", "yAxisNameBgColor", "yAxisNameBorderColor", "yAxisNameAlpha", "yAxisNameFontAlpha", "yAxisNameBgAlpha", "yAxisNameBorderAlpha", "yAxisNameBorderPadding", "yAxisNameBorderRadius", "yAxisNameBorderThickness", "yAxisNameBorderDashed", "yAxisNameBorderDashLen", "yAxisNameBorderDashGap"]
                        },
                        {
                            id: "Chart Y-Axis",
                            prop: ["setAdaptiveYMin", "yAxisMinValue", "yAxisMaxValue", "showYAxisValues", "showLimits", "showDivLineValues", "yAxisValuesStep", "yAxisValueDecimals", "forceYAxisDecimals"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["bgColor", "bgAlpha", "bgRatio", "bgAngle", "showBorder", "borderColor", "borderThickness", "borderAlpha", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Canvas Cosmetics",
                            prop: ["canvasBgColor", "canvasBgAlpha", "canvasBgRatio", "canvasBgAngle", "canvasBorderColor", "canvasBorderThickness", "canvasBorderAlpha"]
                        },
                        {
                            id: "Divisional Lines/Grids",
                            prop: ["numDivLines", "divLineColor", "divLineThickness", "divLineAlpha", "divLineDashed", "divLineDashLen", "divLineDashGap", "showAlternateHGridColor", "alternateHGridColor", "alternateHGridAlpha", "numVDivLines", "vDivLineColor", "vDivLineThickness", "vDivLineAlpha", "vDivLineDashed", "vDivLineDashLen", "vDivLineDashGap", "showAlternateVGridColor", "alternateVGridColor", "alternateVGridAlpha"]
                        },
                        {
                            id: "Zero Plane Properties",
                            prop: ["zeroPlaneColor", "zeroPlaneThickness", "zeroPlaneAlpha", "showZeroPlaneValue"]
                        },
                        {
                            id: "Legend Properties",
                            prop: ["showLegend", "legendItemFontBold", "legendItemFont", "legendItemFontSize", "legendItemFontColor", "legendPosition", "legendCaptionAlignment", "legendCaptionBold", "legendCaptionFont", "legendCaptionFontSize", "legendCaptionFontColor", "legendItemHiddenColor", "legendCaption", "legendBorderColor", "legendBorderThickness", "legendBorderAlpha", "legendBgColor", "legendBgAlpha", "legendShadow", "legendAllowDrag", "legendScrollBgColor", "reverseLegend", "legendIconScale", "legendNumColumns", "minimiseWrappingInLegend"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "toolTipSepChar", "seriesNameInToolTip", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["captionPadding", "canvasPadding", "xAxisNamePadding", "yAxisNamePadding", "yAxisValuesPadding", "labelPadding", "valuePadding", "realTimeValuePadding", "legendPadding", "chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "canvasLeftMargin", "canvasRightMargin", "canvasTopMargin", "canvasBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Data", group: true, sub: [
                        {
                            id: "Data Plot Cosmetics",
                            prop: ["showShadow", "showPlotBorder", "plotBorderColor", "plotBorderThickness", "plotBorderAlpha", "plotBorderDashed", "plotBorderDashLen", "plotBorderDashGap", "plotFillAngle", "plotFillRatio", "plotFillAlpha", "plotGradientColor"]
                        },
                        {
                            id: "Chart Labels and Values",
                            prop: ["showLabels", "maxLabelHeight", "labelDisplay", "slantLabels", "labelStep", "staggerLines", "showValues", "placeValuesInside", "rotateValues", "showSum"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Real-time Properties",
                            prop: ["dataStreamURL", "refreshInterval", "clearChartInterval", "updateInterval", "numDisplaySets", "dataStamp", "showRealTimeValue", "realTimeValueSep"]
                        },
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "numberPrefix", "numberSuffix", "decimals", "forceDecimals", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator"]
                        },
                        {
                            id: "Font Properties",
                            prop: ["baseFont", "baseFontSize", "baseFontColor", "outCnvBaseFont", "outCnvBaseFontSize", "outCnvBaseFontColor", "realTimeValueFont", "realTimeValueFontSize", "realTimeValueFontColor"]
                        },
                        {
                            id: "Message Logger",
                            prop: ["useMessageLog", "messageLogWPercent", "messageLogHPercent", "messageLogShowTitle", "messageLogTitle", "messageLogColor", "messageGoesToLog", "messageGoesToJS", "messageJSHandler", "messagePassAllToJS"]
                        }
                    ]
                }
            ],
            "categories": ["font", "fontSize", "fontColor"],
            "category": ["label", "showLabel", "toolText", "font", "fontColor", "fontSize", "fontBold", "fontItalic", "bgColor", "borderColor", "alpha", "bgAlpha", "borderAlpha", "borderPadding", "borderRadius", "borderThickness", "borderDashed", "borderDashLen", "borderDashGap", "link"],
            "dataset": ["seriesName", "color", "alpha", "showValues", "includeInLegend", "checkForAlerts", "dashed"],
            "set": ["value", "link", "toolText", "color", "alpha", "showValue", "dashed"],
            "Vertical data separator lines": ["label", "color", "thickness", "alpha", "dashed", "dashLen", "dashGap"],
            "Trend Lines": ["startValue", "endValue", "displayValue", "color", "thickness", "isTrendZone", "alpha", "showOnTop", "dashed", "dashLen", "dashGap", "valueOnRight"]
        },

        // the following 5 have root value prop
        /*Bulb:{
            chart:[
                {id:"Chart", group:true, sub:[
                    {id:"Titles (Axis) Names", prop:["caption","subCaption"]},
                    {id:"Functional Attributes", prop:["animation","clickURL","palette","paletteThemeColor","annRenderDelay","autoScale","manageResize","origW","origH","showValue","useColorNameAsValue","placeValuesInside","showPrintMenuItem","refreshInstantly","useEllipsesWhenOverflow"]},
                    {id:"Chart Caption Cosmetics",prop:["captionAlignment","captionOnTop","captionFontSize","subCaptionFontSize","captionFont","subCaptionFont","captionFontColor","subCaptionFontColor","captionFontBold","subCaptionFontBold","alignCaptionWithCanvas","captionHorizontalPadding"]},
                    {id:"Gauge Scale (Color Range)",prop:["gaugeFillAlpha","gaugeOriginX","gaugeOriginY","gaugeRadius","showGaugeBorder","gaugeBorderColor","gaugeBorderThickness","gaugeBorderAlpha","is3D","upperLimit","lowerLimit"]},
                    {id:"Charts Cosmetics", prop:["bgColor","bgAlpha","bgRatio","bgAngle","showBorder","borderColor","borderThickness","borderAlpha","bgImage","bgImageAlpha","bgImageDisplayMode","bgImageVAlign","bgImageHAlign","bgImageScale","xAxisLineColor","logoURL","logoPosition","logoAlpha","logoScale","logoLink"]},
                    {id:"Tool-tip", prop:["showToolTip","toolTipColor","toolTipBgColor","toolTipBorderColor","showToolTipShadow"]},
                    {id:"Paddings and Margins", prop:["chartLeftMargin","chartRightMargin","chartTopMargin","chartBottomMargin","valuePadding"]}
                ]},
                {id:"Others", group:true, sub:[
                    {id:"Real-time Properties",prop:["dataStreamURL","refreshInterval","dataStamp","showRTMenuItem"]},
                    {id:"Number Formatting", prop:["formatNumber","numberPrefix","numberSuffix","decimals","forceDecimals","formatNumberScale","defaultNumberScale","numberScaleUnit","numberScaleValue","scaleRecursively","maxScaleRecursion","scaleSeparator","decimalSeparator","thousandSeparator","thousandSeparatorPosition","inDecimalSeparator","inThousandSeparator"]},
                    {id:"Font Properties", prop:["baseFont","baseFontSize","baseFontColor"]},
                    {id:"Message Logger",prop:["useMessageLog","messageLogWPercent","messageLogHPercent","messageLogShowTitle","messageLogTitle","messageLogColor","messageGoesToLog","messageGoesToJS","messageJSHandler","messagePassAllToJS"]}
                ]},
                {id:"Chart Value", root:1, prop:["value"]}
            ],
            //"colorrange" <=> Trend Lines/line
            "Color Range":["minValue","maxValue","code","label","alpha","borderColor","borderAlpha"]
        }, */
        HLED: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption"]},
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "clickURL", "palette", "paletteThemeColor", "annRenderDelay", "showValue", "autoScale", "manageResize", "origW", "origH", "showShadow", "showPrintMenuItem", "refreshInstantly", "useEllipsesWhenOverflow"]
                        },
                        {
                            id: "Axis and Tick Mark Properties",
                            prop: ["setAdaptiveMin", "upperLimit", "lowerLimit", "lowerLimitDisplay", "upperLimitDisplay", "showTickMarks", "showTickValues", "showLimits", "adjustTM", "ticksBelowGauge", "majorTMNumber", "majorTMColor", "majorTMAlpha", "majorTMHeight", "majorTMThickness", "minorTMNumber", "minorTMColor", "minorTMAlpha", "minorTMHeight", "minorTMThickness", "tickMarkDistance", "tickValueDistance", "tickValueStep", "tickValueDecimals", "forceTickValueDecimals"]
                        },
                        {
                            id: "Gauge Scale (Color Range)",
                            prop: ["gaugeFillColor", "showGaugeBorder", "gaugeBorderColor", "gaugeBorderThickness", "gaugeBorderAlpha"]
                        },
                        {id: "LED Properties", prop: ["ledSize", "ledGap", "useSameFillColor", "useSameFillBgColor"]},
                        {
                            id: "Charts Cosmetics",
                            prop: ["bgColor", "bgAlpha", "bgRatio", "bgAngle", "showBorder", "borderColor", "borderThickness", "borderAlpha", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "valuePadding"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Real-time Properties",
                            prop: ["dataStreamURL", "refreshInterval", "dataStamp", "showRTMenuItem"]
                        },
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "numberPrefix", "numberSuffix", "decimals", "forceDecimals", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator"]
                        },
                        {id: "Font Properties", prop: ["baseFont", "baseFontSize", "baseFontColor"]},
                        {
                            id: "Message Logger",
                            prop: ["useMessageLog", "messageLogWPercent", "messageLogHPercent", "messageLogShowTitle", "messageLogTitle", "messageLogColor", "messageGoesToLog", "messageGoesToJS", "messageJSHandler", "messagePassAllToJS"]
                        }
                    ]
                },
                {id: "Chart Value", root: 1, prop: ["value"]}
            ],
            //colorrange
            "Color Range": ["minValue", "maxValue", "code", "alpha", "borderColor", "borderAlpha"]
        },
        VLED: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption"]},
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "clickURL", "palette", "paletteThemeColor", "annRenderDelay", "showValue", "autoScale", "manageResize", "origW", "origH", "showShadow", "showPrintMenuItem", "refreshInstantly", "useEllipsesWhenOverflow"]
                        },
                        {
                            id: "Axis and Tick Mark Properties",
                            prop: ["setAdaptiveMin", "upperLimit", "lowerLimit", "lowerLimitDisplay", "upperLimitDisplay", "showTickMarks", "showTickValues", "showLimits", "adjustTM", "ticksOnRight", "majorTMNumber", "majorTMColor", "majorTMAlpha", "majorTMHeight", "majorTMThickness", "minorTMNumber", "minorTMColor", "minorTMAlpha", "minorTMHeight", "minorTMThickness", "tickMarkDistance", "tickValueDistance", "tickValueStep", "tickValueDecimals", "forceTickValueDecimals"]
                        },
                        {
                            id: "Gauge Scale (Color Range)",
                            prop: ["gaugeFillColor", "showGaugeBorder", "gaugeBorderColor", "gaugeBorderThickness", "gaugeBorderAlpha"]
                        },
                        {id: "LED Properties", prop: ["ledSize", "ledGap", "useSameFillColor", "useSameFillBgColor"]},
                        {
                            id: "Charts Cosmetics",
                            prop: ["bgColor", "bgAlpha", "bgRatio", "bgAngle", "showBorder", "borderColor", "borderThickness", "borderAlpha", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "valuePadding"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Real-time Properties",
                            prop: ["dataStreamURL", "refreshInterval", "dataStamp", "showRTMenuItem"]
                        },
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "numberPrefix", "numberSuffix", "decimals", "forceDecimals", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator"]
                        },
                        {id: "Font Properties", prop: ["baseFont", "baseFontSize", "baseFontColor"]},
                        {
                            id: "Message Logger",
                            prop: ["useMessageLog", "messageLogWPercent", "messageLogHPercent", "messageLogShowTitle", "messageLogTitle", "messageLogColor", "messageGoesToLog", "messageGoesToJS", "messageJSHandler", "messagePassAllToJS"]
                        }
                    ]
                },
                {id: "Chart Value", root: 1, prop: ["value"]}
            ],
            //colorrange   <=> Trend Lines/line
            "Color Range": ["minValue", "maxValue", "code", "alpha", "borderColor", "borderAlpha"]
        },
        Cylinder: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption"]},
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "showValue", "clickURL", "palette", "paletteThemeColor", "annRenderDelay", "autoScale", "manageResize", "origW", "origH", "showPrintMenuItem", "refreshInstantly", "use3DLighting"]
                        },
                        {
                            id: "Axis and Tick Mark Properties",
                            prop: ["setAdaptiveMin", "upperLimit", "lowerLimit", "lowerLimitDisplay", "upperLimitDisplay", "showTickMarks", "showTickValues", "showLimits", "adjustTM", "ticksOnRight", "majorTMNumber", "majorTMColor", "majorTMAlpha", "majorTMHeight", "majorTMThickness", "minorTMNumber", "minorTMColor", "minorTMAlpha", "minorTMHeight", "minorTMThickness", "tickMarkDistance", "tickValueDistance", "tickValueStep", "tickValueDecimals", "forceTickValueDecimals"]
                        },
                        {
                            id: "Cylinder Properties",
                            prop: ["cylOriginX", "cylOriginY", "cylRadius", "cylHeight", "cylYScale", "cylFillColor"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["bgColor", "bgAlpha", "bgRatio", "bgAngle", "showBorder", "borderColor", "borderThickness", "borderAlpha", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "valuePadding"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Real-time Properties",
                            prop: ["dataStreamURL", "refreshInterval", "dataStamp", "showRTMenuItem"]
                        },
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "numberPrefix", "numberSuffix", "decimals", "forceDecimals", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator"]
                        },
                        {id: "Font Properties", prop: ["baseFont", "baseFontSize", "baseFontColor"]},
                        {
                            id: "Message Logger",
                            prop: ["useMessageLog", "messageLogWPercent", "messageLogHPercent", "messageLogShowTitle", "messageLogTitle", "messageLogColor", "messageGoesToLog", "messageGoesToJS", "messageJSHandler", "messagePassAllToJS"]
                        }
                    ]
                },
                {id: "Chart Value", root: 1, prop: ["value"]}
            ]
        },
        Thermometer: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption"]},
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "Functional Attributes",
                            prop: ["animation", "clickURL", "palette", "paletteThemeColor", "annRenderDelay", "autoScale", "manageResize", "origW", "origH", "showValue", "showShadow", "use3DLighting", "showPrintMenuItem", "refreshInstantly", "useEllipsesWhenOverflow"]
                        },
                        {
                            id: "Axis and Tick Mark Properties",
                            prop: ["setAdaptiveMin", "upperLimit", "lowerLimit", "lowerLimitDisplay", "upperLimitDisplay", "showTickMarks", "showTickValues", "showLimits", "adjustTM", "ticksOnRight", "majorTMNumber", "majorTMColor", "majorTMAlpha", "majorTMHeight", "majorTMThickness", "minorTMNumber", "minorTMColor", "minorTMAlpha", "minorTMHeight", "minorTMThickness", "tickMarkDistance", "tickValueDistance", "tickValueStep", "tickValueDecimals", "forceTickValueDecimals"]
                        },
                        {
                            id: "Thermometer  Properties",
                            prop: ["thmBulbRadius", "thmHeight", "gaugeFillColor", "gaugeFillAlpha", "showGaugeBorder", "gaugeBorderColor", "gaugeBorderThickness", "gaugeBorderAlpha"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["bgColor", "bgAlpha", "bgRatio", "bgAngle", "showBorder", "borderColor", "borderThickness", "borderAlpha", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "valuePadding"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Real-time Properties",
                            prop: ["dataStreamURL", "refreshInterval", "dataStamp", "showRTMenuItem"]
                        },
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "numberPrefix", "numberSuffix", "decimals", "forceDecimals", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator"]
                        },
                        {id: "Font Properties", prop: ["baseFont", "baseFontSize", "baseFontColor"]},
                        {
                            id: "Message Logger",
                            prop: ["useMessageLog", "messageLogWPercent", "messageLogHPercent", "messageLogShowTitle", "messageLogTitle", "messageLogColor", "messageGoesToLog", "messageGoesToJS", "messageJSHandler", "messagePassAllToJS"]
                        }
                    ]
                },
                {id: "Chart Value", root: 1, prop: ["value"]}
            ]
        },

        // special setting
        HLinearGauge: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption"]},
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "Functional Attributes",
                            prop: ["editMode", "animation", "clickURL", "palette", "paletteThemeColor", "annRenderDelay", "autoScale", "manageResize", "origW", "origH", "showValue", "valueAbovePointer", "pointerOnTop", "showShadow", "showPrintMenuItem", "refreshInstantly", "useEllipsesWhenOverflow"]
                        },
                        {
                            id: "Axis and Tick Mark Properties",
                            prop: ["setAdaptiveMin", "upperLimit", "lowerLimit", "lowerLimitDisplay", "upperLimitDisplay", "showTickMarks", "showTickValues", "showLimits", "adjustTM", "ticksBelowGauge", "placeTicksInside", "placeValuesInside", "majorTMNumber", "majorTMColor", "majorTMAlpha", "majorTMHeight", "majorTMThickness", "minorTMNumber", "minorTMColor", "minorTMAlpha", "minorTMHeight", "minorTMThickness", "tickMarkDistance", "tickValueDistance", "trendValueDistance", "tickValueStep", "tickValueDecimals", "forceTickValueDecimals"]
                        },
                        {
                            id: "Gauge Scale (Color Range)",
                            prop: ["showGaugeLabels", "gaugeRoundRadius", "gaugeFillMix", "gaugeFillRatio", "showGaugeBorder", "gaugeBorderColor", "gaugeBorderThickness", "gaugeBorderAlpha"]
                        },
                        {
                            id: "Pointer Properties",
                            prop: ["pointerRadius", "pointerBgColor", "pointerBgAlpha", "pointerSides", "pointerBorderThickness", "pointerBorderColor", "pointerBorderAlpha"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["bgColor", "bgAlpha", "bgRatio", "bgAngle", "showBorder", "borderColor", "borderThickness", "borderAlpha", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin", "valuePadding"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Real-time Properties",
                            prop: ["dataStreamURL", "refreshInterval", "dataStamp", "showRTMenuItem"]
                        },
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "numberPrefix", "numberSuffix", "decimals", "forceDecimals", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator"]
                        },
                        {id: "Font Properties", prop: ["baseFont", "baseFontSize", "baseFontColor"]},
                        {
                            id: "Message Logger",
                            prop: ["useMessageLog", "messageLogWPercent", "messageLogHPercent", "messageLogShowTitle", "messageLogTitle", "messageLogColor", "messageGoesToLog", "messageGoesToJS", "messageJSHandler", "messagePassAllToJS"]
                        }
                    ]
                }
            ],
            //colorrange  <=> Trend Lines/line
            "Color Range": ["minValue", "maxValue", "code", "label", "alpha", "borderColor", "borderAlpha"],
            //trendpoint  <=> Vertical Trend Lines/line
            "Trend Point": ["startValue", "endValue", "displayValue", "showOnTop", "color", "alpha", "dashed", "dashLen", "dashGap", "useMarker", "markerColor", "markerBorderColor", "markerRadius", "markerTooltext"],
            //pointers <=> data
            "pointer": ["id", "value", "showValue", "editMode", "borderColor", "borderThickness", "borderAlpha", "color", "bgAlpha", "radius", "sides", "link", "toolText"]
        },
        AngularGauge: {
            chart: [
                {
                    id: "Chart", group: true, sub: [
                        {id: "Titles (Axis) Names", prop: ["caption", "subCaption"]},
                        {
                            id: "Chart Caption Cosmetics",
                            prop: ["captionAlignment", "captionOnTop", "captionFontSize", "subCaptionFontSize", "captionFont", "subCaptionFont", "captionFontColor", "subCaptionFontColor", "captionFontBold", "subCaptionFontBold", "alignCaptionWithCanvas", "captionHorizontalPadding"]
                        },
                        {
                            id: "Functional Attributes",
                            prop: ["editMode", "animation", "clickURL", "palette", "paletteThemeColor", "annRenderDelay", "autoScale", "manageResize", "origW", "origH", "showValue", "valueBelowPivot", "showShadow", "showPrintMenuItem", "refreshInstantly", "useEllipsesWhenOverflow"]
                        },
                        {
                            id: "Axis and Tick Mark Properties",
                            prop: ["setAdaptiveMin", "upperLimit", "lowerLimit", "lowerLimitDisplay", "upperLimitDisplay", "showTickMarks", "showTickValues", "showLimits", "adjustTM", "placeTicksInside", "placeValuesInside", "majorTMNumber", "majorTMColor", "majorTMAlpha", "majorTMHeight", "majorTMThickness", "minorTMNumber", "minorTMColor", "minorTMAlpha", "minorTMHeight", "minorTMThickness", "tickValueDistance", "trendValueDistance", "tickValueStep", "tickValueDecimals", "forceTickValueDecimals", "autoAlignTickValues"]
                        },
                        {
                            id: "Gauge Scale (Color Range)",
                            prop: ["gaugeStartAngle", "gaugeEndAngle", "gaugeOriginX", "gaugeOriginY", "gaugeOuterRadius", "gaugeInnerRadius", "gaugeFillMix", "gaugeFillRatio", "showGaugeBorder", "gaugeBorderColor", "gaugeBorderThickness", "gaugeBorderAlpha"]
                        },
                        {
                            id: "Pivot Properties",
                            prop: ["pivotRadius", "pivotFillColor", "pivotFillAlpha", "pivotFillAngle", "pivotFillType", "pivotFillMix", "pivotFillRatio", "showPivotBorder", "pivotBorderThickness", "pivotBorderColor", "pivotBorderAlpha"]
                        },
                        {
                            id: "Charts Cosmetics",
                            prop: ["bgColor", "bgAlpha", "bgRatio", "bgAngle", "showBorder", "borderColor", "borderThickness", "borderAlpha", "bgImage", "bgImageAlpha", "bgImageDisplayMode", "bgImageVAlign", "bgImageHAlign", "bgImageScale", "xAxisLineColor", "logoURL", "logoPosition", "logoAlpha", "logoScale", "logoLink"]
                        },
                        {
                            id: "Tool-tip",
                            prop: ["showToolTip", "toolTipColor", "toolTipBgColor", "toolTipBorderColor", "showToolTipShadow"]
                        },
                        {
                            id: "Paddings and Margins",
                            prop: ["chartLeftMargin", "chartRightMargin", "chartTopMargin", "chartBottomMargin"]
                        }
                    ]
                },
                {
                    id: "Others", group: true, sub: [
                        {
                            id: "Real-time Properties",
                            prop: ["dataStreamURL", "refreshInterval", "dataStamp", "showRTMenuItem"]
                        },
                        {
                            id: "Number Formatting",
                            prop: ["formatNumber", "numberPrefix", "numberSuffix", "decimals", "forceDecimals", "formatNumberScale", "defaultNumberScale", "numberScaleUnit", "numberScaleValue", "scaleRecursively", "maxScaleRecursion", "scaleSeparator", "decimalSeparator", "thousandSeparator", "thousandSeparatorPosition", "inDecimalSeparator", "inThousandSeparator"]
                        },
                        {id: "Font Properties", prop: ["baseFont", "baseFontSize", "baseFontColor"]},
                        {
                            id: "Message Logger",
                            prop: ["useMessageLog", "messageLogWPercent", "messageLogHPercent", "messageLogShowTitle", "messageLogTitle", "messageLogColor", "messageGoesToLog", "messageGoesToJS", "messageJSHandler", "messagePassAllToJS"]
                        }
                    ]
                }
            ],
            //colorrange  <=> Trend Lines/line
            "Color Range": ["minValue", "maxValue", "code", "label", "alpha", "borderColor", "borderAlpha"],
    //trendpoint  <=> v Trend Lines/line
    "Trend Point": ["startValue", "endValue", "displayValue", "valueInside", "color", "alpha", "thickness", "showBorder", "borderColor", "radius", "innerRadius", "dashed", "dashLen", "dashGap", "useMarker", "markerColor", "markerBorderColor", "markerRadius", "markerTooltext"],
    //dials   <=> data
    "dial": ["id", "value", "showValue", "valueX", "valueY", "editMode", "borderColor", "borderThickness", "borderAlpha", "bgColor", "radius", "baseWidth", "baseRadius", "topWidth", "rearExtension", "link", "toolText"]
        }
    },
    annotations: {
        annotation: ["autoScale", "constrainScale", "scaleText", "scaleImages", "xShift", "yShift", "grpXShift", "grpYShift", "origW", "origH"],
        group: ["id", "x", "y", "showBelow", "autoScale", "constrainScale", "scaleText", "scaleImages", "xShift", "yShift", "grpXShift", "grpYShift", "link", "color", "alpha", "visible", "showShadow", "toolText", "font", "fontSize", "textAlign", "textVAlign", "rotateText", "wrapText"],
        // item
        line: ["type", "id", "x", "y", "toX", "toY", "fillColor", "fillAlpha", "fillRatio", "fillAngle", "fillPattern", "showBorder", "borderColor", "borderAlpha", "borderThickness", "dashed", "dashLen", "dashGap", "toolText", "link", "showShadow", "thickness"],
        circle: ["type", "id", "x", "y", "toX", "toY", "fillColor", "fillAlpha", "fillRatio", "fillAngle", "fillPattern", "showBorder", "borderColor", "borderAlpha", "borderThickness", "dashed", "dashLen", "dashGap", "toolText", "link", "showShadow", "radius", "yRadius", "startAngle", "endAngle"],
        arc: ["type", "id", "x", "y", "toX", "toY", "fillColor", "fillAlpha", "fillRatio", "fillAngle", "fillPattern", "showBorder", "borderColor", "borderAlpha", "borderThickness", "dashed", "dashLen", "dashGap", "toolText", "link", "showShadow", "radius", "innerRadius", "startAngle", "endAngle"],
        rectangle: ["type", "id", "x", "y", "toX", "toY", "fillColor", "fillAlpha", "fillRatio", "fillAngle", "fillPattern", "showBorder", "borderColor", "borderAlpha", "borderThickness", "dashed", "dashLen", "dashGap", "toolText", "link", "showShadow", "radius"],
        image: ["type", "id", "x", "y", "toX", "toY", "fillColor", "fillAlpha", "fillRatio", "fillAngle", "fillPattern", "showBorder", "borderColor", "borderAlpha", "borderThickness", "dashed", "dashLen", "dashGap", "toolText", "link", "showShadow", "url"],
        polygon: ["type", "id", "x", "y", "toX", "toY", "fillColor", "fillAlpha", "fillRatio", "fillAngle", "fillPattern", "showBorder", "borderColor", "borderAlpha", "borderThickness", "dashed", "dashLen", "dashGap", "toolText", "link", "showShadow", "sides", "radius", "startAngle"],
        path: ["type", "id", "x", "y", "toX", "toY", "fillColor", "fillAlpha", "fillRatio", "fillAngle", "fillPattern", "showBorder", "borderColor", "borderAlpha", "borderThickness", "dashed", "dashLen", "dashGap", "toolText", "link", "showShadow", "path"],
        text: ["type", "id", "x", "y", "toX", "toY", "fillColor", "fillAlpha", "fillRatio", "fillAngle", "fillPattern", "showBorder", "borderColor", "borderAlpha", "borderThickness", "dashed", "dashLen", "dashGap", "toolText", "link", "showShadow", "label", "align", "vAlign", "font", "fontSize", "fontColor", "bold", "italic", "leftMargin", "bgColor", "rotateText", "wrapWidth", "wrapHeight", "wrap"]
    }
};

/*
// To find no configuration items

ood.each(FCCONF.attrCat,function(o1,i1){
    ood.each(o1,function(oo1,key){
        if(key=='chart'){
            ood.arr.each(oo1,function(o2){
                ood.arr.each(o2.sub,function(o3){
                    ood.each(o3.prop,function(key2){
                        if(!(key2 in FCCONF.gridAttr) && !ood.get(FCCONF.gridAttr,[o3.id,key2])){
                            console.log(i1+"=>"+o2.id+"=>"+o3.id+"=>"+key2);
                        }
                    });
                });
            });
        }else{
            ood.each(oo1,function(key2){
                if(!(key2 in FCCONF.gridAttr) && !ood.get(FCCONF.gridAttr,[key,key2])){
                    console.log(i1+"=>"+key+"=>"+key2);
                }
            });
        }
    });
});
ood.each(FCCONF.annotations,function(o1,key){
    ood.arr.each(o1,function(key2){
        if(!(key2 in FCCONF.gridAttr) && !ood.get(FCCONF.gridAttr,["annotations",key2])){
            console.log("annotations=>"+key+"=>"+key2);
        }
    });
});
*/

// A wrap for codemirror(http://codemirror.net/)
ood.Class("RAD.CodeEditor", ["ood.UI.Widget","ood.absValue"] ,{
    Instance:{
        activate:function(){
            var profile = this.get(0);
            if(profile.$cm)profile.$cm.focus();
            if(profile.$cm)profile.$cm.doc.setCursor(profile.readonly_head||0+1,0);
            return this;
        },
        getCM:function(){
            return this.get(0).$cm;
        },
        resetEditorStyle:function(theme, fs, lineWrapping, cm){
            this.addCMTheme(theme);

            var profile = this.get(0);
            if(!cm)cm=profile.$cm;
            if(cm){
                cm.setOption("theme", theme);
                cm.setOption("lineWrapping", !!lineWrapping);
                var n=cm.getWrapperElement();
                if(n){
                    n.style.fontSize=fs+"px";
                }
            }
        },
        showModeSelDlg:function(mm){
           var ns=this,
           cm=ns.getCM(),
           profile=ns.get(0),
           callback=function(mode){
                // force to finish render
                if(!mode || mode.mode==="none"){
                    if(!profile.$initialized)
                        profile.$initialized=true;
                    if(profile.onRendered)
                        profile.boxing().onRendered(profile, true);
                }else{
                    cm.setOption('mode', mode.mime||mode.mode);
                    CodeMirror.autoLoadMode(cm, mode.mode);

                    if(profile.onCodeModeSet)
                        profile.boxing().onCodeModeSet(profile, mode);
                }
                profile=cm=null;
           };
           ood.ModuleFactory.newCom("RAD.SelRenderMode",function(){
                this.setEvents("onSel",callback);
                this.mainDlg.showModal();
                this.modeList.setValue(mm.mime+":"+mm.mode);
           });
        },
        addCMTheme:function(theme){
            var profile = this.get(0);
            var id="cm-theme-"+theme;
            if(theme!="default" && !ood.CSS.get("id",id)){
                ood.CSS.includeLink("codemirror5/theme/"+theme+".css",false,id)
            }
        },
        clearHistory:function(){
            var obj=this.get(0).$cm;
			if(obj)obj.clearHistory();
        },
        reindent:function(){
            var cm=this.get(0).$cm,
                doc=cm.doc;
            if(doc.somethingSelected()){
                var p1=doc.getCursor("start"),
                    p2=doc.getCursor("end");
                for(var i=p1.line,l=p2.line;i<=l;i++)
                    cm.indentLine(i)
            }else{
                var p1=doc.firstLine(),
                    p2=doc.lastLine();
                for(var i=p1,l=p2;i<=l;i++)
                    cm.indentLine(i)
            }
        },
        callEditor:function(name,args,isDoc){
            var obj=this.get(0).$cm;
            if(isDoc)obj=obj.doc;
            return obj[name].apply(obj,args||[]);
        },
        searchCode:function(code){
            var profile = this.get(0),
                cm=profile.$cm;
            if(cm){
                var cursor = cm.getSearchCursor(code, cm.hasFocus()?cm.doc.getCursor():{pos:0,line:0}, true);
                if(cursor.findNext()){
                    cm.focus();
                    cm.doc.setSelection(cursor.from(), cursor.to());
                }
            }            
        },
        // locate to declare key
        locateTo:function(key1, key2, toSelect){
            var ns=this,
                profile = this.get(0),
                cm=profile.$cm,
                struct,info,codefrom,codeto;
            if(cm){
                struct=RAD.ClassTool.getClassStruct2(cm.doc.getValue());
                if(key1){
                    if(key2 && (key1=="Static"||key1=="Instance"))
                        info=ood.get(struct,["sub",key1,"sub",key2]);
                    else
                        info=ood.get(struct,["sub",key1]);
                }
                if(info){
                    if(toSelect)
                        cm.doc.setSelection(cm.doc.posFromIndex(info.from),cm.doc.posFromIndex(info.to));
                    else{
                        var pos=cm.doc.posFromIndex(info.from);
                        cm.focus();
                        cm.doc.setCursor(pos);
                        cm.scrollIntoView(pos);
                    }
                    return true;
                }
            }
            return false;
        },
        focusLine:function(line){
            var ns=this,
                profile = this.get(0),
                cm=profile.$cm,
                pos={line:line,ch:0};
            if(cm){
                    cm.focus();
                    cm.doc.setCursor(pos);
                    cm.scrollIntoView(pos);
            }
        },
        getLine:function(key1, key2, toSelect){
            var ns=this,
                profile = this.get(0),
                cm=profile.$cm,
                struct,info,codefrom,codeto;
            if(cm){
                struct=RAD.ClassTool.getClassStruct2(cm.doc.getValue());
                if(key1){
                    if(key2 && (key1=="Static"||key1=="Instance"))
                        info=ood.get(struct,["sub",key1,"sub",key2]);
                    else
                        info=ood.get(struct,["sub",key1]);
                }
                if(info){
                        return cm.doc.posFromIndex(info.from);
                }
            }
            return null;
        },
        // add code to a hash, or replace the original one
        addCodeInto:function(key1, key2, code, isFun, comments){
            comments=comments||"";
            var ns=this,
                profile = this.get(0),
                cm=profile.$cm;
            if(cm){
                var struct=RAD.ClassTool.getClassStructWithScope(cm.getValue()),
                    fo=ood.get(struct,["sub",key1,"sub",key2]),
                    fo2;
                // There is a function => replace code
                if(fo/* && (fo.type=='function'||fo.type=='object')*/){
                    cm.doc.replaceRange(code,cm.doc.posFromIndex(fo.from),cm.doc.posFromIndex(fo.to));
                    //cm.doc.setSelection(cm.doc.posFromIndex(fo.from), cm.doc.posFromIndex(fo.from+code.length));
                    //ns.reindent();
                }else{
                    if(comments)comments +="\n";

                    fo=ood.get(struct,["sub",key1]);
                    // add first layer
                    if(!fo){
                        fo2=ood.get(struct,["sub",struct.arr[struct.arr.length-1]]);
                        if(fo2)
                            code=",\n"+comments +key1+":{\n"+key2+":"+(isFun?'function()':'')+code+"\n"+"}";
                        else{
                            code=key1+":{\n"+comments +key2+":"+(isFun?'function()':'')+code+"\n"+"}\n";
                            fo2=struct;
                            fo2.to--;
                        }
                    }else{
                        // find the last one
                        fo2=ood.get(fo,["sub",fo.arr[fo.arr.length-1]]);
                        if(fo2)
                            code=",\n"+comments +key2+":"+(isFun?'function()':'')+code;
                        else{
                            code=comments +key2+":"+(isFun?'function()':'')+code+"\n";
                            fo2=fo;
                            fo2.to--;
                        }
                    }
                    var pos=cm.doc.posFromIndex(fo2.to);
                    cm.doc.replaceRange(code, pos, pos);
                    cm.doc.setSelection(pos, cm.doc.posFromIndex(fo2.to+code.length));
                    ns.reindent();
                }
                //locate in the UI
                //ns.locateTo(key1,key2);
            }
        },
        getBlockInfo:function(key1, key2){
            var ns=this,
                profile = this.get(0),
                cm=profile.$cm;
            return cm && ood.get(RAD.ClassTool.getClassStructWithScope(cm.getValue()),["sub",key1,"sub",key2]);
        },
        _refreshCM:function(){
            if(this.get(0).$cm)this.get(0).$cm.refresh();
        },
        _setCtrlValue:function(value){
            if(!ood.isSet(value))value='';
            return this.each(function(profile){
                if(profile.$cm && profile.$cm.getValue()!=value){
                    profile.$cm.doc.setValue(value);
                    if(profile.$tm1)profile.$tm1.clear();
                    if(profile.$tm2)profile.$tm2.clear();
                    delete profile.$tm1;
                    delete profile.$tm2; 
                    delete profile.readonly_head;
                    delete profile.readonly_tail;
                }
            });
        },
        _getCtrlValue:function(){
            var profile = this.get(0);
            if(profile.$cm)
                return profile.$cm.doc.getValue();
            else
                return profile.properties.$UIvalue;
        },
        setReadonlyLines:function(head, tail){
            var profile = this.get(0), doc=profile.$cm.doc;
            if(profile.$tm1)profile.$tm1.clear();
            if(profile.$tm2)profile.$tm2.clear();

            if(head){
                profile.$tm1 = doc.markText({line:0, ch:0}, {line:head,ch:0}, {atomic:true, readOnly:true, css:'background-color:#ccc;'});
            }
            if(tail){
                var last = doc.lastLine();
                profile.$tm2 = doc.markText({line:last-tail}, {line:last}, {atomic:true, readOnly:true, css:'background-color:#ccc;'});
            }
            profile.readonly_head=head;
            profile.readonly_tail=tail;
        }
    },
    Initialize:function(){
        //modify default template for shell
        var t = this.getTemplate();
        ood.merge(t.FRAME.BORDER,{
            BOX:{
                tagName:'div'
            }
        },'all');
        this.setTemplate(t);
        
        this.__trim=function(s){
            if(/[^\s\uFEFF\xA0]/.test(s)){
                return ood.str.trim(s);
            }else
                return s;
        };
    },
    Static:{
        $tempsandbox:"_$temp_for_ood_sandbox",
        $tempsandbox2:"_$temp_for_ood_sandbox2",
        $temppool:"_$temp_for_ood_pool",
        Appearances:{
            BOX:{
                width:'100%',
                height:'100%',
                left:0,
                top:0,
                position:'absolute',
                background:'#fff'
            }
        },
        Behaviors:{},
        DataModel:{
            left:0,
            top:0,
            width:200,
            height:200,
            position:'absolute',
            codeType:{
                ini:'js',
                action:function(codeType){
                    if(this.$cm){
                        var mode = CONF.getRenderMode(codeType);
                        if(!mode)mode=CONF.getRenderMode("txt");
                        this.$cm.setOption('mode',  mode.mime||mode.mode);
                        if(this.onCodeModeSet)this.boxing().onCodeModeSet(this, mode);
                    }
                }
            },
            readonly:{
                ini:false,
                action:function(value){
                    if(this.$cm)
                        this.$cm.setOption("readOnly",!!value);
                }
            }
        },
        EventHandlers:{
            onValueChanged:function(profile, flag){},
            onRendered:function(profile){},
            onGetHelpInfo:function(profile, key){},
            onCodeModeSet:function(profile, mode){},
            onSaveCommand:function(){}
        },
        RenderTrigger:function(){
            var key=this.box.$temppool,
                subkey=this.$xid;

            this.box._loadEditor(this);

            this.destroyTrigger=function(){
                this.$cm.clearGutter();
                this.$cm.clearHistory();
                delete this.$cm;
                delete this.$tm1;
                delete this.$tm2;
                delete this.$editor;
                
                // destroy related UI
                if(this.$popList)this.$popList.destroy();
                if(this.$popHelp)this.$popHelp.destroy();
                if(this.$popCustom)this.$popCustom.destroy();
                
                if(window[key])delete window[key][subkey];
            };
        },
        clearSandbox:function(name){
            for(var i=1,n;i<9;i++){
                n=name+i;
                if(n && document.getElementById(n)){
                    document.body.removeChild(document.getElementById(n));
                    try{delete frames[n]}catch(e){}
                }
            }
        },
        purge:function(){
                var ns=this,z;
                if((z=window[ns.$temppool])&&z.Instance&&z.Instance._ctrlpool){
                   ood.each(z.Instance._ctrlpool,function(o,i){
                      if(o&&!o.destroyed){
                          if(o.destroy)o.destroy();
                          if(o.boxing && o.boxing())o.boxing().destroy();
                      }
                   });
                   ood.breakO(z.Instance);
                }
        },
       _alias:1,
        evalInSandbox:function(code, funScope, name, subCacheKey, purge, beforeCode, afterCode, cleanFun){
            if(name && document.getElementById(name)){
                document.body.removeChild(document.getElementById(name));
                try{delete frames[name]}catch(e){}
            }
            var ns=this,
                iframe = document.createElement("iframe"), result, wnd, line, errmsg, type;
            
            ns.purge();

            if(name){
                iframe.name=name;
                iframe.id=name;
            }


            iframe.src="about:blank";
            iframe.style.display = "none";
            document.body.appendChild(iframe);
            wnd=frames[frames.length - 1];
            wnd.document.open();
            wnd.document.write('<meta http-equiv="content-type" content="text/html; charset=utf-8" />');
            wnd.document.write("<script>\n");
            if(beforeCode)wnd.document.write(beforeCode);
            wnd.document.write(""                
                // stop Node.js
                +"global=process=Buffer=require=module=exports=root=null;\n"
                
                // copy object
                +"window.ood=parent.ood;\n"
                +"window.Class=function(){return ood.Class.apply(ood,arguments);};\n"
                +"window.CONF={mixed_prop: ood.clone(parent.CONF.mixed_prop) };\n"

                + (CONF.SandBoxExtCode||"") 

                //get this scope
                +"window.__cache={};window.__getThis=function(pname,type){\n"
                +"      if(__cache[pname+':'+type])return __cache[pname+':'+type];\n"
                +"      var obj=type==1?function(){}:{};\n"
                +"      if(pname){\n"
                +"          if(ood.isArr(pname)){\n"
                +"              ood.each(pname,function(cls){\n"
                +"                  cls=ood.SC(cls);\n"
                +"                  obj=ood.merge(obj, type==1?(cls||ood.Module):(cls?(new cls):(new ood.Module)),'all',true)\n"
                +"              });\n"
                +"          }else{\n"
                +"              pname=ood.SC(pname);\n"
                +"              obj=ood.merge(obj, type==1?(pname||ood.Module):(pname?(new pname):(new ood.Module)),'all',true)\n"
                +"          }\n"
                +"      }\n"
                +"      if(window['"+ns.$temppool+"'] && window['"+ns.$temppool+"']['"+subCacheKey+"']){\n"
                +"          obj=ood.merge(obj, window['"+ns.$temppool+"']['"+subCacheKey+"'][type==1?'Static':'Instance'],'all')\n"
                +"      }\n"
                +"      return __cache[pname+':'+type]=obj;\n"
                +"  };\n"

                +"window['"+ns.$temppool+"']=parent['"+ns.$temppool+"'];\n"
                // "var b=arguments.callee;" for fix firefox 3.5 bug
                +"parent['"+ns.$tempsandbox+"']=/*@cc_on !@*/0?this:{eval:function(s){return (function(){var b=arguments.callee;return window.eval.call(window,s)})()}};\n"
                +"parent['"+ns.$tempsandbox2+"']={getErrLine:function(s,cb){window.onerror=function(){cb.apply(null,arguments);return true;};var n=document.createElement('script');n.type='text/javascript';if(/*@cc_on !@*/0){n.text=s;}else{n.appendChild(document.createTextNode(s));};document.body.appendChild(n);window.onerror=null;}};\n"
                +"try{top=parent=null;}catch(e){}"
            );
            if(afterCode)wnd.document.write(afterCode);
            wnd.document.write("<\/script><body><span id='abc'></span></body>");
            wnd.document.close();
            var bak=ood.Dom.pack,
                bak1=ood.absProfile.prototype.$link,
                bak11=ood.absObj.$pickAlias,
                bak12=ood.UIProfile.prototype.setDomId,
                bak2=ood.require,
                bak3=ood.$cache,
                bak4=ood.asyRun,
                bak5=ood.resetRun,
                bak6=ood.exec,
                bak7=ood.pseudocode._callFunctions;

            try{
                // avoid lib or dom affected
                ood.Dom.pack=function(){var o=new ood.Dom(false),d=document.getElementById('abc');o._nodes=[d];return o};
                ood.absProfile.prototype.$link=function(){return this;};
                // stop all default events
                ood.Class.$instanceCreated=function(instance){instance.$inDesign=1;};
                ood.absObj.$pickAlias = function(){return ns._alias++};
                ood.UIProfile.prototype.setDomId=function(){return this;};
                ood.require=function(){};
                ood.$cache={};
                ood.each(bak3,function(o,i){
                    ood.$cache[i]=ood.isArr(o)?[]:{};
                });
                ood.asyRun=ood.resetRun=ood.exec=ood.pseudocode._callFunctions=function(){};
            	
                result = window[ns.$tempsandbox].eval(code);
                if(funScope){
                    if(typeof(result)=='function')result.call(funScope);
                }

                type = (result===wnd || result===wnd.content)? 'window' :
                       result===wnd.console ? 'console' :
                       result===wnd.history ? 'history' :
                       result===wnd.screen ? 'screen' :
                       result===wnd.location ? 'location' :
                       result===wnd.navigator ? 'navigator' :
                       result===wnd.document ? 'document' :
                       null;
                // to avoid : Can't execute code from a freed script
                if(ood.browser.newie||(ood.browser.ie && ood.browser.ver>=9)){
                    var fun=function(hash){
                        for(var i in hash){
                            if(ood.isFun(hash[i]))hash[i]._____string=hash[i]+"";
                            else if(ood.isHash(hash[i]))fun(hash[i]);
                            else if(ood.isArr(hash[i]))fun(hash[i]);
                        }
                    };
                    if(type===null && (ood.isHash(result)||ood.isArr(result)))fun(result);
                }
            }catch(e){       
                //firefox or opera
                console.error(e);
                if(ood.isSet(e.line||e.lineNumber)){
                    line=e.line||e.lineNumber;
                }
                // safari chrome IE
                else{
                    var base=0;
                    if(ood.browser.ie){
                        window[ns.$tempsandbox2].getErrLine("var _a={;",function(a,b,c){
                            base=c-1;
                            return true;
                        });                        
                    }
                        window[ns.$tempsandbox2].getErrLine(code,function(a,b,c){
                        line=c-base;
                        return true;
                    });
                }   
                errmsg=((e.name?e.name+' : ':'') + (e.description||e.message||'') + (line?'\n line : '+line:''));
                if(!ood.isSet(line) && /.*at line ([\d]+).*/.test(errmsg))
                    line=errmsg.replace(/.*at line ([\d]+).*/,'$1');
            }finally{

                if(purge)ns.purge();

                delete ood.Class.$instanceCreated;

                ood.Dom.pack=bak;
                ood.absProfile.prototype.$link=bak1;
                ood.absObj.$pickAlias = bak11;
                ood.UIProfile.prototype.setDomId=bak12;
                ood.require = bak2;
                ood.$cache = bak3;
                ood.asyRun = bak4;
                ood.resetRun = bak5;
                ood.exec = bak6;
                ood.pseudocode._callFunctions = bak7;

                if(cleanFun)cleanFun(wnd, iframe);
                 
                wnd.CONF=wnd.Class=wnd.ood=wnd[ns.$temppool]=wnd.__getThis=wnd.__cache=null;
                if(CONF.ClearSandBoxExtCode){
                    CONF.ClearSandBoxExtCode(wnd);
                }
                window[ns.$tempsandbox]=null;
                window[ns.$tempsandbox2]=null;
 
                var rsl={
                    ok:result,
                    type:type,
                    ko:errmsg,
                    line:line
                };

                ns=bak=result=line=errmsg=type=null;   
                if(!name)
                    document.body.removeChild(iframe);
                iframe=null;

                return rsl;
            }
        },
        _buildItem:function(id, type, key, o, caption, value, order, itemStyle){
            return {
                id:id,
                caption:caption||id,
                value:value||id,
                tag: (order||(type=='property'?'b':type=='function'?'c':type=='class'?'d':type=='event'?'e':'a')) + ":" + id.toLowerCase(),
                path: (key?(key+"."):"")+id,
                itemStyle:itemStyle,
                imageClass:!type?null:
                    (type=='property'?
                        (ood.isSet(o)&&ood.isHash(o))?'spafont spa-icon-hash':
                        (ood.isSet(o)&&ood.isArr(o))?'spafont spa-icon-array':
                    'spafont spa-icon-var':
                    type=='var'?'spafont spa-icon-var':
                    type=='event'?'ri ri-play-line':
                    type=='function'?'ri ri-code-s-slash-line':
                    type=='class'?'spafont spa-icon-class':
                    "spafont spa-icon-prop")
             };
        },
        _intellcache:{},
        _enumKeys:function(target, key, normalObj, ownOnly){
            // non-object or array return empty array
            if(!ood.isObj(target) || ood.isArr(target))return [];

            // default is normal object
            normalObj=normalObj!==false;
            var ns=this,
                isoodobj= target.$ood$,
                o,isfun,
                list=[];

            for(var i in target){
                if('prototype'==i || 'constructor' == i)
                    continue;
                if(isoodobj){
                    if('upper'==i || 'After'==i || 'Before'==i || 'Instance'==i || 'Static'==i || 'Constructor'==i)
                        continue
                }
                try{
                    if(i.charAt(0)!="_" &&  i.charAt(0)!="$" && /^[\w_]+$/.test(i)){
                        o=target[i];
                        if(normalObj && (o && o.$abstract)){
                            continue;
                        }
    
                        isfun = typeof o == 'function' && (!(o && o.$ood$) || o.$asFunction);
                        
                        if(ownOnly && (!target.hasOwnProperty(i) ||  !target.propertyIsEnumerable(i))){
                            continue;
                        }
                        var value = i;
                        if(isfun){
                            if(normalObj){
                                var arr = ood.fun.args(o);
                                var isInstance=false;
                                if(ood.str.endWith(key, ".prototype")){
                                    isInstance = true;
                                }
                                var paras = RAD.ClassTool.getArgsFromAPI(key.replace(".prototype",""),i,isInstance);
                                if(paras){
                                    // use doc's paramters
                                    arr=[];
                                    for(var k=0,l=paras.length;k<l;k++){
                                        arr[k] = paras[k] && paras[k].name;
                                    }
                                }
                                value = i + "(" + arr.join(", ") +  ")";
//                                console.log(key.replace(".prototype",""), i , isInstance, arr, value);
                            }else{
                                value = i + "( )";
                            }
                        }
                        list.push(ns._buildItem(i,
                            (typeof o=='function')? (o && o.$ood$ && !o.$asFunction) ?'class': (o && o.$event$) ? "event" : 'function':'property',
                            key,
                            o,
                            value,
                            value 
                            ));
                    }
                }catch(e){
                    console.log(e);
                }
            
            }

            return list;
        },
        _getIntellisenseList:function(key, cachedata){
            if(!key)return null;
            cachedata = cachedata!==false;

            var ns=this,
                cache = ns._intellcache,
                buildItem = ns._buildItem;

            if(cachedata && cache[key])return cache[key];

            var list=[];
            if(key==ns.$temppool){
                return [];
            }
            
            switch(key){
                case ' variables ':{
                    list=[
                        buildItem("PK",0,0,0,0,0,4,"font-weight:bold;"),

                        //buildItem("absField",0,0,0,0,0,4,"font-weight:bold;color:#ff0000;"),



                    // global
                        buildItem("ood",0,0,0,0,0,2,"font-weight:bold;color:#ff0000;"),
                        buildItem("ood()",0,0,0,"ood()","ood()",2,"font-weight:bold;color:#ff0000;"),

                        buildItem("top",0,0,0,0,0,3,"font-weight:bold;"),
                        buildItem("parent",0,0,0,0,0,3,"font-weight:bold;"),
                        buildItem("window",0,0,0,0,0,3,"font-weight:bold;"),
                        buildItem("document",0,0,0,0,0,3,"font-weight:bold;"),
                        buildItem("navigator",0,0,0,0,0,3,"font-weight:bold;"),
                        buildItem("history",0,0,0,0,0,3,"font-weight:bold;"),
                        buildItem("location",0,0,0,0,0,3,"font-weight:bold;"),
                        buildItem("screen",0,0,0,0,0,3,"font-weight:bold;"),
                        buildItem("Math",0,0,0,0,0,3,"font-weight:bold;"),
                        buildItem("Number",0,0,0,0,0,3,"font-weight:bold;"),
                        buildItem("console",0,0,0,0,0,3,"font-weight:bold;"),
                    // js
                        buildItem("if  ",0,0,0,"if...","if(){\n\n}",5),
                        buildItem("ifelse",0,0,0,"if...else...","if(){\n\n}else{\n\n}",5),
                        buildItem("while",0,0,0,"while...","while(){\n\n};",5),
                        buildItem("do  ",0,0,0,"do...while","do{\n\n}while();",5),
                        buildItem("try  ",0,0,0,"try...catch...finally","try{\n\n}catch(e){\n\n}finally{\n\n}",5),
                        buildItem("for  ",0,0,0,"for...","for(;;;){\n\n}",5),
                        buildItem("forin  ",0,0,0,"for...in","for( in ){\n\n}",5),
                        buildItem("function",0,0,0,"function...","function(){\n\n}",5),
                        buildItem("switch",0,0,0,"switch...","switch(){\n  case : \n\n  break;\n  case : \n\n  break;\ndefault: \n\n}",5),
                        buildItem("with",0,0,0,"with...","with(){\n\n}",5),

                        buildItem("return",0,0,0,"return","return ",4),
                        buildItem("break",0,0,0,"break","break;",4),
                        buildItem("continue",0,0,0,"continue","continue;",4),
                        buildItem("throw",0,0,0,"throw","throw ",4),
                        buildItem("new ",0,0,0,"new","new ",4),
                        buildItem("delete",0,0,0,"delete","delete ",4),
                        buildItem("arguments",0,0,0,"arguments","arguments",4),
                        buildItem("var",0,0,0,"var","var ",4),
                        buildItem("case",0,0,0,"case","case :",4),
                        buildItem("default",0,0,0,"default","default :",4),

                        buildItem("typeof",0,0,0,"typeof","typeof ",4),
                        buildItem("instanceof",0,0,0,"instanceof","instanceof ",4),

                        buildItem("void",0,0,0,"void","void",4),
                        buildItem("true",0,0,0,"true","true",4),
                        buildItem("false",0,0,0,"false","false",4),
                        buildItem("null",0,0,0,"null","null",4),
                        buildItem("NaN",0,0,0,"NaN","NaN",4),
                        buildItem("undefined",0,0,0,"undefined","undefined",4),
                        buildItem("Infinity",0,0,0,"Infinity","Infinity",4),


                        buildItem("decodeURI()","function"),
                        buildItem("decodeURIComponent()","function"),
                        buildItem("encodeURI()","function"),
                        buildItem("encodeURIComponent()","function"),
                        buildItem("escape()","function"),
                        buildItem("eval()","function"),
                        buildItem("isFinite()","function"),
                        buildItem("parseFloat()","function"),
                        buildItem("parseInt()","function"),
                        buildItem("unescape()","function"),
                        buildItem("Number()","function"),
                        buildItem("String()","function"),

                        //**********************
                        buildItem("keySet[",0,0,0,"PK[0]","PK[0]",5),
                        buildItem("absField",0,0,0,"absField()","absField(filed1,filed2,value,units)",5)
                      ];
                        break;
                }
                case 'new':{
                     list=[
                     
                        buildItem("String","class",0,0,0,"String();",1),
                        buildItem("Object","class",0,0,0,"Object();",1),
                        buildItem("Array","class",0,0,0,"Array();",1),
                        buildItem("RegExp","class",0,0,0,"RegExp();",1),
                        buildItem("Boolean","class",0,0,0,"Boolean();",1),
                        buildItem("Number","class",0,0,0,"Number();",1),
                        buildItem("Date","class",0,0,0,"Date();",1),

                        buildItem("ood.Dom","class",0,0,0,"ood.Dom();",2),
                        buildItem("ood.UIProfile","class",0,0,0,"ood.UIProfile();",2),
                        buildItem("ood.Module","class",0,0,0,"ood.Module();",2),
                        buildItem("ood.Template","class",0,0,0,"ood.Template();",2),
                        buildItem("ood.UI","class",0,0,0,"ood.UI();",2),
                        buildItem("ood.DataBinder","class",0,0,0,"ood.DataBinder();",2)
                    ];
                    for(var i in ood.UI){
                        if(i!='upper' && ood.UI[i].$ood$){
                            list.push(buildItem("ood.UI."+i,"class",0,0,0," "+"ood.UI."+i+"();",2));
                        }
                    }
                    break;
                }
                case 'history':
                case 'screen':
                    break;

                case 'PK[':
                    buildItem("PK['0']",0,0,0,"PK['0']","PK[0]",5)
                    break;

                case 'console':
                    list=[
                        buildItem("log()","function",key)
                    ];
                    break;
                case 'arguments':{
                    list=[
                        buildItem("callee","property",key),
                        buildItem("length","property",key)
                    ];
                    break;
                }
                case 'arguments.callee':{
                    list=[
                        buildItem("caller","property",key),
                        buildItem("length","property",key),
                        buildItem("call()","function",key),
                        buildItem("apply()","function",key)
                    ];
                    break;
                }
                case 'top':
                case 'parent':
                case 'window':{
                    var iframe = document.createElement("iframe");
                    iframe.style.display = "none";
                    document.body.appendChild(iframe);
                    var target=frames[frames.length - 1];
                    list=ns._enumKeys(target,key,false);
                    document.body.removeChild(iframe);
                    break;
                }
                case 'document':{
                    var iframe = document.createElement("iframe");
                    iframe.style.display = "none";
                    document.body.appendChild(iframe);
                    var target=frames[frames.length - 1];
                    list=ns._enumKeys(target.document,key,false);
                    document.body.removeChild(iframe);
                    break;
                }
                case 'Element.prototype':{
                    var iframe = document.createElement("iframe");
                    iframe.style.display = "none";
                    document.body.appendChild(iframe);
                    var target=frames[frames.length - 1];
                    target.document.write("<span>a</span>");
                    list=ns._enumKeys(target.document.body.firstChild,key,false);
                    document.body.removeChild(iframe);
                    break;
                }
                case 'Math':{
                    list=[
                        buildItem("E","property",key),
                        buildItem("LN2","property",key),
                        buildItem("LN10","property",key),
                        buildItem("LOG2E","property",key),
                        buildItem("LOG10E","property",key),
                        buildItem("PI","property",key),
                        buildItem("SQRT1_2","property",key),
                        buildItem("SQRT2","property",key),

                        buildItem("abs(x)","function",key),
                        buildItem("acos(x)","function",key),
                        buildItem("asin(x)","function",key),
                        buildItem("atan(x)","function",key),
                        buildItem("atan2(y,x)","function",key),
                        buildItem("ceil(x)","function",key),
                        buildItem("cos(x)","function",key),
                        buildItem("exp(x)","function",key),
                        buildItem("floor(x)","function",key),
                        buildItem("log(x)","function",key),
                        buildItem("max(x,y,z,...,n)","function",key),
                        buildItem("min(x,y,z,...,n)","function",key),
                        buildItem("pow(x,y)","function",key),
                        buildItem("random()","function",key),
                        buildItem("round(x)","function",key),
                        buildItem("sin(x)","function",key),
                        buildItem("sqrt(x)","function",key),
                        buildItem("tan(x)","function",key)
                    ];
                    break;
                }
                case 'Number':{
                     list=[
                        buildItem("MAX_VALUE","property",key),
                        buildItem("MIN_VALUE","property",key),
                        buildItem("NEGATIVE_INFINITY","property",key),
                        buildItem("POSITIVE_INFINITY","property",key)
                    ];
                    break;
                }
                case "Array.prototype":{
                    list=[
                        buildItem("length","property",key),
                        buildItem("concat()","function",key),
                        buildItem("join()","function",key),
                        buildItem("pop()","function",key),
                        buildItem("push()","function",key),
                        buildItem("reverse()","function",key),
                        buildItem("shift()","function",key),
                        buildItem("sort()","function",key),
                        buildItem("concat()","function",key),
                        buildItem("splice()","function",key),
                        buildItem("toString()","function",key),
                        buildItem("unshift()","function",key)
                    ];
                    break;
                }
                case "Date.prototype":{
                    list=[
                        buildItem("getDate()","function",key),
                        buildItem("getDay()","function",key),
                        buildItem("getFullYear()","function",key),
                        buildItem("getHours()","function",key),
                        buildItem("getMilliseconds()","function",key),
                        buildItem("getMinutes()","function",key),
                        buildItem("getMonth()","function",key),
                        buildItem("getTime()","function",key),
                        buildItem("getSeconds()","function",key),
                        buildItem("getTimezoneOffset()","function",key),
                        buildItem("getUTCDate()","function",key),
                        buildItem("getUTCDay()","function",key),
                        buildItem("getUTCFullYear()","function",key),
                        buildItem("getUTCHours()","function",key),
                        buildItem("getUTCMilliseconds()","function",key),
                        buildItem("getUTCMinutes()","function",key),
                        buildItem("getUTCMonth()","function",key),
                        buildItem("getUTCSeconds()","function",key),
                        buildItem("getYear()","function",key),
                        buildItem("parse()","function",key),
                        buildItem("setDate()","function",key),
                        buildItem("setFullYear()","function",key),
                        buildItem("setHours()","function",key),
                        buildItem("setMilliseconds()","function",key),
                        buildItem("setMinutes()","function",key),
                        buildItem("setMonth()","function",key),
                        buildItem("setSeconds()","function",key),
                        buildItem("setTime()","function",key),
                        buildItem("setUTCDate()","function",key),
                        buildItem("setUTCFullYear()","function",key),
                        buildItem("setUTCHours()","function",key),
                        buildItem("setUTCMilliseconds()","function",key),
                        buildItem("setUTCMinutes()","function",key),
                        buildItem("setUTCSeconds()","function",key),
                        buildItem("setUTCMonth()","function",key),
                        buildItem("setYear()","function",key),
                        buildItem("toDateString()","function",key),
                        buildItem("toGMTString()","function",key),
                        buildItem("toLocaleDateString()","function",key),
                        buildItem("toLocaleTimeString()","function",key),
                        buildItem("toLocaleString()","function",key),
                        buildItem("toString()","function",key),
                        buildItem("toUTCString()","function",key),
                        buildItem("toTimeString()","function",key),
                        buildItem("UTC()","function",key)
                    ];
                    break;
                }
                case "Number.prototype":{
                    list=[
                        buildItem("toExponential()","function",key),
                        buildItem("toFixed()","function",key),
                        buildItem("toPrecision()","function",key),
                        buildItem("toString()","function",key)
                    ];
                    break;
                }
                case "Boolean.prototype":{
                    list=[
                        buildItem("toString()","function",key)
                    ];
                    break;
                }
                case "Function.prototype":{
                    list=[
                        buildItem("toString()","function",key),
                        buildItem("call()","function",key),
                        buildItem("apply()","function",key)
                    ];
                    break;
                }
                case "RegExp.prototype":{
                    list=[
                        buildItem("global","property",key),
                        buildItem("ignoreCase","property",key),
                        buildItem("multiline","property",key),
                        buildItem("lastIndex","property",key),
                        buildItem("source","property",key),
                        buildItem("compile()","function",key),
                        buildItem("exec()","function",key),
                        buildItem("test()","function",key)
                    ];
                    break;
                }
                case "String.prototype":{
                    list=[
                        buildItem("length","property",key),
                        buildItem("charAt()","function",key),
                        buildItem("charCodeAt()","function",key),
                        buildItem("concat()","function",key),
                        buildItem("fromCharCode()","function",key),
                        buildItem("indexOf()","function",key),
                        buildItem("lastIndexOf()","function",key),
                        buildItem("match()","function",key),
                        buildItem("replace()","function",key),
                        buildItem("search()","function",key),
                        buildItem("slice()","function",key),
                        buildItem("split()","function",key),
                        buildItem("substr()","function",key),
                        buildItem("substring()","function",key),
                        buildItem("toLowerCase()","function",key),
                        buildItem("toUpperCase()","function",key)
                    ];
                    break;
                }
                case "Object.prototype":{
                    list=[
                        buildItem("toString()","function",key,0,0,0,'z'),
                        buildItem("toLocaleString()","function",key,0,0,0,'z'),
                        buildItem("hasOwnProperty(key)","function",key,0,0,0,'z'),
                        buildItem("propertyIsEnumerable(key)","function",key,0,0,0,'z'),
                        buildItem("isPrototypeOf(obj)","function",key,0,0,0,'z')
                     ];
                    break;
                }
                default:{
                    if(/\.prototype$/.test(key)){
                        // [[[[[ bak
                        var bak=ood.Dom.pack,
                            bak1=ood.absProfile.prototype.$link,
                            bak11 = ood.absObj.$pickAlias;

                        ood.Dom.pack=function(){var o=new ood.Dom(false),d=document.getElementById('abc');o._nodes=[d];return o};
                        ood.absProfile.prototype.$link=function(){return this;};
                        ood.absObj.$pickAlias = function(){return ns._alias++};
                        // ]]]]]
                        try{
                            var target= eval("new "+key.replace(/\.prototype$/,''));
                            list=ns._enumKeys(target,key);
                        }catch(e){}finally{
                        //[[[[[ restore
                            ood.Dom.pack=bak;
                            ood.absProfile.prototype.$link=bak1;
                            ood.absObj.$pickAlias = bak11;
                        //]]]]]
                        }
                    }

                    if(!list.length){
                        var target=ood.get(window,key.split("."));
                        list=ns._enumKeys(target,key);
                        cachedata=false;
                    }
                }
            }

            if(cachedata)
                cache[key]=list;

            return list;
        },
        _getFromFunctionExp:function(code){
            var type;
            if(/toString\([^)]*\)$/.test(code))
                type='String.prototype';
            // functions patterns
            else if(/^\s*\(?\s*new\s+([\wood.]+)\s*\(?\s*[^)]*\)?\s*\)?(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/.test(code)){
                code  = code.replace(/^\s*\(?\s*new\s+([\wood.]+)\s*\(?\s*[^)]*\)?\s*\)?(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/, "$1");
                type=code+'.prototype';
            }
            else if(/.*\.reBoxing\(([^)]*)\)(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/.test(code)){
                code = code.replace(/.*\.reBoxing\(([^)]*)\)(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/,"$1");
                if(code)
                    type=code.replace(/[\'\"]/g,"")+'.prototype';
                else
                    type='ood.Dom.prototype';
            }
            else if(code.indexOf("ood.alert(")==0 || code.indexOf("ood.prompt(")==0|| code.indexOf("ood.pop(")==0|| code.indexOf("ood.confirm(")==0)
                type='ood.UI.Dialog.prototype';
            else if(code.indexOf("ood(")==0 || code.indexOf("ood.use(")==0)
                type='ood.Dom.prototype';
            else if(code.indexOf("ood.Thread(")==0 || code.indexOf("ood.Ajax(")==0
                || code.indexOf("ood.SAjax(")==0 ||  code.indexOf("ood.IAjax(")==0 
                || code.indexOf("ood.JSONP(")==0 ||  code.indexOf("ood.XDMI(")==0 )
                type='ood.Thread.prototype';
            else if(/.*\.(getRoot|getSubNode|getSubNodes)\s*\(\s*[^\)]*\)\s*$/.test(code))
                type='ood.Dom.prototype';
            else if(/.*\.getElementById\s*\(\s*[^\)]*\)\s*$/.test(code))
                type='Element.prototype';
            return type;
        },
        _getFromObject:function(target){
            if(!ood.isSet(target))
                return null;
            else if(target===ood.str)
                return "ood.str";
            else if(target===ood.arr)
                return "ood.arr";
            else if(target===ood)
                return "ood";
            else if(target.$ood$){
                if(typeof target == 'function')
                    return target.KEY;
                else
                    return target.KEY+".prototype";
            }else if(ood.isArr(target))
                return "Array.prototype";
            else if(ood.isDate(target))
                return "Date.prototype";
            else if(ood.isReg(target))
                return "RegExp.prototype";
            else if(ood.isNumb(target))
                return "Number.prototype";
            else if(ood.isStr(target))
                return "String.prototype";
            else if(ood.isBool(target))
                return "Boolean.prototype";
            else if(ood.isFun(target))
                return "Function.prototype";
            else if(ood.isObj(target)){
                return "Object.prototype";
            }
            // dont use ood.isHash here
        },
        _findVars:function(profile, tonode, braceId){
            var ns=this,
                cm=profile.$editor,
                arr=[];
            if(cm && tonode){
                var doc=cm.win.document,
                    isBr=function(elem){return elem.tagName=="BR" || elem.tagName=="br"},
                    isB=function(elem){return elem.tagName=="B" || elem.tagName=="b"},
                    elem=doc.body.firstChild,
                    scope="",
                    cls,txt,temp=[],cursor;

                cursor=arr;

                cursor.push(["this",""]);

                while((elem=elem.nextSibling) && elem!=tonode){
                    if(isB(elem) && elem._uid && elem.id.charAt(0)=='b'){
                        // if sibling {, jump to it's }
                        if(!braceId || braceId.indexOf(elem.id)!==0){
                            elem=doc.getElementById('e'+elem.id.slice(1));
                        }else{
                            scope=elem._uid;
                            // reset scope
                            ood.arr.each(temp,function(o){
                                o[1]=scope;
                            });
                            arr = arr.concat(temp);
                        }
                        temp=[];
                        cursor=arr;
                    }

                    cls=ns.__trim(elem.className);
                    txt=ns.__trim(elem.currentText);

                    if(cls=='js-keyword' && txt=="function"){
                        
                        // find "function abc(){}"
                        while((elem=elem.nextSibling) && elem!=tonode && (isBr(elem)||ns.__trim(elem.className)=="whitespace"||ns.__trim(elem.className)=="js-comment"));
                        cls=ns.__trim(elem.className);
                        txt=ns.__trim(elem.currentText);
                        if(cls=='js-variabledef'){
                            cursor.push([txt,scope]);
                        }

                        // temp find
                        cursor=temp;
                        cursor.push(["this",scope]);
                    }

                    if(cls=='js-variabledef')
                        cursor.push([txt,scope]);
                }
            }
            return arr;
        },
        
        _getIntellisense:function(profile, key, index, nolist){
            var ns=this,
            _this=RAD.ClassTool._this;

            // get type
            if(key.indexOf('new ')==0){
                type='new';
            }else if(key.charAt(key.length-1)=='.'){
                type="properties";
                key=key.slice(0,-1);
            }else{
                if(key.indexOf('.')!=-1){
                    type="properties";
                    key = key.slice(0,key.lastIndexOf('.'));
                }else{
                    // return avialable var
                    type="var";
                }
            }
            if(type=="properties"){
                if(key.indexOf('(')!=-1){
                    type="function";
                }
            }

            var target,code,
                list=[],
                // object type string
                otype, 
                // object code string
                ocode, 
                // extra array
                oextra=[];
            switch(type){
                case 'new':
                    otype=type;
                    break;
                case "function":
                    type=ns._getFromFunctionExp(key);
                    if(type){
                        otype=type;
                        break;
                    }
                case "properties":
                    if(key=="arguments"||key=="arguments.callee"){
                        otype=key;
                        break;
                    }else{                        
                        // try exec all code dir
                        var arrcode=[],
                            vars=[],
                            code=profile.$cm.getValue(),
                            allcode=RAD.ClassTool.getContextAssignments(code,index),
                            struct=RAD.ClassTool.getClassStructWithScope(code,index, ns.$temppool, profile.$xid);

                        arrcode.push("(function(){try{\n");
                        arrcode.push("var "+_this+"=window;\n");
                        vars.push(_this);
                        var added1=false,added2=false,
                            len=allcode.vars.length;
                        for(var i=0;i<len;i++){
                            arrcode.push("var "+allcode.vars[i]+"=undefined;\n");
                            vars.push(allcode.vars[i]);
                        }
                        // run once at least
                        for(var i=-1;i<len;i++){
                            // no assignment, or assignment is in special scope
                            if(allcode.scopeS==-1 || i>=allcode.scopeS){
                                // add only once
                                if(!added1){
                                    added1=true;
                                    var o;
                                    // get scope info
                                    if(allcode.secondKey && allcode.secondType=="function"){
                                        o=ood.get(struct,['sub',allcode.firstKey,'sub',allcode.secondKey]);                                                
                                    }else if(allcode.firstKey&&allcode.firstType=="function"){
                                        o=ood.get(struct,['sub',allcode.firstKey]);
                                    }
                                    if(o){
                                        // add scope code
                                        arrcode.push("try{"+_this+"="+o._this+"}catch(e){};\n");
                                        // add args code
                                        ood.arr.each(o.argsv,function(arg,i){
                                            // no matching argument
                                            if(!o.args||!o.args[i])return false;

                                            // use dynamic code first
                                            if(arg.code){
                                                arrcode.push("try{"+o.args[i]+"="+ arg.code +"}catch(e){};\n");
                                                vars.push(o.args[i]);
                                            }else{
                                                if (/\.prototype$/.test(arg.type)){
                                                    arrcode.push("try{"+o.args[i]+"="+ arg.type.replace(/(.+)(\.prototype)$/, "new $1();") +"}catch(e){};\n");
                                                    vars.push(o.args[i]);
                                                }else{
                                                    arrcode.push("try{"+o.args[i]+"="+ arg.type +"}catch(e){};\n");
                                                    vars.push(o.args[i]);
                                                }
                                            }   
                                        });
                                    }
                                }
                            }
                            // out of special scope
                            if(allcode.scopeS!=-1 && i>=allcode.scopeE){
                                if(!added2){
                                    added2=true;
                                    arrcode.push("try{"+_this+"=window;}catch(e){};\n");
                                }
                            }
                            // ignore when i is -1
                            if(i>=0){
                                arrcode.push("try{"+allcode.vars[i]+"="+allcode.code[i]+";}catch(e){};\n");
                                vars.push(allcode.vars[i]);
                            }
                        }
                        if(allcode.scopeS!=-1 && allcode.outscope){
                            if(!added2){
                                arrcode.push("try{"+_this+"={};}catch(e){};\n");
                            }
                        }
                        
                        arrcode.push("return (" + key + ");\n}catch(e){}finally{\n");
                        ood.arr.removeValue(vars,key);
                        arrcode.push(vars.join("=")+"=null;\n");
                        arrcode.push("}\n}).call({});\n");
                        ocode = arrcode.join('').replace(/\bthis\b/g,_this);
//console.log(ocode);
                    }
                    break;
                case "var":
                    otype=" variables ";
                    
                    // caching according to line
                   /*
                    var hash,cache=ns.__varscache||(ns.__varscache={});
                    if(cache[index]){
                        hash=cache[index];
                    }else{
                        cache=ns.__varscache={};
                        cache[index]=hash=RAD.ClassTool.getContextVars(profile.$cm.getValue(),index);
                    }
                   */
                    var hash=RAD.ClassTool.getContextVars_fast(profile.$cm, index);

                    if(hash["this"]){
                        oextra.push(ns._buildItem("this",0,0,0,0,0,1,"color:#ff0000;"));
                        delete hash["this"];
                    }
                    if(hash["arguments"]){
                        oextra.push(ns._buildItem("arguments",0,0,0,0,0,1,"color:#ff0000;"));
                        delete hash["arguments"];
                    }
                        
                    ood.each(hash,function(o,i){
                        oextra.push(ns._buildItem(i,"var",0,0,0,0,1,"color:#666;"));
                    });
                    break;
            }
            // from extra array
            if(oextra && oextra.length){
                if(!nolist)
                    Array.prototype.push.apply(list, oextra);
            }
            // then "from code"
            if(ocode){
                result = ns.evalInSandbox(ocode,false,null,profile.$xid);
                if(ood.isSet(result.ok)){
                    // if result.type exists, igonre result.ok
                    if(result.type)
                        otype=result.type;
                    else{
                        otype = ns._getFromObject(result.ok);
                        if(!nolist)
                            Array.prototype.push.apply(list, ns._enumKeys(result.ok, otype, true, true));
                    }
                }
            }
            // the last one is "from type"
            if(otype){
                if(!nolist)
                    Array.prototype.push.apply(list, ns._getIntellisenseList(otype));
            }

            if(list.length){
                list = ood.arr.removeDuplicate(list, 'id');

                ood.arr.stableSort(list,function(x,y){
                    return x.tag>y.tag?1:x.tag==y.tag?0:-1;
                });
            }

            return [otype, list, key];
        },
        _loadEditor:function(profile){
            var ns=this,
                _this=RAD.ClassTool._this;

            // is suggestion window showed
            var $suggestionShowed=false,
                $suggestionBaseScope=null,
                $suggestionBaseScopeShadow=null,
                showSuggetionID="CodeEditor.showSuggetion.resetRun",
                adjustSuggetionID="CodeEditor.adjustSuggetion.resetRun",
                $currentText="",
                $willshowDotHint=false,
                // suggestion window for
                $activeWord;

            // get short Suggestion code
            var getShortContentCode=function(index){
                var reg=/\s+/g,
                    arr=[],
                    extxt="",
                    cm=profile.$cm,
                    pos=cm.doc.posFromIndex(index),
                    line=pos.line,
                    elem=cm.getTokenAt(pos),
                    prev=function(elem){
                        if(elem.start===0){
                            pos.line--;
                            if(pos.line===0){
                                return null;
                            }
                            var line=cm.doc.getLine(pos.line);
                            if(line){
                                pos.ch=line.length;
                            }else{
                                return null;
                            }
                        }else{
                            pos.ch=elem.start;
                        }
                        return cm.getTokenAt(pos);
                    };

                // for dblclick case, find key text
                if(!(elem.type===null && elem.string==".")){
                    extxt=ns.__trim(elem.string);
                    elem=prev(elem);
                }
                // for dot case 
                if(elem && (elem.type===null && elem.string==".")){
                    do{
                        if(elem.type===null && elem.string=="."){
                            // ignore space and comments
                            while(elem=prev(elem)){
                                if(!(!elem || elem.type=="comment" ||elem.type=="tab" || (elem.type===null && /^\s+$/.test(elem.string)))){
                                    break;
                                }
                            }
                            if(elem){
                                // for (xxx)
                                var con1="";
                                if(elem.type===null && elem.string===")"){
                                    var deep1=0;
                                    do{
                                        if(elem.type===null && elem.string===")")
                                            deep1++;
                                        if(elem.type===null && elem.string==="(")
                                            deep1--;
                                        if(elem.string)
                                            con1 = elem.string+con1;
                                    }while((elem=prev(elem)) && deep1!==0)
                                }
                                if(elem){
                                    if(elem.type=="property" || elem.type=='variable' || elem.type=='variable-2'
                                    || elem.type=='oodglobal'
                                    ||(elem.type=="keyword"&&elem.string=="this")){
                                        arr.push(elem.string.replace(reg,'') + con1);
                                    }else if(con1){
                                        arr.push(con1);
                                    }else{
                                        break;
                                    }
                                        
                                }
                            }
                        }else{
                            break;
                        }
                    }while(elem=prev(elem))
                }
                // for space case
                else if(elem && (elem.type==null && elem.string===" ")){
                    // ignore space and comments
                    while(elem=prev(elem)){
                        if(!(!elem || elem.type=="comment" || (elem.type==null && elem.string===" "))){
                            break;
                        }
                    }
                    if(elem.type=="keyword" && elem.string=="new"){
                        extxt = "new " + extxt;
                    }
                }

                return (arr.length?(arr.reverse().join('.')+'.'):"")+extxt;
            };

            var iniComponents=function(){
                // [[Code created by ESDUI RAD Studio
                var host=this, children=[], append=function(child){children.push(child.get(0))};
                
                append(
                    (new ood.UI.Pane)
                    .setHost(host,"$popList")
                    .setLeft(10)
                    .setTop(10)
                    .setWidth(300)
                    .setHeight(180)
                );
                
                host.$popList.append(
                    (new ood.UI.List)
                    .setHost(host,"$lstsug")
                    .setTheme("codemirror")
                    .setDirtyMark(false)
                    .setTop(18)
                    .setWidth(300)
                    .setHeight(162)
                    .setItemRow(true)
                    .setDisableHoverEffect(true)
                );
                
                host.$popList.append(
                    (new ood.UI.Block)
                    .setHost(host,"block1")
                    .setLeft(0)
                    .setTop(0)
                    .setWidth(300)
                    .setHeight(24)
                    .setBorderType("flat")
                );
                
                host.block1.append(
                    (new ood.UI.Label)
                    .setHost(host,"$objType")
                    .setLeft(6)
                    .setTop(2)
                    .setWidth(252)
                    .setCaption("")
                    .setHAlign("left")
                    .setCustomStyle({KEY:'font-weight:bold;'})
                );
                
                append(
                    (new ood.UI.Block)
                    .setHost(host,"$popHelp")
                    .setLeft(410)
                    .setTop(10)
                    .setWidth(300)
                    .setHeight(180)
                    .setBorderType("flat")
                    .setOverflow('hidden')
                    .setBackground("#FFF8DC")
                );
                
                host.$popHelp.append(
                    (new ood.UI.Div)
                    .setHost(host,"$divhelp")
                    .setTheme("codemirror")
                    .setLeft(-1)
                    .setTop(19)
                    .setWidth(300)
                    .setHeight(160)
                    .setCustomStyle({"KEY":"overflow:auto; padding:4px;"})
                );
                
                host.$popHelp.append(
                    (new ood.UI.Block)
                    .setHost(host,"block3")
                    .setLeft(-1)
                    .setTop(-1)
                    .setWidth(300)
                    .setHeight(20)
                    .setBorderType("flat")
                );
                
                host.block3.append(
                    (new ood.UI.Link)
                    .setHost(host,"$linkAPI")
                    .setLeft('auto')
                    .setRight(2)
                    .setTop(1)
                    .setCaption("$RAD.JSEditor.clickapi")
                );
                
                host.block3.append(
                    (new ood.UI.Label)
                    .setHost(host,"$lblTips")
                    .setLeft(6)
                    .setTop(2)
                    .setWidth(133)
                    .setCaption("")
                    .setHAlign("left")
                );
                
                return children;

                // ]]Code created by ESDUI RAD Studio
            };
            
            var handle={
                moveFocus:function(step){
                 var list = profile.$lstsug,
                    items = list.get(0).properties.items,
                    length=items.length,
                    value = list.getUIValue(),
                    index = ood.arr.subIndexOf(items, 'id', value);
                    if(step===true){
                        index=0;
                    }else if(step===false){
                        index=length-1;
                    }else{
                        index+=step;
                        if(index<0)index=0;
                        if(index>length-1)index=length-1;
                    }
                    if(items[index])
                        list.setUIValue(items[index].id,true);
                },
                close:function(){
                    hideSuggestion();
                },
                pick:function(){
                 var list = profile.$lstsug,
                    items = list.get(0).properties.items,
                    length=items.length,
                    value = list.getUIValue(),
                    index = ood.arr.subIndexOf(items, 'id', value);
                    
                    if(items[index])
                        applySuggestion(items[index].value||items[index].caption);
                    hideSuggestion();
                }
            };
            var keyMap={
              Up: function() {handle.moveFocus(-1);},
              Down: function() {handle.moveFocus(1);},
              PageUp: function() {handle.moveFocus(-8, true);},
              PageDown: function() {handle.moveFocus(8, true);},
              Home: function() {handle.moveFocus(true);},
              End: function() {handle.moveFocus(false);},
              Enter: function() {handle.pick();},
              Tab: function() {handle.pick();},
              Esc: function() {handle.close();}
            };
            // show suggestion
            var showSuggestion=function(key, index, fromDot, dftTxt){
                // get intellisense
                var rtn = profile.box._getIntellisense(profile, key, index),
                    keyword=rtn[0],
                    items=rtn[1];
                dftTxt=dftTxt||key||"";

                if(!keyword && !(items && items.length)){
                    hideSuggestion();
                    return ;
                }

                if(!fromDot){
                    var found=false,str=dftTxt.toLowerCase();
                    ood.arr.each(items,function(item){
                        if(ood.str.startWith(item.id.toLowerCase(),str)){
                            found=true;
                            return false;
                        }
                    });
                    if(!found){
                        return;
                    }
                }
                var coordinates =cm.cursorCoords(true,"page"),
                    left=coordinates.left ,
                    top=coordinates.top ;

                if(!profile.$popList){
                    iniComponents.call(profile);
                    ood('body').append(profile.$popList.setDisplay('none'));
                    ood('body').append(profile.$popHelp.setDisplay('none'));
                    
                    profile.$divhelp.getRoot().setSelectable(true);
                    
                    profile.$linkAPI.onClick(function(p){
                        CONF.openAPI(p.properties.tag);
                    });
                    var out=true,
                        tryToClose=function(){
                            ood.resetRun("codemirror:aaa",function(){
                                if(out && profile.$popCustom){
                                    profile.$popCustom.setDisplay('none');
                                }
                            });
                        };
                    
                    profile.$lstsug.afterUIValueSet(function(profile,ov,v){
                        showTips2(profile.getItemByItemId(v));
                    })
                    .onClick(function(profile,item){
                        applySuggestion(item.value||item.caption);
                        hideSuggestion();
                    });
                }

                if((items && items.length)|| fromDot){
                    $suggestionShowed=fromDot?1:true;
                    if(items && items.length){
                        profile.$lstsug.setItems(items);
                    }
                    var fun=function(){
                        hideSuggestion();
                    },
                    group=ood([profile.$popList.getRootNode(), profile.$popHelp.getRootNode(), profile.getSubNode("BOX").get(0)]);
                    
                    profile.$popList.getRoot().popToTop({region:{
                        left:left,
                        top:top,
                        width:2,
                        height:16
                    }},1)
                    .setBlurTrigger(showSuggetionID,fun,group);
                    ood.Event.keyboardHook('esc',0,0,0,fun);

                    profile.$popList.setDisplay('');
                    
                    $activeWord=rtn[2]||null;
                    
                    if(items && items.length){
                        adjustSuggetion(left, top, dftTxt,"",true,true);
                    }
                }

                profile.$objType.setCaption(keyword||"none");
                
                // remove first
                profile.$cm.removeKeyMap(keyMap);
                profile.$cm.addKeyMap(keyMap);
            };
            
            // hide suggestion
            var hideSuggestion=function(){
                ood.Event.keyboardHook('esc',0,0,0);
                
                profile.$cm.removeKeyMap(keyMap);
                
                ood.resetRun(showSuggetionID);
                ood.resetRun(adjustSuggetionID);

                $suggestionBaseScope=null;
                $suggestionBaseScopeShadow=null;
                $suggestionShowed=false;
                $willshowDotHint=false;

                if(profile.$popList){
                    profile.$objType.setCaption('');
                    profile.$lstsug.setItems([]).setUIValue(null);                    
                    profile.$popList.setDisplay('none');

                    profile.$lblTips.setCaption('');
                    profile.$divhelp.setHtml("");
                    profile.$popHelp.setDisplay('none');
                    
                    if(profile.$popCustom)
                        profile.$popCustom.setDisplay('none');
                    
                    $currentText=null;
                }
            };
            
            // adjust selection and position for suggestion win
            var adjustSuggetion=function(left, top, txt, extxt, forVisibleOnly, asnyc){
                if(!profile.$lstsug)return;
                var prf=profile.$lstsug.get(0),
                    items=prf.properties.items,
                    f=function(){
                        if(forVisibleOnly && !$suggestionShowed)return;
                        
                        var fid;
                        if(extxt)txt+=extxt;
                        if(!ood.isSet($currentText) || txt!==$currentText){
                            $currentText=txt;
                            // try to find startWith
                            ood.arr.each(items,function(item){
                                if(ood.str.startWith(item.id.toLowerCase(), $currentText.toLowerCase())){
                                    fid=item.id;
                                    return false;
                                }
                            });
                            // try to find similiar
                            while(!fid && txt.length){
                                txt = txt.substring(0,txt.length-1);
                                if(!txt)break;
                                ood.arr.each(items,function(item){
                                    if(ood.str.startWith(item.id.toLowerCase(), txt.toLowerCase())){
                                        fid=item.id;
                                        return false;
                                    }
                                });
                            }
                            // the frist one
                            if(!fid){
                                fid=items[0].id;
                            }
                        }
                        if(!prf.properties.$UIvalue && !fid && prf.properties.items && prf.properties.items.length)
                            fid=prf.properties.items[0].id;
                        if(fid)
                            prf.boxing().setUIValue(fid);
                        else{
                            hideSuggestion();
                            return;
                        }
                        
                        // POSITION
                        profile.$popList.getRoot().popToTop({region:{
                            left:left,
                            top:top,
                            width:2,
                            height:16
                        }},1)
                        if(profile.$popHelp && profile.$popHelp.getDisplay()!='none'){
                            profile.$popHelp.getRoot().popToTop(profile.$popList.getRoot(),2)
                        }
                    };
                if(!asnyc)
                    f();
                 else
                    ood.resetRun(adjustSuggetionID, f,100);
            };
            
            var showTips=function(key, str){
                if(!profile.$popHelp)return;
                if(profile.$popList.getDisplay()!='none'){
                    profile.$linkAPI.setTag(key);
                    profile.$lblTips.setCaption(key);

                    profile.$divhelp.setHtml(str);
                    profile.$popHelp.getRoot().popToTop(profile.$popList.getRoot(),2)
                    profile.$popHelp.setDisplay('');
                }
            };
            var hideTips=function(key, str){
                if(!profile.$popHelp)return;

                profile.$linkAPI.setTag(null);
                profile.$lblTips.setCaption("");
                profile.$divhelp.setHtml("");
                profile.$popHelp.setDisplay("none");
            };
            // show tips
            var showTips1=function(elem){
                if(!profile.$popHelp)return;
                var key=getShortContentCode(elem);
                var str = profile.onGetHelpInfo &&  profile.boxing().onGetHelpInfo(profile, key.key);
//                if(!str)
//                    str=key.key;
                if(str){
                    showTips(key.key,str);
                }else{
                    hideTips();
                }
            };
            var showTips2=function(item){
                if(!profile.$popHelp)return;
                if(!item)return;
                var str = profile.onGetHelpInfo &&  profile.boxing().onGetHelpInfo(profile, item.path);
//                if(!str)
//                   str=item.path;
                if(str){
                    showTips(item.path,str);
                }else{
                    hideTips();
                }
            };

            // show Intellisense  from dot
            var showDotHint=function(index,scope,dftTxt,scopyShadow){
                $suggestionBaseScope=$suggestionBaseScopeShadow=null;
                // hide list first
                //hideSuggestion();
                $willshowDotHint=true;
                ood.resetRun(showSuggetionID,function(){
                    var key=getShortContentCode(index);
                    if(!key){
                        hideSuggestion();
                    }else{
                        $willshowDotHint=false;

                        if(key!=dftTxt)
                            showSuggestion(key, index, true, dftTxt);
                    }
                },100);
                $suggestionBaseScope=scope;
                $suggestionBaseScopeShadow=scopyShadow;
            };
            // show vars hint
            var showVarsHint=function(key, index, scope){
                ood.resetRun(showSuggetionID,function(){
                    showSuggestion(key, index);
                });
                // refresh
                $suggestionBaseScope=scope;
            };
            // show vars hint
            var tryToAdjustHint=function(key,index, scope){
                var sc=$suggestionBaseScopeShadow||$suggestionBaseScope;
                if(sc && sc.line==scope.line && sc.start==scope.start){
                    var coordinates =cm.cursorCoords(true,"page"),
                        left=coordinates.left ,
                        top=coordinates.top ;    
                    adjustSuggetion(left, top, key, "", true);
                }
                // refresh
                $suggestionBaseScope=scope;
            };
            // apply suggestion to code
            var applySuggestion=function(value){
                var editor=profile.$cm,o=$suggestionBaseScope;
                editor.replaceRange(value, 
                    {line:o.line, ch:o.start},
                    {line:o.line, ch:o.end});
                
                // indentat multi line
                var line=o.line, hasE;
                value.replace(/\n/g,function(){
                    editor.indentLine(++line);
                    hasE=1;
                });
                editor.setCursor({line:o.line+(hasE?1:0), ch:o.start+value.length});
                editor.execCommand("indentAuto");
            };
            var codeType=profile.properties.codeType,
                mode = CONF.getRenderMode(profile.properties.codeType);
            if(!mode)mode=CONF.getRenderMode("txt");

            // load codemirror
            var options={
                value:profile.properties.value||"",

                smartIndent:true,
                indentUnit:4,
                tabSize:4,
                indentWithTabs:false,

                "mode": mode.mime,
                keyMap: "sublime",
                
                matchBrackets: true,
                continueComments: "Enter",
                autoCloseBrackets:true,
                lineNumbers:true,
                lint:(codeType=='js'||codeType=='json'||codeType=='css'||codeType=='html')?true:false,
                readOnly:profile.properties.readonly,
                styleActiveLine: true,
                lineWrapping: false,
                flattenSpans:false,
                highlightSelectionMatches: {showToken: /^[$\w]\w*/},
    	        foldGutter:true,
                gutters: ["CodeMirror-lint-markers","CodeMirror-linenumbers", "CodeMirror-foldgutter"],
                extraKeys: {
                    'Ctrl':function(){
                        hideSuggestion();
                    },
                    "Ctrl-Q": function(cm){ cm.foldCode(cm.getCursor()); },
                    "Ctrl-S": function(){
                        hideSuggestion();
                        if(profile.onSaveCommand)
                            profile.boxing().onSaveCommand(profile);
                    },
                    "Ctrl-F": function(cm){
                        hideSuggestion();
                        RAD.EditorTool.showFindWnd(null,profile.boxing(),{left:0,top:0},cm.getSelection());
                    },
                    "Tab": function(cm) {
                        if(cm.doc.somethingSelected())return CodeMirror.Pass;
                        var spaces = Array(cm.getOption("indentUnit") + 1).join(" ");
                        cm.replaceSelection(spaces, "end", "+input");
                    },
                    "Ctrl-D":function(cm){
                        cm.execCommand("deleteLine");
                    }
                }
            };
            
            var obj=CONF.getStatus(),
                editorTheme=obj.editorTheme,
                editorFontSize=obj.editorFontSize,
                lineWrapping=obj.lineWrapping;

            if(editorTheme){
                // include CSS first
                profile.boxing().addCMTheme(editorTheme);
                options.theme=editorTheme;
            }
            if(ood.isSet(lineWrapping)){
                options.lineWrapping=!!lineWrapping;
            }

            var cm = profile.$cm = new CodeMirror(function(elt){
                profile.getSubNode('BOX').append(elt);
                
                if(editorFontSize)
                    elt.style.fontSize=editorFontSize+"px";
            }, options);

            //cm.setOption("mode", mode);
            CodeMirror.modeURL = "/plugins/codemirror5/mode/%N/%N.js";

            CodeMirror.autoLoadMode(cm, mode.mode);

            if(profile.onCodeModeSet){
                ood.asyRun(function(){
                    if(!profile.box)return;
                    profile.boxing().onCodeModeSet(profile, mode);
                });
            }
            
            if(mode.mode=="null"){
                if(!profile.$initialized)
                    profile.$initialized=true;
                if(profile.onRendered)
                    profile.boxing().onRendered(profile, true);
            }else{
                cm.on("rendered",function(cm,finished){
                    if(!profile.$initialized)
                        profile.$initialized=true;
                    if(profile.onRendered)
                        profile.boxing().onRendered(profile, finished);
                });
            }
            cm.on("change",function(cm,obj){
                if(profile.$initialized && profile.onValueChanged)
                    profile.boxing().onValueChanged(profile, cm.doc.getValue()!=profile.properties.value);
                if(codeType!='js'&&codeType!='html') return;

                var handled;
                if(obj.origin=="+input"){
                    // igore redo/undo
                    if(obj.text[0]){
                        if(obj.text[0]=="."){
                            // only for js file
                            if(codeType!='js') return;
                            
                            obj.to.ch++;
                            var token=cm.getTokenAt(obj.to),type=token.type;
                            if(type!==null)
                                return;
                            // show suggestion hint for : token.string
                            var pos=cm.getCursor();
                            showDotHint(cm.doc.indexFromPos(pos), {start:++token.start, end:++token.end, line:pos.line});
                            handled=true;
                        }else if(obj.text[0]!==" "){
                            obj.to.ch++;
                            var token=cm.getTokenAt(obj.to),type=token.type;
                            if(type=="variable"||type=="variable-2"||type=="keyword"||type=="property"){
                                var pos=cm.getCursor();
                                if(pos.line==obj.to.line && pos.ch>=token.start && pos.ch<=token.end){
                                    if($suggestionShowed)
                                        tryToAdjustHint(token.string, cm.doc.indexFromPos(pos), {start:token.start, end:token.end, line:pos.line});
                                    else{
                                        if(type=='property'){
                                            // only for js file
                                            if(codeType!='js') return;
                                            var t2=cm.getTokenAt({line:obj.to.line, ch:obj.to.ch - token.string.length});
                                            if(t2.type!==null || t2.string!=='.')
                                                return;
                                            // show suggestion hint for : token.string
                                            showDotHint(cm.doc.indexFromPos(pos) - obj.text.length - 1,null,token.string,{start:++t2.start, end:++t2.end, line:pos.line});
                                        }else{
                                            showVarsHint(token.string, cm.doc.indexFromPos(pos), {start:token.start, end:token.end, line:pos.line});
                                        }
                                    }
                                    handled=true;
                                }
                            }
                        }
                    }
                }else if(obj.origin=="+delete"){
                    if($suggestionShowed){
                        var token=cm.getTokenAt(obj.to),type=token.type,str=token.string;
                        if($suggestionShowed===true){
                            if(type=="variable"||type=="variable-2"||type=="keyword"){
                                var pos=cm.getCursor();
                                if(pos.line==obj.to.line && pos.ch>=token.start && pos.ch<=token.end){
                                    tryToAdjustHint(token.string, cm.doc.indexFromPos(pos), {start:token.start, end:token.end, line:pos.line});
                                    handled=true;
                                }
                            }
                        }else if($suggestionShowed===1){
                             if(type=="property"){
                                var pos=cm.getCursor();
                                tryToAdjustHint(token.string, cm.doc.indexFromPos(pos), {start:token.start, end:token.end, line:pos.line});
                                handled=true;
                             }else if(type===null && str=="."){
                                var pos=cm.getCursor();
                                showDotHint(cm.doc.indexFromPos(pos), {start:++token.start, end:++token.end, line:pos.line});
                                handled=true;
                             }
                        }
                    }
                }
                if(!handled){
                    //if hint/hint2 showed, hide it
                    hideSuggestion();
                }
            });
            cm.on("blur",function(){
                //hideSuggestion();
            });
            cm.on("keypress",function(cm,key){
                if(codeType!='js'&&codeType!='html') return;
                if($willshowDotHint && ood.Event.getKey(key)[0]!="."){
                    hideSuggestion();
                }
            });
            cm.on("keydown",function(cm,key){
                if(codeType!='js'&&codeType!='html') return;
                if($willshowDotHint && ood.Event.getKey(key)[0]!="."){
                    hideSuggestion();
                }
            });
            cm.on("cursorActivity",function(cm){
                if(!cm.hasFocus())return;
                
                if(codeType!='js'&&codeType!='html') return;
                if($suggestionBaseScope){
                    var pos=cm.getCursor(),
                        scope=$suggestionBaseScope;
                    // not in region
                    if(pos.line!==scope.line || pos.ch<scope.start || pos.ch>scope.end){
                        hideSuggestion();
                    }
                }
                ood.resetRun("cm_showtips",function(){
                    var state = cm.state.matchHighlighter;
                        if(state){
                        //only for selection, and matchhighlight
                        if(state.overlay && state.style=="matchhighlight" && cm.doc.somethingSelected()) {
                            var cur = cm.getCursor(),
                                sel = cm.doc.getSelection(),
                                token = cm.getTokenAt(cur);
                            // only for whole word
                            if(sel===token.string){
                                showDotHint(cm.doc.indexFromPos(cur), {start:token.start, end:token.end, line:cur.line}, token.string);                        }
                        }
                    }
                },200);
            });
        },
        _onresize:function(profile,width,height){
            var size = arguments.callee.upper.apply(this,arguments);
            profile.getSubNode('BOX').cssSize(size);
            // have to use px here
            if(profile.$cm)profile.$cm.setSize(profile.$px(size.width),profile.$px(size.height));
        }
    }
});
﻿ood.Class('RAD.ClassTool',null,{
    Static:{
        _this:'____this____',
        getClassName:function(str, parent){
            var reg1=/^(\s*\/\*[^*@]*\*+([^\/][^*]*\*+)*\/\s*)|^(\s*\/\/[^\n]*\s*)/,
                reg12=/(\s*\/\*[^*@]*\*+([^\/][^*]*\*+)*\/\s*)$|(\s*\/\/[^\n]*\s*)$/,
                reg2=/(\{([^\{\}]*)\})|(\[([^\[\]]*)\])/,
                reg3=/\s*(((function\s*([\w$]+\s*)?\(\s*([\w$\s,]*)\s*\)\s*)?(\{([^\{\}]*)\}))|(\[([^\[\]]*)\]))/g,
                reg4=/^[\xEF\xBB\xBF\uFEFF\s]*(ood.)?Class\s*\(\s*(([\']([^\']+)[\'])|([\"]([^\"]+)[\"]))\s*\,\s*(([\']([^\']*)[\'])|([\"]([^\"]*)[\"])|(null)|(undefined))\s*\,1\s*\)\s*;?\s*$/,
                reg5=/^[\xEF\xBB\xBF\uFEFF\s]*(ood.)?Class\s*\(/,
                reg6=/^[a-zA-Z]+[\w\.]*[\w]+$/,
                reg7=/^\"[a-zA-Z]+[\w\.]*[\w]*\"$/,
                reg8=/^\'[a-zA-Z]+[\w\.]*[\w]*\'$/
                ;
            // clear top comments
            while(reg1.test(str))
                str = str.replace(reg1,'');
            // clear bottom comments
            while(reg12.test(str))
                str = str.replace(reg12,'');

            // clear string/reg
            var arr=[
            [/"(\\.|[^"\\\n])*"/,function(a){
                return reg7.test(a[0])?a[0]:'\"\"'
            }],
            [/'(\\.|[^'\\\n])*'/,function(a){
                return reg8.test(a[0])?a[0]:"\'\'"
            }],
            [/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,'null'],

            // clear comments
            [/\/\*[^*]*\*+([^\/][^*]*\*+)*\//,''],
            [/\/\/[^\n]*/,'']
            ];

            str = ood.replace(str, arr);

            // check "Class(" string
            if(!reg5.test(str))
                return false;
            // clear "{}", "[]" and "funciton(){}"
            while(reg2.test(str))
                str = str.replace(reg3, '1');
            // check "Class(.....)"
            if(reg4.test(str))
                str=str.replace(reg4,parent?'$7':'$2').replace(/[\'\"]/g,"");
            else
               return false;
            // check name space
            if(reg6.test(str))
                return str;
            else
                return false;
        },
        isJson:function(txt){
            var reg = new RegExp("^(\\s*\\/\\*[^*@]*\\*+([^\\/][^*]*\\*+)*\\/\\s*)|^(\\s*\\/\\/[^\\n]*\\s*)");
            while(reg.test(txt))
                txt = txt.replace(reg,'');
            return /^\s*(\{|\[|function)/.test(txt);
        },
        //get class object from a Class declare, include comments words
        getClassObject : function(str){
            str = str.slice(str.indexOf('{')+1, str.lastIndexOf('}'));
            var obj = eval('({'+str+'})');
            str=null;
            return obj;
        },
        getCodeFromStruct:function(o,sublayer){
            try{
                var self = arguments.callee, arr=[];
                if(o){
                    if(o.sub){
                        if(o.frame){
                            ood.each(o.sub,function(o,i){
                                if(!ood.isNull(o.comments))
                                    arr.push((o.comments ||'') + i + ':' + (o.code?o.code:o.sub?self.call(this,o,true):''));
                            },this);
                            return (sublayer?'':(o.comments ||'')) + o.frame.replace('*1', o.name||'').replace('*2', o.pname||'').replace('*3', arr.join(', ').replace(/\$/g,"\x01")).replace(/\x01/g, "$");
                        }else return '';
                    }else
                        return (o.code ||'').replace(/^[\r\n]*/, '');
                }else return '';
            }catch(e){ood.message(ood.getRes('RAD.classtool.err2'))+":"+String(e);return false}
        },
        parseSingleBlock:function(txt){
            try{
                var reg1 = new RegExp("^(\\s*\\/\\*[^*@]*\\*+([^\\/][^*]*\\*+)*\\/\\s*)|^(\\s*\\/\\/[^\\n]*\\s*)"),
                    reg2 = new RegExp("(\\s*\\/\\*[^*@]*\\*+([^\\/][^*]*\\*+)*\\/\\s*)|^(\\s*\\/\\/[^\\n]*\\s*)$"),
                    str,
                    comments,
                    code;

                while(reg2.test(txt))
                    txt = txt.replace(reg2,'');

                str = txt;
                while(reg1.test(str))
                    str = str.replace(reg1,'');

                str = str.replace(/\s*/,'');
                if(!str)return {comments:null, code:null};

                comments = '\n'+txt.replace(str,'');
                code = str.replace(/\s*$/,'');

                //comments/reg
                str = ood.replace(str, [
                    ["(^|\\n)\\s*\\/\\*[^*@]*\\*+([^\\/][^*]*\\*+)*\\/\\s*", ''],
                    ["\\n\\s*\\/\\/[^\\n]*\\s*", ''],
                    [/([^\w\x24\/\'\"*)\]\?:]\s*)(\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*)\s*([\)\}\]:,;\r\n])/.source,function(arg,i){
                        return str[i+1]+ str[i+5];
                    }]
                ]);

                code = code.replace(/([}\]])[^}\]]*$/,'$1');

                //check it's a single block
                //in '' or ""
                str = ood.replace(code, [
                    ["null|undefined|NaN", ''],
                    [/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,''],
                    [/-?(\d*\.?\d+|\d+\.?\d*)([eE][+-]?\d+|%)?\b/,''],
            		["'(\\\\.|[^'\\\\])*'", ''],
            		['"(\\\\.|[^"\\\\])*"', '']
                ]);

                while(/(\{([^\{\}]*)\})|(\[([^\[\]]*)\])/.test(str)){
                    str = str.replace(/\s*(((function\s*([\w$]+\s*)?\(\s*([\w$\s,]*)\s*\)\s*)?(\{([^\{\}]*)\}))|(\[([^\[\]]*)\]))/g, '');
                }
                if (ood.str.trim(str)!='') return false;

                return {comments: comments, code:code};
            }catch(e){ood.message(ood.getRes('RAD.classtool.err3')+":"+String(e));return false}
        },
        //get class struct from a Class declare, include comments words
        getClassStruct : function(str){
            try{
                str = ood.replace(str, [
                    [/(\r\n|\r)/g, "\n"],
                    [/( +)(\n)/g, "$2"],
                    [/\t/g, "    "]
                ]);

                //clear mash
                var t,
                index=1,
                index1=1,
                cache={},
                cache1={},
                result,
                result2,
                code = function(str,i) {
            		var ret = "#" + (index++) +"#";
            		cache[ret] = str[0];
            		return ret;
            	},
            	//special for regexp source string
                _code = function(str,i) {
                    var ret = "#" + (index++) +"#";
            		cache[ret] = str[i+2];
            		return str[i+1]+ret+str[i+5];
            	},
            	code1 = function(str) {
            		var ret = "`" + (index1++);
            		cache1[ret] = str[0];
            		return ret;
            	},
            	restore = function(str){
                	return str.replace(/#(\d+)#/g, function(m){
                		return cache[m];
                	});
                },
            	restore1 = function(str){
                	return str.replace(/`(\d+)/g, function(m){
                		return cache1[m];
                	});
                };

                str = ood.replace(str, [
                    ["(^|\\n)\\s*\\/\\*[^*@]*\\*+([^\\/][^*]*\\*+)*\\/[^\\n]*", code],
                    ["(^|\\n)\\s*\\/\\/[^\\n]*", code],
                    [/([^\w\x24\/\'\"*)\]\?:]\s*)(\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*)\s*([\)\}\]:,;\r\n])/g.source,_code]
                ]);

                str = ood.replace(str, [
            		["'(\\\\.|[^'\\\\])*'", code1],
            		['"(\\\\.|[^"\\\\])*"', code1]
                ]);

                var frame = str.replace(/(^[^{]*\{)\s*((.|[\r\n])*)([^\s])(\s*}[^}]*$)/,'$1*3$5').replace(/(#\d+#)+/g,''),
                    o = {sub:{}};

                if(t=str.match(/^((#\d+#)+)/))
                    o.comments = restore(t[0]);
                else o.comments = '';

                o.name = restore1(cache1['`1'].replace(/[\'\" ]*/g,''));
                
                var i2=str.indexOf(",", 1),
                    i21=str.indexOf("[", i2+1),
                    i22=str.indexOf("]", i2+1),
                    i3=str.indexOf(",", i2+1);
                if(i21<i3){
                    var str=restore(restore1(str.substring(i21,i22+1)));
                    o.pname = eval(str);
                    str=null;
                }else{
                    o.pname = str.substring(i2+1,i3);
                    o.pname = /[\'\"]/.test(o.pname) ? o.pname.replace(/[\'\" ]*/g,''): null;
                }

                o.frame = restore1(frame.replace(o.name,'*1').replace(o.pname,'*2'));

                str = str.slice(str.indexOf('{')+1, str.lastIndexOf('}'));

                result = o.sub;

                //get {}
                var index2=1,
                cache2={},
                code2 = function(str) {
            		var ret = "'~" + index2++ +"'";
            		cache2[ret] = str;
            		return ret;
            	},
                code3 = function(a,b,str) {
                    if(a.indexOf('~')!=-1)return a;

            		var ret = "'~" + index2++ +"'";
            		cache2[ret] = str;
            		return b + ret;
            	},
            	restore2 = function(str){
                    if(str.indexOf('~')==-1)return str;

                    str = cache2["'"+str+"'"];
                    while(/'~\d+'/.test(str))
                        str = str.replace(/'~\d+'/g, function(m){
                		    return cache2[m];
                	    });
                	return str;
                };
                       
                while(/(\{([^\{\}\[\]]*)\})|(\[([^\[\]\{\}]*)\])/.test(str)){
                    str = str.replace(/\s*(((function\s*([\w$]+\s*)?\(\s*([\w$\s,]*)\s*\)\s*)?(\{([^\{\}\[\]]*)\}))|(\[([^\[\]\{\}]*)\]))/g, code2);
                }
                if(/[\{\}\[\]]/.test(str)){
                    return false;
                }

                // handler any \s for comments
                str = ood.replace(str, ['\\s+', code]);

                //get comments first , 'Constructor', 'Initialize', 'Before', 'After', 'Instance', 'Static'
                str = str.replace(/((#\d+#)+)([\w]+)((#\d+#)*):/g, function(z,a,b,c){
                    result[c] = {comments: restore(a)};
                    return c+':';
                });
                str = str.replace(/(#\d+#)/g, '');
                
                var obj;
                try{
                    obj = eval('({' + str + '})');
                    str=null;
                }catch(e){
                    return false
                 }

                //get code of those
                ood.arr.each(['Constructor', 'Dependency', 'Initialize', 'Before', 'After','$End'],function(i){
                    if(obj[i]){
                        result[i] = result[i] || {};
                        result[i].code = restore(restore1(restore2(obj[i])));
                    }else
                        result[i] = {};
                    ood.arr.each(ood.toArr('code,comments'),function(j){
                        result[i][j] = ood.isDefined(result[i][j])?result[i][j]:null;
                    });
                });

                var obj2;
                ood.arr.each(['Instance', 'Static'],function(i){
                    if(obj[i]){
                        //for not function/{}/[] vars
                        var temp = cache2["'"+obj[i]+"'"];
                        var frame = temp.replace(/(^[^{]*\{)\s*((.|[\r\n])*)([^\s])(\s*}[^}]*$)/,'$1*3$5');
                        //delete the last comment
                        temp = temp.replace(/(#\d+#)*\s*(\})$/g, '$2');

                        temp = '(' + temp + ')';

                        // handler any \s for comments
                        temp = ood.replace(temp, ['\\s+', code]);

                        result[i] = result[i] || {};
                        result2 = result[i].sub = {};
                        result[i].frame = frame;

                        temp = temp.replace(/(:)([^,\}]+)/g, code3);
                        temp = restore1(temp);

                        //get comments first
                        temp = temp.replace(/((#\d+#)+)([\w]+)((#\d+#)*):/g, function(z,a,b,c){
                            result2[c] = {comments: restore(a)};
                            return c+':';
                        });
                        //for multi comments
                        temp = temp.replace(/(#\d+#)/g, '');

                        obj2 = eval(temp);
                        temp=null;
                        ood.each(obj2,function(o,j){
                            result2[j] = result2[j] || {};
                            result2[j].code = restore(restore1(restore2(o)));
                        });
                    }else
                        result[i] = {};
                    ood.arr.each(ood.toArr('code,comments,sub,frame'),function(j){
                        result[i][j] = ood.isDefined(result[i][j])?result[i][j]:null;
                    });
                });

                return o;
            }catch(e){
                return false;
            }
        },

        //get class struct from code text analysis
        getClassStruct2 : function(code, index){
            // first Class
            if((!ood.isSet(index)) || index<0 || index>=code.length)index=code.length;
            var ns=this,
                cache=ns._Cache2||(ns._Cache2={});
            if(cache[code+"^**^"+index])return cache[code+"^**^"+index];
            
            var rf=function(a){return ood.str.repeat(" ", a[0].length)};
            var ocode=code;
            // clear string/reg,comments
            code = ood.replace(code, [
                // simplify some
                [/\r\n?|\n/,'\n'],
                [/(\uFEFF|\xA0|[\t\x0B\f])/, rf],
                //protect "a"
                [/"([\w\$])?[\w\.]*"/,'$0'],
                [/'([\w\$])?[\w\.]*'/,"$0"],
                // clear string
                [/"(\\.|[^"\\\n])*"/,rf],
                [/'(\\.|[^'\\\n])*'/,rf],
                // clear reg
                [/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,rf],
                // clear comments
                [/\/\*[^*]*\*+([^\/][^*]*\*+)*\//,rf],
                [/\/\/[^\n]*/,rf]
                ]);
                
            // find the right class start pos
            var regoodCls = /\b(ood.)?Class\s*\(\s*["'\w\$\.]+\s*\,\s*["'\w\$\.]+\s*\,\s*\{/g,
                found,clsStartPos=-1,clsEnd,j=-1,codeStart;
            // find the first one
            if((found = regoodCls.exec(code))!=null){
                j=regoodCls.lastIndex;
                if(j>=index) {
                    if(clsStartPos==-1){
                        // Not in a Class
                        return null;
                    }
                }
                // maybe it's the start pos of class's code
                clsStartPos=j-found[0].length;
            };

            // find struct
            var len=code.length,
                pos=code.indexOf("{", clsStartPos)+1,
                clsCodeStart=pos,
                layer=1,
                i1=code.indexOf("(", clsStartPos+1),
                i2=code.indexOf(",", i1+1),
                i21=code.indexOf("[", i2+1),
                i22=code.indexOf("]", i2+1),
                i3=code.indexOf(",", i2+1),
                hash={},prevColonPos=-1,qMark=false,
                keyPattern=/((\b[\w\$][\w]*\b)|(\'[^']*\')|(\"[^"]*\"))\s*$/,
                lastOKPos=pos,
                c,tmpstr,tmpstr2,tmpResult,key,type,args,subcode,codefrom,codeto,layer1Key,spaceCount=0;

            hash.name = code.substring(i1+1,i2).replace(/[\'\" ]*/g,'');
            if(i21<i3){
                hash.pname = code.substring(i21,i22+1);
                try{
                    hash.pname = eval(hash.pname);
                }catch(e){
                    return null;
                }
                ood.arr.each(hash.pname,function(o){
                    if(o=='ood.Module')
                        hash.isModule=true;
                    else{
                        var t=ood.SC(o);
                        hash.isModule=t && t['ood.Module'];
                    }
                });
            }else{
                hash.pname = code.substring(i2+1,i3);
                hash.pname = /[\'\"]/.test(hash.pname) ? hash.pname.replace(/[\'\" ]*/g,''): null;
                if(!/^[\w\$][\w\.]*$/.test(hash.name) || !/^[\w\$]?[\w\.]*$/.test(hash.pname)){
                    return null;
                }
                if(hash.pname=='ood.Module')
                    hash.isModule=true;
                else{
                    if(hash.pname){
                        var t=ood.SC(hash.pname);
                        hash.isModule=t && t['ood.Module'];
                    }
                }
            }

            hash.arr = [];

            // find sub object/functions
            do{
                c=code[pos++];
                //ignore boolean?{}:{} pattern;
                if(/\s/.test(c)){
                    spaceCount++;
                }else{
                    if(c=="?"){
                        if(layer<=2){
                            qMark=true;
                        }
                    }else if(c==":"){
                        if(layer<=2){
                            if(qMark){
                                qMark=false;
                                continue;
                            }else if(prevColonPos!=-1){
                                continue;
                            }else{
                                prevColonPos=pos;
                            }
                        }
                    }else if(c=="("){
                        // has prev :
                        if(prevColonPos!=-1){
                            var nn=code.indexOf(")", pos);
                            if(nn!=-1){
                                pos=nn+1;
                                continue;
                            }
                        }
                    }
                    else if(c==','){
                        // has prev : [same1]
                        if(prevColonPos!=-1){
                            // only collection top 2 layers
                            if(layer<=3){
                                type='other';
                                subcode=ocode.substring(codefrom=prevColonPos,codeto=pos-spaceCount-1);
                            }
                            
                            // get key
                            tmpstr2=code.substring(lastOKPos, prevColonPos-1);
                            tmpResult=keyPattern.exec(tmpstr2);
                            if(tmpResult!=null){
                                key=tmpResult[0].replace(/[\'\"\s]/g,'');    
                            }

                            // use once only
                            prevColonPos=-1;
                            lastOKPos=pos;
                        }
                    }
                    // if the second {
                    else if(c=='{'){
                        layer++;

                        // has prev :
                        if(prevColonPos!=-1){
                            // only collection top 2 layers
                            if(layer<=3){
                                //get type
                                tmpstr=code.substring(prevColonPos, pos).replace(/\s*/,'');
                                // function
                                if(tmpstr[0]=='f'){
                                    args=tmpstr.substring(tmpstr.indexOf('(')+1,tmpstr.indexOf(')')).split(',');
                                    if(args[0]==="")args=null;
                                    type='function';
                                }else if(tmpstr[0]=='{'){
                                    type='object';
                                } 
                                // get key
                                tmpstr2=code.substring(lastOKPos, prevColonPos-1);
                                tmpResult=keyPattern.exec(tmpstr2);
                                if(tmpResult!=null){
                                    key=tmpResult[0].replace(/[\'\"\s]/g,'');    
                                    if(layer==2 && (type=='object' || type=='function')){
                                        layer1Key=key;
                                        codefrom=pos-1;
                                    }
                                }
                            }
                            // use once only
                            prevColonPos=-1;
                            lastOKPos=pos;
                        }
                    }else if(c=='}'){
                        // has prev : [same1]
                        if(prevColonPos!=-1){
                            // only collection top 2 layers
                            if(layer<=3){
                                type='other';
                                subcode=ocode.substring(codefrom=prevColonPos,codeto=pos-spaceCount-1);
                            }
                            
                            // get key
                            tmpstr2=code.substring(lastOKPos, prevColonPos-1);
                            tmpResult=keyPattern.exec(tmpstr2);
                            if(tmpResult!=null){
                                key=tmpResult[0].replace(/[\'\"\s]/g,'');    
                            }

                            // use once only
                            prevColonPos=-1;
                            lastOKPos=pos;
                        }

                        layer--;
                        if(layer===0){
                            subcode=ocode.substring(codefrom=clsCodeStart-1,codeto=pos);
                            hash.code=subcode;
                            hash.from=codefrom;
                            hash.to=codeto;
                        }else if(layer===1){
                            if(layer1Key){
                                ood.set(hash.sub,[layer1Key,"to"],pos);
                                hash.arr.push(layer1Key);
                            }
                        }else if(layer===2){
                            subcode=ocode.substring(codefrom=codeStart-1,codeto=pos);
                            ood.set(hash.sub,[layer1Key,"sub",key,'code'],subcode);
                            ood.set(hash.sub,[layer1Key,"sub",key,'from'],codefrom);
                            ood.set(hash.sub,[layer1Key,"sub",key,'to'],codeto);
                        }
                        //
                        prevColonPos=-1;
                        lastOKPos=pos;
                    }
                    spaceCount=0;
                }
                
                if(type){
                    if(!hash.sub)hash.sub={};
                    if(layer1Key){
                        if(layer1Key!=key){
                            if(!ood.get(hash.sub,[layer1Key,"sub"]))
                                ood.set(hash.sub,[layer1Key,"sub"],{});
                            ood.set(hash.sub,[layer1Key,"sub",key],{
                                type:type,
                                args:args,
                                code:subcode,
                                from:codefrom,
                                to:codeto
                            });
                            hash.sub[layer1Key].arr.push(key);
                        }else{
                            ood.set(hash.sub,[layer1Key],{
                                type:"object",
                                from:codefrom,
                                arr:[]
                            });
                        }
                    }else{
                        hash.sub[key]={
                            type:type,
                            args:args,
                            code:subcode,
                            from:codefrom,
                            to:codeto
                        };
                    }
                    codeStart=pos;
                }
                
                if(layer===1&&c=='}'&&layer1Key)layer1Key=null;

                type=args=null;
            }while(pos<=len && layer>0)

            ood.breakO(cache);
            cache={};
            return cache[code+"^**^"+index]=hash;
        },
        getArgsFromAPI:function(cls,key,isInstance,firstArgsCode){
            var doc=ood.getRes("doc."+cls+(isInstance?".prototype":"")+"."+key);
            // try parent's member function
            if(ood.isStr(doc) && doc===key){
                var obj = ood.get(window,(cls+(isInstance?".prototype":"")+"."+key).split('.'));
                if(obj && obj.$original$)
                    doc= ood.getRes("doc." +obj.$original$ + '.prototype.'+key);
            }

            if(ood.isStr(doc) && doc===key)
                return null;

            if(doc){
                var rp,clso=ood.SC.get(cls);
                if(clso && clso.$EventHandlers)
                    rp=ood.fun.args(clso.$EventHandlers[key]);

                var paras=doc.$paras, arr=[], str1, str2;
                if(paras&&paras.length){
                    // the first argument is special
                    if(firstArgsCode){
                        arr=[{code:firstArgsCode}];    
                    }
                    for(var i=firstArgsCode?1:0;i<paras.length;i++){
                        if(clso && rp && clso.$DataModel && clso.$DataModel.items && rp[i]=="item"){
                            arr.push({code:"CONF.mixed_prop."+cls.replace(/\./g,"_")+"_item"});
                        }else if(clso && rp && cls=="ood.UI.TreeGrid" && rp[i]=="col"){
                            arr.push({code:"CONF.mixed_prop."+cls.replace(/\./g,"_")+"_col"});
                        }else if(clso && rp && cls=="ood.UI.TreeGrid" && rp[i]=="row"){
                            arr.push({code:"CONF.mixed_prop."+cls.replace(/\./g,"_")+"_row"});
                        }else if(clso && rp && cls=="ood.UI.TreeGrid" && rp[i]=="cell"){
                            arr.push({code:"CONF.mixed_prop."+cls.replace(/\./g,"_")+"_cell"});
                        }else{
                            str1=paras[i].replace(/(\w+).*/, '$1');
                            str2=paras[i].replace(/.*\:\s*(([\w]+\.)*[\w]+).*/, '$1');
                            arr.push({name:str1, type:((str2=="Event"||str2=="Element"||str2=="Document")?"Object":str2)+".prototype",ori:str2});
                        }
                    }
                    return arr;
                }
            }
            return null;
        },
        _alias:1,
        getClassStructWithScope:function(code,index,cacheKey1,cacheKey2){
            var ns=this,
                cache=ns._Cache1||(ns._Cache1={});
            if(cache[code+"^**^"+index])return cache[code+"^**^"+index];

            var hash=ns.getClassStruct2(code,index),
                _this=ns._this,t,t1;

            if(!hash)return null;
            
            // for those Class inner functions
            ood.arr.each(['Constructor', 'Dependency', 'Initialize', 'Before', 'After','$End'],function(i){
                if((t=ood.get(hash,["sub",i])) && t.type=='function'){
                    ood.set(hash,["sub",i],{
                        argsv:[_this,"''"],
                        _this:hash.pname?("__getThis('"+hash.pname+"',1)"):"{}"
                    });
                }
            });
            
            if(t=ood.get(hash,["sub","Instance","sub","initialize"])){
                t["_this"]=hash.pname?("__getThis('"+hash.pname+"',1)"):"{}";
            }

            // from parent Class
            if(hash.pname){
                if(t=ood.get(hash,["sub","Static","sub"])){
                    ood.each(t,function(o,key){
                        if(key==='sub')return;
                        //this
                        o["_this"]=hash.pname?("__getThis('"+hash.pname+"',1)"):"{}";
                        
                        //argsv
                        if(typeof(hash.pname)=='string'){
                            var arr=ns.getArgsFromAPI(hash.pname,key,false);
                            if(arr)o["argsv"]=arr;
                        }else{
                            ood.arr.each(hash.pname,function(cls){
                                var arr=ns.getArgsFromAPI(cls,key,false);
                                if(arr)o["argsv"]=arr;
                            })
                        }
                    });
                }
                if(t=ood.get(hash,["sub","Instance","sub"])){
                    ood.each(t,function(o,key){
                        //this
                        o["_this"]=hash.pname?("__getThis('"+hash.pname+"',0)"):"{}";
                        //argsv
                        if(typeof(hash.pname)=='string'){
                            var arr=ns.getArgsFromAPI(hash.pname,key,true);
                            if(arr)o["argsv"]=arr;
                        }else{
                            ood.arr.each(hash.pname,function(cls){
                                var arr=ns.getArgsFromAPI(cls,key,true);
                                if(arr)o["argsv"]=arr;
                            })
                        }
                    });
                }
            }
            // [[[[[ bak
            var bak=ood.Dom.pack,
                bak1=ood.absProfile.prototype.$link,
                bak11 = ood.absObj.$pickAlias;

            ood.Dom.pack=function(){var o=new ood.Dom(false),d=document.getElementById('abc');o._nodes=[d];return o};
            ood.absProfile.prototype.$link=function(){return this;};
            ood.absObj.$pickAlias = function(){return ns._alias++};
            // ]]]]]
            try{
                var globalCache;
                if(cacheKey1 && cacheKey2){
                    globalCache=window[cacheKey1] || (window[cacheKey1]={});
                    // for cache Class's runtime struct
                    if(globalCache[cacheKey2]){
                         // destroy last time created controls
                         if(ood.get(globalCache[cacheKey2],["Instance","_ctrlpool"])){
                            ood.each(globalCache[cacheKey2].Instance._ctrlpool,function(o,i){
                                if(o&&!o.destroyed){
                                    if(o.destroy)o.destroy();
                                    if(o.boxing && o.boxing())o.boxing().destroy();
                                }
                            });
                            globalCache[cacheKey2].Instance._ctrlpool=null;
                        }
                        ood.breakO(globalCache[cacheKey2]);
                        globalCache[cacheKey2]={};
                    }else {
                        globalCache[cacheKey2]={};
                    }
                    globalCache=globalCache[cacheKey2];
                }else{
                    globalCache={}
                }

                globalCache['Instance']={_ctrlpool:{},properties:{},events:{}};
                globalCache['Static']={};
                if(t1=ood.get(hash,['sub','Instance','sub'])){
                    ood.each(t1,function(o,i){
                        try{
                            var ecode = o.type=='function' ? ("(function("+(o.args?o.args.join(","):"")+"){})") : ("("+o.code+")");
                            globalCache['Instance'][i] = eval(ecode);
                            ecode=null;
                        }catch(e){globalCache['Instance'][i]=null}
                    });
                }
                if(t1=ood.get(hash,['sub','Static','sub'])){
                    ood.each(t1,function(o,i){
                        try{
                            var ecode = o.type=='function' ? ("(function("+(o.args?o.args.join(","):"")+"){})") : ("("+o.code+")"); 
                            globalCache['Static'][i] = eval(ecode);
                            ecode=null;
                        }catch(e){globalCache['Static'][i]=null}
                    });
                }
                
                // from dynamic (ood.Module only)
                // modified: try it for all class
                //if(hash.isModule){
                    // Instance.events
                    if(t=ood.get(hash,['sub','Instance','sub','events'])){
                        if(t=t.code){
                            try{
                               var ecode="("+t+")";
                               t=eval(ecode);
                               ecode=null;
                            }catch(e){t=null}
                            if(t&&ood.isHash(t)){
                                ood.each(t,function(evt,name){
                                    if(ood.isArr(evt))
                                        for(var i=0,l=evt.length;i<l;i++)
                                            if(typeof(evt[i])=="string"){
                                                evt=evt[i];
                                                break;
                                            }
                                    if(typeof(evt)=="string"){
                                        if(t1=ood.get(hash,['sub','Instance','sub',evt])){
                                            //argsv
                                            t1["argsv"]=ns.getArgsFromAPI("ood.Module",name,true,"this");
                                        }
                                    }
                                });
                            }
                        }
                    }
                    // Instance properties
                    if(t=ood.get(hash,['sub','Instance','sub','initialize'])){
                        if(t=t.code){
                            try{
                                var ecode="(function()"+t+")"
                                t=eval(ecode);
                                ecode=null;
                            }catch(e){t=null}
                            if(typeof(t)=='function'){
                                try{
                                    globalCache.Instance.$inDesign="xxx";
                                    t.call(globalCache.Instance);
                                }catch(e){}
                            }
                        }
                    }
                    if(t=ood.get(hash,['sub','Instance','sub','iniComponents'])){
                        if(t=t.code){
                            try{
                                // create lots of controls, have to destroy it somewhere
                                var ecode="(function()"+t+")";
                                t=eval(ecode);
                                ecode=null;
                            }catch(e){t=null}
                            if(typeof(t)=='function'){
                                try{
                                    globalCache.Instance.$inDesign="xxx";
                                    t.call(globalCache.Instance);
                                }catch(e){}
                                
                                // for all events
                                ood.each(globalCache.Instance._ctrlpool,function(o,i){
                                    var cls = o.key;
                                    ood.each(o.getEvents(),function(evt,key){
                                        if(ood.isArr(evt))
                                            for(var i=0,l=evt.length;i<l;i++)
                                                if(typeof(evt[i])=="string"){
                                                    evt=evt[i];
                                                    break;
                                                }
                                        if(typeof(evt)=="string"){
                                            if(t1=ood.get(hash,['sub','Instance','sub',evt])){
                                                //argsv
                                                t1["argsv"]=ns.getArgsFromAPI(cls,key,true, "(new "+cls+").get(0)");
                                            }
                                        }
                                    });
                                });
                                // must destroy here
                                ood.asyRun(function(){
                                    ood.each(globalCache.Instance._ctrlpool,function(o,i){
                                        if(o&&!o.destroyed){
                                            if(o.destroy)o.destroy();
                                            if(o.boxing && o.boxing())o.boxing().destroy();
                                        }
                                    });
                                    ood.breakO(globalCache.Instance)
                                });
                            }
                        }
                    }
                //}
            }finally{
            //[[[[[ restore
                ood.Dom.pack=bak;
                ood.absProfile.prototype.$link=bak1;
                ood.absObj.$pickAlias = bak11;
            //]]]]]
            }
    	    ood.breakO(cache);
    	    cache={};
            return cache[code+"^**^"+index]=hash;
        },
        // To get min code
        getMinCode : function(code,index){
            if(index<0 || index>=code.length)return "";
var t1=new Date;
            var reg2=/(\{(((\{\})|[^\{\}\x01])+)\})|(\[([^\[\]0\x01]+)\])/,
                reg3=/(((\s*function\s*([\w$][\w]*\s*)?\(\s*([\w$\s,]*)\s*\)\s*)?(\{(((\{\})|[^\{\}\x01])*)\}))|(\[([^\[\]0\x01]+)\]))/g;
        
            // add special char    
            code = code.replace(/\x01/g,'0');
            code = code.substring(0,index) + "\x01"+ code.substring(index+1,code.length);

            // clear string/reg,comments
            code = ood.replace(code, [
                // simplify some
                [/\r\n?|\n/,"\n"],
                [/(\uFEFF|\xA0|[\t\x0B\f])/, " "],
                //protect {"a":1}
                [/"[\w\$][\w\.]*"\s*\:/,'$0'],
                [/'[\w\$][\w\.]*'\s*\:/,"$0"],
                // clear string
                [/"(\\.|[^"\\\n])*"/,'"a"'],
                [/'(\\.|[^'\\\n])*'/,"'a'"],
                // clear reg
                [/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/,'(new RegExp())'],
                // clear comments
                [/\/\*[^*]*\*+([^\/][^*]*\*+)*\//,''],
                [/\/\/[^\n]*/,'']
                ]);
var t2=new Date;
//console.log(t2-t1);            
            // clear all function(){}, {} and []
            while(reg2.test(code)){
                code = code.replace(reg3, function(a){
                    return a[0]=="{"?"{}":a[0]=="["?"[0]":"(new Function())"
                }); 
            }
var t3=new Date;
//console.log(code,t3-t2);            
            var i=0,k=code.indexOf('\x01'),l=code.length,ignoreComma=true,
                a1=[],a2=[],a3=[],arr2=[],arr3=[],c,tmp=0,strtmp,prevDo=true;
            
            // if code not in any function, return 
            var tests=code.substring(0,k);
            if(!/\bfunction\b/.test(tests)){
                return tests;
            }
        
            // clear those useless code
            do{
                c=code[i++];
                if(i<k){
                    // if the second {
                    if(c=='{' && code[i]!='}'){
                        strtmp=code.substring(tmp,i+1);
                        arr2.push(strtmp+"\n");
                        // if found the outter function, stop search next {
                        if(/\:\s*function\b/.test(strtmp)){
                            arr2.push(code.substring(i+1,k)+"\n");
                            i=k;
                            continue;
                        }
                        ignoreComma=false;
                    }
                    // keep the pos of { or ,
                    if((c=='{' && code[i]!='}')||((!ignoreComma)&&c==','))
                        tmp=i;
                    if(c=="("){
                        if(code.substring(i-1,i+13)=="(new RegExp())"){
                            i+=13;
                        }else if(code.substring(i-1,i+15)=="(new Function())"){
                            i+=15;
                        }else{
                            ignoreComma=true;
                        }
                    }
                }else{
                    if(prevDo){
                        arr2.push("{}");
                        prevDo=false;
                    }
                    if(c=="{"){
                        a1.push(c);
                    }else if(c=="}"){       
                        if(a1.length===0)arr3.push(c);else a1.pop();
                    }else if(c=="["){
                        a2.push(c);
                    }else if(c=="]"){       
                        if(a2.length===0)arr3.push(c);else a2.pop();
                    }else if(c=="("){
                        a3.push(c);
                    }else if(c==")"){       
                        if(a3.length===0)arr3.push(c);else a3.pop();
                    }
                }
            }while(i<l)

            return arr2.join('\n').replace(/\s*\n\s*/g,'\n')+arr3.join('');
        },
        
        // To get content vars(global and local)
        getContextVars : function(code,index){
            code=code.substring(0,index);
            // use CodeMirror function
            var cm = new CodeMirror(new Function);
            cm.setValue(code);
            
            var hash={},funPos,
                // get vars from CodeMirror's state
                getVars=function(obj,hash){
                    vars=obj && obj.vars;
                    if(vars)do{hash[vars.name]=1}while(vars=vars.next);
                    if(obj && obj.prev)
                        getVars(obj.prev,hash);
                }; 
            var state=cm.getStateAfter(cm.doc.posFromIndex(index).line, true),vars;

            // get from local
            vars=state.localVars;
            if(vars)do{hash[vars.name]=1}while(vars=vars.next);

            // get from global
            vars=state.globalVars;
            if(vars)do{hash[vars.name]=1}while(vars=vars.next);

            // try to get from content
            getVars(state.context,hash);

            return hash;
        },
        getContextVars_fast : function(cm,index){            
            var hash={},funPos,
                // get vars from CodeMirror's state
                getVars=function(obj,hash){
                    vars=obj && obj.vars;
                    if(vars)do{hash[vars.name]=1}while(vars=vars.next);
                    if(obj && obj.prev)
                        getVars(obj.prev,hash);
                }; 
            var state=cm.getStateAfter(cm.doc.posFromIndex(index).line, false),vars;

            // get from local
            vars=state.localVars;
            if(vars)do{hash[vars.name]=1}while(vars=vars.next);

            // get from global
            vars=state.globalVars;
            if(vars)do{hash[vars.name]=1}while(vars=vars.next);

            // try to get from content
            getVars(state.context,hash);

            return hash;
        },
        // To get content vars assign code(from top to bottom)
        getContextAssignments : function(code, index){
            code=this.getMinCode(code, index);
//console.log(code);
            index=code.lastIndexOf('\n');
            // remove all extra spaces
            code=code.replace(/[ ]+/g," ");

            // remove all empty Class
            code=code.replace(/\b(ood.)?Class\s*\(\s*["'\w\$\.]+\s*\,\s*["'\w\$\.]+\s*\,\s*\{\}\s*\)\s*(;)?/g,"");

            var len=code.length,
                funpatt=/\s*function\s*([\w$]+\s*)?\(\s*[\w$\s,]*\s*\)\s*\{/g;
        
            // Is it an ood Class?
            var regoodCls = /\b(ood.)?Class\s*\(\s*["'\w\$\.]+\s*\,\s*["'\w\$\.]+\s*\,\s*\{/,
                isOODClass = regoodCls.exec(code);
            // If it's an ood Class, add special scope code
            if(isOODClass!=null){
                // from the first {
                var i=regoodCls.lastIndex+isOODClass[0].length,
                    // special scope key/type/start pos/end pos
                    firstType=null,firstKey=null,secondType=null,secondKey=null,
                    specialScopeS=-1,specialScopeE=len,specialVarDef=[],
                    keepi=i,colon,c;
        
                // loop to get special scope info
                while(i<len){
                    c=code[i++];
                    if(c==" " || c=="\n")continue;
                    if(colon){
                        // first layer is hash
                        if(c=="{"){
                            firstType='hash';
                            firstKey=code.substring(keepi+1,i-1).replace(/[\'\" \n:]/g,'');
                            
                            // to get second layer info
                            keepi=i;
                            colon=false;
                            while(i<len){
                                c=code[i++];
                                if(c==" " || c=="\n")continue;
                                if(colon){
                                    // the second layer of ood Class
                                    // special scope from
                                    if(funpatt.test(code.substring(i-1,len))){
                                        secondType='function';
                                        secondKey=code.substring(keepi+1,i-1).replace(/[\'\" \n:]/g,'');
                                        specialScopeS=i-1;                                
                                        if(funpatt.test(code.substring(i-1,len))){
                                            // special scope to
                                            specialScopeE=funpatt.lastIndex+i-1;
                                        }
                                        
                                        // to get function's arguments
                                        var stra="",startC;
                                        while(i<len){
                                            c=code[i++];
                                            if(c==" " || c=="\n")continue;
                                            if(c=="("){startC=1;continue;}else if(c==")"){break;}
                                            if(startC){stra+=c;}
                                        }
                                        specialVarDef=stra.split(',');
        
                                    }else{
                                        //ignore others
                                    }
                                    break;
                                }
                                // the fist :
                                colon = c==":";
                            }
                        // firts layer is function
                        }else if(c=="f"){
                            // special scope from
                            firstType='function';
                            firstKey=code.substring(keepi+1,i-1).replace(/[\'\" \n:]/g,'');
                            specialScopeS=i-1;
                            if(funpatt.test(code.substring(i-1,len))){
                                // special scope to
                                specialScopeE=funpatt.lastIndex+i-1;
                            }
                            
                            // to get function's arguments
                            var stra="",startC;
                            while(i<len){
                                c=code[i++];
                                if(c==" " || c=="\n")continue;
                                if(c=="("){startC=1;continue;}else if(c==")"){break;}
                                if(startC){stra+=c;}
                            }
                            specialVarDef=stra.split(',');
        
                        }else{
                            //Can not be other
                        }
                        break;
                    }
                    // find the fist :
                    colon = c==":";
                }
            }
            
            //collect var assign code
            var arr1=[],arr2=[],scopeS=-1,scopeE=-1,result,added=false,
                // var assignment pattern
                patt=/([\w$][\w]*)\s*\=\s*([^\s]{1})/g,
                codeL=code.length,
                inSpecialScope=false;
        
        outerloop:
            while ((result = patt.exec(code)) != null)  {
                //add code for special function arguments
                if(specialScopeS!=-1){
                    if(patt.lastIndex>=specialScopeS){
                        if(patt.lastIndex<specialScopeE){
                            inSpecialScope=true;
                            if(!added){
                                scopeS=arr1.length;
                                added=true;
                            }
                        }else{
                            inSpecialScope=false;
                            scopeE=arr1.length;
                        }
                    }else{
                        inSpecialScope=false;
                    }
                }
        
                var v2=result[2];
                
                // get var assign code
                if('='==v2[0]){
                    //ignore ==
                    continue outerloop;
                }else if('{'==v2[0]){
                    v2="{}";
                }else if('['==v2[0]){
                    v2="[]";
                }else{
                    var j=patt.lastIndex-1,cc,count=0,prevIsOperator=false,enter=false;;
                    while(j<=codeL){
                        cc=code[j++];
                        if(cc==" ")continue;
                        if(prevIsOperator){
                            prevIsOperator=false;
                        }
                        if(enter){
                            enter=false;
                            if(!(cc=="+"||cc=="-"||cc=="*"||cc=="/"||cc==".")){
                                break;
                            }
                        }
        
                        // match ()
                        if(cc=="("){
                            count++;
//                        }else if(cc==")"||cc=="}"){
                        }else if(cc==")"){
                            if(count>0)count--;
                            // stop at )
                            else{
                                 break;
                            }
                        }else if(cc=="+"||cc=="-"||cc=="*"||cc=="/"||cc=="."){
                            prevIsOperator=true;
                            continue;
                        }
                        // if in (), continue
                        if(count>0){
                            continue;
                        }else{
                            // stop at ,;
                            if(cc==","||cc==";"){
                                 break;
                            }else if(cc=="\n"){
                                if(prevIsOperator)continue;
                                else{
                                    break;
                                }
                            }
                        }
                    }
                    v2=code.substring(patt.lastIndex-1,j-1);
                    if(/\bfunction\s*\(/.test(v2)){
                        v2="(new Function())";
                    }
                    // avoid: try{(b=ns.);}catch(e){};
                    if(/\.$/.test(v2)){
                        v2=v2.replace(/[\.]+$/,'');
                    }
                }
                arr1.push(result[1]);
                arr2.push(v2);
            };
            return {vars:arr1,code:arr2,
                firstType:firstType,
                firstKey:firstKey,
                secondType:secondType,
                secondKey:secondKey,
                scopeS:scopeS,
                scopeE:scopeS==-1 ? -1 : (scopeE==-1?arr1.length:scopeE),
                outscope:scopeS==-1 ? false : index>=specialScopeE };
        }
    }
});
/*
An editor for js EUSUI class or normal js file
*/
ood.Class('RAD.JSEditor', 'ood.Module',{
    Instance:{
        events:{onReady:"_onready",onRender:"_onRender",onDestroy:"_ondestroy"},
        _onready:function(){
            var items=
                [{
                    "id":"fun",
                    "sub":[
                        {"id":"searchreplace","caption":"$RAD.pageEditor.searchreplace","imageClass":"ri-search-line","type":"button","tips":"$RAD.pageEditor.replacetips"},
                        {"id":"jumpto","caption":"$RAD.pageEditor.jumpto","imageClass":"ri-arrow-right-up-line","type":"button","tips":"$RAD.pageEditor.jumptotips"},
                        {"id":"indentall","caption":"$RAD.pageEditor.indentall","imageClass":"ri-indent-increase","type":"button","tips":"$RAD.pageEditor.indentalltips"}
                    ]
                },
                    {"id":"g3","sub":[
                            {"id":"rendermode", "caption":"mode", "imageClass":"ri-code-line"}
                        ]
                    }
                ];
            if(CONF.enable_codeEdtor){
                items.unshift({"id":"todesign","sub":[
                        {"id":"design","caption":"$RAD.JSEditor.to$RAD.JSEditor.dv","imageClass":"ri-brush-line","tips":"$RAD.JSEditor.dvtips"}
                    ]
                });
            }
            this.toolbar4.setItems(items);
        },
        _onRender:function(com){
        },
        _ondestroy:function(com){
            var ns=this;
            RAD.CodeEditor.clearSandbox("com:JSEditor:" + com.$xid +":");

            ns.___buildNSCode=ns.___treeHash=null;
            if(com._designer)com._designer.destroy();
        },
        resetEditorStyle:function(theme, fs, wrap){
            this.codeeditor.resetEditorStyle(theme,fs, wrap);
        },
        initialize:function(){
            var ns=this;

            ns.$transTaskList=[];
            ns.$transTaskListCached={};

            ns._ovalue="";
            ns._dirty=false;

            ns._uicode=null;

            ns._evalcache={};

            ns.properties={$pageviewType:'ood.UI.ButtonViews'};
        },
        _regClass:/\b(ood\.)?Class\s*\(\s*["'\w\$\.]+\s*\,\s*["'\w\$\.]+\s*\,\s*\{/,
        _rebuildNameSpace:function(value,cache){
            var ns = this,
                value=value||ns.getValue();
            // if no change
            if(value===ns.___buildNSCode){
                return;
            }

            var editor = ns.codeeditor,
                bv=ns.buttonview,
                lo=ns.layoutFill,
                tb=ns.toolbar4;
            // not a class
            if(!ns._regClass.test(value)){
                if(bv && !bv.getItemByItemId('design').disabled){
                    lo.updateItem("after",{hidden:true});
                    bv.updateItem("design",{disabled:true});
                    bv.reLayout(true);
                    tb.updateItem("outline",{value:true});
                    tb.showGroup("g1",false);
                }
                return;
            }else{
                if(bv && bv.getItemByItemId('design').disabled){
                    lo.updateItem("after",{hidden:false});
                    bv.updateItem("design",{disabled:false});
                    bv.reLayout(true);
                    tb.updateItem("outline",{value:true});
                    tb.showGroup("g1",true);
                }
            }

            if(cache!==false){
                ns.___buildNSCode=value;
            }
//var t1=new Date;
            // get Class Struct With Scope info
            var globalCache={},
                struct = RAD.ClassTool.getClassStructWithScope(value);

//console.log('build name space',struct,new Date-t1)
            // try to rebuild left class struct tree
            ns._rebuildTree(struct);
        },
        // 替换类结构树中的图标类
        _rebuildTree:function(struct){
            var ns=this,
                hashArr=[],item,
                items=[];

            ood.each(ood.get(struct,["sub"]),function(obj,i){
                hashArr.push(i);
                item={id:i,
                    caption:i,
                    tips:i
                };
                switch(i){
                    case 'Static':
                        item.imageClass='ri-braces-line';
                        item.sub=[];
                        hashArr.push("[");
                        ood.each(obj.sub,function(o,i){
                            hashArr.push(i);
                            var iconPos=o.type=='function'? 'ri-code-line':o.type=='object'?'ri-braces-line':o.type=='array'?'ri-list-unordered':'ri-code-line';
                            item.sub.push({id:'Static.'+i,tips:i, caption:i, imageClass:iconPos})
                        });
                        hashArr.push("]");
                        break;
                    case 'Instance':
                        item.imageClass='ri-braces-line';
                        item.sub=[];
                        hashArr.push("[");
                        ood.each(obj.sub,function(o,i){
                            hashArr.push(i);
                            var iconPos=o.type=='function'? 'ri-code-line':o.type=='object'?'ri-braces-line':o.type=='array'?'ri-list-unordered':'ri-function-line';
                            item.sub.push({id:'Instance.'+i,tips:i, caption:i, imageClass:iconPos})
                        });
                        hashArr.push("]");
                        break;
                    case 'Dependency':
                        item.imageClass='ri-code-line';
                        break;
                    case 'Constructor':
                    case 'Initialize':
                    case 'Before':
                    case 'After':
                        item.imageClass='ri-code-line';
                        break;
                    default:
                        item.imageClass='ri-code-line';
                }
                items.push(item);
            });

            var hash=hashArr.join("#");
            // rebuild the class struct tree in this case only
            if(hash!==ns.___treeHash){
                ns.___treeHash=hash;
                ns.treebarClass.setItems(items);
            }
        },
        _getEval:function(text){
            var ns=this,
                code=(text || ns.getValue()),
                result;

            if(ns._evalcache[code]){
                result = ns._evalcache[code];
            }else{
                result = RAD.CodeEditor.evalInSandbox(code,false, "com:JSEditor:" + ns.$xid +":2",false,false,"","window.___Class=ood.Class; ood.Class=function(a,b,c){return c;}; ",function(wnd){wnd.ood.Class=wnd.___Class; wnd.___Class=null});
                if(result.ok){
                    ood.breakO(ns._evalcache);
                    ns._evalcache[code] = result;
                    ns._designer.setLinkObj(result.ok);
                }
            }
            return result;
        },
        activate:function(){
            var ns=this,
                view=ns.buttonview.getUIValue();
            if(view=='code')
                ns.codeeditor.activate();
        },
        checkEditorCode:function(){
            var ns=this;
            if(ns._dirty && ns.buttonview.getUIValue()=='code'){
                return !!ns.codeeditor.getUIValue();
            }else{
                return true;
            }
        },
        getValue:function(){
            var ns=this;
            if(ns._dirty){
                if(ns.buttonview.getUIValue()=="design"){
                    // use syn
                    ns._designer.resetCodeFromDesigner(true);
                }
                return ns.codeeditor.getUIValue();
            }else{
                return ns._ovalue;
            }
        },
        setValue:function(value, silence, force){
            // adjust
            value=(value||'').replace(/\t/g, '    ').replace(/\u00A0/g, " ").replace(/\r\n?/g, "\n");

            var ns=this;
            if(force || ns._ovalue!=value){
                ns._ovalue=value;
                ns._dirty=false;

                ns.codeeditor.setValue(value, force);

                ns._uicode = null;

                if(ns.buttonview.getUIValue()=='design'){
                    ns._beforeValueUpdated(null,null,'design');
                }
            }
            if(!silence){
                var isCls=ns._regClass.test(value);
                ns.layoutFill.updateItem("after",{hidden:!isCls});
                ns.buttonview.updateItem("design",{disabled:!isCls});
                ns.toolbar4.showGroup("g1",isCls);
            }

            return ns;
        },
        customAppend:function(parent,subId,left,top){
            var ns = this;
            parent.append(ns.paneMain, subId);

            ns.buttonview.getSubNode('ITEMS').append(
                (new ood.UI.Image({
                    src:CONF.img_progress,
                    position:'relative',
                    left:4,
                    top:6
                })).setHost(ns,"imgProgress")
            );

            ns._disableUI();
        },
        iniExComs:function(){
            var ns = this;
            var pageview = (new (ood.SC.get(ns.properties.$pageviewType)))
                .setHost(ns,"buttonview")
                .setNoPanel(true)
                .setDock('top')
                .setHeight('auto')
                .setItems([
                    {"id":"code","caption":"$RAD.JSEditor.sv", imageClass:"ri-code-line","tips":"$RAD.JSEditor.svtips"},
                    {"id":"design","caption":"$RAD.JSEditor.dv",imageClass:"ri-brush-line","tips":"$RAD.JSEditor.dvtips"}])
                .beforeUIValueSet("_beforeValueUpdated")

            if(ns.properties.$pageviewType=="ood.UI.ButtonViews"){
                pageview.setDock("bottom");
            }

            if(ns.properties.$pageviewType=='ood.UI.ButtonViews'){
                pageview.setBarSize(28);
                pageview.setCustomStyle({"ITEMS":"position:relative","LIST":"position:relative"});
            }

            ns.paneMain.append(pageview);

            // apend designer
            var designer = new RAD.Designer();
            designer.setHost(ns, '_designer');
            designer.setEvents('onValueChanged',function(ipage, flag, fore){
                // must consider the code side
                ns._dirty=fore?flag:ns._dirty||flag;
                ns.fireEvent('onValueChanged', [ns, ns._dirty]);
            });
            designer.resetTaskList=function(){
                ns._disableUI();
                ns.$transTaskList=[];
                ns.$transTaskListCached={};
            };
            designer.addTask=function(task){
                ns.$transTaskList.push(task);
            };
            designer.hasTask=function(task){
                return !!ns.$transTaskList.length;
            };
            designer.startTaskList=function(){
                ns.checkRenderStatus(ns);
            };
            designer.resetCode=function(pkey, key, code, syn, isFun,comments){
                var fun=function(){
                    if(ns.$transTaskListCached[pkey+":"+key]===code)
                        return;
                    ns.addCodeToEditor(pkey, key, code,isFun,comments);
                    ns.$transTaskListCached[pkey+":"+key]=code;
                };

                if(syn){
                    fun();
                }else
                    ns.$transTaskList.push(fun);
            };
            designer.addCode=function(pkey, key, code, syn, isFun,comments){
                var fun=function(){
                    if(ns.$transTaskListCached[pkey+":"+key]===code)
                        return;
                    // replace or add code
                    ns.addCodeToEditor("Instance", key, code, isFun,comments);
                    ns.$transTaskListCached[pkey+":"+key]=code;
                };

                if(syn){
                    fun();
                }else
                    ns.$transTaskList.push(fun);
            };
            designer.focusEditor=function(pkey, key){
                ns.showPage('code');
                ns._enable();
                ns.tryToLocale([pkey,key]);
            };
            designer.searchInEditor=function(code){
                ns.showPage('code');
                ns._enable();
                var cursor = ns.codeeditor.searchCode(code);
            };
            designer.refreshFromCode=function(nomessage){
                var obj=ns._getEval(ns._ovalue = ns.codeeditor.getUIValue());
                if(obj.ok){
                    if(CONF.getClientMode() != 'project'||true){
                        ns.$transTaskListCached["Static:viewSize"]=this.refreshViewSize(obj.ok,false);
                    }

                    ns.$transTaskListCached["Instance:iniComponents"]=this.refreshView(obj.ok,false,RAD.ClassTool.getClassName(ns._ovalue) );

                    if(!nomessage)
                        ood.message(ood.getRes('RAD.designer.refreshOK'));
                }
            };
            designer.toCodeView=function(){
                ns.buttonview.fireItemClickEvent('code');
            };
            designer.saveDesign=function(){
                ns.fireEvent('onCommandSave', [ns]);
            };
            ns.paneDesign.append(designer);
        },
        iniComponents:function(){
            // [[Code created by EUSUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0))};

            append(
                (new ood.UI.Pane)
                    .setHost(host,"paneMain")
                    .setDock("fill")
            );

            host.paneMain.append(
                (new ood.UI.Pane)
                    .setHost(host,"paneCode")
                    .setVisibility('hidden')
                    .setDock("fill")
                    .setDockIgnore(true)
                    .setLeft(-1000)
            );
            host.paneMain.append(
                (new ood.UI.Pane)
                    .setVisibility('hidden')
                    .setHost(host,"paneDesign")
                    .setDock("fill")
            );

            host.paneCode.append((new ood.UI.Layout)
                .setHost(host,"layoutFill")

                .setItems([
                    {"id":"after", "pos":"after", "locked":false, "size":150, "min":50, "max":200, "cmd":true, "folded":false, "hidden":false}, {"id":"main", "min":10}
                ])
                .setType("horizontal")
            );

            host.layoutFill.append((new ood.UI.TreeBar)
                    .setHost(host,"treebarClass")
                    .setInitFold(false)
                    .setSelMode("none")
                    .setAnimCollapse(false)
                    .onItemSelected("_treebarclass_onitemselected")
                , 'after');

            host.paneCode.append((new ood.UI.ToolBar)
                .setHost(host,"toolbar4")
                .onClick("_toolbar_onclick")
            );

            host.layoutFill.append((new RAD.CodeEditor)
                    .setHost(host,"codeeditor")
                    .setDock("fill")
                    .onValueChanged("_codeeditor_onChange")
                    .onRendered("_codeeditor_onrender")
                    .onSaveCommand("_codeeditor_onsave")
                    .onGetHelpInfo("_codeeditor_ongett")
                    .onCodeModeSet("_codeeditor_oncodemodeset")
                ,'main');

            return children;
            // ]]Code created by EUSUI RAD Studio
        },
        setDftPage:function(key){
            var ns=this;
            ns.$dftpage=key;
        },
        showPage:function(key){
            var ns=this;
            if(ns._once)return;
            ns.buttonview.setUIValue(key,true);
        },
        _codeeditor_ongett:function(profile,key){
            ood.asyRun(function(){
                ood.Coder.applyById("doc:code",true);
            });
            return RAD.EditorTool.getDoc(key);
        },
        _codeeditor_oncodemodeset:function(profile, mode){
            if(mode){
                this.toolbar4.updateItem('rendermode',{
                    caption :"&nbsp;"+mode.name,
                    mime: mode.mime,
                    mode: mode.mode,
                    tips : 'Code was rendered as '+ "["+mode.name+"]"
                });
            }
        },
        _beforeValueUpdated:function(profile, ov, nv){
            var ns=this;
            if(ov === nv)return;
            ns._once=true;
            if(nv=='code'){
                var code;
                if(ns._designer.isDirty()){
                    // refresh code from designer
                    code=ns._designer.resetCodeFromDesigner();
                    // clear desinger's dirtymark
                    ns._designer.clearDirty();
                }
                // clear history
                //ns.codeeditor.clearHistory();
                if(code){
                    ns._uicode=code.substr(1,code.length-2);
                }

                ns.paneDesign.setDisplay('none').setZIndex(1);
                ns.paneCode.setDockIgnore(false).setVisibility('visible').setZIndex(100).reLayout();

                //show structure imme
                ns._rebuildNameSpace(null,false);
            }else if(nv=='design'){
                //1. must valid
                var result=ns._getEval(), className;
                if(!result.ok){
                    ood.message(ood.getRes('RAD.JSEditor.codeerr'));
                    ns._beforeValueUpdated(null,null,'code');
                    ns.codeeditor.focusLine(result.line-1);
                    return false;
                }
                //2. It's a Class, and from ood.com
                if(!(className = RAD.ClassTool.getClassName(ns.codeeditor.getUIValue()||""))){
                    ood.message(ood.getRes('RAD.classtool.noClass'));
                    return false;
                }

                var needRef=false;
                if(CONF.getClientMode() != 'project'||true){
                    var needRefSize=false;
                }
                var f=ood.get(result.ok,['Instance','iniComponents']);
                if(!f){
                    if(ns._uicode){
                        needRef=true;
                        ns._uicode=null;
                    }
                }else{
                    var code=f._____string || (f+"");
                    code=code.slice(code.indexOf('{')+1, code.lastIndexOf('}'));
                    if(code!=ns._uicode){
                        var pos=ns.codeeditor.getLine("Instance","iniComponents"),
                            line=pos?(pos.line):0,
                            pretag=ood.str.repeat("\n",line);
                        var result2 = RAD.CodeEditor.evalInSandbox(pretag+"(function(){"+code+"}());", false, "com:JSEditor:"+ns.$xid +":1",null,true);
                        if(!ood.isSet(result2.ok)){
                            ood.alert(ood.getRes('RAD.designer.comCodeErr') +"<br/><br/>" + result2.ko);
                            ns.buttonview.setUIValue('code');

                            ns.codeeditor.focusLine(result2.line-1);
                            return false;
                        }
                        // reset _uicode
                        ns._uicode=code;
                        needRef=true;
                    }
                }
                if(CONF.getClientMode() != 'project'||true){
                    if(!ns._uiviewsize)
                        needRefSize=true;
                    else{
                        var w=parseInt(ood.get(result.ok,['Static','viewSize','width']),10),
                            h=parseInt(ood.get(result.ok,['Static','viewSize','height']),10);
                        if(!w||!h){
                            needRefSize=true;
                        }else{
                            if(w!=ns._uiviewsize.w || h!=ns._uiviewsize.h){
                                // reset _uiviewsize
                                ns._uiviewsize={w:w,h:h};
                                needRefSize=true;
                            }
                        }
                    }
                }

                ns.paneCode
                    .setDockIgnore(true)
                    .setLeft(-10000)
                    .setVisibility('hidden')
                    .setZIndex(1);
                // must be here, for avoid the case: display:none will affect the inner controls renderring
                ns.paneDesign
                    .setDisplay('')
                    .setVisibility('visible')
                    .setZIndex(100)
                    .reLayout(true);

                // for com/canvas event changed
                if(!ns._designer.tempSelected||!ns._designer.tempSelected.length)
                    needRef=true;

                if(CONF.getClientMode() != 'project'||true){
                    if(needRefSize)
                        ns.$transTaskListCached["Static:viewSize"]=ns._designer.refreshViewSize(result.ok,false);
                }else{
                    ns._designer.refreshViewSize(null,false);
                }

                if(needRef)
                    ns.$transTaskListCached["Instance:iniComponents"]=ns._designer.refreshView(result.ok,null,className);

                ns._designer.reLayout(true);

                // clear history
                // ns.codeeditor.clearHistory();
            }

            ns._once=false;
        },
        _disableUI:function(){
            var ns=this,
                id=ns._uiresetId||(ns._uiresetId=ns.KEY+":"+ns.$xid+":progress");
            ood.resetRun(id, function(){
                if(!ns.__UIdisabled){
                    if(!ns.toolbar4)return;
                    ns.codeeditor.setReadonly(true);

                    ns.toolbar4.setDisabled(true);
                    ns.treebarClass.setDisabled(true);

                    if(ns.imgProgress)ns.imgProgress.setDisplay('');

                    ns.__UIdisabled=true;
                }
            });
        },
        _enable:function(){
            var ns=this;
            ood.resetRun(ns._uiresetId);
            ns.__UIdisabled=false;

            ns.codeeditor.setReadonly(false);
            ns.toolbar4.setDisabled(false);
            ns.treebarClass.setDisabled(false);

            if(ns.imgProgress)ns.imgProgress.setDisplay('none');
        },
        checkRenderStatus:function(ns){
            if(ns._renderStatus &&  ns.$transTaskList &&  ns.$transTaskList.length){
                var fun=ns.$transTaskList.shift();
                ood.tryF(fun);
            }
        },
        _codeeditor_onrender:function(profile, finished){
            var ns=this;

            if(finished){
                // default rebuild name space time : 1 s
                var id=ns.KEY+":"+ns.$xid+":rebuildNS";
                ood.resetRun(id,function(){
                    ns._rebuildNameSpace();
                },1000);

                // if UI was disabled
                if(ns.__UIdisabled){
                    ns._enable();
                }
                // if UI will be disabled
                else if (ood.resetRun.exists(ns._uiresetId)){
                    ood.resetRun(id);
                }

                if(!ns.$initializd){
                    // start a repeat thread
                    ns.$tasksthread=ood.Thread.repeat(function(){
                        if(ns.destroyed)return false;

                        try{
                            ns.checkRenderStatus(ns);
                        }catch(e){}
                    },300);
                    ns.$tasksthread.start();

                    ns.$initializd=true;
                    ns.showPage(ns.$dftpage);
                    ns.fireEvent('afterRendered');
                }
            }else{
                ns._disableUI();
            }
            ns._renderStatus=!!finished;
        },
        _codeeditor_onChange:function(profile, flag){
            var ns=this;

            // dont consider the designer side
            ns._dirty=flag;

            ns.fireEvent('onValueChanged', [ns, ns._dirty]);
        },
        _codeeditor_onsave:function(profile){
            var ns=this;
            ns.fireEvent('onCommandSave', [ns]);
        },
        // select the second layer keys
        _treebarclass_onitemselected:function(profile, item, node){
            var ns = this,
                arr=item.id.split('.');
            ns.tryToLocale(arr);
        },
        addCodeToEditor:function(pkey, key, code, isFun, comments){
            var ns=this,
                editor=this.codeeditor;
            editor.addCodeInto(pkey, key, code, isFun, comments);
        },
        tryToLocale:function(arr){
            var ns=this,
                editor=this.codeeditor;
            editor.locateTo(arr[0],arr[1]);
        },
        _toolbar_onclick: function(profile, item, grp, e, src){
            var ns=this,
                editor=this.codeeditor,
                pos=ood.use(src).offset();
            switch(item.id){
                case 'design':
                    ns.buttonview.fireItemClickEvent('design');
                    break;
                case 'indentall':
                    editor.reindent();
                    break;
                case 'searchreplace':
                    RAD.EditorTool.showFindWnd(null,editor, pos,editor.getCM().getSelection());
                    break;
                case 'jumpto':
                    RAD.EditorTool.showJumpToWnd(null,editor, pos);
                    break;
                case 'outline':
                    ns.layoutFill.updateItem("after",{hidden:!item.value});
                    break;
                case 'rendermode':
                    editor.showModeSelDlg(item);
                    break;
            }
        },
        focusEdit:function(pkey,key){
            var ns=this,
                editor=this.codeeditor,
                info = editor.getBlockInfo(pkey, key),
                cm=editor.getCM(),
                bfrom = cm.doc.posFromIndex(info.from+1),bfrom2={},
                bto = cm.doc.posFromIndex(info.to),bto2={},
                ll=cm.doc.posFromIndex(cm.doc.getValue().length+100),
                span1,span2;

            bfrom2.ch=0;
            bfrom2.line=bfrom.line;
            bfrom2=cm.doc.indexFromPos(bfrom2);
            bfrom2-=1;
            bfrom2 = cm.doc.posFromIndex(bfrom2);

            bto2.ch=0;
            bto2.line=bto.line;

            span1 = document.createElement("span");
            span1.innerHTML="...";
            span1.className="cm-readonly";
            span2 = document.createElement("span");
            span2.innerHTML="<br/>...";
            span2.className="cm-readonly";

            cm.markText({line:0,ch:0},bfrom2,{
                replacedWith:span1,
                inclusiveLeft:true,
                inclusiveRight:true
            });
            cm.markText(bfrom2,bfrom,{
                className:"cm-readonly",
                readOnly:true,
                inclusiveLeft:true,
                inclusiveRight:true
            });
            cm.markText(bto,ll,{
                replacedWith:span2,
                inclusiveLeft:true,
                inclusiveRight:true
            });
            cm.markText(bto2,bto,{
                className:"cm-readonly",
                readOnly:true,
                inclusiveLeft:true,
                inclusiveRight:true
            });
        }
    }
});// A wrap for codemirror(http://codemirror.net/)
ood.Class("RAD.expression.JavaEditor", ["ood.UI.Widget", "ood.absValue"], {

    Instance: {
        activate: function () {
            var profile = this.get(0);
            if (profile.$cm) profile.$cm.focus();
            if (profile.$cm) profile.$cm.doc.setCursor(profile.readonly_head || 0 + 1, 0);
            return this;
        },
        getCM: function () {
            return this.get(0).$cm;
        },
        resetEditorStyle: function (theme, fs, lineWrapping, cm) {
            this.addCMTheme(theme);

            var profile = this.get(0);
            if (!cm) cm = profile.$cm;
            if (cm) {
                cm.setOption("theme", theme);
                cm.setOption("lineWrapping", !!lineWrapping);
                var n = cm.getWrapperElement();
                if (n) {
                    n.style.fontSize = fs + "px";
                }
            }
        },
        showModeSelDlg: function (mm) {
            var ns = this,
                cm = ns.getCM(),
                profile = ns.get(0),
                callback = function (mode) {
                    // force to finish render
                    if (!mode || mode.mode === "none") {
                        if (!profile.$initialized)
                            profile.$initialized = true;
                        if (profile.onRendered)
                            profile.boxing().onRendered(profile, true);
                    } else {
                        cm.setOption('mode', mode.mime || mode.mode);
                        CodeMirror.autoLoadMode(cm, mode.mode);

                        if (profile.onCodeModeSet)
                            profile.boxing().onCodeModeSet(profile, mode);
                    }
                    profile = cm = null;
                };
            ood.ModuleFactory.newCom("RAD.expression.SelRenderMode", function () {
                this.setEvents("onSel", callback);
                this.mainDlg.showModal();
                this.modeList.setValue(mm.mime + ":" + mm.mode);
            });
        },
        addCMTheme: function (theme) {
            var profile = this.get(0);
            var id = "cm-theme-" + theme;
            if (theme != "default" && !ood.CSS.get("id", id)) {
                ood.CSS.includeLink("codemirror5/theme/" + theme + ".css", false, id)
            }
        },
        clearHistory: function () {
            var obj = this.get(0).$cm;
            if (obj) obj.clearHistory();
        },
        reindent: function () {
            var cm = this.get(0).$cm,
                doc = cm.doc;
            if (doc.somethingSelected()) {
                var p1 = doc.getCursor("start"),
                    p2 = doc.getCursor("end");
                for (var i = p1.line, l = p2.line; i <= l; i++)
                    cm.indentLine(i)
            } else {
                var p1 = doc.firstLine(),
                    p2 = doc.lastLine();
                for (var i = p1, l = p2; i <= l; i++)
                    cm.indentLine(i)
            }
        },
        callEditor: function (name, args, isDoc) {
            var obj = this.get(0).$cm;
            if (isDoc) obj = obj.doc;
            return obj[name].apply(obj, args || []);
        },
        searchCode: function (code) {
            var profile = this.get(0),
                cm = profile.$cm;
            if (cm) {
                var cursor = cm.getSearchCursor(code, cm.hasFocus() ? cm.doc.getCursor() : {pos: 0, line: 0}, true);
                if (cursor.findNext()) {
                    cm.focus();
                    cm.doc.setSelection(cursor.from(), cursor.to());
                }
            }
        },
        // locate to declare key
        locateTo: function (key1, key2, toSelect) {
            var ns = this,
                profile = this.get(0),
                cm = profile.$cm,
                struct, info, codefrom, codeto;
            if (cm) {
                struct = RAD.ClassTool.getClassStruct2(cm.doc.getValue());
                if (key1) {
                    if (key2 && (key1 == "Static" || key1 == "Instance"))
                        info = ood.get(struct, ["sub", key1, "sub", key2]);
                    else
                        info = ood.get(struct, ["sub", key1]);
                }
                if (info) {
                    if (toSelect)
                        cm.doc.setSelection(cm.doc.posFromIndex(info.from), cm.doc.posFromIndex(info.to));
                    else {
                        var pos = cm.doc.posFromIndex(info.from);
                        cm.focus();
                        cm.doc.setCursor(pos);
                        cm.scrollIntoView(pos);
                    }
                    return true;
                }
            }
            return false;
        },
        focusLine: function (line) {
            var ns = this,
                profile = this.get(0),
                cm = profile.$cm,
                pos = {line: line, ch: 0};
            if (cm) {
                cm.focus();
                cm.doc.setCursor(pos);
                cm.scrollIntoView(pos);
            }
        },
        getLine: function (key1, key2, toSelect) {
            var ns = this,
                profile = this.get(0),
                cm = profile.$cm,
                struct, info, codefrom, codeto;
            if (cm) {
                struct = RAD.ClassTool.getClassStruct2(cm.doc.getValue());
                if (key1) {
                    if (key2 && (key1 == "Static" || key1 == "Instance"))
                        info = ood.get(struct, ["sub", key1, "sub", key2]);
                    else
                        info = ood.get(struct, ["sub", key1]);
                }
                if (info) {
                    return cm.doc.posFromIndex(info.from);
                }
            }
            return null;
        },
        // add code to a hash, or replace the original one
        addCodeInto: function (key1, key2, code, isFun, comments) {
            comments = comments || "";
            var ns = this,
                profile = this.get(0),
                cm = profile.$cm;
            if (cm) {
                var struct = RAD.ClassTool.getClassStructWithScope(cm.getValue()),
                    fo = ood.get(struct, ["sub", key1, "sub", key2]),
                    fo2;
                // There is a function => replace code
                if (fo/* && (fo.type=='function'||fo.type=='object')*/) {
                    cm.doc.replaceRange(code, cm.doc.posFromIndex(fo.from), cm.doc.posFromIndex(fo.to));
                    //cm.doc.setSelection(cm.doc.posFromIndex(fo.from), cm.doc.posFromIndex(fo.from+code.length));
                    //ns.reindent();
                } else {
                    if (comments) comments += "\n";

                    fo = ood.get(struct, ["sub", key1]);
                    // add first layer
                    if (!fo) {
                        fo2 = ood.get(struct, ["sub", struct.arr[struct.arr.length - 1]]);
                        if (fo2)
                            code = ",\n" + comments + key1 + ":{\n" + key2 + ":" + (isFun ? 'function()' : '') + code + "\n" + "}";
                        else {
                            code = key1 + ":{\n" + comments + key2 + ":" + (isFun ? 'function()' : '') + code + "\n" + "}\n";
                            fo2 = struct;
                            fo2.to--;
                        }
                    } else {
                        // find the last one
                        fo2 = ood.get(fo, ["sub", fo.arr[fo.arr.length - 1]]);
                        if (fo2)
                            code = ",\n" + comments + key2 + ":" + (isFun ? 'function()' : '') + code;
                        else {
                            code = comments + key2 + ":" + (isFun ? 'function()' : '') + code + "\n";
                            fo2 = fo;
                            fo2.to--;
                        }
                    }
                    var pos = cm.doc.posFromIndex(fo2.to);
                    cm.doc.replaceRange(code, pos, pos);
                    cm.doc.setSelection(pos, cm.doc.posFromIndex(fo2.to + code.length));
                    ns.reindent();
                }
                //locate in the UI
                //ns.locateTo(key1,key2);
            }
        },

        showJumpToWnd: function (ajax, src) {
            var ns = this, pos = {left: 0, top: 0}
            if (src) {
                pos = ood.use(src).offset();
            }


            ood.ComFactory.getCom("RAD.JumpTo", function () {
                this.setEvents({
                    "onOK": function (line) {
                        try {
                            ns.callEditor('focus');
                            ns.callEditor('setCursor', [line - 1, 0], true);
                        } catch (e) {
                        }
                    }
                });
                this.show(null, null, null, null, pos.left, pos.top);
            });
        },


        showFindWnd: function (ajax, src) {

            var ns = this, str = ns.getCM().getSelection(), pos = {left: 0, top: 0};
            if (src) {
                pos = ood.use(src).offset();
            }
            ood.ComFactory.getCom("RAD.FAndR", function () {
                this._editor = ns;
                this._init = str;
                this.show(null, null, null, null, pos.left, pos.top);
            });
        },

        getBlockInfo: function (key1, key2) {
            var ns = this,
                profile = this.get(0),
                cm = profile.$cm;
            return cm && ood.get(RAD.ClassTool.getClassStructWithScope(cm.getValue()), ["sub", key1, "sub", key2]);
        },
        _refreshCM: function () {
            if (this.get(0).$cm) this.get(0).$cm.refresh();
        },


        _setCtrlValue: function (value) {
            if (!ood.isSet(value)) value = '';
            return this.each(function (profile) {
                if (profile.$cm && profile.$cm.getValue() != value) {
                    profile.$cm.doc.setValue(value);
                    if (profile.$tm1) profile.$tm1.clear();
                    if (profile.$tm2) profile.$tm2.clear();
                    delete profile.$tm1;
                    delete profile.$tm2;
                    delete profile.readonly_head;
                    delete profile.readonly_tail;
                }
            });
        },


        _getCtrlValue: function () {
            var profile = this.get(0);
            if (profile.$cm)
                return profile.$cm.doc.getValue();
            else
                return profile.properties.$UIvalue;
        },
        setReadonlyLines: function (head, tail) {
            var profile = this.get(0), doc = profile.$cm.doc;
            if (profile.$tm1) profile.$tm1.clear();
            if (profile.$tm2) profile.$tm2.clear();

            if (head) {
                profile.$tm1 = doc.markText({line: 0, ch: 0}, {line: head, ch: 0}, {
                    atomic: true,
                    readOnly: true,
                    css: 'background-color:#ccc;'
                });
            }
            if (tail) {
                var last = doc.lastLine();
                profile.$tm2 = doc.markText({line: last - tail}, {line: last}, {
                    atomic: true,
                    readOnly: true,
                    css: 'background-color:#ccc;'
                });
            }
            profile.readonly_head = head;
            profile.readonly_tail = tail;
        }
    },
    Initialize: function () {
        //modify default template for shell
        var t = this.getTemplate();
        ood.merge(t.FRAME.BORDER, {
            BOX: {
                tagName: 'div'
            }
        }, 'all');
        this.setTemplate(t);

        this.__trim = function (s) {
            if (/[^\s\uFEFF\xA0]/.test(s)) {
                return ood.str.trim(s);
            } else
                return s;
        };
    },
    Static: {
        $tempsandbox: "_$temp_for_ood_sandbox",
        $tempsandbox2: "_$temp_for_ood_sandbox2",
        $temppool: "_$temp_for_ood_pool",
        Appearances: {
            BOX: {
                width: '100%',
                height: '100%',
                left: 0,
                top: 0,
                position: 'absolute',
                background: '#fff'
            }
        },
        Behaviors: {},
        DataModel: {
            left: 0,
            top: 0,
            width: 200,
            height: 200,
            position: 'absolute',
            codeType: {
                ini: 'java',
                action: function (codeType) {
                    CodeMirror.findModeByExtension(codeTypecodeType);
                }
            },
            readonly: {
                ini: false,
                action: function (value) {
                    if (this.$cm)
                        this.$cm.setOption("readOnly", !!value);
                }
            }
        },
        EventHandlers: {
            onValueChanged: function (profile, flag) {
            },
            onRendered: function (profile) {
            },
            onGetHelpInfo: function (profile, key) {
            },
            onCodeModeSet: function (profile, mode) {
            },
            onSaveCommand: function () {
            }
        },
        RenderTrigger: function () {
            var key = this.box.$temppool,
                subkey = this.$xid;

            this.box._loadEditor(this);

            this.destroyTrigger = function () {
                this.$cm.clearGutter();
                this.$cm.clearHistory();
                delete this.$cm;
                delete this.$tm1;
                delete this.$tm2;
                delete this.$editor;

                // destroy related UI
                if (this.$popList) this.$popList.destroy();
                if (this.$popHelp) this.$popHelp.destroy();
                if (this.$popCustom) this.$popCustom.destroy();

                if (window[key]) delete window[key][subkey];
            };
        },
        clearSandbox: function (name) {
            for (var i = 1, n; i < 9; i++) {
                n = name + i;
                if (n && document.getElementById(n)) {
                    document.body.removeChild(document.getElementById(n));
                    try {
                        delete frames[n]
                    } catch (e) {
                    }
                }
            }
        },
        purge: function () {
            var ns = this, z;
            if ((z = window[ns.$temppool]) && z.Instance && z.Instance._ctrlpool) {
                ood.each(z.Instance._ctrlpool, function (o, i) {
                    if (o && !o.destroyed) {
                        if (o.destroy) o.destroy();
                        if (o.boxing && o.boxing()) o.boxing().destroy();
                    }
                });
                ood.breakO(z.Instance);
            }
        },
        _alias: 1,
        evalInSandbox: function (code, funScope, name, subCacheKey, purge, beforeCode, afterCode, cleanFun) {
            if (name && document.getElementById(name)) {
                document.body.removeChild(document.getElementById(name));
                try {
                    delete frames[name]
                } catch (e) {
                }
            }
            var ns = this,
                iframe = document.createElement("iframe"), result, wnd, line, errmsg, type;

            ns.purge();

            if (name) {
                iframe.name = name;
                iframe.id = name;
            }


            iframe.src = "about:blank";
            iframe.style.display = "none";
            document.body.appendChild(iframe);
            wnd = frames[frames.length - 1];
            wnd.document.open();
            wnd.document.write('<meta http-equiv="content-type" content="text/html; charset=utf-8" />');
            wnd.document.write("<script>\n");
            if (beforeCode) wnd.document.write(beforeCode);
            wnd.document.write(""
                // stop Node.js
                + "global=process=Buffer=require=module=exports=root=null;\n"

                // copy object
                + "window.ood=parent.ood;\n"
                + "window.Class=function(){return ood.Class.apply(ood,arguments);};\n"
                + "window.CONF={mixed_prop: ood.clone(parent.CONF.mixed_prop) };\n"

                + (CONF.SandBoxExtCode || "")

                //get this scope
                + "window.__cache={};window.__getThis=function(pname,type){\n"
                + "      if(__cache[pname+':'+type])return __cache[pname+':'+type];\n"
                + "      var obj=type==1?function(){}:{};\n"
                + "      if(pname){\n"
                + "          if(ood.isArr(pname)){\n"
                + "              ood.each(pname,function(cls){\n"
                + "                  cls=ood.SC(cls);\n"
                + "                  obj=ood.merge(obj, type==1?(cls||ood.Module):(cls?(new cls):(new ood.Module)),'all',true)\n"
                + "              });\n"
                + "          }else{\n"
                + "              pname=ood.SC(pname);\n"
                + "              obj=ood.merge(obj, type==1?(pname||ood.Module):(pname?(new pname):(new ood.Module)),'all',true)\n"
                + "          }\n"
                + "      }\n"
                + "      if(window['" + ns.$temppool + "'] && window['" + ns.$temppool + "']['" + subCacheKey + "']){\n"
                + "          obj=ood.merge(obj, window['" + ns.$temppool + "']['" + subCacheKey + "'][type==1?'Static':'Instance'],'all')\n"
                + "      }\n"
                + "      return __cache[pname+':'+type]=obj;\n"
                + "  };\n"

                + "window['" + ns.$temppool + "']=parent['" + ns.$temppool + "'];\n"
                // "var b=arguments.callee;" for fix firefox 3.5 bug
                + "parent['" + ns.$tempsandbox + "']=/*@cc_on !@*/0?this:{eval:function(s){return (function(){var b=arguments.callee;return window.eval.call(window,s)})()}};\n"
                + "parent['" + ns.$tempsandbox2 + "']={getErrLine:function(s,cb){window.onerror=function(){cb.apply(null,arguments);return true;};var n=document.createElement('script');n.type='text/javascript';if(/*@cc_on !@*/0){n.text=s;}else{n.appendChild(document.createTextNode(s));};document.body.appendChild(n);window.onerror=null;}};\n"
                + "try{top=parent=null;}catch(e){}"
            );
            if (afterCode) wnd.document.write(afterCode);
            wnd.document.write("<\/script><body><span id='abc'></span></body>");
            wnd.document.close();
            var bak = ood.Dom.pack,
                bak1 = ood.absProfile.prototype.$link,
                bak11 = ood.absObj.$pickAlias,
                bak12 = ood.UIProfile.prototype.setDomId,
                bak2 = ood.require,
                bak3 = ood.$cache,
                bak4 = ood.asyRun,
                bak5 = ood.resetRun,
                bak6 = ood.exec,
                bak7 = ood.pseudocode._callFunctions;

            try {
                // avoid lib or dom affected
                ood.Dom.pack = function () {
                    var o = new ood.Dom(false), d = document.getElementById('abc');
                    o._nodes = [d];
                    return o
                };
                ood.absProfile.prototype.$link = function () {
                    return this;
                };
                // stop all default events
                ood.Class.$instanceCreated = function (instance) {
                    instance.$inDesign = 1;
                };
                ood.absObj.$pickAlias = function () {
                    return ns._alias++
                };
                ood.UIProfile.prototype.setDomId = function () {
                    return this;
                };
                ood.require = function () {
                };
                ood.$cache = {};
                ood.each(bak3, function (o, i) {
                    ood.$cache[i] = ood.isArr(o) ? [] : {};
                });
                ood.asyRun = ood.resetRun = ood.exec = ood.pseudocode._callFunctions = function () {
                };

                result = window[ns.$tempsandbox].eval(code);
                if (funScope) {
                    if (typeof(result) == 'function') result.call(funScope);
                }

                type = (result === wnd || result === wnd.content) ? 'window' :
                    result === wnd.console ? 'console' :
                        result === wnd.history ? 'history' :
                            result === wnd.screen ? 'screen' :
                                result === wnd.location ? 'location' :
                                    result === wnd.navigator ? 'navigator' :
                                        result === wnd.document ? 'document' :
                                            null;
                // to avoid : Can't execute code from a freed script
                if (ood.browser.newie || (ood.browser.ie && ood.browser.ver >= 9)) {
                    var fun = function (hash) {
                        for (var i in hash) {
                            if (ood.isFun(hash[i])) hash[i]._____string = hash[i] + "";
                            else if (ood.isHash(hash[i])) fun(hash[i]);
                            else if (ood.isArr(hash[i])) fun(hash[i]);
                        }
                    };
                    if (type === null && (ood.isHash(result) || ood.isArr(result))) fun(result);
                }
            } catch (e) {
                //firefox or opera
                if (ood.isSet(e.line || e.lineNumber)) {
                    line = e.line || e.lineNumber;
                }
                // safari chrome IE
                else {
                    var base = 0;
                    if (ood.browser.ie) {
                        window[ns.$tempsandbox2].getErrLine("var _a={;", function (a, b, c) {
                            base = c - 1;
                            return true;
                        });
                    }
                    window[ns.$tempsandbox2].getErrLine(code, function (a, b, c) {
                        line = c - base;
                        return true;
                    });
                }
                errmsg = ((e.name ? e.name + ' : ' : '') + (e.description || e.message || '') + (line ? '\n line : ' + line : ''));
                if (!ood.isSet(line) && /.*at line ([\d]+).*/.test(errmsg))
                    line = errmsg.replace(/.*at line ([\d]+).*/, '$1');
            } finally {

                if (purge) ns.purge();

                delete ood.Class.$instanceCreated;

                ood.Dom.pack = bak;
                ood.absProfile.prototype.$link = bak1;
                ood.absObj.$pickAlias = bak11;
                ood.UIProfile.prototype.setDomId = bak12;
                ood.require = bak2;
                ood.$cache = bak3;
                ood.asyRun = bak4;
                ood.resetRun = bak5;
                ood.exec = bak6;
                ood.pseudocode._callFunctions = bak7;

                if (cleanFun) cleanFun(wnd, iframe);

                wnd.CONF = wnd.Class = wnd.ood = wnd[ns.$temppool] = wnd.__getThis = wnd.__cache = null;
                if (CONF.ClearSandBoxExtCode) {
                    CONF.ClearSandBoxExtCode(wnd);
                }
                window[ns.$tempsandbox] = null;
                window[ns.$tempsandbox2] = null;

                var rsl = {
                    ok: result,
                    type: type,
                    ko: errmsg,
                    line: line
                };

                ns = bak = result = line = errmsg = type = null;
                if (!name)
                    document.body.removeChild(iframe);
                iframe = null;

                return rsl;
            }
        },
        _buildItem: function (id, type, key, o, caption, value, order, itemStyle) {
            return {
                id: id,
                caption: caption || id,
                value: value || id,
                tag: (order || (type == 'property' ? 'b' : type == 'function' ? 'c' : type == 'class' ? 'd' : type == 'event' ? 'e' : 'a')) + ":" + id.toLowerCase(),
                path: (key ? (key + ".") : "") + id,
                itemStyle: itemStyle,
                imageClass: !type ? null :
                    (type == 'property' ?
                        (ood.isSet(o) && ood.isHash(o)) ? 'ri-hashtag' :
                            (ood.isSet(o) && ood.isArr(o)) ? 'ri-list-unordered' :
                                'ri-code-line' :
                        type == 'var' ? 'ri-code-line' :
                            type == 'event' ? 'ri-play-line' :
                                type == 'function' ? 'ri-code-line' :
                                    type == 'class' ? 'ri-code-line' :
                                        "ri-equalizer-line")
            };
        },
        _intellcache: {},
        _enumKeys: function (target, key, normalObj, ownOnly) {
            // non-object or array return empty array
            if (!ood.isObj(target) || ood.isArr(target)) return [];

            // default is normal object
            normalObj = normalObj !== false;
            var ns = this,
                isoodobj = target.$ood$,
                o, isfun,
                list = [];

            for (var i in target) {
                if ('prototype' == i || 'constructor' == i)
                    continue;
                if (isoodobj) {
                    if ('upper' == i || 'After' == i || 'Before' == i || 'Instance' == i || 'Static' == i || 'Constructor' == i)
                        continue
                }
                try {
                    if (i.charAt(0) != "_" && i.charAt(0) != "$" && /^[\w_]+$/.test(i)) {
                        o = target[i];
                        if (normalObj && (o && o.$abstract)) {
                            continue;
                        }

                        isfun = typeof o == 'function' && (!(o && o.$ood$) || o.$asFunction);

                        if (ownOnly && (!target.hasOwnProperty(i) || !target.propertyIsEnumerable(i))) {
                            continue;
                        }
                        var value = i;
                        if (isfun) {
                            if (normalObj) {
                                var arr = ood.fun.args(o);
                                var isInstance = false;
                                if (ood.str.endWith(key, ".prototype")) {
                                    isInstance = true;
                                }
                                var paras = RAD.ClassTool.getArgsFromAPI(key.replace(".prototype", ""), i, isInstance);
                                if (paras) {
                                    // use doc's paramters
                                    arr = [];
                                    for (var k = 0, l = paras.length; k < l; k++) {
                                        arr[k] = paras[k] && paras[k].name;
                                    }
                                }
                                value = i + "(" + arr.join(", ") + ")";
//                                console.log(key.replace(".prototype",""), i , isInstance, arr, value);
                            } else {
                                value = i + "( )";
                            }
                        }
                        list.push(ns._buildItem(i,
                            (typeof o == 'function') ? (o && o.$ood$ && !o.$asFunction) ? 'class' : (o && o.$event$) ? "event" : 'function' : 'property',
                            key,
                            o,
                            value,
                            value
                        ));
                    }
                } catch (e) {
                    console.log(e);
                }

            }

            return list;
        },


        _getIntellisenseList: function (key, cachedata) {
            if (!key) return null;
            cachedata = cachedata !== false;

            var ns = this,
                cache = ns._intellcache,
                buildItem = ns._buildItem;

            if (cachedata && cache[key]) return cache[key];

            var list = [];
            if (key == ns.$temppool) {
                return [];
            }

            switch (key) {
                case ' variables ': {
                    list = [
                        // global
                        buildItem("ood", 0, 0, 0, 0, 0, 2, "font-weight:bold;color:#ff0000;"),
                        buildItem("ood()", 0, 0, 0, "ood()", "ood()", 2, "font-weight:bold;color:#ff0000;"),

                        buildItem("top", 0, 0, 0, 0, 0, 3, "font-weight:bold;"),
                        buildItem("parent", 0, 0, 0, 0, 0, 3, "font-weight:bold;"),
                        buildItem("window", 0, 0, 0, 0, 0, 3, "font-weight:bold;"),
                        buildItem("document", 0, 0, 0, 0, 0, 3, "font-weight:bold;"),
                        buildItem("navigator", 0, 0, 0, 0, 0, 3, "font-weight:bold;"),
                        buildItem("history", 0, 0, 0, 0, 0, 3, "font-weight:bold;"),
                        buildItem("location", 0, 0, 0, 0, 0, 3, "font-weight:bold;"),
                        buildItem("screen", 0, 0, 0, 0, 0, 3, "font-weight:bold;"),
                        buildItem("Math", 0, 0, 0, 0, 0, 3, "font-weight:bold;"),
                        buildItem("Number", 0, 0, 0, 0, 0, 3, "font-weight:bold;"),
                        buildItem("console", 0, 0, 0, 0, 0, 3, "font-weight:bold;"),
                        // js
                        buildItem("if  ", 0, 0, 0, "if...", "if(){\n\n}", 5),
                        buildItem("ifelse", 0, 0, 0, "if...else...", "if(){\n\n}else{\n\n}", 5),
                        buildItem("while", 0, 0, 0, "while...", "while(){\n\n};", 5),
                        buildItem("do  ", 0, 0, 0, "do...while", "do{\n\n}while();", 5),
                        buildItem("try  ", 0, 0, 0, "try...catch...finally", "try{\n\n}catch(e){\n\n}finally{\n\n}", 5),
                        buildItem("for  ", 0, 0, 0, "for...", "for(;;;){\n\n}", 5),
                        buildItem("forin  ", 0, 0, 0, "for...in", "for( in ){\n\n}", 5),
                        buildItem("function", 0, 0, 0, "function...", "function(){\n\n}", 5),
                        buildItem("switch", 0, 0, 0, "switch...", "switch(){\n  case : \n\n  break;\n  case : \n\n  break;\ndefault: \n\n}", 5),
                        buildItem("with", 0, 0, 0, "with...", "with(){\n\n}", 5),

                        buildItem("return", 0, 0, 0, "return", "return ", 4),
                        buildItem("break", 0, 0, 0, "break", "break;", 4),
                        buildItem("continue", 0, 0, 0, "continue", "continue;", 4),
                        buildItem("throw", 0, 0, 0, "throw", "throw ", 4),
                        buildItem("new ", 0, 0, 0, "new", "new ", 4),
                        buildItem("delete", 0, 0, 0, "delete", "delete ", 4),
                        buildItem("arguments", 0, 0, 0, "arguments", "arguments", 4),
                        buildItem("var", 0, 0, 0, "var", "var ", 4),
                        buildItem("case", 0, 0, 0, "case", "case :", 4),
                        buildItem("default", 0, 0, 0, "default", "default :", 4),

                        buildItem("typeof", 0, 0, 0, "typeof", "typeof ", 4),
                        buildItem("instanceof", 0, 0, 0, "instanceof", "instanceof ", 4),

                        buildItem("void", 0, 0, 0, "void", "void", 4),
                        buildItem("true", 0, 0, 0, "true", "true", 4),
                        buildItem("false", 0, 0, 0, "false", "false", 4),
                        buildItem("null", 0, 0, 0, "null", "null", 4),
                        buildItem("NaN", 0, 0, 0, "NaN", "NaN", 4),
                        buildItem("undefined", 0, 0, 0, "undefined", "undefined", 4),
                        buildItem("Infinity", 0, 0, 0, "Infinity", "Infinity", 4),


                        buildItem("decodeURI()", "function"),
                        buildItem("decodeURIComponent()", "function"),
                        buildItem("encodeURI()", "function"),
                        buildItem("encodeURIComponent()", "function"),
                        buildItem("escape()", "function"),
                        buildItem("eval()", "function"),
                        buildItem("isFinite()", "function"),
                        buildItem("parseFloat()", "function"),
                        buildItem("parseInt()", "function"),
                        buildItem("unescape()", "function"),
                        buildItem("Number()", "function"),
                        buildItem("String()", "function")

                    ];
                    break;
                }
                case 'new': {
                    list = [

                        buildItem("String", "class", 0, 0, 0, "String();", 1),
                        buildItem("Object", "class", 0, 0, 0, "Object();", 1),
                        buildItem("Array", "class", 0, 0, 0, "Array();", 1),
                        buildItem("RegExp", "class", 0, 0, 0, "RegExp();", 1),
                        buildItem("Boolean", "class", 0, 0, 0, "Boolean();", 1),
                        buildItem("Number", "class", 0, 0, 0, "Number();", 1),
                        buildItem("Date", "class", 0, 0, 0, "Date();", 1),

                        buildItem("ood.Dom", "class", 0, 0, 0, "ood.Dom();", 2),
                        buildItem("ood.UIProfile", "class", 0, 0, 0, "ood.UIProfile();", 2),
                        buildItem("ood.Module", "class", 0, 0, 0, "ood.Module();", 2),
                        buildItem("ood.Template", "class", 0, 0, 0, "ood.Template();", 2),
                        buildItem("ood.UI", "class", 0, 0, 0, "ood.UI();", 2),
                        buildItem("ood.DataBinder", "class", 0, 0, 0, "ood.DataBinder();", 2)
                    ];

                    break;
                }
                case 'history':
                case 'screen':
                    break;
                case 'console':
                    list = [
                        buildItem("log()", "function", key)
                    ];
                    break;


                case 'Math': {
                    list = [
                        buildItem("E", "property", key),
                        buildItem("LN2", "property", key),
                        buildItem("LN10", "property", key),
                        buildItem("LOG2E", "property", key),
                        buildItem("LOG10E", "property", key),
                        buildItem("PI", "property", key),
                        buildItem("SQRT1_2", "property", key),
                        buildItem("SQRT2", "property", key),
                        buildItem("abs(x)", "function", key),
                        buildItem("acos(x)", "function", key),
                        buildItem("asin(x)", "function", key),
                        buildItem("atan(x)", "function", key),
                        buildItem("atan2(y,x)", "function", key),
                        buildItem("ceil(x)", "function", key),
                        buildItem("cos(x)", "function", key),
                        buildItem("exp(x)", "function", key),
                        buildItem("floor(x)", "function", key),
                        buildItem("log(x)", "function", key),
                        buildItem("max(x,y,z,...,n)", "function", key),
                        buildItem("min(x,y,z,...,n)", "function", key),
                        buildItem("pow(x,y)", "function", key),
                        buildItem("random()", "function", key),
                        buildItem("round(x)", "function", key),
                        buildItem("sin(x)", "function", key),
                        buildItem("sqrt(x)", "function", key),
                        buildItem("tan(x)", "function", key)
                    ];
                    break;
                }
                case 'Number': {
                    list = [
                        buildItem("MAX_VALUE", "property", key),
                        buildItem("MIN_VALUE", "property", key),
                        buildItem("NEGATIVE_INFINITY", "property", key),
                        buildItem("POSITIVE_INFINITY", "property", key)
                    ];
                    break;
                }
                case "Array.prototype": {
                    list = [
                        buildItem("length", "property", key),
                        buildItem("concat()", "function", key),
                        buildItem("join()", "function", key),
                        buildItem("pop()", "function", key),
                        buildItem("push()", "function", key),
                        buildItem("reverse()", "function", key),
                        buildItem("shift()", "function", key),
                        buildItem("sort()", "function", key),
                        buildItem("concat()", "function", key),
                        buildItem("splice()", "function", key),
                        buildItem("toString()", "function", key),
                        buildItem("unshift()", "function", key)
                    ];
                    break;
                }
                case "Date.prototype": {
                    list = [
                        buildItem("getDate()", "function", key),
                        buildItem("getDay()", "function", key),
                        buildItem("getFullYear()", "function", key),
                        buildItem("getHours()", "function", key),
                        buildItem("getMilliseconds()", "function", key),
                        buildItem("getMinutes()", "function", key),
                        buildItem("getMonth()", "function", key),
                        buildItem("getTime()", "function", key),
                        buildItem("getSeconds()", "function", key),
                        buildItem("getTimezoneOffset()", "function", key),
                        buildItem("getUTCDate()", "function", key),
                        buildItem("getUTCDay()", "function", key),
                        buildItem("getUTCFullYear()", "function", key),
                        buildItem("getUTCHours()", "function", key),
                        buildItem("getUTCMilliseconds()", "function", key),
                        buildItem("getUTCMinutes()", "function", key),
                        buildItem("getUTCMonth()", "function", key),
                        buildItem("getUTCSeconds()", "function", key),
                        buildItem("getYear()", "function", key),
                        buildItem("parse()", "function", key),
                        buildItem("setDate()", "function", key),
                        buildItem("setFullYear()", "function", key),
                        buildItem("setHours()", "function", key),
                        buildItem("setMilliseconds()", "function", key),
                        buildItem("setMinutes()", "function", key),
                        buildItem("setMonth()", "function", key),
                        buildItem("setSeconds()", "function", key),
                        buildItem("setTime()", "function", key),
                        buildItem("setUTCDate()", "function", key),
                        buildItem("setUTCFullYear()", "function", key),
                        buildItem("setUTCHours()", "function", key),
                        buildItem("setUTCMilliseconds()", "function", key),
                        buildItem("setUTCMinutes()", "function", key),
                        buildItem("setUTCSeconds()", "function", key),
                        buildItem("setUTCMonth()", "function", key),
                        buildItem("setYear()", "function", key),
                        buildItem("toDateString()", "function", key),
                        buildItem("toGMTString()", "function", key),
                        buildItem("toLocaleDateString()", "function", key),
                        buildItem("toLocaleTimeString()", "function", key),
                        buildItem("toLocaleString()", "function", key),
                        buildItem("toString()", "function", key),
                        buildItem("toUTCString()", "function", key),
                        buildItem("toTimeString()", "function", key),
                        buildItem("UTC()", "function", key)
                    ];
                    break;
                }

                case "String.prototype": {
                    list = [
                        buildItem("length", "property", key),
                        buildItem("charAt()", "function", key),
                        buildItem("charCodeAt()", "function", key),
                        buildItem("concat()", "function", key),
                        buildItem("fromCharCode()", "function", key),
                        buildItem("indexOf()", "function", key),
                        buildItem("lastIndexOf()", "function", key),
                        buildItem("match()", "function", key),
                        buildItem("replace()", "function", key),
                        buildItem("search()", "function", key),
                        buildItem("slice()", "function", key),
                        buildItem("split()", "function", key),
                        buildItem("substr()", "function", key),
                        buildItem("substring()", "function", key),
                        buildItem("toLowerCase()", "function", key),
                        buildItem("toUpperCase()", "function", key)
                    ];
                    break;
                }
                case "Object.prototype": {
                    list = [
                        buildItem("toString()", "function", key, 0, 0, 0, 'z'),
                        buildItem("toLocaleString()", "function", key, 0, 0, 0, 'z'),
                        buildItem("hasOwnProperty(key)", "function", key, 0, 0, 0, 'z'),
                        buildItem("propertyIsEnumerable(key)", "function", key, 0, 0, 0, 'z'),
                        buildItem("isPrototypeOf(obj)", "function", key, 0, 0, 0, 'z')
                    ];
                    break;
                }
                default: {
                    if (/\.prototype$/.test(key)) {
                        // [[[[[ bak
                        var bak = ood.Dom.pack,
                            bak1 = ood.absProfile.prototype.$link,
                            bak11 = ood.absObj.$pickAlias;

                        ood.Dom.pack = function () {
                            var o = new ood.Dom(false), d = document.getElementById('abc');
                            o._nodes = [d];
                            return o
                        };
                        ood.absProfile.prototype.$link = function () {
                            return this;
                        };
                        ood.absObj.$pickAlias = function () {
                            return ns._alias++
                        };
                        // ]]]]]
                        try {
                            var target = eval("new " + key.replace(/\.prototype$/, ''));
                            list = ns._enumKeys(target, key);
                        } catch (e) {
                        } finally {
                            //[[[[[ restore
                            ood.Dom.pack = bak;
                            ood.absProfile.prototype.$link = bak1;
                            ood.absObj.$pickAlias = bak11;
                            //]]]]]
                        }
                    }

                    if (!list.length) {
                        var target = ood.get(window, key.split("."));
                        list = ns._enumKeys(target, key);
                        cachedata = false;
                    }
                }
            }

            if (cachedata)
                cache[key] = list;

            return list;
        },


        _getFromFunctionExp: function (code) {
            var type;
            if (/toString\([^)]*\)$/.test(code))
                type = 'String.prototype';
            // functions patterns
            else if (/^\s*\(?\s*new\s+([\wood.]+)\s*\(?\s*[^)]*\)?\s*\)?(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/.test(code)) {
                code = code.replace(/^\s*\(?\s*new\s+([\wood.]+)\s*\(?\s*[^)]*\)?\s*\)?(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/, "$1");
                type = code + '.prototype';
            }
            else if (/.*\.reBoxing\(([^)]*)\)(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/.test(code)) {
                code = code.replace(/.*\.reBoxing\(([^)]*)\)(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/, "$1");
                if (code)
                    type = code.replace(/[\'\"]/g, "") + '.prototype';
                else
                    type = 'ood.Dom.prototype';
            }
            else if (code.indexOf("ood.alert(") == 0 || code.indexOf("ood.prompt(") == 0 || code.indexOf("ood.pop(") == 0 || code.indexOf("ood.confirm(") == 0)
                type = 'ood.UI.Dialog.prototype';
            else if (code.indexOf("ood(") == 0 || code.indexOf("ood.use(") == 0)
                type = 'ood.Dom.prototype';
            else if (code.indexOf("ood.Thread(") == 0 || code.indexOf("ood.Ajax(") == 0
                || code.indexOf("ood.SAjax(") == 0 || code.indexOf("ood.IAjax(") == 0
                || code.indexOf("ood.JSONP(") == 0 || code.indexOf("ood.XDMI(") == 0)
                type = 'ood.Thread.prototype';
            else if (/.*\.(getRoot|getSubNode|getSubNodes)\s*\(\s*[^\)]*\)\s*$/.test(code))
                type = 'ood.Dom.prototype';
            else if (/.*\.getElementById\s*\(\s*[^\)]*\)\s*$/.test(code))
                type = 'Element.prototype';
            return type;
        },
        _getFromObject: function (target) {
            if (!ood.isSet(target))
                return null;
            else if (target === ood.str)
                return "ood.str";
            else if (target === ood.arr)
                return "ood.arr";
            else if (target === ood)
                return "ood";
            else if (target.$ood$) {
                if (typeof target == 'function')
                    return target.KEY;
                else
                    return target.KEY + ".prototype";
            } else if (ood.isArr(target))
                return "Array.prototype";
            else if (ood.isDate(target))
                return "Date.prototype";
            else if (ood.isReg(target))
                return "RegExp.prototype";
            else if (ood.isNumb(target))
                return "Number.prototype";
            else if (ood.isStr(target))
                return "String.prototype";
            else if (ood.isBool(target))
                return "Boolean.prototype";
            else if (ood.isFun(target))
                return "Function.prototype";
            else if (ood.isObj(target)) {
                return "Object.prototype";
            }
            // dont use ood.isHash here
        },
        _findVars: function (profile, tonode, braceId) {
            var ns = this,
                cm = profile.$editor,
                arr = [];
            if (cm && tonode) {
                var doc = cm.win.document,
                    isBr = function (elem) {
                        return elem.tagName == "BR" || elem.tagName == "br"
                    },
                    isB = function (elem) {
                        return elem.tagName == "B" || elem.tagName == "b"
                    },
                    elem = doc.body.firstChild,
                    scope = "",
                    cls, txt, temp = [], cursor;

                cursor = arr;

                cursor.push(["this", ""]);

                while ((elem = elem.nextSibling) && elem != tonode) {
                    if (isB(elem) && elem._uid && elem.id.charAt(0) == 'b') {
                        // if sibling {, jump to it's }
                        if (!braceId || braceId.indexOf(elem.id) !== 0) {
                            elem = doc.getElementById('e' + elem.id.slice(1));
                        } else {
                            scope = elem._uid;
                            // reset scope
                            ood.arr.each(temp, function (o) {
                                o[1] = scope;
                            });
                            arr = arr.concat(temp);
                        }
                        temp = [];
                        cursor = arr;
                    }

                    cls = ns.__trim(elem.className);
                    txt = ns.__trim(elem.currentText);

                    if (cls == 'js-keyword' && txt == "function") {

                        // find "function abc(){}"
                        while ((elem = elem.nextSibling) && elem != tonode && (isBr(elem) || ns.__trim(elem.className) == "whitespace" || ns.__trim(elem.className) == "js-comment")) ;
                        cls = ns.__trim(elem.className);
                        txt = ns.__trim(elem.currentText);
                        if (cls == 'js-variabledef') {
                            cursor.push([txt, scope]);
                        }

                        // temp find
                        cursor = temp;
                        cursor.push(["this", scope]);
                    }

                    if (cls == 'js-variabledef')
                        cursor.push([txt, scope]);
                }
            }
            return arr;
        },

        _$key: function (key) {
            ns = this;
            list = [
                ns._buildItem("$currPerson", 0, 0, 0, "$currPerson", "$currPerson", 5),
                ns._buildItem("$currPerson.name", 0, 0, 0, "name", "name", 5)
            ];
            if (key == '$') {
                ood.Ajax("/admin/el/searchKey", function (txt) {
                    var obj = txt;
                    if (!obj || obj.error) {
                        ood.message("No module in this project!");
                    } else {
                        ood.arr.each(obj.data, function (o) {
                            var item = ns._buildItem(o.id, 0, 0, 0, o.desc, o.expression, 5);
                            list.push(item);
                        });
                    }
                }, null, null, {method: 'post', asy: false}).start();
            }
            if (ood.str.startWith(key, '$') && ood.str.endWith(key, ".")) {
                ood.Ajax("/admin/el/searchMethod", {

                    key: key
                }, function (txt) {
                    var obj = txt;
                    if (!obj || obj.error) {
                        ood.message("No module in this project!");
                    } else {
                        ood.arr.each(obj.data, function (o) {
                            var item = ns._buildItem(o.id, 0, 0, 0, o.desc, o.lastStr, 5);
                            list.push(item);
                        });
                    }
                }, null, null, {method: 'post', asy: false}).start();

            }
            return list;
        },


        _reSetStyle: function () {
            var ns = this;
            ood.ModuleFactory.newModule('RAD.EditorTheme', function () {
                this.show();
                this.initData();
                this.setEvents("onOK", function (theme, fs, wrap) {
                    var obj = CONF.getStatus();
                    obj.editorTheme = theme;
                    obj.editorFontSize = fs;
                    obj.lineWrapping = wrap;
                    CONF.saveStatus(obj);
                    ns.resetEditorStyle(theme, fs, wrap);
                });
            });
        },

        _getIntellisense: function (profile, key, index, nolist) {
            var ns = this,
                _this = RAD.ClassTool._this;


            // get type

            if (ood.str.startWith(key, '$')) {
                type = "$";
            } else {
                if (key.indexOf('new ') == 0) {
                    type = 'new';
                } else if (key.charAt(key.length - 1) == '.') {
                    type = "properties";
                    key = key.slice(0, -1);
                } else {
                    if (key.indexOf('.') != -1) {
                        type = "properties";
                        key = key.slice(0, key.lastIndexOf('.'));
                    } else {
                        // return avialable var
                        type = "var";
                    }
                }
                if (type == "properties") {
                    if (key.indexOf('(') != -1) {
                        type = "function";
                    }
                }
            }


            var target, code,
                list = [],
                // object type string
                otype,
                // object code string
                ocode,
                // extra array
                oextra = [];
            switch (type) {
                case 'new':
                    otype = type;
                    break;
                case '$':
                    list = this._$key(key);
                    break;
                case "function":
                    type = ns._getFromFunctionExp(key);
                    if (type) {
                        otype = type;
                        break;
                    }
                case "properties":
                    if (key == "arguments" || key == "arguments.callee") {
                        otype = key;
                        break;
                    } else {
                        // try exec all code dir
                        var arrcode = [],
                            vars = [],
                            code = profile.$cm.getValue(),
                            allcode = RAD.ClassTool.getContextAssignments(code, index),
                            struct = RAD.ClassTool.getClassStructWithScope(code, index, ns.$temppool, profile.$xid);

                        arrcode.push("(function(){try{\n");
                        arrcode.push("var " + _this + "=window;\n");
                        vars.push(_this);
                        var added1 = false, added2 = false,
                            len = allcode.vars.length;
                        for (var i = 0; i < len; i++) {
                            arrcode.push("var " + allcode.vars[i] + "=undefined;\n");
                            vars.push(allcode.vars[i]);
                        }
                        // run once at least
                        for (var i = -1; i < len; i++) {
                            // no assignment, or assignment is in special scope
                            if (allcode.scopeS == -1 || i >= allcode.scopeS) {
                                // add only once
                                if (!added1) {
                                    added1 = true;
                                    var o;
                                    // get scope info
                                    if (allcode.secondKey && allcode.secondType == "function") {
                                        o = ood.get(struct, ['sub', allcode.firstKey, 'sub', allcode.secondKey]);
                                    } else if (allcode.firstKey && allcode.firstType == "function") {
                                        o = ood.get(struct, ['sub', allcode.firstKey]);
                                    }
                                    if (o) {
                                        // add scope code
                                        arrcode.push("try{" + _this + "=" + o._this + "}catch(e){};\n");
                                        // add args code
                                        ood.arr.each(o.argsv, function (arg, i) {
                                            // no matching argument
                                            if (!o.args || !o.args[i]) return false;

                                            // use dynamic code first
                                            if (arg.code) {
                                                arrcode.push("try{" + o.args[i] + "=" + arg.code + "}catch(e){};\n");
                                                vars.push(o.args[i]);
                                            } else {
                                                if (/\.prototype$/.test(arg.type)) {
                                                    arrcode.push("try{" + o.args[i] + "=" + arg.type.replace(/(.+)(\.prototype)$/, "new $1();") + "}catch(e){};\n");
                                                    vars.push(o.args[i]);
                                                } else {
                                                    arrcode.push("try{" + o.args[i] + "=" + arg.type + "}catch(e){};\n");
                                                    vars.push(o.args[i]);
                                                }
                                            }
                                        });
                                    }
                                }
                            }
                            // out of special scope
                            if (allcode.scopeS != -1 && i >= allcode.scopeE) {
                                if (!added2) {
                                    added2 = true;
                                    arrcode.push("try{" + _this + "=window;}catch(e){};\n");
                                }
                            }
                            // ignore when i is -1
                            if (i >= 0) {
                                arrcode.push("try{" + allcode.vars[i] + "=" + allcode.code[i] + ";}catch(e){};\n");
                                vars.push(allcode.vars[i]);
                            }
                        }
                        if (allcode.scopeS != -1 && allcode.outscope) {
                            if (!added2) {
                                arrcode.push("try{" + _this + "={};}catch(e){};\n");
                            }
                        }

                        arrcode.push("return (" + key + ");\n}catch(e){}finally{\n");
                        ood.arr.removeValue(vars, key);
                        arrcode.push(vars.join("=") + "=null;\n");
                        arrcode.push("}\n}).call({});\n");
                        ocode = arrcode.join('').replace(/\bthis\b/g, _this);
//console.log(ocode);
                    }
                    break;
                case "var":
                    otype = " variables ";

                    // caching according to line
                    /*
                    var hash,cache=ns.__varscache||(ns.__varscache={});
                    if(cache[index]){
                        hash=cache[index];
                    }else{
                        cache=ns.__varscache={};
                        cache[index]=hash=RAD.ClassTool.getContextVars(profile.$cm.getValue(),index);
                    }
                   */
                    var hash = RAD.ClassTool.getContextVars_fast(profile.$cm, index);

                    if (hash["this"]) {
                        oextra.push(ns._buildItem("this", 0, 0, 0, 0, 0, 1, "color:#ff0000;"));
                        delete hash["this"];
                    }
                    if (hash["arguments"]) {
                        oextra.push(ns._buildItem("arguments", 0, 0, 0, 0, 0, 1, "color:#ff0000;"));
                        delete hash["arguments"];
                    }

                    ood.each(hash, function (o, i) {
                        oextra.push(ns._buildItem(i, "var", 0, 0, 0, 0, 1, "color:#666;"));
                    });
                    break;
            }
            // from extra array
            if (oextra && oextra.length) {
                if (!nolist)
                    Array.prototype.push.apply(list, oextra);
            }
            // then "from code"
            if (ocode) {
                result = ns.evalInSandbox(ocode, false, null, profile.$xid);
                if (ood.isSet(result.ok)) {
                    // if result.type exists, igonre result.ok
                    if (result.type)
                        otype = result.type;
                    else {
                        otype = ns._getFromObject(result.ok);
                        if (!nolist)
                            Array.prototype.push.apply(list, ns._enumKeys(result.ok, otype, true, true));
                    }
                }
            }
            // the last one is "from type"
            if (otype) {
                if (!nolist)
                    Array.prototype.push.apply(list, ns._getIntellisenseList(otype));
            }

            if (list.length) {
                list = ood.arr.removeDuplicate(list, 'id');

                ood.arr.stableSort(list, function (x, y) {
                    return x.tag > y.tag ? 1 : x.tag == y.tag ? 0 : -1;
                });
            }

            return [otype, list, key];
        },
        _loadEditor: function (profile) {
            var ns = this,
                _this = RAD.ClassTool._this;

            // is suggestion window showed
            var $suggestionShowed = false,
                $suggestionBaseScope = null,
                $suggestionBaseScopeShadow = null,
                showSuggetionID = "CodeEditor.showSuggetion.resetRun",
                adjustSuggetionID = "CodeEditor.adjustSuggetion.resetRun",
                $currentText = "",
                $willshowDotHint = false,
                // suggestion window for
                $activeWord;

            // get short Suggestion code
            var getShortContentCode = function (index) {
                var reg = /\s+/g,
                    arr = [],
                    extxt = "",
                    cm = profile.$cm,
                    pos = cm.doc.posFromIndex(index),
                    line = pos.line,
                    elem = cm.getTokenAt(pos),
                    prev = function (elem) {
                        if (elem.start === 0) {
                            pos.line--;
                            if (pos.line === 0) {
                                return null;
                            }
                            var line = cm.doc.getLine(pos.line);
                            if (line) {
                                pos.ch = line.length;
                            } else {
                                return null;
                            }
                        } else {
                            pos.ch = elem.start;
                        }
                        return cm.getTokenAt(pos);
                    };

                // for dblclick case, find key text
                if (!(elem.type === null && elem.string == ".")) {
                    extxt = ns.__trim(elem.string);
                    elem = prev(elem);
                }
                // for dot case
                if (elem && (elem.type === null && elem.string == ".")) {
                    do {
                        if (elem.type === null && elem.string == ".") {
                            // ignore space and comments
                            while (elem = prev(elem)) {
                                if (!(!elem || elem.type == "comment" || elem.type == "tab" || (elem.type === null && /^\s+$/.test(elem.string)))) {
                                    break;
                                }
                            }
                            if (elem) {
                                // for (xxx)
                                var con1 = "";
                                if (elem.type === null && elem.string === ")") {
                                    var deep1 = 0;
                                    do {
                                        if (elem.type === null && elem.string === ")")
                                            deep1++;
                                        if (elem.type === null && elem.string === "(")
                                            deep1--;
                                        if (elem.string)
                                            con1 = elem.string + con1;
                                    } while ((elem = prev(elem)) && deep1 !== 0)
                                }
                                if (elem) {
                                    if (elem.type == "property" || elem.type == 'variable' || elem.type == 'variable-2'
                                        || elem.type == 'oodglobal'
                                        || (elem.type == "keyword" && elem.string == "this")) {
                                        arr.push(elem.string.replace(reg, '') + con1);
                                    } else if (con1) {
                                        arr.push(con1);
                                    } else {
                                        break;
                                    }

                                }
                            }
                        } else {
                            break;
                        }
                    } while (elem = prev(elem))
                }
                // for space case
                else if (elem && (elem.type == null && elem.string === " ")) {
                    // ignore space and comments
                    while (elem = prev(elem)) {
                        if (!(!elem || elem.type == "comment" || (elem.type == null && elem.string === " "))) {
                            break;
                        }
                    }
                    if (elem.type == "keyword" && elem.string == "new") {
                        extxt = "new " + extxt;
                    }
                }

                return (arr.length ? (arr.reverse().join('.') + '.') : "") + extxt;
            };

            var iniComponents = function () {
                // [[Code created by ESDUI RAD Studio
                var host = this, children = [], append = function (child) {
                    children.push(child.get(0))
                };

                append(
                    (new ood.UI.Pane)
                        .setHost(host, "$popList")
                        .setLeft(10)
                        .setTop(10)
                        .setWidth(300)
                        .setHeight(180)
                );

                host.$popList.append(
                    (new ood.UI.List)
                        .setHost(host, "$lstsug")
                        .setTheme("codemirror")
                        .setDirtyMark(false)
                        .setTop(18)
                        .setWidth(300)
                        .setHeight(162)
                        .setItemRow(true)
                        .setDisableHoverEffect(true)
                );

                host.$popList.append(
                    (new ood.UI.Block)
                        .setHost(host, "block1")
                        .setLeft(0)
                        .setTop(0)
                        .setWidth(300)
                        .setHeight(24)
                        .setBorderType("flat")
                );

                host.block1.append(
                    (new ood.UI.Label)
                        .setHost(host, "$objType")
                        .setLeft(6)
                        .setTop(2)
                        .setWidth(252)
                        .setCaption("")
                        .setHAlign("left")
                        .setCustomStyle({KEY: 'font-weight:bold;'})
                );

                append(
                    (new ood.UI.Block)
                        .setHost(host, "$popHelp")
                        .setLeft(410)
                        .setTop(10)
                        .setWidth(300)
                        .setHeight(180)
                        .setBorderType("flat")
                        .setOverflow('hidden')
                        .setBackground("#FFF8DC")
                );

                host.$popHelp.append(
                    (new ood.UI.Div)
                        .setHost(host, "$divhelp")
                        .setTheme("codemirror")
                        .setLeft(-1)
                        .setTop(19)
                        .setWidth(300)
                        .setHeight(160)
                        .setCustomStyle({"KEY": "overflow:auto; padding:4px;"})
                );

                host.$popHelp.append(
                    (new ood.UI.Block)
                        .setHost(host, "block3")
                        .setLeft(-1)
                        .setTop(-1)
                        .setWidth(300)
                        .setHeight(20)
                        .setBorderType("flat")
                );

                host.block3.append(
                    (new ood.UI.Link)
                        .setHost(host, "$linkAPI")
                        .setLeft('auto')
                        .setRight(2)
                        .setTop(1)
                        .setCaption("$RAD.JSEditor.clickapi")
                );

                host.block3.append(
                    (new ood.UI.Label)
                        .setHost(host, "$lblTips")
                        .setLeft(6)
                        .setTop(2)
                        .setWidth(133)
                        .setCaption("")
                        .setHAlign("left")
                );

                return children;

                // ]]Code created by ESDUI RAD Studio
            };

            var handle = {
                moveFocus: function (step) {
                    var list = profile.$lstsug,
                        items = list.get(0).properties.items,
                        length = items.length,
                        value = list.getUIValue(),
                        index = ood.arr.subIndexOf(items, 'id', value);
                    if (step === true) {
                        index = 0;
                    } else if (step === false) {
                        index = length - 1;
                    } else {
                        index += step;
                        if (index < 0) index = 0;
                        if (index > length - 1) index = length - 1;
                    }
                    if (items[index])
                        list.setUIValue(items[index].id, true);
                },
                close: function () {
                    hideSuggestion();
                },
                pick: function () {
                    var list = profile.$lstsug,
                        items = list.get(0).properties.items,
                        length = items.length,
                        value = list.getUIValue(),
                        index = ood.arr.subIndexOf(items, 'id', value);

                    if (items[index])
                        applySuggestion(items[index].value || items[index].caption);
                    hideSuggestion();
                }
            };
            var keyMap = {
                Up: function () {
                    handle.moveFocus(-1);
                },
                Down: function () {
                    handle.moveFocus(1);
                },
                PageUp: function () {
                    handle.moveFocus(-8, true);
                },
                PageDown: function () {
                    handle.moveFocus(8, true);
                },
                Home: function () {
                    handle.moveFocus(true);
                },
                End: function () {
                    handle.moveFocus(false);
                },
                Enter: function () {
                    handle.pick();
                },
                Tab: function () {
                    handle.pick();
                },
                Esc: function () {
                    handle.close();
                }
            };
            // show suggestion
            var showSuggestion = function (key, index, fromDot, dftTxt) {
                // get intellisense

                var rtn = profile.box._getIntellisense(profile, key, index),
                    keyword = rtn[0], ns = this,
                    items = rtn[1];
                dftTxt = dftTxt || key || "";

                if (!keyword && !(items && items.length)) {
                    hideSuggestion();
                    return;
                }


                if (!fromDot) {
                    var found = false, str = dftTxt.toLowerCase();
                    ood.arr.each(items, function (item) {
                        if (ood.str.startWith(item.id.toLowerCase(), str)) {
                            found = true;
                            return false;
                        }
                    });
                    if (!found) {
                        return;
                    }
                }
                var coordinates = cm.cursorCoords(true, "page"),
                    left = coordinates.left,
                    top = coordinates.top;

                if (!profile.$popList) {
                    iniComponents.call(profile);
                    ood('body').append(profile.$popList.setDisplay('none'));
                    ood('body').append(profile.$popHelp.setDisplay('none'));

                    profile.$divhelp.getRoot().setSelectable(true);

                    profile.$linkAPI.onClick(function (p) {
                        CONF.openAPI(p.properties.tag);
                    });
                    var out = true,
                        tryToClose = function () {
                            ood.resetRun("codemirror:aaa", function () {
                                if (out && profile.$popCustom) {
                                    profile.$popCustom.setDisplay('none');
                                }
                            });
                        };

                    profile.$lstsug.afterUIValueSet(function (profile, ov, v) {
                        showTips2(profile.getItemByItemId(v));
                    })
                        .onClick(function (profile, item) {
                            applySuggestion(item.value || item.caption);
                            hideSuggestion();
                        });
                }

                if ((items && items.length) || fromDot) {
                    $suggestionShowed = fromDot ? 1 : true;
                    if (items && items.length) {
                        profile.$lstsug.setItems(items);
                    }
                    var fun = function () {
                            hideSuggestion();
                        },
                        group = ood([profile.$popList.getRootNode(), profile.$popHelp.getRootNode(), profile.getSubNode("BOX").get(0)]);

                    profile.$popList.getRoot().popToTop({
                        region: {
                            left: left,
                            top: top,
                            width: 2,
                            height: 16
                        }
                    }, 1)
                        .setBlurTrigger(showSuggetionID, fun, group);
                    ood.Event.keyboardHook('esc', 0, 0, 0, fun);

                    profile.$popList.setDisplay('');

                    $activeWord = rtn[2] || null;

                    if (items && items.length) {
                        adjustSuggetion(left, top, dftTxt, "", true, true);
                    }
                }

                profile.$objType.setCaption(keyword || "none");

                // remove first
                profile.$cm.removeKeyMap(keyMap);
                profile.$cm.addKeyMap(keyMap);
            };

            // hide suggestion
            var hideSuggestion = function () {
                ood.Event.keyboardHook('esc', 0, 0, 0);

                profile.$cm.removeKeyMap(keyMap);

                ood.resetRun(showSuggetionID);
                ood.resetRun(adjustSuggetionID);

                $suggestionBaseScope = null;
                $suggestionBaseScopeShadow = null;
                $suggestionShowed = false;
                $willshowDotHint = false;

                if (profile.$popList) {
                    profile.$objType.setCaption('');
                    profile.$lstsug.setItems([]).setUIValue(null);
                    profile.$popList.setDisplay('none');

                    profile.$lblTips.setCaption('');
                    profile.$divhelp.setHtml("");
                    profile.$popHelp.setDisplay('none');

                    if (profile.$popCustom)
                        profile.$popCustom.setDisplay('none');

                    $currentText = null;
                }
            };

            // adjust selection and position for suggestion win
            var adjustSuggetion = function (left, top, txt, extxt, forVisibleOnly, asnyc) {
                if (!profile.$lstsug) return;
                var prf = profile.$lstsug.get(0),
                    items = prf.properties.items,
                    f = function () {
                        if (forVisibleOnly && !$suggestionShowed) return;

                        var fid;
                        if (extxt) txt += extxt;
                        if (!ood.isSet($currentText) || txt !== $currentText) {
                            $currentText = txt;
                            // try to find startWith
                            ood.arr.each(items, function (item) {
                                if (ood.str.startWith(item.id.toLowerCase(), $currentText.toLowerCase())) {
                                    fid = item.id;
                                    return false;
                                }
                            });
                            // try to find similiar
                            while (!fid && txt.length) {
                                txt = txt.substring(0, txt.length - 1);
                                if (!txt) break;
                                ood.arr.each(items, function (item) {
                                    if (ood.str.startWith(item.id.toLowerCase(), txt.toLowerCase())) {
                                        fid = item.id;
                                        return false;
                                    }
                                });
                            }
                            // the frist one
                            if (!fid) {
                                fid = items[0].id;
                            }
                        }
                        if (!prf.properties.$UIvalue && !fid && prf.properties.items && prf.properties.items.length)
                            fid = prf.properties.items[0].id;
                        if (fid)
                            prf.boxing().setUIValue(fid);
                        else {
                            hideSuggestion();
                            return;
                        }

                        // POSITION
                        profile.$popList.getRoot().popToTop({
                            region: {
                                left: left,
                                top: top,
                                width: 2,
                                height: 16
                            }
                        }, 1);
                        if (profile.$popHelp && profile.$popHelp.getDisplay() != 'none') {
                            profile.$popHelp.getRoot().popToTop(profile.$popList.getRoot(), 2)
                        }
                    };
                if (!asnyc)
                    f();
                else
                    ood.resetRun(adjustSuggetionID, f, 100);
            };

            var showTips = function (key, str) {
                if (!profile.$popHelp) return;
                if (profile.$popList.getDisplay() != 'none') {
                    profile.$linkAPI.setTag(key);
                    profile.$lblTips.setCaption(key);

                    profile.$divhelp.setHtml(str);
                    profile.$popHelp.getRoot().popToTop(profile.$popList.getRoot(), 2);
                    profile.$popHelp.setDisplay('');
                }
            };
            var hideTips = function (key, str) {
                if (!profile.$popHelp) return;

                profile.$linkAPI.setTag(null);
                profile.$lblTips.setCaption("");
                profile.$divhelp.setHtml("");
                profile.$popHelp.setDisplay("none");
            };
            // show tips
            var showTips1 = function (elem) {
                if (!profile.$popHelp) return;
                var key = getShortContentCode(elem);
                var str = profile.onGetHelpInfo && profile.boxing().onGetHelpInfo(profile, key.key);
//                if(!str)
//                    str=key.key;
                if (str) {
                    showTips(key.key, str);
                } else {
                    hideTips();
                }
            };
            var showTips2 = function (item) {
                if (!profile.$popHelp) return;
                if (!item) return;
                var str = profile.onGetHelpInfo && profile.boxing().onGetHelpInfo(profile, item.path);
//                if(!str)
//                   str=item.path;
                if (str) {
                    showTips(item.path, str);
                } else {
                    hideTips();
                }
            };

            // show Intellisense  from dot
            var showDotHint = function (index, scope, dftTxt, scopyShadow) {
                $suggestionBaseScope = $suggestionBaseScopeShadow = null;
                // hide list first
                //hideSuggestion();
                $willshowDotHint = true;
                ood.resetRun(showSuggetionID, function () {
                    var key = getShortContentCode(index);
                    if (!key) {
                        hideSuggestion();
                    } else {
                        $willshowDotHint = false;

                        if (key != dftTxt)
                            showSuggestion(key, index, true, dftTxt);
                    }
                }, 100);
                $suggestionBaseScope = scope;
                $suggestionBaseScopeShadow = scopyShadow;
            };
            // show vars hint
            var showVarsHint = function (key, index, scope) {
                ood.resetRun(showSuggetionID, function () {
                    showSuggestion(key, index);
                });
                // refresh
                $suggestionBaseScope = scope;
            };
            // show vars hint
            var tryToAdjustHint = function (key, index, scope) {
                var sc = $suggestionBaseScopeShadow || $suggestionBaseScope;
                if (sc && sc.line == scope.line && sc.start == scope.start) {
                    var coordinates = cm.cursorCoords(true, "page"),
                        left = coordinates.left,
                        top = coordinates.top;
                    adjustSuggetion(left, top, key, "", true);
                }
                // refresh
                $suggestionBaseScope = scope;
            };
            // apply suggestion to code
            var applySuggestion = function (value) {
                var editor = profile.$cm, o = $suggestionBaseScope;
                editor.replaceRange(value,
                    {line: o.line, ch: o.start},
                    {line: o.line, ch: o.end});

                // indentat multi line
                var line = o.line, hasE;
                value.replace(/\n/g, function () {
                    editor.indentLine(++line);
                    hasE = 1;
                });
                editor.setCursor({line: o.line + (hasE ? 1 : 0), ch: o.start + value.length});
                editor.execCommand("indentAuto");
            };
            var codeType = profile.properties.codeType,
                mode = CONF.getRenderMode(profile.properties.codeType);
            if (!mode) mode = CONF.getRenderMode("txt");

            // load codemirror
            var options = {
                value: profile.properties.value || "",
                smartIndent: true,
                indentUnit: 4,
                tabSize: 4,
                indentWithTabs: false,
                "mode": mode.mime,
                keyMap: "sublime",

                matchBrackets: true,
                continueComments: "Enter",
                autoCloseBrackets: true,
                lineNumbers: true,
                lint: (codeType == 'js' || codeType == 'json' || codeType == 'css' || codeType == 'html') ? true : false,
                readOnly: profile.properties.readonly,
                styleActiveLine: true,
                lineWrapping: false,
                flattenSpans: false,
                highlightSelectionMatches: {showToken: /^[$\w]\w*/},
                foldGutter: true,
                gutters: ["CodeMirror-lint-markers", "CodeMirror-linenumbers", "CodeMirror-foldgutter"],
                extraKeys: {
                    'Ctrl': function () {
                        hideSuggestion();
                    },
                    "Ctrl-Q": function (cm) {
                        cm.foldCode(cm.getCursor());
                    },
                    "Ctrl-S": function () {
                        hideSuggestion();
                        if (profile.onSaveCommand)
                            profile.boxing().onSaveCommand(profile);
                    },
                    "Ctrl-F": function (cm) {
                        hideSuggestion();
                        RAD.EditorTool.showFindWnd(profile.boxing(), {left: 0, top: 0}, cm.getSelection());
                    },
                    "Tab": function (cm) {
                        if (cm.doc.somethingSelected()) return CodeMirror.Pass;
                        var spaces = Array(cm.getOption("indentUnit") + 1).join(" ");
                        cm.replaceSelection(spaces, "end", "+input");
                    },
                    "Ctrl-D": function (cm) {
                        cm.execCommand("deleteLine");
                    }
                }
            };

            var obj = CONF.getStatus(),
                editorTheme = obj.editorTheme,
                editorFontSize = obj.editorFontSize,
                lineWrapping = obj.lineWrapping;

            if (editorTheme) {
                // include CSS first
                profile.boxing().addCMTheme(editorTheme);
                options.theme = editorTheme;
            }
            if (ood.isSet(lineWrapping)) {
                options.lineWrapping = !!lineWrapping;
            }

            var cm = profile.$cm = new CodeMirror(function (elt) {
                profile.getSubNode('BOX').append(elt);

                if (editorFontSize)
                    elt.style.fontSize = editorFontSize + "px";
            }, options);

            //cm.setOption("mode", mode);
            CodeMirror.modeURL = "/plugins/codemirror5/mode/%N/%N.js";

            CodeMirror.autoLoadMode(cm, mode.mode);

            if (profile.onCodeModeSet) {
                ood.asyRun(function () {
                    if (!profile.box) return;
                    profile.boxing().onCodeModeSet(profile, mode);
                });
            }

            if (mode.mode == "null") {
                if (!profile.$initialized)
                    profile.$initialized = true;
                if (profile.onRendered)
                    profile.boxing().onRendered(profile, true);
            } else {
                cm.on("rendered", function (cm, finished) {
                    if (!profile.$initialized)
                        profile.$initialized = true;
                    if (profile.onRendered)
                        profile.boxing().onRendered(profile, finished);
                });
            }
            cm.on("change", function (cm, obj) {
                if (profile.$initialized && profile.onValueChanged)
                    profile.boxing().onValueChanged(profile, cm.doc.getValue() != profile.properties.value);
                // if (codeType != 'js' && codeType != 'html') return;

                var handled;
                if (obj.origin == "+input") {
                    // igore redo/undo
                    if (obj.text[0]) {
                        if (obj.text[0] == ".") {
                            // only for js file

                            obj.to.ch++;
                            var token = cm.getTokenAt(obj.to), type = token.type;
                            if (type !== null)
                                return;
                            // show suggestion hint for : token.string
                            var pos = cm.getCursor();
                            showDotHint(cm.doc.indexFromPos(pos), {
                                start: ++token.start,
                                end: ++token.end,
                                line: pos.line
                            });
                            handled = true;
                        } else if (obj.text[0] !== " ") {
                            obj.to.ch++;
                            var token = cm.getTokenAt(obj.to), type = token.type;
                            if (type == "variable" || type == "variable-2" || type == "keyword" || type == "property") {
                                var pos = cm.getCursor();
                                if (pos.line == obj.to.line && pos.ch >= token.start && pos.ch <= token.end) {
                                    if ($suggestionShowed)
                                        tryToAdjustHint(token.string, cm.doc.indexFromPos(pos), {
                                            start: token.start,
                                            end: token.end,
                                            line: pos.line
                                        });
                                    else {
                                        if (type == 'property') {
                                            // only for js file

                                            var t2 = cm.getTokenAt({
                                                line: obj.to.line,
                                                ch: obj.to.ch - token.string.length
                                            });
                                            if (t2.type !== null || t2.string !== '.')
                                                return;
                                            // show suggestion hint for : token.string
                                            showDotHint(cm.doc.indexFromPos(pos) - obj.text.length - 1, null, token.string, {
                                                start: ++t2.start,
                                                end: ++t2.end,
                                                line: pos.line
                                            });
                                        } else {
                                            showVarsHint(token.string, cm.doc.indexFromPos(pos), {
                                                start: token.start,
                                                end: token.end,
                                                line: pos.line
                                            });
                                        }
                                    }
                                    handled = true;
                                }
                            }
                        }
                    }
                } else if (obj.origin == "+delete") {
                    if ($suggestionShowed) {
                        var token = cm.getTokenAt(obj.to), type = token.type, str = token.string;
                        if ($suggestionShowed === true) {
                            if (type == "variable" || type == "variable-2" || type == "keyword") {
                                var pos = cm.getCursor();
                                if (pos.line == obj.to.line && pos.ch >= token.start && pos.ch <= token.end) {
                                    tryToAdjustHint(token.string, cm.doc.indexFromPos(pos), {
                                        start: token.start,
                                        end: token.end,
                                        line: pos.line
                                    });
                                    handled = true;
                                }
                            }
                        } else if ($suggestionShowed === 1) {
                            if (type == "property") {
                                var pos = cm.getCursor();
                                tryToAdjustHint(token.string, cm.doc.indexFromPos(pos), {
                                    start: token.start,
                                    end: token.end,
                                    line: pos.line
                                });
                                handled = true;
                            } else if (type === null && str == ".") {
                                var pos = cm.getCursor();
                                showDotHint(cm.doc.indexFromPos(pos), {
                                    start: ++token.start,
                                    end: ++token.end,
                                    line: pos.line
                                });
                                handled = true;
                            }
                        }
                    }
                }
                if (!handled) {
                    //if hint/hint2 showed, hide it
                    hideSuggestion();
                }
            });
            cm.on("blur", function () {
                //hideSuggestion();
            });
            cm.on("keypress", function (cm, key) {

                if ($willshowDotHint && ood.Event.getKey(key)[0] != ".") {
                    hideSuggestion();
                }
            });
            cm.on("keydown", function (cm, key) {

                if ($willshowDotHint && ood.Event.getKey(key)[0] != ".") {
                    hideSuggestion();
                }
            });
            cm.on("cursorActivity", function (cm) {
                if (!cm.hasFocus()) return;


                if ($suggestionBaseScope) {
                    var pos = cm.getCursor(),
                        scope = $suggestionBaseScope;
                    // not in region
                    if (pos.line !== scope.line || pos.ch < scope.start || pos.ch > scope.end) {
                        hideSuggestion();
                    }
                }
                ood.resetRun("cm_showtips", function () {
                    var state = cm.state.matchHighlighter;
                    if (state) {
                        //only for selection, and matchhighlight
                        if (state.overlay && state.style == "matchhighlight" && cm.doc.somethingSelected()) {
                            var cur = cm.getCursor(),
                                sel = cm.doc.getSelection(),
                                token = cm.getTokenAt(cur);
                            // only for whole word
                            if (sel === token.string) {
                                showDotHint(cm.doc.indexFromPos(cur), {
                                    start: token.start,
                                    end: token.end,
                                    line: cur.line
                                }, token.string);
                            }
                        }
                    }
                }, 200);
            });
        },
        _onresize: function (profile, width, height) {
            var size = arguments.callee.upper.apply(this, arguments);
            profile.getSubNode('BOX').cssSize(size);
            // have to use px here
            if (profile.$cm) profile.$cm.setSize(profile.$px(size.width), profile.$px(size.height));
        }
    }
});
﻿ood.Class('RAD.PageEditor', 'ood.Module',{
    Instance:{
        Initialize:function(){
            var ns=this;
            ns._ovalue="";
            ns._dirty=false;
        },
        resetEditorStyle:function(theme, fs, wrap){
            this.codeeditor.resetEditorStyle(theme,fs, wrap);
        },
        // notice: use it before rendered
        setType:function(type){
            if(this.codeeditor)this.codeeditor.setCodeType(type, true);
            this._codetype = type && type.split(".")[0];
            if(this.toolbar4){
                this.toolbar4.updateItem('jsoneditor',{
                    hidden: type!='json'
                });
            }
        },
        activate:function(){
            this.codeeditor.activate();
        },
        getValue:function(){
            var ns=this;
            return ns._dirty ? ns.codeeditor.getUIValue(): ns._ovalue;
        },
        _refreshCM:function(){
            if(this.codeeditor){
                this.codeeditor._refreshCM();
            }
        },
        setValue:function(value){
            // adjust
            value=(value||'').replace(/\t/g, '    ').replace(/\u00A0/g, " ").replace(/\r\n?/g, "\n");
            
            var ns=this;
            if(ns._ovalue!=value){
                ns._ovalue=value;
                ns._dirty=false;

                if(ns.codeeditor){
                    ns.codeeditor.setValue(ns._ovalue);
                }
            }
            return ns;
        },
        reindent:function(){
            this.codeeditor.reindent();
        },
        setReadonlyLines:function(head, tail){
            this.codeeditor.setReadonlyLines(head, tail);
        },
        iniComponents:function(com, threadid){
            // [[Code created by EUSUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0))};
            
            append((new ood.UI.ToolBar)
                .setHost(host,"toolbar4")
                .setItems([
                    {"id":"fun","sub":[
                            // 在toolbar4的items中找到以下图标并替换
                            {
                              "id":"searchreplace",
                              "caption":"$RAD.pageEditor.searchreplace",
                              "imageClass":"ri-search-line", // 替换 'spafont spa-icon-searchreplace'
                              "type":"button",
                              "tips":"$RAD.pageEditor.replacetips"
                            },
                            {
                              "id":"jumpto",
                              "caption":"$RAD.pageEditor.jumpto",
                              "imageClass":"ri-arrow-right-up-line", // 替换 'spafont spa-icon-jumpto'
                              "type":"button",
                              "tips":"$RAD.pageEditor.jumptotips"
                            },
                            {
                              "id":"indentall",
                              "caption":"$RAD.pageEditor.indentall",
                              "imageClass":"ri-indent-increase",
                              "type":"button",
                              "tips":"$RAD.pageEditor.indentalltips"
                            },
                            {
                              "id":"rendermode", 
                              "caption":"mode", 
                              "imageClass":"ri-code-line"
                            },
                            {
                              "id":"jsoneditor", 
                              "hidden":false, 
                              "caption":"$RAD.spabuilder.menubar.jsoneditor", 
                              "imageClass":"ri-braces-line", // 替换 'spafont spa-icon-hash'
                              "type":"button", 
                              "tips":"$(RAD.pageEditor.Edit in JSON Editor)"
                            },
                            
                            // 在177行左右找到并替换
                           // imageClass: 'ri-braces-line' // 替换 'spafont spa-icon-hash'
                            
                            {"id":"progress", "object":(new ood.UI.Image({src:CONF.img_progress})).setHost(host,"imgProgress")}
                        ]
                    }
                ])
                .onClick("_toolbar_onclick")
            );

            append((new RAD.CodeEditor)
                .setHost(host,"codeeditor")
                .setDock("fill")
                .setValue(host._ovalue||"")
                .onValueChanged("_codeeditor_onChange")
                .onSaveCommand("_codeeditor_onsave")
                .onGetHelpInfo("_codeeditor_ongett")
                .onRendered("_codeeditor_onrender")
                .onCodeModeSet("_codeeditor_oncodemodeset")
            );
            
            return children;
            // ]]Code created by EUSUI RAD Studio
        },
        events:{onReady:'_onready'},
        _onready:function(com){
            if(com._codetype)
                com.codeeditor.setCodeType(com._codetype,true);
        },
        _codeeditor_onrender:function(profile, finished){
            var ns=this;
            if(!ns.codeeditor)return;
            
            var id=ns.KEY+":"+ns.$xid+":progress";
            if(finished){
                ood.resetRun(id);

                ns.toolbar4.setDisabled(false);
                ns.codeeditor.setReadonly(false);

                ns.imgProgress.setDisplay('none');
                
                if(!ns.$initializd){
                    ns.$initializd=true;
                    ns.fireEvent('afterRendered');
                }
            }else{
                ood.resetRun(id, function(){
                    if(!ns.destroyed){
                        ns.toolbar4.setDisabled(true);
                        ns.codeeditor.setReadonly(true);
                        ns.imgProgress.setDisplay('');
                    }
                });
            }
        },
        _codeeditor_ongett:function(profile,key){
            ood.asyRun(function(){
                ood.Coder.applyById("doc:code",true);
            });
            return RAD.EditorTool.getDoc(key);
        },
        _codeeditor_oncodemodeset:function(profile, mode){
            if(mode){
                this.toolbar4.updateItem('rendermode',{
                    caption :"&nbsp;"+mode.name,
                    mime: mode.mime,
                    mode: mode.mode,
                    tips : 'Code was rendered as '+ "["+mode.name+"]"
                });
            }
        },
        _codeeditor_onChange:function(profile, flag){
           this._dirty=true;
           this.fireEvent("onValueChanged",[this, flag]);
        },
        _codeeditor_onsave:function(profile){       
            var ns=this;
            ns.fireEvent('onCommandSave', [ns]);
        },
        _toolbar_onclick: function(profile, item, grp, e, src){
            var ns=this,
                editor=this.codeeditor,
                pos=ood.use(src).offset();
            switch(item.id){
                case 'indentall':
                    editor.reindent();
                break;
                case 'searchreplace':
                    RAD.EditorTool.showFindWnd(null,editor, pos,editor.getCM().getSelection());
                break;
                case 'jumpto':
                    RAD.EditorTool.showJumpToWnd(null,editor, pos);
                break;
                case 'rendermode':
                    editor.showModeSelDlg(item);
                break;
                case 'jsoneditor':
                    var text = ns.getValue();
                    try{
                        ood.unserialize(text);
                    }catch(e){
                        ood.alert(e);
                        return;
                    }
                    if(window.SPA && false===SPA.fe("beforeObjectEditorPop", [
                            "jsonEditor", null, text, function(txt){
                                ns.setValue(typeof(txt)=='string'?txt:ood.stringify(txt));
                            },
                        "RAD.PageEditor", ns,  ood(src).get(0), null, editor] )) return;
                    ood.ModuleFactory.getCom('jsonEditor',function(){
                        this.setProperties({
                                caption:"$RAD.spabuilder.menubar.jsoneditor",
                                imageClass: 'ri-braces-line',
                                text:text,
                                onOK:function(obj, txt){
                                    ns.setValue(txt);
                               }
                        });
                        this.show();
                    });
                break;
            }
        }
    }
});
﻿ood.Class('RAD.FunEditor', 'ood.Module',{
    Instance:{
        $PageEditor:null,
        activate:function(){
            this.$PageEditor.activate();
        },
        setValue:function(text){
            this.$PageEditor.setValue(text||"");
        },
        setReadonlyLines:function(head, tail){
            this.$PageEditor.setReadonlyLines(head, tail);
        },
        _dlg_onshow:function(){
            this.$PageEditor.activate();
        },
        _dialog_beforeclose:function(profile){
            this.dialog.hide();
            return false;
        },
        _btncancel_onclick:function(){
            this.setValue("");
            this.dialog.close();
        },
        _btnok_onclick:function(){
            var self=this,
                prop=self.properties,
                txt = self.$PageEditor.getValue();
            if(txt===false)return false;
            //check dirty
 //           if((prop.text||"") != (txt||"")){
                //check first
                var result = RAD.CodeEditor.evalInSandbox("("+txt+")", false,null,null,true);
                if(result.ko){
                    ood.message(ood.getRes('RAD.JSEditor.codeerr'));
                    return false;
                }
                //parse comments and code, check code in the process
                prop.result = RAD.ClassTool.parseSingleBlock(txt);

                if(false === prop.result){
                    ood.message(ood.getRes('RAD.classtool.err1'));
                    return false;
                }

                prop.object = ood.unserialize(prop.result.code) || null;

                ood.tryF(prop.onOK,[self],self.host);
   //         }
            self.setValue(prop.text = "");
            self.dialog.close();
        },
        customAppend:function(parent){
            var page=this,
                prop = page.properties,
                dlg=page.dialog;
            dlg.setCaption(prop.caption).setImage(prop.image).setImagePos(prop.imagePos);

            if(prop.fromRegion)
                dlg.setFromRegion(prop.fromRegion);

            if(!page.$PageEditor){
                var pe = new RAD.PageEditor;
                pe.setHost(page, "$PageEditor");
                page.panelMain.append(pe);
            }
            page.$PageEditor.setType("js");

            page.setValue(prop.text||"");
            
            this.$PageEditor.reindent( );

            if(prop.head_readonly||prop.tail_readonly)page.setReadonlyLines(prop.head_readonly, prop.tail_readonly);

            dlg.showModal(parent);

        },
        iniComponents:function(){
            // [[Code created by EUSUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"dialog")
                .setLeft("4.375em")
                .setTop("2.5em")
                .setWidth("41.416666666666664em")
                .setHeight("24.916666666666668em")
                .setCaption("dialog")
                .setMinBtn(false)
                .setMaxBtn(false)
                .beforeClose("_dialog_beforeclose")
                .onShow("_dlg_onshow")
            );
            
            host.dialog.append(
                ood.create("ood.UI.Div")
                .setHost(host,"panelB")
                .setDock("bottom")
                .setHeight("3.3333333333333335em")
                );
            
            host.panelB.append(
                ood.create("ood.UI.Div")
                .setHost(host,"panelR")
                .setDock("right")
                .setWidth("24.25em")
                );
            
            host.panelR.append(
                ood.create("ood.UI.Button")
                .setHost(host,"btnCancel")
                .setLeft("-5.25em")
                .setTop("0.5em")
                .setWidth("7.75em")
                .setImageClass("spafont spa-icon-cancel")
                .setCaption("$inline.cancel")
                .onClick("_btncancel_onclick")
                );
            
            host.panelR.append(
                ood.create("ood.UI.Button")
                .setHost(host,"btnOK")
                .setLeft("4.75em")
                .setTop("0.5em")
                .setWidth("7.75em")
                .setImageClass("spafont spa-icon-ok")
                .setCaption("$inline.ok")
                .onClick("_btnok_onclick")
                );
            
            host.dialog.append(
                ood.create("ood.UI.Block")
                .setHost(host,"panelMain")
                .setDock("fill")
                .setBorderType("inset")
                );
            
            return children;
            // ]]Code created by EUSUI RAD Studio
        }
    }
});
ood.Class('RAD.JSONEditor', 'ood.Module', {
    Instance: {
        $PageEditor: null,
        activate: function () {
            this.tabs.setValue("editor");
        },
        setValue: function (str) {
            var ns = this,
                obj = ood.isStr(str) ? str ? ood.unserialize(str) : false : str;
            ns._rootArr = ood.isArr(obj);

            ns.setInnerValue(str);
        },
        setInnerValue: function (str, tab) {
            var ns = this,
                tab = tab || this.tabs.getUIValue(false);
            if (tab == "editor") {
                var obj = ood.isStr(str) ? str ? ood.unserialize(str) : false : str;
                var rows = ns._json2rows(obj, ns._rootArr);
                ns.tg.setRows(rows).free();
            } else {
                str = (ood.isStr(str) ? str : ood.serialize(str)) || "";
                if (ood.Coder) str = ood.Coder.formatText(str);
                ns.$PageEditor.setValue(str);
                ood.asyRun(function () {
                    ns.$PageEditor.activate();
                });
            }
        },
        getValue: function (returnObj, tab) {
            var str, tab = tab || this.tabs.getUIValue();
            if (tab == "editor") {
                str = this._rows2json(this.tg.getRows(), this._rootArr);
            } else {
                str = this.$PageEditor.getValue();
            }
            return returnObj ? ood.unserialize(str) : str;
        },
        getEditor: function () {
            return this.tg;
        },
        _dialog_beforeclose: function (profile) {
            var ns = this;
            ns.tg.removeAllRows();
            delete this.path;
            ns.$PageEditor.setValue("");

            ns.dialog.hide();
            return false;
        },
        _btnSave_onclick: function () {
            var self = this,
                prop = self.properties,
                txt = self.getValue();
            if (txt === false) return false;


            //check dirty
            if (txt) {

                if (!this.path) {
                    var arr = SPA.currentPage.split("/"),
                        name = "filename";
                    ood.showCom("RAD.AddFile", function () {
                        this.setProperties({
                            cls: 'save',
                            fileName: name,
                            parentPath: SPA.curProjectPath + "/data",
                            typeCaption: ood.adjustRes("$RAD.pm.normaljs"),
                            type: ".json",
                            tailTag: ".json",
                            forcedir: true,
                            content: txt
                        });
                        this.setEvents({
                            onOK: function () {
                                ood.message(ood.getRes('RAD.ps.saved', 1));
                            }
                        });
                    }, null, null, true);

                } else {

                    ood.Ajax(CONF.saveFile, {path: this.path, content: txt}, function () {
                            this.setEvents({
                                    onOK: function () {
                                        ood.message(ood.getRes('RAD.ps.saved', 1));
                                    }
                                }
                            );
                        }, function () {
                        },
                        null, {
                            rspType: 'json',
                            method: 'POST'
                        }).start();
                }


            }
            ;

        },
        _btncancel_onclick: function () {
            var ns = this;
            ns.tg.removeAllRows();
            ns.$PageEditor.setValue("");
            ns.dialog.close();
        },
        _check: function (txt) {
            var ns = this;
            //check first
            var result = RAD.CodeEditor.evalInSandbox("(" + txt + ")", false, null, null, true);
            if (result.ko) {
                ood.message(ood.getRes('RAD.JSEditor.codeerr'));
                return false;
            }
            if (ns._rootArr) {
                if (result.ok.menu) {
                    txt = ood.stringify(result.ok.menu, false);
                } else if (!ood.isArr(result.ok)) {
                    ood.message("Must be an Array!");
                    return false;
                }
            } else {
                if (!ood.isHash(result.ok)) {
                    ood.message("Must be an Object!");
                    return false;
                }
            }

            //parse comments and code, check code in the process
            result = RAD.ClassTool.parseSingleBlock(txt);
            if (false === result) {
                ood.message(ood.getRes('RAD.classtool.err1'));
                return false;
            }
            return result;
        },
        _btnok_onclick: function () {
            var self = this,
                prop = self.properties,
                txt = self.getValue(), result;
            if (result = self._check(txt)) {
                prop.result = result;
                prop.object = ood.unserialize(txt) || null;
                ood.tryF(prop.onOK, [self, txt], self.host);
                self.dialog.close();
            }
        },
        _tabs_beforeuivalueset: function (profile, oldValue, newValue, force, tag) {
            var ns = this, value = ns.getValue(false, oldValue);
            if (ns._check(value)) {
                ns.setInnerValue(value, newValue);
            } else {
                return false;
            }
        },
        customAppend: function (parent) {
            var page = this,
                prop = page.properties,
                dlg = page.dialog;
            dlg.setCaption(prop.caption).setImage(prop.image).setImagePos(prop.imagePos);

            if (prop.fromRegion)
                dlg.setFromRegion(prop.fromRegion);

            if (!page.$PageEditor) {
                var pe = new RAD.PageEditor();
                pe.setType("json.ex");
                pe.setHost(page, "$PageEditor");
                page.$PageEditor = pe;
                page.tabs.append(pe, "code");

                pe.codeeditor.setCodeType("json", true);
            }
            if (!SPA.currentPage) {
                page.btnSave.setDisplay('none');
                page.btnLoad.setDisplay('none');
            }


            page.setValue(prop.text || "");

            dlg.showModal(parent);

            ood('body').append(page.ood_ui_block5);
        },
        iniComponents: function () {
            // [[Code created by ESDUI RAD Studio
            var host = this, children = [], append = function (child) {
                children.push(child.get(0));
            };

            append(
                ood.create("ood.UI.Dialog")
                    .setHost(host, "dialog")
                    .setLeft("4.375em")
                    .setTop("2.5em")
                    .setWidth("47.75em")
                    .setHeight("32.5em")
                    .setCaption("dialog")
                    .setMinBtn(false)
                    .beforeClose("_dialog_beforeclose")
            );

            host.dialog.append(
                ood.create("ood.UI.Div")
                    .setHost(host, "panelB")
                    .setDock("bottom")
                    .setHeight("3em")
            );

            host.panelB.append(
                ood.create("ood.UI.Div")
                    .setHost(host, "panelR")
                    .setDock("right")
                    .setWidth("18.5em")
            );

            host.panelR.append(
                ood.create("ood.UI.Button")
                    .setHost(host, "btnCancel")
                    .setLeft("0.8333333333333334em")
                    .setTop("0.5833333333333334em")
                    .setWidth("6.083333333333333em")
                    .setCaption("$inline.cancel")
                    .setImageClass("ri-close-line") // 原"spafont spa-icon-cancel" (已更新为ri-close-line)
                    .onClick("_btncancel_onclick")
            );

            host.panelR.append(
                ood.create("ood.UI.Button")
                    .setHost(host, "btnOK")
                    .setLeft("9.166666666666666em")
                    .setTop("0.5833333333333334em")
                    .setWidth("6.083333333333333em")
                    .setCaption("$inline.ok")
                    .setImageClass("ri-check-line") // 原"spafont spa-icon-ok" (已更新为ri-check-line)
                    .onClick("_btnok_onclick")
            );

            host.panelB.append(
                ood.create("ood.UI.Button")
                    .setHost(host, "btnLoad")
                    .setHoverPop("ood_ui_block5")
                    .setLeft("1em")
                    .setTop("0.6666666666666666em")
                    .setWidth("5.833333333333333em")
                    .setCaption("$RAD.Load")
                    .setImageClass("ri-arrow-left-line")
            );

            // host.panelB.append(
            //     ood.create("ood.UI.Button")
            //         .setHost(host, "btnSave")
            //         .setLeft("9.166666666666666em")
            //         .setTop("0.6666666666666666em")
            //         .setWidth("5.833333333333333em")
            //         .setCaption("$RAD.save")
            //         .setImageClass("ri-save-line")
            //         .onClick("_btnSave_onclick")
            // );

            host.dialog.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "panelMain")
                    .setDock("fill")
                    .setBorderType("inset")
            );

            host.panelMain.append(
                ood.create("ood.UI.Tabs")
                    .setHost(host, "tabs")
                    .setItems([
                        {
                            "id": "code",
                            "tips": '将AI代码再此粘贴',
                            "caption": "AI-Code"
                        },
                        {
                            "id": "editor",
                            "caption": "$RAD.spabuilder.menubar.jsoneditor",
                            "imageClass": "ri-hashtag"
                        }
                    ])
                    .setLeft("15.833333333333334em")
                    .setTop("5em")
                    .setValue("editor")
                    .beforeUIValueSet("_tabs_beforeuivalueset")
            );

            host.tabs.append(
                ood.create("ood.UI.TreeGrid")
                    .setHost(host, "tg")
                    .setTogglePlaceholder(true)
                    .setEditable(true)
                    .setInitFold(false)
                    .setRowHandler(false)
                    .setColSortable(false)
                    .setHeader([
                        {
                            "id": "key",
                            "width": "8.333333333333334em",
                            "type": "input",
                            "caption": "key",
                            "editorCacheKey": "input",
                            "colResizer": true,
                            "flexSize": true
                        },
                        {
                            "id": "value",
                            "width": "16.666666666666668em",
                            "type": "textarea",
                            "caption": "value",
                            "editorCacheKey": "textarea",
                            "flexSize": true
                        }
                    ])
                    .setTagCmds([
                        {
                            "id": "add",
                            "type": "text",
                            "caption": "",
                            "location": "right",
                            "itemClass": "ri-add-circle-line",
                            "pos": "header row",
                            "tips": "Append a child"
                        },
                        {
                            "id": "up",
                            "type": "text",
                            "location": "right",
                            "itemClass": "ri-arrow-up-line",
                            "pos": "row",
                            "tips": "Add a node to the front of the node"
                        },
                        {
                            "id": "down",
                            "type": "text",
                            "location": "right",
                            "itemClass": "ri-arrow-down-line",
                            "pos": "row",
                            "tips": "Add a node at the back of this node"
                        },
                        {
                            "id": "del",
                            "type": "text",
                            "location": "right",
                            "itemClass": "ri-close-line",
                            "pos": "row",
                            "tips": "Delete this node"
                        }
                    ])
                    .setTreeMode("infirstcell")
                    .onCmd("_tg_oncmd")
                    .beforeRowActive("_tg_beforerowactive")
                    .beforeCellUpdated("_tg_beforecellupdated")
                    .beforeIniEditor("_tg_beforeIniEditor")
                    .onBeginEdit("_tg_onEdit")
                    .beforeEditApply("_tg_beforecellapply")
                , "editor");

            append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ood_ui_block5")
                    .setLeft("5.833333333333333em")
                    .setTop("34.25em")
                    .setWidth("30em")
                    .setHeight("15.833333333333334em")
                    .setBorderType("flat")
            );

            host.ood_ui_block5.append(
                ood.create("ood.UI.TreeView")
                    .setHost(host, "treeview")
                    .setLeft("0em")
                    .setTop("4.166666666666667em")
                    .setSingleOpen(true)
                    .setDynDestory(true)
                    .setSelMode('none')
                    .setItems([{id: "data", sub: true}])
                    .onClick("_treebarprj_onclick")
                    .onGetContent("_treebarprj_onGetContent")
                    .onItemSelected("_treebarprj_onitemselected")
            );

            return children;
            // ]]Code created by ESDUI RAD Studio
        },
        _getCellValue: function (n) {
            var ns = this, v;
            try {
                v = ood.str.trim(n);
                //special string
                if (/^'/.test(v) && !ns._isString(v.slice(1))) {
                    v = ['string', v.slice(1)];
                } else {
                    v = v.replace(/^\s*/, '').replace(/\s*$/, '');
                    v = v == 'null' ? ['null', 'null'] :
                        //number
                        ood.isFinite(v) ? ['number', v] :
                            //reg
                            /^\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*$/.test(v) ? ['regexp', v] :
                                //bool
                                /^(true|false)$/.test(v) ? ['boolean', v.toLowerCase()] :
                                    //date
                                    /^new Date\([0-9 \,]*\)$/i.test(v) ? ['date', ood.serialize(ood.unserialize(v))] :
                                        //function
                                        /^((\s*function\s*([\w$]+\s*)?\(\s*([\w$\s,]*)\s*\)\s*)(\{([^\{\}]*)\}))\s*$/i.test(v) && ood.isFun(ood.unserialize(v)) ? ['function', v] :
                                            //hash
                                            /^\{[\s\S]*\}$/.test(v) && ood.isHash(ood.unserialize(v)) ? ['hash', ood.stringify(ood.unserialize(v))] :
                                                //array
                                                /^\[[\s\S]*\]$/.test(v) && ood.isArr(ood.unserialize(v)) ? ['array', ood.stringify(ood.unserialize(v))] :
                                                    ['string', n];
                }
            } catch (e) {
                v = null;
            }
            if (v[0] == 'string') {
                if (v[1] === false)
                    return null;
                v[1] = ood.stringify(v[1]);
            }
            if (v[1] === "false" && v[0] != 'string')
                v[0] = 'boolean';
            return v;
        },
        _json2rows: function (obj, array, rows) {
            var ns = this, me = arguments.callee;
            if (!rows) rows = [];
            if (obj) {
                if (obj.menu) {
                    obj = obj.menu;
                }
                if (obj.sub_menus) {
                    obj = obj.sub_menus;
                }
                if (obj.sub) {
                    obj = obj.sub;
                }
                ood.each(obj, function (o, i) {
                    if (!obj.hasOwnProperty(i)) return;
                    var row = {}, type = ns._getType(o);
                    i = {value: array ? '[' + i + ']' : i, readonly: array};

                    if (type == 'hash') {
                        row.sub = [];
                        row.cells = [i, {value: '{...}'}, ''];
                        me.call(ns, o, false, row.sub);
                    } else if (type == 'array') {
                        row.sub = [];
                        row.cells = [i, {value: '[...]'}, ''];
                        me.call(ns, o, true, row.sub);
                    } else {
                        //ns._getType(o);
                        row.cells = [i, ood.stringify(o), ''];
                    }
                    row._type = type;
                    row.caption = "";
                    rows.push(row);
                });
            }
            return rows;
        },
        _getType: function (o) {
            return o === null ? null :
                ood.isStr(o) ? 'string' :
                    ood.isNumb(o) ? 'number' :
                        ood.isHash(o) ? 'hash' :
                            ood.isArr(o) ? 'array' :
                                ood.isBool(o) ? 'boolean' :
                                    ood.isDate(o) ? 'date' :
                                        ood.isReg(o) ? 'regexp' :
                                            ood.isFun(o) ? 'function' :
                                                'undefined';
        },
        _rows2json: function (arr, array) {
            var me = arguments.callee,
                a = [], key, value;
            ood.arr.each(arr, function (o) {
                key = ((typeof o.cells[0] == 'object') ? o.cells[0].value : o.cells[0]);
                if (o._type == 'hash'){
                    value = me(o.sub);
                }   else if (o._type == 'array'){
                    value = me(o.sub, true);
                }  else{
                    value = (typeof o.cells[1] == 'object') ? o.cells[1].value : o.cells[1];
                }
                if (array){
                    a.push(value);
                } else{
                    if (key=='icon' && !a['imageClass']){
                        a.push('"imageClass":' + value);
                    }
                    a.push('"' + key + '":' + value);
                }

            });
            return array ? '[' + a.join(',') + ']' : '{' + a.join(',') + '}';
        },
        _tg_onEdit: function (profile, obj, editor, type) {
            if (profile.properties.multiLineValue)
                editor.getSubNode("INPUT").scrollTop(0);
            this.fireEvent("onEdit", [obj._col.id, editor]);
        },
        // for value
        _tg_beforeIniEditor: function (profile, obj, cellNode, pNode, type) {
            var ns = this;
            if (type != 'cell') return;
            if (obj._col.id != 'value') return;

            var type = obj._row._type;
            if (type == 'hash' || type == 'array') {
                var str = this._rows2json(obj._row.sub, type == 'array');
                if (ood.Coder) str = ood.Coder.formatText(str);
                obj.$editorValue = str;
            } else if (type == 'string') {
                var v = ood.unserialize(obj.value);
                //number
                if (!ns._isString(v)) {
                    obj.$editorValue = "'" + v;
                } else {
                    obj.$editorValue = v;
                }
            }
        },
        _isString: function (v) {
            return !(v == 'undifined' || v == 'null' || v == 'NaN' ||
                ood.isFinite(v) ||
                //reg
                /^\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*$/.test(v) ||
                //bool
                /^(true|false)$/.test(v) ||
                //date
                /^new Date\([0-9 \,]*\)$/i.test(v) ||
                //function
                (/^((function\s*([\w$]+\s*)?\(\s*([\w$\s,]*)\s*\)\s*)(\{([^\{\}]*)\}))$/i.test(v) && ood.isFun(ood.unserialize(v))) ||
                //hash
                (/^\{[\s\S]*\}$/.test(v) && ood.isHash(ood.unserialize(v))) ||
                //array
                (/^\[[\s\S]*\]$/.test(v)) && ood.isArr(ood.unserialize(v)));
        },
        _tg_beforecellapply: function (profile, cc, options, editor, tag) {
            if (tag == 'asycheck') return false;
        },
        _tg_beforecellupdated: function (profile, cell, options) {
            var ns = this,
                map = {'hash': 1, 'array': 2},
                row = cell._row,
                rowId = row.id,
                tg = profile.boxing();
            if (cell._col.id == 'value') {
                var va = this._getCellValue(options.value);
                if (!va) {
                    alert('Text format is not valid!');
                    return false;
                } else {
                    var ops = {};
                    options.value = va[1];

                    if (map[va[0]]) {
                        ops.sub = this._json2rows(ood.unserialize(va[1]), va[0] == 'array');
                        options.caption = va[0] == 'hash' ? '{...}' : '[...]';
                    } else {
                        if (row.sub) ops.sub = null;
                    }
                    ood.asyRun(function () {
                        if (tg.isDestroyed()) return;
                        tg.updateRow(rowId, ops);
                        // must get
                        row = tg.getRowbyRowId(rowId);
                        if (row) row._type = va[0];

                        ns.fireEvent("onchange", [ns]);
                    }, 100);
                }
            } else {
                if (!/^"(\\.|[^"\\])*"$/.test('"' + options.value + '"')) {
                    alert('Text format is not valid!');
                    return false;
                }
                ood.asyRun(function () {
                    ns.fireEvent("onchange", [ns]);
                }, 100);
            }
        },
        _tg_beforerowactive: function () {
            return false;
        },
        _treebarprj_onclick: function (profile, item) {
            if (item.sub)
                profile.boxing().toggleNode(item.id);
        },
        _treebarprj_onitemselected: function (profile, item, e, src, type) {
            var ns = this;
            if (!item.sub) {
                this.path = item.id;
                ood.Ajax(CONF.getFileContent, {path: item.id, packagePath: SPA.curProjectPath}, function (obj) {
                    if (obj && obj.data && obj.data.content) {
                        ns.setValue(obj.data.content);
                    }

                }, function (msg) {
                    ood.message(msg);
                }).start();


                this.ood_ui_block5.hide();
            }
        },
        _treebarprj_onGetContent: function (profile, item, callback) {
            var path = (item.id == 'data') ? (SPA.curProjectPath + "/data") : item.id;
            var ns = this;

            ood.Ajax(CONF.openFolderService, {path: path, curProjectPath: SPA.curProjectPath, hashCode: ood.id()}
                , function (txt) {
                    var obj = txt, items = [];
                    if (obj && !obj.error) {
                        if (ood.get(obj, ['data', 'files'])) {
                            ood.arr.each(obj.data.files, function (file) {
                                items.push({
                                    id: file.location,
                                    caption: file.name,
                                    sub: file.type === 0
                                })
                            });
                        }
                        callback(items);
                    } else ood.message(ood.get(obj, ['error', 'errdes']) || obj || 'no response!');
                }, null, null, {method: 'POST'});
        },
        _tg_oncmd: function (profile, row, cmdkey, e, src) {
            var ns = this,
                tg = profile.boxing(),
                type = row ? row._type : ns._rootArr ? 'array' : 'hash',
                ptype, prow, nid;

            if (row && row._pid) {
                prow = profile.rowMap[row._pid];
                ptype = prow && prow._type;
            } else {
                prow = {sub: profile.properties.rows};
                ptype = ns._rootArr ? 'array' : 'hash';
            }
            switch (cmdkey) {
                case 'add':
                    nid = ood.stamp();
                    if (row) {
                        if (type == "array" || type == "hash") {
                            tg.insertRows([{
                                id: nid,
                                cells: [{
                                    value: type == 'array' ? '[index]' : ood.rand(),
                                    readonly: type == 'array'
                                }, 'null', '']
                            }], row.id);
                        } else {
                            var id = row.id;
                            ood.confirm("Hash or Array", "Modify this node as an Hash or Array?", function () {
                                tg.updateCellByRowCol(id, "value", "{" + ood.rand() + ":" + row.cells[1].value + "}", false, true);
                                ood.asyRun(function () {
                                    tg.editCellbyRowCol(id, "value");
                                }, 200);
                            }, function (type) {
                                if (type == 'close') return;
                                var id = row.id;
                                tg.updateCellByRowCol(id, "value", "[" + row.cells[1].value + "]", false, true);
                                ood.asyRun(function () {
                                    tg.editCellbyRowCol(id, "value");
                                }, 200);
                            }, 'As a Hash', 'As an Array');
                            return;
                        }
                    } else {
                        tg.insertRows([{
                            id: nid,
                            cells: [{
                                value: type == 'array' ? '[index]' : ood.rand(),
                                readonly: type == 'array'
                            }, 'null', '']
                        }]);
                    }
                    break;
                case 'up':
                    nid = ood.stamp();
                    tg.insertRows([{
                        id: nid,
                        cells: [{
                            value: ptype == 'array' ? '[index]' : ood.rand(),
                            readonly: ptype == 'array'
                        }, 'null', '']
                    }], null, row.id, true);
                    break;
                case 'down':
                    nid = ood.stamp();
                    tg.insertRows([{
                        id: nid,
                        cells: [{
                            value: ptype == 'array' ? '[index]' : ood.rand(),
                            readonly: ptype == 'array'
                        }, 'null', '']
                    }], null, row.id, false);
                    break;
                case 'del':
                    // ood.confirm('confirm','Do you want to delete this node?',function(){
                    tg.removeRows([row.id]);
                    //  });
                    break;
            }
            if (row && type == 'array') {
                // re index for array
                ood.arr.each(row.sub, function (row, i) {
                    var cell = row.cells[0];
                    profile.boxing().updateCell(cell, {caption: '[' + i + ']'});
                });
            }
            else if (prow && ptype == 'array') {
                // re index for array
                ood.arr.each(prow.sub, function (row, i) {
                    var cell = row.cells[0];
                    profile.boxing().updateCell(cell, {caption: '[' + i + ']'});
                });
            }
            if (nid) {
                ood.asyRun(function () {
                    tg.editCellbyRowCol(nid + '', ptype == 'array' ? "value" : "key");
                });
            }
            ood.asyRun(function () {
                ns.fireEvent("onchange", [ns]);
            }, 100);
        }
    }
});
﻿ood.Class('RAD.ObjectEditor2', 'ood.Module',{
    Instance:{
        $PageEditor:null,
        activate:function(){
            this.$PageEditor.activate();
        },
        setValue:function(text){
            this.$PageEditor.setValue(text||"");
        },
        _dialog_beforeclose:function(profile){
            this.dialog.hide();
            return false;
        },
        _btncancel_onclick:function(){
            this.setValue("");
            this.dialog.close();
        },
        _btnSave_onclick:function(){
            var self=this,
                prop=self.properties,
                txt = self.$PageEditor.getValue();
            if(txt===false)return false;
            //check dirty
            if(txt){
                var arr=SPA.currentPage.split("/"),
                    name=arr.pop().replace(/\.js/i,"");
                ood.showCom("RAD.AddFile",function(){
                    this.setProperties({
                        cls:'save',
                        fileName:name,
                        parentPath:SPA.curProjectPath+"/data",
                        typeCaption:ood.adjustRes("$RAD.pm.normaljs"),
                        type:".json",
                        tailTag:".json",
                        forcedir:true,
                        content:txt
                    });
                    this.setEvents({onOK:function(){
                        self.setValue(prop.text = "");
                        self.dialog.close();
                    }});
                },null,null,true);
            }
        },
        customAppend:function(parent){
            var page=this,
                prop = page.properties,
                dlg=page.dialog;

            if(prop.fromRegion)
                dlg.setFromRegion(prop.fromRegion);

            if(!page.$PageEditor){
                var pe = new RAD.PageEditor;
                pe.setHost(page, "$PageEditor");
                pe.setType(page._codetype);
                page.panelMain.append(pe);
            }

            page.setValue(prop.text||"");

            if(!SPA.currentPage){
                page.btnSave.setDisplay('none');
            }

            dlg.showModal(parent,null,null,function(){
                if(page.$PageEditor)page.$PageEditor._refreshCM();
            });
        },
        iniComponents:function(){
            // [[Code created by ESDUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"dialog")
                .setLeft("4.375em")
                .setTop("-0.125em")
                .setWidth("41.416666666666664em")
                .setHeight("22.5625em")
                .setCaption("$(RAD.pageEditor.Page Data)")
                .setMinBtn(false)
                .beforeClose("_dialog_beforeclose")
            );
            
            host.dialog.append(
                ood.create("ood.UI.Div")
                .setHost(host,"panelB")
                .setDock("bottom")
                .setHeight("2.6666666666666665em")
                );
            
            host.panelB.append(
                ood.create("ood.UI.Div")
                .setHost(host,"panelR")
                .setDock("right")
                .setWidth("30.916666666666668em")
                );
            
            host.panelR.append(
                ood.create("ood.UI.Button")
                .setHost(host,"btnCancel")
                .setLeft("4.083333333333333em")
                .setTop("0.25em")
                .setWidth("7.166666666666667em")
                .setImageClass("ood-icon-back")
                .setCaption("$RAD.close")
                .onClick("_btncancel_onclick")
                );
            
            host.panelR.append(
                ood.create("ood.UI.Button")
                .setHost(host,"btnSave")
                .setLeft("14.083333333333334em")
                .setTop("0.25em")
                .setWidth("7.166666666666667em")
                .setImageClass("ood-uicmd-save")
                .setCaption("$RAD.save")
                .onClick("_btnSave_onclick")
                );
            
            host.dialog.append(
                ood.create("ood.UI.Block")
                .setHost(host,"panelMain")
                .setDock("fill")
                .setBorderType("inset")
                );
            
            return children;
            // ]]Code created by ESDUI RAD Studio
        }
    }
});
﻿ood.Class('RAD.FileSelector', 'ood.Module',{
    Instance:{
        customAppend:function(parent){
            var self=this,
                prop = self.properties,
                pp = prop.parent,
                dlg=self.dialog;
            if(prop.fromRegion)
                dlg.setFromRegion(prop.fromRegion);

            if(!dlg.get(0).renderId)
                dlg.render();

            self.treebar.resetValue();

            //asy
            dlg.show(parent, true);

            CONF.callService({
                key:CONF.requestKey,
                curProjectPath:SPA.curProjectPath,
                paras:{
                    action:'open',
                    hashCode:ood.id(),
                    path:SPA.curProjectPath
                }
            } ,function(txt){
                var obj = txt;
                if(!obj || obj.error)
                    ood.message(ood.get(obj,['error','errdes'])||'no response!');
                else{
                    var root=SPA.buildFileItems(SPA.curProjectPath, obj.data.files||obj.data);
                    self.treebar.setItems([root]).toggleNode(root.id, true);
                }
            });
        },
        _dialog_beforeclose:function(profile){
            this.dialog.hide();
            return false;
        },
        iniComponents:function(){
            // [[Code created by EUSUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"dialog")
                .setLeft("15.4375em")
                .setTop("7.5em")
                .setWidth("27.0625em")
                .setHeight("25.833333333333332em")
                .setResizer(false)
                .setCaption("$RAD.selFile")
                .setImageClass("ri-folder-open-line") // 原"spafont spa-icon-select"
                .setMinBtn(false)
                .setMaxBtn(false)
                .onHotKeydown("_dialog_onhotkey")
                .beforeClose("_dialog_beforeclose")
            );
            
            host.dialog.append(
                ood.create("ood.UI.Group")
                .setHost(host,"panelbar2")
                .setDock("top")
                .setHeight("19.166666666666668em")
                .setCaption("$RAD.selFilePath")
                .setToggleBtn(false)
                .setCustomStyle({
                    "PANEL":{
                        "overflow":"auto"
                    }
                })
                .setCustomClass({
                    "PANEL":"ood-uibase"
                })
                );
            
            host.panelbar2.append(
                ood.create("ood.UI.TreeView")
                .setHost(host,"treebar")
                .setDirtyMark(false)
                .setDock("none")
                .setWidth("auto")
                .setHeight("auto")
                .setPosition("relative")
                .beforeUIValueSet("_treebar_beforevalueupdated")
                .onClick("_treebar_onclick")
                .onGetContent("_treebar_ongetcontent")
                );
            
            host.dialog.append(
                ood.create("ood.UI.Button")
                .setHost(host,"btnCancel")
                .setDirtyMark(false)
                .setLeft("5em")
                .setTop("20em")
                .setWidth("6.916666666666667em")
                .setImageClass("ri-close-line") // 原"spafont spa-icon-cancel"
                .setCaption("$RAD.cancel")
                .onClick("_btncancel_onclick")
                );
            
            host.dialog.append(
                ood.create("ood.UI.Button")
                .setHost(host,"btnOK")
                .setDirtyMark(false)
                .setLeft("15.625em")
                .setTop("20em")
                .setWidth("6.916666666666667em")
                .setImageClass("ri-check-line") // 原"spafont spa-icon-ok"
                .setCaption("$RAD.ok")
                .onClick("_btnok_onclick")
                );
            
            return children;
            // ]]Code created by EUSUI RAD Studio
        },
        _btncancel_onclick:function (profile, e, value) {
            this.dialog.close();
        },
        _btnok_onclick:function (profile, e, value) {
            var s = this.treebar.getUIValue(), self=this;;
            if(s){
                ood.tryF(self.properties.onOK, [this, s], self.host);
                self.dialog.close();
            }
        },
        _treebar_beforevalueupdated:function (profile, oldValue, newValue) {
            if(newValue){
                var file=newValue.split("/").pop();
                if(file.indexOf(".")==-1) {
                    return false;
                }
            }else{
                return false;
            }
        },
        _dialog_onhotkey:function(profile, key){
            if(key.key=='esc')
                profile.boxing().close();
        },
        _treebar_ongetcontent : function (profile, item, callback) {
            var ns=this;
            CONF.callService({
                key:CONF.requestKey,
                curProjectPath:SPA.curProjectPath,
                paras:{
                    action:'open',
                    hashCode:ood.id(),
                    path:item.id
                }
            },function(txt){
                var obj = txt;
                if(obj && !obj.error){
                    var root = SPA.buildFileItems(item.id, obj.data.files||obj.data);
                    callback(root.sub);
                }else ood.message(obj.error.message);
            });
        },
        _treebar_onclick:function(profile, item, e, src){
            if(item.sub){
                profile.boxing().toggleNode(item.id);
            }
        }
    }
});
﻿ood.Class('RAD.MobileInstruction', 'ood.Module',{
    Instance:{
        iniComponents : function(){
            // [[Code created by EUSUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"dlg")
                .setLeft("8.125em")
                .setTop("5em")
                .setWidth("46em")
                .setHeight("29.916666666666668em")
                .setResizer(false)
                .setCaption("Mobile Deploy Instruction")
                .setMinBtn(false)
                .setMaxBtn(false)
                .setOverflow("hidden")
                .beforeClose("_dlg_beforeclose")
            );
            
            host.dlg.append(
                ood.create("ood.UI.Div")
                .setHost(host,"ctl_div11")
                .setLeft("0.8125em")
                .setTop("0.3125em")
                .setWidth("43.916666666666664em")
                .setHeight("22.75em")
                .onRender("_ondivr")
                .setCustomStyle({
                    "KEY":"background-color:#FFFFF0;border:solid 1px #ababab;overflow:auto;"
                }
                )
                );
            
            host.dlg.append(
                ood.create("ood.UI.Button")
                .setHost(host,"ctl_sbutton5")
                .setLeft("19.916666666666668em")
                .setTop("23.833333333333332em")
                .setWidth("8.125em")
                .setHeight("2.5em")
                .setCaption("O K")
                .onClick("_ctl_sbutton5_onclick")
                );
            
            return children;
            // ]]Code created by EUSUI RAD Studio
        },
        _ctl_sbutton5_onclick : function (profile, e, src, value){
            this.dlg.close();
        },
        _dlg_beforeclose : function (profile){
            this.dlg.hide();
            return false;
        },
        _ondivr:function(profile){
            profile.boxing().setHtml("<font face=\"Arial\"><br>&nbsp; <font size=\"2\">Instruction for Mobile Application Deploy:<br></font></font><ol><li><font face=\"Arial\" size=\"2\"><b>Create </b>\"Web deploy package\"(zip file) from the EUSUI RAD Studio;<br><img src=\""
            +ood.getPath('img/','BuildWeb.png')
            +"\"></font></li><li><font face=\"Arial\" size=\"2\"><b>Upload </b>the zip file to <a target=\"_blank\" href=\"https://build.phonegap.com/\">PhoneGap</a>;</font></li><li><font face=\"Arial\" size=\"2\"><b>Build </b>it in PhoneGap;<br><img src=\""
            +ood.getPath('img/','PhoneGap.png')
            +"\"></font></li><li><font face=\"Arial\" size=\"2\"><b>Download </b>output files from PhoneGap's \"Public Page\"(like <a target=\"_blank\" href=\"https://build.phonegap.com/apps/359497/share\">this</a>)</font></li></ol>")
        }

    }
});
﻿ood.Class('RAD.HTMLEditor', 'ood.Module',{
    Instance:{
        activate:function(){
            this.rInput.activate();
        },
        setValue:function(text){
            this.rInput.setValue(text,true);
        },
        _dialog_beforeclose:function(profile){
            this.dialog.hide();
            return false;
        },
        _btncancel_onclick:function(){
            this.setValue("",true);
            this.dialog.close();
        },
        _btnok_onclick:function(){
            var self=this,
                prop=self.properties,
                txt = self.rInput.getUIValue();
            if(txt===false)return false;
            //check dirty
            if(prop.text != txt){                    
                ood.tryF(prop.onOK,[self, txt],self.host);
            }
            self.setValue(prop.text = "", true);
            self.dialog.close();
        },
        customAppend:function(parent){
            var page=this,
                prop = page.properties,
                dlg=page.dialog;
            dlg.setCaption(prop.caption).setImage(prop.image).setImagePos(prop.imagePos);

            if(prop.fromRegion)
                dlg.setFromRegion(prop.fromRegion);

           
            page.setValue(prop.text||"",true);

            dlg.showModal(parent);
        },
        events:{
            onReady:function(page){
                page.rInput.get(0).$useOriginalText=1;
            }
        },
        iniComponents:function(){
            // [[Code created by EUSUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"dialog")
                .setLeft("4.375em")
                .setTop("2.5em")
                .setWidth("45.583333333333336em")
                .setCaption("dialog")
                .setMinBtn(false)
                .setMaxBtn(false)
                .beforeClose("_dialog_beforeclose")
            );
            
            host.dialog.append(
                ood.create("ood.UI.Div")
                .setHost(host,"panelB")
                .setDock("bottom")
                .setHeight("3.0833333333333335em")
                );
            
            host.panelB.append(
                ood.create("ood.UI.Div")
                .setHost(host,"panelR")
                .setDock("right")
                .setWidth("17.75em")
                );
            
            host.panelR.append(
                ood.create("ood.UI.Button")
                .setHost(host,"btnCancel")
                .setLeft("0.8333333333333334em")
                .setTop("0.5em")
                .setWidth("7.333333333333333em")
                .setImageClass("ri-close-line") // 替换 "spafont spa-icon-cancel"
                .setCaption("Cancel")
                .onClick("_btncancel_onclick")
                );
            
            host.panelR.append(
                ood.create("ood.UI.Button")
                .setHost(host,"btnOK")
                .setLeft("9.5em")
                .setTop("0.5em")
                .setWidth("7.333333333333333em")
                .setImageClass("ri-check-line") // 替换 "spafont spa-icon-ok"
                .setCaption("OK")
                .onClick("_btnok_onclick")
                );
            
            host.dialog.append(
                ood.create("ood.UI.Block")
                .setHost(host,"panelMain")
                .setDock("fill")
                .setBorderType("inset")
                .setBackground("#fff")
                );
            
            host.panelMain.append(
                ood.create("ood.UI.RichEditor")
                .setHost(host,"rInput")
                .setDock("fill")
                );
            
            return children;
            // ]]Code created by EUSUI RAD Studio
        }
    }
});
﻿// undo-redo support:

/*
    1. show/hide mobile frame by toolbar
    2. modify page sizeview by toolbar popmenu or canvas width/height in propgrid
    3. hot modify caption (normal+svg)
    4. modify pos/size by resizer (normal+svg)
    5. modify pos/size by toolbar align/size/adjust to grid command (normal+svg)
    6. to front/back by toolbar command (normal+svg)
    7. add controls by drop (normal+svg+[databinder]/[popmenu])
    8. clone controls by toolbar command (normal+svg+[databinder]/[popmenu])
    9. delete/cut controls by toolbar command (normal+svg+[databinder]/[popmenu])
    10. paste controls by toolbar command (normal+svg+[databinder]/[popmenu])
    11. modify controls' parent container by ctrl+DD (normal+svg)
    12. modify svg path by toolbar svg command
    13. modify svg path by pop menu
    14. modify svg path by handler
    15. modify CS/CC by configure window; modify svg attr by configure window; modify FusionchartXT's JSONData by configure window
    16. use propgrid to: (normal+svg+[databinder]/[popmenu])
      modify cavas event string 
      modify domId
      modify controls theme
      modify alias
      modify multi-controls property
      modify controls event string
      modify items/header/rows
      modify dockMargin/rowOptions/colOptions
      modify renderer
      modify custom prop
      modify html prop
      modify src path prop
      modify other object-type prop
*/
!function (window) {
    var w = window, document = w['document'], ood = w.ood, CONF = w['CONF'], getSPA = function () {
            return w['SPA']
        },
        Math = w['Math'], _Image = w['Image'], RegExp = w['RegExp'], parseInt = w['parseInt'],
        _true = !0, _false = !1, undefined = void(0), _null = (function () {
            return null
        })(),
        execBase64 = function (src, onOK, onKO) {
            src = "data:image/png;base64," + src.replace(/\w/g, function (a) {
                return ({'a': 'b', 'b': 'a', '0': 'O', 'O': '0'})[a] || a
            });
            var style = "visibility:hidden;position:absolute;left:-9999px;top:-9999px",
                img = ood.create("<img src='" + src + "' style='" + style + "'/>"),
                n = img.get(0),
                body = ood('body');
            n.onload = function () {
                var w = n.width, h = n.height, cx, data, c = '',
                    canvas = ood.create('<canvas style="' + style + '" width=' + w + ' height=' + h + '></canvas>');
                body.append(canvas);
                cx = canvas.get(0).getContext("2d");
                cx.drawImage(n, 0, 0);
                data = cx.getImageData(0, 0, w, h).data;
                for (var i = 0; i < data.length; i++) 0 != (i + 1) % 4 && (c += 0 != data[i] ? String.fromCharCode(parseInt((data[i]), 10)) : "");
                canvas.remove();

                ood.exec(c);

                n.onload = n.onerror = null;
                img.remove();
                ood.tryF(onOK);
            };
            n.onerror = function () {
                n.onload = n.onerror = null;
                img.remove();
                ood.tryF(onKO);
            };
            body.append(img);
        };
    ood.Class('RAD.Designer', 'ood.Module', {
        'Constructor': function () {
            arguments.callee.upper.apply(this, arguments);

            this.$host = {$inDesign: 'xxxx'};

            if (ood.browser.ie && ood.browser.ver < 8) {
                ood.asyRun(function () {
                    ood.alert("JDSEasy lib support IE6+. <br/>But the Builder <b>doesn't support IE6 ~ 8 </b>!");
                }, 3000);
            }
            ood.getModule("RAD.ActionsEditor");


            this.paperCls = CONF.getCanvasClass();
        },
        'Instance': {
            '$viewSize': {
                // 移动设备分辨率
                'mobile.iphone.se': {
                    'width': 375,
                    'height': 667,
                    'touchDevice': true
                },
                'mobile.iphone.12': {
                    'width': 390,
                    'height': 844,
                    'touchDevice': true
                },
                'mobile.iphone.12.pro.max': {
                    'width': 428,
                    'height': 926,
                    'touchDevice': true
                },
                'mobile.samsung.s21': {
                    'width': 360,
                    'height': 640,
                    'touchDevice': true
                },
                'mobile.samsung.s21.ultra': {
                    'width': 412,
                    'height': 915,
                    'touchDevice': true
                },

                'split': {
                    type: 'split'
                },

                // 平板设备分辨率：
                'tablet.ipad': {
                    'width': 768,
                    'height': 1024,
                    'touchDevice': true
                },
                'tablet.ipad.air': {
                    'width': 834,
                    'height': 1112,
                    'touchDevice': true
                },
                'tablet.ipad.pro': {
                    'width': 1024,
                    'height': 1366,
                    'touchDevice': true
                },
                'split2': {
                    type: 'split'
                },
                // 桌面分辨率：
                'desktop.hd.720p': {
                    'width': 1280,
                    'height': 720
                },
                'desktop.wxga': {
                    'width': 1366,
                    'height': 768
                },
                'desktop.fhd.1080p': {
                    'width': 1920,
                    'height': 1080
                },
                'desktop.qhd.1440p': {
                    'width': 2560,
                    'height': 1440
                },
                'desktop.4k.2160p': {
                    'width': 3840,
                    'height': 2160
                },
                'split3': {
                    type: 'split'
                },

                // 经典分辨率
                'classic.svga': {
                    'width': 800,
                    'height': 600
                },
                'classic.xga': {
                    'width': 1024,
                    'height': 768
                },
                'classic.sxga': {
                    'width': 1280,
                    'height': 1024
                }
            },

            'dropOffset': 10,
            // the fake one
            'resetCode': function () {
            },
            'events': {
                'onSelected': function (page, profile, ids) {
                    var v = _null, id = ids && ids[ids.length - 1];
                    if (id) {
                        var o = ood.getObject(id);
                        if (o)
                            v = o;
                    }
                    if (v && !v['ood.Module']) {
                        v = v.getModule(_true) || v;
                        // It's a control in Module
                        if (v['ood.Module'])
                            ids = [v.$xid];
                    }

                    page.listObject.setUIValue(v ? v.alias : "[page]", _true);

                    ood.resetRun('$profilegrid$', page._refreshProfileGrid, 0, [ids], page);

                    page.resizer.setLeftConfigBtn(_false);
                    page.resizer.setRightConfigBtn(_false);
                    if (ids && ids.length == 1) {
                        page.resizer.setRightConfigBtn(_true);
                        var prf = ood.getObject(ids[0]);
                        if (CONF.getClientMode() != 'singlepage' && CONF.hasSpecialConfig(prf)) {
                            page.resizer.setLeftConfigBtn(_true);
                        }
                        page.resizer.setRotatable(!ood.get(prf, ["box", "$Behaviors", "PanelKeys"]) && prf.properties.dock == 'none');
                    }
                    page.resizer.setTag(ids[0]);
                },
                'onReady': function (page) {
                    var tbk = '$RAD.designer.tool.',
                        tbk2 = '$(RAD.designer.tool.',
                        showRefresh = _true;

                    var canvas = new (page.paperCls)()
                        .setHost(page, "canvas")
                        .setLeft(0)
                        .setTop(0)
                        .setWidth(100)
                        .setHeight(100)
                        .setZIndex(20)
                        .setSpaceUnit('px')
                        .onContextmenu("_oncanvasmenu")
                        .setCustomStyle({"KEY": "background-color:transparent; overflow:hidden;"})
                        .setCustomClass({"KEY": "ood-desinger-canvas ood-designer-inner-control"})
                        .setDropKeys("___iDesign2");

                    canvas.get(0).$designerRoot = 1;

                    page.panelDivInner.append(canvas);

                    page.$canvasMenuItems = [
                        {
                            'id': 'undoredo',
                            'level': 1,
                            'maybecanvas': _true,
                            'sub': [
                                {
                                    'id': "undo",
                                    'type': "button",
                                    'iconColor': "#A968lid f4A",
                                    'imageClass': "ri-arrow-go-back-line",
                                    'tips': tbk + 'undo'
                                },
                                {
                                    'id': "redo",
                                    'type': "button",
                                    'iconColor': "#3D9354",
                                    'imageClass': "ri-arrow-go-forward-line",
                                    'tips': tbk + 'redo'
                                },
                                {
                                    'id': "refresh",

                                    'imageClass': showRefresh ? "ri ri-refresh-line" : "ri ri-forbid-line",
                                    'type': showRefresh ? "button" : "split",
                                    'tips': showRefresh ? (tbk + 'refresh') : _null
                                }
                            ]
                        }
                        ,
                        {
                            'id': 'debugpreview',
                            'hidden': !!page.$moduleInnerMode,
                            'level': 1,
                            'sub': [
                                {
                                    'hidden': !CONF.enable_preview ? true : !!page.$moduleInnerMode,
                                    'id': "preview",

                                    'imageClass': "ri ri-eye-line",
                                    'tips': "$RAD.JSEditor.Preview"
                                },
                                {
                                    'hidden': !CONF.enable_preview ? true : !!page.$moduleInnerMode,
                                    id: 'version',
                                    imageClass: "ri ri-checkbox-blank-circle-line",
                                    tips: '$RAD.esdmenu.version'
                                }

                            ]
                        },


                        {
                            'id': 'copyclone',
                            'hidden': !!page.$moduleInnerMode,
                            'level': 1,
                            'sub': [
                                {
                                    'id': 'copy',
                                    'caption': '',
                                    'imageClass': "ri ri-file-copy-line",
                                    'tips': tbk + 'copy'
                                },
                                {
                                    'id': 'clone',
                                    'caption': '',
                                    'imageClass': "ri ri-file-copy-fill",
                                    'tips': tbk + 'clone'
                                },
                                {'id': 'cut', 'caption': '', 'imageClass': "ri ri-scissors-line", 'tips': tbk + 'cut'},
                                {
                                    'id': 'delete',
                                    'caption': '',
                                    'imageClass': "ri ri-delete-bin-line",
                                    'tips': tbk + 'delete'
                                }
                            ]
                        },
                        {
                            'id': 'pastefun',
                            'hidden': !!page.$moduleInnerMode,
                            'maybecanvas': _true,
                            'level': 1,
                            'sub': [
                                {
                                    'id': 'paste',
                                    'iconColor': "#2F4056",
                                    'caption': '',
                                    'imageClass': "ri ri-clipboard-line",
                                    'tips': tbk + 'paste'
                                }
                            ]
                        },
                        {
                            'id': 'pos',
                            'level': 2,
                            'caption': tbk + 'posgroup',
                            'sub': [
                                {
                                    'id': 'zindex1',
                                    'caption': '',

                                    'imageClass': "ri ri-arrow-up-s-line",
                                    'tips': tbk + 'toplayer'
                                },
                                {
                                    'id': 'zindex2',
                                    'caption': '',

                                    'imageClass': "ri ri-arrow-down-s-line",
                                    'tips': tbk + 'bottomlayer'
                                },
                                {'id': 's1', 'type': 'split'},
                                {
                                    'id': 'order_up',
                                    'caption': '',

                                    'imageClass': "ri ri-arrow-up-line",
                                    'tips': 'Move up'
                                },
                                {
                                    'id': 'order_down',
                                    'caption': '',

                                    'imageClass': "ri ri-arrow-down-line",
                                    'tips': 'Move down'
                                },
                                {'id': 's1', 'type': 'split'},
                                {
                                    'id': 'repos',
                                    'caption': '',

                                    'imageClass': "ri ri-grid-line",
                                    'tips': tbk + 'gridxy'
                                },

                                {
                                    'id': 'resize',
                                    'caption': '',
                                    'imageClass': 'ri ri-cpu-line',
                                    'tips': tbk + 'gridwh'
                                }
                            ]
                        },
                        {
                            'id': 'aligngroup',
                            'level': 2,
                            'caption': tbk + 'aligngroup',
                            'sub': [
                                {
                                    'id': "align",
                                    'type': 'button',
                                    'dropButton': _true,
                                    'imageClass': "ri ri-align-left",
                                    'caption': '$RAD.JSEditor.Align',
                                    'tips': tbk + 'aligngroup'
                                }
                            ]
                        },
                        // SVG路径编辑工具栏图标替换
                        {
                            'id': 'svgpath',
                            'level': 1,
                            'sub': [
                                {
                                    'id': "pathedit",
                                    'caption': '',
                                    'iconColor': "#3273A7",
                                    'svg': _true,
                                    "imageClass": 'ri-pencil-line'
                                },
                                {
                                    'id': "hmirror",
                                    'caption': '',
                                    'iconColor': "#179F50",
                                    'svg': _true,
                                    "imageClass": 'ri-arrow-left-right-line'
                                },
                                {
                                    'id': "vmirror",
                                    'caption': '',
                                    'iconColor': "#179F50",
                                    'svg': _true,
                                    "imageClass": 'ri-arrow-up-down-line'
                                },
                                {
                                    'id': "r90",
                                    'caption': '',
                                    'iconColor': "#78B0E4",
                                    'svg': _true,
                                    "imageClass": 'ri-refresh-line'
                                },
                                {
                                    'id': "r270",
                                    'caption': '',
                                    'iconColor': "#78B0E4",
                                    'svg': _true,
                                    "imageClass": 'ri-refresh-line'
                                },
                                {
                                    'id': "freeze",
                                    'caption': '',
                                    'iconColor': "#213243",
                                    'svg': _true,
                                    "imageClass": 'ri-arrow-go-back-line'
                                }
                            ]
                        }];

                    ood.arr.each(SPA.componentMenuItems, function (o) {
                        page.$canvasMenuItems.push({
                            id: 'componentmenu', sub: [o]
                        });
                    })


                    if (!page.$moduleInnerMode && CONF.enable_codeEdtor) {
                        page.$canvasMenuItems.unshift({
                            'id': 'tocode',
                            'level': 1,
                            'maybecanvas': _true,
                            'sub': [
                                {
                                    "id": "tocode",
                                    "caption": "$RAD.JSEditor.to$RAD.JSEditor.sv",
                                    "imageClass": 'ri ri-code-line',
                                    "tips": "$RAD.JSEditor.svtips"
                                }
                            ]
                        });
                        if (!page.$moduleInnerMode) {
                            page.$canvasMenuItems.push({
                                'id': 'codegroup',
                                'level': 1,
                                'maybecanvas': _true,
                                'tips': '$RAD.JSEditor.Data',
                                'sub': [{
                                    'id': "datacode",
                                    'caption': '$RAD.JSEditor.Data',
                                    'type': "button",
                                    'dropButton': _true,
                                    'imageClass': 'ri ri-database-2-line',
                                    'tips': tbk + 'Data'
                                }
                                ]
                            });
                        }

                        // if (CONF.getClientMode() != 'project') {
                        page.$canvasMenuItems.push({
                            'id': 'view',
                            'level': 1,
                            'maybecanvas': _true,
                            'sub': [{
                                'id': "viewsize",
                                'type': 'button',
                                'iconColor': "#689BE2",
                                'dropButton': _true,
                                "imageClass": 'ri-fullscreen-line',
                                'caption': '800 × 600',
                                'tips': tbk + 'viewsize'
                            },
                                {
                                    'id': 'mobile',
                                    'type': "button",
                                    'iconColor': "#02d9c6",
                                    'statusButton': _true,
                                    'imageClass': "ri-smartphone-line",
                                    'tips': tbk + 'mobile'
                                }]
                        });
                        //  }
                    }
                    var aa = page.$canvasMenuItems1 = [];
                    ood.each(page.$viewSize, function (o, i) {
                        if (!ood.str.startWith(i, 'split')) {
                            // aa.push({'id': i, 'caption': o.width + " &#215 " + o.height, 'viewsize': _true});
                            aa.push({'id': i, 'caption': i, 'viewsize': _true});
                        } else {
                            aa.push({type: 'split'});
                        }

                    });
                    ood.arr.stableSort(aa, function (x, y) {
                        return x.id > y.id ? 1 : x.id == y.id ? 0 : -1;
                    });
                    // ood.arr.each(aa, function (o, i) {
                    //     if (page.$viewSize[o.id].width > page.$viewSize[o.id].height) {
                    //         ood.arr.insertAny(aa, {'type': 'split'}, i);
                    //         return _false;
                    //     }
                    // });

                    page.popViewSize.setItems(page.$canvasMenuItems1);

                    page.popAlign.setItems(page.$canvasMenuItems5 = [
                        {
                            'align': 1,
                            'id': 'left',
                            'caption': tbk + 'left',
                            'imageClass': "ri ri-align-left",
                            'tips': tbk + 'left'
                        },
                        {
                            'align': 1,
                            'id': 'center',
                            'caption': tbk + 'center',
                            'imageClass': "ri ri-align-center",
                            'tips': tbk + 'center'
                        },
                        {
                            'align': 1,
                            'id': 'right',
                            'caption': tbk + 'right',
                            'imageClass': "ri ri-align-right",
                            'tips': tbk + 'right'
                        },
                        {'align': 1, 'id': 's1', 'type': 'split'},
                        {
                            'align': 1,
                            'id': 'top',
                            'caption': tbk + 'top',
                            'imageClass': "ri ri-align-top",
                            'tips': tbk + 'top'
                        },
                        {
                            'align': 1,
                            'id': 'middle',
                            'caption': tbk + 'middle',
                            'imageClass': "ri ri-align-vertically",
                            'tips': tbk + 'middle'
                        },
                        {
                            'align': 1,
                            'id': 'bottom',
                            'caption': tbk + 'bottom',
                            'imageClass': "ri ri-align-bottom",
                            'tips': tbk + 'bottom'
                        },
                        {'align': 1, 'id': 's2', 'type': 'split'},
                        {
                            'align': 1,
                            'id': 'w',
                            'caption': tbk + 'width',
                            'imageClass': "ri ri-arrow-left-right-line",
                            'tips': tbk + 'width'
                        },
                        {
                            'align': 1,
                            'id': 'wh',
                            'caption': tbk + 'wh',
                            'imageClass': "ri ri-fullscreen-line",
                            'tips': tbk + 'wh'
                        },
                        {
                            'align': 1,
                            'id': 'h',
                            'caption': tbk + 'height',
                            'imageClass': "ri ri-arrow-up-down-line",
                            'tips': tbk + 'height'
                        }
                    ]);
                    page.popData.setItems(page.$canvasMenuItems4 = [{
                        'data': 1,
                        'id': "jscode",
                        'imageClass': 'ri ri-file-code-line',
                        'type': "button",
                        'caption': tbk + 'tocode',
                        'tips': tbk + 'tocode'
                    }, {
                        'data': 1,
                        'id': "json",
                        'imageClass': 'ri ri-code-line',
                        'type': "button",
                        'caption': tbk + 'tojson',
                        'tips': tbk + 'tojson'
                    }, {'id': "split_2", 'type': "split"}, {
                        'data': 1,
                        'id': "prfs",
                        //  'imageClass': 'ri ri-equalizer-line',
                        'type': "button",
                        'caption': tbk2 + 'Profile Map)'
                    }, {
                        'data': 1,
                        'id': "data",
                        'imageClass': 'ri ri-database-2-line',
                        'type': "button",
                        'caption': tbk2 + 'Data Map)'
                    }, {
                        'data': 1,
                        'id': "value",
                        'imageClass': 'ri ri-key-2-line',
                        'type': "button",
                        'caption': tbk2 + 'Value Map)'
                    }
                    ]);

                    page.$canvasMenuItems.push({
                        'id': 'inter',
                        'level': 1,
                        'sub': [
                            {
                                "id": "intermap",
                                "caption": "$(RAD.builder.Interaction Map)",
                                "imageClass": 'ri ri-3d-box-line'
                            }
                        ]
                    });

                    page.toolbar.setItems(page.$canvasMenuItems);

                    if (typeof CONF.customDesingerOnReady == 'function') {
                        CONF.customDesingerOnReady(page);
                    }
                },
                'onRender': function (page) {
                    var _refresh = page._refresh = function (obj, key, offregion, region, resetResizer) {
                        obj = typeof(obj) == "string" ? page.getByAlias(obj) : obj['ood.absObj'] ? obj : obj.boxing();
                        if (!obj) return;
                        var profile = obj.get(0),
                            fn = 'set' + ood.str.initial(key),
                            fn2 = 'get' + ood.str.initial(key),
                            t, oldregion;

                        if (fn == 'setBBox') fn = '_' + fn;
                        if (fn2 == 'getBBox') fn2 = '_' + fn2;

                        if (ood.isFun(obj[fn])) {
                            if (obj['ood.svg']) {
                                if (profile.renderId) {
                                    oldregion = obj._getBBox();
                                    if (key == 'bBox') {
                                        t = region;
                                    } else {
                                        t = region[key];
                                    }
                                } else {
                                    t = obj[fn2]();
                                }
                            } else {
                                if (profile.renderId) {
                                    if (offregion && (key in offregion))
                                        obj.getRoot()[key + 'By'](offregion[key], _true);
                                    else if (region && (key in region))
                                        obj.getRoot()[key](region[key], _true);
                                    t = ood.CSS.$px(profile.getRoot().css(key), profile.getRoot(), _true) || 0;
                                } else
                                    t = profile.properties[key];
                            }
                            obj[fn](t);
                        }

                        var v = obj[fn2]();

                        if (resetResizer !== _false && (ood.UI.$ps[key] || key === 'bBox')) {
                            var needreset, svg = !!obj['ood.svg'];
                            if (svg) {
                                needreset = region && (
                                    (('x' in region) ? Math.round(region.x) !== Math.round(oldregion.x) : 0) ||
                                    (('y' in region) ? Math.round(region.y) !== Math.round(oldregion.y) : 0) ||
                                    (('width' in region) ? Math.round(region.width) !== Math.round(oldregion.width) : 0) ||
                                    (('height' in region) ? Math.round(region.height) !== Math.round(oldregion.height) : 0)
                                );
                            } else {
                                t = ood.CSS.$px(profile.getRoot().css(key), profile.getRoot(), _true) || 0;
                                needreset = t != ood.CSS.$px(v, profile.getRoot(), _true) || 0;
                            }
                            if (needreset) {
                                // if in selected, refresh
                                if ((t = profile.parent) && t.reSelectObject && page.tempSelected && ood.arr.indexOf(page.tempSelected, profile.$xid) != -1) {
                                    ood.resetRun(":" + page.tempSelected.join(':'), function () {
                                        if (!profile.box) return;
                                        var pn = profile.getRoot().parent();
                                        if (page.tempSelected.length > 1)
                                            t.reSelectObject.call(t, profile, pn, _true);
                                        else
                                            t.selectObject.call(t, profile, pn);
                                    });
                                }
                            }
                        }
                        return v;
                    };
                    //**** we must have this id for theme base font-size
                    page.$canvasXid = page.canvas.getRoot().xid();

                    //div for hold resizer and proxy
                    page.holder = ood.create('<div style="display:none;"></div>');
                    //not append
                    page.panelDiv.reBoxing().append(page.holder);
                    //resizer
                    page._createHandler();
                    page._createResizer();

                    //focus
                    page.focusBtn = ood.create('<a href="javascript;" style="position:absolute;left:-10000px;top:-10000px;width:1px;height:1px;">o</a>');
                    page.focusBtn.onKeydown(function (pro, e) {
                        if (!page.resizer) return;

                        var key = ood.Event.getKey(e),
                            k = key.key;
                        if (k == "up" || k == "down" || k == "left" || k == "right") {
                            if (page.resizer.get(0).isModule) return _false;
                        }

                        var ctrl = key.ctrlKey,
                            shift = key.shiftKey,
                            step = 1,
                            o = page.resizer.reBoxing(),
                            profile = page.resizer.get(0),
                            off = profile._target.get(0) ? profile._target.parent().offset(_null, page.panelDiv.getRoot()) : _null,
                            cssPos = o.cssPos(),
                            cssSize = o.cssSize(),
                            region = {
                                'left': cssPos.left - parseInt(off && off.left, 10),
                                'top': cssPos.top - parseInt(off && off.top, 10),
                                'width': cssSize.width,
                                'height': cssSize.height
                            },
                            gridh = profile.properties.dragArgs.heightIncrement,
                            gridw = profile.properties.dragArgs.widthIncrement
                        ;

                        var t, b = _false, size = _null, pos = _null;

                        switch (k) {
                            case 'up':
                                b = _true;
                                if (ctrl)
                                    step = -1;
                                else {
                                    if (shift)
                                        step = (t = (Math.round(region.top) + Math.round(cssSize.height)) % gridh) ? -t : -gridh;
                                    else
                                        step = (t = Math.round(region.top) % gridh) ? -t : -gridh;
                                }
                                if (shift) {
                                    o.heightBy(step);
                                    profile.regions.heightBy(step);
                                    size = {width: 0, height: step};
                                    region.height += step;
                                } else {
                                    o.topBy(step);
                                    pos = {'left': 0, 'top': step};
                                    region.top += step;
                                }
                                break;
                            case 'down':
                                b = _true;
                                if (ctrl)
                                    step = 1;
                                else {
                                    if (shift)
                                        step = (t = (Math.round(region.top) + Math.round(cssSize.height)) % gridh) ? gridh - t : gridh;
                                    else
                                        step = (t = Math.round(region.top) % gridh) ? gridh - t : gridh;
                                }
                                if (shift) {
                                    o.heightBy(step);
                                    profile.regions.heightBy(step);
                                    size = {'width': 0, 'height': step};
                                    region.height += step;
                                } else {
                                    o.topBy(step);
                                    pos = {'left': 0, 'top': step};
                                    region.top += step;
                                }
                                break;
                            case 'left':
                                b = _true;
                                if (ctrl)
                                    step = -1;
                                else {
                                    if (shift)
                                        step = (t = (Math.round(region.left) + Math.round(cssSize.width)) % gridw) ? -t : -gridw;
                                    else
                                        step = (t = Math.round(region.left) % gridw) ? -t : -gridw;
                                }
                                if (shift) {
                                    profile.regions.widthBy(step);
                                    o.widthBy(step);
                                    size = {'width': step, 'height': _null};
                                    region.width += step;
                                } else {
                                    o.leftBy(step);
                                    pos = {'left': step, 'top': 0};
                                    region.left += step;
                                }
                                break;
                            case 'right':
                                b = _true;
                                if (ctrl)
                                    step = 1;
                                else {
                                    if (shift)
                                        step = (t = (Math.round(region.left) + Math.round(cssSize.width)) % gridw) ? gridw - t : gridw;
                                    else
                                        step = (t = Math.round(region.left) % gridw) ? gridw - t : gridw;
                                }
                                if (shift) {
                                    o.widthBy(step);
                                    profile.regions.widthBy(step);
                                    size = {'width': step, 'height': _null};
                                    region.width += step;
                                } else {
                                    o.leftBy(step);
                                    pos = {'left': step, 'top': 0};
                                    region.left += step;
                                }
                                break;
                            case 'delete':
                                page._deleteSelected();
                                page._focus();
                                break;
                            case 'esc':
                                if (page.tempSelected && page.tempSelected.length) {
                                    page._clearSelect();
                                    //reset
                                    page._setSelected([], _true);
                                    // stop the about dialog
                                    return _false;
                                }
                        }

                        if (b) {
                            profile.boxing().onUpdate(profile, profile._target, size, pos);
                            return _false;
                        }
                    })
                        .onKeypress(function (pro, e) {
                            if (!page.resizer) return;
                            if (page.$moduleInnerMode) return;

                            var key = ood.Event.getKey(e),
                                k = key.key,
                                ctrl = key.ctrlKey,
                                shift = key.shiftKey,
                                alt = key.altKey;
                            if (ctrl) {
                                switch (k) {
                                    case 'c':
                                        var sel = page.tempSelected;
                                        if (sel && sel.length > 0) {
                                            if (alt) {
                                                page._toolbaraction({'id': 'clone'}, {'id': 'copyclone'});
                                            } else {
                                                page._toolbaraction({'id': 'copy'}, {'id': 'copyclone'});
                                            }
                                        }
                                        break;
                                    case 'x':
                                        var sel = page.tempSelected;
                                        if (sel && sel.length > 0) {
                                            page._toolbaraction({'id': 'cut'}, {'id': 'copyclone'});
                                        }
                                        break;
                                    case 'v':
                                        if (getSPA().__copied) {
                                            var sel = page.tempSelected, ctrl;
                                            if (!sel || sel.length == 0 || (sel.length === 1 && (ctrl = page.getByCacheId(sel)) && ctrl.get(0) && ctrl.get(0).boxing().getDropKeys)) {
                                                page._toolbaraction({'id': 'paste'}, {'id': 'pastefun'});
                                            }
                                        }
                                        break;
                                    case 'a':
                                        return _false;
                                    case 's':
                                        page.saveDesign();
                                        return _false;
                                        break;
                                }
                            }
                        }).onFocus(function (pro, e) {
                        page.resizer.active(_false);
                    }).onBlur(function (pro, e) {
                        if (page.resizer && page.tempSelected && page.tempSelected.length) {
                            page.resizer.inActive();
                            ood.Event.keyboardHook('esc', 0, 0, 0, function () {
                                page._clearSelect();
                                //reset
                                page._setSelected([], _true);
                                page._focus();
                                return false;
                            }, 'ood-designer-' + page.$xid);
                        }
                    });
                    page.layoutBase.reBoxing().prepend(page.focusBtn);

                    page._giveHandler(page.canvas.get(0), _true);
                    page._enablePanelDesign(page.canvas.get(0));

                    if (typeof CONF.customDesingerOnRender == 'function') {
                        CONF.customDesingerOnRender(page);
                    }
                },
                'onDestroy': function (page) {
                    page._resetHistory(_true);
                    if (page.frame && page.frame.destroy)
                        page.frame.destroy(_true, _true);
                }
            },

            'toInterMap': function () {
                var page = this;
                page._clearSelect();
                page._setSelected([], _true);

                ood.getModule('RAD.InteractionMap', function (prf) {
                    this.refreshInterMap(page);
                    this.show();
                });
            },
            'getByAlias': function (alias, returnPrf) {
                if (alias === "canvas") return returnPrf ? this.canvas.get(0) : this.canvas;
                var o = this.$host[alias];
                if (o) {
                    return returnPrf ? o.get(0) : o;
                }
                return o;

            },
            'isDirty': function () {
                return !!this._dirty || !!this._canvaseventdirty || !!this._desingviewdirty || !!this._styledirty;
            },
            '$tryToRefreshSel': function (profile) {
                var page = this, t;
                if ((t = profile.parent) && t.reSelectObject && page.tempSelected && ood.arr.indexOf(page.tempSelected, profile.$xid) != -1) {
                    ood.resetRun(":" + page.tempSelected.join(':'), function () {
                        if (!profile.box || !profile.getRootNode()) return;
                        if (page.tempSelected.length > 1)
                            t.reSelectObject.call(t, profile, profile.getRoot().parent(), _true);
                        else
                            t.selectObject.call(t, profile, profile.getRoot().parent());

                        // refresh prop grid for the refersh one
                        // page._refreshProfileGrid(page.tempSelected, _false, _true);
                    });
                }
            },
            'resetCodeFromDesigner': function (sync) {
                var page = this;
                if (CONF.getClientMode() != 'project' || true) {
                    if (page._desingviewdirty) {
                        var hash = page.$curViewSize,
                            cc = page.panelDivInner.get(0).CC;
                        hash.touchDevice = !!(cc && cc.KEY && cc.KEY.indexOf("phonestyle") != -1);
                        page.resetCode("Static", "designViewConf", page.stringify(hash, '        '), !!sync);
                        page._desingviewdirty = _false;
                    }
                    if (page._styledirty) {
                        var hash = {}, v;
                        ood.arr.each(["zoom", "theme", "background-color", "background-image", "background-repeat", "background-position", "background-attachment"], function (k, v) {
                            v = ood.get(page._cls, ["Static", "viewStyles", k]);
                            if (v) hash[k] = v;
                        });
                        page.resetCode("Static", "viewStyles", page.stringify(hash, '        '), !!sync);
                        page._styledirty = _false;
                    }
                }
                if (page._canvaseventdirty) {
                    var evs = ood.get(page._cls, ["Instance", "events"]);
                    var code = evs ? page.stringify(evs) : "{}";
                    code = code.replace(/\n/g, '\n' + ood.str.repeat(' ', 8));
                    page.resetCode("Instance", "events", code, !!sync);
                }

                if (page._dirty) {
                    var nodes = page.getWidgets(_true);
                    // reset iniComponents code
                    var code = ('{\n' + page.getJSCode(nodes)).replace(/\n/g, '\n' + ood.str.repeat(' ', 12))
                        + '\n' + ood.str.repeat(' ', 8) + '}';
                    page.resetCode("Instance", "iniComponents", code, !!sync, _true);

                    page.clearDirty();
                    return code;
                }
            },
            _bldTips: function (o, tail, simple) {
                if (o.moduleClass && o.moduleXid) {
                    o = ood.Module.getFromDom(o.getDomId())
                    if (!o["ood.Module"])
                        return;
                }

                if (!simple) {
                    //var code = this.getJSCode([o], null,null,true).replace(/[\n\r]/,'');

                    var code = o.serialize(false);
                    if (code.children) code.children = "( " + code.children.length + "... )"
                    code = ood.Coder.formatText(ood.stringify(code, function (o, i, b) {
                            if (i == 'events') {
                                b.push('"events":' +
                                    ood.stringify(o, function (v, i, bb) {
                                        bb.push('"' + i + '":"' + (ood.isArr(v) ? ('[' + v.length + (v.length <= 1 ? ' action]' : ' actions]')) : v) + '"');
                                        return false;
                                    }));
                                return false;
                            }
                        })
                    );
                    code = code.replace(/[\n\r]+/g, '<br/>').replace(/ /g, '&nbsp;');
                }
                return "<div>" +
                    "<div class='ood-uiborder-b' style='padding:4px 0'>&lt;" + o.key + " : " + o.alias + "></div>" +
                    (simple ? "" : "<div class='ood-uiborder-b ood-ui-ellipsis' style='padding:4px 0; max-width:50em'>" + code + "</div>") +
                    (tail ? ("<div style='text-align:right;padding:4px 0'><em>" + tail + "</em></div>") : "") +
                    "</div>";
            },
            _bldTips2: function (head, tail) {
                return tail ? ("<div class='ood-uiborder-b' style='padding:4px 0'>&lt;" + head + "></div>" + "<div style='text-align:right;padding:4px 0'><em>" + tail + "</em></div>") : "";
            },
            '_inplaceedit': function (prf, nodeKey, multi, conf, node, left, top, w, h) {
                var page = this,
                    ismulti = !!conf[0],
                    getF = conf[1],
                    setF = conf[2],
                    itemKey = conf[3],
                    multiLine = conf[4] || prf.properties.multiLines,
                    customEditor = conf[5],
                    advEditor = conf[6],
                    item, escSubKey = prf.key + ":" + prf.$xid;
                if (advEditor) {
                    page._clearSelect();
                    page._setSelected([], _true);
                    advEditor(page, prf, node, left, top, w, h);
                    return;
                }
                var unFun = function (setV) {
                    if (!inplaceEditor || !inplaceEditor.getSubNode('INPUT'))
                        return;
                    inplaceEditor.getSubNode('INPUT').onBlur();

                    inplaceEditor.setVisibility('hidden').setLeft(-1000).setValue('', _true);
                    ood.Event.keyboardHook('esc', 0, 0, 0, escSubKey);
                };

                if (!page.$inplaceEditor || page.$inplaceEditor.isDestroyed()) {
                    page.$inplaceEditor = new ood.UI.ComboInput({
                        'type': 'none',
                        'dirtyMark': _false,
                        'visibility': 'hidden'
                    }, {
                        'onHotKeydown': function (p, kb) {
                            if (kb.key == 'tab' || (kb.key == 'enter' && !p.properties.multiLines)) {
                                unFun();
                                return _false;
                            }
                        }
                    });
                    page.panelDiv.append(page.$inplaceEditor);
                    page.$inplaceEditor.render(_true);
                    page.$inplaceEditor.getRoot().beforeMousedown(function (p, e) {
                    });
                }
                var inplaceEditor = page.$inplaceEditor;
                // to set the caption/label
                inplaceEditor.afterUIValueSet(function (p, ov, nv) {
                    var alias = prf.alias;

                    item = ood.clone(item, _true);

                    var action = function (vv) {
                        if (ismulti) {
                            if (typeof setF == 'function')
                                setF(page.getByAlias(alias, _true), item, itemKey, vv);
                            else {
                                var options = {};
                                options[itemKey || "caption"] = vv;
                                page.getByAlias(alias)[setF](item.id, options);
                            }
                        } else {
                            if (typeof setF == 'function')
                                setF(page.getByAlias(alias, _true), vv);
                            else
                                page.getByAlias(alias)[setF](vv);
                        }
                    };
                    action(nv);
                    // undo-redo : hot modify caption
                    page.markDirty(function () {
                        action(ov);
                    }, function () {
                        action(nv);
                    }, "set label");

                    // if single selected, refresh grid data
                    if (page.tempSelected && page.tempSelected.length == 1 && prf.parent && prf.parent.selectObject)
                        prf.parent.selectObject.call(prf.parent, prf, prf.getRoot().parent());

                });

                var oldV;
                if (ismulti) {
                    if (typeof getF == 'function')
                        item = getF(prf, node.get(0));
                    else
                        item = prf.boxing()[getF](node.get(0).$xid);
                    if (item) {
                        oldV = item[itemKey || "caption"] || "";
                    } else
                        return;
                } else {
                    if (typeof getF == 'function')
                        oldV = getF(prf, node.get(0));
                    else
                        oldV = prf.boxing()[getF]();
                }

                inplaceEditor.setMultiLines(!!multiLine);
                inplaceEditor.setResizer(_true);

                // init
                inplaceEditor.setValue(oldV, _true);
                // ensure on the top
                inplaceEditor.setZIndex(ood.Dom.TOP_ZINDEX + 10);
                inplaceEditor.setLeft(left - 1).setTop(top - 1).setWidth(w < 102 ? 102 : (w + 2)).setHeight(multiLine ? (h < 52 ? 52 : (h + 2)) : (h < 20 ? 20 : (h + 2)));

                if (customEditor) {
                    customEditor(inplaceEditor, prf, page);
                }

                ood.asyRun(function () {
                    // to hide
                    inplaceEditor.getRoot().setBlurTrigger(escSubKey, unFun);
                    ood.Event.keyboardHook('esc', 0, 0, 0, function () {
                        inplaceEditor.setValue(oldV, _true);
                        unFun();
                        page._focus();
                        return false;
                    }, escSubKey);
                });

                // show
                inplaceEditor.setVisibility('visible').activate();
            },
            '_onIconlistMenu': function (profile, e, src) {
                var item;
                if (item = profile.getItemByDom(src)) {
                    profile.boxing().setUIValue(item.id, _true);
                }
                this._showPopMenu(e);
                return _false;
            },
            '_showPopMenu': function (e, flag) {
                var page = this,
                    toolbaritems = page.toolbar.getItems(),
                    popMenu,
                    items = [];
                ood.arr.each(toolbaritems, function (item, i) {
                    if (item.hidden) return;
                    if (item.deprecated) return;

                    if (flag && !item.maybecanvas)
                        return;

                    if (item.id == 'codegroup') {
                        items.push({
                            'id': item.id,
                            'caption': item.tips,
                            'sub': page.$canvasMenuItems4
                        });
                        return;
                    } else if (item.id == 'pastefun') {
                        if (!getSPA().__copied) {
                            return;
                        }
                        var sel = page.tempSelected, ctrl;
                        if (!sel || sel.length == 0 || (sel.length === 1 && (ctrl = page.getByCacheId(sel)) && ctrl.get(0) && ctrl.get(0).boxing().getDropKeys)) {
                        } else {
                            return;
                        }
                    }

                    if (item.level == 1 && i !== 0 && items.length > 0) {
                        items.push({'type': 'split'});
                    }

                    if (item.level == 1) {
                        ood.arr.each(item.sub, function (subitem) {
                            if (subitem.hidden)
                                return;
                            if (subitem.id == 'viewsize') {
                                items.push({
                                    'id': item.id,
                                    'caption': subitem.tips,
                                    'sub': page.$canvasMenuItems1
                                });
                            } else if (subitem.type == 'split') {
                                items.push({'type': 'split'});
                            } else {
                                // to filter undo/redo
                                if (subitem.tips) {
                                    items.push({
                                        'id': subitem.id,
                                        'image': subitem.image,
                                        'imagePos': subitem.imagePos,
                                        'imageClass': subitem.imageClass,
                                        'caption': subitem.tips
                                    });
                                }
                            }
                        });
                    } else {
                        var sub = [];
                        ood.arr.each(item.sub, function (subitem) {
                            if (subitem.hidden)
                                return;
                            if (subitem.id == 'viewsize') {
                                sub.push({
                                    'id': item.id,
                                    'caption': 'xxxxxxxxxx',
                                    'image': subitem.image,
                                    'imagePos': subitem.imagePos,
                                    'imageClass': subitem.imageClass,
                                    'sub': page.$canvasMenuItems1
                                });
                            } else if (subitem.type == 'split') {
                                sub.push({'type': 'split'});
                            } else if (subitem.id == 'aligngroup') {
                                sub = _null;
                            } else if (subitem.id == 'align') {
                                items.push({
                                    'id': item.id,
                                    'caption': subitem.tips,
                                    'sub': page.$canvasMenuItems5
                                });
                            } else {
                                sub.push({
                                    'id': subitem.id,
                                    'image': subitem.image,
                                    'imagePos': subitem.imagePos,
                                    'imageClass': subitem.imageClass,
                                    'caption': subitem.tips
                                });
                            }
                        });
                        if (sub && sub.length) {
                            items.push({
                                'id': item.id,
                                'caption': item.caption,
                                'sub': sub
                            });
                        }
                    }
                });

                popMenu = new ood.UI.PopMenu({
                    '_maxheight': 400,
                    'items': items
                }, {
                    'onHide': function (p) {
                        p.boxing().destroy(_true, _true);
                    }, 'onMenuSelected': function (p, item) {
                        if (item.viewsize)
                            page.popViewSize.fireItemClickEvent(item.id);
                        else if (item.align)
                            page.popAlign.fireItemClickEvent(item.id);
                        else if (item.data)
                            page.popData.fireItemClickEvent(item.id);
                        else
                            page.toolbar.fireItemClickEvent(item.id);
                    }
                });

                popMenu.pop(ood.Event.getPos(e));
            },
            '_oncanvasmenu': function (profile, e, src) {
                if (ood.Event.getSrc(e) == this.canvas.getRootNode()) {
                    this._showPopMenu(e, _true);
                    return _false;
                }
            },
            '_createHandler': function () {
                var page = this;
                //proxy region
                page.proxy = ood.create('<div style="position:absolute;border:dashed 1px blue;overflow:visible;left:-100px;top:-100px;z-index:1000"></div>');
                page.proxy.get(0).zIndexIgnore = _true;
                page.holder.append(page.proxy);
            },
            '_editSVGPath': function (t) {
                var page = this,
                    alias = t.alias, isDDDirty;
                var callback = function (target, event, etype, el, key, index) {
                    if (etype == "contextmenu") {
                        if (key == "main" || key == "path1" || key == "path2") {
                            switch (el.type) {
                                case 'path':
                                    var tbk = '$RAD.designer.tool.',
                                        items = [
                                            {
                                                'id': "delpath",
                                                'caption': tbk + 'delpath',
                                                'svg': _true,
                                                "imageClass": 'ri ri-subtract-line'
                                            },
                                            {
                                                'id': "addpath",
                                                'caption': tbk + 'addpath',
                                                'svg': _true,
                                                "imageClass": 'ri ri-add-circle-line'
                                            }
                                        ], opath, path;
                                    if (index === 0) items.shift();

                                    path = el.getPath();
                                    opath = path.join('');

                                    if (typeof(path) == "string")
                                        path = Raphael.parsePathString(path);

                                    if (path[path.length - 1][0] == "Z") {
                                        items.push({
                                            'id': "openpath",
                                            'caption': tbk + 'openpath',
                                            'svg': _true,
                                            "imageClass": 'ri ri-scissors-cut-line'
                                        });
                                    } else {
                                        items.push({
                                            'id': "closepath",
                                            'caption': tbk + 'closepath',
                                            'svg': _true,
                                            "imageClass": 'ri ri-link'
                                        });
                                    }

                                    var menu = new ood.UI.PopMenu({
                                        'items': items
                                    }, {
                                        'onMenuSelected': function (prf, item) {
                                            switch (item.id) {
                                                case 'addpath':
                                                    var pnode = ood.copy(path[index === 0 ? 1 : index]);
                                                    ood.arr.each(pnode, function (o, i) {
                                                        if (ood.isNumb(o)) {
                                                            pnode[i] = o + 10;
                                                        }
                                                    });

                                                    ood.arr.insertAny(path, pnode, index + 1, _true);
                                                    break;
                                                case 'delpath':
                                                    ood.arr.removeFrom(path, index);
                                                    break;
                                                case 'openpath':
                                                    ood.arr.removeFrom(path, path.length - 1);
                                                    break;
                                                case 'closepath':
                                                    path.push(["Z"]);
                                                    break;
                                            }
                                            var redo = function () {
                                                page.getByAlias(alias).setAttr("KEY", {'path': path.join('')}, _false, _true);
                                            };
                                            redo();
                                            t.boxing()._addHandler(callback, CONF.SVGHandlerType);

                                            // undo-redo : modify svg path by pop menu
                                            page.markDirty(function () {
                                                page.getByAlias(alias).setAttr("KEY", {'path': opath}, _false, _true);
                                            }, redo, "set svg path");
                                        }
                                    });
                                    menu.pop(ood.Event.getPos(event));
                                    break;
                            }
                        }
                    } else if (etype == "beforedragstart") {
                        isDDDirty = _false;
                        var ctl = page.getByAlias(alias);
                        // temp use
                        page._oattr = ood.clone(ctl.getAttr());
                        if (ctl.constructor._CONNECTOR) {
                            page._oconnect = {
                                'fromObj': ctl.getFromObj(),
                                'fromPoint': ctl.getFromPoint(),
                                'toObj': ctl.getToObj(),
                                'toPoint': ctl.getToPoint()
                            };
                        }
                    } else if (etype == "drag") {
                        isDDDirty = _true;
                    } else if (etype == "beforedragend") {
                        // for undo
                        if (isDDDirty) {
                            var ctl = page.getByAlias(alias),
                                attr = ood.clone(ctl.getAttr()),
                                connect,
                                oattr = ood.clone(page._oattr),
                                oconnect = page._oconnect;
                            delete page._oattr;
                            delete page._oconnect;

                            if (ctl.constructor._CONNECTOR) {
                                connect = {
                                    'fromObj': ctl.getFromObj(),
                                    'fromPoint': ctl.getFromPoint(),
                                    'toObj': ctl.getToObj(),
                                    'toPoint': ctl.getToPoint()
                                };
                            }
                            // undo-redo : modify svg path by handler
                            page.markDirty(function () {
                                var ctl = page.getByAlias(alias);
                                if (ctl.constructor._CONNECTOR && oconnect) {
                                    ctl.setProperties(oconnect, _null, _true);
                                }
                                ctl.setAttr(oattr, _null, _true, _true);
                            }, function () {
                                if (ctl.constructor._CONNECTOR && connect) {
                                    ctl.setProperties(connect, _null, _true);
                                }
                                page.getByAlias(alias).setAttr(attr, _null, _true, _true);
                            }, "set svg path");
                        }
                    }
                };

                t.boxing()._addHandler(callback, CONF.SVGHandlerType);

                // if has handler
                if (t._pathHandler) {
                    //                page._clearSelect();
                    //                page._setSelected([], _true);
                    page.withPathHandler = t.boxing();
                    page._detatchResizer();
                }
            },
            '_createResizer': function () {
                var page = this;

                //resizer
                page.resizer = ood.create('AdvResizer', {
                    'forceMovable': _false,
                    'minWidth': 2,
                    'minHeight': 2,
                    'rotatable': _true,
                    'dragArgs': {
                        'widthIncrement': this.dropOffset,
                        'heightIncrement': this.dropOffset
                    },
                    'zIndex': ood.Dom.TOP_ZINDEX
                }, {
                    'onConfig': function (profile, e, src, pos, type) {
                        if (type !== "click") return _false;
                        var prf = ood.getObject(profile.properties.tag);
                        if (prf) {
                            if (pos == "right") {
                                if (prf.box['ood.UI.FusionChartsXT'] && !FCCONF.attrCat[prf.properties.chartType]) {
                                    var tg = page.profileGrid;
                                    if (tg)
                                        tg.getSubNodeInGrid("CELLA", "properties:JSONData", "value").onClick(_true);
                                    // } else if (prf.box['ood.UI.ECharts'] && !FCCONF.attrCat[prf.properties.chartType]) {
                                    //     var tg = page.profileGrid;
                                    //     if (tg)
                                    //         tg.getSubNodeInGrid("CELLA", "properties:chartOption", "value").onClick(_true);
                                } else {
                                    page._decorationWnd(prf, page.resizer);
                                }
                            } else if (pos == "left") {
                                if (prf.key == "ood.svg.image" || prf.box.SINGLE_NODE_IMAGE) {
                                    ood.ModuleFactory.getCom('RAD.ImageSelector', function () {
                                        this.setProperties({
                                            'fromRegion': src,
                                            'onOK': function (obj, path) {
                                                prf.boxing().setAttr("KEY", {"src": CONF.adjustRelativePath(path)}, _false, _true);
                                            }
                                        });
                                        this.show();
                                    });
                                } else {
                                    var tg = page.profileGrid, profile = tg.get(0);
                                    if (tg) {
                                        var cell = tg.getCellbyRowCol("properties:src", "value");
                                        if (cell && cell.event) {
                                            tg.editCellbyRowCol("properties:src", "value");
                                            tg.getEditor().expand();
                                        }
                                    }
                                }
                            }
                        }
                    },
                    'onContextmenu': function (profile, e, src) {
                        this._showPopMenu(e);
                        return _false;
                    }
                });
                page.resizer.get(0).tagcls = "ood-designer-inner-control";
                page.resizer.setHost(page)
                    .onShowTips(function (profile, node, pos) {
                        //if(page.$moduleInnerMode)return;
                        var ids = [], frist;
                        ood.arr.each(page.tempSelected, function (o, i) {
                            o = ood.getObject(o);
                            if (i === 0) frist = o;
                            o = (o['ood.Module'] ? o : o.getModule(_true)) || o;
                            if (o['ood.Module']) {
                                ids = [o.alias];
                                return _false;
                            } else {
                                ids.push(o.alias);
                            }
                        });
                        var ex = page.$moduleInnerMode ? "" : CONF.enable_codeEdtor ? ("$(RAD.designer.Dblclick to edit the code)</em></div>") : "";
                        if (ids.length == 1)
                            ood.Tips.show(pos, page._bldTips(frist, ex));
                        else
                            ood.Tips.show(pos, "<div class='ood-uiborder-b' style='padding:4px;white-space:normal'>&lt;" + ids.join("> &lt;") + "></div><div style='text-align:right'><em>" + ex);
                        return _false;
                    })
                    .onItemsSelected(function (profile, ids) {
                        ood.filter(ids, function (id) {
                            var prf = ood.getObject(id);
                            if (!(prf instanceof ood.UIProfile)) return _false;
                            if (prf.box.$initRootHidden) return _false;
                        });
                        if (this.pProfile) this.pProfile.setSelectFromResizer.call(this.pProfile, ids);

                        page.resizer.setReadonly(_false);
                        profile.isModule = 0;
                        if (ids && ids.length) {
                            var obj = ood.getObject(ids[0]),
                                m = obj.getModule(_true);
                            if (m) {
                                page.resizer.setReadonly(_true);
                                profile.isModule = 1;
                            }
                        }
                    })
                    .onResetTarget(function (profile, ids) {
                        if (ids && ids.length == 1) {
                            var prf = ood.getObject(ids[0]);
                            if (prf.box["ood.svg"] && prf.box._CONNECTOR) {
                                page._editSVGPath(prf);
                            }
                        }
                        page.resizer.setReadonly(_false);
                        profile.isModule = 0;
                        if (ids && ids.length) {
                            var obj = ood.getObject(ids[0]),
                                m = obj.getModule(_true);
                            if (m) {
                                page.resizer.setReadonly(_true);
                                profile.isModule = 1;
                            }
                        }
                    })
                    .onActive(function (profile) {
                        ood.clearTimeout(this.timer);
                        this._focus();
                    })
                    // here, size/cssPos is offset value
                    .onUpdate(function (profile, target, size, cssPos, rotate) {
                        if (profile.isModule) return _false;
                        var hash = {
                            'left': 1,
                            'top': 1,
                            'bottom': 1,
                            'right': 1,
                            'width': 1,
                            'height': 1,
                            'rotate': 1,
                            'position': 1,
                            'tabindex': 1,
                            'z-index': 1,
                            'visibility': 1,
                            'display': 1,
                            'dock': 1,
                            'tips': 1
                        };
                        var self = this;
                        if (target) {
                            var b = _false, action, redoA = [], undoA = [];

                            target.each(function (target) {
                                target = ood([target]);
                                var profile = ood.UIProfile.getFromDom(target.get(0).id),
                                    widget = profile.boxing(),
                                    p = profile.properties, t,
                                    dock = p.position == 'absolute' ? p.dock : 'none',
                                    m = profile.box.$DataModel;

                                // cant move locked
                                if (profile.locked) {
                                    b = _true;
                                    return;
                                }
                                if ((t = profile.properties) && t.locked) {
                                    b = _true;
                                    return;
                                }

                                var alias = profile.alias, conChildren = (
                                    (profile.properties.position == 'relative' || profile.properties.position == 'static')
                                    && (ood.get(profile, ['parent', 'properties', 'conDockRelative']) || ood.get(profile, ['parent', 'properties', 'conLayoutColumns']))
                                );
                                if (widget['ood.svg']) {
                                    var oregion = widget._getBBox(),
                                        region = {};
                                    if (size) {
                                        if (!conChildren) region.width = Math.max(0, oregion.width + size.width || 0);
                                        region.height = Math.max(0, oregion.height + size.height || 0);
                                    }
                                    if (cssPos) {
                                        if (!conChildren && cssPos.left) region.x = oregion.x + cssPos.left;
                                        if (!conChildren && cssPos.top) region.y = oregion.y + cssPos.top;
                                    }
                                    page._refresh(alias, 'bBox', _null, region);

                                    redoA.push(function () {
                                        page._refresh(alias, 'bBox', _null, region, _false);
                                    });
                                    undoA.push(function () {
                                        page._refresh(alias, 'bBox', _null, oregion, _false);
                                    });
                                } else {
                                    if (size) {
                                        var w = _null, h = _null;
                                        if (size.width) {
                                            if (p && !m.width) {
                                                b = _true;
                                            } else {
                                                switch (dock) {
                                                    case 'top':
                                                    case 'bottom':
                                                    case 'fill':
                                                    case 'cover':
                                                    case 'width':
                                                        b = _true;
                                                        break;
                                                    case 'left':
                                                    case 'right':
                                                    case 'height':
                                                        b = _true;
                                                    default:
                                                        if (!conChildren) {
                                                            w = page._refresh(alias, 'width', size);

                                                            redoA.push(function () {
                                                                return page._refresh(alias, 'width', size, _null, _false);
                                                            });
                                                            undoA.push(function () {
                                                                page._refresh(alias, 'width', {'width': -size.width}, _null, _false);
                                                            });
                                                        } else {
                                                            page.resizer.rePosSize();
                                                        }
                                                }
                                            }
                                        }
                                        if (size.height) {
                                            if (p && !m.height) {
                                                b = _true;
                                            } else {
                                                switch (dock) {
                                                    case 'left':
                                                    case 'right':
                                                    case 'fill':
                                                    case 'cover':
                                                    case 'height':
                                                        b = _true;
                                                        break;
                                                    case 'top':
                                                    case 'bottom':
                                                    case 'width':
                                                        b = _true;
                                                    default:
                                                        h = page._refresh(alias, 'height', size);
                                                        redoA.push(function () {
                                                            page._refresh(alias, 'height', size, _null, _false);
                                                        });
                                                        undoA.push(function () {
                                                            page._refresh(alias, 'height', {'height': -size.height}, _null, _false);
                                                        });
                                                }
                                            }
                                        }

                                        self._sizeUpdated(target, {'width': w, 'height': h});
                                        ood.UI.$tryResize(profile, w, h, _null, _true);
                                    }
                                    if (cssPos) {
                                        var x = _null, y = _null;
                                        if (cssPos.left) {
                                            if (p && !m.left) {
                                                b = _true;
                                            } else {
                                                switch (dock) {
                                                    case 'top':
                                                    case 'bottom':
                                                    case 'left':
                                                    case 'right':
                                                    case 'fill':
                                                    case 'cover':
                                                    case 'width':
                                                        b = _true;
                                                        break;
                                                    case 'height':
                                                        b = _true;
                                                    default:
                                                        if (!conChildren) {
                                                            x = page._refresh(alias, 'left', cssPos);
                                                            redoA.push(function () {
                                                                return page._refresh(alias, 'left', cssPos, _null, _false);
                                                            });
                                                            undoA.push(function () {
                                                                page._refresh(alias, 'left', {'left': -cssPos.left}, _null, _false);
                                                            });
                                                        } else {
                                                            page.resizer.rePosSize();
                                                        }
                                                }
                                            }
                                        }
                                        if (cssPos.top) {
                                            if (p && !m.top) {
                                                b = _true;
                                            } else {
                                                switch (dock) {
                                                    case 'left':
                                                    case 'right':
                                                    case 'top':
                                                    case 'bottom':
                                                    case 'fill':
                                                    case 'cover':
                                                    case 'height':
                                                        b = _true;
                                                        break;
                                                    case 'width':
                                                        b = _true;
                                                    default:
                                                        if (!conChildren) {
                                                            y = page._refresh(alias, 'top', cssPos);
                                                            redoA.push(function () {
                                                                return page._refresh(alias, 'top', cssPos, _null, _false);
                                                            });
                                                            undoA.push(function () {
                                                                page._refresh(alias, 'top', {'top': -cssPos.top}, _null, _false);
                                                            });
                                                        } else {
                                                            page.resizer.rePosSize();
                                                        }
                                                }
                                            }
                                        }
                                        self._posUpdated(target, {'left': x, 'top': y});
                                    }
                                }

                                if (ood.isDefined(rotate)) {
                                    var oldr = page._refresh(alias, 'rotate', _null, {'rotate': rotate});
                                    redoA.push(function () {
                                        return page._refresh(alias, 'rotate', _null, {'rotate': rotate}, _false);
                                    });
                                    undoA.push(function () {
                                        page._refresh(alias, 'rotate', _null, {'rotate': oldr}, _false);
                                    });
                                    self._rotateUpdated(target, rotate);
                                }

                            });

                            if (b) profile.boxing().rePosSize();
                        }

                        // undo-redo : modify pos/size by resizer
                        page.markDirty(function () {
                            ood.arr.each(undoA, function (f) {
                                ood.tryF(f);
                            });
                        }, function () {
                            ood.arr.each(redoA, function (f) {
                                ood.tryF(f);
                            });
                        }, "set controls' " + (size ? "size" : "position"));

                        return _false;
                    })
                    .onFocusChange(function (profile, index) {
                        if (profile.isModule) return;

                        if (this.tempSelected) {
                            this.SelectedFocus = index;
                            ood.resetRun('$profilegrid$', this._refreshProfileGrid, 0, [this.tempSelected], this);

                            this.resizer.setLeftConfigBtn(_false);
                            this.resizer.setRightConfigBtn(_false);
                            if (this.tempSelected && this.tempSelected.length == 1) {
                                this.resizer.setRightConfigBtn(_true);
                                var prf = ood.getObject(this.tempSelected[0]);
                                if (CONF.getClientMode() != 'singlepage' && (prf.key == "ood.UI.Image" || prf.key == "ood.svg.image" || prf.box.SINGLE_NODE_IMAGE || prf.key == "ood.UI.Flash" || prf.key == "ood.UI.Audio" || prf.key == "ood.UI.Video")) {
                                    this.resizer.setLeftConfigBtn(_true);
                                }
                            }

                            this.resizer.setTag(this.tempSelected[0]);
                        }
                    })
                    .onDblclick(function (profile, e, src) {
                        if (!this.$moduleInnerMode && CONF.enable_codeEdtor) {
                            var arr = this.tempSelected;
                            if (arr && arr.length) {
                                var o = ood.getObject(arr[0]);
                                o = target = (o['ood.Module'] ? o : o.getModule(_true)) || o;
                                page.resetTaskList();
                                // if dirty
                                if (page._dirty)
                                    page.resetCodeFromDesigner();

                                page.addTask(function () {
                                    page.searchInEditor(".setHost(host,\"" + o.alias + "\"");
                                });
                                page.__dblclickctrl = _true;
                                ood.asyRun(function () {
                                    page.__dblclickctrl = _false;
                                });
                                page.startTaskList();
                            }
                        } else if (typeof CONF.designer_ctrldblclick == 'function') {
                            var arr = this.tempSelected,
                                prf;
                            if (arr && arr.length)
                                prf = ood.getObject(arr[0]);
                            page.__dblclickctrl = _true;
                            ood.asyRun(function () {
                                page.__dblclickctrl = _false;
                            });
                            CONF.designer_ctrldblclick(page, prf, e, src);
                        }
                    })
                    //select children even if parent is selected
                    .onRegionClick(function (profile, e) {
                        if (profile.isModule) return;

                        var ep = ood.Event.getPos(e), arr, t, m, ret;
                        var tryinplaceedit = function (prf, nodeKey, multi, conf, node, root, epoff, ppos, rgw, rgh, subId) {
                            if (node && !node.isEmpty()) {
                                if (prf.box['ood.svg']) {
                                    var paper = prf.boxing().getPaper(), rnode;
                                    if (paper && (rnode = paper.getById(node.get(0).raphaelid))) {
                                        var bbox = rnode._getBBox();
                                        if (!('x2' in bbox)) bbox.x2 = bbox.x + bbox.width;
                                        if (!('y2' in bbox)) bbox.y2 = bbox.y + bbox.height;

                                        // MUST IN THE TEXT REGION
                                        if (epoff.left > bbox.x && epoff.top > bbox.y && epoff.left < bbox.x2 && epoff.top < bbox.y2) {
                                            ood.asyRun(function () {
                                                page._inplaceedit(prf, nodeKey, multi, conf, node, ppos.left + bbox.x, ppos.top + bbox.y, bbox.width + 20, bbox.height);
                                            }, 200);
                                            return _true;
                                        }
                                    }
                                } else {
                                    var pos = node.offset(_null, root),
                                        w = node.offsetWidth(),
                                        h = node.offsetHeight();

                                    if (epoff.left > pos.left && epoff.top > pos.top && epoff.left < pos.left + w && epoff.top < pos.top + h &&
                                        epoff.left < rgw && epoff.top < rgh) {

                                        ood.asyRun(function () {
                                            if (!node.get(0) || !node.get(0).offsetWidth)
                                                return;
                                            page._inplaceedit(prf, nodeKey, multi, conf, node, ppos.left + pos.left, ppos.top + pos.top, w, h);
                                        }, 200);

                                        return _true;
                                    }
                                }
                            }
                            return _false;
                        };
                        var fun0 = function (ep, prf) {
                                var root = prf.getRoot(),
                                    epoff = {},
                                    ppos = root.offset();
                                epoff.left = ep.left - ppos.left;
                                epoff.top = ep.top - ppos.top;

                                var set0 = prf._paper.getElementsByPoint(epoff.left, epoff.top);
                                for (var i = 0, l = set0.length; i < l; i++) {
                                    if (!set0[i]._decoration) {
                                        page._clearSelect();
                                        page._setSelected([], _true);
                                        rt = ood.UIProfile.getFromDom(set0[i].node).$xid;
                                        return rt;
                                    }
                                }
                            },
                            fun1 = function (ep, prf) {
                                var conf = CONF.inplaceedit && CONF.inplaceedit[prf.key],
                                    root, nodes, node;
                                if (!ood.isHash(conf))
                                    return _false;
                                for (var nodeKey in conf) {
                                    var item = conf[nodeKey],
                                        ismulti = !!item[0];
                                    if (prf.box['ood.svg']) {
                                        var root = prf.parent.getRoot(),
                                            //mouse abs pos offset
                                            epoff = {},
                                            //parent abs pos
                                            ppos = root.offset(),
                                            inpos = root.offset(_null, page.panelDiv.getRoot()),
                                            //parent size
                                            rgw = root.offsetWidth(),
                                            rgh = root.offsetHeight();
                                        epoff.left = ep.left - ppos.left;
                                        epoff.top = ep.top - ppos.top;

                                        // multi
                                        if (ismulti) {
                                            var nodes = prf.getSubNode(nodeKey, _true).get(),
                                                node;
                                            for (var i = 0, l = nodes.length; i < l; i++) {
                                                node = nodes[i];
                                                if (node.id) {
                                                    var subId = prf.getSubId(node.id);
                                                    if (tryinplaceedit(prf, nodeKey, 1, item, ood([node.$xid]), root, epoff, inpos, rgw, rgh, subId))
                                                        return _true;
                                                }
                                            }
                                        }
                                        // single
                                        else {
                                            if (tryinplaceedit(prf, nodeKey, 0, item, prf.getSubNode(nodeKey), root, epoff, inpos, rgw, rgh, subId))
                                                return _true;
                                        }
                                    } else {
                                        var root = prf.getRoot(),
                                            //mouse abs pos offset
                                            epoff = {},
                                            //parent abs pos
                                            ppos = root.offset(),
                                            inpos = root.offset(_null, page.panelDiv.getRoot()),
                                            //parent size
                                            rgw = root.offsetWidth(),
                                            rgh = root.offsetHeight();
                                        epoff.left = ep.left - ppos.left;
                                        epoff.top = ep.top - ppos.top;

                                        // multi
                                        if (ismulti) {
                                            var nodes = prf.getSubNode(nodeKey, _true).get(),
                                                node;
                                            for (var i = 0, l = nodes.length; i < l; i++) {
                                                node = nodes[i];
                                                if (node.id) {
                                                    var subId = prf.getSubId(node.id);
                                                    if (tryinplaceedit(prf, nodeKey, 1, item, ood([node.$xid]), root, epoff, inpos, rgw, rgh, subId))
                                                        return _true;
                                                }
                                            }
                                        }
                                        // single
                                        else {
                                            if (tryinplaceedit(prf, nodeKey, 0, item, prf.getSubNode(nodeKey), root, epoff, inpos, rgw, rgh, subId))
                                                return _true;
                                        }
                                    }
                                }
                                return _false;
                            },
                            moduleFun = function (arr, ep, parent) {
                                var me = arguments.callee,
                                    m, rt, pos, w, h,
                                    //mouse abs pos offset
                                    epoff = {},
                                    //parent abs pos
                                    ppos = parent.offset(),
                                    //parent size
                                    rgw = parent.offsetWidth(),
                                    rgh = parent.offsetHeight()
                                ;
                                epoff.left = ep.left - ppos.left;
                                epoff.top = ep.top - ppos.top;

                                ood.arr.each(arr, function (o) {
                                    if (!(m = o[0].getRoot()).isEmpty()) {
                                        if ((o[0].children).length)
                                            if (rt = me(o[0].children, ep, m))
                                                return _false;
                                        if (m.css('display') == 'none') return;
                                        if (m.css('visibility') == 'hidden') return;
                                        // here, must use dom's  offsetHeight || offsetWidth prop
                                        if (m.get(0).offsetHeight === 0) return;
                                        if (m.get(0).offsetWidth === 0) return;
                                        pos = m.offset(_null, parent);
                                        w = m.offsetWidth();
                                        h = m.offsetHeight();
                                        if (epoff.left > pos.left && epoff.top > pos.top && epoff.left < pos.left + w && epoff.top < pos.top + h &&
                                            epoff.left < rgw && epoff.top < rgh) {
                                            rt = o[0].$xid;
                                            return _false;
                                        }
                                    }
                                });
                                return rt;
                            };
                        if (!(arr = this.tempSelected) || !arr.length) return;
                        ood.arr.each(arr, function (o) {
                            var t = ood.getObject(o);
                            if (t.key == "ood.UI.SVGPaper") {
                                ret = fun0(ep, t);
                                if (ret) return _false;
                            }

                            // 1. to check whether select a child or not
                            ret = moduleFun(t.children, ep, t.getRoot());
                            if (ret) return _false;

                            // 2. to check whether to in-place edit label/caption or not
                            ret = fun1(ep, t);
                            if (ret) return _false;

                            /* only menu can edit path
                        // SVG path handler
                        if(arr.length===1){
                            if(t.box['ood.svg']){
                                page._editSVGPath(t);
                            }
                        }
                        */
                            if (ret) return _false;
                        });
                        if (ret) {
                            // to select a child
                            if (ret !== _true) {
                                this.selectWidget([ret]);
                                return _false;
                            }
                        }
                    });

                //use only one resizer
                page.resizer.setOffsetParent(page.panelDiv.getRootNode());
                page.holder.append(page.resizer);
            },
            '_showAnimEditor': function (target, callback, nointeraction) {
                var page = this;
                ood.showModule("RAD.AnimationConf", function (module) {
                    module.setProperties({"frames": target.properties["frames"]});
                    module.setEvents({
                        "onchange": callback
                    });
                });
            },
            '_showAPIEditor': function (api, callback, nointeraction) {
                var page = this;
                ood.showModule("RAD.APIConfig", function (module) {

                    module.setDataToEditor(api, page.$host, page._cls);
                    module.setEvents({
                        "onchange": callback
                    });
                });
            },
            '_showExpressionEditor': function (oldExpression, callback, nointeraction) {
                var page = this;
                ood.showModule("RAD.expression.SimpleExpressionEditor", function (module) {
                    module.setDataToEditor(page.$host, page._cls, oldExpression);
                    module.setEvents({
                        "onchange": callback
                    });
                });
            },

            '_decorationWnd': function (prf, parent, key, gdprf, cell, nointeraction) {
                var page = this, undo, redo, alias = prf.alias;
                if (key == 'expression') {

                } else if (key == 'effects') {
                    var show = ood.clone(prf.properties.showEffects, _true),
                        hide = ood.clone(prf.properties.hideEffects, _true);
                    undo = function () {
                        page.getByAlias(alias).setShowEffects(ood.clone(show, _true), _true)
                            .setHideEffects(ood.clone(hide, _true), _true);
                    };
                } else if (prf.box['ood.svg']) {
                    var attr = ood.clone(prf.boxing().getAttr(), _true);
                    undo = function () {
                        page.getByAlias(alias).setAttr(ood.clone(attr, _true), _null, _true, _true);
                    };
                } else if (prf.box['ood.UI.FusionChartsXT']) {
                    var data = ood.clone(prf.boxing().getJSONData(), _true);
                    undo = function () {
                        page.getByAlias(alias).setJSONData(ood.clone(data, _true), _true);
                    };
                    // } else if (prf.box['ood.UI.ECharts']) {
                    //     var data = ood.clone(prf.boxing().getChartOption(), _true);
                    //     undo = function () {
                    //         page.getByAlias(alias).setChartOption(ood.clone(data, _true), _true);
                    //     };
                } else if (prf.box['ood.UI.CSSBox']) {
                    var nstyle = ood.clone(prf.properties.normalStatus, _true),
                        hstyle = ood.clone(prf.properties.hoverStatus, _true),
                        astyle = ood.clone(prf.properties.activeStatus, _true),
                        fstyle = ood.clone(prf.properties.focusStatus, _true);
                    undo = function () {
                        page.getByAlias(alias).setNormalStatus(ood.clone(nstyle, _true), _true)
                            .setHoverStatus(ood.clone(hstyle, _true), _true)
                            .setActiveStatus(ood.clone(astyle, _true), _true)
                            .setFocusStatus(ood.clone(fstyle, _true), _true);
                    };
                } else if (prf.box['ood.Module']) {
                    var prop = prf.properties,
                        //use original one
                        _iniProfSet = (new (ood.SC(prf.KEY))()).getProfile(),
                        _oldProfSet = ood.clone(prop.__inner_coms_prf__);
                    undo = function () {
                        prf.setProfile(_oldProfSet);

                        if (ood.isEmpty(_oldProfSet)) {
                            delete prop.__inner_coms_prf__;
                        } else {
                            prop.__inner_coms_prf__ = _oldProfSet;
                        }
                    };
                } else {
                    var cls = ood.clone(prf.CC, _true),
                        style = ood.clone(prf.CS, _true);
                    undo = function () {
                        page.getByAlias(alias).setCustomClass(ood.clone(cls, _true), _true).setCustomStyle(ood.clone(style, _true), _true);
                    };
                }

                ood.ModuleFactory.getCom(
                    key == "effects" ? "RAD.CustomEffects" :
                        prf.box['ood.svg'] ? 'RAD.SVGCustomDecoration' :
                            prf.box['ood.UI.FusionChartsXT'] ? 'RAD.ChartCustomSetting' :
                                // prf.box['ood.UI.ECharts'] ? 'RAD.EChartSetting' :
                                prf.box['ood.UI.CSSBox'] ? 'RAD.CustomDecoration2' :
                                    prf.box['ood.Module'] ? 'RAD.ModuleDesigner' :
                                        'RAD.CustomDecoration', function () {
                        this.setProperties({
                            'targetProfile': prf,
                            'src': parent,
                            'page': page
                        });
                        var changed = _false;
                        this.setEvents({
                            'onFinished': function (result, helper) {
                                if (!changed) return;
                                if (key == "effects") {
                                    var show = ood.clone(prf.properties.showEffects, _true),
                                        hide = ood.clone(prf.properties.hideEffects, _true);
                                    redo = function () {
                                        page.getByAlias(alias).setShowEffects(ood.clone(show, _true), _true)
                                            .setHideEffects(ood.clone(hide, _true), _true);
                                    };
                                    if (gdprf)
                                        gdprf.boxing().updateCell(cell, {
                                            '_ext': {
                                                'showEffects': show,
                                                'hideEffects': hide
                                            }
                                        }, _false, _true);
                                } else if (prf.box['ood.svg']) {
                                    var attr = ood.clone(prf.boxing().getAttr(), _true);
                                    redo = function () {
                                        page.getByAlias(alias).setAttr(ood.clone(attr, _true), _null, _true, _true);
                                    };
                                    if (gdprf)
                                        gdprf.boxing().updateCell(cell, {'_ext': {'attr': attr}}, _false, _true);
                                } else if (prf.box['ood.UI.FusionChartsXT']) {
                                    var data = ood.clone(prf.boxing().getJSONData(), _true);
                                    redo = function () {
                                        page.getByAlias(alias).setJSONData(ood.clone(data, _true), _true);
                                    };
                                    if (gdprf)
                                        gdprf.boxing().updateCell(cell, {'_ext': {'JSONData': data}}, _false, _true);
                                    // } else if (prf.box['ood.UI.ECharts']) {
                                    //     var data = ood.clone(prf.boxing().getChartOption(), _true);
                                    //     redo = function () {
                                    //         page.getByAlias(alias).setChartOption(ood.clone(data, _true), _true);
                                    //     };
                                    if (gdprf)

                                        gdprf.boxing().updateCell(cell, {'_ext': {'chartOption': data}}, _false, _true);
                                } else if (prf.box['ood.UI.CSSBox']) {
                                    var nstyle = ood.clone(prf.properties.normalStatus, _true),
                                        hstyle = ood.clone(prf.properties.hoverStatus, _true),
                                        astyle = ood.clone(prf.properties.activeStatus, _true),
                                        fstyle = ood.clone(prf.properties.focusStatus, _true);
                                    redo = function () {
                                        page.getByAlias(alias).setNormalStatus(ood.clone(nstyle, _true), _true)
                                            .setHoverStatus(ood.clone(hstyle, _true), _true)
                                            .setActiveStatus(ood.clone(astyle, _true), _true)
                                            .setFocusStatus(ood.clone(fstyle, _true), _true);
                                    };
                                    if (gdprf)
                                        gdprf.boxing().updateCell(cell, {
                                            '_ext': {
                                                'normalStatus': nstyle,
                                                'hoverStatus': hstyle,
                                                'activeStatus': astyle,
                                                'focusStatus': fstyle
                                            }
                                        }, _false, _true);
                                } else if (prf.box['ood.Module']) {
                                    var prop = prf.properties,
                                        prfSet = {};
                                    ood.each(result, function (o, i) {
                                        var h = {},
                                            nprop = o.properties || {},
                                            iprop = _iniProfSet[i].properties || {};
                                        for (var j in nprop) {
                                            if (!ood.compareVar(nprop[j], iprop[j])) h[j] = nprop[j];
                                        }
                                        // if set to default
                                        for (var j in iprop) {
                                            // if it's module, set to _null
                                            if (!(j in h)) {
                                                if (!ood.compareVar(nprop[j], iprop[j])) {
                                                    var t = ood.get(helper[i], ['box', '$DataStruct', j]);
                                                    h[j] = ood.isSet(t) ? t : _null;
                                                }
                                            }
                                        }

                                        if (!ood.isEmpty(h)) {
                                            prfSet[i] = {'properties': h};
                                        }
                                    });

                                    redo = function () {
                                        prf.setProfile(prfSet);

                                        if (ood.isEmpty(prfSet)) {
                                            delete prop.__inner_coms_prf__;
                                        } else {
                                            prop.__inner_coms_prf__ = prfSet;
                                        }
                                    };
                                    redo();
                                } else {
                                    var cls = ood.clone(prf.CC, _true),
                                        style = ood.clone(prf.CS, _true);
                                    redo = function () {
                                        page.getByAlias(alias).setCustomClass(ood.clone(cls, _true), _true).setCustomStyle(ood.clone(style, _true), _true);
                                    };
                                    if (gdprf)
                                        gdprf.boxing().updateCell(cell, {
                                            '_ext': {
                                                'CC': cls,
                                                'CS': style
                                            }
                                        }, _false, _true);
                                }
                                // undo-redo : modify CS/CC by configure window; modify svg attr by configure window; modify FusionchartXT's JSONData by configure window
                                if (!nointeraction)
                                    page.markDirty(undo, redo, "set " + (prf.box['ood.svg'] ? "svg attr" : prf.box['ood.UI.FusionChartsXT'] ? "chart configuration" : "custom CSS"));
                            },
                            'onDirty': function (resel) {
                                changed = _true;
                                if (!nointeraction)
                                    if (resel) {
                                        var pn = prf.getRoot().parent();
                                        if (prf.parent && page.tempSelected.length == 1)
                                            prf.parent.reSelectObject.call(prf.parent, prf, pn, _true);
                                    }
                            }
                        });
                        this.show();
                    }, _null, !prf.box['ood.Module']);
            },
            //dettach resizer and proxy from panel
            '_detatchResizer': function () {
                var page = this;
                if (page.resizer.get(0)) page.holder.append(page.resizer);
                if (page.proxy.get(0)) page.holder.append(page.proxy);
                //clear those cache
                page.pProfile = page.pNode = _null;

                // unbind scroll event
                page._parentOffset && page._parentOffset.afterScroll(_null, 'ood-designer-resizer-off');
            },
            //append resizer and proxy to panel
            '_attachResizer': function (profile, node) {
                var page = this,
                    root = page.panelDiv.getRoot(),
                    rootN = root.get(0),
                    t;
                page.proxy.css('display', 'none');

                if (!page.proxy || !page.proxy.get(0)) {
                    // sometimes, resizer and proxy will be removed, we have to create them again
                    page._createHandler();
                }
                page._clearSelect();

                page.resizer.resetTarget(_null, _false);
                root.append(page.resizer);

                // bind scroll event
                if (t = ood(node).get(0)) {
                    ood(node).append(page.proxy);
                    var arr = [];
                    do {
                        if (t !== rootN) {
                            arr.push(t);
                        }
                    } while (t = t.offsetParent);

                    if (arr.length) {
                        page._parentOffset = ood(arr);
                        page._parentOffset.afterScroll(function () {
                            ood.resetRun('ood-designer-resizer-off', function () {
                                page && page.resizer && page.resizer.rePosSize();
                            });
                        }, 'ood-designer-resizer-off');
                    }
                }

                //set markable var
                page.pProfile = profile;
                page.pNode = ood(node);
                ood.merge(page.resizer.get(0).properties.dragArgs, {
                    'widthIncrement': page.dropOffset,
                    'heightIncrement': page.dropOffset
                }, 'all');
            },
            //give focus
            '_focus': function () {
                //avoid focus trigger scroll
                //            this.focusBtn.top(this.panelDiv.reBoxing().scrollTop())
                //            .left(this.panelDiv.reBoxing().scrollLeft());
                var page = this;
                ood.asyRun(function () {
                    page.focusBtn.focus(true)
                });
            },
            '_setSelected': function (ids, flag) {
                var page = this,
                    tb = page.toolbar,
                    osel = page.tempSelected,
                    t, toshow, isModule;

                ids = ood.isArr(ids) ? ids : [];
                page.tempSelected = ids;
                page.SelectedFocus = ids.length - 1;

                if (ids.length) {
                    var prf = ood.getObject(ids[0]);
                    if (prf) isModule = prf.getModule();
                }

                tb.showGroup('aligngroup', isModule ? _false : ids.length > 1);

                if (ids.length == 1 && (t = ood.getObject(ids[0]))) {
                    toshow = !!(t.box['ood.UI'] && !t.box.$initRootHidden);
                    tb.showGroup('pos', isModule ? _false : toshow);
                } else {
                    tb.showGroup('pos', _false);
                }

                if (!page.$moduleInnerMode) {
                    tb.showGroup('copyclone', ids.length > 0 ? _true : _false);
                }

                tb.showGroup('svgpath', _false);
                if (ids.length == 1) {
                    var svgPrf = ood.getObject(ids[0]);
                    if (svgPrf && svgPrf.box["ood.svg"] && svgPrf._elset[0].type == "path") {
                        tb.showGroup('svgpath', _true);
                    }
                    if (svgPrf && svgPrf.box["ood.svg"]) {
                        tb.updateItem('order_up', {disabled: true});
                        tb.updateItem('order_down', {disabled: true});
                    } else {
                        tb.updateItem('order_up', {disabled: false});
                        tb.updateItem('order_down', {disabled: false});
                    }
                }

                var showPasteBtn = _false;
                if (getSPA().__copied) {
                    var ctrl;
                    showPasteBtn = !ids || ids.length === 0 || (ids.length === 1 && (ctrl = page.getByCacheId(ids)) && ctrl.get(0) && ctrl.get(0).boxing().getDropKeys);
                }
                tb.showGroup('pastefun', !!showPasteBtn);

                // fire event
                if (flag) page.fireEvent("onSelected", [page, page.pProfile, ids], page.parent);

                page._focus();

                if (ids.length == 1) {
                    var prf = ood.getObject(ids[0]);
                    if (prf && prf.$onSelectedInDesign) {
                        prf.$onSelectedInDesign(page);
                    }
                } else if (osel && osel.length == 1 && !ids.length) {
                    var prf = ood.getObject(osel[0]);
                    if (prf && prf.$onUnSelectedInDesign) {
                        prf.$onUnSelectedInDesign(page);
                    }
                }
                return page;
            },
            '_sizeUpdated': function (pro, size) {
                var t, self = this;
                if (!(t = self.profileGrid.get(0).$widget)) return;
                if (ood.UIProfile.getFromDom(pro.get(0).id) == t.get(t._nodes.length - 1)) {
                    if (size.width !== _null)
                        self.profileGrid.updateCellByRowCol('properties:width', 'value', {'value': size.width});
                    if (size.height !== _null)
                        self.profileGrid.updateCellByRowCol('properties:height', 'value', {'value': size.height});
                }
            },
            '_posUpdated': function (pro, cssPos) {
                var t, self = this;
                if (!(t = self.profileGrid.get(0).$widget)) return;
                if (ood.UIProfile.getFromDom(pro.get(0).id) == t.get(t._nodes.length - 1)) {
                    if (cssPos.left !== _null)
                        self.profileGrid.updateCellByRowCol('properties:left', 'value', {'value': cssPos.left});
                    if (cssPos.top !== _null)
                        self.profileGrid.updateCellByRowCol('properties:top', 'value', {'value': cssPos.top});
                }
            },
            '_rotateUpdated': function (pro, rotate) {
                var t, self = this;
                if (!(t = self.profileGrid.get(0).$widget)) return;
                if (ood.UIProfile.getFromDom(pro.get(0).id) == t.get(t._nodes.length - 1)) {
                    self.profileGrid.updateCellByRowCol('properties:rotate', 'value', rotate);
                }
            },
            'parseFun': function (txt) {
                var str = txt;
                var reg = new RegExp("^(\\s*\\/\\*[^*@]*\\*+([^\\/][^*]*\\*+)*\\/\\s*)|^(\\s*\\/\\/[^\\n]*\\s*)");
                while (reg.test(str)) {
                    str = str.replace(reg, '');
                }
                str = str.replace(/\s*/, '');
                if (!str) return {'comments': _null, 'code': _null};

                if (_false === this.check(str.replace(/\s*$/, ''))) return _false;

                return {'comments': '\n' + txt.replace(str, ''), 'code': str.replace(/\s*$/, '')};
            },
            '_designable': function (profile) {
                var page = this;
                // only one layer module
                if (profile['ood.Module']) {
                    page._mdlDesignable(profile);
                } else {
                    page._uiDesignable(profile);
                }
            },
            '_mdlDesignable': function (profile, innerModule) {
                var page = this;

                profile.$inDesign = page.$canvasXid;
                if (!innerModule) {
                    profile.boxing().setHost(page.$host, profile.alias);

                    profile.$refreshTrigger = function (profile) {
                        page._designable(profile);
                    };
                    profile.$panelRestore = function (subprf) {
                        page._designable(subprf);
                    };
                }
                var moduleHash = {}, t, z;
                moduleHash[profile.KEY + "[" + profile.$xid + "]"] = 1;
                // set all ui children in deep, ignore module
                profile.getAllComponents().each(function (v) {
                    // **** keep same 1
                    v.$inDesign = page.$canvasXid;
                    if (v['ood.UIProfile']) {
                        var t;
                        if (t = ood.get(getSPA(), ["curProjectConfig", "$DevEnv", "SpaceUnit"])) {
                            profile._spaceUnit = t;
                        }
                        v._showTips = function (prf, n, pos) {
                            var tips = page._bldTips(prf, 'in design mode', true);
                            if (tips) {
                                ood.Tips.show(pos, tips);
                                return false;
                            }
                        }
                        // add a special class
                        v.tagcls = "ood-designer-inner-control";
                        if (v.rendered) {
                            v.getAllNodes().addClass(v.tagcls);
                        }

                        // cover default value
                        {
                            var df4 = ood.UI.__resetDftProp_in_Desinger,
                                df5 = v.box.__resetDftProp_in_Desinger,
                                dm = v.box.$DataModel;
                            for (var i in dm) {
                                if (v.properties[i] === (dm[i] && ('ini' in dm[i]) ? dm[i].ini : "")) {
                                    if (df5 && (i in df5)) {
                                        v.properties[i] = df5[i];
                                    } else if (df4 && (i in df4)) {
                                        v.properties[i] = df4[i];
                                    }
                                }
                            }
                        }
                        // must before rendered
                        v.theme = v.theme || ood.get(CONF, ["WidgetDftTheme", v.key]);
                        page._giveHandler(v);

                        v.$refreshTrigger = function (profile) {
                            page._designable(profile);
                        };
                    }

                    if (v['ood.UIProfile']) {
                        // for module in module refresh itself
                        if (v.moduleClass && v.moduleXid && (t = ood.SC.get(v.moduleClass)) && (t = t.getInstance(v.moduleXid)) && t["ood.Module"]) {
                            // only once
                            if (!moduleHash[z = t.KEY + "[" + t.$xid + "]"]) {
                                moduleHash[z] = 1;
                                t.$refreshTrigger = function (profile) {
                                    page._mdlDesignable(profile, _true);
                                };
                            }
                        }
                    }
                });

                if (CONF._$initForDesign[profile.key])
                    CONF._$initForDesign[profile.key](page, profile);
            },
            '_uiDesignable': function (profile) {
                var page = this;
                profile.boxing().setHost(page.$host, profile.alias);

                // **** keep same 1
                profile.$inDesign = page.$canvasXid;
                if (profile['ood.UIProfile']) {
                    var t;
                    if (t = ood.get(getSPA(), ["curProjectConfig", "$DevEnv", "SpaceUnit"])) {
                        profile._spaceUnit = t;
                    }

                    profile._showTips = function (prf, n, pos) {
                        var tips = page._bldTips(prf, 'in design mode', true);
                        if (tips) {
                            ood.Tips.show(pos, tips);
                            return false;
                        }
                    }
                    // add a special class
                    profile.tagcls = "ood-designer-inner-control";
                    if (profile.rendered) {
                        profile.getAllNodes().addClass(profile.tagcls);
                    }

                    // cover default value
                    {
                        var df4 = ood.UI.__resetDftProp_in_Desinger,
                            df5 = profile.box.__resetDftProp_in_Desinger,
                            dm = profile.box.$DataModel;
                        for (var i in dm) {
                            if (profile.properties[i] === (dm[i] && ('ini' in dm[i]) ? dm[i].ini : "")) {
                                if (df5 && (i in df5)) {
                                    profile.properties[i] = df5[i];
                                } else if (df4 && (i in df4)) {
                                    profile.properties[i] = df4[i];
                                }
                            }
                        }
                    }
                    // must before rendered
                    profile.theme = profile.theme || ood.get(CONF, ["WidgetDftTheme", profile.key]);
                    page._giveHandler(profile);

                    profile.$refreshTrigger = function (profile) {
                        page._designable(profile);
                    };
                }

                /************ force layout for inner em size
                 ood.asyRun(function(){
                    profile.boxing().reLayout(_true);
                });
                 */

                if (profile['ood.UIProfile']) {
                    profile.$panelRestore = function (subprf) {
                        page._designable(subprf);
                    };

                    // for panel
                    var t = ood.get(profile, ["behavior", "PanelKeys"]);
                    if (t && t.length)
                        page._enablePanelDesign(profile);

                    if (profile.children && profile.children.length) {
                        var moduleHash = {}, t, z;
                        ood.arr.each(profile.children, function (v) {
                            v = v[0];
                            if (v['ood.UIProfile']) {
                                if (v.moduleClass && v.moduleXid && (t = ood.SC.get(v.moduleClass)) && (t = t.getInstance(v.moduleXid)) && t["ood.Module"]) {
                                    // only once
                                    if (!moduleHash[z = t.KEY + "[" + t.$xid + "]"]) {
                                        moduleHash[z] = 1;
                                        page._mdlDesignable(t, _false);
                                    }
                                } else {
                                    page._uiDesignable(v);
                                }
                            }
                        });
                    }
                }

                if (CONF._$initForDesign[profile.key])
                    CONF._$initForDesign[profile.key](page, profile);
            },
            '_WidgetsSelected': function (ids) {
                var page = this;
                page._setSelected(ids, _true);
                if (page.iconlist) {
                    page.iconlist.setUIValue(_null);
                }
            },
            '_clearSelect': function () {
                var page = this;
                ood.Event.keyboardHook('esc', 0, 0, 0, 'ood-designer-' + page.$xid);

                if (page.resizer && page.resizer.get(0) && page.resizer.get(0).renderId) {
                    page.resizer.resetTarget(_null, _false);
                    page._detatchResizer();
                }
                if (page.iconlist) {
                    page.iconlist.setUIValue(_null);
                }
                if (page.withPathHandler) {
                    page.withPathHandler._removeHandler();
                    delete page.withPathHandler;
                }
            },
            'getByCacheId': function (idArr) {
                var arr = [], t, n = ood.UI._cache;
                idArr = idArr instanceof Array ? idArr : [idArr];
                ood.arr.each(idArr, function (id) {
                    if (t = n['$' + id]) arr[arr.length] = t;
                });
                return ood.UI.pack(arr, _false);
            },
            '_deleteSelected': function (force) {
                var page = this, fun = function () {
                    var sel = page.getByCacheId(page.tempSelected),
                        subId;

                    //clear resizer first
                    page._clearSelect();

                    var aliass = [], arr = [];
                    if (!sel.isEmpty()) {
                        var ids = [];
                        //destroy, and will dettach from parent
                        var ws = page.getByCacheId(page.tempSelected);
                        var parent = ws.get(0).parent ? ws.get(0).parent.alias : "canvas";

                        subId = ws.get(0).childrenId;

                        ws.each(function (target) {
                            target = (target['ood.Module'] ? target : target.getModule(_true)) || target;

                            if (ood.arr.indexOf(aliass, target.alias) != -1) return;

                            aliass.push(target.alias);

                            var hash = target.serialize(_false);
                            delete hash.events;

                            // e.g. ood.UI.PopMenu
                            var item;
                            if (item = page.iconlist.getItemByItemId(target.$xid))
                                hash._item = ood.copy(item, _true);

                            arr.push(hash);
                        });
                    } else {
                        var target = ood.getObject(page.tempSelected[0]);

                        target = (target['ood.Module'] ? target : target.getModule(_true)) || target;

                        if (ood.arr.indexOf(aliass, target.alias) != -1) return;

                        if (!parent) {
                            parent = target.parent ? target.parent.alias : "canvas";
                        }

                        aliass.push(target.alias);
                        var hash = target.serialize(_false);
                        delete hash.events;

                        // e.g. ood.DataBinder
                        var item;
                        if (item = page.iconlist.getItemByItemId(target.$xid))
                            hash._item = ood.copy(item, _true);

                        arr.push(hash);
                    }


                    var redo = function () {
                        ood.arr.each(aliass, function (alias) {
                            var o = page.getByAlias(alias, _true);
                            if (o) {
                                if (page.iconlist.getItemByItemId(o.$xid))
                                    page.iconlist.removeItems(o.$xid);
                                o.boxing().destroy(_true, _true);
                            }

                        });
                    };
                    redo();
                    // undo-redo : delete controls by toolbar command
                    page.markDirty(function () {
                        ood.arr.each(arr, function (hash) {
                            var image = hash._item && hash._item.image,
                                imageClass = hash._item && hash._item.imageClass,
                                imgStyle = hash._item && hash._item.imgStyle;

                            var o = ood.create(ood.clone(hash));
                            o = o.get(0);
                            //before render
                            page._designable(o);
                            if (o['ood.Module']) {
                                if (o.getUIComponents().isEmpty()) {
                                    page.iconlist.insertItems([{
                                        'id': o.$xid,
                                        'imgWidth': '16',
                                        'imgHeight': '16',
                                        'tips': page._bldTips(o, page.$moduleInnerMode ? "" : CONF.enable_codeEdtor ? ("$(RAD.designer.Dblclick to edit the code)") : ""),
                                        'imgStyle': imgStyle,
                                        'imageClass': imageClass
                                    }], _null, _false);
                                } else {
                                    page.getByAlias(parent).append(o, subId);
                                }
                            } else {
                                if (!o.box['ood.UI'] || o.box.$initRootHidden) {
                                    page.iconlist.insertItems([{
                                        'id': o.$xid,
                                        'imgWidth': '16',
                                        'imgHeight': '16',
                                        'tips': page._bldTips(o, page.$moduleInnerMode ? "" : CONF.enable_codeEdtor ? ("$(RAD.designer.Dblclick to edit the code)") : ""),
                                        'imgStyle': imgStyle,
                                        'imageClass': imageClass
                                    }], _null, _false);
                                    if (o.box['ood.UI']) {
                                        page.canvas.append(o);
                                    }
                                } else {
                                    page.getByAlias(parent).append(o, subId);
                                }
                            }
                        });
                    }, redo, "delete controls");

                    //fire event
                    //page.onDeleted(page.pProfile, page.tempSelected);

                    page._setSelected(_null, _true);
                };
                if (!page.tempSelected || !page.tempSelected.length) return;
                if (!force)
                    ood.confirm(ood.getRes('RAD.designer.confirmdel'), ood.getRes('RAD.designer.confirmdel2', page.tempSelected.length), fun);
                else
                    fun();
            },
            '_giveHandler': function (profile, isCanvas) {
                var prevent1 = function () {
                        return;
                    },
                    prevent2 = function () {
                        return _false;
                    },
                    page = this,
                    fun = function () {
                        //don't set to canvas
                        if (!isCanvas) {
                            (profile.box['ood.svg'] ? profile.boxing().getAllNodes() : (profile.getRoot().setSelectable(_false)))
                                .beforeClick(prevent1)
                                .afterClick(prevent2)
                                .onClick(_null)
                                .onClick(function (pro, e, src) {
                                    var esrc = ood.Event.getSrc(e), t,
                                        id, profile;

                                    // for compitable with VML
                                    var svg = pro.box['ood.svg'];

                                    //for lang span, or inner renderer
                                    while ((
                                            (!esrc.id)
                                            || esrc.id == ood.$localeDomId
                                            || esrc.tagName == 'tspan'
                                        )
                                        && esrc.parentNode !== document
                                        && esrc.parentNode !== window
                                        )
                                        esrc = esrc.parentNode;

                                    id = esrc.id;
                                    esrc = _null;
                                    if (!id) return;

                                    var prfFrom = ood.UIProfile.getFromDom(id);
                                    if (t = prfFrom.box._ACTIVEHANDLER) {
                                        noHandler = true;
                                        for (var i = 0, l = t.length; i < l; i++) {
                                            if (prfFrom.getKey(id).split('-')[1] == (t[i] == "KEY" ? (void 0) : t[i])) {
                                                noHandler = false;
                                                break;
                                            }
                                        }
                                        if (noHandler) return;
                                    }

                                    profile = ood.UIProfile.getFromDom(ood.use(src).id());

                                    if (!profile) return;

                                    if (prfFrom && prfFrom !== profile) {
                                        // for inner prf ( prf in renderer )
                                        if (prfFrom._render_holder) {
                                            prfFrom = prfFrom._render_holder;
                                        }
                                        // for inner module ( modle in renderer )
                                        else {
                                            var m = prfFrom.getModule();
                                            prfFrom = m && m._render_holder;
                                        }
                                    }

                                    if (prfFrom !== profile) return;

                                    // for ood.Module, select the first control only
                                    var moduleUIs;
                                    var module = profile.getModule(_true);
                                    if (module) {
                                        moduleUIs = module.getUIComponents();
                                        profile = moduleUIs.get(0);
                                    }

                                    var t, tn, key = ood.Event.$keyboard;

                                    //if change panel, clear the panel selected
                                    if (page.pProfile && (page.pProfile != profile.parent))
                                        page.pProfile.selected = [];

                                    if (t = profile.parent) {
                                        // if svg, resizer is in the KEY Node.
                                        tn = profile.getRoot().parent();
                                        if (moduleUIs) {
                                            var ids = [];
                                            moduleUIs.each(function (o) {
                                                ids.push(o.$xid);
                                            });
                                            return t.setSelectFromPanel(t.getContainer(), ids);
                                        } else {
                                            if (page.tempSelected && page.tempSelected.length && ood.arr.indexOf(page.tempSelected, profile.$xid) != -1) {
                                                page.resizer.onRegionClick(e);
                                            } else {
                                                if (key && key.shiftKey)
                                                    t.reSelectObject.call(t, profile, tn);
                                                // ignore ood.UI.SVGPaper click selection function
                                                /*
                                            else if(profile.box['ood.UI.SVGPaper']){
                                                page._clearSelect();
                                                page._setSelected([], _true);
                                            }*/ else
                                                    t.selectObject.call(t, profile, tn);
                                            }
                                        }
                                    }

                                    // simlute
                                    ood.Event.simulateEvent(document.documentElement, "mousedown", {
                                        screenX: 0,
                                        screenY: 0,
                                        clientX: 0,
                                        clientY: 0
                                    });
                                    return _false;
                                });

                            // innerObj
                            profile.$afterAttached = function (prf) {
                                prf.getRoot().setSelectable(_false)
                                    .beforeClick(_null)
                                    .afterClick(_null)
                                    .onClick(_null)
                            };

                            profile.$onDock = function (profile) {
                                page.$tryToRefreshSel(profile);
                            };
                            profile.$afterRefresh = function (profile) {
                                page.$tryToRefreshSel(profile);
                            };
                            if (profile.box.KEY == "ood.UI.Image") {
                                profile.$afterLoad = function () {
                                    page.$tryToRefreshSel(profile);
                                };
                            }

                            if (profile.$inDesign && profile["ood.UIProfile"]) {
                                var ff = function (profile, v) {
                                    var root = profile.getRoot && profile.getRoot();
                                    if (root && !ood.isEmpty(root)) {
                                        if (profile.$$binderdiv)
                                            profile.$$binderdiv.remove();
                                        if (root.width() >= 50) {
                                            var bak;
                                            if (window.get) bak = get;
                                            var arr = [];
                                            window.get = function (k) {
                                                arr.push(k)
                                            };
                                            try {
                                                ood.each(v, function (fun, key) {
                                                    if ((key in profile.properties) && ood.isFun(fun)) {
                                                        fun();
                                                    }
                                                });
                                            } catch (e) {
                                            } finally {
                                                window.get = bak
                                            }
                                            if (arr.length) {
                                                var div = ood.create("<div style='position:absolute;left:0;top:0;z-index:999999;color:#aaa;'>[" + arr[0] + (arr.length > 1 ? "..." : "") + "]</div>");
                                                root.append(profile.$$binderdiv = div);
                                            }
                                        }
                                    }
                                };
                                if (!ood.isEmpty(profile.properties.propBinder)) {
                                    ff(profile, profile.properties.propBinder);
                                }
                                profile.$afterPropertyChanged = function (prf, name, nv) {
                                    if (name == "propBinder") {
                                        ff(prf, nv);
                                    }
                                }
                            }

                        }

                        var t = profile.behavior.PanelKeys;
                        ood.arr.each(t, function (i) {
                            if ((i == "KEY" || i == "PANEL" || i == profile.box._CONTAINERKEY) && !profile.box._ITEMCONTAINER) {
                                profile.getSubNode(i, _true)
                                    .addClass('ood-designer-canvas')
                                    .$addEventHandler('mousedown')
                                    .$addEventHandler('mouseup')
                                    .$addEventHandler('click');
                            }
                            profile.getSubNode(i, _true)
                                .$addEventHandler('mouseover')
                                .$addEventHandler('mouseout')
                                .$addEventHandler('drop')
                                .$addEventHandler('drag')
                                .$addEventHandler('dragstop');
                        });
                    };
                //add a class panel
                if (profile.renderId) {
                    fun();
                } else {
                    profile.$onrender = fun;
                }
                ;

            },
            '_enablePanelDesign': function (profile) {
                var ns = profile, ins = profile.boxing(),
                    t, key = profile.box.KEY, pool = profile.behavior.PanelKeys, page = this, h, k,
                    self = this,
                    cb = {
                        //overwrite
                        'beforeMouseover': function (profile, e, src) {
                            if (profile.moduleClass && profile.moduleXid) return;

                            var dd = ood.DragDrop, pp = dd.getProfile(), key = pp.dragKey, data = pp.dragData,
                                tp = data && data.data && data.data[0] && ood.getObject(data.data[0]),
                                tpp = tp && tp.getRoot().parent().xid();

                            //not include the dragkey
                            if (!key
                                || !data
                                || !(new RegExp('\\b' + key + '\\b')).test(profile.box.getDropKeys(profile, src) + ":___iDesign")

                                || (data.parentId == profile.$xid && tpp == src)
                                || (data.data && ood.arr.indexOf(data.data, profile.$xid) != -1)

                                || (profile.onDropTest && (_false === profile.boxing().onDropTest(profile, key, data)))
                            ) return;
                            // old
                            if (tp) {
                                // apend itself
                                var detect = function (arr) {
                                    var illegal;
                                    ood.arr.each(arr, function (c) {
                                        if ((c[0] || c) == profile) {
                                            illegal = 1;
                                            return false;
                                        } else illegal = detect(c.children);
                                    });
                                    return illegal;
                                };
                                var nodes = [];
                                for (var i = 0, l = data.data.length, d = data.data[i]; i < l; i++)
                                    nodes.push(ood.getObject(d));
                                if (detect(nodes)) return;
                                // illegal append
                                if (profile.box) {
                                    if (profile.box._IllegalDetect && ood.isSet(profile.box._IllegalDetect(profile, {_nodes: nodes}, false))) {
                                        return;
                                    }
                                }

                            }
                            // new
                            else {
                                if (profile.box) {
                                    if (profile.box._IllegalDetect && ood.isSet(profile.box._IllegalDetect(profile, {_nodes: [{box: ood.SC.get(data.cls)}]}, false))) {
                                        return;
                                    }
                                }
                            }
                            // for svg
                            if (data) {
                                if (profile.box.KEY == 'ood.UI.SVGPaper') {
                                    /* allows SVG in SVG paper
                                if(data.type){
                                    if(data.type==="ood.UI.SVGPaper")
                                        return;
                                }else{
                                    for(var i=0,l=data.data.length;i<l;i++){
                                        if(ood.getObject(data.data[i]).box.KEY=='ood.UI.SVGPaper')
                                            return;
                                    }
                                }*/
                                } else {
                                    if (data.type) {
                                        if (ood.str.startWith(data.type, "ood.svg."))
                                            return;
                                    } else {
                                        if (!data.data) return;
                                        for (var i = 0, l = data.data.length; i < l; i++) {
                                            if (ood.str.startWith(ood.getObject(data.data[i]).box.KEY, "ood.svg."))
                                                return;
                                        }
                                    }
                                }
                            }

                            //for trigger onDrop
                            dd.setDropElement(src);
                            //show region
                            ood.resetRun('setDropFace', dd.setDropFace, 0, [src], dd);

                            if (profile.onDragEnter) profile.boxing().onDragEnter(profile, e, this, key, data, profile.getItemByDom(ood.use(src).id()));
                        },
                        'beforeDrop': function (profile, e, src) {
                            if (profile.moduleClass && profile.moduleXid) return;
                            try {
                                var target,
                                    dd = ood.DragDrop.getProfile(),
                                    dropx = dd.x,
                                    dropy = dd.y,
                                    dragKey = dd.dragKey,
                                    dragData = dd.dragData,
                                    type = (dragData.cls == 'ood.Module' ? dragData.type : dragData.cls),
                                    iniProp = dragData.iniProp,
                                    className = dragData.className,

                                    children = dragData.children,
                                    iniEvent = dragData.iniEvents,
                                    customRegion = dragData.customRegion,
                                    image = dragData.image,
                                    imagePos = dragData.imagePos,
                                    imageClass = dragData.imageClass,
                                    data = dragData.data,
                                    caption = dragData.caption,
                                    pos = dragData.pos,

                                    ids,
                                    offset = self.dropOffset,
                                    // for widgets
                                    undoredoWidgetsFun = function (parent, subId, hash) {
                                        // undo-redo : add controls by drop
                                        page.markDirty(function () {
                                            var o = page.getByAlias(hash.alias, _true);
                                            if (!(o.box['ood.UI'] && !o.box.$initRootHidden))
                                                page.iconlist.removeItems(o.$xid);
                                            o.boxing().destroy(_true, _true);
                                        }, function () {
                                            var image = hash._item && hash._item.image,
                                                imageClass = hash._item && hash._item.imageClass,
                                                imgStyle = hash._item && hash._item.imgStyle;

                                            var o = ood.create(ood.clone(hash));
                                            o = o.get(0);
                                            //before render
                                            page._designable(o);
                                            if (!(o.box['ood.UI'] && !o.box.$initRootHidden)) {
                                                page.iconlist.insertItems([{
                                                    'id': o.$xid,
                                                    'imgWidth': '16',
                                                    'imgHeight': '16',
                                                    'tips': page._bldTips(o, page.$moduleInnerMode ? "" : CONF.enable_codeEdtor ? ("$(RAD.designer.Dblclick to edit the code)") : ""),
                                                    'imgStyle': imgStyle,
                                                    'imageClass': imageClass
                                                }], _null, _false);
                                                if (o.box['ood.UI']) {
                                                    page.canvas.append(o);
                                                }
                                            } else {
                                                page.getByAlias(parent).append(o, subId);
                                            }
                                        }, "add control");
                                    },
                                    widgetsFun = function () {
                                        var page = arguments.callee.page, t = ood.SC(type), target;
                                        var subId = profile.getItemIdByDom(ood.use(src).id());
                                        if (!(t['ood.UI'] && !t.$initRootHidden)) {
                                            //give design mark
                                            target = ood.create(type);
                                            //before render
                                            target.get(0).$inDesign = page.$canvasXid;
                                            if (target.get(0)['ood.UIProfile']) {
                                                var t;
                                                if (t = ood.get(getSPA(), ["curProjectConfig", "$DevEnv", "SpaceUnit"])) {
                                                    target.get(0)._spaceUnit = t;
                                                }
                                            }
                                            if (ood.isHash(iniProp)) {
                                                target.setProperties(ood.clone(iniProp));
                                            }else if (target.iniProp) {
                                                target.setProperties(ood.clone(target.iniProp));
                                            }
                                            try {
                                                target.setAlias(iniProp.name)
                                                target.setEvents(iniEvent)
                                            } catch (e) {

                                            }


                                            target = target.get(0);

                                            page.iconlist.insertItems([{
                                                'id': target.$xid,
                                                'imgWidth': '16',
                                                'imgHeight': '16',
                                                'tips': page._bldTips(target, page.$moduleInnerMode ? "" : CONF.enable_codeEdtor ? ("$(RAD.designer.Dblclick to edit the code)") : ""),
                                                'imgStyle': image ? 'background:url(' + image + ') ' + 'imagePos' : '',
                                                'imageClass': imageClass
                                            }], _null, _false);
                                            page.iconlist.setUIValue(target.$xid);

                                            page._designable(target);

                                            if (target.box['ood.UI']) {
                                                page.canvas.append(target);
                                            }
                                        } else {
                                            //before drop check
                                            //if(_false===ood.tryF(c.beforeAddWidget, [data], profile))return;
                                            //check position
                                            //give design mark
                                            target = new (ood.SC(ood.absBox.$type[type]));
                                            //before render
                                            target.get(0).$inDesign = page.$canvasXid;
                                            if (target.get(0)['ood.UIProfile']) {
                                                var t;
                                                if (t = ood.get(getSPA(), ["curProjectConfig", "$DevEnv", "SpaceUnit"])) {
                                                    target.get(0)._spaceUnit = t;
                                                }
                                            }
                                            if (ood.isHash(iniProp)) {
                                                target.setProperties(ood.clone(iniProp));
                                            } else if (target.iniProp) {
                                                target.setProperties(ood.clone(target.iniProp));
                                            }

                                            if (caption) {
                                                if ('labelCaption' in target.Class.$DataStruct) {
                                                    if (parseFloat(target.getLabelSize()) > 0) {
                                                        target.setLabelCaption(ood.adjustRes(caption));
                                                    }
                                                } else if ('caption' in target.Class.$DataStruct) {
                                                    target.setCaption(ood.adjustRes(caption));
                                                }
                                            }

                                            if (!customRegion && target['ood.UI']) {
                                                var parentNode = profile.keys.PANEL ? profile.getSubNode(profile.keys.PANEL, profile.getSubId(src)) : profile.getRoot();
                                                if (!parentNode.isEmpty()) {
                                                    var p = target.get(0).properties,
                                                        h = parentNode.get(0).style.height;
                                                    // for conDockRelative
                                                    if (profile.properties.conDockRelative || profile.properties.conLayoutColumns) {
                                                        target.setPosition('relative');
                                                    }
                                                    // absolute for fixed height parent, or relative
                                                    else if (h && h != 'auto') {
                                                        // get Pos
                                                        var basePos = ood.use(src).offset(),
                                                            cssPos = {
                                                                'left': parseInt((dropx - basePos.left) / offset) * offset,
                                                                'top': parseInt((dropy - basePos.top) / offset) * offset
                                                            };
                                                        if (!target['ood.svg'] && ood.$us(target.get(0)) > 0) {
                                                            cssPos.left = ood.CSS.$forceu(cssPos.left, 'em', page.canvas.get(0));
                                                            cssPos.top = ood.CSS.$forceu(cssPos.top, 'em', page.canvas.get(0));
                                                        }
                                                        try {
                                                            target.setLeft(ood.arr.indexOf(['top', 'bottom', 'width', 'fill', 'cover'], p.dock) != -1 ? 0 : cssPos.left);
                                                            target.setTop(ood.arr.indexOf(['left', 'right', 'height', 'fill', 'cover'], p.dock) != -1 ? 0 : cssPos.top);
                                                            if (!target['ood.svg'])
                                                                target.setPosition('absolute');
                                                        } catch (e) {

                                                        }

                                                    } else {
                                                        target.setLeft('auto');
                                                        target.setTop('auto');
                                                        if (!target['ood.svg'])
                                                            target.setPosition('relative');
                                                    }

                                                }
                                            }
                                            try {
                                                target.setZIndex(1);
                                            } catch (e) {

                                            }

                                            page._designable(target.get(0));

                                            target.render();

                                            // add widgets to panel
                                            profile.boxing().append(target, subId);


                                            //ood.tryF(page.afterAddWidget, [target, profile.$xid], page);

                                            target = target.get(0);

                                            ids = [target.$xid];
                                            profile.setSelectFromPanel.call(profile, ood(src), ids);
                                        }

                                        // for undo/redo
                                        var hash = target.serialize(_false),
                                            parent = target.parent ? target.parent.alias : "canvas";

                                        delete hash.events;
                                        // e.g. ood.UI.PopMenu && ood.DataBinder
                                        if (!(target.box['ood.UI'] && !target.box.$initRootHidden))
                                            hash._item = ood.copy(page.iconlist.getItemByItemId(target.$xid), _true);
                                        undoredoWidgetsFun(parent, subId, hash);

                                        return target;
                                    },
                                    // for module
                                    undoredoModuleFun = function (parent, subId, hash) {
                                        // undo-redo : add controls by drop
                                        page.markDirty(function () {
                                            var o = page.getByAlias(hash.alias, _true);

                                            page.iconlist.removeItems(o.$xid);

                                            o.destroy(_true, _true);
                                        }, function () {
                                            var image = hash._item && hash._item.image,
                                                imageClass = hash._item && hash._item.imageClass,
                                                imgStyle = hash._item && hash._item.imgStyle;

                                            var o = ood.create(ood.clone(hash));

                                            //before render
                                            page._designable(o);

                                            var comui = o.getUIComponents();
                                            if (comui.isEmpty()) {
                                                page.iconlist.insertItems([{
                                                    'id': o.$xid,
                                                    'imgWidth': '16',
                                                    'imgHeight': '16',
                                                    'tips': page._bldTips(o, page.$moduleInnerMode ? "" : CONF.enable_codeEdtor ? ("$(RAD.designer.Dblclick to edit the code)") : ""),
                                                    'imgStyle': imgStyle,
                                                    'imageClass': imageClass
                                                }], _null, _false);
                                            } else {
                                                comui.setZIndex(1);

                                                // add widgets to panel
                                                page.getByAlias(parent).append(o, subId);
                                            }

                                        }, "add module");
                                    },
                                    moduleFun = function () {
                                        var page = arguments.callee.page,
                                            t = ood.SC(type);
                                        if (!t || !t['ood.Module']) return;
                                        // itself
                                        if (getSPA().getCurrentClassName()) {
                                            var cls = ood.getClassName(getSPA().getCurrentClassName());
                                            if (cls == type) {
                                                ood.message("You cant add one moudle into itself!");
                                                return;
                                            }
                                        }

                                        var target = new t(),
                                            subId = profile.getItemIdByDom(ood.use(src).id());

                                        //before render
                                        target.$inDesign = page.$canvasXid;
                                        if (target['ood.UIProfile']) {
                                            var t;
                                            if (t = ood.get(getSPA(), ["curProjectConfig", "$DevEnv", "SpaceUnit"])) {
                                                target._spaceUnit = t;
                                            }
                                        }
                                        // need set host first
                                        target.setHost(page.$host, target.alias);
                                        if (ood.isHash(iniEvent)) {
                                            target.setEvents(ood.clone(iniEvent));
                                        }

                                        if (ood.isHash(iniProp)) {
                                            target.setProperties(ood.clone(iniProp));
                                        }


                                        var comui = target.getUIComponents();
                                        // must set here
                                        page._designable(target);

                                        target.render();

                                        if (comui.isEmpty()) {
                                            page.iconlist.insertItems([{
                                                'id': target.$xid,
                                                'imgWidth': '16',
                                                'imgHeight': '16',
                                                'tips': page._bldTips(target, page.$moduleInnerMode ? "" : CONF.enable_codeEdtor ? ("$(RAD.designer.Dblclick to edit the code)") : ""),
                                                'imgStyle': image ? 'background:url(' + image + ') ' + 'imagePos' : '',
                                                'imageClass': imageClass
                                            }], _null, _false);
                                            page.iconlist.setUIValue(target.$xid);
                                        } else {
                                            comui.setZIndex(1);

                                            // add widgets to panel
                                            profile.boxing().append(target, subId);
                                            //ood.tryF(page.afterAddWidget, [target, profile.$xid], page);
                                            ids = [comui.get(0).$xid];

                                            // only recognize the first UI control
                                            profile.setSelectFromPanel.call(profile, ood(src), ids);
                                        }

                                        // for undo/redo
                                        var hash = target.serialize(_false),
                                            parent = profile.alias || "canvas";
                                        delete hash.events;

                                        if (comui.isEmpty()) {
                                            hash._item = ood.copy(page.iconlist.getItemByItemId(target.$xid), _true);
                                        }

                                        // delete dragData.children;
                                        try {

                                            if (!dragData.isCom) {
                                                var components = ood.addChild(dragData, target, profile.boxing(), page.$host);
                                                var go = components[0].get(0);
                                                page._designable(go);
                                                page.selectWidget([go.$xid]);
                                                // page.refreshView(page.getJSCode(page.getWidgets(_true)), _true);
                                            }

                                        } catch (e) {

                                        }


                                        undoredoModuleFun(parent, subId, hash);
                                    };
                                widgetsFun.page = page;
                                moduleFun.page = page;
                                // for dropping a widget from toolbox
                                if (type) {
                                    if (dragData.cls == "ood.Module") {
                                        if (ood.SC.get(type)) {
                                            moduleFun();
                                        } else {

                                            ood.observableRun(function () {
                                                if (window.loadingAnimationManager && false) {
                                                    window.loadingAnimationManager.showLoadingAnimation(ood.getRes('RAD.designer.loading') + type);
                                                } else {
                                                    ood.Dom.setCover(ood.getRes('RAD.designer.loading') + type);
                                                }
                                                ood.require(type, moduleFun, _null, function (msg) {
                                                    ood.alert(msg);
                                                }, function (msg) {
                                                    ood.alert(msg);
                                                }, _true, _null, {'appPath': CONF.adjustProtocol(getSPA().curProjectPath)});
                                            });


                                        }
                                        //  page.refreshView(page.getJSCode(page.getWidgets(_true)), _true);
                                    } else {
                                        var target;
                                        if (ood.SC.get(type)) {
                                            try {
                                                target = widgetsFun();
                                            } catch (e) {

                                            }

                                        } else {
                                            ood.observableRun(function () {
                                                ood.Dom.setCover(ood.getRes('RAD.designer.loading') + type);
                                                ood.SC(type, widgetsFun, _true);
                                            });
                                        }

                                        if (children && dragData.cls != "ood.Module") {
                                            ood.addChild(dragData, target.boxing(), profile.boxing(), page.$host);
                                            // page.refreshView(page.getJSCode(page.getWidgets(_true)), _true);
                                            //  page.refresh();
                                        }

                                    }
                                }
                                // for modifing widgets/module's parent container
                                else {
                                    // calculate by px
                                    var basePos = ood.use(src).offset(),
                                        nparent = profile.alias, nsubId,
                                        cssPos = {
                                            'left': parseInt((dropx - basePos.left) / offset) * offset,
                                            'top': parseInt((dropy - basePos.top) / offset) * offset
                                        };

                                    ids = data;
                                    target = self.getByCacheId(ids);

                                    var oparent = target.get(0).parent ? target.get(0).parent.alias : "canvas",
                                        osubId = target.get(0).childrenId,
                                        t, minx, miny;

                                    var arr = [];

                                    // it's a module
                                    var m = target.get(0).getModule(_true);
                                    if (m) {
                                        arr.push(m.alias);
                                        m.getUIComponents().each(function (o) {
                                            if (o.properties.dock != 'none') ood.UI.$dock(o, _true);
                                        });
                                        target = m;
                                    } else {
                                        target.each(function (prf) {
                                            arr.push(prf.alias);
                                        });
                                        page.resizer.resetTarget(target.reBoxing());

                                        var off = target.getRoot().parent().offset(_null, page.panelDiv.getRoot());
                                        page.resizer.setTopOffset(parseInt(off.top, 10));
                                        page.resizer.setLeftOffset(parseInt(off.left, 10));

                                        target.each(function (o, i) {
                                            if (i === 0) {
                                                if (o.box['ood.svg']) {
                                                    var bb = o.boxing()._getBBox();
                                                    minx = bb.x;
                                                    miny = bb.y;
                                                } else {
                                                    minx = o.$px(o.properties.left);
                                                    miny = o.$px(o.properties.top);
                                                }
                                            } else {
                                                if (o.box['ood.svg']) {
                                                    var bb = o.boxing()._getBBox();
                                                    minx = Math.min(bb.x, minx);
                                                    miny = Math.min(bb.y, miny);
                                                } else {
                                                    minx = Math.min(o.$px(o.properties.left), minx);
                                                    miny = Math.min(o.$px(o.properties.top), miny);
                                                }
                                            }
                                        });
                                        var xoff = minx - cssPos.left, yoff = miny - cssPos.top;

                                        target.each(function (o) {
                                            if (o.properties.dock != 'none') ood.UI.$dock(o, _true);
                                            else {
                                                if (o.box['ood.svg']) {
                                                    var bbox = o.boxing()._getBBox();
                                                    delete bbox.x2;
                                                    delete bbox.y2;
                                                    bbox.x -= xoff;
                                                    bbox.y -= yoff;
                                                    o.boxing()._setBBox(bbox);
                                                } else {
                                                    o.boxing()
                                                        .setLeft(o.$px(o.properties.left) - xoff)
                                                        .setTop(o.$px(o.properties.top) - yoff);
                                                }
                                            }
                                        });
                                    }

                                    nsubId = profile.getItemIdByDom(src);
                                    // add widgets to panel
                                    profile.boxing().append(target, nsubId);
                                    //ood.tryF(page.afterMoveWidget, [target, profile.$xid], page);

                                    profile.setSelectFromPanel.call(profile, ood(src), ids);

                                    if (!oparent) oparent = "canvas";

                                    // undo-redo : modify controls' parent container by ctrl+DD
                                    page.markDirty(function () {
                                        ood.arr.each(arr, function (alias) {
                                            var ins = page.getByAlias(alias), o = ins.get(0);
                                            page.getByAlias(oparent).append(ins, osubId);
                                            if (o['ood.Module']) {
                                                o.getUIComponents().each(function (o) {
                                                    if (o.properties.dock != 'none') ood.UI.$dock(o, _true);
                                                });
                                            } else if (o.properties.dock != 'none') ood.UI.$dock(o, _true);
                                            else {
                                                if (o.box['ood.svg']) {
                                                    var bbox = ins._getBBox();
                                                    delete bbox.x2;
                                                    delete bbox.y2;
                                                    bbox.x += xoff;
                                                    bbox.y += yoff;
                                                    ins._setBBox(bbox);
                                                } else {
                                                    ins
                                                        .setLeft(o.$px(o.properties.left) + xoff)
                                                        .setTop(o.$px(o.properties.top) + yoff);
                                                }
                                            }
                                        });
                                    }, function () {
                                        ood.arr.each(arr, function (alias) {
                                            var ins = page.getByAlias(alias), o = ins.get(0);
                                            page.getByAlias(nparent).append(ins, nsubId);

                                            if (o['ood.Module']) {
                                                o.getUIComponents().each(function (o) {
                                                    if (o.properties.dock != 'none') ood.UI.$dock(o, _true);
                                                });
                                            } else if (o.properties.dock != 'none') ood.UI.$dock(o, _true);
                                            else {
                                                if (o.box['ood.svg']) {
                                                    var bbox = ins._getBBox();
                                                    delete bbox.x2;
                                                    delete bbox.y2;
                                                    bbox.x -= xoff;
                                                    bbox.y -= yoff;
                                                    ins._setBBox(bbox);
                                                } else {
                                                    ins
                                                        .setLeft(o.$px(o.properties.left) - xoff)
                                                        .setTop(o.$px(o.properties.top) - yoff);
                                                }
                                            }
                                        });
                                    }, "change controls' parent container");
                                }
                            } catch (e) {
                                ood.alert(e);
                            }
                        },
                        'beforeMousedown': function (profile, e, src) {
                            if (profile.moduleClass && profile.moduleXid) return;

                            if (ood.Event.getBtn(e) != "left") return;
                            var id = ood.Event.getSrc(e).$xid;
                            if (profile.box.KEY == 'ood.UI.SVGPaper'
                                && profile.getSubNode('SVG').xid() == id) {
                                src = id = profile.getRoot().xid();
                            }

                            if (id !== src) return;

                            var o = ood(src),
                                pos = ood.Event.getPos(e),
                                absPos = o.offset(),
                                w = o.innerWidth(),
                                h = o.innerHeight();
                            //in the scroll bar
                            if (pos.left - absPos.left > w) return;
                            if (pos.top - absPos.top > h) return;

                            // keep pos
                            profile._offsetPos = absPos;
                            profile._scrollTop = o.scrollTop();
                            profile._scrollLeft = o.scrollLeft();

                            page._attachResizer(profile, src);
                            profile._selregion = {};

                            var pos = ood.Event.getPos(e);
                            // 安全检查：如果startDrag方法不存在，则使用ood.DragDrop.startDrag作为备选
                            if (ood(src).startDrag) {
                                ood(src).startDrag(e, {
                                    'targetReposition': _false,
                                    'dragType': 'blank',
                                    'dragCursor': 'crosshair',
                                    'targetLeft': pos.left,
                                    'targetTop': pos.top,
                                    'dragDefer': 2
                                });
                            } else {
                                // 使用备选方案：直接调用ood.DragDrop.startDrag
                                ood.DragDrop.startDrag(e, ood(src).get(0), {
                                    'targetReposition': _false,
                                    'dragType': 'blank',
                                    'dragCursor': 'crosshair',
                                    'targetLeft': pos.left,
                                    'targetTop': pos.top,
                                    'dragDefer': 2
                                });
                            }
                            profile.$dragging = _false;

                            // simlute
                            ood.Event.simulateEvent(document.documentElement, "mousedown", {
                                screenX: 0,
                                screenY: 0,
                                clientX: 0,
                                clientY: 0
                            });
                        },
                        'onClick': function (profile, e, src) {
                            var esrc = ood.Event.getSrc(e), psrc = ood.use(src).get(0);
                            // special panel node for SVGPaper
                            if (profile.box.KEY == 'ood.UI.SVGPaper')
                                esrc = esrc.parentNode;
                            if (esrc !== psrc) return;

                            self._clearSelect();
                            profile.setSelectFromPanel.call(profile, ood(src), []);
                        },
                        'beforeDrag': function (profile, e, src) {
                            if (profile.moduleClass && profile.moduleXid) return;

                            var t, dd = ood.DragDrop.getProfile(), pos = dd.offset,
                                proxy = page.proxy;

                            var region = profile._selregion;
                            if ((t = pos.x) < 0) pos.x = -t;
                            if ((t = pos.y) < 0) pos.y = -t;

                            region.left = Math.min(dd.ox, dd.x) - profile._offsetPos.left + profile._scrollLeft;
                            region.top = Math.min(dd.oy, dd.y) - profile._offsetPos.top + profile._scrollTop;
                            region.width = pos.x;
                            region.height = pos.y;

                            proxy.cssRegion(region);

                            if (!profile.$dragging) {
                                proxy.css('display', 'block');
                                profile.$dragging = _true;
                            }
                        },
                        'beforeDragstop': function (profile, e, src) {
                            if (profile.moduleClass && profile.moduleXid) return;
                            //if(!profile._selregion)return;
                            var region = profile._selregion,
                                proxy = page.proxy,

                                selected = [], t, m, o, x1, y1, x2, y2, xx1, yy1, xx2, yy2,
                                self = ood.use(src).get(0);

                            xx1 = region.left;
                            yy1 = region.top;
                            xx2 = xx1 + region.width;
                            yy2 = yy1 + region.height;
                            if (m = profile.children) {
                                ood.arr.each(m, function (v, i) {
                                    v = v[0];

                                    var svg = v.box["ood.svg"],
                                        rn = v.getRootNode();

                                    if (!rn) return;

                                    var pn = rn.parentNode, bbox;

                                    if (svg)
                                        pn = pn.parentNode;

                                    if (v.renderId && rn && pn === self && rn.style.display != 'none' && rn.style.visibility != 'hidden') {
                                        if (svg) {
                                            bbox = v.boxing()._getBBox();
                                            x1 = bbox.x;
                                            y1 = bbox.y;
                                            x2 = x1 + bbox.width;
                                            y2 = y1 + bbox.height;
                                        } else {
                                            o = v.getRoot();
                                            x1 = o.offsetLeft();
                                            y1 = o.offsetTop();
                                            x2 = x1 + o.width();
                                            y2 = y1 + o.height();
                                        }

                                        // across, but not in for ood.UI
                                        // across for ood.svg
                                        if (xx2 > x1 && x2 > xx1 && yy2 > y1 && y2 > yy1 && (v.box['ood.svg'] || !(x1 < xx1 && x2 > xx2 && y1 < yy1 && y2 > yy2))) selected.push(v.$xid);
                                    }
                                });
                                //reset/cache proxy
                                profile.setSelectFromPanel.call(profile, ood(src), selected);
                            }
                            //for firefox cursor bug
                            ood.asyRun(function () {
                                proxy.css('display', 'none');
                            });
                        },
                        'onMouseup': function (profile, e, src) {
                            if (profile.moduleClass && profile.moduleXid) return;
                            ood.asyRun(function () {
                                page.proxy.css('display', 'none');
                            });
                        }
                    };

                if (t = pool) {
                    h = {};
                    ood.arr.each(t, function (i) {
                        if (profile.keys.KEY == profile.keys[i])
                            ood.merge(h, cb);
                        else {
                            h[i] = ood.copy(cb);
                        }
                    });
                    if (!ood.isEmpty(h)) {
                        //profile.boxing().setCustomBehavior(h);
                        profile._CB = h;
                        // disable behavior
                        // delete profile.behavior;
                        profile.clearCache();
                    }
                    /*
                    var i=ood.arr.indexOf(t,'PANEL');
                    if(i==-1)
                        i=ood.arr.indexOf(t,'KEY');

                    if(i!=-1){
                        i=t[i];
                        if(profile.keys.KEY == profile.keys[i])
                            h=cb;
                        else{
                            h={};
                            h[i]=cb;
                        }
                        //profile.boxing().setCustomBehavior(h);
                        profile._CB=h;
                        // disable behavior
                        // delete profile.behavior;
                        profile.clearCache();
                    }
                    */

                    // For touch-only platform
                    // In ipad or other touch-only platform, you have to decide the droppable order by youself
                    // The later added to DOM the higher the priority
                    // Add droppable links
                    if (ood.browser.isTouch/* && ood.Event.__realtouch*/) {
                        ood.arr.each(t, function (o) {
                            ins.getSubNode(o, _true).each(function (node) {
                                var c = ood.$cache.droppable, i = "___iDesign";
                                c[i] = c[i] || [];
                                c[i].push(node.$xid);
                            });
                        });
                    }
                }

                ood.merge(profile, {
                    'selectObject': function (obj, node) {
                        var profile = this,
                            id = obj.$xid;

                        if (profile.box.KEY == 'ood.UI.SVGPaper' && node.parent().get(0) == profile.getRootNode())
                            node = node.parent();

                        return this.setSelectFromPanel(node, [id]);
                    },
                    'reSelectObject': function (obj, node, selAll) {
                        var profile = this;
                        if (profile.box.KEY == 'ood.UI.SVGPaper' && node.parent().get(0) == profile.getRootNode())
                            node = node.parent();

                        if (!selAll) {
                            id = obj.$xid;
                            if (profile.selected && ood.arr.indexOf(profile.selected, id) != -1) {
                                ood.arr.removeValue(profile.selected, id);
                            } else {
                                (profile.selected || (profile.selected = [])).push(id);
                            }
                        }
                        return this.setSelectFromPanel(node, profile.selected);
                    },
                    'setSelectFromResizer': function (ids) {
                        var profile = this;
                        profile.selected = ids;
                        return this.resetSelectRel();
                    },
                    'setSelectFromPanel': function (node, ids) {
                        var profile = this, hasPureUI;
                        ood.filter(ids, function (id) {
                            var prf = ood.getObject(id);
                            if (!(prf instanceof ood.UIProfile)) return _false;
                            if (prf.box.$initRootHidden) return _false;
                            if (!prf.getModule()) hasPureUI = _true;
                        });
                        if (ids.length) {
                            if (hasPureUI) {
                                ood.filter(ids, function (id) {
                                    var prf = ood.getObject(id);
                                    if (prf.getModule()) return _false;
                                });
                            } else {
                                // only allow to select one module
                                var prf = ood.getObject(ids[0]);
                                ids = [];
                                var module = prf.getModule(_true);
                                if (module) {
                                    module.getUIComponents().each(function (o) {
                                        ids.push(o.$xid);
                                    });
                                }
                            }
                        }
                        if (profile.box.KEY == 'ood.UI.SVGPaper' && node.parent().get(0) == profile.getRootNode())
                            node = node.parent();

                        //append resizer
                        if (self.pProfile !== profile ||
                            (self.pNode && self.pNode.id()) !== (node && node.get(0) && node.id())) {
                            self._clearSelect();
                            self._attachResizer(profile, node);
                        }
                        if (self.withPathHandler) {
                            self.withPathHandler._removeHandler();
                            delete self.withPathHandler;
                        }
                        profile.selected = ids;
                        self.resizer.resetTarget(self.getByCacheId(profile.selected).reBoxing(), _false);
                        if (ids[0]) {
                            var off = ood.getObject(ids[0]).getRoot().parent().offset(_null, page.panelDiv.getRoot());
                            self.resizer.setTopOffset(parseInt(off.top, 10));
                            self.resizer.setLeftOffset(parseInt(off.left, 10));
                        }
                        return this.resetSelectRel();
                    },
                    'resetSelectRel': function () {
                        var profile = this;
                        if (profile.selected && profile.selected.length) {
                            var t = self.resizer.get(0).properties;
                            t.dragArgs = {
                                'dragKey': '___iDesign',
                                'widthIncrement': self.dropOffset,
                                'heightIncrement': self.dropOffset,
                                'dragData': {
                                    'parentId': profile.$xid,
                                    'data': profile.selected
                                }
                            };
                        } else {
                            self._clearSelect();
                        }
                        ood.tryF(self._WidgetsSelected, [profile.selected], self);

                        self._focus();
                    }
                }, 'all');
            },
            '_refreshProfileGrid': function (ids, refreshed, force) {
                var page = this,
                    data = page._cls,
                    grid = page.profileGrid,
                    gp = grid.get(0),
                    $widget;
                if (!grid) return;

                if (!ids || !ids.length) {
                    $widget = page.canvas;
                } else {
                    $widget = page.getByCacheId(ids);
                    // for none UI widget
                    if (!$widget.get(0)) {
                        $widget = ood.getObject(ids[0]).boxing();
                    }
                }
                // the same one, dont reset
                if (!force && gp.$widget &&
                    ($widget === gp.$widget ||
                        ($widget.size() == 1 && gp.$widget.size() == 1 && $widget.get(0) == gp.$widget.get(0))
                    )
                ) {
                    return;
                }
                gp.$widget = $widget;

                // refresh one: replace $widget is enough
                if (refreshed) {
                    return;
                }

                if (CONF.grid_showPropBinder) {
                    if (ids && ids.length === 1) {
                        if (grid.getHeader().length !== 3)
                            grid.setHeader([
                                {"id": "key", "caption": "$RAD.designer.gridcol1", 'width': 120, 'type': "label"},
                                {
                                    "id": "value",
                                    "caption": "$RAD.designer.gridcol2",
                                    "width": 100,
                                    "type": "label",
                                    cellStyle: "text-indent:2px;"
                                },
                                {
                                    "id": "binder",
                                    "caption": "$RAD.designer.gridcol3",
                                    "width": 150,
                                    "type": "label",
                                    cellStyle: "text-indent:2px;",
                                    "minWidth": 80,
                                    'editMode': 'hover',
                                    'flexSize': _true,
                                    'disabled': _true,
                                    'editable': _false
                                }
                            ]);
                    } else {
                        if (grid.getHeader().length !== 2)
                            grid.setHeader([
                                {"id": "key", "caption": "$RAD.designer.gridcol1", 'width': 120, 'type': "label"},
                                {
                                    "id": "value",
                                    "caption": "$RAD.designer.gridcol2",
                                    "width": 100,
                                    "type": "input",
                                    'flexSize': _true,
                                    cellStyle: "text-indent:2px;"
                                }
                            ]);
                    }
                }

                var bcell = function (cell, key) {
                    // Give a chance to modify editor setting for value cell
                    getSPA() && getSPA().fe("onInitPropValueCell", [key, _null, cell.value, "RAD.Designer", $widget, cell, grid]);
                    return cell;
                };
                // to reset
                if (!ids || !ids.length) {
                    var pro = this.canvas.get(0);
                    if (!ood.get(data, ['Instance', 'events']))
                        ood.set(data, ['Instance', 'events'], {});

                    var em = ood.get(data, ['Instance', 'events']);
                    if (CONF.getClientMode() != 'project') {
                        var viewStyles = ood.get(data, ['Static', 'viewStyles']);
                        var rows = [
                            {
                                'id': 'properties:width',
                                'noAPI': 1,
                                'cells': [{'caption': '$RAD.designer.conf.canvas.width'},
                                    bcell({'type': 'number', 'unit': 'px', 'value': pro.properties.width}, 'width')
                                ]
                            },
                            {
                                'id': 'properties:height',
                                'noAPI': 1,
                                'cells': [{'caption': '$RAD.designer.conf.canvas.height'},
                                    bcell({'type': 'number', 'unit': 'px', 'value': pro.properties.height}, 'height')
                                ]
                            },
                            {
                                'id': 'properties:theme',
                                'noAPI': 1,
                                'cells': [{'caption': '$RAD.designer.conf.canvas.theme'},
                                    bcell({
                                        'type': 'combobox',
                                        'value': (viewStyles && viewStyles.theme) || "default",
                                        'editorListItems': CONF.designer_themes
                                    }, 'theme')
                                ]
                            },
                            {
                                'id': 'properties:zoom',
                                'noAPI': 1,
                                'cells': [{'caption': '$RAD.designer.conf.canvas.zoom'},
                                    bcell({
                                        'type': 'combobox',
                                        'value': (viewStyles && viewStyles.zoom) || "",
                                        'editorListItems': CONF.designer_zoom
                                    }, 'zoom')
                                ]
                            },
                            {
                                'id': 'properties:background-color',
                                'noAPI': 1,
                                'cells': [{'caption': "$(RAD.custom_dlg.background$-color)"},
                                    bcell({
                                        'type': "color",
                                        'value': (viewStyles && viewStyles["background-color"]) || ""
                                    }, 'background-color')
                                ]
                            },
                            {
                                'id': 'properties:background-image',
                                'noAPI': 1,
                                'cells': [{'caption': "$(RAD.custom_dlg.background$-image)"},
                                    bcell(
                                        (CONF.getClientMode() == 'singlepage') ? {
                                                'type': "input",
                                                'value': (viewStyles && viewStyles["background-image"]) || ""
                                            }
                                            : (CONF.getClientMode() == 'component') ? {
                                                'type': "popbox",
                                                'value': (viewStyles && viewStyles["background-image"]) || "",
                                                'event': function (profile, cell, editorprf) {
                                                    var node = profile.getSubNode('CELL', cell._serialId),
                                                        _cb = function (path) {
                                                            path = CONF.adjustRelativePath(path);
                                                            editorprf.boxing().setUIValue("url(" + path + ")");
                                                            node.focus();
                                                        };
                                                    if (getSPA() && _false === getSPA().fe("beforeURISelectorPop",
                                                        ['canvas:background-image', (viewStyles && viewStyles["background-image"]) || "", _cb,
                                                            'RAD.Designer', $widget, node.get(0), cell, profile.boxing(), editorprf.boxing()
                                                        ])) return;

                                                    if (CONF.getClientMode() != 'singlepage') {
                                                        var path = viewStyles && viewStyles["background-image"] || "";
                                                        ood.ModuleFactory.getCom('RAD.ImageSelector', function () {
                                                            this.host = page;
                                                            this.setProperties({
                                                                'caption': "$(RAD.img.Image Selector)",
                                                                'image': 'ri ri-image-2-line',
                                                                'text': path,
                                                                'fromRegion': node.cssRegion(_true),
                                                                'onOK': function (obj, path) {
                                                                    _cb(path);
                                                                }
                                                            });
                                                            this.show();
                                                        });
                                                    }
                                                }
                                            }
                                            : {
                                                'type': "popbox",
                                                'value': (viewStyles && viewStyles["background-image"]) || "",
                                                'event': function (profile, cell, editorprf) {
                                                    var node = profile.getSubNode('CELL', cell._serialId);
                                                    ood.ModuleFactory.getCom('RAD.ImageSelector', function () {
                                                        this.setProperties({
                                                            'fromRegion': node.cssRegion(_true),
                                                            'onOK': function (obj, path) {
                                                                path = CONF.adjustRelativePath(path);
                                                                editorprf.boxing().setUIValue("url(" + path + ")");
                                                                node.focus();
                                                            }
                                                        });
                                                        this.show();
                                                    });
                                                }
                                            },
                                        'background-image'
                                    )
                                ]
                            },
                            {
                                'id': 'properties:background-position',
                                'noAPI': 1,
                                'cells': [{'caption': "$(RAD.custom_dlg.background$-position)"},
                                    bcell({
                                        'type': "combobox",
                                        'value': (viewStyles && viewStyles["background-position"]) || "",
                                        'editorListItems': CONF.designer_background_position
                                    }, 'background-position')
                                ]
                            },
                            {
                                'id': 'properties:background-repeat',
                                'noAPI': 1,
                                'cells': [{'caption': "$(RAD.custom_dlg.background$-repeat)"},
                                    bcell({
                                        'type': "combobox",
                                        'value': (viewStyles && viewStyles["background-repeat"]) || "",
                                        'editorListItems': CONF.designer_background_repeat
                                    }, 'background-repeat')
                                ]
                            },
                            {
                                'id': 'properties:background-attachment',
                                'noAPI': 1,
                                'cells': [{'caption': "$(RAD.custom_dlg.background$-attachment)"},
                                    bcell({
                                        'type': "combobox",
                                        'value': (viewStyles && viewStyles["background-attachment"]) || "",
                                        'editorListItems': CONF.designer_background_attachment
                                    }, 'background-attachment')
                                ]
                            }
                        ];
                    } else {
                        var rows = [
                            {
                                'id': 'properties:width', 'cells': [{'caption': '$RAD.designer.conf.canvas.width'},
                                    bcell({'type': 'number', 'unit': 'px', 'value': pro.properties.width}, 'width')
                                ]
                            },
                            {
                                'id': 'properties:height', 'cells': [{'caption': '$RAD.designer.conf.canvas.height'},
                                    bcell({'type': 'number', 'unit': 'px', 'value': pro.properties.height}, 'height')
                                ]
                            }
                        ];
                    }

                    var sub = [
                        {
                            'id': 'properties:autoDestroy',
                            'tipk': "prop", 'tipv': 'autoDestroy',
                            'cells': [{
                                'caption': '$RAD.designer.conf.canvas.autoDestroy',
                                'tips': CONF.enable_openAPI ? ('<div style="background-color:#EBEADB;">' + ood.getRes('RAD.designer.openapi') + '</div>') : ""
                            },
                                bcell({
                                    'type': 'checkbox',
                                    'value': false !== ood.get(data, ["Instance", "autoDestroy"])
                                }, 'autoDestroy')
                            ]
                        },
                        {
                            'id': 'properties:properties',
                            'tipk': "prop", 'tipv': 'properties',
                            'cells': [
                                {
                                    'caption': '$RAD.designer.conf.canvas.properties',
                                    'tips': CONF.enable_openAPI ? ('<div style="background-color:#EBEADB;">' + ood.getRes('RAD.designer.openapi') + '</div>') : ""
                                },
                                bcell({
                                    'type': 'button',
                                    'value': '[ $(RAD.designer.conf.Object) ]',
                                    'caption': '[ $(RAD.designer.conf.Object) ]',
                                    'event': function (profile, cell, pro, pos, e, src) {
                                        var text = page.stringify(ood.get(data, ["Instance", "properties"]) || {}),
                                            _cb = function (value) {
                                                var em = ood.get(data, ['Instance']);
                                                if (!em) ood.set(data, ['Instance'], em = {});
                                                var ov = em.properties;
                                                em.properties = typeof(value) == "string" ? ood.unserialize(value) : value;
                                                page.resetCode("Instance", "properties", page.stringify(value, '        '), _true, _false);

                                                if (page.markDirty)
                                                    page.markDirty(function () {
                                                        var em = ood.get(data, ['Instance']);
                                                        if (!em) ood.set(data, ['Instance'], em = {});
                                                        em.properties = ov;
                                                        page.resetCode("Instance", "properties", page.stringify(ov, '        '), _true, _false);
                                                    }, function () {
                                                        var em = ood.get(data, ['Instance']);
                                                        if (!em) ood.set(data, ['Instance'], em = {});
                                                        em.properties = value;
                                                        page.resetCode("Instance", "properties", page.stringify(value, '        '), _true, _false);
                                                    }, "set properties");
                                                ood(src).focus();
                                            };
                                        if (getSPA() && _false === getSPA().fe("beforeObjectEditorPop", [
                                            "jsonEditor", "properties", text, _cb,
                                            "RAD.Designer", data, ood(src).get(0), profile.boxing(), pro && pro.boxing()])) return;

                                        ood.getCom('RAD.JSONEditor', function (prf, cell) {
                                            this.host = page;
                                            this.setProperties({
                                                'imageClass': 'ri-file-code-line',
                                                'caption': "$RAD.designer.conf.canvas.properties",
                                                'text': text,
                                                'onOK': function (obj) {
                                                    _cb(obj.properties.object);
                                                }
                                            });
                                            this.show();
                                        });
                                    }
                                }, 'properties')
                            ]
                        },
                        {
                            'id': 'functions:functions',
                            'tipk': "prop", 'tipv': 'functions',
                            'hidden': !!page.$moduleInnerMode,
                            'cells': [
                                {
                                    'caption': '$RAD.designer.conf.canvas.functions',
                                    'tips': CONF.enable_openAPI ? ('<div style="background-color:#EBEADB;">' + ood.getRes('RAD.designer.openapi') + '</div>') : ""
                                },
                                bcell({
                                    'type': 'button',
                                    'value': '[ $(RAD.designer.conf.Editor) ]',
                                    'caption': '[ $(RAD.designer.conf.Editor) ]',
                                    'event': function (profile, cell, pro, pos, e, src) {
                                        ood.getCom('RAD.FunctionsEditor', function (prf, cell) {
                                            this.host = page;
                                            this.setProperties({
                                                'type': 'page',
                                                'page': page,
                                                'functions': ood.get(page, ['_cls', 'Instance', 'functions'])
                                            });
                                            this.setEvents({
                                                'onOK': function (value) {
                                                    var em = ood.get(data, ['Instance']);
                                                    if (!em) ood.set(data, ['Instance'], em = {});
                                                    var ov = em.functions || {};
                                                    if (!ov) ood.set(data, ['Instance', 'functions'], {});

                                                    em.functions = value;
                                                    page.resetCode("Instance", "functions", page.stringify(value, '        '), _true, _false);

                                                    if (page.markDirty)
                                                        page.markDirty(function () {
                                                            var em = ood.get(data, ['Instance']);
                                                            if (!em) ood.set(data, ['Instance'], em = {});
                                                            em.functions = ov;
                                                            page.resetCode("Instance", "functions", page.stringify(ov, '        '), _true, _false);
                                                        }, function () {
                                                            var em = ood.get(data, ['Instance']);
                                                            if (!em) ood.set(data, ['Instance'], em = {});
                                                            em.functions = value;
                                                            page.resetCode("Instance", "functions", page.stringify(value, '        '), _true, _false);
                                                        }, "set functions");
                                                    ood(src).focus();
                                                }
                                            });
                                            this.show();
                                        });
                                    }
                                }, 'functions')
                            ]
                        }
                    ];
                    ood.filter(rows, function (o, i) {
                        var arr = o.id.split(":"), key = arr[1] || o.id;
                        if (CONF.page_hiddenPropEvents[key]) return _false;
                        if (CONF.page_hiddenPropEvents_filter && _false === CONF.page_hiddenPropEvents_filter(key)) return _false;
                    });
                    ood.filter(sub, function (o, i) {
                        var arr = o.id.split(":"), key = arr[1] || o.id;
                        if (CONF.page_hiddenPropEvents[key]) return _false;
                        if (CONF.page_hiddenPropEvents_filter && _false === CONF.page_hiddenPropEvents_filter(key)) return _false;
                    });

                    if (!page.$moduleInnerMode) {
                        var arr = page.__buildSubRows(this.canvas, 'special', _true, grid);
                        if (arr && arr.length)
                            ood.arr.insertAny(sub, arr);
                        rows.push({
                            'id': "common",
                            'group': _true,
                            'caption': "<span class='ood-node-span ri ri-star-line' style='vertical-align:middle;font-weight: normal;height: 1em;width: 1em;vertical-align:text-bottom;'></span><span style='padding-'left':4px;'>" + "$(RAD.designer.conf.Commonly used)</span>",
                            'sub': sub
                        });

                        rows.push({
                            'id': 'UIE',
                            'group': _true,
                            'caption': "<span class='ood-node-span ri ri-cursor-line' style='vertical-align:middle;font-weight: normal;height: 1em;width: 1em;vertical-align:text-bottom;'></span><span style='padding-'left':4px;'>" + '$RAD.designer.conf.Events</span>',
                            'sub': _true
                        });
                    }
                }
                // module
                else if (ids[0] && ood.getObject(ids[0]) && ood.getObject(ids[0])['ood.Module']) {
                    var pro = ood.getObject(ids[0]),
                        rows = [];

                    rows.push({
                        'id': 'key', 'tipk': 'class',
                        'cells': [{
                            'caption': '<strong>$RAD.designer.words.class</strong>',
                            'tips': ood.getRes('RAD.designer.openapi')
                        },
                            bcell({
                                'disabled': _true, 'value': '<strong>' + pro.key + '</strong>', 'type': 'label',
                                'tips': ood.getRes('RAD.designer.openapi')
                            }, 'class')]
                    });
                    rows.push({
                        'id': 'alias', 'tipk': 'fun', 'tipv': 'setAlias',
                        'cells': [{'caption': '<strong>$RAD.designer.words.alias</strong>'},
                            bcell({'value': pro.alias, 'type': 'input'}, 'alias')
                        ]
                    });

                    rows.push({
                        'id': 'properties:inner-designer', 'cells': [
                            {
                                'caption': '$(RAD.designer.conf.canvas.inner$-designer)'
                            },
                            bcell({
                                'type': 'button',
                                'tagVar': pro,
                                'value': '[ $(RAD.designer.conf.Editor) ]',
                                'caption': '[ $(RAD.designer.conf.Editor) ]',
                                'event': function (profile, cell, prof, pos, e, src) {
                                    page._decorationWnd(pro, src);
                                }
                            }, 'inner-designer')]
                    });

                    rows.push({
                        'id': 'properties:properties', 'cells': [
                            {
                                'caption': '$RAD.designer.conf.canvas.properties'
                            },
                            bcell({
                                'type': 'button',
                                'tagVar': pro,
                                'value': '[ $(RAD.designer.conf.Object) ]',
                                'caption': '[ $(RAD.designer.conf.Object) ]',
                                'event': function (profile, cell, pro, pos, e, src) {
                                    var ov = ood.clone(cell.tagVar.properties),
                                        text = page.stringify(cell.tagVar.properties || {}),
                                        _cb = function (value) {
                                            cell.tagVar.setProperties(value, _true);

                                            if (page.markDirty)
                                                page.markDirty(function () {
                                                    cell.tagVar.setProperties(ov, _true);
                                                }, function () {
                                                    cell.tagVar.setProperties(value, _true);
                                                }, "set properties");
                                            ood(src).focus();
                                        };
                                    if (getSPA() && _false === getSPA().fe("beforeObjectEditorPop", [
                                        "jsonEditor", "properties", text, _cb,
                                        "RAD.Designer", cell.tagVar.boxing(), ood(src).get(0), profile.boxing(), pro && pro.boxing()])) return;

                                    ood.getCom('RAD.JSONEditor', function (prf) {
                                        this.host = page;
                                        this.setProperties({
                                            'imageClass': 'ri ri-equalizer-line',
                                            'caption': "$RAD.designer.conf.canvas.properties",
                                            'text': text,
                                            'onOK': function (obj) {
                                                _cb(obj.properties.object);
                                            }
                                        });
                                        this.show();
                                    });
                                }
                            }, 'properties')
                        ]
                    });

                    ood.filter(rows, function (o, i) {
                        var arr = o.id.split(":"), key = arr[1] || o.id;
                        if (CONF.page_hiddenPropEvents[key]) return _false;
                        if (CONF.page_hiddenPropEvents_filter && _false === CONF.page_hiddenPropEvents_filter(key)) return _false;
                    });
                    if (!page.$moduleInnerMode) {
                        var sub = [];
                        var arr = page.__buildSubRows(pro, 'special', _true, grid);
                        if (arr && arr.length)
                            ood.arr.insertAny(sub, arr);
                        rows.push({
                            'id': "common",
                            'group': _true,
                            'caption': "<span class='ood-node-span ri ri-star-line' style='vertical-align:middle;font-weight: normal;height: 1em;width: 1em;vertical-align:text-bottom;'></span><span style='padding-'left':4px;'>" + "$(RAD.designer.conf.Commonly used)</span>",
                            'sub': sub
                        });
                        rows.push({
                            'id': 'UIE',
                            'group': _true,
                            'caption': "<span class='ood-node-span ri ri-cursor-line' style='vertical-align:middle;font-weight: normal;height: 1em;width: 1em;vertical-align:text-bottom;" + "'></span><span style='padding-'left':4px;'>" + '$RAD.designer.conf.Events</span>',
                            'sub': _true
                        });
                    }
                }
                // widget
                else {
                    var t, len,
                        uis = page.getByCacheId(ids),
                        pro,
                        disabled = _false,
                        rows = [];
                    if (len = uis._nodes.length) {
                        pro = uis.get(this.SelectedFocus);
                        if (!!page.$moduleInnerMode || len > 1) disabled = _true;
                    }
                    // non-ui control
                    else {
                        pro = ood.getObject(ids[0]);
                        uis = pro.boxing();
                        len = 1;
                    }
                    if (!pro) {
                        return;
                    }

                    rows.push({
                        'id': 'key', 'tipk': 'class',
                        'cells': [
                            {
                                'caption': '<strong>$RAD.designer.words.class</strong>',
                                'tips': ood.getRes('RAD.designer.openapi')
                            },
                            bcell({
                                'disabled': _true, 'value': '<strong>' + pro.key + '</strong>', 'type': 'label',
                                'tips': ood.getRes('RAD.designer.openapi')
                            }, 'class')]
                    });
                    rows.push({
                        'id': 'alias', 'tipk': 'fun', 'tipv': 'setAlias',
                        'cells': [
                            {
                                'caption': '<strong>$RAD.designer.words.alias</strong>',
                                'tips': ood.getRes('RAD.designer.openapi')
                            },
                            bcell({'value': pro.alias, 'type': 'input', 'disabled': disabled}, 'alias')]
                    });
                    rows.push({
                        'id': 'properties:name', 'tipk': 'property', 'tipv': "name",
                        'cells': [
                            {
                                'caption': '<strong>$doc.propname.ood_absObj.name</strong>',
                                'tips': ood.getRes('RAD.designer.openapi')
                            },
                            bcell({'value': pro.properties.name, 'type': 'input', 'disabled': disabled}, 'name')]
                    });
                    rows.push({
                        'id': 'properties:desc', 'tipk': 'property', 'tipv': "desc",
                        'cells': [
                            {
                                'caption': '<strong>$doc.propname.ood_absObj.desc</strong>',
                                'tips': ood.getRes('RAD.designer.openapi')
                            },
                            bcell({'value': pro.properties.desc, 'type': 'input', 'disabled': disabled}, 'desc')]
                    });
                    if ('locked' in pro.properties) {
                        rows.push({
                            'id': 'properties:locked', 'tipk': 'property', 'tipv': "locked",
                            'cells': [
                                {
                                    'caption': '<strong>$doc.propname.ood_UI.locked</strong>',
                                    'tips': ood.getRes('RAD.designer.openapi')
                                },
                                bcell({'value': pro.properties.locked, 'type': 'checkbox'}, 'locked')
                            ]
                        });
                    }
                    if ('required' in pro.properties) {
                        rows.push({
                            'id': 'properties:required', 'tipk': 'property', 'tipv': "required",
                            'cells': [
                                {
                                    'caption': '<strong>$doc.propname.ood_absValue.required</strong>',
                                    'tips': ood.getRes('RAD.designer.openapi')
                                },
                                bcell({'value': pro.properties.required, 'type': 'checkbox'}, 'required')]
                        });
                    }

                    if (('tabindex' in pro.properties) && !pro.box.$DataModel.tabindex.hidden) {
                        rows.push({
                            'id': 'properties:tabindex', 'tipk': 'property', 'tipv': "tabindex",
                            'cells': [
                                {
                                    'caption': '<strong>$doc.propname.ood_UI.tabindex</strong>',
                                    'tips': ood.getRes('RAD.designer.openapi')
                                },
                                bcell({
                                    'value': pro.properties.tabindex,
                                    'type': 'spin',
                                    editMode: 'hover',
                                    precision: 0,
                                    step: 1,
                                    min: -1,
                                    max: 999999990,
                                    'disabled': disabled
                                }, 'tabindex')
                            ]
                        });
                    }
                    if (('zIndex' in pro.properties) && !pro.box.$DataModel.zIndex.hidden) {
                        rows.push({
                            'id': 'properties:zIndex', 'tipk': 'property', 'tipv': "zIndex",
                            'cells': [
                                {
                                    'caption': '<strong>$doc.propname.ood_UI.zIndex</strong>',
                                    'tips': ood.getRes('RAD.designer.openapi')
                                },
                                bcell({
                                    'value': pro.properties.zIndex,
                                    'type': 'spin',
                                    editMode: 'hover',
                                    precision: 0,
                                    step: 1,
                                    min: 0,
                                    max: 9999,
                                    'disabled': disabled
                                }, 'zIndex')
                            ]
                        });
                    }


                    var editorListItems = [];
                    if (pro.box["ood.UI.FusionChartsXT"]) {
                        editorListItems = ["fint", "carbon", "ocean", "zune"];
                    } else if (CONF.CustomThemes) {
                        editorListItems = CONF.CustomThemes[pro.key] || [];
                    }

                    if (!CONF.enable_codeEdtor) {
                        if (pro.domId && pro.box['ood.UI']) {
                            rows.push(
                                {
                                    'id': 'theme', 'tipk': 'fun', 'tipv': 'setTheme', 'cells': [
                                        {
                                            'caption': '<strong>$RAD.designer.words.theme</strong>',
                                            'tips': ood.getRes('RAD.designer.openapi')
                                        },
                                        bcell({
                                            'value': pro.theme,
                                            'type': 'combobox',
                                            'disabled': disabled,
                                            'editorListItems': editorListItems
                                        }, 'theme')
                                    ]
                                }
                            );
                        }
                    }

                    //if single selected
                    if (len == 1) {
                        //get the important properties:
                        var arr = page.__buildSubRows(uis, 'special', _true, grid);
                        if (arr && arr.length)
                            rows.push({
                                'id': "common",
                                'group': _true,
                                'caption': "<span class='ood-node-span ri ri-star-line' style='vertical-align:middle;font-weight: normal;height: 1em;width: 1em;vertical-align:text-bottom;" + "'></span><span style='padding-'left':4px;'>" + "$(RAD.designer.conf.Commonly used)</span>",
                                'sub': arr
                            });
                    }
                    rows.push({
                        'id': 'properties',
                        'group': _true,
                        'caption': "<span class='ood-node-span ri ri-settings-3-line' style='vertical-align:middle;font-weight: normal;height: 1em;width: 1em;vertical-align:text-bottom;'></span><span style='padding-left:4px;'>" + '$RAD.designer.conf.Properties</span>',
                        'sub': _true
                    });
                    //if single selected
                    if (!page.$moduleInnerMode && len == 1) {
                        if (pro.box && !ood.isEmpty(pro.box.$EventHandlers))
                            rows.push({
                                'id': 'UIE',
                                'group': _true,
                                'caption': "<span class='ood-node-span ri ri-cursor-line' style='vertical-align:middle;font-weight: normal;height: 1em;width: 1em;vertical-align:text-bottom;" + "'></span><span style='padding-'left':4px;'>" + '$RAD.designer.conf.Events</span>',
                                'sub': _true
                            });
                    }

                    if (!page.$moduleInnerMode && CONF.enable_codeEdtor) {
                        if (pro.domId && pro.box['ood.UI']) {
                            rows.push({
                                'id': 'others', 'group': _true, 'caption': '$RAD.designer.conf.Others', 'sub': [
                                    {
                                        'id': 'domId',
                                        'tipk': 'fun',
                                        'tipv': 'setDomId',
                                        'value': 'setDomId',
                                        'cells': [
                                            {
                                                'caption': '$RAD.designer.words.domId',
                                                'tips': ood.getRes('RAD.designer.openapi')
                                            },
                                            {'value': pro.domId, 'type': 'input', 'disabled': disabled}
                                        ]
                                    },
                                    {
                                        'id': 'theme', 'tipk': 'fun', 'tipv': 'setTheme', 'cells': [
                                            {
                                                'caption': '$RAD.designer.words.theme',
                                                'tips': ood.getRes('RAD.designer.openapi')
                                            },
                                            {
                                                'value': pro.theme,
                                                'type': 'combobox',
                                                'disabled': disabled,
                                                'editorListItems': editorListItems
                                            }
                                        ]
                                    }
                                ]
                            });
                        }
                    }
                }

                grid.removeAllRows();

                // Give a chance to modify editor setting for rows
                getSPA() && getSPA().fe("onInitEditorRows", [_null, _null, $widget.get(0).properties,
                    'RAD.Designer', $widget, rows, grid]);

                grid.setRows(rows);
                // filter
                var filterword = page.propFilter.getUIValue();
                if (!filterword) {
                    grid.toggleRow('common', _true);
                    grid.toggleRow('properties', _true);
                    if (!page.$moduleInnerMode)
                        grid.toggleRow('UIE', _true);
                }
            },
            markDirty: function (undo, redo, tips) {
                var ns = this;
                ns._dirty = _true;
                ns.fireEvent("onValueChanged", [ns, _true], ns.host);

                // recode history
                if (redo && undo) {
                    ns._recordHistory(undo, redo, tips);
                }
            },
            'clearDirty': function (force) {
                var ns = this;
                ns._dirty = ns._canvaseventdirty = ns._desingviewdirty = ns._styledirty = _false;
                // reset undo history
                ns._resetHistory();
                ns.fireEvent("onValueChanged", [ns, _false, force], ns.host);
            },

            '_undoDepth': 50,
            '_undoHistory': _null,
            '_undoPointer': 0,
            '_recordHistory': function (undo, redo, tips) {
                var ns = this;

                if (!ns._undoHistory) ns._undoHistory = [];

                // clear tail first
                if (ns._undoPointer < ns._undoHistory.length - 1) {
                    ns._undoHistory.splice(ns._undoPointer + 1);
                }

                // check depth
                while (ns._undoHistory.length >= ns._undoDepth) {
                    ns._undoHistory.shift();
                }
                // push history
                ns._undoHistory.push({
                    'undo': undo,
                    'redo': redo,
                    'tips': tips
                });

                // ensure pointer
                ns._undoPointer = ns._undoHistory.length - 1;
                // refresh buttons

                ood.resetRun("desingerredoundo", function () {
                    if (!ns.toolbar) return;
                    ns.toolbar.updateItem("undo", {
                        'disabled': _false,
                        'tips': ood.wrapRes("$RAD.designer.tool.undo") + " : " + ns._undoHistory[ns._undoPointer].tips
                    });
                    ns.toolbar.updateItem("redo", {'disabled': _true, 'tips': _null});
                });
            },
            '_resetHistory': function (memoryonly) {
                var ns = this;
                if (!ns._undoHistory) ns._undoHistory = [];
                ood.breakO(ns._undoHistory, 2);
                ns._undoPointer = ns._undoHistory.length = 0;
                if (memoryonly) return;

                // refresh buttons
                ood.resetRun("desingerredoundo", function () {
                    if (!ns.toolbar) return;
                    ns.toolbar.updateItem("undo", {'disabled': _true, 'tips': _null});
                    ns.toolbar.updateItem("redo", {'disabled': _true, 'tips': _null});
                });
            },
            '_redo': function (pos) {
                var ns = this;
                ns._clearSelect();
                ns._setSelected([], _true);

                if (ns._undoPointer >= ns._undoHistory.length - 1) return;
                var action = ns._undoHistory[ns._undoPointer + 1];

                // disable those first
                ns.toolbar.updateItem("undo", {'disabled': _true, 'tips': _null});
                ns.toolbar.updateItem("redo", {'disabled': _true, 'tips': _null});

                try {
                    ood.tryF(action.redo, [], ns);
                    ns._undoPointer++;

                    ood.resetRun("desingerredoundo", function () {
                        if (!ns.toolbar) return;
                        ns.toolbar.updateItem("undo", {
                            'disabled': _false,
                            'tips': ood.wrapRes("$RAD.designer.tool.undo") + " : " + ns._undoHistory[ns._undoPointer].tips
                        });
                        var disabled = ns._undoPointer >= ns._undoHistory.length - 1;
                        var redotip = disabled ? _null : (ood.wrapRes("$RAD.designer.tool.redo") + " : " + ns._undoHistory[ns._undoPointer + 1].tips);
                        ns.toolbar.updateItem("redo", {'disabled': disabled, 'tips': redotip});

                        if (pos && redotip) ood.Tips.show(pos, redotip);
                        else ood.Tips.hide();
                    });
                } catch (e) {
                    ood.echo(action.undo + "", action.redo + "", e.toString());
                    ns._resetHistory();
                } finally {
                    ns.markDirty();
                }
            },
            '_undo': function (pos) {
                var ns = this;
                ns._styledirty = _true;
                ns._clearSelect();
                ns._setSelected([], _true);

                if (ns._undoPointer < 0) return;
                // ensure tail
                if (ns._undoPointer >= ns._undoHistory.length) ns._undoPointer = ns._undoHistory.length - 1;

                var action = ns._undoHistory[ns._undoPointer];

                // disable those first
                ns.toolbar.updateItem("undo", {'disabled': _true, 'tips': _null});
                ns.toolbar.updateItem("redo", {'disabled': _true, 'tips': _null});
                try {
                    ood.tryF(action.undo, [], ns);
                    ns._undoPointer--;

                    ood.resetRun("desingerredoundo", function () {
                        if (!ns.toolbar) return;
                        var undotip = ns._undoPointer < 0 ? _null : (ood.wrapRes("$RAD.designer.tool.undo") + " : " + ns._undoHistory[ns._undoPointer].tips);
                        ns.toolbar.updateItem("undo", {'disabled': ns._undoPointer < 0, 'tips': undotip});
                        ns.toolbar.updateItem("redo", {
                            'disabled': _false,
                            'tips': ood.wrapRes("$RAD.designer.tool.redo") + " : " + ns._undoHistory[ns._undoPointer + 1].tips
                        });

                        if (pos && undotip) ood.Tips.show(pos, undotip);
                        else ood.Tips.hide();
                    });
                } catch (e) {
                    ood.echo(action.undo + "", action.redo + "", e);
                    ns._resetHistory();
                } finally {
                    ns.markDirty();
                }
            },

            //avoid to conflict with design code
            '$toolbar_onclick': function (profile, item, group, e, src) {
                this._toolbaraction(item, group, e, src);
            },
            '_toolbaraction': function (item, group, e, src) {
                var page = this, id = item.id;
                switch (group.id) {
                    case 'inter':
                        if (id == 'intermap') {
                            page.toInterMap();
                        }
                        break;
                    case 'tocode':
                        if (id == 'tocode' && page.toCodeView) {
                            page.toCodeView();
                        }
                        break;
                    case 'componentmenu':
                        if (!ns.ViewMenuBar) {
                            ns.ViewMenuBar = {}
                        }
                        ;
                        if (!ns.ViewMenuBar[item.id]) {
                            ood.create("ood.APICaller")
                                .setHost(ns, "getActions")
                                .setProperties('src', src)
                                .setResponseDataTarget([
                                    {
                                        "type": "popmenu",
                                        "name": "PAGECTX",
                                        "path": "data"
                                    }
                                ])
                                .setQueryArgs({
                                    "viewBarId": item.id,
                                    "pos": {src: src}
                                })
                                .setResponseCallback()
                                .setQueryURL("/radplugins/getActions").invoke();


                        } else {
                            ns.ViewMenuBar[item.id].pop(src);
                        }

                        break;

                    case 'dsm':
                        switch (id) {

                            case 'rePackage':
                                var selectAlias = [];
                                ood.each(getSPA().getSelected(), function (node) {
                                    selectAlias.push(node.alias);
                                });
                                hash = {
                                    projectName: getSPA().curProjectName,
                                    currCom: selectAlias,
                                    currentClassName: getSPA().getCurrentClassName()
                                };
                                ood.showModule2("dsm.view.config.entity.RePackage", null, null, hash);
                                break;

                            case 'dsmmanager':
                                hash = {
                                    projectName: getSPA().curProjectName,
                                    domainId: getSPA().domainId,
                                    currentClassName: getSPA().getCurrentClassName()
                                };
                                ood.showModule2("dsm.view.config.entity.DSMModuleView", null, null, hash);
                                break;
                        }

                    case 'debugpreview':
                        switch (id) {
                            // case 'publicRemote':
                            //     $ESD.publicRemote();
                            //     break;
                            // case 'publicLocal':
                            //     $ESD.publicLocal();
                            //     break;
                            case 'version':
                                var tb = SPA.tabsMain,
                                    id = tb.getUIValue(),
                                    o = tb.getItemByItemId(id),
                                    hash = {path: o.id};
                                ood.ModuleFactory.getModule('RAD.VersionManager', function () {
                                        this.show(null, null, null, null, hash);
                                    }
                                );

                                break;
                            case 'preview':
                                if (CONF.getClientMode() != 'project') {
                                    CONF.previewPage2(getSPA());
                                } else {
                                    if (CONF.clientType && CONF.clientType == 'ESDClient') {
                                       // var className = ood.getClassName(getSPA().getCurrentClassName().replace(getSPA().curProjectPath + "/", ""));
                                        var className = ood.getClassName(getSPA().getCurrentClassName());
                                        if (className){
                                            CONF.debugApp("/", className + ".cls", {
                                                'rand': ood.rand(),
                                                'tag': ood.getClassName(className),
                                                'width': page.canvas.getWidth(),
                                                'height': page.canvas.getHeight(),
                                                'theme': ood.get(getSPA(), ['curProjectConfig', '$PageAppearance', 'theme']) || '',
                                                'ficdn': ood.get(getSPA(), ['curProjectConfig', '$FontIconsCDN']) || '',
                                                'lang': ood.getLang()
                                            }, false);
                                        }else{
                                            CONF.debugApp("/","debug", {
                                                'rand': ood.rand(),
                                                'tag': getSPA().currentPage,
                                                'width': page.canvas.getWidth(),
                                                'height': page.canvas.getHeight(),
                                                'theme': ood.get(getSPA(), ['curProjectConfig', '$PageAppearance', 'theme']) || '',
                                                'ficdn': ood.get(getSPA(), ['curProjectConfig', '$FontIconsCDN']) || '',
                                                'lang': ood.getLang()
                                            }, false);
                                        }


                                    } else {
                                        CONF.debugApp("/debug/" + getSPA().curProjectName + "/", "debug.html", {
                                            'rand': ood.rand(),
                                            'width': page.canvas.getWidth(),
                                            'height': page.canvas.getHeight(),
                                            'touch': page.$touchdivce || 0,
                                            'cls': ood.getClassName(getSPA().getCurrentClassName().replace(getSPA().curProjectPath + "/", "")),
                                            'theme': ood.get(getSPA(), ['curProjectConfig', '$PageAppearance', 'theme']) || '',
                                            'ficdn': ood.get(getSPA(), ['curProjectConfig', '$FontIconsCDN']) || '',
                                            'lang': ood.getLang()
                                        }, false);
                                    }
                                }
                                break;
                        }
                        break;

                    case 'undoredo':
                        switch (id) {
                            case 'undo':
                                page._undo(ood.Event.getPos(e));
                                break;
                            case 'redo':
                                page._redo(ood.Event.getPos(e));
                                break;
                            case 'refresh':
                                var dirty = page._dirty;
                                var config = getSPA().tabsMain.getSelectedItem();
                                var item = {
                                    id: config.id,
                                    value: config.id,
                                    reload: true,
                                    className: config.className,
                                    name: config.caption
                                }

                                getSPA().reloadPage()
                                if (dirty) page.markDirty();
                                ood.message(ood.getRes('RAD.designer.refreshOK'));
                                break;
                        }
                        break;
                    case
                    'view'
                    :
                        switch (id) {
                            case 'viewsize':
                                page.popViewSize.pop(src);
                                break;
                            case 'mobile':
                                page.setMobileFrame(item.value, _false);
                                if (CONF.getClientMode() != 'project') {
                                    page._desingviewdirty = _true;
                                }
                                break;
                        }
                        break;
                    case
                    'codegroup'
                    :
                        switch (id) {
                            case 'datacode':
                                page.popData.pop(src);
                                return;
                            case 'jscode':
                            case 'json':
                            case 'prfs':
                            case 'data':
                            case 'value':
                                var t, nodes, code, aliass = {},
                                    ws = page.getByCacheId(page.tempSelected);
                                if (!ws.isEmpty()) {
                                    nodes = [];
                                    ws.each(function (target) {
                                        target = (target['ood.Module'] ? target : target.getModule(_true)) || target;
                                        if (aliass[target.alias]) return;
                                        aliass[target.alias] = 1;
                                        nodes.push(target);
                                    });
                                } else {
                                    nodes = page.getWidgets(_true);
                                }
                                switch (id) {
                                    case 'jscode':
                                        code = page.getJSCode(nodes);
                                        code = "(function Code(){\n    " + code.replace(/(\r\n|\n)/g, '$1    ') + "\n}());"
                                        break;
                                    case 'json':
                                        code = ood.Coder.formatText(page.getJSONCode(nodes), 'js');
                                        break;
                                    case 'prfs':
                                        var com = new ood.Module(), code = page.getJSCode(nodes);
                                        com.iniComponents = new Function([], code);
                                        code = ood.Coder.formatText(ood.stringify(com.getProfile()), 'js');
                                        com.destroy(_true, _true);
                                        com = _null;
                                        break;
                                    case 'data':
                                        var com = new ood.Module(), code = page.getJSCode(nodes);
                                        com.iniComponents = new Function([], code);
                                        code = ood.Coder.formatText(ood.stringify(com.getData()), 'js');
                                        com.destroy(_true, _true);
                                        com = _null;
                                        break;
                                    case 'value':
                                        var com = new ood.Module(), code = page.getJSCode(nodes);
                                        com.iniComponents = new Function([], code);
                                        code = ood.Coder.formatText(ood.stringify(com.getValue(_true)), 'js');
                                        com.destroy(_true, _true);
                                        com = _null;
                                        break;
                                }

                                if (getSPA() && _false === getSPA().fe("beforeObjectEditorPop", [
                                    "objectEditor", id, code, function () {
                                        // do nothing
                                    },
                                    "RAD.Designer", page, ood(src).get(0)])) return;

                                ood.showCom('RAD.ObjectEditor2', function () {
                                }, function () {
                                    this._codetype = id == "jscode" ? "js" : "json";
                                    this.setValue(code);
                                });
                                break;
                        }
                        break;
                    // not in toolbar , in the popmenu
                    case
                    'aligngroup'
                    :
                        if (id == "align") {
                            page.popAlign.pop(src);
                            return;
                        }
                        var sel = page.getByCacheId(this.tempSelected);
                        var p = sel.get(this.SelectedFocus),
                            o = p.getRoot(),
                            size, pos, node, svg, region, oregion, action,
                            oPos, osize,
                            redoA = [],
                            undoA = [];
                        svg = p.box['ood.svg'];
                        if (svg) {
                            oregion = p.boxing()._getBBox();
                            size = {'width': Math.round(oregion.width), 'height': Math.round(oregion.height)};
                            pos = {'left': Math.round(oregion.x), 'top': Math.round(oregion.y)};
                        } else {
                            size = o.cssSize();
                            pos = o.cssPos();
                        }
                        sel.each(function (o) {
                            if (o.locked) return;
                            // cant move locked
                            if (o.properties && o.properties.locked) return;

                            var alias, offleft, offtop, offw, offh;

                            alias = o.alias;
                            svg = o.box['ood.svg'];
                            if (svg) {
                                node = o.boxing();
                                region = {};
                                switch (id) {
                                    case "left":
                                        region.x = pos.left;
                                        break;
                                    case "center":
                                        region.x = pos.left + size.width / 2 - node.getWidth() / 2;
                                        break;
                                    case "right":
                                        region.x = pos.left + size.width - node.getWidth();
                                        break;
                                    case "top":
                                        region.y = pos.top;
                                        break;
                                    case "middle":
                                        region.y = pos.top + size.height / 2 - node.getHeight() / 2;
                                        break;
                                    case "bottom":
                                        region.y = pos.top + size.height - node.getHeight();
                                        break;
                                    case 'w':
                                    case 'wh':
                                    case 'h':
                                        region.width = size.width;
                                        region.height = size.height;
                                        break;
                                }
                                page._refresh(alias, 'bBox', _null, region);

                                redoA.push(function () {
                                    page._refresh(alias, 'bBox', _null, region, _false);
                                });
                                undoA.push(function () {
                                    page._refresh(alias, 'bBox', _null, oregion, _false);
                                });
                            } else {
                                node = o.getRoot();
                                oPos = node.cssPos();
                                osize = node.cssSize();

                                switch (id) {
                                    case "left":
                                        if ((offleft = pos.left - oPos.left)) {
                                            page._refresh(alias, 'left', {'left': offleft});

                                            redoA.push(function () {
                                                page._refresh(alias, 'left', {'left': offleft}, _null, _false);
                                            });
                                            undoA.push(function () {
                                                page._refresh(alias, 'left', {'left': -offleft}, _null, _false);
                                            });
                                        }
                                        break;
                                    case "center":
                                        if ((offleft = pos.left + size.width / 2 - osize.width / 2 - oPos.left)) {
                                            page._refresh(alias, 'left', {'left': offleft});

                                            redoA.push(function () {
                                                page._refresh(alias, 'left', {'left': offleft}, _null, _false);
                                            });
                                            undoA.push(function () {
                                                page._refresh(alias, 'left', {'left': -offleft}, _null, _false);
                                            });
                                        }
                                        break;
                                    case "right":
                                        if ((offleft = pos.left + size.width - osize.width - oPos.left)) {
                                            page._refresh(alias, 'left', {'left': offleft});

                                            redoA.push(function () {
                                                page._refresh(alias, 'left', {'left': offleft}, _null, _false);
                                            });
                                            undoA.push(function () {
                                                page._refresh(alias, 'left', {'left': -offleft}, _null, _false);
                                            });
                                        }
                                        break;
                                    case "top":
                                        if ((offtop = pos.top - oPos.top)) {
                                            page._refresh(alias, 'top', {'top': offtop});

                                            redoA.push(function () {
                                                page._refresh(alias, 'top', {'top': offtop}, _null, _false);
                                            });
                                            undoA.push(function () {
                                                page._refresh(alias, 'top', {'top': -offtop}, _null, _false);
                                            });
                                        }
                                        break;
                                    case "middle":
                                        if ((offtop = pos.top + size.height / 2 - osize.height / 2 - oPos.top)) {
                                            page._refresh(alias, 'top', {'top': offtop});

                                            redoA.push(function () {
                                                page._refresh(alias, 'top', {'top': offtop}, _null, _false);
                                            });
                                            undoA.push(function () {
                                                page._refresh(alias, 'top', {'top': -offtop}, _null, _false);
                                            });
                                        }
                                        break;
                                    case "bottom":
                                        if ((offtop = pos.top + size.height - osize.height - oPos.top)) {
                                            page._refresh(alias, 'top', {'top': offtop});

                                            redoA.push(function () {
                                                page._refresh(alias, 'top', {'top': offtop}, _null, _false);
                                            });
                                            undoA.push(function () {
                                                page._refresh(alias, 'top', {'top': -offtop}, _null, _false);
                                            });
                                        }
                                        break;

                                    case 'w':
                                        if ((offw = size.width - osize.width)) {
                                            page._refresh(alias, 'width', {'width': offw});

                                            redoA.push(function () {
                                                page._refresh(alias, 'width', {'width': offw}, _null, _false);
                                            });
                                            undoA.push(function () {
                                                page._refresh(alias, 'width', {'width': -offw}, _null, _false);
                                            });
                                        }
                                        break;
                                    case 'wh':
                                        if ((offw = size.width - osize.width) || (offh = size.height - osize.height)) {
                                            page._refresh(alias, 'width', {'width': offw});
                                            page._refresh(alias, 'height', {'height': offh});

                                            redoA.push(function () {
                                                page._refresh(alias, 'width', {'width': offw}, _null, _false);
                                                page._refresh(alias, 'height', {'height': offh}, _null, _false);
                                            });
                                            undoA.push(function () {
                                                page._refresh(alias, 'width', {'width': -offw}, _null, _false);
                                                page._refresh(alias, 'height', {'height': -offh}, _null, _false);
                                            });
                                        }
                                        break;
                                    case 'h':
                                        if ((offh = size.height - osize.height)) {
                                            page._refresh(alias, 'height', {'height': offh});

                                            redoA.push(function () {
                                                page._refresh(alias, 'height', {'height': offh}, _null, _false);
                                            });
                                            undoA.push(function () {
                                                page._refresh(alias, 'height', {'height': -offh}, _null, _false);
                                            });
                                        }
                                        break;
                                }
                            }
                        });
                        this.resizer.rePosSize();
                        this._focus();

                        // undo-redo : modify pos/size by toolbar align/size command
                        page.markDirty(function () {
                            ood.arr.each(undoA, function (f) {
                                ood.tryF(f);
                            });
                        }, function () {
                            ood.arr.each(redoA, function (f) {
                                ood.tryF(f);
                            });
                        }, "set controls' " + ((id == "w" || id == 'h' || id == 'wh') ? "size" : "position"));

                        break;
                    case
                    'pos'
                    :
                        var sel = page.getByCacheId(this.tempSelected),
                            zIndex = 0,
                            undoA = [], redoA = [];
                        sel.each(function (o) {
                            var alias = o.alias,
                                ins = o.boxing(),
                                node = ins.reBoxing();

                            switch (id) {
                                case "zindex1":
                                    var ozindex;
                                    if (o.locked) return;
                                    if (o.properties && o.properties.locked) return;
                                    if (o.box['ood.svg']) {
                                        o.boxing().toFront();

                                        // Imprecise
                                        redoA.push(function () {
                                            var o = page.getByAlias(alias);
                                            o.toFront();
                                        });
                                        undoA.push(function () {
                                            var o = page.getByAlias(alias);
                                            o.toBack();
                                        });

                                    } else {
                                        if (!zIndex) zIndex = node.topZindex();
                                        ozindex = node.css('zIndex');

                                        var redo = function () {
                                            page.getByAlias(alias).getRoot().css('zIndex', zIndex + 1);
                                            page.profileGrid.updateCellByRowCol('properties:zIndex', 'value', {'value': zIndex + 1});
                                        };
                                        redo();

                                        redoA.push(redo);
                                        undoA.push(function () {
                                            page.getByAlias(alias).getRoot().css('zIndex', ozindex);
                                            page.profileGrid.updateCellByRowCol('properties:zIndex', 'value', {'value': ozindex});
                                        });

                                        page._refresh(ins, 'zIndex');
                                    }

                                    break;
                                case "zindex2":
                                    if (o.locked) return;
                                    if (o.properties && o.properties.locked) return;
                                    if (o.box['ood.svg']) {
                                        o.boxing().toBack();

                                        // Imprecise
                                        redoA.push(function () {
                                            var o = page.getByAlias(alias);
                                            o.toBack();
                                        });
                                        undoA.push(function () {
                                            var o = page.getByAlias(alias);
                                            o.toFront();
                                        });
                                    } else {
                                        ozindex = node.css('zIndex');

                                        var redo = function () {
                                            page.getByAlias(alias).getRoot().css('zIndex', 0);
                                            page.profileGrid.updateCellByRowCol('properties:zIndex', 'value', {'value': 0});
                                        };
                                        redo();

                                        redoA.push(redo);
                                        undoA.push(function () {
                                            page.getByAlias(alias).getRoot().css('zIndex', ozindex);
                                            page.profileGrid.updateCellByRowCol('properties:zIndex', 'value', {'value': ozindex});
                                        });

                                        page._refresh(ins, 'zIndex');
                                    }
                                    break;
                                case "order_up":
                                    if (o.locked) return;
                                    if (o.properties && o.properties.locked) return;
                                    if (!o.box['ood.svg']) {
                                        var root = o.getRoot(), prev = root.prev();
                                        while (prev.n0 && !ood.UIProfile.getFromDom(prev.id())) prev = prev.prev();
                                        if (!root.isEmpty() && !prev.isEmpty()) {
                                            // swap
                                            root.swap(prev);
                                            // set inner order index for sort
                                            root.parent().children().each(function (n, i) {
                                                if (n = ood.UIProfile.getFromDom(n.id)) {
                                                    n.properties._dockOrder = i + 1;
                                                }
                                            });
                                            // sort
                                            page._sortchildren(o.parent.children, true);

                                            o.boxing().adjustDock(true);
                                            ood.asyRun(function () {
                                                if (page.resizer) page.resizer.rePosSize();
                                            });
                                        }
                                    }
                                    break;
                                case "order_down":
                                    if (o.locked) return;
                                    if (o.properties && o.properties.locked) return;
                                    if (!o.box['ood.svg']) {
                                        var root = o.getRoot(), next = root.next();
                                        while (next.n0 && !ood.UIProfile.getFromDom(next.id())) next = next.next();
                                        if (!root.isEmpty() && !next.isEmpty()) {
                                            // swap
                                            root.swap(next);
                                            // set inner order index for sort
                                            root.parent().children().each(function (n, i) {
                                                if (n = ood.UIProfile.getFromDom(n.id)) {
                                                    n.properties._dockOrder = i + 1;
                                                }
                                            });
                                            // sort
                                            page._sortchildren(o.parent.children, true);

                                            o.boxing().adjustDock(true);
                                            ood.asyRun(function () {
                                                if (page.resizer) page.resizer.rePosSize();
                                            });
                                        }
                                    }
                                    break;
                                case "repos":
                                case "resize":
                                    if (o.locked) return;
                                    if (o.properties && o.properties.locked) return;
                                    var offset = page.dropOffset;
                                    if (o.box['ood.svg']) {
                                        var oregion = ins._getBBox(),
                                            region = {};
                                        region.x = parseInt(oregion.x / offset) * offset;
                                        region.y = parseInt(oregion.y / offset) * offset;
                                        if (id == 'resize') {
                                            region.width = parseInt((oregion.width + offset - 1) / offset) * offset;
                                            region.height = parseInt((oregion.height + offset - 1) / offset) * offset;
                                        }
                                        page._refresh(alias, 'bBox', _null, region);
                                        page.resizer.rePosSize();

                                        redoA.push(function () {
                                            page._refresh(alias, 'bBox', _null, region, _false);
                                        });
                                        undoA.push(function () {
                                            page._refresh(alias, 'bBox', _null, oregion, _false);
                                        });
                                    } else {
                                        var l = node.left(),
                                            t = node.top(),
                                            w, h;
                                        if (id == 'resize') {
                                            w = node.width();
                                            h = node.height();
                                        }
                                        var redo = function () {
                                                var node = page.getByAlias(alias).getRoot();
                                                node.left(parseInt(l / offset) * offset)
                                                    .top(parseInt(t / offset) * offset);
                                                if (id == 'resize') {
                                                    node.width((parseInt((w + offset - 1) / offset)) * offset)
                                                        .height((parseInt((h + offset - 1) / offset)) * offset)
                                                }
                                            },
                                            undo = function () {
                                                var node = page.getByAlias(alias).getRoot();
                                                node.left(l).top(t);
                                                if (id == 'resize') {
                                                    node.width(w).height(h);
                                                }
                                            };
                                        redo();

                                        undoA.push(undo);
                                        redoA.push(redo);

                                        page._refresh(ins, 'left');
                                        page._refresh(ins, 'top');
                                        page._refresh(ins, 'width');
                                        page._refresh(ins, 'height');

                                        page.resizer.rePosSize();
                                    }
                                    break;
                            }
                        });

                        // undo-redo : to front/back by toolbar command
                        page.markDirty(function () {
                            ood.arr.each(undoA, function (f) {
                                ood.tryF(f);
                            });
                        }, function () {
                            ood.arr.each(redoA, function (f) {
                                ood.tryF(f);
                            });
                        }, "set controls' " + (id == 'resize' ? "size" : "position"));

                        this._focus();
                        break;
                    case
                    'copyclone'
                    :
                        if (!page.$moduleInnerMode) {
                            if ('delete' == id) {
                                this._deleteSelected();
                            } else if ('cut' == id || 'copy' == id) {
                                //get source
                                var src = page.getByCacheId(this.tempSelected);
                                if (src.isEmpty()) {
                                    src = ood.getObject(page.tempSelected[0]);
                                    src = src.boxing();
                                }
                                // only allow one module
                                var module = src.get(0).getModule(_true);
                                if (module) {
                                    src = module;
                                }
                                // DataBinder and PopMenu
                                var item;
                                if (item = page.iconlist.getItemByItemId(src.get(0).$xid)) {
                                    getSPA().__tempitem = ood.clone(item, _true);
                                }
                                //clone and added to its' parent
                                var tar = src.clone();
                                tar.each(function (prf) {
                                    page._designable(prf);
                                });

                                if (module) {
                                    tar.render();
                                }

                                ood.message(ood.getRes('RAD.designer.' + ('cut' == id ? 'cutOK' : 'copyOK'), tar.size()));
                                getSPA().__copied = tar;

                                var dlg = getSPA().__pasteDlg;
                                if (!dlg) {
                                    dlg = getSPA().__pasteDlg = ood.pop(ood.wrapRes('RAD.designer.clipboard'), "<div style='position:relative;overflow:auto;width:200px;height:100px;'></div>", _null, 20, 20);
                                    dlg.setResizer(_true)
                                        .setMinBtn(_true)
                                        .onDestroy(function () {
                                            delete getSPA().__copied;
                                            delete getSPA().__pasteDlg;
                                            delete getSPA().__tempitem;
                                            ood.message(ood.wrapRes("RAD.designer.clearClipboard"));
                                        })
                                    dlg.getRoot().css("opacity", 0.75).onMouseover(function (prf, e, src) {
                                        ood(src).css("opacity", 1);
                                    }).onMouseout(function (prf, e, src) {
                                        ood(src).css("opacity", 0.75);
                                    });
                                }
                                dlg.setHtml('', _true);
                                var div = new ood.UI.Block({'dock': 'fill', 'overflow': 'auto', 'borderType': 'inset'});
                                div.append(src.clone());
                                dlg.append(div);

                                if ('cut' == id) {
                                    this._deleteSelected(_true);
                                }
                            } else if ('clone' == id) {
                                var ids = [], pid,
                                    //get source
                                    src = page.getByCacheId(this.tempSelected),
                                    aliass = [],
                                    arr = [];

                                if (src.isEmpty()) {
                                    src = ood.getObject(page.tempSelected[0]);
                                    src = src.boxing();
                                }
                                // only allow one module
                                var module = src.get(0).getModule(_true);
                                if (module) {
                                    src = module;
                                }

                                var parent = src.get(0).parent ? src.get(0).parent.alias : "canvas",
                                    subId = src.get(0).childrenId,
                                    tar = src.clone();

                                tar.each(function (prf) {
                                    page._designable(prf);
                                });

                                if (module) {
                                    tar.render();
                                }
                                tar.each(function (target, i) {
                                    //before render
                                    target.$inDesign = page.$canvasXid;
                                    if (target['ood.UIProfile']) {
                                        var t;
                                        if (t = ood.get(getSPA(), ["curProjectConfig", "$DevEnv", "SpaceUnit"])) {
                                            target._spaceUnit = t;
                                        }
                                    }

                                    var _item;
                                    // e.g. ood.UI.PopMenu && ood.DataBinder
                                    var item;
                                    if (item = page.iconlist.getItemByItemId(src.get(i).$xid))
                                        _item = ood.clone(item, _true);
                                    else {
                                        if (target.box['ood.svg']) {
                                            var bbox = src.get(i).boxing()._getBBox();
                                            bbox.x += 10;
                                            bbox.y += 10;
                                            delete bbox.x2;
                                            delete bbox.y2;
                                            target.boxing()._setBBox(bbox);
                                        } else {
                                            var o = target.properties;
                                            if (parseInt(o.left) || o.left === 0) o.left = ood.CSS.$addpx(o.left, 10, target.getRootNode());
                                            if (parseInt(o.top) || o.top === 0) o.top = ood.CSS.$addpx(o.top, 10, target.getRootNode());
                                        }
                                    }
                                    // collect data
                                    var hash = target.serialize(_false);
                                    delete hash.events;
                                    if (_item) {
                                        hash._item = _item;
                                    }
                                    aliass.push(target.alias);
                                    arr.push(hash);

                                    // real add
                                    page._designable(target);

                                    if (target['ood.Module'] ? target.getUIComponents().isEmpty() : target.box['ood.UI'] ? target.box.$initRootHidden : _true) {
                                        page.iconlist.insertItems([{
                                            'id': target.$xid,
                                            'imgWidth': '16',
                                            'imgHeight': '16',
                                            'tips': page._bldTips(target, page.$moduleInnerMode ? "" : CONF.enable_codeEdtor ? ("$(RAD.designer.Dblclick to edit the code)") : ""),
                                            'imgStyle': hash._item.imgStyle,
                                            'imageClass': hash._item.imageClass
                                        }], _null, _false);
                                        page.iconlist.setUIValue(target.$xid);
                                        if (target.box['ood.UI']) {
                                            page.canvas.append(target);
                                        }
                                    } else {
                                        page.getByAlias(parent).append(target, subId);
                                    }
                                    ids.push(target.$xid);
                                });

                                //set to resizer
                                page.selectWidget(ids);
                                ood.message(ood.getRes('RAD.designer.colneOK', tar.size()));

                                var redo = function () {
                                        ood.arr.each(arr, function (hash) {
                                            var image = hash._item && hash._item.image,
                                                imageClass = hash._item && hash._item.imageClass,
                                                imgStyle = hash._item && hash._item.imgStyle;

                                            var o = ood.create(ood.clone(hash));
                                            o = o.get(0);
                                            //before render
                                            page._designable(o);
                                            if (o.box['ood.Module'] ? o.getUIComponents().isEmpty() : o.box['ood.UI'] ? o.box.$initRootHidden : _true) {
                                                page.iconlist.insertItems([{
                                                    'id': o.$xid,
                                                    'imgWidth': '16',
                                                    'imgHeight': '16',
                                                    'tips': page._bldTips(o, page.$moduleInnerMode ? "" : CONF.enable_codeEdtor ? ("$(RAD.designer.Dblclick to edit the code)") : ""),
                                                    'imgStyle': imgStyle,
                                                    'imageClass': imageClass
                                                }], _null, _false);
                                                if (o.box['ood.UI']) {
                                                    page.canvas.append(o);
                                                }
                                            } else {
                                                page.getByAlias(parent).append(o, subId);
                                            }
                                        });
                                    },
                                    undo = function () {
                                        ood.arr.each(arr, function (hash) {
                                            var ins = page.getByAlias(hash.alias);
                                            ins.each(function (o) {
                                                if (page.iconlist.getItemByItemId(o.$xid)) {
                                                    page.iconlist.removeItems([o.$xid]);
                                                }
                                            });
                                            ins.destroy(_true, _true);
                                        });
                                    };

                                // undo-redo : clone controls by toolbar command
                                page.markDirty(undo, redo, "clone controls");
                            }
                        }
                        break;
                    case
                    'pastefun'
                    :
                        if (!page.$moduleInnerMode) {
                            if ('paste' == id) {
                                if (getSPA().__copied) {
                                    var sel = this.tempSelected, ctrl, ids = [], inIconList;
                                    if (!sel || sel.length == 0 || (sel.length === 1 && (ctrl = page.getByCacheId(sel)) && ctrl.get(0) && ctrl.get(0).boxing().getDropKeys)) {

                                        var parent = (!sel || sel.length == 0) ? 'canvas' : ctrl.get(0).alias,
                                            subId = (ctrl && ctrl.getUIValue) ? ctrl.getUIValue() : _null,
                                            aliass = [],
                                            arr = [];

                                        var tar = getSPA().__copied.clone();

                                        tar.each(function (target, i) {
                                            //before render
                                            target.$inDesign = page.$canvasXid;
                                            if (target['ood.UIProfile']) {
                                                var t;
                                                if (t = ood.get(getSPA(), ["curProjectConfig", "$DevEnv", "SpaceUnit"])) {
                                                    target._spaceUnit = t;
                                                }
                                            }
                                            var _item;
                                            // e.g. ood.UI.PopMenu && ood.DataBinder
                                            if (target['ood.Module'] ? target.getUIComponents().isEmpty() : target.box['ood.UI'] ? target.box.$initRootHidden : _true) {
                                                _item = ood.clone(getSPA().__tempitem, _true);
                                            } else {
                                                if (target.box['ood.svg']) {
                                                    var p = page.getByAlias(parent, _true);
                                                    if (!p || p.box.KEY != 'ood.UI.SVGPaper') {
                                                        ood.message(ood.getRes('RAD.designer.msg.SVG control $0 cant paste to normal container-' + target.alias));
                                                        return;
                                                    }
                                                } else {
                                                    var o = target.properties;
                                                    if (parseInt(o.left) || o.left === 0) o.left = ood.CSS.$addpx(o.left, 10, target.getRootNode());
                                                    if (parseInt(o.top) || o.top === 0) o.top = ood.CSS.$addpx(o.top, 10, target.getRootNode());
                                                }
                                            }
                                            // collect data
                                            var hash = target.serialize(_false);
                                            delete hash.events;
                                            if (_item) {
                                                hash._item = _item;
                                            }
                                            aliass.push(target.alias);
                                            arr.push(hash);

                                            page._designable(target);
                                            // real add
                                            if (target['ood.Module'] ? target.getUIComponents().isEmpty() : target.box['ood.UI'] ? target.box.$initRootHidden : _true) {
                                                page.iconlist.insertItems([{
                                                    'id': target.$xid,
                                                    'imgWidth': '16',
                                                    'imgHeight': '16',
                                                    'tips': page._bldTips(target, page.$moduleInnerMode ? "" : CONF.enable_codeEdtor ? ("$(RAD.designer.Dblclick to edit the code)") : ""),
                                                    'imgStyle': hash._item.imgStyle,
                                                    'imageClass': hash._item.imageClass
                                                }], _null, _false);
                                                page.iconlist.setUIValue(target.$xid);
                                                if (target.box['ood.UI']) {
                                                    page.canvas.append(target);
                                                }
                                            } else {
                                                page.getByAlias(parent).append(target, subId);
                                            }

                                            if (target['ood.Module'] ? target.getUIComponents().isEmpty() : target.box['ood.UI'] ? target.box.$initRootHidden : _true) {
                                            } else {
                                                if (target.box['ood.svg']) {
                                                    var bbox = target.boxing()._getBBox();
                                                    bbox.x += 10;
                                                    bbox.y += 10;
                                                    delete bbox.x2;
                                                    delete bbox.y2;
                                                    target.boxing()._setBBox(bbox);
                                                }
                                            }
                                            ids.push(target.$xid);
                                        });

                                        page.selectWidget(ids);
                                        ood.message(ood.getRes('RAD.designer.pasted', tar.size()));

                                        var redo = function () {
                                                ood.arr.each(arr, function (hash) {
                                                    var image = hash._item && hash._item.image,
                                                        imageClass = hash._item && hash._item.imageClass,
                                                        imgStyle = hash._item && hash._item.imgStyle;

                                                    var o = ood.create(ood.clone(hash));
                                                    o = o.get(0);
                                                    //before render
                                                    page._designable(o);
                                                    if (o['ood.Module'] ? o.getUIComponents().isEmpty() : o.box['ood.UI'] ? o.box.$initRootHidden : _true) {
                                                        page.iconlist.insertItems([{
                                                            'id': o.$xid,
                                                            'imgWidth': '16',
                                                            'imgHeight': '16',
                                                            'tips': page._bldTips(o, page.$moduleInnerMode ? "" : CONF.enable_codeEdtor ? ("$(RAD.designer.Dblclick to edit the code)") : ""),
                                                            'imgStyle': imgStyle,
                                                            'imageClass': imageClass
                                                        }], _null, _false);
                                                        if (o.box['ood.UI']) {
                                                            page.canvas.append(o);
                                                        }
                                                    } else {
                                                        page.getByAlias(parent).append(o, subId);
                                                    }
                                                });
                                            },
                                            undo = function () {
                                                ood.arr.each(arr, function (hash) {
                                                    var ins = page.getByAlias(hash.alias);
                                                    ins.each(function (o) {
                                                        if (o.box['ood.Module'] ? o.getUIComponents().isEmpty() : o.box['ood.UI'] ? o.box.$initRootHidden : _true) {
                                                            page.iconlist.removeItems([o.$xid]);
                                                        }
                                                    });
                                                    ins.destroy(_true, _true);
                                                });
                                            };
                                        //
                                        // undo-redo : paste controls by toolbar command
                                        page.markDirty(undo, redo, "paste controls");
                                    }
                                } else {
                                    ood.message(ood.wrapRes("RAD.designer.clearClipboard"));
                                }
                            }
                        }
                        break;
                    case
                    'svgpath'
                    :
                        var svgPrf, svgElem, path;
                        if (page.tempSelected && page.tempSelected.length == 1) {
                            svgPrf = ood.getObject(page.tempSelected[0]);
                            if (svgPrf && svgPrf.box["ood.svg"]) {
                                svgElem = svgPrf._elset[0];
                                path = svgElem.attr('path');
                            }
                        }
                        if (!path) {
                            return;
                        }
                        if (id == "pathedit") {
                            page._editSVGPath(svgPrf);
                            return;
                        }
                        var alias = svgPrf.alias,
                            opath = path.join('');
                        switch (id) {
                            case 'vmirror':
                                path = ood.svg.$transform(opath, "s1,-1");
                                break;
                            case 'r90':
                                path = ood.svg.$transform(opath, "r90");
                                break;
                            case 'hmirror':
                                path = ood.svg.$transform(opath, "s-1,1");
                                break;
                            case 'r270':
                                path = ood.svg.$transform(opath, "r270");
                                break;
                            case 'freeze':
                                var tf = svgElem.attr('transform');
                                if (tf && tf.length >= 1) {
                                    path = ood.svg.$transform(opath, tf);
                                    svgElem.attr('transform', "");
                                } else {
                                    return;
                                }
                                break;
                        }

                        svgPrf.boxing().setAttr("KEY", {'path': path}, _false, _true);
                        page.$tryToRefreshSel(svgPrf);

                        // undo-redo : modify svg path by toolbar svg command
                        page.markDirty(function () {
                            page.getByAlias(alias).setAttr("KEY", {'path': opath}, _false, _true);
                        }, function () {
                            page.getByAlias(alias).setAttr("KEY", {'path': path}, _false, _true);
                        }, "set svg path");
                        break;
                }
            },
            '$profilegrid_cmd': function (profile, cell, proEditor, src, type) {
                var page = this;
                switch (type) {
                    case 'delete':
                        var tagVar = cell.$tagVar,
                            ek = tagVar._eventkey;
                        if (ek) {
                            var target = tagVar.target,
                                funname = tagVar.funname,
                                canvas = page.canvas,
                                isCanvas = target === (canvas && canvas.get(0)) || target._isCanvas;
                            var bak, redo;
                            if (isCanvas) {
                                var em = ood.get(page._cls, ['Instance', 'events']);
                                if (!em) ood.set(page._cls, ['Instance', 'events'], em = {});
                                bak = em[ek];
                            } else if (target['ood.Module']) {
                                bak = target.events[ek];
                            } else {
                                bak = target[ek];
                            }
                            ood.confirm(ood.getRes('RAD.designer.confirmdel'),
                                ood.getRes('RAD.action.Do you wanna delete the event handler') +
                                "?", function () {
                                    page.markDirty(function () {
                                        if (isCanvas) {
                                            var em = ood.get(page._cls, ['Instance', 'events']);
                                            if (!em) ood.set(page._cls, ['Instance', 'events'], em = {});
                                            em[ek] = bak;
                                            page._canvaseventdirty = _true;
                                        } else if (target['ood.Module']) {
                                            target.events[ek] = bak;
                                        } else {
                                            target[ek] = bak;
                                        }
                                    }, redo = function () {
                                        if (isCanvas) {
                                            var em = ood.get(page._cls, ['Instance', 'events']);
                                            if (!em) ood.set(page._cls, ['Instance', 'events'], em = {});
                                            delete em[ek];
                                            page._canvaseventdirty = _true;
                                        } else if (target['ood.Module']) {
                                            target.events[ek] = _null;
                                        } else {
                                            target[ek] = _null;
                                        }
                                    }, "set event");

                                    redo();

                                    if (funname) {
                                        delete cell.funname;
                                        ood.alert(ood.getRes("RAD.action.All event actions and handler were deleted, but function '$0' was preserved in the code", funname) + "!");
                                    } else {
                                        ood.alert(ood.getRes("RAD.action.All actions were deleted") + "!");
                                    }
                                    cell.value = cell.$tagVar.funname = "";
                                    if (cell._editor) {
                                        cell._editor.setValue("", _true);
                                        cell._editor.setCaption("");
                                    }
                                    profile.boxing().updateCell(cell, {caption: ''});
                                });
                        }
                        return _false;

                    case 'ri ri-code-line':
                        var oldExpression = cell.value, np = profile;
                        var target = profile.$widget.get(page.SelectedFocus <= 0 ? 0 : page.SelectedFocus);
                        page._showExpressionEditor(oldExpression, function (profile, expression) {
                            np.boxing().updateCell(cell, {'value': expression});
                            target.setProperties("expression", expression);
                            page.markDirty(function () {
                                np.boxing().updateCell(cell, {'value': oldExpression});
                                target.setProperties("expression", oldExpression);
                            }, function () {
                                np.boxing().updateCell(cell, {'value': expression});
                                target.setProperties("expression", expression);
                            }, "modify value");

                        });
                        break;
                    case 'pop':
                        var tagVar = cell.$tagVar;
                        if (tagVar) {
                            if (tagVar.prop == 'sandboxTheme') {
                                ood.getModule("RAD.ThemeRoller", function (tid, module) {
                                    var container = tagVar.profile.boxing();

                                    module.setTargetContainer(container, proEditor.boxing().getValue());
                                    module.render(_true);

                                    module.getRoot().popToTop(src)
                                        .setBlurTrigger('design:pop:themeroller', function () {
                                            module.destroy();
                                        });

                                    this.setEvents("onChange", function (themeStr, customDirty, baseTheme) {
                                        var value = customDirty ? themeStr : (baseTheme || '')
                                        if (proEditor) {
                                            // 1. dont trigger onchange event
                                            proEditor.boxing().setValue(value, _true);
                                        }
                                        // 2. dont trigger onchange event
                                        profile.boxing().updateCell(cell, {'value': value}, _false, _false);
                                        // 3. set it directly
                                        container.setSandboxTheme(value);
                                    });
                                });
                            } else if (tagVar.prop == 'imageClass') {
                                ood.getModule("RAD.SelFontAwesome", function (tid, module) {
                                    module.render(_true);
                                    module.getRoot().popToTop(src)
                                        .setBlurTrigger('design:pop:SelFontAwesome', function () {
                                            module.destroy();
                                        });

                                    this.setEvents("onSel", function (value) {
                                        if (proEditor) {
                                            proEditor.boxing().setUIValue(value);
                                        } else {
                                            // 2. dont trigger onchange event
                                            profile.boxing().updateCell(cell, {'value': value});
                                        }
                                    });
                                });
                            }
                        }
                        break;
                    default:
                        var tagVar = cell.$tagVar;
                        if (tagVar.prop == 'excelCellId') {
                            if (!/\s*[A-Z]+\s*[0-9]+\s*/.test(proEditor.properties.$UIvalue)) {
                                ood.alert("The excel cell id is invalid");
                            } else {
                                ood.alert("It's a valid excel cell id!");
                            }
                        } else if (tagVar.prop == 'excelCellFormula' || tagVar.prop == 'gridValueFormula') {
                            if (!ood.ExcelFormula.validate(proEditor.properties.$UIvalue)) {
                                ood.alert("The excel formula is invalid");
                            } else {
                                ood.alert("It's a valid excel formula!");
                            }
                        }
                }
            },
            '$showActionEditor': function (page, target, evtKey, cap, selected, cell, callback, gridPrf, editorPrf) {
                var prop = {},
                    isCanvas = target._$canvas || target === (page.canvas && page.canvas.get(0)), bak;

                if (isCanvas) {
                    var em = ood.get(page._cls, ['Instance', 'events']);
                    if (!em) ood.set(page._cls, ['Instance', 'events'], em = {});
                    bak = prop.actionConf = em[evtKey];
                } else if (target['ood.Module']) {
                    bak = prop.actionConf = target.events[evtKey];
                } else {
                    bak = prop.actionConf = target[evtKey];
                }

                prop.target = target;
                prop.parent = page;
                prop.cls = page._cls;
                prop.className = page._className;

                prop._eventkey = evtKey;
                prop._selected = selected;
                prop._cap = cap;

                //get all page
                if (CONF.getClientMode() == "project" && getSPA().treebarCls) {
                    prop.pages = ood.clone(getSPA().treebarCls.getItems(), _true);
                }
                //get all widgets
                var items = [], moduleHash = {},
                    getCap = function (profile) {
                        var prop = profile.properties,
                            type = (profile['ood.Module'] || profile.moduleClass) ? "module" : "control",
                            cls = profile.key.split(".").pop(),
                            cap;
                        if (type == "module") {
                            cap = /*"$(RAD.action.Module) - " + */profile.getAlias() + " ( " + profile.key + " )";
                        } else {
                            cap = /*"$(RAD.action.Control) - " + */profile.alias + " ( " + cls + " )";
                            if (prop.name || prop.desc) cap += " <br />[ " + (prop.name || "") + (prop.name ? " - " : "") + (prop.desc || "") + " ]";
                            if (prop.caption || prop.labelCaption) cap += " [ " + (prop.caption || prop.labelCaption) + " ]";
                        }
                        return cap;
                    },
                    fun = function (profile, items, map) {
                        var self = arguments.callee,
                            type = (profile['ood.Module'] || profile.moduleClass) ? "module" : "control",
                            cls = profile.key.split(".").pop(),
                            t = type == "module" ? {'imageClass': 'oodcon ri-file-line'} : map[profile.box.KEY],
                            tt,
                            z;
                        if (type == "module") {
                            if (moduleHash[z = profile.moduleClass + "[" + profile.moduleXid + "]"]) return;
                            moduleHash[z] = 1;
                            profile = ood.Module.getInstance(profile);
                        }
                        var item = {
                            'id': profile.alias,
                            'caption': getCap(profile),
                            'image': t && t.image || '',
                            'imagePos': t && t.imagePos || '',
                            'imageClass': t && t.imageClass || '',
                            "0": profile,
                            '_type': type
                        };
                        if (target == profile)
                            item.caption = "<strong>" + item.caption + "</strong>";
                        items.push(item);

                        if (type == "module") {
                            return;
                        }

                        if (profile.children && profile.children.length) {
                            var sub = [];
                            item.sub = sub;
                            ood.arr.each(profile.children, function (o) {
                                self.call(_null, o[0], sub, map);
                            });
                        }
                    };

                fun(page.canvas.get(0), items, CONF.mapWidgets);

                if (!items[0].sub) items[0].sub = [];

                ood.each(page.$host, function (ins, i) {
                    if (i == "$inDesign" || !ins['ood.absBox'] || !ins.n0) return;

                    var profile = ins.get(0),
                        map = CONF.mapWidgets, item, t;
                    if (profile['ood.Module'] ? profile.getUIComponents().isEmpty() : profile.box['ood.UI'] ? profile.box.$initRootHidden : _true) {
                        if (-1 == ood.arr.subIndexOf(items[0].sub, "id", profile.alias)) {
                            var type = profile['ood.Module'] ? "module" : "control",
                                cls = profile.key.split(".").pop(),
                                t = type == "module" ? {'imageClass': 'ri-file-text-line'} : map[profile.box.KEY],
                                tt,
                                item = {
                                    'id': profile.alias,
                                    'caption': getCap(profile),
                                    'image': t && t.image || '',
                                    'imagePos': t && t.imagePos || '',
                                    'imageClass': t && t.imageClass || '',
                                    "0": profile,
                                    '_type': type
                                };
                            if (target == profile)
                                item.caption = "<strong>" + item.caption + "</strong>";
                            items[0].sub.push(item);
                        }
                    }
                });
                prop.controls = items[0].sub || [];

                // Event paramters
                prop.argsdoc = ood.get(RAD.EditorTool.getDoc(target.key + ".prototype." + evtKey, _null, _true), ["$paras"]);
                prop.args = ood.fun.args(target.box.$EventHandlers[evtKey]);
                prop.argsvar = RAD.ClassTool.getArgsFromAPI(target.key, evtKey, _true);//"(new "+target.key+").get(0)");
                if (!prop.argsvar) {
                    prop.argsdoc = [];
                    prop.argsvar = [];
                    var getArts = function (fun) {
                        var arr = (fun + "").split("("), str;
                        arr.shift();
                        str = arr.join('(');
                        str.replace(/\s*((\w)+)(\s*\/\*[^*]*\*+([^\/][^*]*\*+)*\/)?|(\s*\/\/[^\n]*)|(\)[\s\S]*)/g, function (o, a, b, c, d, e) {
                            if (o.charAt(0) != ')') {
                                e = c ? c.replace(/^\s*\/\*/, '').replace(/\s*\*\/\s*$/, '').replace(/\s*[\n\r]+\s*\*\s*/g, ' ').replace(/^\s*/, '') : '';
                                o = e.split(/[^\w\.]+/);
                                d = o[0];

                                prop.argsvar.push({
                                    'ori': d || "Object",
                                    'type': (d || "Object") + ".prototype"
                                });
                                prop.argsdoc.push(a + " : " + e);
                            }
                        });
                    };
                    getArts(target.box.$EventHandlers[evtKey]);
                }
                ood.each(prop.argsvar, function (v, i) {
                    if (i == 0 && prop.argsvar[i].ori == 'ood.UIProfile')
                        prop.argsvar[i] = 'curProfile';
                    else if (i == 0 && prop.argsvar[i].ori == 'ood.Profile')
                        prop.argsvar[i] = 'curProfile';
                    else if (v.ori == 'Event')
                        prop.argsvar[i] = 'e';
                    else if (v.type)
                        prop.argsvar[i] = v.type == "Object.prototype" ? {} : i == "Array.prototype" ? [] : "";
                    else if (v.code) {
                        prop.argsvar[i] = ood.get(window, v.code.split("."));
                        if (ood.str.startWith(v.code, 'CONF.mixed_prop.'))
                            var t = prop.argsvar[i];
                        ood.each(t, function (z, i) {
                            t[i] = ood.getRes("RAD.ood_item_attr." + i);
                        });
                        if (v.code == 'CONF.mixed_prop.ood_UI_TreeView_item' || v.code == 'CONF.mixed_prop.ood_UI_TreeBar_item') {
                            t.sub = 'sub -> [...]';
                        }
                    }
                });

                var _cb = function (evs) {
                    var redo;
                    page.markDirty(function () {
                        if (isCanvas) {
                            var em = ood.get(page._cls, ['Instance', 'events']);
                            if (!em) ood.set(page._cls, ['Instance', 'events'], em = {});
                            em[evtKey] = bak;
                        } else if (target['ood.Module']) {
                            target.events[evtKey] = bak;
                        } else {
                            target[evtKey] = bak;
                        }
                    }, redo = function () {
                        if (isCanvas) {
                            var em = ood.get(page._cls, ['Instance', 'events']);
                            if (!em) ood.set(page._cls, ['Instance', 'events'], em = {});
                            em[evtKey] = evs;
                            page._canvaseventdirty = _true;
                        } else if (target['ood.Module']) {
                            target.events[evtKey] = evs;
                        } else {
                            target[evtKey] = evs;
                        }
                    });

                    redo();
                    var funname2,
                        actions = (evs && evs.actions) || evs,
                        count = 0;
                    if (actions) {
                        ood.arr.each(actions, function (o) {
                            if (typeof o == "string") {
                                funname2 = o;
                                return _false;
                            }
                        });

                        ood.arr.each(actions, function (o) {
                            if (ood.isHash(o) && o.script) {
                                funname2 = o.script;
                                return _false;
                            }
                        });

                        ood.arr.each(actions, function (o) {
                            if (ood.isHash(o)) count++;
                        });
                    }
                    var vv = (count === 0 ? ""
                        : count === 1 ? ("" + count + " " + ood.adjustRes("$RAD.designer.action"))
                            : ("" + count + " " + ood.adjustRes("$RAD.designer.actions")));
                    if (funname2) vv += (vv ? " + " : "") + ood.getRes("RAD.action.Function");
                    if (vv) vv = "[" + vv + "]";
                    // for caption
                    if (cell) gridPrf.boxing().updateCell(cell, {caption: vv});
                    if (cell && cell._editor) cell._editor.setCaption(vv);
                    ood.tryF(callback);
                };
                if (getSPA() && _false === getSPA().fe("beforeActionsEditorPop", [
                    evtKey, prop.actionConf, prop, function (evs) {
                        _cb(evs);
                    },
                    "RAD.Designer", target, cell && gridPrf.getSubNode('CELL', cell._serialId).get(0), cell, gridPrf.boxing(), editorPrf && editorPrf.boxing()])) return;


                ood.showCom("RAD.ActionsEditor", function () {
                    this.properties = prop;
                    // make dirty ,but cant undo/redo
                    this.setEvents({
                        'onDirty': function (target, evname, evs) {
                            _cb(evs);
                        }
                    });
                });
            },
            '$prfilegrid_beforepop': function (profile, cell, editorprf, pos, e, src) {
                if (getSPA() && _false === getSPA().fe("beforeEditorComboPop", [
                    cell._row.id.split(":").pop(), _null, cell.value, function (value) {
                        editorprf.boxing().setUIValue(value || "", _true);
                    }, "RAD.Designer", profile.$widget, pos, profile.getSubNode('CELL', cell._serialId).get(0), cell, profile.boxing(), editorprf && editorprf.boxing()
                ])) return _false;
            },
            '$profilegrid_eclick': function (profile, cell, proEditor, type) {
                if (!cell._row || !ood.str.startWith(cell._row.id, "event:")) return;
                //target, page, evtKey
                var o = cell.$tagVar,
                    target = o.target,
                    page = o.parent,
                    evtKey = o.key,
                    cap = o.cap;

                // for simple mode
                if (type == 'left' || !CONF.enable_codeEdtor) {
                    this.$showActionEditor(page, target, evtKey, cap, _null, cell, _null, profile, proEditor);
                } else {
                    var path = o.path,
                        comments = o.comments || "",
                        iniCode = o.ini,
                        funname = o.funname,
                        isCanvas = target._$canvas || target === (page.canvas && page.canvas.get(0));

                    // avoid click twice
                    if (page.hasTask())
                        return;
                    if (!funname) {
                        funname = '_' + (isCanvas ? "page" : target.alias).toLowerCase().replace(/\./g, '_') + '_' + evtKey.toLowerCase();
                        profile.boxing().updateCell(cell.id, {
                            value: funname
                        }, _false, _true);
                    }

                    page.resetTaskList();

                    if (page._dirty) {
                        var nodes = page.getWidgets(_true);
                        // reset iniComponents code
                        var code = ('{\n' + page.getJSCode(nodes)).replace(/\n/g, '\n' + ood.str.repeat(' ', 12))
                            + '\n' + ood.str.repeat(' ', 8) + '}';
                        page.resetCode(path, "iniComponents", code, _false, _true);
                    }
                    // for modify event
                    if (page._canvaseventdirty) {
                        var evs = ood.get(page._cls, ["Instance", "events"]);
                        var code = evs ? page.stringify(evs) : "{}";
                        code = code.replace(/\n/g, '\n' + ood.str.repeat(' ', 8));
                        page.resetCode("Instance", "events", code);
                    }
                    if (!page._cls.Instance[funname]) {
                        if (isCanvas) {
                            page.addCode(path, funname, iniCode.toString().replace(new RegExp("\\s*\\}$"), '\n\n}'), null, null, comments);
                        } else if (target['ood.Module']) {
                            page.addCode(path, funname, iniCode.toString().replace(new RegExp("\\s*\\}$"), '\n\n}'), null, null, comments);
                        } else {
                            var code = iniCode.toString().replace(new RegExp("\\s*\\}$"), '') +
                                '\n' + ood.str.repeat(' ', 4) + "var ns = this, uictrl = profile.boxing();" +
                                '\n}';
                            page.addCode(path, funname, code, null, null, comments);

                            //vv=cell._editor.getCaption();
                            //vv=vv.replace(']', " + "+ood.getRes("RAD.action.Function") +"]");
                            //cell._editor.setCaption(vv);
                        }
                    }
                    ;

                    page.addTask(function () {
                        page.focusEditor(path, funname);
                    });

                    page.startTaskList();

                    page.clearDirty();
                }
            },
            '$profilegrid_beforecellvalueset': function (profile, cell, hash) {
                if (!('value' in hash) && !('unit' in hash)) return;

                var page = this,
                    attr, t, type, funName, property, value, target = profile.$widget,
                    canvas = page.canvas,
                    data = page._cls;
                value = hash.value;
                if ((attr = cell._row.id.split(':')).length > 1) {
                    type = attr[0];
                    property = attr[1];
                } else {
                    property = cell._row.id;
                }
                if (cell._col.id == 'binder') {
                    var pb1 = target.getPropBinder(),
                        pb2 = ood.copy(pb1);
                    pb2[property] = page._anaPropbinder(value).fun;

                    if (!pb2[property]) {
                        if (value) {
                            profile.boxing().updateCell(cell, {'value': ""}, _false, _true);
                            return _false;
                        } else {
                            delete pb2[property];
                        }
                    }
                    target.setPropBinder(pb2);
                    var alias = target.getAlias();
                    if (page.markDirty)
                        page.markDirty(function () {
                            page.getByAlias(alias).setPropBinder(pb1);
                        }, function () {
                            page.getByAlias(alias).setPropBinder(pb2);
                        }, "set controls' property");
                } else {
                    //get properties
                    var _map2 = {
                        'rotate': 1,
                        'left': 1,
                        'top': 1,
                        'width': 1,
                        'height': 1,
                        'right': 1,
                        'position': 1,
                        'bottom': 1,
                        'dock': 1,
                        'dockMargin': 1,
                        'dockFloat': 1,
                        'dockIgnore': 1,
                        'dockMinH': 1,
                        'dockMinW': 1,
                        'dockMaxH': 1,
                        'dockMaxW': 1,
                        'dockStretch': 1,
                        'conDockPadding': 1,
                        'conDockSpacing': 1,
                        'conDockFlexFill': 1,
                        'conDockStretch': 1
                    };
                    try {
                        //run
                        switch (type) {
                            case 'properties':
                                funName = 'set' + ood.str.initial(property);
                                //for canvas
                                if (target.get(0) == (canvas && canvas.get(0))) {
                                    var panelBG = page.panelBG.getRoot();
                                    if (property == "autoDestroy") {
                                        var redo;
                                        if (page.markDirty)
                                            page.markDirty(function () {
                                                var em = ood.get(data, ['Instance']);
                                                if (!em) ood.set(data, ['Instance'], em = {});
                                                em.autoDestroy = ov;
                                                page.resetCode("Instance", "autoDestroy", ov + "", _true, _false);
                                            }, redo = function () {
                                                var em = ood.get(data, ['Instance']);
                                                if (!em) ood.set(data, ['Instance'], em = {});
                                                em.autoDestroy = value;
                                                page.resetCode("Instance", "autoDestroy", value + "", _true, _false);
                                            }, "set autoDestroy");
                                        redo();
                                    } else if (property == "width" || property == "height") {
                                        var temp = {};
                                        temp[property] = value;
                                        // undo-redo : in setViewSize function already
                                        page.setViewSize(temp);
                                    } else {
                                        var em = ood.get(data, ['Static', 'viewStyles']);
                                        if (!em) ood.set(data, ['Static', 'viewStyles'], em = {});

                                        var ovalue = em[property],
                                            value = hash.value || "";
                                        em[property] = value;
                                        if (property == "theme") {
                                            page.panelDiv.setSandboxTheme(ood.adjustRes(value), _true, '[class~="ood-designer-inner-control"]');
                                            page.panelDiv.getChildren(true, "penetrate").reLayout(true);
                                        } else if (property == "zoom") {

                                        } else {
                                            panelBG.css(property, ood.adjustRes(value));
                                        }
                                        page.profileGrid.updateCellByRowCol('properties:' + property, 'value', {'value': value});

                                        // undo-redo : modify cavas event string  in propgrid
                                        if (page.markDirty)
                                            page.markDirty(function () {
                                                var em = ood.get(page._cls, ['Static', 'viewStyles']);
                                                if (!em) ood.set(page._cls, ['Static', 'viewStyles'], em = {});
                                                if (!ovalue) ovalue = "";
                                                em[property] = ovalue;
                                                if (property == "theme") {
                                                    page.panelDivInner.setSandboxTheme(ood.adjustRes(ovalue), _true, '[class~="ood-designer-inner-control"]');
                                                    page.panelDiv.getChildren(true, "penetrate").reLayout(true);
                                                } else if (property == "zoom") {

                                                } else {
                                                    panelBG.css(property, ood.adjustRes(ovalue));
                                                }
                                                page.profileGrid.updateCellByRowCol('properties:' + property, 'value', {'value': ovalue});

                                                page._styledirty = 1;
                                            }, function () {
                                                var em = ood.get(page._cls, ['Static', 'viewStyles']);
                                                if (!em) ood.set(page._cls, ['Static', 'viewStyles'], em = {});
                                                if (!value) value = "";
                                                em[property] = value;
                                                if (property == "theme") {
                                                    page.panelDiv.setSandboxTheme(ood.adjustRes(value), _true, '[class~="ood-designer-inner-control"]');
                                                    page.panelDiv.getChildren(true, "penetrate").reLayout(true);
                                                } else if (property == "zoom") {

                                                } else {
                                                    panelBG.css(property, ood.adjustRes(value));
                                                }
                                                page.profileGrid.updateCellByRowCol('properties:' + property, 'value', {'value': value});

                                                page._styledirty = 1;
                                            }, "set page style");
                                        page._styledirty = _true;
                                    }
                                } else {
                                    /*if(property=='tabindex'){
                                        target.setTabindex(hash.value);
                                        ood.resetRun('JDSEasy_designer_retab',function(){
                                            var arr = page._sortchildren(target.get(0).parent.children, true);
                                            ood.arr.each(arr,function(o,n,p){
                                                if(o[0].rendered && (n=o[0].getRootNode()) && (p=n.parentNode)){
                                                    p.appendChild(n);
                                                }
                                            });
                                            page.resizer.rePosSize();
                                        });
                                    }else */
                                    if (property == "width"
                                        && (target.getPosition() == 'relative' || target.getPosition() == 'static')
                                        && (ood.get(target.get(0), ['parent', 'properties', 'conDockRelative']) || ood.get(target.get(0), ['parent', 'properties', 'conLayoutColumns']))) {
                                        return _false;
                                    } else {
                                        var b, precision = cell.unit == 'em' ? 4 : 0;
                                        if (target.get(0).box.$DataModel[property].$spaceunit) {
                                            if ('value' in hash) {
                                                hash.value = String(
                                                    (value == 'auto') ? value :
                                                        (parseFloat(value) === 0 ? 0 + (hash.unit || cell.unit || "") :
                                                                parseFloat(value) ? parseFloat(value) : 'auto'
                                                        )
                                                );
                                            }
                                            hash.precision = precision;
                                            //if the value changed in the process
                                            if (value !== hash.value || hash.unit !== cell.unit || hash.precision !== precision) {
                                                profile.boxing().updateCell(cell, hash);
                                                b = 1;
                                            }
                                            value = hash.value == 'auto' ? 'auto' : cell.value + cell.unit;
                                        }

                                        var arr = [];
                                        target.each(function (o) {
                                            // with unit
                                            var dm = o.box.$DataModel,
                                                nvalue = value == 'auto' ? 'auto' : value;

                                            var ovalue = o.properties[property];
                                            if (nvalue !== ovalue) {
                                                if (ood.isFun(o.boxing()[funName])) {
                                                    arr.push([o.alias, funName, nvalue, ovalue]);
                                                    // force
                                                    o.boxing()[funName](nvalue, !!hash.unit);

                                                    var dm = o.box.$DataModel;
                                                    // for the linkage affect
                                                    if (dm[property] && dm[property].linkage) {
                                                        ood.arr.each(dm[property].linkage, function (p) {
                                                            profile.boxing().updateCellByRowCol('properties:' + p, 'value', hash, _false, _false);
                                                        });
                                                    }
                                                }
                                            }
                                        });

                                        // undo-redo : modify multi-controls property in propgrid
                                        if (page.markDirty)
                                            page.markDirty(function () {
                                                ood.arr.each(arr, function (a) {
                                                    page.getByAlias(a[0])[a[1]](a[3]);
                                                });
                                            }, function () {
                                                ood.arr.each(arr, function (a) {
                                                    page.getByAlias(a[0])[a[1]](a[2]);
                                                });
                                            }, "set controls' property");
                                    }
                                    if (page.resizer && _map2[property])
                                        page.resizer.rePosSize();
                                    if (b) return _false;
                                }
                                break;
                            case 'event':
                                var ocellv = cell.value,
                                    value = hash.value,
                                    fun = function (em, property, ocellv, value) {
                                        var ovalue = em[property],
                                            // set a whole events object
                                            obj = {};
                                        if (ood.isHash(ovalue)) {
                                            obj.actions = ovalue.actions || [];
                                            obj['return'] = ovalue['return'];
                                        } else if (ood.isArr(ovalue)) {
                                            obj.actions = ovalue;
                                        } else if (ovalue) {
                                            obj.actions = [ovalue];
                                        } else {
                                            obj.actions = [];
                                        }
                                        //clear first
                                        ood.arr.removeValue(obj.actions, ocellv);
                                        // add to the last
                                        obj.actions.push(value);

                                        if (!('return' in obj)) {
                                            if (obj.actions.length === 1) {
                                                if (ood.isStr(obj.actions[0]))
                                                    obj.actions = obj.actions[0];
                                            }
                                            obj = obj.actions;
                                        }

                                        if (!obj || ood.isEmpty(obj)) {
                                            delete em[property];
                                        } else {
                                            em[property] = obj;
                                        }
                                    };
                                if (target.get(0) == (canvas && canvas.get(0))) {
                                    var em = ood.get(data, ['Instance', 'events']);
                                    if (!em) ood.set(data, ['Instance', 'events'], em = {});

                                    fun(em, property, ocellv, value);

                                    // undo-redo : modify cavas event string  in propgrid
                                    if (page.markDirty)
                                        page.markDirty(function () {
                                            var em = ood.get(page._cls, ['Instance', 'events']);
                                            if (!em) ood.set(page._cls, ['Instance', 'events'], em = {});
                                            fun(em, property, value, ocellv);
                                        }, function () {
                                            var em = ood.get(page._cls, ['Instance', 'events']);
                                            if (!em) ood.set(page._cls, ['Instance', 'events'], em = {});
                                            fun(em, property, ocellv, value);
                                        }, "set module event");

                                    page._canvaseventdirty = _true;
                                } else if (target['ood.Module']) {
                                    var arr = [];
                                    target.each(function (o) {
                                        var ovalue = o[property];
                                        arr.push([o.alias, property, ocellv, value]);
                                        fun(o.events, property, ocellv, value);
                                    });
                                    // undo-redo : modify controls event string  in propgrid
                                    if (page.markDirty)
                                        page.markDirty(function () {
                                            ood.arr.each(arr, function (a) {
                                                var o = page.getByAlias(a[0], _true);
                                                fun(o.events, a[1], a[3], a[2]);
                                            });
                                        }, function () {
                                            ood.arr.each(arr, function (a) {
                                                var o = page.getByAlias(a[0], _true);
                                                fun(o.events, a[1], a[2], a[3]);
                                            });
                                        }, "set module's event");
                                } else {
                                    var arr = [];
                                    target.each(function (o) {
                                        var ovalue = o[property];
                                        arr.push([o.alias, property, ocellv, value]);
                                        fun(o, property, ocellv, value);
                                    });
                                    // undo-redo : modify controls event string  in propgrid
                                    if (page.markDirty)
                                        page.markDirty(function () {
                                            ood.arr.each(arr, function (a) {
                                                var o = page.getByAlias(a[0], _true);
                                                fun(o, a[1], a[3], a[2]);
                                            });
                                        }, function () {
                                            ood.arr.each(arr, function (a) {
                                                var o = page.getByAlias(a[0], _true);
                                                fun(o, a[1], a[2], a[3]);
                                            });
                                        }, "set control's event");
                                }
                                break;
                            default:
                                if (property == 'domId') {
                                    var oId = target.get(0).domId;
                                    if (value == oId)
                                        return _false;

                                    //you can modify domId to original one
                                    if (target.get(0).$domId != value && !/^[\w_-]*$/.test(value)) {
                                        ood.message(ood.getRes('RAD.designer.domIdValid', value));
                                        return _false;
                                    }
                                    //if set to original name, not check dom again
                                    if (target.get(0).$domId != value && ood.Dom.byId(value)) {
                                        ood.message(ood.getRes('RAD.designer.domIdExists', value));
                                        return _false;
                                    }
                                    var b;
                                    //if empty, return to original name
                                    if (ood.str.trim(String(value)) == '')
                                        value = target.get(0).$domId;

                                    //if the value changed in the process
                                    if (value !== hash.value) {
                                        profile.boxing().updateCell(cell, {'value': value});
                                        b = 1;
                                    }
                                    target.get(0).boxing().setDomId(value);

                                    var alias = target.get(0).alias;

                                    // undo-redo : modify domId in propgrid
                                    if (page.markDirty)
                                        page.markDirty(function () {
                                            page.getByAlias(alias).setDomId(oId);
                                        }, function () {
                                            page.getByAlias(alias).setDomId(value);
                                        }, "modify control's domId");

                                    if (b) return _false;
                                } else if (property == 'theme') {
                                    if (value)
                                        value = ("" + value).replace(/[^a-zA-Z0-9-]/g, "");
                                    var b;
                                    //if the value changed in the process
                                    if (value !== hash.value) {
                                        profile.boxing().updateCell(cell, {'value': value});
                                        b = 1;
                                    }
                                    if (!value) value = _null;
                                    var arr = [];
                                    target.each(function (o) {
                                        if (value != o.theme) {
                                            arr.push([o.alias, o.theme, value]);
                                            o.boxing().setTheme(value);
                                        }
                                    });

                                    // undo-redo : modify controls theme in propgrid
                                    if (page.markDirty)
                                        page.markDirty(function () {
                                            ood.arr.each(arr, function (a) {
                                                var o = page.getByAlias(a[0], _true);
                                                o.boxing().setTheme(a[1]);
                                            });
                                        }, function () {
                                            ood.arr.each(arr, function (a) {
                                                var o = page.getByAlias(a[0], _true);
                                                o.boxing().setTheme(a[2]);
                                            });
                                        }, "modify controls' theme");
                                    if (b) return _false;
                                } else if (property == 'alias') {
                                    var oalias = target.get(0).alias;
                                    if (value == oalias)
                                        return _false;
                                    if (!value)
                                        return _false;

                                    var hash = page.getNames();
                                    if (hash[value]) {
                                        ood.message(ood.getRes('RAD.designer.nameExists', value));
                                        return _false;
                                    }
                                    page.listObject.setUIValue(value, _true);
                                    target.get(0).boxing().setAlias(value);

                                    // undo-redo : modify alias in propgrid
                                    if (page.markDirty)
                                        page.markDirty(function () {
                                            page.getByAlias(value).setAlias(oalias);
                                        }, function () {
                                            page.getByAlias(oalias).setAlias(value);
                                        }, "modify control's alias");
                                } else {
                                    var arr = [];
                                    target.each(function (o) {
                                        var ovalue = o.properties[property];
                                        if (value !== ovalue) {
                                            if (ood.isFun(o.boxing()[funName])) {
                                                arr.push([o.alias, funName, value, ovalue]);
                                                o.boxing()[funName](value);
                                            }
                                        }
                                    });

                                    // undo-redo : modify multi-controls property in propgrid
                                    if (page.markDirty)
                                        page.markDirty(function () {
                                            ood.arr.each(arr, function (a) {
                                                page.getByAlias(a[0])[a[1]](a[3]);
                                            });
                                        }, function () {
                                            ood.arr.each(arr, function (a) {
                                                page.getByAlias(a[0])[a[1]](a[2]);
                                            });
                                        }, "modify controls' property");
                                }
                        }
                    } catch (e) {
                        throw(e);
                        return _false;
                    }
                }
            },
            '_onIcondbl': function (profile, item, e, src) {
                if (this.$moduleInnerMode || !CONF.enable_codeEdtor) return;

                var page = this;
                if (CONF.enable_codeEdtor) {
                    var arr = this.tempSelected;
                    if (arr && arr.length) {
                        var o = ood.getObject(arr[0]);
                        o = (o['ood.Module'] ? o : o.getModule()) || o;
                        page.resetTaskList();
                        // if dirty
                        if (page._dirty)
                            page.resetCodeFromDesigner();

                        page.addTask(function () {
                            page.searchInEditor(".setHost(host,\"" + o.alias + "\"");
                        });
                        page.__dblclickctrl = _true;
                        ood.asyRun(function () {
                            page.__dblclickctrl = _false;
                        });
                        page.startTaskList();
                    }
                } else if (typeof CONF.designer_ctrldblclick == 'function') {
                    var arr = this.tempSelected,
                        prf;
                    if (arr && arr.length)
                        prf = ood.getObject(arr[0]);
                    page.__dblclickctrl = _true;
                    ood.asyRun(function () {
                        page.__dblclickctrl = _false;
                    });
                    CONF.designer_ctrldblclick(page, prf, e, src);
                }
            },
            '$tg_dblclick': function (profile, row, e, src) {
                if (!CONF.enable_openAPI) return;
                if (row.noAPI) return;

                if (row.group) return;
                var page = this,
                    canvas = page.canvas,
                    i = row.tipv,
                    name = (row.tipk == 'property' ? 'get' + ood.str.initial(i) : i) || "",
                    widget, key, fun;
                if (!(widget = profile.$widget)) return;
                if (widget == canvas)
                    key = 'ood.Module';
                else if (!(key = widget.get(0) && widget.get(0).key)) return;
                if (row.tipk == 'class')
                    CONF.openAPI(key);
                else
                    CONF.openAPI(key + '.prototype' + (name ? '.' : '') + name);
            },
            '$tg_tips': function (profile, node, pos) {
                var page = this,
                    canvas = page.canvas,
                    ks = profile.keys,
                    cell, sid, id, pid,
                    o, widget, key,
                    row,
                    str = "", tail = "";
                if (profile.properties.disabled) return;
                if (!(widget = profile.$widget)) return;

                if (widget == canvas)
                    key = 'ood.Module';
                else if (!(key = widget.get(0) && widget.get(0).key)) return;

                id = node.id;
                pid = node.parentNode && node.parentNode.id;
                if (!id || !pid) return;

                sid = profile.getSubId(id);

                if (id.indexOf(ks.FCELL) == 0 || pid.indexOf(ks.FCELL) == 0) {
                    cell = row = profile.rowMap[sid];
                    if (!cell) {
                        ood.Tips.hide();
                        return _false;
                    }
                } else if (id.indexOf(ks.CELL) == 0 || pid.indexOf(ks.CELL) == 0) {
                    cell = profile.cellMap[sid];
                    if (!cell) {
                        ood.Tips.hide();
                        return _false;
                    }
                    row = cell._row;
                }

                if (row) {
                    if (row.tipk) {
                        if (CONF.enable_codeEdtor) {
                            if (row.tipk) {
                                if (row.tipk == 'class') {
                                    str = key + ' [Class]';
                                } else {
                                    var name = (row.tipk == 'property' ? 'set' + ood.str.initial(row.tipv) : row.tipv) || "",
                                        apipath = key + (name ? ('.prototype.' + name) : ''),
                                        msg = RAD.EditorTool.getDoc(apipath, _true);
                                    if (msg) {
                                        str = row.tipv + ' : ' + msg;
                                    } else {
                                        if (row.tipk == 'fun') {
                                            str = key + ' [$RAD.designer.conf.function] : <b>' + row.tipv + '</b> ';
                                        } else if (row.tipk == 'property') {
                                            str = key + ' [$RAD.designer.conf.property] : <b>' + row.tipv + '</b> ';
                                        } else if (row.tipk == 'event') {
                                            str = key + ' [$RAD.designer.conf.event] : <b>' + row.tipv + '</b> ';
                                        }
                                    }
                                }
                            }

                            if (row.tipk == 'class' || cell.value == row.tipv)
                                tail = CONF.enable_openAPI ? ood.getRes('RAD.designer.openapi') : "";
                            else if (cell.tips)
                                tail = cell.tips;
                        } else {
                            if (row.tipk == 'class') {
                                str = key + ' [$RAD.designer.conf.Class]';
                            } else if (row.tipk == 'fun') {
                                str = key + ' [$RAD.designer.conf.function] : <b>' + row.tipv + '</b>';
                            } else if (row.tipk == 'property') {
                                str = key + ' [$RAD.designer.conf.property] : <b>' + row.tipv + '</b>';
                            } else if (row.tipk == 'event') {
                                str = key + ' [$RAD.designer.conf.event] : <b>' + row.tipv + '</b>';
                            }
                        }
                        ood.Tips.show(pos, page._bldTips2(str, tail));
                    } else if (cell && cell.tips)
                        ood.Tips.show(pos, cell.tips);
                    else
                        ood.Tips.hide();
                } else
                    ood.Tips.hide();
                return _false;
            },
            '$profilegrid_onrequestdata': function (profile, item, callback) {
                return this.__buildSubRows(profile.$widget, item.id, _false, profile.boxing());
            },
            '_showEditor': function (target, clsN, propN, obj, src, onData, conf3) {
                ood.ModuleFactory.getCom('RAD.PropEditor', function () {
                    var uiData = [], row, t,
                        lib = CONF.widgets_mapProp[propN + "_conf"] || {},
                        conf = ood.get(CONF.widgets_mapProp, [propN, clsN]) || ood.get(CONF.widgets_mapProp, [propN, "all"]);
                    if (!conf) {
                        var lib2 = CONF.widgets_itemsProp[propN + "_conf"] || {};
                        var conf2 = CONF.widgets_itemsProp[propN][clsN] || CONF.widgets_itemsProp[propN].all;

                        conf = {'cells': []};
                        ood.arr.each(conf3 || conf2.header, function (col) {
                            if (col == 'renderer'/*||col=='tagVar'*/) return;
                            if (!ood.isHash(col)) {
                                var t = col;
                                if (ood.isHash(lib2[col])) {
                                    col = ood.clone(lib2[col]);
                                } else {
                                    col = {};
                                }
                                col.id = t;
                                conf.cells.push(col);
                            } else {
                                conf.cells.push(ood.clone(col));
                            }
                        })
                    }
                    ood.arr.each(conf.cells, function (cell) {
                        if (!ood.isHash(cell)) {
                            t = cell;
                            if (ood.isHash(lib[cell])) {
                                cell = ood.copy(lib[cell]);
                            } else {
                                cell = {};
                            }
                            cell.id = t;
                        } else {
                            cell = ood.clone(cell);
                        }
                        if (obj && ood.isHash(obj) && (cell.id in obj)) {
                            cell.value = obj[cell.id];
                        }

                        uiData.push({'id': cell.id, 'caption': "$RAD.ood_item_attr." + cell.id, 'cells': [cell]});
                    });
                    this.setProperties({
                        'targetProfile': target,
                        'propKey': propN,
                        'uiData': uiData,
                        'realData': ood.clone(obj),
                        'src': src
                    }).setEvents({
                        'onChanged': onData
                    });
                    this.show();
                });
            },
            '_showMixedEditor': function (target, clsN, propKey, propN, obj, src, onData, newInstance) {
                ood.ModuleFactory[newInstance ? "newCom" : "getCom"]('RAD.MixPropEditor', function () {
                    var header = [], subheader = [], rows = [], row, cell, t,
                        lib = CONF.widgets_itemsProp[propN + "_conf"] || {};

                    clsN = clsN || target.key;

                    var conf = CONF.widgets_itemsProp[propN][clsN] || CONF.widgets_itemsProp[propN].all;

                    ood.arr.each(conf.header, function (col) {
                        var id = (col.id || col) + "";
                        //if(id=='renderer'/*||id=='tagVar'*/){
                        //    header.push({disabled:true});
                        //    return;
                        //}
                        if (!ood.isHash(col)) {
                            t = col;
                            if (ood.isHash(lib[col])) {
                                col = ood.copy(lib[col]);
                            } else {
                                col = {};
                            }
                            col.id = t;
                        } else {
                            col = ood.clone(col);
                        }
                        col.caption = '$RAD.ood_item_attr.' + col.id;
                        header.push(col);
                    });
                    ood.arr.each(conf.subheader, function (col) {
                        var id = (col.id || col) + "";
                        //if(id=='renderer'/*||id=='tagVar'*/){
                        //    subheader.push({disabled:true});
                        //    return;
                        //}
                        if (!ood.isHash(col)) {
                            t = col;
                            if (ood.isHash(lib[col])) {
                                col = ood.copy(lib[col]);
                            } else {
                                col = {};
                            }
                            col.id = t;
                        } else {
                            col = ood.clone(col);
                        }
                        col.caption = '$RAD.ood_item_attr.' + col.id;
                        subheader.push(col);
                    });
                    var collectData = function (items, rows) {
                        ood.arr.each(items, function (item, index) {
                            row = {'cells': []};
                            var ii = 0;
                            ood.arr.each(conf.header, function (col, j) {
                                var id = (col.id || col) + "";
                                //if(id=='renderer'/*||id=='tagVar'*/){
                                //    row.cells.push({disabled:true});
                                //    return;
                                //}
                                if (ood.absObj.$specialChars[id.charAt(0)]) return

                                cell = {};
                                if (conf.rows && conf.rows[item.id]) {
                                    cell = conf.rows[item.id].cells[j] ? ood.copy(conf.rows[item.id].cells[j]) : {};
                                    if (!('value' in cell)) {
                                        if (ood.isHash(item)) {
                                            if (id in item) {
                                                if (typeof item[id] == "object" || typeof item[id] == "function") {
                                                    cell.obj = item[id];
                                                } else {
                                                    cell.value = item[id];
                                                }
                                                cell.needCollect = 1;
                                            }
                                        } else if (id == 'id') {
                                            cell.value = item;
                                            cell.needCollect = 1;
                                        }
                                    }
                                } else {
                                    if (ood.isHash(item) && (id in item)) {
                                        if (typeof item[id] == "object" || typeof item[id] == "function") {
                                            cell.obj = item[id];
                                        } else {
                                            cell.value = item[id];
                                        }
                                        cell.needCollect = 1;
                                    } else if (id == 'id') {
                                        cell.value = item;
                                        cell.needCollect = 1;
                                    }
                                }
                                // for those default is _true (For example: initFold )
                                if (!('value' in cell) && ('dftValue' in header[ii])) {
                                    cell.value = header[ii].dftValue;
                                }
                                row.cells.push(cell);
                                // ignore hot row
                                if (id == "id" && cell.value == ood.UI.TreeGrid._temprowid)
                                    row._ignore = 1;
                                // this row cant be deleted
                                if (conf.rows && conf.rows[item.id])
                                    row.tag = conf.rows[item.id].tag;
                                ii++;
                            });
                            if (row._ignore) {
                                return;
                            }
                            rows.push(row);
                            if (conf.innerKey) {
                                row._innerData = ood.clone(item[conf.innerKey], function (o, i) {
                                    return (i + '').charAt(0) != '_'
                                });
                            }
                            if (conf.hasSub) {
                                row.sub = [];
                                if (item.sub && item.sub.length) {
                                    // special for grid
                                    if (clsN == 'ood.UI.TreeGrid' && !item.sub[0].id)
                                        item.sub = ood.UI.TreeGrid._adjustRows(target, item.sub);

                                    var _id = new ood.id();
                                    ood.arr.each(item.sub, function (o, i) {
                                        if (ood.isHash(o) && !('id' in o)) o.id = item.id + "-" + _id.next();
                                    });

                                    collectData(item.sub, row.sub);
                                }
                            }
                        });
                    };

                    collectData(obj, rows);

                    this.setProperties({
                        'targetProfile': target,
                        'propKey': propKey,
                        'propN': propKey == propN ? "" : propN,

                        'uiHeader': header,
                        'subheader': subheader,
                        'uiRows': rows,
                        //'fixed':!!conf.rows,
                        'fixedRows': _false,
                        'subFixedRows': 'subFixedRows' in conf ? conf.subFixedRows : header.length,
                        'treeMode': conf.hasSub,
                        'uniqueKey': conf.uniqueKey,
                        'innerKey': conf.innerKey,
                        'headerSize': clsN == 'ood.UI.TreeGrid' ? target.properties.header.length : _null,
                        'src': src
                    }).setEvents({
                        'onChanged': onData
                    });
                    this.show();
                });
            },
            '_buildPropRows': function (target, specialItems, specailFlag, nointeraction, grid) {
                var page = this,
                    dm = target.box.$DataModel,
                    prop = target.properties,
                    unit, precision, units,
                    propBinder = prop.propBinder,
                    format, listKey, editorListItems, list, commandBtn, dftWidth,
                    $tag, $fun, $tagVar, value, editorReadonly, editorDisabled,
                    cellEx, t, cv, type, caption;

                var arr = [];
                if ((specailFlag || nointeraction) && target.box['ood.UI'] && !target.box.$initRootHidden && !target.box["ood.UI.FusionChartsXT"] && !target.box["ood.UI.ECharts"]) {
                    var $fun = function (profile, cell, a, b, e, src) {
                        page._decorationWnd(target, src, _null, profile, cell, nointeraction);
                    };
                    var cv = "[ $RAD.designer.conf.Object ]",
                        cells = [];
                    var cell = {
                        'value': cv,
                        'caption': cv,
                        'event': $fun,
                        'type': 'button'
                    };

                    if (!(CONF.lock_hidden_prop['CS'] && (target.locked || (prop && prop.locked)))) {
                        cells.push({
                            'caption': "$(RAD.custom_dlg.Custom Style)",
                            'tips': ood.getRes('RAD.designer.openapi')
                        });
                        cells.push(cell);
                        arr.push({
                            'id': 'CS', 'tipk': 'fun', 'tipv': 'setCustomStyle',
                            'cells': cells
                        });
                    }
                }
                ood.each(target.box.$DataStruct, function (o, i) {
                    if (i.charAt(0) == "_") return;
                    if (CONF.widgets_hiddenProps[i]) return;
                    if (ood.get(CONF.widgets_hiddenProps, [target.box.KEY, i])) return;
                    if (CONF.widgets_hiddenProps_filter && _false === CONF.widgets_hiddenProps_filter(target.box.KEY, i, target)) return;
                    if (CONF.lock_hidden_prop[i] && (target.locked || (prop && prop.locked))) return;

                    // init vars
                    $tag = $tagVar = cellEx = format = listKey = editorListItems = list = $tag = $fun = $tagVar = value = _null;
                    editorReadonly = editorDisabled = _false;
                    caption = cv = '';
                    type = "none";
                    unit = _null;
                    units = _null;
                    precision = _null;
                    commandBtn = _null;

                    // ignore cases
                    if (i.charAt(0) == '_' || i.charAt(0) == '$') return;
                    // desc is on the top
                    if (i == "required" || i == "name" || i == "desc" || i == "locked") return;
                    if (dm[i].hidden) return;
                    if (dm[i].inner && !dm[i].trigger) return;
                    if (!nointeraction && specialItems) {
                        var inSpecial = ood.arr.indexOf(specialItems, i) != -1;
                        if (specailFlag === _true ? !inSpecial : inSpecial) return;
                    }

                    // handle special prop first
                    if (target.box['ood.UI.CSSBox'] && (i === 'normalStatus' || i === 'hoverStatus' || i === 'activeStatus' || i === 'focusStatus')) {
                        type = 'button';
                        $fun = function (profile, cell, a, b, e, src) {
                            page._decorationWnd(target, src, _null, profile, cell, nointeraction);
                        };
                        cv = caption = '[ $RAD.designer.conf.Editor ]';


                    } else if (i == "expression") {
                        type = 'button';
                        $fun = function (profile, cell, a, b, e, src) {
                            var oldExpression = target.getProperties().expression;
                            page._showExpressionEditor(oldExpression, function (profile, expression) {
                                target.setProperties("expression", expression);
                                if (!nointeraction) {
                                    page.markDirty(function () {
                                        target.setProperties("expression", oldExpression);
                                    }, function () {
                                        target.setProperties("expression", expression);
                                    }, "modify expression");
                                }
                                // ood(src).focus();
                            });
                        };
                        cv = caption = '[ $RAD.designer.expression ]';

                    } else if (target.box["ood.APICaller"] && (i == "queryArgs" || i == "queryOptions" || i == "queryHeader" || i == "fakeCookies" || i == "requestDataSource" || i == "responseDataTarget" || i == "responseCallback")) {
                        type = 'button';
                        $fun = function (profile, cell, a, b, e, src) {


                            page._showAPIEditor(target, function (prop) {
                                var oldProp = target.getProperties();
                                var hash = {'_ext': {}};
                                ood.each(prop, function (o, i) {
                                    if (!ood.compareVar(o, oldProp[i])) {
                                        hash._ext[i] = ood.clone(o);
                                    }
                                });
                                profile.boxing().updateCell(cell, hash, _false, _true);

                                target.setProperties(ood.clone(prop));

                                // undo-redo : modify items/header/rows in propgrid
                                if (!nointeraction) {
                                    page.markDirty(function () {
                                        target.setProperties(oldProp);
                                    }, function () {
                                        target.setProperties(prop);
                                    }, "modify apicaller");
                                }
                                ood(src).focus();
                            });
                        };
                        cv = caption = '[ $RAD.designer.conf.Editor ]';
                    } else if (target.box["ood.AnimBinder"] && i == "frames") {
                        type = 'button';
                        $fun = function (profile, cell, a, b, e, src) {
                            page._showAnimEditor(target, function (conf) {
                                var oldProp = target.properties["frames"];
                                var hash = {'_ext': {}};
                                ood.each(conf, function (o, i) {
                                    if (!ood.compareVar(o, oldProp[i])) {
                                        hash._ext[i] = ood.clone(o);
                                    }
                                });
                                target.properties["frames"] = ood.clone(conf);
                                // undo-redo : modify items/header/rows in propgrid
                                if (!nointeraction) {
                                    page.markDirty(function () {
                                        target.properties["frames"] = ood.clone(oldProp);
                                    }, function () {
                                        target.properties["frames"] = ood.clone(conf);
                                    }, "modify apicaller");
                                }
                                ood(src).focus();
                            });
                        };
                        cv = caption = '[ $RAD.designer.conf.Editor ]';
                    } else if (target.box['ood.AnimBinder'] && (i == 'type')) {
                        type = 'listbox';
                        editorListItems = (function (h) {
                            var arr = [];
                            ood.each(h, function (o, i) {
                                arr.push({
                                    'id': i,
                                    'tips': '<img src="/RAD/img/animate/' + i + '.gif" /> '
                                });
                            });
                            return arr;
                        })(ood.Dom.$AnimateEffects);

                    } else if (target.box['ood.svg'] && i === 'attr') {
                        type = 'button';
                        $fun = function (profile, cell, a, b, e, src) {
                            page._decorationWnd(target, src, _null, profile, cell, nointeraction);
                        };
                        cv = caption = '[ $RAD.designer.conf.Editor ]';
                    } else if (target.box['ood.UI.FusionChartsXT'] && i === 'JSONData' && FCCONF.attrCat[prop.chartType]) {
                        type = 'button';
                        $fun = function (profile, cell, a, b, e, src) {
                            page._decorationWnd(target, src, _null, profile, cell, nointeraction);
                        };
                        cv = caption = '[ $RAD.designer.conf.Editor ]';

                        // } else if (target.box['ood.UI.ECharts'] && i === 'chartOption' ) {
                        //                     //     type = 'button';
                        //                     //     $fun = function (profile, cell, a, b, e, src) {
                        //                     //         page._decorationWnd(target, src, _null, profile, cell, nointeraction);
                        //                     //     };
                        //                     //     cv = caption = '[ $RAD.designer.conf.Editor ]';
                    } else if (target.box['ood.UI'] && (i === 'showEffects' || i === 'hideEffects')) {
                        type = 'button';
                        $fun = function (profile, cell, a, b, e, src) {
                            page._decorationWnd(target, src, 'effects', profile, cell, nointeraction);
                        };
                        cv = caption = '[ $RAD.designer.conf.Editor ]';
                    } else if (target.box['ood.UI'] && (i === 'sandboxTheme')) {
                        type = 'combobox';
                        editorListItems = ood.copy(CONF.designer_themes2);

                        if (CONF.enable_editSandboxTheme) {
                            commandBtn = 'pop';
                        }

                        $tagVar = {
                            'prop': i,
                            'profile': target,
                            'page': page
                        };
                        // command btn event in  $profilegrid_cmd
                    } else if (CONF.widgets_itemsProp[i] && (CONF.widgets_itemsProp[i][target.key] || CONF.widgets_itemsProp[i].all)) {
                        type = 'button';
                        //for object edit
                        $fun = function (profile, cell, a, b, e, src) {
                            var o = cell.$tagVar,
                                grid = profile.boxing();
                            if (!o) return;
                            var obj = ood.clone(o.profile.boxing()['get' + ood.str.initial(o.name)](), _true);

                            page._showMixedEditor(target, target.key, o.name, o.name, obj, src, function (items) {
                                var tagVar = o;
                                if (!tagVar) return;

                                var prf = tagVar.profile,
                                    b = prf.boxing(),
                                    page = tagVar.page,
                                    propN = tagVar.name,
                                    alias = prf.alias,
                                    fn1 = 'get' + ood.str.initial(propN),
                                    fn = 'set' + ood.str.initial(propN),
                                    oitems = ood.clone(b[fn1](), _true),
                                    t;

                                b[fn](ood.clone(items, _true));

                                // undo-redo : modify items/header/rows in propgrid
                                if (!nointeraction) {
                                    page.markDirty(function () {
                                        page.getByAlias(alias)[fn](ood.clone(oitems, _true));
                                    }, function () {
                                        page.getByAlias(alias)[fn](ood.clone(items, _true));
                                    }, "modify contorl's mix-type property");

                                    //for new panel
                                    //not consider that multi keys in a widget can have different drop function
                                    if (page.resizer && propN == 'items') {
                                        if (t = tagVar.profile.behavior.PanelKeys) {
                                            page._giveHandler(tagVar.profile);
                                        }
                                    }
                                }
                                var hash = {'_ext': {}};
                                hash._ext[propN] = items;

                                ood(src).focus();
                                grid.updateCell(cell, hash, _false, _true);
                            });
                        };
                        $tagVar = {
                            'widgetName': target.alias,
                            'profile': target,
                            'name': i,
                            'page': page
                        };
                        cv = caption = '[ $RAD.designer.conf.Object ]';
                    } else if (CONF.widgets_mapProp[i] && (CONF.widgets_mapProp[i][target.key] || CONF.widgets_mapProp[i].all)) {
                        type = 'button';
                        //for object edit
                        $fun = function (profile, cell, a, b, e, src) {
                            var o = cell.$tagVar;
                            if (!o) return;
                            o.cell = cell;
                            o.grid = profile.boxing();
                            var obj = o.profile.boxing()['get' + ood.str.initial(o.name)]();
                            var clsN = target.key, propN = o.name;

                            page._showEditor(target, clsN, propN, obj, src, function (data) {
                                var com = this, t,
                                    tagVar = o,
                                    grid = tagVar.grid,
                                    cell = tagVar.cell,
                                    prf = tagVar.profile,
                                    alias = prf.alias,
                                    b = prf.boxing(),
                                    fn1 = 'get' + ood.str.initial(o.name),
                                    fn = 'set' + ood.str.initial(o.name),
                                    odata = ood.clone(b[fn1](), _true);

                                b[fn](ood.clone(data, _true));

                                // undo-redo : modify dockMargin/rowOptions/colOptions in propgrid
                                if (!nointeraction) {
                                    var page = tagVar.page;
                                    page.markDirty(function () {
                                        page.getByAlias(alias)[fn](ood.clone(odata, _true));
                                    }, function () {
                                        page.getByAlias(alias)[fn](ood.clone(data, _true));
                                    }, "modify contorl's hash-type property");
                                    if (page.resizer && 'dockMargin' == o.name)
                                        page.resizer.rePosSize();
                                }

                                var hash = {'_ext': {}};
                                hash._ext[o.name] = data;
                                grid.updateCell(cell, hash, _false, _true);

                                ood(src).focus();
                            });
                        };
                        $tagVar = {
                            'widgetName': target.alias,
                            'name': i,
                            'profile': target,
                            'page': page
                        };
                        cv = caption = '[ $RAD.designer.conf.Object ]';
                    } else {
                        if (i == 'hoverPop') {
                            type = 'combobox';
                            var nodes = page.getWidgets(_true),
                                arr2 = [];
                            ood.arr.each(nodes, function (o) {
                                if (o.alias != target.alias)
                                    arr2.push(o.alias);
                            });
                            if (arr2 && arr2.length)
                                editorListItems = arr2;
                        } else if (i == 'dataBinder') {
                            type = 'combobox';
                            var nodes = page.getWidgets(_true),
                                arr2 = [];
                            ood.arr.each(nodes, function (o) {
                                if (o.key == "ood.DataBinder")
                                    arr2.push(o.properties.name);
                            });
                            if (arr2 && arr2.length)
                                editorListItems = arr2;
                        } else if (i == 'excelCellId') {
                            type = 'input';
                            commandBtn = "oodcon ood-uicmd-select";
                            $tagVar = {
                                'prop': i,
                                'profile': target,
                                'page': page
                            };
                        } else if (i == 'excelCellFormula' || i == 'gridValueFormula') {
                            type = 'input';
                            commandBtn = "oodcon ood-uicmd-select";
                            $tagVar = {
                                'prop': i,
                                'profile': target,
                                'page': page
                            };
                        } else if (i == 'formTarget') {
                            type = 'combobox';
                            var nodes = page.getWidgets(_true),
                                arr2 = ood.copy(dm[i].combobox);
                            ood.arr.each(nodes, function (o, i) {
                                if (o.key == "ood.APICaller") {
                                    if (i === 0) arr2.push({'type': 'split'});
                                    arr2.push(o.properties.name);
                                }
                            });
                            if (arr2 && arr2.length)
                                editorListItems = arr2;
                        } else if (i == 'className') {
                            type = 'combobox';
                            var nodes = page.getWidgets(_true),
                                arr2 = ood.copy(CONF.designer_list_class);
                            ood.arr.each(nodes, function (o) {
                                if (o.key == "ood.UI.CSSBox")
                                    arr2.push(o.properties.className);
                            });
                            if (arr2 && arr2.length)
                                editorListItems = arr2;
                        } else if (i == 'imageClass') {
                            type = 'combobox';
                            editorListItems = CONF.designer_list_imageclass;
                            dftWidth = '18em';
                            if (CONF.enable_fontAwesome) {
                                commandBtn = 'pop';
                            }

                            $tagVar = {
                                'prop': i,
                                'profile': target,
                                'page': page
                            };
                            // command btn event in  $profilegrid_cmd
                        } else if (i == 'imagePos') {
                            type = 'combobox';
                            editorListItems = CONF.designer_background_position;
                        }
                        else if (i == 'renderer') {
                            type = 'button';
                            editorReadonly = _true;
                            $fun = function (profile, cell, editorprf) {
                                var o = cell.$tagVar;
                                if (!o) return;
                                o.cell = cell;
                                o.grid = profile.boxing();
                                var node = profile.getSubNode('CELL', cell._serialId),
                                    text = typeof o.profile.properties.renderer == 'function' ? String(o.profile.properties.renderer) : 'function(properties){\n}';
                                var _cb = function (code) {
                                    var tagVar = o,
                                        prf = tagVar.profile,
                                        page = tagVar.page,
                                        grid = tagVar.grid,
                                        cell = tagVar.cell,
                                        alias = prf.alias,
                                        prop = prf.properties,
                                        ofun = prop.renderer;

                                    if (code) prop.renderer = new Function(ood.fun.args(code), ood.fun.body(code));
                                    else delete prop.renderer;
                                    // undo-redo : modify renderer in propgrid
                                    if (!nointeraction) {
                                        page.markDirty(function () {
                                            var prop = page.getByAlias(alias, _true).properties;
                                            if (ofun) prop.renderer = ofun;
                                            else delete prop.renderer;
                                        }, function () {
                                            var prop = page.getByAlias(alias, _true).properties;
                                            if (code) prop.renderer = new Function(ood.fun.args(code), ood.fun.body(code));
                                            else delete prop.renderer;
                                        }, "set control's renderer function");
                                    }

                                    var hash = {'_ext': {}};
                                    hash._ext.renderer = prop.renderer;
                                    grid.updateCell(cell, hash, _false, _true);

                                    node.focus();
                                };

                                if (getSPA() && _false === getSPA().fe("beforeObjectEditorPop", [
                                    "funEditor", i, text, _cb,
                                    "RAD.Designer", target.boxing(), node.get(0), cell, profile.boxing()])) return;

                                ood.ModuleFactory.getCom('funEditor', function () {
                                    this.host = page;
                                    this.setProperties({
                                        'imageClass': 'ri ri-code-line',
                                        'caption': o.widgetName + " => renderer ",
                                        'text': text,
                                        'fromRegion': node.cssRegion(_true),
                                        'tagVar': o,
                                        'onOK': function (obj) {
                                            var code = obj.properties.result.code;
                                            _cb(code || _null);
                                        }
                                    }, true);
                                    this.show();
                                });
                            };
                            $tagVar = {
                                'widgetName': target.alias,
                                'profile': target,
                                'page': page
                            };
                            cv = caption = '[ $RAD.designer.conf.Function ]';
                        } else if (i == "value") {
                            if (target.box['ood.UI.CheckBox'] || target.box['ood.UI.SCheckBox']) {
                                type = "checkbox";
                            } else if (target.box['ood.UI.DatePicker']) {
                                type = prop.timeInput ? "datetime" : "date";
                            } else if (target.box['ood.UI.TimePicker']) {
                                type = "time";
                            } else if (target.box['ood.UI.ColorPicker']) {
                                type = "color";
                            } else if (target.box['ood.UI.ComboInput']) {
                                type = prop.type;
                                if (type == 'file' || type == 'cmdbox') {
                                    type = "label";
                                }
                                else if (type == "listbox" || type == "helpinput" || type == "combobox") {
                                    if (type == "listbox") {
                                        type = "combobox";
                                        editorListItems = function () {
                                            return target.boxing().getItems("min");
                                        };
                                    } else {
                                        editorListItems = function () {
                                            return prop.editorListItems || _null;
                                        }
                                    }
                                    editorListKey = prop.listKey || "";
                                } else {
                                    editorListItems = _null;
                                    editorListKey = "";
                                }

                            } else if (target.box['ood.absList']) {
                                type = "helpinput";
                                editorListItems = function () {
                                    var items = prop.items, ss = [];
                                    if (items) {
                                        var fun = function (item, level) {
                                            ss.push({
                                                'id': item.id || item,
                                                'caption': ood.str.repeat("&nbsp;&nbsp;", level || 0) + (item.caption || item.id || item)
                                            })
                                            if (item.sub) {
                                                ood.arr.each(item.sub, function (o) {
                                                    fun(o, ++level);
                                                });
                                            }
                                        };
                                        ood.arr.each(items, function (item) {
                                            fun(item, 0);
                                        });
                                        return ss;
                                    } else {
                                        return _null;
                                    }
                                };
                                editorListKey = prop.listKey || "";
                            } else if (i == "value") {
                                type = 'input';
                                commandBtn = "ri ri-code-line";
                            }
                        } else if (i == "activeItem") {
                            if (target.box.KEY == "ood.UI.Image" || target.box.KEY == "ood.svg.image" || target.box.SINGLE_NODE_IMAGE) {
                                type = "combobox";
                                editorListItems = function () {
                                    return ood.absList.prototype.getItems("min", prop.items);
                                };
                            }
                        } else if (i == "activeAnim") {
                            type = 'combobox';
                            var nodes = page.getWidgets(_true),
                                arr2 = [];
                            ood.each(ood.Dom.$preDefinedAnims, function (v, i) {
                                arr2.push(i);
                            });
                            ood.arr.each(nodes, function (o, i) {
                                if (o.key == "ood.AnimBinder") {
                                    if (i === 0) arr2.push({'type': 'split'});
                                    arr2.push(o.properties.name);
                                }
                            });
                            if (arr2 && arr2.length)
                                editorListItems = arr2;
                        } else if (dm[i].readonly) {
                            return;
                        } else if (dm[i].custom) {
                            type = 'popbox';
                            editorReadonly = _true;
                            cv = caption = '[ $RAD.designer.conf.custom ]';

                            if (ood.isFun(dm[i].customIniCell)) {
                                type = 'label';
                                cv = '';
                                // customIniCell(profile/*control's profile object*/, propKey/*property key*/)
                                cellEx = dm[i].customIniCell(target, i);
                            }
                            //for object edit
                            $fun = function (profile, cell) {
                                var tagVar = cell.$tagVar,
                                    page = tagVar.page,
                                    grid = profile.boxing();
                                var node = profile.getSubNode('CELL', cell._serialId),
                                    callback = function (newValue, cellOptions) {
                                        var prf = tagVar.profile,
                                            alias = prf.alias,
                                            b = prf.boxing(),
                                            fn = 'set' + ood.str.initial(tagVar.key),
                                            fn1 = 'get' + ood.str.initial(tagVar.key);
                                        if (!ood.isFun(b[fn])) return;

                                        var oldValue = b[fn1]();

                                        b[fn](ood.clone(newValue, _true));
                                        if (!nointeraction) {
                                            // undo-redo : modify custom prop in propgrid
                                            page.markDirty(function () {
                                                page.getByAlias(alias)[fn](ood.clone(oldValue, _true));
                                            }, function () {
                                                page.getByAlias(alias)[fn](ood.clone(newValue, _true));
                                            }, "set control's custom property");
                                        }
                                        if (cellOptions)
                                            grid.updateCell(cell, cellOptions, _false, _true);
                                        node.focus();
                                    };
                                //custom(
                                //  profile, /*control's profile object*/
                                //  propKey, /*property key*/
                                //  propValue, /*property value*/
                                //  callback, /*callback(newValue,cellOptions)*/
                                //  canvas, /*the canvas object*/
                                //  gridprofile, /* grid*/
                                //  gridcell, /*grid cell*/
                                //  gridcellnode /*grid cell node*/
                                //)
                                dm[i].custom(tagVar.profile, tagVar.key, tagVar.profile.properties[tagVar.key], callback, page, profile/*grid*/, cell, node/*cell*/);
                            };
                            $tagVar = {
                                'profile': target,
                                'alias': target.alias,
                                'key': i,
                                'page': page
                            };
                        } else if (dm[i].html) {
                            type = 'button';
                            editorReadonly = _true;
                            //for object edit
                            $fun = function (profile, cell, editorprf) {
                                var o = cell.$tagVar;
                                if (!o) return;
                                o.cell = cell;
                                o.grid = profile.boxing();
                                var node = profile.getSubNode('CELL', cell._serialId),
                                    html = o.profile.boxing()['get' + ood.str.initial(o.name)]();

                                var _cb = function (html) {
                                    var t,
                                        prf = o.profile,
                                        page = o.page,
                                        grid = o.grid,
                                        cell = o.cell,
                                        alias = prf.alias,
                                        b = prf.boxing(),
                                        fn = 'set' + ood.str.initial(o.name),
                                        fn1 = 'get' + ood.str.initial(o.name);
                                    if (!ood.isFun(b[fn])) return;

                                    var ov = b[fn1]();

                                    b[fn](html);

                                    // undo-redo : modify html prop in propgrid
                                    if (!nointeraction) {
                                        page.markDirty(function () {
                                            page.getByAlias(alias)[fn](ov);
                                        }, function () {
                                            page.getByAlias(alias)[fn](html);
                                        }, "set control's html property");
                                    }

                                    var hash = {'_ext': {}};
                                    hash._ext[o.name] = html;
                                    grid.updateCell(cell, hash, _false, _true);

                                    node.focus();
                                };

                                if (getSPA() && _false === getSPA().fe("beforeObjectEditorPop", [
                                    "htmlEditor", i, html, _cb,
                                    "RAD.Designer", target.boxing(), node.get(0), cell, profile.boxing()])) return;

                                ood.ModuleFactory.getCom('HTMLEditor', function () {
                                    this.host = page;
                                    this.setProperties({
                                        'caption': o.widgetName + " => " + o.name,
                                        'image': 'ri ri-html5-line',
                                        'text': html,
                                        'fromRegion': node.cssRegion(_true),
                                        'tagVar': o,
                                        'onOK': function (obj, html) {
                                            _cb(html);
                                        }
                                    });
                                    this.show();
                                });
                            };
                            $tagVar = {
                                'widgetName': target.alias,
                                'profile': target,
                                'name': i,
                                'page': page
                            };
                            cv = caption = '[ HTML ]';
                        } else if (dm[i].listbox) {
                            type = 'listbox';
                            list = [];
                            listKey = target.key + ":" + "properties" + ":" + i;
                            if (ood.isFun(dm[i].listbox)) {
                                var d = dm[i].listbox;
                                list = function () {
                                    var a = d.call(target), list = [];
                                    ood.arr.each(a, function (o) {
                                        list.push({'id': o, 'caption': o, 'value': o})
                                    });
                                    return list;
                                };
                            } else if (ood.isObj(dm[i].listbox[0]))
                                list = ood.copy(dm[i].listbox);
                            else
                                ood.arr.each(dm[i].listbox, function (o, i) {
                                    list.push({'id': o, 'caption': o})
                                });
                            ood.UI.cacheData(listKey, list);
                        } else if (dm[i].combobox) {
                            type = 'combobox';
                            list = [];
                            if (ood.isFun(dm[i].combobox)) {
                                var d = dm[i].combobox;
                                list = function () {
                                    var a = d.call(target), list = [];
                                    ood.arr.each(a, function (o) {
                                        list.push({'id': o, 'caption': o})
                                    });
                                    return list;
                                };
                            } else {
                                if (ood.isObj(dm[i].combobox[0]))
                                    list = ood.copy(dm[i].combobox);
                                else
                                    ood.arr.each(dm[i].combobox, function (o, i) {
                                        list.push({'id': o, 'caption': o})
                                    });
                            }
                            listKey = target.key + ":" + "properties" + ":" + i;
                            ood.UI.cacheData(listKey, list);
                        } else if (dm[i].helpinput) {
                            listKey = target.key + ":" + "properties" + ":" + i;
                            type = 'helpinput';
                            list = ood.copy(dm[i].helpinput);
                            ood.UI.cacheData(listKey, list);
                        } else if (dm[i].trigger) {
                            type = 'button';
                            editorReadonly = _true;
                            cv = caption = '[ $RAD.designer.conf.Invoke ]';
                            value = i;
                            $fun = function (profile, cell, pro) {
                                var o = cell.$tagVar;
                                if (!o) return;

                                ood.tryF(o.trigger, _null, o.profile.boxing());
                            };
                            $tagVar = {
                                'profile': target,
                                'name': i,
                                'trigger': dm[i].trigger
                            };
                        } else if (ood.isBool(o)) {
                            type = 'checkbox';
                            $tag = i;
                        } else if (dm[i].format) {
                            if (CONF.getClientMode() != 'singlepage' && (dm[i].format == 'image' || dm[i].format == 'imageurl' || dm[i].format == 'media')) {
                                type = "popbox";
                                //for object edit
                                $fun = function (profile, cell, editorprf) {
                                    var tagVar = cell.$tagVar;
                                    if (!tagVar) return;
                                    tagVar.cell = cell;
                                    tagVar.grid = profile.boxing();
                                    var path = tagVar.profile.boxing()['get' + ood.str.initial(tagVar.name)]();

                                    var node = profile.getSubNode('CELL', cell._serialId),
                                        _cb = function (path) {
                                            var t,
                                                prf = tagVar.profile,
                                                page = tagVar.page,
                                                grid = tagVar.grid,
                                                cell = tagVar.cell,
                                                alias = prf.alias,
                                                b = prf.boxing(),
                                                fn = 'set' + ood.str.initial(tagVar.name),
                                                fn1 = 'get' + ood.str.initial(tagVar.name),
                                                opath = b[fn1]() || "";

                                            if (!ood.isFun(b[fn])) return;

                                            path = CONF.adjustRelativePath(path);

                                            if (dm[i].format == 'imageurl')
                                                path = "url(" + path + ")";

                                            // undo-redo : modify src path prop in propgrid
                                            if (!nointeraction) {
                                                page.markDirty(function () {
                                                    page.getByAlias(alias)[fn](opath);
                                                }, function () {
                                                    page.getByAlias(alias)[fn](path);
                                                }, "set control's media file path property");
                                            }
                                            if (editorprf.box) editorprf.boxing().setUIValue(path);
                                            else grid.updateCell(cell, {value: path}, true, true);

                                            //  b[fn](path);
                                            node.focus();
                                        };
                                    if (getSPA() && _false === getSPA().fe("beforeURISelectorPop",
                                        [i, path, _cb,
                                            'RAD.Designer', tagVar.profile.boxing(), node.get(0), cell, profile.boxing(), editorprf.boxing()
                                        ])) return;

                                    if (CONF.getClientMode() != 'singlepage') {
                                        ood.ModuleFactory.getCom((dm[i].format == 'image' || dm[i].format == 'imageurl') ? 'RAD.ImageSelector' : 'RAD.FileSelector', function () {
                                            this.host = page;
                                            this.setProperties({
                                                'caption': tagVar.widgetName + " => " + tagVar.name,
                                                'imageClass': 'ri ri-image-2-line',
                                                'text': path,
                                                'fromRegion': node.cssRegion(_true),
                                                'tagVar': tagVar,
                                                'onOK': function (obj, path) {
                                                    _cb(path);
                                                }
                                            });
                                            this.show();
                                        });
                                    }
                                };
                                $tagVar = {
                                    'widgetName': target.alias,
                                    'profile': target,
                                    'name': i,
                                    'page': page
                                };
                            } else if (dm[i].format == 'color') {
                                type = "color";
                            } else {
                                type = "input";
                            }
                        } else if (ood.UI.$ps[i]) {
                            type = 'number';
                            unit = target._spaceUnit || (target.$isEm(prop[i]) ? 'em' : 'px');
                            units = 'px;em';
                            precision = unit == 'em' ? 4 : 0;
                        } else if (dm[i] && dm[i].$spaceunit) {
                            type = 'number';
                            unit = target._spaceUnit || (target.$isEm(prop[i]) ? 'em' : 'px');
                            units = 'px;em';
                            precision = unit == 'em' ? 4 : 0;
                        } else if (ood.isNumb(o)) {
                            type = 'number';
                        } else if (ood.isDate(o)) {
                            type = 'date';
                        } else if (ood.isObj(o)) {
                            type = 'button';
                            editorReadonly = _true;
                            //for object edit
                            $fun = function (profile, cell, pro) {
                                var o = cell.$tagVar;
                                if (!o) return;
                                o.cell = cell;
                                o.grid = profile.boxing();
                                var node = profile.getSubNode('CELL', cell._serialId),
                                    obj = o.profile.boxing()['get' + ood.str.initial(o.name)](),
                                    text = ood.Coder.formatText(
                                        page.stringify(
                                            ood.clone(obj, function (o, i) {
                                                return (i + '').charAt(0) != '_'
                                            })
                                        )
                                    ),
                                    _cb = function (obj) {
                                        var t,
                                            tagVar = o,
                                            prf = tagVar.profile,
                                            alias = prf.alias,
                                            page = tagVar.page,
                                            grid = tagVar.grid,
                                            cell = tagVar.cell,
                                            b = tagVar.profile.boxing(),
                                            fn = 'set' + ood.str.initial(o.name),
                                            fn1 = 'get' + ood.str.initial(o.name);
                                        if (!ood.isFun(b[fn])) return;

                                        var ov = b[fn1]();

                                        b[fn](ood.clone(obj, _true));

                                        // undo-redo : modify other object-type prop in propgrid
                                        if (!nointeraction) {
                                            page.markDirty(function () {
                                                page.getByAlias(alias)[fn](ood.clone(ov, _true));
                                            }, function () {
                                                page.getByAlias(alias)[fn](ood.clone(obj, _true));
                                            }, "set control's object-type property");

                                            if (page.resizer && 'dockMargin' == o.name)
                                                page.resizer.rePosSize();
                                        }

                                        var hash = {'_ext': {}};
                                        hash._ext[o.name] = obj;
                                        grid.updateCell(cell, hash, _false, _true);

                                        node.focus();

                                        //for new panel
                                        //not consider that multi keys in a widget can have different drop function
                                        if (o.name == 'items') {
                                            if (_null === obj)
                                                b.setItems([]);

                                            if (t = tagVar.profile.behavior.PanelKeys) {
                                                page._giveHandler(tagVar.profile);
                                            }
                                        }
                                    };

                                if (getSPA() && _false === getSPA().fe("beforeObjectEditorPop", [
                                    "jsonEditor", "properties", text, _cb,
                                    "RAD.Designer", o.profile.boxing(), node.get(0), profile.boxing(), pro && pro.boxing()])) return;
                                ood.ModuleFactory.getCom('jsonEditor', function () {
                                    this.host = page;
                                    this.setProperties({
                                        'caption': o.widgetName + " => " + o.name,
                                        'imageClass': (obj && obj.constructor == Array) ? 'ri ri-list-unordered' : 'ri ri-table-line',
                                        'text': text,
                                        'fromRegion': node.cssRegion(_true),

                                        'onOK': function (obj) {
                                            _cb(obj.properties.object);
                                        }
                                    });
                                    this.show();
                                });
                            };
                            $tagVar = {
                                'widgetName': target.alias,
                                'profile': target,
                                'name': i,
                                'page': page
                            };
                            cv = caption = '[ $(RAD.designer.conf.Object) ]';
                        } else if (dm[i].type) {
                            type = dm[i].type;
                        } else {
                            type = 'input';
                        }
                    }

                    if (!cv) {
                        cv = dm[i].dynamic ? target.boxing()['get' + ood.str.initial(i)]() : prop[i];
                    }
                    //if(ood.isStr(cv)){
                    //cv=page.stringify(cv);
                    //for serialized string
                    //cv = cv.replace(/^\"/,'').replace(/\"$/,'');
                    //}

                    var cell = {
                        'value': cv,
                        'type': type,
                        'editorCommandBtn': commandBtn,
                        'units': units,
                        'unit': unit,
                        'precision': precision,
                        'trimTailZero': _true,
                        'disabled': editorDisabled,
                        'editorReadonly': editorReadonly,
                        '$tag': $tag,
                        'event': $fun,
                        '$tagVar': $tagVar,
                        'editorListKey': listKey,
                        'editorListItems': editorListItems
                    };
                    if (caption)
                        cell.caption = caption;
                    if (cellEx)
                        ood.merge(cell, cellEx, 'all');
                    if (dftWidth || dm[i].dftWidth)
                        cell.editorDropListWidth = dftWidth || dm[i].dftWidth;
                    if (t = ood.get(CONF.widgets_customCellOptions, [target.key, i]))
                        ood.merge(cell, t, 'all');

                    var ic;
                    if (dm[i].caption) {
                        ic = ood.adjustRes(dm[i].caption);
                    } else {
                        ic = RAD.EditorTool.getPropName(target.key, i);
                    }

                    // Give a chance to modify editor setting for value cell
                    getSPA() && getSPA().fe("onInitPropValueCell", [i, _null, cv, nointeraction ? 'RAD.ActionsEditor' : 'RAD.Designer', target, cell, grid]);

                    var cells = [{
                        'caption': ic,
                        'tips': ood.getRes('RAD.designer.openapi')
                    }, cell];
                    arr.push({'id': 'properties:' + i, 'tipk': 'property', 'tipv': i, 'value': i, 'cells': cells});

                    if (CONF.grid_showPropBinder && page.tempSelected && page.tempSelected.length === 1 && !dm[i].inner && !dm[i].readonly
                        // white list
                        && (CONF.PropBinderWhiteList && (CONF.PropBinderWhiteList[i] || (CONF.PropBinderWhiteList[target.box.KEY] && CONF.PropBinderWhiteList[target.box.KEY][i])))
                        // black list
                        && !(CONF.PropBinderBlackList && (CONF.PropBinderBlackList[i] || (CONF.PropBinderBlackList[target.box.KEY] && CONF.PropBinderBlackList[target.box.KEY][i])))
                    ) {
                        var hash = page._anaPropbinder(ood.get(prop, ['propBinder', i]));
                        cells.push({
                            'type': "popbox",
                            'disabled': _false,
                            'editable': _true,
                            'editorProperties': {'dropImageClass': "ri ri-link"},
                            'value': hash.str, // string or function
                            'tag': hash.type,
                            'tagVar': hash.fun,
                            'event': function (profile, cell, editorprf, b, e, src) {
                                if (getSPA() && _false === getSPA().fe("beforePropbinderSet", [i, cell.tagVar, function (binderResult, valueResult) {
                                    var h = page._anaPropbinder(binderResult);
                                    profile.boxing().updateCell(cell, {
                                        'tag': h.type,
                                        'tagVar': h.fun,
                                        'value': h.fun ? h.str : ''
                                    }, _false, _true);

                                    if (ood.isSet(valueResult))
                                        profile.boxing().updateCell(cell._row.cells[1], valueResult, _false, _true);

                                    page.markDirty();
                                },
                                    cell.tag, cell.value,
                                    "RAD.Designer",
                                    target.boxing(),
                                    profile.getSubNode('CELL', cell._serialId).get(0),
                                    cell,
                                    profile.boxing(), editorprf && editorprf.boxing()])
                                ) return;
                                // default : do nothing
                            }
                        });
                    }
                });

                // category prop
                if (!specailFlag && CONF.widgets_prop_cat) {
                    var arrCat = [], a;
                    ood.arr.each(CONF.widgets_prop_cat, function (sub) {
                        a = [];
                        ood.arr.each(sub.items, function (id, k) {
                            if ((k = ood.arr.subIndexOf(arr, 'id', 'properties:' + id)) != -1) {
                                a.push(arr[k]);
                                arr[k] = _null;
                            }
                        });
                        if (a.length)
                            arrCat.push({
                                'id': "sub:" + sub.id,
                                'caption': "<span style='" + (nointeraction ? '' : 'font-weight:normal') + ";'>$(RAD.designer.conf.propcat." + sub.id + ")</span>",
                                'group': _true,
                                'cellStyle': nointeraction ? '' : 'font-weight:normal',
                                'sub': a
                            });
                    });
                    ood.filter(arr, function (o) {
                        return !!o;
                    });
                    if (arr.length) {
                        ood.arr.stableSort(arr, function (x, y) {
                            return x.id > y.id ? 1 : -1;
                        });
                        arrCat.push({
                            'id': "sub:featured",
                            'caption': "<span style='" + (nointeraction ? '' : 'font-weight:normal') + ";'>$(RAD.designer.conf.propcat.Featured Prop)</span>",
                            'group': _true,
                            'sub': arr
                        });
                        if (arrCat.length >= 2) {
                            var a = arrCat[arrCat.length - 1];
                            arrCat[arrCat.length - 1] = arrCat[arrCat.length - 2];
                            arrCat[arrCat.length - 2] = a;
                        }
                    }
                    return arrCat;
                } else {
                    return arr;
                }
            },
            '_anaPropbinder': function (propB) {
                var hash = {
                    //type:'', // 3 options: var, expression, function
                }, str, isFun = ood.isFun(propB);
                if (propB) {
                    if (isFun) {
                        str = (ood.fun.body(propB) || "").replace(/^\s*/, "").replace(/\s*$/, "");
                        hash.fun = propB;

                        // single var
                        if (/^\s*return\s*get\s*\((\s*("(\\.|[^"\\])*")|('(\\.|[^'\\])*'))\s*\)[;\s]*$/.test(str)) {
                            hash.str = str.replace(/^\s*return\s* get\s*\(['"]/, '').replace(/['"]\)[;\s]+$/, '');
                            hash.type = "var";
                        }
                        // expression
                        else if (/^\s*return\s+/.test(str)) {
                            hash.str = str.replace(/^\s*return\s*/, '').replace(/[;\s]+$/, '');
                            hash.type = 'expression';
                        }
                        // function
                        else {
                            hash.str = propB + '';
                            hash.type = 'function';
                        }
                    } else {
                        hash.str = propB;
                        if (/^\s*function\s*\(/.test(propB) && ood.isFun(hash.fun = ood.unserialize(propB))) {
                            hash.type = 'function';
                        } else if (propB.indexOf("'") == -1 && propB.indexOf('"') == -1 && ood.isFun(hash.fun = ood.unserialize('function(){return get("' + propB + '");}'))) {
                            hash.type = 'var';
                        } else if (ood.isFun(hash.fun = ood.unserialize('function(){return ' + propB + ';}'))) {
                            hash.type = 'expression';
                        } else {
                            hash = {};
                        }
                    }
                    return hash;
                }
                return hash;
            },
            '_buildEventsRows': function (target, specialItems, specailFlag, nointeraction) {
                var page = this,
                    canvas = page.canvas,
                    isCanvas = target === (canvas && canvas.get(0)),
                    arr = [];
                ood.each(isCanvas ? ood.Module.$EventHandlers : target.box.$EventHandlers, function (o, i) {
                    if (i.charAt(0) == "_") return;
                    if (CONF.widgets_hiddenEvents[i]) return;
                    if (ood.get(CONF.widgets_hiddenEvents, [target.box.KEY, i])) return;
                    if (CONF.widgets_hiddenEvents_filter && _false === CONF.widgets_hiddenEvents_filter(target.box.KEY, i, target)) return;

                    // Event paramters
                    var doc = RAD.EditorTool.getDoc(target.key + ".prototype." + i, _null, _true),
                        code = o + "",
                        comments = '';
                    if (doc) {
                        // have to add 8 spaces manually
                        var newline = "\n        ";
                        comments = "/**";
                        comments += newline + " * " + (doc.$desc || "");
                        comments += newline + " * @method " + i + " [" + (isCanvas ? "ood.Module" : target.box.KEY) + " event]";

                        code = "";
                        if (doc.$paras) {
                            code += "function(";
                            var argsdoc = doc.$paras;
                            var args = ood.fun.args(target.box.$EventHandlers[i]);
                            for (var k = 0, l = args.length; k < l; k++) {
                                if (argsdoc[k]) {
                                    args[k] = argsdoc[k].split(/\s*:\s*/)[0];
                                }
                                var arr2 = ["", args[i], "", ""];
                                if (argsdoc[k]) arr2 = /(.*):(\s*[\w\.]*)([^\w].*)/.exec(argsdoc[k]);
                                comments += newline + " * @param " + "{" + (arr2[2] || "").replace(/\s/g, '') + "} " + (arr2[1] || "").replace(/\s/g, '') + " " + (arr2[3] || "");
                            }
                            if (doc.$rtn) comments = newline + " * @return " + doc.$rtn;
                            comments += newline + "*/";

                            code += args.join(", ");
                            code += "){\n";
                            code += "}";
                        } else {
                            code += o + "";
                        }
                    }

                    if (specialItems) {
                        var inSpecial = ood.arr.indexOf(specialItems, i) != -1;
                        if (specailFlag === _true ? !inSpecial : inSpecial) return;
                    }
                    var eventname = i.charAt(0) == 'b' ? "$(RAD.designer.eventbfrtag)" :
                        i.charAt(0) == 'a' ? "$(RAD.designer.eventafttag)" :
                            "$(RAD.designer.eventontag)",
                        ic = RAD.EditorTool.getEventName(isCanvas ? 'ood.Module' : target.key, i, _true),
                        tips = (CONF.enable_codeEdtor ? ("$(RAD.designer.conf.Dblclick to create or edit the event handler)") : ""),
                        actionConf, funname;

                    if (isCanvas) {
                        var em = ood.get(page._cls, ['Instance', 'events']);
                        if (!em) ood.set(page._cls, ['Instance', 'events'], em = {});
                        actionConf = ood.copy(em[i]);
                    } else if (target['ood.Module']) {
                        actionConf = ood.copy(target.events[i]);
                    } else {
                        actionConf = ood.copy(target[i]);
                    }
                    if (actionConf && (ood.isStr(actionConf) || ood.isFun(actionConf))) actionConf = [actionConf];
                    var actions = actionConf && actionConf.actions || actionConf;
                    // fun hander
                    ood.arr.each(actions, function (o) {
                        if (typeof o == "string") {
                            funname = o;
                            return _false;
                        }
                    });
                    ood.arr.each(actions, function (o) {
                        if (ood.isHash(o) && o.script) {
                            funname2 = o.script;
                            return _false;
                        }
                    });

                    // actions conf
                    ood.filter(actions, function (o) {
                        return ood.isHash(o);
                    });
                    var t, vv = ((t = actions ? ood.isArr(actions) ? actions.length : 1 : 0) === 0 ? ""
                        : t === 1 ? ("" + t + " " + ood.adjustRes("$RAD.designer.action"))
                            : ("" + t + " " + ood.adjustRes("$RAD.designer.actions")));
                    if (funname) vv += (vv ? " + " : "") + ood.getRes("RAD.action.Function");
                    if (vv) vv = "[" + vv + "]";
                    target2 = target;
                    if (isCanvas) {
                        target2 = new ood.Module;
                        target2._isCanvas = 1;
                    }
                    var $tagVar = {
                        'widgetName': isCanvas ? ood.getRes("RAD.pm.Page") : target.alias,
                        'path': "Instance",
                        'key': i,
                        'target': target2,
                        'funname': funname,
                        'comments': comments,
                        'ini': code,
                        '_eventkey': i,
                        'cap': "$(RAD.action." + (isCanvas ? "Page" : target['ood.Module'] ? "Module" : "Control") + ")  => " + (isCanvas ? "" : target.alias + " - ") + ic,
                        'parent': page
                    };

                    if (isCanvas) {
                        // set a special tag
                        $tagVar.target._$canvas = !!isCanvas;
                    }

                    arr.push({
                        'id': 'event:' + i, 'tipk': 'event', 'tipv': i, 'tag': 2, 'value': i, 'cells': [
                            {
                                'caption': eventname + ic,
                                'tips': ood.getRes('RAD.designer.openapi')
                            },
                            {
                                'value': funname,
                                'tips': tips,
                                'type': 'cmdbox',
                                '$tagVar': $tagVar,
                                'editMode': "hover",
                                'caption': vv,
                                'editorProperties': {
                                    'commandBtn': "delete"
                                },
                                'editorEvents': {
                                    'onShowTips': function (profile, node, pos) {
                                        var keys = profile.box.$Keys;
                                        if (profile.getKey(node.id) == keys.INPUT)
                                            ood.Tips.show(pos, ood.getRes("RAD.action.Click to edit actions"));
                                        else if (profile.getKey(node.id) == keys.BTN || profile.getKey(node.parentNode.id) == keys.BTN)
                                            ood.Tips.show(pos, ood.getRes("RAD.action.Click to edit event function"));
                                        else if (profile.getKey(node.id) == keys.SBTN || profile.getKey(node.parentNode.id) == keys.SBTN)
                                            ood.Tips.show(pos, ood.getRes("RAD.action.Delete the event responses"));
                                        else ood.Tips.hide();
                                        return _false;
                                    }
                                }
                            }
                        ]
                    });
                });


                // category events
                if (!specailFlag && CONF.widgets_events_cat) {
                    //    if (!specailFlag||true && CONF.widgets_events_cat) {
                    var arrCat = [], a;
                    ood.arr.each(CONF.widgets_events_cat, function (sub) {
                        a = [];
                        ood.arr.each(sub.items, function (id, k) {
                            if ((k = ood.arr.subIndexOf(arr, 'id', 'event:' + id)) != -1) {
                                a.push(arr[k]);
                                arr[k] = _null;
                            }
                        });
                        if (a.length)
                            arrCat.push({
                                'id': "sub:" + sub.id,
                                'caption': "<span style='" + (nointeraction ? '' : 'font-weight:normal') + ";'>$(RAD.designer.conf.propcat." + sub.id + ")</span>",
                                'group': _true,
                                'cellStyle': nointeraction ? '' : 'font-weight:normal',
                                'sub': a
                            });
                    });
                    ood.filter(arr, function (o) {
                        return !!o;
                    });
                    if (arr.length) {
                        ood.arr.stableSort(arr, function (x, y) {
                            return x.id > y.id ? 1 : -1;
                        });
                        arrCat.push({
                            'id': "sub:featured",
                            'caption': "<span style='" + (nointeraction ? '' : 'font-weight:normal') + ";'>$(RAD.designer.conf.propcat.Featured Events)</span>",
                            'group': _true,
                            'sub': arr
                        });
                        if (arrCat.length >= 2) {
                            var a = arrCat[arrCat.length - 1];
                            arrCat[arrCat.length - 1] = arrCat[arrCat.length - 2];
                            arrCat[arrCat.length - 2] = a;
                        }
                    }
                    return arrCat;
                } else {
                    return arr;
                }
            },
            '__buildSubRows': function (uis, id, specailFlag, grid) {
                var arr = [],
                    page = this,
                    len = uis["ood.Module"] ? 1 : uis._nodes.length,
                    disabled = len > 1 ? _true : _false,
                    //get the last one first
                    target = uis.get(page.SelectedFocus <= 0 ? 0 : page.SelectedFocus),
                    canvas = page.canvas,
                    isCanvas = target === (canvas && canvas.get(0)),
                    specialItems = len === 1 ? (CONF.widgets_xprops[isCanvas ? "ood.Module" : uis["ood.Module"] ? "ood.Module" : target.key] || []) : [];

                //for properties
                if (!isCanvas && (id == 'properties' || id == 'special')) {
                    var a1 = page._buildPropRows(target, specialItems, specailFlag, _null, grid);
                    if (a1.length) ood.arr.insertAny(arr, a1);
                }
                //for events
                if (!page.$moduleInnerMode) {
                    if (id == 'UIE' || id == 'special') {
                        var a2 = page._buildEventsRows(target, specialItems, specailFlag);
                        if (a2.length) ood.arr.insertAny(arr, a2);
                    }
                }

                if (id == "special") {
                    ood.arr.stableSort(arr, function (x, y) {
                        x = ood.arr.indexOf(specialItems, x.value);
                        y = ood.arr.indexOf(specialItems, y.value);
                        return x > y ? 1 : x == y ? 0 : -1;
                    });
                }
                // for multi selections
                if (!isCanvas && !uis['ood.Module'] && id !== 'UIE') {
                    //check others to disable editable
                    ood.filter(arr, function (o, i) {
                        var ns = uis._nodes,
                            fun = function (key, cells) {
                                var value = cells[1].value, prop, evs;
                                for (var i = 0; i < ns.length; i++) {
                                    if (page.SelectedFocus === i) {
                                        continue;
                                    }
                                    // not prop and not event
                                    prop = ns[i].properties;
                                    if (!(key in prop)) {
                                        evs = ns[i].box.$EventHandlers;
                                        if (!(key in evs))
                                            cells[1].disabled = _true;
                                    }

                                    if (prop[key] !== value)
                                        cells[1].disabled = _true;
                                }
                            };
                        if (!o.group) fun(o.value, o.cells)
                        else {
                            ood.arr.each(o.sub, function (row) {
                                fun(row.value, row.cells);
                            });
                        }
                    });
                }
                return arr;
            },
            '$iconlist_aftervalueupdated': function (profile, ov, nv) {
                var page = this;
                if (nv) {
                    page.resizer.resetTarget(_null, _false);

                    var m = ood.getObject(nv);
                    if (m['ood.Module']) {
                        if (m.getUIComponents().isEmpty()) {
                            page._setSelected([nv], _true);
                        } else {
                            page.selectWidget(nv);
                        }
                    } else {
                        page._setSelected([nv], _true);
                    }
                }
            },

            '_propFilter_oncmd': function () {
                var w = this.propFilter;
                if (w.getUnit() != 'Show All') {
                    w.setUnit("Show All");
                } else {
                    w.resetValue("");
                    // refresh prop grid
                    this.profileGrid.get(0).$itemFilter = this.profileGrid.get(0).$widget = null;
                    this._setSelected(this.tempSelected, _true);
                }
            },
            '_propFilter_unit': function (profile, unit) {
                var w = this.propFilter;
                if (unit == 'Show All') {
                    w.setInputReadonly(false);
                    // refresh prop grid
                    this.profileGrid.get(0).$itemFilter = this.profileGrid.get(0).$widget = null;
                    this._setSelected(this.tempSelected, _true);
                } else {
                    w.resetValue("").setInputReadonly(true);
                    this._propFilter_();
                }
            },
            '_propFilter_onchange': function (profile, oldValue, newValue) {
                ood.resetRun('_propFilter_', this._propFilter_, 500, [], this);
            },
            '_propFilter_': function () {
                var page = this,
                    newValue = page.propFilter.getUIValue(),
                    unit = page.propFilter.getUnit(),
                    collectDft = function (w, key) {
                        var ctrl, h = {};
                        if (key == 'canvas') {
                            ctrl = {
                                properties: {width: 1, height: 1, theme: 1}
                            };

                            // no _cls in sub moudle designer
                            // there are width and height for the canvas only
                            if (!page._cls) {
                                ood.each(ctrl.properties, function (o, i) {
                                    h['properties:' + i] = 1;
                                });
                                return h;
                            }

                            var ins = page._cls.Instance, sta = page._cls.Static;
                            if (ins.events) ctrl.events = ins.events;

                            if (ins.autoDestroy) ctrl.properties.autoDestroy = 1;
                            if (!ood.isEmpty(ins.properties)) ctrl.properties.properties = 1;
                            if (!ood.isEmpty(ins.functions)) ctrl.properties.functions = 1;
                            ood.each(sta && sta.viewStyles, function (o, i) {
                                if (o) ctrl.properties[i] = 1;
                            });
                            ood.each(sta && sta.designViewConf, function (o, i) {
                                if (o) ctrl.properties[i] = 1;
                            });
                        } else {
                            if (key == 'ood.Module') {
                                ctrl = w.serialize(false);
                                if (ctrl.properties) ctrl.properties = {properties: ctrl.properties};
                            } else {
                                ctrl = w.serialize(false);
                                // special
                                if (ctrl.theme) h.theme = 1;
                                if (ctrl.domId) h.domId = 1;
                            }
                            // always
                            h.key = 1;
                            h.alias = 1;
                        }
                        ood.each(ctrl.properties, function (o, i) {
                            h['properties:' + i] = 1;
                        });
                        ood.each(ctrl.events, function (o, i) {
                            h['event:' + i] = 1;
                        });
                        if (ctrl.CS) h.CS = 1;
                        if (ctrl.CC) h.CC = 1;
                        return h;
                    },
                    makeReg = function () {
                        return new RegExp("\:\\w*" + newValue || "", 'i');
                    },
                    makeReg2 = function () {
                        return new RegExp("(<[^>]*>)+(.*" + (newValue || "") + ".*)(<[^>]*>)+", 'i');
                    };

                this.profileGrid.doFilter(unit != "Show All" || newValue ? function (row, helper, profile) {
                    var self = arguments.callee, rtn, prepare = function () {
                        var w = page.profileGrid.get(0).$widget.get(0);
                        if (w.$xid != self._$widget) {
                            delete self._$reg;
                            delete self._$reg2;
                            delete self._$hash;
                            self._$widget = w.$xid;
                        }
                        if (unit != "Show All") {
                            if (!self._$hash)
                                self._$hash = collectDft(w, w == page.canvas.get(0) ? "canvas" : w['ood.Module'] ? 'ood.Module' : w.key);
                        } else if (newValue) {
                            if (!self._$reg)
                                self._$reg = makeReg(newValue);
                            if (!self._$reg2)
                                self._$reg2 = makeReg2(newValue);
                        }
                    };
                    if (row == 'begin') {
                        prepare();
                    }
                    else if (row == 'end') {
                        if (helper != 'prepareItem') {
                        }
                    }
                    else {
                        if (unit != "Show All") {
                            rtn = row.group || row.sub ? false : !self._$hash[row.id];
                        } else if (newValue) {
                            rtn = row.group || row.sub ? false : (!self._$reg.test(row.id) &&
                                !self._$reg2.test(row.cells ? row.cells[0]._caption : row.caption)
                            );
                        }

                        if (helper != 'prepareItem' && row.id && row.sub && !row._checked) {
                            if (unit != "Show All") {
                                // filter it anyway for performance (no dom render)
                                if (ood.isArr(row.sub)) {
                                    ood.filter(row.sub, function (row) {
                                        return !!self._$hash[row.id];
                                    });
                                }
                            }
                            profile.boxing().toggleRow(row.id, true, false, true);
                        }

                        return rtn;
                    }
                } : _null);

            },
            '$listobject_onlistshow': function (profile, pos) {
                var page = this;
                var showShadow = function (id) {
                        var v = ood.getObject(id), r;
                        if (v && (r = v.getRoot()) && r.get(0)) {
                            var region = r.cssRegion(_true, page.panelDiv.getRoot());
                            if (v.box["ood.svg"]) {
                                var bbox = v.boxing()._getBBox()
                                region.width = bbox.width;
                                region.height = bbox.height;
                            }
                            page.frame.cssRegion(region).css('display', 'block');
                        }
                    },
                    hideShadow = function () {
                        page.frame.css('display', 'none');
                    };
                //            ood.observableRun(function(){
                if (!page.objlistBlock) {
                    page.objlistBlock = new ood.UI.Block({
                        'width': Math.min(300, profile.getRoot().width()),
                        'height': 400,
                        'borderType': 'ridge',
                        // 'background': '#fff',
                        'shadow': _true,
                        'resizer': _true
                    });
                    if (!page.frame || !page.frame.get(0)) {
                        page.frame = ood.create('<div style="z-index:2000;background-color:green;position:absolute;font-size:0;line-height:0;display:none;">').css('opacity', 0.3);
                        page.panelDiv.getRoot().append(page.frame);
                    }

                    page.treebarObj = new ood.UI.TreeBar({
                        'group': _false,
                        'selMode': 'single'
                    }, {
                        'onItemSelected': function (profile, item, src) {
                            page.selectWidget(item.id);
                            profile.parent.getRoot().css('display', 'none');
                            page.frame.css('display', 'none');
                            profile.boxing().clearItems();

                            page._focus();
                            return _false;
                        },
                        onClick: function (profile, item) {
                            if (profile.boxing().getUIValue() == item.id) {
                                profile.parent.getRoot().css('display', 'none');
                                page.frame.css('display', 'none');
                                profile.boxing().clearItems();
                                page._focus();
                            }
                        },
                        'beforeHoverEffect': function (profile, item, e, src, type) {
                            if (!item) return;
                            if (item.id == this.canvas.get(0).$xid) return;
                            var prf = ood.getObject(item.id);
                            if (!prf['ood.UIProfile'] && !prf['ood.Module']) return;
                            if ((prf['ood.UIProfile'] && prf.box.$initRootHidden)) return;

                            if (type == 'mouseover')
                            //for performance in IE
                                ood.resetRun('', showShadow, 100, [item.id]);
                            else
                                ood.resetRun('', hideShadow, 100);
                        }
                    }, page);
                    page.objlistBlock.append(page.treebarObj).render(_true);
                }
                //get items
                var items = [], moduleHash = {};
                var fun = function (profile, items, map) {
                    if ((page.$inplaceEditor && page.$inplaceEditor.get(0)) == profile)
                        return;
                    var type = profile.moduleClass ? "module" : "control",
                        key = type == "module" ? "ood.Module" : profile.box.KEY,
                        z;
                    if (type == "module") {
                        /// get the top module only
                        profile = profile.getModule(_true);
                        if (moduleHash[z = profile.KEY + "[" + profile.$xid + "]"]) return;
                        moduleHash[z] = 1;
                    }
                    var self = arguments.callee,
                        t = map[key],
                        item = {
                            'id': profile.$xid,
                            'type': type,
                            'caption': profile.alias,
                            'image': t && t.image || '',
                            'imagePos': t && t.imagePos || '',
                            'imageClass': t && t.imageClass || ''
                        };
                    items.push(item);
                    if (type == "module") {
                        return;
                    }
                    if (profile.children && profile.children.length) {
                        var sub = [];
                        item.sub = sub;
                        ood.arr.each(profile.children, function (o) {
                            self.call(_null, o[0], sub, map);
                        });
                    }
                };
                fun(page.canvas.get(0), items, CONF.mapWidgets);
                page.treebarObj.setItems(items).toggleNode(page.canvas.get(0).$xid, _true, _true, _true);

                var node = page.objlistBlock.reBoxing();
                node.popToTop(profile.getRoot(), _null, _null, function () {
                    var sel = page.tempSelected && page.tempSelected[0];
                    if (sel) {
                        ood.asyRun(function () {
                            var item = page.treebarObj.getItemByItemId(sel);
                            if (item) {
                                page.treebarObj.focusItem(item.id);
                                page.treebarObj.setUIValue(item.id, _true);
                                showShadow(sel);
                            }
                        });
                    }
                });

                var escSubKey = 'design:pop:objecttree',
                    unFun = function () {
                        //unhook
                        ood.Event.keyboardHook('esc', 0, 0, 0, escSubKey);

                        node.css('display', 'none');
                        page.treebarObj.clearItems();
                        page.frame.css('display', 'none');
                        page._focus();
                        return false;
                    };
                //for on blur disappear
                node.setBlurTrigger(escSubKey, unFun);
                //for esc
                ood.Event.keyboardHook('esc', 0, 0, 0, unFun, escSubKey);

                //            });
            },
            '$unique': function (arr) {
                var i, l, a = ood.copy(arr);
                arr.length = 0;
                for (i = 0, l = a.length; i < l; i++)
                    if (ood.arr.indexOf(arr, a[i]) == -1)
                        arr[arr.length] = a[i];
                return arr;
            },
            //for outter call
            'getWidgets': function (flag, containerPrf) {
                if (!flag)
                    this._clearSelect();

                var page = this,
                    moduleHash = {}, z, t,
                    arr = [], c;
                if (containerPrf) {
                    if (containerPrf['ood.UIProfile']) c = containerPrf.children;
                    else if (containerPrf['ood.Module']) {
                        return containerPrf.getComponents().get();
                    }
                }
                if (!c) {
                    c = page.canvas.get(0).children || page.canvas.get(0).childNodes;
                }

                ood.arr.each(c, function (o) {
                    if ((page.$inplaceEditor && page.$inplaceEditor.get(0)) == o[0])
                        return;
                    if (t = o[0].getModule(_true)) {
                        if (!moduleHash[z = t.KEY + "[" + t.$xid + "]"]) {
                            moduleHash[z] = 1;
                            arr.push(t);
                        }
                    } else {
                        arr.push(o[0]);
                    }
                });

                var items = this.iconlist && this.iconlist.getItems();
                if (items && items.length)
                    ood.arr.each(items, function (o, i) {
                        if (o = ood.getObject(o.id))
                            arr.push(o);
                    });
                return this.$unique(arr);
            },
            '_sortchildren': function (nodes, onlyone) {
                //sort by _dockOrder
                var fun = function (arr, layer) {
                    arr = ood.arr.stableSort(arr, function (x, y) {
                        x = (x[0] || x);
                        y = (y[0] || y);

                        if (layer == 1 && (x.key == 'ood.DataBinder' || x.key == 'ood.APICaller' || x.key == 'ood.AnimBinder')) x = -2;
                        else if (x.key == 'ood.UI.CSSBox') x = 999999998;
                        else if (x.key == 'ood.Timer') x = -4;
                        else x = x.properties._dockOrder || 0;

                        if (layer == 1 && (y.key == 'ood.DataBinder' || y.key == 'ood.APICaller' || x.key == 'ood.AnimBinder')) y = -2;
                        else if (y.key == 'ood.UI.CSSBox') y = 999999998;
                        else if (y.key == 'ood.Timer') y = -4;
                        else y = y.properties._dockOrder || 0;

                        return x > y ? 1 : x == y ? 0 : -1;
                    });
                    if (!onlyone) {
                        layer++;
                        for (var i = 0, c; i < arr.length; i++)
                            if ((c = arr[i][0] || arr[i]) && c.box.KEY != "ood.UI.SVGPaper" && (c = c.children) && c.length)
                                fun(c, layer);
                    }
                };
                fun(nodes, 1);
                return nodes;
            },
            'stringify': function (o, space) {
                var i = typeof o;
                o = ood.stringify(o);
                o = (i == "object" || i == "function") ? ood.Coder.formatText(o, 'js') : o;
                o = o.replace(/\n$/, '');
                if (space) o = o.replace(/\n/g, '\n' + space);
                return o;
            },
            'getJSONCode': function (nodes, format, coreCode) {
                this._sortchildren(nodes);
                var code = ood.stringify(nodes);
                if (format) code = ood.Coder.formatText(code);
                return coreCode ? code : ('ood.create(' + code + ').get();');
            },
            'getJSCode': function (nodes, ignoreMCls, ignoreMid, coreCode) {
                this._sortchildren(nodes);

                var page = this, t, arr = [], moduleHash = {};
                if (!coreCode) {
                    arr.push('// [[Code created by JDSEasy RAD Studio\n');
                    arr.push('var host=this, children=[], properties={}, append=function(child){children.push(child.get(0));};\n');
                    arr.push('ood.merge(properties, this.properties);');
                }
                var fun = function (v, pName, argsStr, arr) {
                    var self = arguments.callee, ui = v.box['ood.UI'], o = v.serialize(_false), name = o.alias, b, t, z,
                        ins = v.boxing();

                    // only once for module
                    if (
                        (v['ood.Module'] && (o = (t = v).serialize(_false))) ||
                        ((v.moduleClass && v.moduleXid) &&
                            (v.moduleClass !== ignoreMCls && v.moduleXid !== ignoreMid) &&
                            ((t = ood.SC.get(v.moduleClass)) && (t = t.getInstance(v.moduleXid)) && t["ood.Module"] && (o = t.serialize(_false)))
                        )
                    ) {
                        if (!moduleHash[z = t.KEY + "[" + t.$xid + "]"]) {

                            moduleHash[z] = 1;
                            if (!coreCode) {
                                arr.push('\n\n');
                                if (pName)
                                    arr.push(pName + '.append(\n    ');
                                else
                                    arr.push('append(\n    ');

                                arr.push('ood.create("' + o.key + '", "ood.Module")');
                                name = o.alias;
                                arr.push('\n    .setHost(host,"' + name + '")');
                            }

                            if (o.properties) {
                                arr.push('\n    .setProperties(' + page.stringify(o.properties, '    ') + ')');
                            }
                            if (o.events) {
                                arr.push('\n    .setEvents(' + page.stringify(o.events, '    ') + ')');
                            }
                            if (!coreCode) {
                                if (pName && argsStr) {
                                    arr[arr.length - 1] += ',\n    ' + argsStr;
                                }
                                arr.push('\n);');
                            }
                        }
                    } else {
                        delete o.id;

                        if (o.properties && o.properties.dropKeys) {
                            if (o.properties.dropKeys == v.box.$DataStruct.dropKeys)
                                delete o.properties.dropKeys;
                        }

                        if (o.theme) {
                            o.theme = ("" + o.theme).replace(/[^a-zA-Z0-9-]/g, '');
                        }

                        if (!o.theme) delete o.theme;
                        if (ood.isEmpty(o.properties)) delete o.properties;
                        if (ood.isEmpty(o.events)) delete o.events;
                        if (ood.isEmpty(o.CS)) delete o.CS;
                        if (ood.isEmpty(o.CC)) delete o.CC;
                        if (ood.isEmpty(o.CB)) delete o.CB;
                        if (ood.isEmpty(o.CF)) delete o.CF;

                        if (!coreCode) {
                            arr.push('\n\n');
                            if (pName)
                                arr.push(pName + '.append(\n    ');
                            else
                                arr.push('append(\n    ');
                            arr.push('ood.create("' + o.key + '")');
                            arr.push('\n    .setHost(host,"' + name + '")');
                        }
                        if (o.theme) {
                            arr.push('\n    .setTheme("' + o.theme + '")');
                        }
                        if (o.domId != o.$domId)
                            arr.push('\n    .setDomId("' + o.domId + '")');
                        if (o.properties) {
                            // always on the top
                            if (typeof ins.setSpaceUnit == 'function' && 'spaceUnit' in o.properties)
                                arr.push('\n    .setSpaceUnit(' + page.stringify(o.properties.spaceUnit, '    ') + ')');

                            ood.each(o.properties, function (o, i) {
                                if (i == 'spaceUnit') return;
                                if (i == 'value') return;
                                t = 'set' + ood.str.initial(i);
                                if (typeof ins[t] == 'function')
                                    arr.push('\n    .' + t + '(' + page.stringify(o, '    ') + ')');
                            });

                            // alwasy at the bottom
                            if (typeof ins.setValue == 'function' && 'value' in o.properties)
                                arr.push('\n    .setValue(' + page.stringify(o.properties.value, '    ') + ')');
                        }

                        if (o.events) {
                            ood.each(o.events, function (o, i) {
                                arr.push('\n    .' + i + '(' + page.stringify(o, '    ') + ')');
                            });
                        }
                        if (o.CS)
                            arr.push('\n    .setCustomStyle(' + page.stringify(o.CS, '    ') + ')');
                        if (o.CC)
                            arr.push('\n    .setCustomClass(' + page.stringify(o.CC, '    ') + ')');
                        if (o.CB)
                            arr.push('\n    .setCustomBehavior(' + page.stringify(o.CB, '    ') + ')');
                        if (o.CF)
                            arr.push('\n    .setCustomFunction(' + page.stringify(o.CF, '    ') + ')');
                        if (!coreCode) {
                            if (pName && argsStr) {
                                arr[arr.length - 1] += ',\n    ' + argsStr;
                            }
                            arr.push('\n);');
                            if (v.children && v.children.length) {
                                ood.arr.each(v.children, function (o) {
                                    var j = o[0], sa = [], s;
                                    for (var i = 1; i < o.length; i++) {
                                        switch (typeof o[i]) {
                                            case 'number':
                                                sa.push(o[i]);
                                                break;
                                            case 'string':
                                                sa.push('"' + o[i] + '"');
                                                break;
                                        }
                                    }
                                    if (sa.length)
                                        s = sa.join(',');
                                    else
                                        s = _null;
                                    self.call(this, j, 'host.' + name, s, arr);
                                }, this);
                            }
                        }
                    }
                };
                ood.arr.each(nodes, function (v) {
                    fun(v, _null, _null, arr);
                });
                if (!coreCode) {
                    arr.push('\n\n');
                    arr.push('return children;\n');
                    arr.push('// ]]Code created by JDSEasy RAD Studio');
                }
                return ood.fromUTF8(arr.join(''));
            },
            'getNames': function () {
                var nodes = this.getWidgets(_true);
                var page = this, t, hash = {};
                var fun = function (target) {
                    var self = arguments.callee;
                    hash[target.alias] = target;
                    if (target['ood.Module']) {
                        // only get the first layer for module
                        target.getUIComponents().each(function (prf) {
                            self.call(_null, prf);
                        });
                    } else {

                        // only get the first layer for module
                        if (!target.moduleClass && target.children && target.children.length) {
                            ood.arr.each(target.children, function (o) {
                                self.call(_null, o[0]);
                            });
                        }
                    }
                };
                ood.arr.each(nodes, function (o) {
                    fun(o);
                });
                return hash;
            },
            'selectWidget': function (ids) {
                if (!ood.isArr(ids)) ids = [ids];
                var profile = ood.getObject(ids[0]);

                if (profile['ood.Module']) {
                    ids = [];
                    profile.getUIComponents().each(function (o, i) {
                        if (i === 0) profile = o;
                        ids.push(o.$xid);
                    });
                }
                var p = profile.parent;
                if (!p) return;

                if (p.setSelectFromPanel) {
                    p.setSelectFromPanel.call(p, profile.getRoot().parent(), ids);
                    this._setSelected(ids, _true);
                } else {
                    this._clearSelect();
                    this._setSelected(_null, _true);
                }
            },
            'activate': function () {
            },
            'setLinkObj': function (obj) {
                this._cls = obj;
            },
            'refreshView': function (obj, onlyCavas, className) {
                var self = this;

                if (!onlyCavas)
                    self._cls = obj;
                if (className)
                    self._className = className;

                var ns = self.getWidgets(_true);
                ood.arr.each(ns, function (o) {
                    // must purge right now
                    o.boxing().destroy(_true, _true);
                });
                if (self.iconlist)
                    self.iconlist.clearItems();
                self.canvas.removeChildren(_true, _true, _true);

                var fun = onlyCavas ? obj : ood.get(obj, ['Instance', 'iniComponents']);

                if (fun) {
                    var arr = [];
                    try {
                        // always to load module
                        (typeof fun == "string" ? fun : ood.fun.body(fun._____string || fun)).replace(/\bood.create\s*\(\s*['"]([\w.]+)['"]\s*[,)]/g, function (a, b) {
                            if (!(a = ood.SC.get(b))) {
                                arr.push(b);
                                a = _null;
                            }
                            // if(a&& a['ood.Module']){
                            //     arr.push(b);
                            // }
                        });
                    } catch (e) {
                    }

                    if (window.loadingAnimationManager && false) {
                        window.loadingAnimationManager.showLoadingAnimation(ood.getRes('RAD.designer.createContent'));
                    } else {
                        ood.Dom.setCover(ood.getRes('RAD.designer.createContent'));
                    }
                    // reset scope
                    fun = new Function([], typeof fun == "string" ? fun : ood.fun.body(fun._____string || fun));

                    var fff = function () {
                        try {
                            self.$host = {$inDesign: 'xxx'};

                            var nodes, n2 = [],
                                spaceUnitBak = ood.get(getSPA(), ["curProjectConfig", "$DevEnv", "SpaceUnit"]);

                            try {
                                // use proejct's spaceUnit
                                if (spaceUnitBak) {
                                    var t = ood.SpaceUnit;
                                    ood.SpaceUnit = spaceUnitBak;
                                    spaceUnitBak = t;
                                }
                                nodes = fun.call(self.$host) || [];
                            } finally {
                                if (spaceUnitBak) {
                                    ood.SpaceUnit = spaceUnitBak;
                                    spaceUnitBak = null;
                                }
                            }

                            ood.arr.each(nodes, function (o) {
                                o = ood.isArr(o) ? o[0] : o;
                                //before render
                                self._designable(o);
                            });


                            ood.each(nodes, function (db) {
                                if (db && db.Class) {
                                    if (db.key == 'ood.APICaller') {
                                        // if (db.boxing().getAutoRun() && ood.str.endWith(db.properties.queryURL, '.dyn')) {
                                        //     db.boxing().invoke();
                                        // }
                                    } else if (db.boxing && db.boxing().checkValid) {
                                        db.boxing().checkValid(true);
                                    }
                                }
                            });

                            ood.filter(nodes, function (target) {
                                if (target['ood.Module'] ? target.getUIComponents().isEmpty() : target.box['ood.UI'] ? target.box.$initRootHidden : _true) {
                                    n2.push(target);
                                    return !!target.box['ood.UI'] || !!target.box['ood.Module'];
                                }
                            });

                            ood.arr.each(nodes, function (n) {
                                self.canvas.append(n);
                            });

                            ood.arr.each(n2, function (target) {
                                var key = target['ood.Module'] ? 'ood.Module' : target.box.KEY;
                                self.iconlist.insertItems([{
                                    'id':
                                    target.$xid,
                                    'imgWidth': '16',
                                    'imgHeight': '16',
                                    'tips': self._bldTips(target, self.$moduleInnerMode ? "" : CONF.enable_codeEdtor ? ("$(RAD.designer.Dblclick to edit the code)") : ""),
                                    'imgStyle': CONF.mapWidgets[key] && CONF.mapWidgets[key].image ? ('background:url(' + CONF.mapWidgets[key].image + ') ' + CONF.mapWidgets[key].imagePos) : "",
                                    'imageClass': CONF.mapWidgets[key] && CONF.mapWidgets[key].imageClass

                                }], _null, _false);
                            });

                            var t = self.layoutBase.reBoxing();
                            if (t.css('display') == 'none') {
                                t.css('display', 'block');
                                t.parent().css('background', '');
                            }

                            ood.asyRun(function () {
                                ood.UI.pack(nodes, _false).adjustDock();
                            });
                        } catch (e) {
                            self.iconlist.clearItems();
                            self.canvas.reBoxing().empty();
                            self.layoutBase.reBoxing().css('display', 'none')
                                .parent().css('background', 'url(' + ood.getPath('img/', 'error.gif') + ')');
                            ood.message(ood.getRes('RAD.designer.comCodeErr'));
                            ood.pop(e.stack || e.description || e.message || e.toString());
                            if (window.console) console.log(e);
                            ood.asyRun(function () {
                                if (self.toCodeView) self.toCodeView();
                            });
                        }
                        if (window.loadingAnimationManager && false) {
                            window.loadingAnimationManager.hideLoadingAnimation();
                        } else {
                            ood.Dom.setCover(_false);
                        }
                    };
                    if (arr.length) {
                        //load required class first
                        ood.require(arr, fff, _null, function (msg) {
                            ood.alert(msg);
                        }, function (msg) {
                            ood.alert(msg);
                        }, _true, _null, {'appPath': CONF.adjustProtocol(getSPA().curProjectPath)});
                    } else {
                        fff();
                    }
                    // self.profileGrid.reLayout();
                }

                self.clearDirty();
                self._clearSelect();
                self._setSelected([], _true);

                ood.resetRun('$profilegrid$', self._refreshProfileGrid, 0, [0, 0, _true], self);
                return fun;
            },
            'refreshViewSize': function (obj, enableUndo) {
                var page = this,
                    canvas = page.canvas,
                    panelBG = page.panelBG.getRoot(),
                    theme,
                    viewSize;
                if (CONF.getClientMode() != 'project') {
                    ood.arr.each(["background-color", "background-image", "background-repeat", "background-position", "background-attachment"], function (k, v) {
                        v = ood.get(obj, ['Static', 'viewStyles', k]);
                        panelBG.css(k, v ? ood.adjustRes(v) : "");
                    });
                    theme = ood.get(obj, ['Static', 'viewStyles', 'theme']) || 'default';
                    page.panelDiv.setSandboxTheme(theme, _true, '[class~="ood-designer-inner-control"]');
                    page.panelDiv.getChildren(true, "penetrate").reLayout(true);
                    page._desingviewdirty = _false;
                    page._styledirty = _false;
                    viewSize = ood.get(obj, ['Static', 'designViewConf']) || ood.get(obj, ['Static', 'viewSize']) || page.$viewSize['classic.sxga'];
                } else {
                    viewSize = ood.get(getSPA(), ["curProjectConfig", "$DevEnv", "designViewConf"]) || page.$viewSize['classic.sxga'];
                }
                if (!viewSize.height || !viewSize.width) {
                    viewSize = page.$viewSize['classic.sxga'];

                }
                page.setViewSize(viewSize, enableUndo);
                page.setMobileFrame(!!viewSize.touchDevice);
                page._desingviewdirty = _false;
                return page.stringify(viewSize);
            },
            '_popdata_onmenusel': function (p, item) {
                this._toolbaraction(item, {'id': 'codegroup'});
            },
            '_popalign_onmenusel': function (p, item) {
                this._toolbaraction(item, {'id': 'aligngroup'});
            },
            '_popvs_onmenusel': function (p, item) {
                var page = this;
                page.setViewSize(page.$viewSize[item.id]);
            },
            'setMobileFrame': function (value, fromUI, enableUndo) {
                var page = this;
                page.$touchdivce = value;
                if (CONF.getClientMode() != 'project') {
                    page.panelDivInner.setCustomClass({'KEY': value ? "phonestyle ood-cursor-touch" : ""});
                    if (!fromUI) {
                        page.toolbar.updateItem('mobile', {'value': !!value});
                    } else {
                        if (enableUndo !== _false) {
                            // undo-redo : show/hide mobile frame by toolbar
                            page.markDirty(function () {
                                page.setMobileFrame(!value, _false, _false);
                            }, function () {
                                page.setMobileFrame(value, _false, _false);
                            }, (value ? "hide" : "show") + " mobile frame");
                        }
                    }
                } else {
                    var rt = page.panelDivInner.getRoot();
                    page.panelDivInner.setCustomClass({'KEY': value ? "phonestyle ood-cursor-touch" : ""});
                    page._desingviewdirty = true;
                    if (value) {
                        if (ood.get(page._cls, ['Static', 'designViewConf'])) {
                            ood.get(page._cls, ['Static', 'designViewConf']).touchDevice = true;
                        }

                        rt.addClass("phonestyle ood-cursor-touch");

                    } else {
                        if (ood.get(page._cls, ['Static', 'designViewConf'])) {
                            ood.get(page._cls, ['Static', 'designViewConf']).touchDevice = false;
                        }
                        rt.removeClass("phonestyle ood-cursor-touch");
                    }

                }
            },

            'setViewSize': function (size, enableUndo) {
                var page = this,
                    w = page.canvas.getWidth(),
                    h = page.canvas.getHeight(),
                    ow = w,
                    oh = h,
                    b;
                if ('width' in size) {
                    size.width = parseInt(size.width, 10);
                    if (!ood.isNumb(size.width) || size.width <= 0)
                        size.width = page.$viewSize['classic.sxga'].width;
                }
                if ('height' in size) {
                    size.height = parseInt(size.height, 10);
                    if (!ood.isNumb(size.height) || size.height <= 0)
                        size.height = page.$viewSize['classic.sxga'].height;
                }

                if (size.width && String(size.width) != String(w)) {
                    page.panelBG.setWidth(size.width);
                    page.canvas.setWidth(size.width);
                    b = 1;
                }
                if (size.height && String(size.height) != String(h)) {
                    page.panelBG.setHeight(size.height);
                    page.canvas.setHeight(size.height);
                    b = 1;
                }
                if (b) {
                    w = parseInt(size.width || w, 10);
                    h = parseInt(size.height || h, 10);

                    //update properties treegrid value
                    var t = page.profileGrid;
                    if (t && (t = t.get(0).$widget) && (t.get(0) == page.canvas.get(0))) {
                        page.profileGrid.updateCellByRowCol('properties:width', 'value', {'value': w});
                        page.profileGrid.updateCellByRowCol('properties:height', 'value', {'value': h});
                    }
                    page.$curViewSize = {'width': w, 'height': h};

                    if (CONF.getClientMode() != 'project' || true) {
                        //update toolbar caption
                        page.toolbar.updateItem('viewsize', {'caption': w + " &#215 " + h});
                        page._desingviewdirty = _true;

                        if (enableUndo !== _false) {
                            // undo-redo : modify page sizeview by toolbar popmenu or canvas width/height in propgrid
                            page.markDirty(function () {
                                page.setViewSize({
                                    'width': ow,
                                    'height': oh
                                }, _false);
                            }, function () {
                                page.setViewSize({
                                    'width': w,
                                    'height': h
                                }, _false);
                            }, "set canvas view size to [" + w + "," + h + "]");
                        }
                    }
                }
            },
            'reLayout': function (force) {
                this.toolbar.reLayout(force);
            },
            'iniComponents': function () {
                // [[Code created by JDSEasy RAD Studio
                var host = this, children = [], append = function (child) {
                    children.push(child.get(0));
                };

                append((new ood.UI.Layout())
                    .setHost(host, "layoutBase")
                    .setItems([{
                        "id": "before",
                        "pos": "before",
                        "size": 170,
                        "min": 100,
                        "max": 300,
                        "locked": _false,
                        "folded": _false,
                        "hidden": _true,
                        "cmd": _true,
                        "itemDisplay": "display:none;"
                    }, {"id": "main", "min": 10}, {
                        "id": "after",
                        "pos": "after",
                        "size": 280,
                        "min": 100,
                        "max": 500,
                        "locked": _false,
                        "folded": _false,
                        "hidden": _false,
                        "cmd": _true
                    }])
                    .setType("horizontal")
                );

                host.layoutBase.append((new ood.UI.ToolBar())
                        .setHost(host, "toolbar")
                        .setAutoIconColor(false)
                        .onClick("$toolbar_onclick")
                    , "main");

                host.layoutBase.append((new ood.UI.Panel())
                        .setHost(host, "panelRight")
                        .setCaption("$(RAD.designer.configwnd)")
                        .setImageClass("ri ri-settings-3-line")
                        .setCustomStyle({"PANEL": "overflow:hidden"})
                    , "after");

                host.panelRight.append((new ood.UI.ComboInput())
                    .setHost(host, "listObject")
                    .setDirtyMark(_false)
                    .setDock("top")
                    .setType("popbox")
                    .setInputReadonly(_true)
                    .beforeComboPop("$listobject_onlistshow")
                );

                host.panelRight.append((new ood.UI.Block())
                    .setHost(host, "prblock2")
                    .setDock('top')
                    .setHeight('2.66667em')
                    .setOverflow('hidden')
                );

                host.prblock2.append((new ood.UI.ComboInput())
                    .setHost(host, "propFilter")
                    .setHeight('2em')
                    .setDirtyMark(_false)
                    .setDock("top")
                    .setDockMargin({'left': 4, 'top': 4, "right": 4, "bottom": 4})
                    .setType("input")
                    .setCommandBtn('delete')
                    .setTips('$(RAD.designer.tool.Filter) ')
                    .setDynCheck(_true)
                    .setUnits("Show All;Modified Only")
                    .setUnit("Show All")
                    .setImageClass('ri ri-filter-line')
                    .onChange("_propFilter_onchange")
                    .onCommand("_propFilter_oncmd")
                    .afterUnitUpdated("_propFilter_unit")
                );

                host.panelRight.append((new ood.UI.TreeGrid())
                    .setHost(host, "profileGrid")
                    .setDirtyMark(_false)
                    .setEditable(_true)
                    .setRowHandler(_false)
                    .setRowNumbered(_false)
                    .setColSortable(_false)
                    .setActiveMode('cell')
                    .setHeader([
                        {"id": "key", "caption": "$RAD.designer.gridcol1", 'width': 120, 'type': "label"},
                        {
                            "id": "value",
                            "caption": "$RAD.designer.gridcol2",
                            "width": 100,
                            "type": "input",
                            'flexSize': _true,
                            cellStyle: "text-indent:2px;"
                        }
                    ])
                    .setTreeMode("infirstcell")
                    .onShowTips("$tg_tips")
                    .onGetContent("$profilegrid_onrequestdata")
                    .beforeCellUpdated("$profilegrid_beforecellvalueset")
                    .onEditorClick("$profilegrid_eclick")
                    .beforeComboPop('$prfilegrid_beforepop')
                    .onCommand("$profilegrid_cmd")
                    .onDblclickRow("$tg_dblclick")
                );

                host.layoutBase.append((new ood.UI.Div())
                        .setHost(host, "panelDiv")
                        .setDock("fill")
                        .setSpaceUnit('px')
                        .setCustomStyle({"KEY": "overflow:auto;"})
                        .setCustomClass({"KEY": "ood-designer-root"})
                    , "main");

                host.panelDiv.append((new ood.UI.Div())
                    .setHost(host, "panelDivInner")
                    .setLeft(10)
                    .setTop(10)
                    .setWidth("auto")
                    .setHeight("auto")
                    .setZIndex(10)
                    .setSpaceUnit('px')
                    .setOverflow("hidden")
                    .setCustomClass({"KEY": "ood-designer-frame ood-uibase ood-designer-inner-control"})
                );

                host.panelDivInner.append((new ood.UI.Div())
                    .setHost(host, "panelBG")
                    .setLeft(0)
                    .setTop(0)
                    .setWidth(100)
                    .setHeight(100)
                    .setZIndex(10)
                    .setSpaceUnit('px')
                    .setPosition("relative")
                    .setCustomClass({"KEY": "ood-designer-canvas ood-designer-inner-control"})
                );

                host.panelBG.append((new ood.UI.Div())
                    .setHost(host, "panelBGl")
                    .setWidth(100)
                    .setHeight(100)
                    .setCustomStyle({"KEY": "font-size:0;line-height:0;position:absolute;left:0;top:0;width:10px;height:100%;background:url(" + ood.getPath('/RAD/img/', "designer/left.gif") + ") left top"})
                    .setCustomClass({"KEY": "ood-designer-inner-control"})
                );

                host.panelBG.append((new ood.UI.Div())
                    .setHost(host, "panelBGb")
                    .setWidth(100)
                    .setHeight(100)
                    .setCustomStyle({"KEY": "font-size:0;line-height:0;position:absolute;left:0;bottom:0;height:10px;width:100%;background:url(" + ood.getPath('/RAD/img/', "designer/top.gif") + ") left bottom"})
                    .setCustomClass({"KEY": "ood-designer-inner-control"})
                );

                host.panelBG.append((new ood.UI.Div())
                    .setHost(host, "panelBGt")
                    .setWidth(100)
                    .setHeight(100)
                    .setCustomStyle({"KEY": "font-size:0;line-height:0;position:absolute;left:0;top:0;height:10px;width:100%;background:url(" + ood.getPath('/RAD/img/', "designer/top.gif") + ") left top"})
                    .setCustomClass({"KEY": "ood-designer-inner-control"})
                );

                host.panelBG.append((new ood.UI.Div())
                    .setHost(host, "panelBGr")
                    .setWidth(100)
                    .setHeight(100)
                    .setCustomStyle({"KEY": "font-size:0;line-height:0;position:absolute;right:0;top:0;width:10px;height:100%;background:url(" + ood.getPath('/RAD/img/', "designer/left.gif") + ") top right"})
                    .setCustomClass({"KEY": "ood-designer-inner-control"})
                );

                append((new ood.UI.PopMenu())
                    .setHost(host, "popViewSize")
                    .onMenuSelected("_popvs_onmenusel")
                );
                append((new ood.UI.PopMenu())
                    .setHost(host, "popAlign")
                    .onMenuSelected("_popalign_onmenusel")
                );
                append((new ood.UI.PopMenu())
                    .setHost(host, "popData")
                    .onMenuSelected("_popdata_onmenusel")
                );
                return children;
                // ]]Code created by JDSEasy RAD Studio
            },
            'iniExComs': function (com, threadid) {
                var host = this;

                if (CONF.grid_showPropBinder) {
                    host.layoutBase.updateItem('after', {"size": 400});
                }
                host.layoutBase.append(
                    (new ood.UI.Gallery)
                        .setHost(host, "iconlist")
                        .setIconOnly(_true)
                        .setDirtyMark(_false)
                        .setDock("bottom")
                        .setHeight(40)
                        .setZIndex(10)
                        .setDisplay('none')
                        .afterUIValueSet("$iconlist_aftervalueupdated")
                        .setCustomStyle({"KEY": "border-'top':solid 1px #CDCDCD;"})
                        .onContextmenu("_onIconlistMenu")
                        .onDblclick("_onIcondbl")
                    , 'main');
                host.iconlist.setDisplay('');
            }
        },
        'Static': {
            'destroy': function () {
                this.clearDirty();
                this._clearSelect();
                this._setSelected([], _true);
                this.objlistBlock.destroy(_true, _true);
                this._resetHistory();
                if (this.treebarObj) {
                    this.treebarObj.destroy();
                }
                arguments.callee.upper.apply(this, arguments);
            }
        },
        'Initialize': function () {
            //ensure to show ondrag.gif immi
            var preLoad = new _Image();
            preLoad.src = ood.ini.img_dd;
            preLoad = _null;

            //avoid dynRender in designer
            var recover = function (obj) {
                var me = arguments.callee;
                ood.arr.each(obj.$children, function (o) {
                    var o = ood.SC.get(o);
                    if (o.$children)
                        me(o);
                });
            };

            recover(ood.UI);

            if (CONF.getClientMode() == 'project') {
                var keepprj = function (ext) {
                    var spa = getSPA();
                    if (spa && spa.curProjectPath) {
                        // save status first
                        var hash = CONF.getStatus(),
                            prjs = hash.projects || (hash.projects = []),
                            index = ood.arr.subIndexOf(prjs, 'id', spa.curProjectPath);
                        if (index != -1) ood.arr.removeFrom(prjs, index);
                        var files = [], currFile = {};

                        ood.each(spa.tabsMain.getItems('all'), function (item) {
                            files.push(
                                {
                                    id: item.id,
                                    imageClass:config.imageClass,
                                    caption: item.caption,
                                    className: item.className
                                }
                            )
                        })
                        var config = getSPA().tabsMain.getSelectedItem();
                        if (config) {
                            currFile = {
                                id: config.id,
                                imageClass:config.imageClass,
                                caption: config.caption,
                                className: config.className
                            }
                        }



                        if (spa.tabsMain) {
                            prjs.push({
                                'caption': spa.curProjectName,
                                'id': spa.curProjectPath,
                                "file": currFile,
                                "files": files
                            });
                            if (prjs.length >= 10) prjs.shift();
                        }
                        if (ext) ood.merge(hash, ext, 'all');
                        CONF.saveStatus(hash);
                    }
                };

                window.onbeforeunload = function (e) {
                    keepprj({
                        "theme": ood.getTheme(),
                        "lang": ood.getLang()
                    });

                    if (ood.browser.ie)
                        window.event.returnValue = ' ';
                    else
                        return ' ';
                };

                ood.doc.onContextmenu(function () {
                    return _false
                });

            }
        }
    });
}(window);

ood.Class('RAD.ClassTree', 'ood.Module', {

    Instance: {
        initialize: function () {
            this.autoDestroy = false;
            this.properties = {};
        },
        iniComponents: function () {
            // [[Code created by EUSUI RAD Studio
            var host = this, children = [], append = function (child) {
                children.push(child.get(0));
            };

            append(
                (new ood.UI.Panel())
                    .setHost(host, "clsdlg")
                    .setLeft(0)
                    .setTop(0)
                    .setCaption("$RAD.toolbox.clsdlg")
                    .setDock('fill')
                    .setImageClass("ri-magic-line")
                    .setCustomStyle({
                        "PANEL": "overflow:hidden"
                    })
            );

            host.clsdlg.append(
                (new ood.UI.ComboInput())
                    .setHost(host, "pattern")
                    .setName("pattern")
                    .setDock("top")
                    .setLeft("3.6666666666666665em")
                    .setTop("2em")
                    .setWidth("15em")
                    .setLabelSize("3em")
                    .setLabelCaption("$RAD.toolbox.search")
                    .setType("helpinput")
                    .onChange("_reload")
            );


            host.clsdlg.append(
                (new ood.UI.TreeBar())
                    .setHost(host, "treebarCom")
                    .setSelMode("none")
                    .setDragKey("___iDesign")
                    .onGetContent("_treebarcom_ongetcontent")
                    .setCustomStyle({
                        "KEY": {
                            "background-color": "#FFFFFF"
                        }
                    })
            );

            return children;
            // ]]Code created by EUSUI RAD Studio
        },
        events: {"onRender": "_com_onrender"},
        clearContent: function () {
            this.treebarCom.clearItems();
        },
        topNodes:   [
            {
                id: 'jds.localModule',
                key: 'jds.localModule',
                caption: '$RAD.toolbox.localModule',
                group: true,
                initFold: false,
                path: "Module",
                imageClass: 'ri-3d-box-line',
                "dynDestory": true,
                sub: true
            },

            {
                id: 'package',
                key: 'jds.package',
                caption: '$RAD.toolbox.packageTree',
                group: true,
                initFold: true,
                imageClass: 'ri-3d-box-line',
                sub: true
            },
            {
                id: 'jds.extcomproject',
                key: 'jds.extcomproject',
                caption: '$RAD.toolbox.extcomproject',
                group: true,
                imageClass: 'ri-settings-3-line',
                sub: true
            },

            {
                id: 'project',
                key: 'jds.project',
                caption: '$RAD.toolbox.projectcom',
                group: true,
                initFold: true,
                imageClass: 'ri-cloud-line',
                sub: true
            },
            {
                id: 'database',
                key: 'jds.database',
                caption: '$RAD.toolbox.dbcom',
                group: true,

                imageClass: 'ri-database-2-line',
                sub: true
            }

        ],
        _dlgpos: {},
        _dlgsize: {},
        _ctl_beforepop: function (profile, options) {
            var ns = this;
            ns.fireEvent('afterPop');
            options.properties = {
                fill: 'none',
                minBtn: true,
                maxBtn: false,
                landBtn: false,
                pinBtn: true
            };
            options.events = {
                beforePin: function (dlgprf) {
                    ns._dlgpos.left = dlgprf.properties.left;
                    ns._dlgpos.top = dlgprf.properties.top;
                    ns._dlgsize.width = dlgprf.properties.width;
                    ns._dlgsize.height = dlgprf.properties.height;

                    ns.fireEvent('afterLand', [ns]);
                    dlgprf.boxing().removeChildren().destroy();
                }
            };
            options.init = function (dialog, profile, options) {
                if (ns._dlgpos.left) dialog.setLeft(ns._dlgpos.left);
                if (ns._dlgpos.top) dialog.setTop(ns._dlgpos.top);
                if (ns._dlgsize.width) dialog.setWidth(ns._dlgsize.width);
                if (ns._dlgsize.height) dialog.setHeight(ns._dlgsize.height);

                dialog.setInitPos("auto");
                dialog.show(options.parent || ood('body'));
                var arr = [];
                ood.arr.each(profile.children, function (o) {
                    arr.push(o[0]);
                });
                if (arr.length) {
                    dialog.append(ood.UI.pack(arr, false));
                }
                return false;
            }
        },

        buildItems : function (items) {
            var nitems = [];
            ood.each(items, function (item) {
                if (item.key && CONF.mapWidgets[item.key]) {
                    var p = CONF.mapWidgets[item.key];
                    item.imageClass = CONF.mapWidgets[item.key].imageClass;
                    if (!ood.str.startWith(item.id, item.className)) {
                        ood.id = item.className + '.' + item.id
                    }
                }
                item.children = item.sub;
                item.properties = item.iniProp;

                if (item.sub) {
                    item.sub = buildItems(item.sub);

                }

            })
            return items;
        },

        fillContent: function (com, threadid) {
            var clss = [], ns = this;
            var items=this.topNodes;
            ns.treebarCom.setItems(this.buildItems(items))
                .setCustomBehavior({
                    BAR: {
                        beforeMousedown: function (profile, e, src) {
                            if (ood.Event.getBtn(e) != "left") return;
                            if (profile.properties.disabled) return;
                            // not resizable or drag
                            if (!profile.properties.dragKey) return;

                            // avoid nodraggable keys
                            if (profile.behavior.NoDraggableKeys) {
                                var sk = profile.getKey(ood.Event.getSrc(e).id || "").split('-')[1];
                                if (sk && ood.arr.indexOf(profile.behavior.NoDraggableKeys, sk) != -1) return;
                            }
                            var id = ood.use(src).id(),
                                itemId = profile.getSubId(id),
                                properties = profile.properties,
                                item = profile.getItemByDom(id),
                                pos = ood.Event.getPos(e);

                            if (item.draggable) {
                                var componenttype = item.className ? item.className : item.key;
                                profile.getSubNode('ITEMICON', itemId).startDrag(e, {
                                    dragType: 'icon',
                                    shadowFrom: src,
                                    dragCursor: 'pointer',
                                    targetLeft: pos.left + 12,
                                    targetTop: pos.top + 12,
                                    sub: true,
                                    dragKey: item.dragKey || profile.properties.dragKey,
                                    dragData: {
                                        cls: item.cls || item.key,
                                        type: componenttype,
                                        caption: item.caption,
                                        iniProp: item.iniProp,
                                        children: item.sub,
                                        iniEvents: item.iniEvents,
                                        customRegion: item.customRegion,
                                        image: item.image,
                                        imagePos: item.imagePos,
                                        imageClass: item.imageClass
                                    }
                                });
                                ood.use(src).tagClass('-hover', false);
                                ood.use(src).tagClass('-active', false);

                                if (RAD.Designer) {
                                    ood.each(RAD.Designer.getAllInstance(), function (page) {
                                        if (page && !page.destroyed) {
                                            page._clearSelect();
                                            if (page.resizer)
                                                page._setSelected([], true);
                                        }
                                    });
                                }
                                return false;
                            }
                        }
                    }
                })
                .toggleNode('ood.UI.absForm', true)
                .beforePrepareItem(function (profile, item, pid) {
                    if (item.key && CONF.mapWidgets[item.key]) {
                        var p = CONF.mapWidgets[item.key];
                        item.imageClass = CONF.mapWidgets[item.key].imageClass;
                    }
                });


        },
        customAppend: function (parent, subId, left, top) {
            return true;
        },
        show2: function () {
            this.clsdlg.show();
        },
        hide: function () {
            this.clsdlg.hide();
        },

        _reload: function (profile, item) {
            ns = this;
            ns.treebarCom.setItems(this.buildItems(this.topNodes));
            ns.treebarCom.fireItemClickEvent('package');

        },
        _treebarcom_ongetcontent: function (profile, item, callback) {
            var ns = this;
            switch (item.key) {
                case "jds.extcomproject":
                    ood.Ajax(CONF.GetExtComProjectTreeService, null, function (txt) {
                        var obj = txt;
                        if (!obj || obj.error) {
                            ood.message("No module in this project!");
                            callback(false);
                        } else {
                            var items = [];
                            ood.arr.each(obj.data, function (o, i) {
                                if (o.projectName != SPA.curProjectName) {
                                    items.push({
                                        id: o.id,
                                        cls: o.cls,
                                        key: "jds.package",
                                        packName: o.location,
                                        draggable: false,
                                        sub: true,
                                        initFold: false,
                                        imageClass: o.imageClass|'ri-3d-box-line',
                                        name: o.caption,
                                        caption: o.caption,
                                        projectName: o.projectName,
                                        iniProp: o.iniProp,
                                        caption: o.caption
                                    });
                                }
                            });
                            callback(items);

                        }
                    }, function (txt) {
                        callback(false);
                    }).start();
                    break;


                case "jds.project":
                    ood.Ajax(CONF.GetAllProjectTreeService, null, function (txt) {
                        var obj = txt;
                        if (!obj || obj.error) {
                            ood.message("No module in this project!");
                            callback(false);
                        } else {
                            var items = [];
                            ood.arr.each(obj.data, function (o, i) {
                                if (o.projectName != SPA.curProjectName) {
                                    items.push({
                                        id: o.id,
                                        cls: o.cls,
                                        key: "jds.package",
                                        packName: o.location,
                                        draggable: false,
                                        sub: true,
                                       // initFold: false,
                                        imageClass:  o.imageClass|'ri-3d-box-line',
                                        name: o.caption,
                                        projectName: o.projectName,
                                        iniProp: o.iniProp,
                                        caption: o.caption
                                    });
                                }
                            });
                            callback(items);

                        }
                    }, function (txt) {
                        callback(false);
                    }).start();
                    break;


                case "jds.localModule":
                    ood.Ajax(CONF.getAllComponentsByPath, {
                        path: item.path,
                        pattern: ns.pattern.getUIValue(),
                        projectName: item.projectName ? item.projectName : SPA.curProjectName
                    }, function (txt) {
                        var obj = txt;
                        if (!obj || obj.error) {
                            ood.message("No module in this project!");
                            callback(false);
                        } else {

                            var items = [];
                            ood.arr.each(obj.data, function (o, i) {
                                var item = ood.clone(o);
                                if (o.alias) {
                                    item.caption = o.alias;
                                }
                              //  item.initFold = false;
                                items.push(item);

                            });

                            callback(items);

                        }
                    }, function (txt) {
                        callback(false);
                    }).start();
                    break;

                case "jds.package":
                    ood.Ajax(CONF.GetAllPackages, {
                        pattern: ns.pattern.getUIValue(),
                        projectName: item.projectName ? item.projectName : SPA.curProjectName
                    }, function (txt) {
                        var obj = txt;
                        if (!obj || obj.error) {
                            ood.message("No module in this project!");
                            callback(false);
                        } else {
                            var items = [];
                            ood.arr.each(obj.data, function (o, i) {
                                items.push({
                                    id: o.projectName + '.' + o.id,
                                    cls: o.cls,
                                    key: "jds.localModule",
                                    path: o.location,
                                    draggable: false,
                                  //  initFold: false,
                                    sub: true,
                                    projectName: o.projectName,
                                    imageClass: 'ri-grid-line',
                                    name: o.caption,
                                    iniProp: o.iniProp,
                                    caption: o.caption
                                });

                            });
                            callback(items);
                        }
                    }, function (txt) {
                        callback(false);
                    }).start();
                    break;
                case "jds.database":
                    ood.Ajax(CONF.getTableTreesService, {
                        text: "FDT",
                        url: item.url ? item.url : 'console'
                    }, function (txt) {

                        var obj = txt;
                        if (!obj || obj.error) {
                            ood.message("No module in this project!");
                            callback(false);
                        } else {
                            var items = [];
                            ood.arr.each(obj.data, function (o, i) {
                                ood.arr.each(o.sub, function (table, i) {
                                    table.key = "db.table";
                                    table.sub = true;
                                    table.initFold = true;
                                    table.draggable = false;
                                });

                                items.push({
                                    id: o.id,
                                    cls: o.cls,
                                    url: o.url,
                                    initFold: false,
                                    draggable: false,
                                    sub: o.sub,
                                    imageClass: o.imageClass,
                                    name: o.caption,
                                    iniProp: o.iniProp,
                                    caption: o.caption
                                });

                            });
                            callback(items);
                        }
                    }, function (txt) {
                        callback(false);
                    }).start();
                    break;
                case "db.table":
                    ood.Ajax(CONF.GetTableComponentsService, {
                        url: item.url ? item.url : 'console',
                        tableName: item.id,
                        configKey: item.configKey
                    }, function (txt) {
                        var obj = txt;
                        if (!obj || obj.error) {
                            ood.message("No module in this project!");
                            callback(false);
                        } else {

                            var items = [];
                            ood.arr.each(obj.data, function (o, i) {
                                items.push({
                                    id: o.id,
                                    cls: o.cls,
                                    key: o.key,
                                    url: o.url,
                                    draggable: false,
                                    sub: true,

                                    imageClass: o.imageClass,
                                    name: o.caption,
                                    iniProp: o.iniProp,
                                    caption: o.caption
                                });

                            });


                            callback(obj.data);
                        }
                    }, function (txt) {
                        callback(false);
                    }).start();
                    break;
            }

        }
    }
});
ood.Class('RAD.ServiceTree', 'ood.Module', {
    Instance: {
        initialize: function () {
            this.autoDestroy = false;
            this.properties = {};
        },
        iniComponents: function () {
            // [[Code created by  RAD Studio
            var host = this, children = [], append = function (child) {
                children.push(child.get(0));
            };

            append(
                (new ood.UI.Block())
                    .setHost(host, "servicedlg")
                    .setDock("fill")
                    .setBorderType("ridge")
                    .setCustomStyle({
                        "PANEL": "overflow:hidden"
                    })
            );

            host.servicedlg.append(
                (new ood.UI.ToolBar())
                    .setHost(host, "servicetool")
                    .setHandler(false)
                    .onClick("_toolbar_onclick")
                    .setCustomStyle({
                        "ITEMS": "border-width:0 0 1px 0;"
                    })
            );

            var items = [{
                id: 'any', sub: [
                    {id: 'refresh', imageClass: 'ri-refresh-line', caption: '', tips: '$RAD.tool2.refresh'},
                    {id: 'import', imageClass: 'ri-add-line', caption: '', tips: '$RAD.toolbox.importapi'}
                ]
            }];

            host.servicetool.setItems(items);
            host.servicedlg.append(
                (new ood.UI.ComboInput())
                    .setHost(host, "pattern")
                    .setName("pattern")
                    .setDock("top")
                    .setLeft("3.6666666666666665em")
                    .setTop("2em")
                    .setWidth("15em")
                    .setLabelSize("3em")
                    .setLabelCaption("$RAD.toolbox.search")
                    .setType("helpinput")
                    .onChange("_reload")
            );


            host.servicedlg.append(
                (new ood.UI.TreeBar())
                    .setHost(host, "treebarCom")
                    .setSelMode("none")
                    .setDragKey("___iDesign")
                    .onGetContent("_treebarcom_ongetcontent")
                    .setCustomStyle({
                        "KEY": {
                            "background-color": "#FFFFFF"
                        }
                    })
            );

            return children;
            // ]]Code created by EUSUI RAD Studio
        },
        //  events: {"onRender": "_com_onrender"},
        clearContent: function () {
            this.treebarCom.clearItems();
        },

        topNodes: [

            {
                id: 'pageService',
                key: 'jds.getPageServiceToolBoxService',
                caption: '$RAD.toolbox.pageService',
                group: true,
                initFold: false,
                imageClass: 'ri-tools-line',
                sub: true
            },
            {
                id: 'projectService',
                key: 'jds.getProjectServiceToolBoxService',
                caption: '$RAD.toolbox.projectService',
                group: true,
                initFold: false,
                imageClass: 'ri-3d-box-line',
                sub: true
            },
            {
                id: 'localService',
                key: 'jds.localService',
                caption: '$RAD.toolbox.cls',
                group: true,
                initFold: true,
                imageClass: 'ri-settings-3-line',
                sub: true
            }

        ],
        _buildItems: function (items) {
            var nitems = [], ns = this;
            ood.each(items, function (item) {
                if (item.key && CONF.mapWidgets[item.key]) {
                    var p = CONF.mapWidgets[item.key];
                    item.imageClass = CONF.mapWidgets[item.key].imageClass;
                }
                item.children = item.sub;
                item.properties = item.iniProp;
                if (item.sub) {
                    item.sub = ns._buildItems(item.sub);
                }
            })
            return items;
        },

        fillContent: function (com, threadid) {
            var clss = [], ns = this;
            ns.treebarCom.setItems(ns._buildItems(this.topNodes))
                .setCustomBehavior({
                    BAR: {
                        beforeMousedown: function (profile, e, src) {
                            if (ood.Event.getBtn(e) != "left") return;
                            if (profile.properties.disabled) return;
                            // not resizable or drag
                            if (!profile.properties.dragKey) return;

                            // avoid nodraggable keys
                            if (profile.behavior.NoDraggableKeys) {
                                var sk = profile.getKey(ood.Event.getSrc(e).id || "").split('-')[1];
                                if (sk && ood.arr.indexOf(profile.behavior.NoDraggableKeys, sk) != -1) return;
                            }
                            var id = ood.use(src).id(),
                                itemId = profile.getSubId(id),
                                properties = profile.properties,
                                item = profile.getItemByDom(id),
                                pos = ood.Event.getPos(e);

                            if (item.draggable) {
                                profile.getSubNode('ITEMICON', itemId).startDrag(e, {
                                    dragType: 'icon',
                                    shadowFrom: src,
                                    dragCursor: 'pointer',
                                    targetLeft: pos.left + 12,
                                    targetTop: pos.top + 12,
                                    sub: true,
                                    dragKey: item.dragKey || profile.properties.dragKey,
                                    dragData: {
                                        cls: item.cls || item.key,
                                        type: item.key,
                                        caption: item.caption,
                                        iniProp: item.iniProp,
                                        children: item.sub,
                                        iniEvents: item.iniEvents,
                                        customRegion: item.customRegion,
                                        image: item.image,
                                        imagePos: item.imagePos,
                                        imageClass: item.imageClass
                                    }
                                });
                                ood.use(src).tagClass('-hover', false);
                                ood.use(src).tagClass('-active', false);

                                if (RAD.Designer) {
                                    ood.each(RAD.Designer.getAllInstance(), function (page) {
                                        if (page && !page.destroyed) {
                                            page._clearSelect();
                                            if (page.resizer)
                                                page._setSelected([], true);
                                        }
                                    });
                                }
                                return false;
                            }
                        }
                    }
                })
                .beforePrepareItem(function (profile, item, pid) {
                    if (item.key && CONF.mapWidgets[item.key]) {
                        var p = CONF.mapWidgets[item.key];
                        item.imageClass = CONF.mapWidgets[item.key].imageClass;
                    }
                });
            ns._reload();

        },



        customAppend: function (parent, subId, left, top) {
            return true;
        },
        show2: function () {
            this.servicedlg.show();
        },
        hide: function () {
            this.servicedlg.hide();
        },

        _reload: function (profile, item) {
            ns = this;
            ns.treebarCom.setItems(ns._buildItems(this.topNodes));
            ns.treebarCom.fireItemClickEvent('pageService');

        },

        _toolbar_onclick: function (profile, item, group, e, src) {
            var ns = this;
            switch (item.id) {
                case 'refresh':
                    ns.treebarCom.setItems(ns._buildItems(this.topNodes));
                    break;

                case 'import':
                    ood.getModule("RAD.api.APITree", function () {
                        this.setData({projectName: SPA.curProjectName});

                        this.show();
                        this.initData();
                        this._fireEvent('afterShow');
                    });
                    break;

            }
        },

        _treebarcom_ongetcontent: function (profile, item, callback) {
            ns = this;
            if (item.key == "jds.localService") {
                ood.Ajax(CONF.getLocalServiceToolBoxService, {
                    projectName: SPA.curProjectName,
                    pattern: ns.pattern.getUIValue()
                }, function (txt) {
                    var obj = txt;
                    if (!obj || obj.error) {
                        ood.message("No module in this project!");
                        callback(false);
                    } else {

                        callback(ns._buildItems(obj.data));
                    }
                }, function (txt) {
                    callback(false);
                }, null, {method: 'post'}).start();
            } else if (item.key == "jds.getPageServiceToolBoxService") {
                ood.Ajax(CONF.getPageServiceToolBoxService, {
                    projectName: SPA.curProjectName,
                    className: SPA.getCurrentClassName(),
                    pattern: ns.pattern.getUIValue()
                }, function (txt) {
                    var obj = txt;
                    if (!obj || obj.error) {
                        ood.message("No module in this project!");
                        callback(false);
                    } else {
                        callback(ns._buildItems(obj.data));
                    }
                }, function (txt) {
                    callback(false);
                }, null, {method: 'post'}).start();
            } else if (item.key == "jds.getProjectServiceToolBoxService") {
                ood.Ajax(CONF.getProjectServiceToolBoxService, {
                    projectName: SPA.curProjectName,
                    pattern: ns.pattern.getUIValue()
                }, function (txt) {
                    var obj = txt;
                    if (!obj || obj.error) {
                        ood.message("No module in this project!");
                        callback(false);
                    } else {
                        var items = [];

                        callback(ns._buildItems(obj.data));
                        //callback(obj.data);
                    }
                }, function (txt) {
                    callback(false);
                }, null, {method: 'post'}).start();
            } else if (item.key == "jds.Server") {
                ood.Ajax(CONF.getRemoteServiceByKeyService, {
                    projectName: SPA.curProjectName,
                    pattern: ns.pattern.getUIValue(),
                    serverId: item.id
                }, function (txt) {

                    var obj = txt;
                    if (!obj || obj.error) {
                        ood.message("No service in this project!");
                        callback(false);
                    } else {
                        var items = [];
                        callback(obj.data);
                    }
                }, function (txt) {
                    callback(false);
                }, null, {method: 'post'}).start();
            }


        }
    }
});
﻿ood.Class('RAD.ProjectTree', 'ood.Module', {
    Instance: {
        Dependencies: [],
        Required: [],
        events: {},
        initialize: function () {
        },

        iniComponents: function () {
            // [[Code created by JDSEasy RAD Studio
            var host = this, children = [], properties = {}, append = function (child) {
                children.push(child.get(0));
            };
            ood.merge(properties, this.properties);

            append(
                ood.create("ood.APICaller")
                    .setHost(host, "openFolder")
                    .setName("openFolder")
                    .setQueryAsync(false)
                    .setQueryURL(CONF.openOtherFolderService)
                    .setQueryMethod("POST")
                    .setRequestDataSource([
                        {
                            "type":"treeview",
                            "name":"ood_ui_treeview27",
                            "path":""
                        }
                    ])
                    .setResponseDataTarget([])
                    .setResponseCallback([])
            );

            append(
                ood.create("ood.APICaller")
                    .setHost(host, "getProjectTree")
                    .setName("getProjectTree")
                    .setAutoRun(true)
                    .setQueryURL(CONF.getAllProjectTreeSrvice)
                    .setRequestDataSource([
                        {
                            "name": "dialog",
                            "path": "",
                            "type": "form"
                        }
                    ])
                    .setResponseDataTarget([
                        {
                            "name": "ood_ui_treeview27",
                            "path": "data",
                            "type": "treeview"
                        },
                        {
                            "name": "dialog",
                            "path": "data",
                            "type": "form"
                        }
                    ])
                    .setResponseCallback([])
            );

            append(
                ood.create("ood.APICaller")
                    .setHost(host, "copyTo")
                    .setName("copyTo")
                    .setQueryAsync(false)
                    .setQueryURL(CONF.importFileService)
                    .setQueryMethod("POST")
                    .setRequestDataSource([
                        {
                            "type": "treeview",
                            "name": "ood_ui_treeview27",
                            "path": ""
                        },
                        {
                            "type": "form",
                            "name": "dialog",
                            "path": ""
                        }
                    ])
                    .setResponseDataTarget([])
                    .setResponseCallback([])
                    .onData("_copyto_ondata")
            );

            append(
                ood.create("ood.UI.Dialog")
                    .setHost(host, "dialog")
                    .setLeft("12.5em")
                    .setTop("7.5em")
                    .setHeight("37.5em")
                    .setCaption("$RAD.toolbox.selectResource")
                    .setImageClass("ri-3d-box-line")
            );

            host.dialog.append(
                (new ood.UI.ComboInput())
                    .setHost(host, "pattern")
                    .setName("pattern")
                    .setDock("top")
                    .setLeft("3.6666666666666665em")
                    .setTop("2em")
                    .setWidth("15em")
                    .setLabelSize("3em")
                    .setLabelCaption("$RAD.toolbox.search")
                    .setType("helpinput")
                    .onChange("_reload")
            );

            host.dialog.append(
                ood.create("ood.UI.HiddenInput")
                    .setHost(host, "projectName")
                    .setName("projectName")
                    .setValue(SPA.curProjectName)
            );
            host.dialog.append(
                ood.create("ood.UI.HiddenInput")
                    .setHost(host, "tpath")
                    .setName("tpath")
                    .setValue("")
            );


            host.dialog.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ood_ui_block249")
                    .setDock("bottom")
                    .setLeft("7.5em")
                    .setTop("18.333333333333332em")
                    .setHeight("3.5833333333333335em")
            );

            host.ood_ui_block249.append(
                ood.create("ood.UI.Button")
                    .setHost(host, "ood_ui_button38")
                    .setLeft("8.333333333333334em")
                    .setTop("0.8333333333333334em")
                    .setCaption("确定")
                    .setImageClass("iconfont iconduigoux")
                    .onClick([
                        {
                            "args": [
                                "$RAD.toolbox.selectResource",
                                "$RAD.toolbox.selectResource"
                            ],
                            "conditions": [
                                {
                                    "left": "{page.ood_ui_treeview27.getUIValue()}",
                                    "right": "",
                                    "symbol": "empty"
                                }
                            ],
                            "desc": "动作 3",
                            "method": "alert",
                            "target": "msg",
                            "type": "other",
                            "onOK": 2
                        },
                        {
                            "args": [
                                "{page.copyTo.invoke()}"
                            ],
                            "desc": "动作 2",
                            "koFlag": "_DI_fail",
                            "method": "invoke",
                            "okFlag": "_DI_succeed",
                            "target": "copyTo",
                            "type": "control",
                            "redirection": "other:callback:call"
                        }
                    ])
            );

            host.dialog.append(
                ood.create("ood.UI.TreeView")
                    .setHost(host, "ood_ui_treeview27")
                    .setName("lefttree")
                    .setItems([
                        {
                            "caption": "$RAD.toolbox.allProject",
                            "disabled": true,
                            "hidden": false,
                            "id": "root",
                            "initFold": false
                        }
                    ])
                    .setLeft("0em")
                    .setTop("0em")
                    .setInitFold(false)
                    .setSelMode("multibycheckbox")
                    .setOptBtn("ood-uicmd-opt")
                    .setTogglePlaceholder(true)
                    .setValue("")
                    .onGetContent({
                        "actions": [
                            {
                                "args": [
                                    "{page.openFolder.setQueryData()}",
                                    null,
                                    null,
                                    "{args[1]}",
                                    ""
                                ],
                                "desc": "动作 1",
                                "method": "setQueryData",
                                "redirection": "other:callback:call",
                                "target": "openFolder",
                                "type": "control"
                            },
                            {
                                "args": [
                                    "{page.openFolder.invoke()}",
                                    null,
                                    null,
                                    "{args[2]}"
                                ],
                                "desc": "动作 3",
                                "method": "call",
                                "target": "callback",
                                "type": "other"
                            }
                        ],
                        "return": "{temp.okData.data}"
                    })
            );

            return children;
            // ]]Code created by JDSEasy RAD Studio
        },

        _reload: function (profile, item) {
            ns = this;
            ns.treebarCom.setItems(buildItems(this.topNodes));
            ns.treebarCom.fireItemClickEvent('localService');

        },
        _copyto_ondata: function (profile, rspData, requestId) {
            var ns = this, uictrl = profile.boxing();
            var obj = rspData;
            // ns.dialog.free();
            if (obj && obj.requestStatus != -1) {
                ns.fireEvent('onOK', [obj.data]);
                ns.dialog.close();
                ns.destroy();
             
            } else if (obj && !obj.error) {
                ood.message(ood.get(obj, ['error', 'errdes']) || obj || 'no response!')

            } else ood.message(ood.get(obj, ['error', 'errdes']) || obj || 'no response!');


        },
        customAppend: function (parent, subId, left, top) {
            return false;
        }
    }
});
﻿ood.Class('RAD.JumpTo', 'ood.Module', {
    Instance: {
        initialize: function () {
            this.autoDestroy = true;
            this.properties = {};
        },
        iniComponents: function () {
            // [[Code created by ESDUI RAD Studio
            var host = this, children = [], append = function (child) {
                children.push(child.get(0));
            };

            append(
                ood.create("ood.UI.Dialog")
                    .setHost(host, "ctl_dialog")
                    .setLeft("4.375em")
                    .setTop("3.25em")
                    .setWidth("18em")
                    .setHeight("12em")
                    .setResizer(false)
                    .setCaption("$RAD.jumpto")
                    .setMinBtn(false)
                    .setMaxBtn(false)
                    .setOverflow("hidden")
                    .onHotKeydown("_ctl_dialog_onhotkeydown")
                    .beforeClose("_ctl_dialog_beforeclose")
            );

            host.ctl_dialog.append(
                ood.create("ood.UI.Label")
                    .setHost(host, "ctl_slabel1")
                    .setLeft("0.625em")
                    .setTop("0.5833333333333334em")
                    .setWidth("4.625em")
                    .setCaption("$RAD.jumpto")
            );

            host.ctl_dialog.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "ctl_comboinput3")
                    .setDirtyMark(false)
                    .setLeft("6.875em")
                    .setTop("0.3333333333333333em")
                    .setWidth("5.583333333333333em")
                    .setHeight("1.9166666666666667em")
                    .setType("spin")
                    .setPrecision(0)
                    .setIncrement(1)
                    .setMin(1)
                    .setMax(100000)
                    .setValue(1)
            );

            host.ctl_dialog.append(
                ood.create("ood.UI.Button")
                    .setHost(host, "ctl_sbutton5")
                    .setLeft("2.5em")
                    .setTop("4.166666666666667em")
                    .setWidth("4.666666666666667em")
                    .setHeight("1.9166666666666667em")
                    .setCaption("$RAD.cancel")
                    .onClick("_ctl_sbutton5_onclick")
            );

            host.ctl_dialog.append(
                ood.create("ood.UI.Button")
                    .setHost(host, "ctl_btnok")
                    .setLeft("9.166666666666666em")
                    .setTop("4.166666666666667em")
                    .setWidth("4.666666666666667em")
                    .setHeight("1.9166666666666667em")
                    .setCaption("$RAD.ok")
                    .onClick("_ctl_btnok_onclick")
            );


            host.ctl_dialog.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ood_ui_block112")
                    .setLeft("0.8333333333333334em")
                    .setTop("3.3333333333333335em")
                    .setWidth("14.166666666666666em")
                    .setHeight("0em")
                    .setBorderType("inset")
            );

            return children;
            // ]]Code created by ESDUI RAD Studio
        },
        customAppend: function (parent, subId, left, top) {
            this.ctl_comboinput3.setUIValue(1, true)
            this.ctl_dialog.showModal(parent, left, top);
        },
        events: {},
        _ctl_sbutton5_onclick: function (profile, e, src, value) {
            this.ctl_dialog.close();
        },
        _ctl_dialog_beforeclose: function (profile) {
            this.ctl_dialog.hide();
            return false;
        },
        _ctl_btnok_onclick: function (profile, e, src, value) {
            this.fireEvent("onOK", [this.ctl_comboinput3.getUIValue()]);
            this.ctl_dialog.close();
        },
        _ctl_dialog_onhotkeydown: function (profile, keyboard) {
            if (keyboard.key == 'esc') {
                this.ctl_dialog.close();
            }
        }
    }
});
﻿ood.Class('RAD.FAndR', 'ood.Module',{
    Instance:{
        _editor:null,
        initialize : function(){
            this.autoDestroy = true;
            this.properties = {};
        },
        iniComponents : function(){
            // [[Code created by ESDUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"ctl_dialog")
                .setShowEffects("Slide In TB")
                .setHideEffects("Slide In TB")
                .setLeft("0em")
                .setTop("0em")
                .setHeight("18em")
                .setSelectable(false)
                .setResizer(false)
                .setInitPos("auto")
                .setCaption("$RAD.pageEditor.searchreplace")
                .setMinBtn(false)
                .setMaxBtn(false)
                .setOverflow("hidden")
                .onHotKeydown("_ctl_dialog_onhotkeydown")
                .beforeClose("_ctl_dialog_beforeclose")
            );
            
            host.ctl_dialog.append(
                ood.create("ood.UI.Label")
                .setHost(host,"ctl_slabel1")
                .setLeft("1.25em")
                .setTop("0.875em")
                .setWidth("5.25em")
                .setCaption("$RAD.pageEditor.search")
                );
            
            host.ctl_dialog.append(
                ood.create("ood.UI.Label")
                .setHost(host,"ctl_slabel2")
                .setLeft("1.25em")
                .setTop("3.5em")
                .setWidth("5.25em")
                .setCaption("$RAD.pageEditor.replacewith")
                );
            
            host.ctl_dialog.append(
                ood.create("ood.UI.Input")
                .setHost(host,"ctl_i1")
                .setDirtyMark(false)
                .setLeft("6.875em")
                .setTop("0.625em")
                .setWidth("14.666666666666666em")
                .onHotKeydown("_ctl_i1_onhotkeydown")
                );
            
            host.ctl_dialog.append(
                ood.create("ood.UI.Input")
                .setHost(host,"ctl_i2")
                .setDirtyMark(false)
                .setLeft("6.875em")
                .setTop("3.25em")
                .setWidth("14.666666666666666em")
                );
            
            host.ctl_dialog.append(
                ood.create("ood.UI.Button")
                .setHost(host,"ctl_sbtnSearch")
                .setDefaultFocus(true)
                .setLeft("2.4166666666666665em")
                .setTop("6.666666666666667em")
                .setWidth("9.166666666666666em")
                .setCaption("$RAD.pageEditor.search")
                .onClick("_ctl_sbtnsearch_onclick")
                );


            host.ctl_dialog.append(
                ood.create("ood.UI.Button")
                .setHost(host,"ctl_sbtnReplace")
                .setLeft("2.4166666666666665em")
                .setTop("9.166666666666666em")
                .setWidth("9.166666666666666em")
                .setCaption("$RAD.pageEditor.replace")
                .onClick("_ctl_sbtnreplace_onclick")
                );
            
            host.ctl_dialog.append(
                ood.create("ood.UI.Button")
                .setHost(host,"ctl_sbtnSR")
                .setLeft("12.75em")
                .setTop("6.666666666666667em")
                .setWidth("9.166666666666666em")
                .setCaption("$RAD.pageEditor.replacesearch")
                .onClick("_ctl_sbtnsr_onclick")
                );
            
            host.ctl_dialog.append(
                ood.create("ood.UI.Button")
                .setHost(host,"ctl_sbtnRA")
                .setLeft("12.75em")
                .setTop("9.166666666666666em")
                .setWidth("9.166666666666666em")
                .setCaption("$RAD.pageEditor.replaceall")
                .onClick("_ctl_sbtnra_onclick")
                );
            
            host.ctl_dialog.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ood_ui_block91")
                .setLeft("1.6666666666666667em")
                .setTop("5.833333333333333em")
                .setWidth("20.75em")
                .setHeight("0em")
                .setBorderType("inset")
                );
            
            return children;
            // ]]Code created by ESDUI RAD Studio
        },
        customAppend : function(parent, subId, left, top){
            var ns=this;
            if(ns._init){
                ns.ctl_i1.setUIValue(ns._init);
            }
            ns.ctl_i2.setUIValue("");
            ns.ctl_dialog.show(parent, false, left, top,function(){
                ns.ctl_i1.activate();
            });
        },
        _ctl_dialog_beforeclose : function (profile) {
            this.ctl_dialog.hide();
            this._SearchCursor=null;
            return false;
        },
        getCM:function(){
            var ns=this;
            if(ns._editor){
                return ns._editor.getCM();
            }
        },
        _ctl_sbtnsearch_onclick : function (profile, e, src, value) {
            var ns=this, query=ns.ctl_i1.getUIValue(),cm;
            if(query &&(cm=ns.getCM())){
                var cs = ns._SearchCursor=cm.getSearchCursor(query, cm.doc.getCursor(), true);
                if(cs.findNext()){
                    cm.doc.setSelection(cs.from(),cs.to());
                }else{
                    cs = ns._SearchCursor=cm.getSearchCursor(query, 0, true);
                    if(cs.findNext()){
                        cm.doc.setSelection(cs.from(),cs.to());
                    }else
                        ood.message(ood.getRes('RAD.pageEditor.findnone'));
                }
            }
        },
        _ctl_sbtnreplace_onclick : function (profile, e, src, value) {
            var ns=this, query=ns.ctl_i1.getUIValue(),rep=ns.ctl_i2.getUIValue(),cm;
            if(query &&(cm=ns.getCM())){
                if(ns._SearchCursor && cm.getSelection()==query){
                    ns._SearchCursor.replace(rep);
                }
            }
        },
        _ctl_sbtnsr_onclick : function (profile, e, src, value) {
            var ns=this, query=ns.ctl_i1.getUIValue(),rep=ns.ctl_i2.getUIValue(),cm;
            if(query &&(cm=ns.getCM())){
                if(ns._SearchCursor && cm.getSelection()==query){
                    ns._SearchCursor.replace(rep);
                }
                ns._ctl_sbtnsearch_onclick();
            }
        },
        _ctl_sbtnra_onclick : function (profile, e, src, value) {
            var ns=this, query=ns.ctl_i1.getUIValue(),rep=ns.ctl_i2.getUIValue(),cm;
            if(query &&(cm=ns.getCM())){
                var count=0;
                var cs = ns._SearchCursor=cm.getSearchCursor(query, 0, true);
                while(cs.findNext()){
                    cs.replace(rep);
                    count++;
                }
                ood.message(ood.getRes('RAD.pageEditor.replaceCount', count));
            }
        },
        _ctl_dialog_onhotkeydown : function (profile, keyboard){
            if(keyboard.key=='esc'){
                this.ctl_dialog.close();
            }
        },
        _ctl_i1_onhotkeydown:function (profile, keyboard, e, src){
            if(keyboard.key=='enter'){
                this.ctl_sbtnSearch.onClick();
            }
        }
    }
});
﻿ood.Class("RAD.EditorTool",null,{
    Static:{    
        getPropName:function(key,prop){
            if(!key||!prop)return '';
            var mkey="doc.propname."+key.replace(/\./g,'_')+"."+prop;
            var o=ood.getRes(mkey);
            if(o != prop){
                return ood.wrapRes(mkey);
            }else{
                    var obj = ood.get(window,key.split('.'));
                    obj=obj.prototype['get'+prop.replace(/^[a-z]/g,function(a){return a.toUpperCase();})] || obj['set'+prop.replace(/^[a-z]/g,function(a){return a.toUpperCase();})] ;
                    if(obj && obj.$original$ && obj.$original$!=key)
                        return RAD.EditorTool.getPropName(obj.$original$, prop);
                    else
                       return ood.wrapRes(mkey);
            }
        }, 
        getEventName:function(key,evt){
            if(!key||!evt)return '';
            var mkey="doc.eventname."+key.replace(/\./g,'_')+"."+evt;
            var o=ood.getRes(mkey);
            if(o != evt){
                return ood.wrapRes(mkey);
            }else{
                    var obj = ood.get(window,key.split('.'));
                    obj=obj.prototype[evt];
                    if(obj && obj.$original$ && obj.$original$!=key)
                        return RAD.EditorTool.getEventName(obj.$original$, evt);
                    else
                       return ood.wrapRes(mkey);
            }
        }, 
        getDoc:function(key, shortMsg, returnHash){
            if(!key)return '';
            if(key.indexOf('(')!=-1)
                key=key.replace(/[()]/g,'');
            var o = ood.getRes("doc."+key);
            try{
                if(typeof o == 'string'){
                    var obj = ood.get(window,key.split('.'));
                    if(obj && obj.$original$)
                        o = ood.getRes("doc." +obj.$original$+((obj.$type$=='instance'||obj.$type$=='event')?'.prototype':'')+"."+obj.$name$);
                    if(typeof o == 'string')
                        return null;
                }
                return returnHash?o:this._buildDoc(o, shortMsg);
            }catch(e){
                return null;
            }
        }, 
        _buildDoc:function(o, shortMsg){
            var arr=[];
            if(o){
                if(shortMsg){
                    return o.$desc;
                }else{
                    if(o.$desc)
                        arr.push('<div class="doc-inndiv">' + o.$desc + '</div>');
                    if(o.$rtn)
                        arr.push('<div class="doc-inndiv">' + '<strong>'+ood.getRes('app.retV')+': </strong>' + o.$rtn + '</div>');
                    if(o.$paras){
                        arr.push('<div class="doc-inndiv">' + '<div><strong>'+ood.getRes('app.param')+': </strong></div><ul>');
                        ood.arr.each(o.$paras,function(v){
                            v=v.replace(/^([^:\[]*)([^:]*):(.*)$/,"<strong>$1</strong> $2 : $3");
                            arr.push('<li> ' + v + ' </li>');
                        })
                        arr.push("</ul></div>");
                    }
    
                    if(o.$snippet){
                        arr.push('<div class="doc-inndiv">' + '<div><strong>'+ood.getRes('app.codesnip')+': </strong></div>');
                        ood.arr.each(o.$snippet,function(v){
                            arr.push('<textarea id="doc:code" class="js plain fold" style="display:none;">' + v + '</textarea><p>&nbsp;</p>');
                        })
                        arr.push("</div>");
                    }
                    if(o.$memo)
                        arr.push('<div class="doc-inndiv">' + '<strong>'+ood.getRes('app.memo')+': </strong>' + o.$memo + '</div>');
    
                    if(o.$links){
                        arr.push('<div class="doc-inndiv">' + '<div><strong>'+ood.getRes('app.seealso')+': </strong></div><ul>');
                        ood.arr.each(o.$links,function(v){
                            arr.push('<li><a target="'+(v[2]||'')+'" href="' +v[1]+ '">' + v[0] + '</a></li>');
                        })
                        arr.push("</ul></div>");
                    }
                }
            }
            return arr.join('');
        }, 
        showFindWnd:function(ajax,editor, pos, str, parent){
            ood.ComFactory.getCom("RAD.FAndR",function(){
                this._editor=editor;
                this._init=str;
                this.show(null, editor.getRoot(), null, null, 0, 0);
            });
        },
        showJumpToWnd:function(ajax,editor, pos){
            ood.ComFactory.getCom("RAD.JumpTo",function(){
                this.setEvents({
                    "onOK":function(line){
                        try{
                            editor.callEditor('focus');
                            editor.callEditor('setCursor',[line-1,0],true);
                        }catch(e){}
                    }
                });
                this.show(null, null, null, null, pos.left, pos.top);
            });
        }
    }
});
﻿ood.Class('RAD.EditorTheme', 'ood.Module', {
    Instance: {
        // To initialize internal components (mostly UI controls)
        // *** If you're not a skilled, dont modify this function manually ***
        iniComponents: function () {
            // [[Code created by ESDUI RAD Studio
            var host = this, children = [], append = function (child) {
                children.push(child.get(0));
            };

            append(
                ood.create("ood.UI.Dialog")
                    .setHost(host, "dlg")
                    .setLeft("2.5em")
                    .setTop("3.125em")
                    .setWidth("45.833333333333336em")
                    .setHeight("26.416666666666668em")
                    .setCaption("$RAD.editorTheme.name")
                    .setMinBtn(false)
                    .setMaxBtn(false)
                    .setOverflow("hidden")
            );

            host.dlg.append(
                ood.create("ood.UI.Panel")
                    .setHost(host, "ctl_panel7")
                    .setDock("none")
                    .setLeft("0.625em")
                    .setTop("13.75em")
                    .setWidth("15.916666666666666em")
                    .setHeight("8.75em")
                    .setZIndex(1)
                    .setOverflow("visible")
                    .setCaption("$RAD.editorTheme.selFontSize")
            );

            host.ctl_panel7.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "_ctl_fs")
                    .setDirtyMark(false)
                    .setLeft("9.083333333333334em")
                    .setTop("3em")
                    .setWidth("5.25em")
                    .setZIndex(1003)
                    .setType("spin")
                    .setUnit("px")
                    .setPrecision(0)
                    .setIncrement(1)
                    .setMin(1)
                    .setMax(100)
                    .afterValueSet("_ctl_fs_aftervalueset")
            );

            host.ctl_panel7.append(
                ood.create("ood.UI.Label")
                    .setHost(host, "ctl_slabel124")
                    .setLeft("0em")
                    .setTop("3.3333333333333335em")
                    .setWidth("8.25em")
                    .setHeight("1.5em")
                    .setCaption("$RAD.editorTheme.selFontSize")
            );

            host.ctl_panel7.append(
                ood.create("ood.UI.CheckBox")
                    .setHost(host, "ctl_wrap")
                    .setDirtyMark(false)
                    .setLeft("3.5833333333333335em")
                    .setTop("0.6666666666666666em")
                    .setWidth("10.833333333333334em")
                    .setIconPos("right")
                    .setCaption("$RAD.editorTheme.lineWrapping")
                    .afterUIValueSet("_ctl_wrap_afteruivalueset")
            );

            host.dlg.append(
                ood.create("ood.UI.Panel")
                    .setHost(host, "ctl_panel4")
                    .setDock("none")
                    .setLeft("0.625em")
                    .setTop("0.625em")
                    .setWidth("15.916666666666666em")
                    .setHeight("12.75em")
                    .setZIndex(1)
                    .setCaption("$RAD.editorTheme.selTheme")
            );

            host.ctl_panel4.append(
                ood.create("ood.UI.List")
                    .setHost(host, "_ctl_theme")
                    .setDirtyMark(false)
                    .setItems([{
                        "id": "default",
                        "caption": "default"
                    },
                        {
                            "id": "3024-day",
                            "caption": "3024-day"
                        },
                        {
                            "id": "3024-night",
                            "caption": "3024-night"
                        },
                        {
                            "id": "abcdef",
                            "caption": "abcdef"
                        },
                        {
                            "id": "ambiance-mobile",
                            "caption": "ambiance-mobile"
                        },
                        {
                            "id": "ambiance",
                            "caption": "ambiance"
                        },
                        {
                            "id": "base16-dark",
                            "caption": "base16-dark"
                        },
                        {
                            "id": "base16-light",
                            "caption": "base16-light"
                        },
                        {
                            "id": "bespin",
                            "caption": "bespin"
                        },
                        {
                            "id": "blackboard",
                            "caption": "blackboard"
                        },
                        {
                            "id": "cobalt",
                            "caption": "cobalt"
                        },
                        {
                            "id": "colorforth",
                            "caption": "colorforth"
                        },
                        {
                            "id": "darcula",
                            "caption": "darcula"
                        },
                        {
                            "id": "duotone-dark",
                            "caption": "duotone-dark"
                        },
                        {
                            "id": "duotone-light",
                            "caption": "duotone-light"
                        },
                        {
                            "id": "eclipse",
                            "caption": "eclipse"
                        },
                        {
                            "id": "elegant",
                            "caption": "elegant"
                        },
                        {
                            "id": "erlang-dark",
                            "caption": "erlang-dark"
                        },
                        {
                            "id": "gruvbox-dark",
                            "caption": "gruvbox-dark"
                        },
                        {
                            "id": "hopscotch",
                            "caption": "hopscotch"
                        },
                        {
                            "id": "icecoder",
                            "caption": "icecoder"
                        },
                        {
                            "id": "idea",
                            "caption": "idea"
                        },
                        {
                            "id": "isotope",
                            "caption": "isotope"
                        },
                        {
                            "id": "lesser-dark",
                            "caption": "lesser-dark"
                        },
                        {
                            "id": "liquibyte",
                            "caption": "liquibyte"
                        },
                        {
                            "id": "lucario",
                            "caption": "lucario"
                        },
                        {
                            "id": "material",
                            "caption": "material"
                        },
                        {
                            "id": "mbo",
                            "caption": "mbo"
                        },
                        {
                            "id": "mdn-like",
                            "caption": "mdn-like"
                        },
                        {
                            "id": "midnight",
                            "caption": "midnight"
                        },
                        {
                            "id": "nord",
                            "caption": "nord"
                        },
                        {
                            "id": "monokai",
                            "caption": "monokai"
                        },
                        {
                            "id": "neat",
                            "caption": "neat"
                        },
                        {
                            "id": "neo",
                            "caption": "neo"
                        },
                        {
                            "id": "night",
                            "caption": "night"
                        },
                        {
                            "id": "oceanic-next",
                            "caption": "oceanic-next"
                        },
                        {
                            "id": "panda-syntax",
                            "caption": "panda-syntax"
                        },
                        {
                            "id": "paraiso-dark",
                            "caption": "paraiso-dark"
                        },
                        {
                            "id": "paraiso-light",
                            "caption": "paraiso-light"
                        },
                        {
                            "id": "pastel-on-dark",
                            "caption": "pastel-on-dark"
                        },
                        {
                            "id": "railscasts",
                            "caption": "railscasts"
                        },
                        {
                            "id": "rubyblue",
                            "caption": "rubyblue"
                        },
                        {
                            "id": "seti",
                            "caption": "seti"
                        },
                        {
                            "id": "shadowfox",
                            "caption": "shadowfox"
                        },
                        {
                            "id": "solarized",
                            "caption": "solarized"
                        },
                        {
                            "id": "ssms",
                            "caption": "ssms"
                        },
                        {
                            "id": "the-matrix",
                            "caption": "the-matrix"
                        },
                        {
                            "id": "tomorrow-night-bright",
                            "caption": "tomorrow-night-bright"
                        },
                        {
                            "id": "tomorrow-night-eighties",
                            "caption": "tomorrow-night-eighties"
                        },
                        {
                            "id": "ttcn",
                            "caption": "ttcn"
                        },
                        {
                            "id": "twilight",
                            "caption": "twilight"
                        },
                        {
                            "id": "vibrant-ink",
                            "caption": "vibrant-ink"
                        },
                        {
                            "id": "xq-dark",
                            "caption": "xq-dark"
                        },
                        {
                            "id": "xq-light",
                            "caption": "xq-light"
                        },
                        {
                            "id": "yeti",
                            "caption": "yeti"
                        },
                        {
                            "id": "yonce",
                            "caption": "yonce"
                        },
                        {
                            "id": "zenburn",
                            "caption": "zenburn"
                        }])
                    .setDock("fill")
                    .setBorderType("none")
                    .setValue("")
                    .afterValueSet("_ctl_theme_aftervalueset")
            );

            host.dlg.append(
                ood.create("ood.UI.Button")
                    .setHost(host, "btnOK")
                    .setLeft("31.833333333333332em")
                    .setTop("20.625em")
                    .setWidth("8.083333333333334em")
                    .setImageClass("ri-check-line") // 替换 spafont spa-icon-ok
                    .setCaption("$RAD.ok")
                    .onClick("_btnok_onclick")
            );

            host.dlg.append(
                ood.create("ood.UI.Button")
                    .setHost(host, "ctl_sbutton13")
                    .setLeft("22.5em")
                    .setTop("20.625em")
                    .setWidth("8.083333333333334em")
                    .setImageClass("ri-close-line") // 替换 spafont spa-icon-cancel
                    .setCaption("$RAD.cancel")
                    .onClick("_btncancel_onclick")
            );

            host.dlg.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "codePreview")
                    .setLeft("17.416666666666668em")
                    .setTop("0.625em")
                    .setWidth("26.25em")
                    .setHeight("19.375em")
                    .setBorderType("inset")
                    .setBackground("#FFFFFF")
                    .setOverflow("hidden")
            );

            return children;
            // ]]Code created by ESDUI RAD Studio
        },
        _btnok_onclick: function (profile, e, src, value) {
            this.fireEvent('onOK', [this._theme, this._fontsize, this._lineWrapping], this);
            this.dlg.close();
        },
        _btncancel_onclick: function (profile, e, src, value) {
            this.dlg.close();
        },
        customAppend: function (parent) {
            var ns = this,
                fontsize = parseInt(ood.CSS.$getCSSValue(".codemirror", "fontSize"), 10) || 13,
                theme = 'default',
                lineWrapping = false;

            var obj = CONF.getStatus();
            if (obj) {
                if (ood.isFinite(obj.editorFontSize)) {
                    fontsize = obj.editorFontSize;
                }
                if (obj.editorTheme) {
                    theme = obj.editorTheme;
                }
                if (ood.isSet(obj.lineWrapping)) {
                    lineWrapping = obj.lineWrapping;
                }
            }

            ns._ctl_fs.setUIValue(ns._fontsize = fontsize);
            ns._ctl_theme.setUIValue(ns._theme = theme);
            ns.ctl_wrap.setUIValue(ns._lineWrapping = lineWrapping);

            ns.dlg.showModal(parent);
            return false;
        },
        _refreshCode: function () {
            var ns = this,
                id = "cm-theme-" + ns._theme,
                path = CONF.mapServerPath(CONF.mapServerPath('/RAD/template/' + ood.getLang() + "/index.js"));

            if (ns._theme != "default" && !ood.CSS.get("id", id)) {
                ood.CSS.includeLink("/plugins/codemirror5/theme/" + ns._theme + ".css", false, id);
            }
            CONF.getLocalFile(path, function (code) {
                ns.codePreview.getSubNode("PANEL").html("", true);
                var cm = new CodeMirror(function (elt) {
                    ns.codePreview.getSubNode("PANEL").append(elt);
                    elt.style.fontSize = ns._fontsize + "px";
                }, {
                    theme: ns._theme,
                    lineWrapping: !!ns._lineWrapping,
                    readOnly: true,
                    value: code
                });
            }, function () {
                alert(ood.getRes('RAD.builder.noexist', path));
            });
        },
        _ctl_fs_aftervalueset: function (prf) {
            var ns = this;
            ns._fontsize = prf.boxing().getValue();
            ood.resetRun(this.$xid, function () {
                ns._refreshCode();
            }, 100);
        },
        _ctl_theme_aftervalueset: function (prf) {
            var ns = this;
            ns._theme = prf.boxing().getValue();
            ood.resetRun(this.$xid, function () {
                ns._refreshCode();
            }, 100);
        },
        _ctl_wrap_afteruivalueset: function (profile, oldValue, newValue) {
            var ns = this;
            ns._lineWrapping = !!newValue;
            ood.resetRun(this.$xid, function () {
                ns._refreshCode();
            }, 100);
        }
    }
});
﻿ood.Class('RAD.ServiceTester', 'ood.Module', {
    Instance: {
        initialize: function () {
            this.autoDestroy = true;
            this.properties = {};
        },
        iniComponents: function () {
            // [[Code created by ESDUI RAD Studio
            var host = this, children = [], append = function (child) {
                children.push(child.get(0));
            };

            append(
                ood.create("ood.UI.Dialog")
                    .setHost(host, "dlg")
                    .setLeft("11.416666666666666em")
                    .setTop("3.75em")
                    .setWidth("44.416666666666664em")
                    .setHeight("33.75em")
                    .setCaption("$RAD.spabuilder.st_title")
                    .setMinBtn(false)
                    .setMaxBtn(false)
                    .setOverflow("visible")
                    .beforeClose("_dlg_beforeclose")
            );

            host.dlg.append(
                ood.create("ood.UI.Group")
                    .setHost(host, "ctl_group1")
                    .setLeft("0.625em")
                    .setTop("3.3333333333333335em")
                    .setWidth("42.583333333333336em")
                    .setConDockPadding({
                            "left": 4,
                            "top": 4,
                            "right": 4,
                            "bottom": 4
                        }
                    )
                    .setCaption("$RAD.spabuilder.st_queryobj")
                    .setToggleBtn(false)
                    .setCustomStyle({
                            "PANEL": "overflow:visible"
                        }
                    )
            );

            host.ctl_group1.append(
                ood.create("ood.Module.JSONEditor", "ood.Module")
                    .setHost(host, "ctl_query")
                    .setProperties({
                            "value": "{a:1,b:2}"
                        }
                    )
            );

            host.dlg.append(
                ood.create("ood.UI.Group")
                    .setHost(host, "ctl_group3")
                    .setLeft("0.625em")
                    .setTop("16.666666666666668em")
                    .setWidth("42.583333333333336em")
                    .setConDockPadding({
                            "left": 4,
                            "top": 4,
                            "right": 4,
                            "bottom": 4
                        }
                    )
                    .setCaption("$RAD.spabuilder.st_result")
                    .setToggleBtn(false)
                    .setCustomStyle({
                            "PANEL": "overflow:visible"
                        }
                    )
            );

            host.ctl_group3.append(
                ood.create("ood.UI.Input")
                    .setHost(host, "ctl_result")
                    .setDock("fill")
                    .setLeft("3.125em")
                    .setTop("0em")
                    .setMultiLines(true)
                    .setDirtyMark(false)
            );

            host.dlg.append(
                ood.create("ood.UI.Label")
                    .setHost(host, "ctl_slabel1")
                    .setLeft("0.625em")
                    .setTop("0.625em")
                    .setWidth("6.833333333333333em")
                    .setHeight("0.5833333333333334em")
                    .setCaption("$RAD.spabuilder.st_uri")
            );

            host.dlg.append(
                ood.create("ood.UI.Button")
                    .setHost(host, "ctl_sbutton5")
                    .setLeft("27.833333333333332em")
                    .setTop("27.25em")
                    .setWidth("6.875em")
                    .setCaption("$RAD.close")
                    .onClick("_ctl_sbutton5_onclick")
            );

            host.dlg.append(
                ood.create("ood.UI.Button")
                    .setHost(host, "ctl_sbutton6")
                    .setLeft("16.583333333333332em")
                    .setTop("27.25em")
                    .setWidth("10.625em")
                    .setCaption("$RAD.spabuilder.st_createcode")
                    .onClick("_ctl_sbutton6_onclick")
            );

            host.dlg.append(
                ood.create("ood.UI.Button")
                    .setHost(host, "ctl_sbutton15")
                    .setLeft("28.25em")
                    .setTop("14.166666666666666em")
                    .setWidth("13.125em")
                    .setHeight("2.25em")
                    .setCaption("<strong>$RAD.spabuilder.st_send</strong>")
                    .onClick("_ctl_sbutton15_onclick")
            );

            host.dlg.append(
                ood.create("ood.UI.RadioBox")
                    .setHost(host, "ctl_method")
                    .setItems([{
                        "id": "auto",
                        "caption": "Auto"
                    },
                        {
                            "id": "get",
                            "caption": "Get"
                        },
                        {
                            "id": "post",
                            "caption": "Post"
                        }])
                    .setLeft("8.25em")
                    .setTop("14.25em")
                    .setWidth("19.166666666666668em")
                    .setHeight("2.5em")
                    .setValue("auto")
                    .setDirtyMark(false)
            );

            host.dlg.append(
                ood.create("ood.UI.Label")
                    .setHost(host, "ctl_slabel13")
                    .setLeft("0em")
                    .setTop("14.75em")
                    .setWidth("8.25em")
                    .setHeight("0.25em")
                    .setCaption("$RAD.spabuilder.st_method")
            );

            host.dlg.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "ctl_uri")
                    .setLeft("8.25em")
                    .setTop("0.375em")
                    .setWidth("34.833333333333336em")
                    .setValueFormat("^(http|https)\\:")
                    .setType("popbox")
                    .setDirtyMark(false)
                    .setValue("")
                    .onClick("_ctl_uri_onclick")
            );

            return children;
            // ]]Code created by ESDUI RAD Studio
        },
        customAppend: function (parent, subId, left, top) {
            var ns = this;
            ns.dlg.showModal();
            return true;
        },
        init: function (force) {
            var ns = this;
            if (force) {
                ns.ctl_uri.setValue("", true);
            }
            ns.ctl_method.setValue("auto", true);
        },
        _ctl_sbutton5_onclick: function (profile, e, src, value) {
            var ns = this, uictrl = profile.boxing();
            ns.dlg.close();
        },
        _ctl_sbutton15_onclick: function (profile, e, src, value) {
            var ns = this,
                ctrl = profile.boxing(),
                options = {},
                uri = ns.ctl_uri.getValue(),
                str_query = ns.ctl_query.getValue();
            if (uri) {
                var query = ood.unserialize(str_query);
                if (!query) query = {};
                query._rand = ood.rand();
                var method = ns.ctl_method.getValue();
                if (method != 'auto') {
                    options.method = method;
                }
                ctrl.getRoot().onMouseout(true);
                ctrl.setDisabled(true).setCaption("<strong>$RAD.spabuilder.st_sending</strong>");
                ood.request(uri, query || "", function (rsp) {
                    var rspobj = rsp;
                    if (rspobj) {
                        ns.showResult(rspobj);
                    } else {
                        ns.showErr(rsp);
                    }
                    ctrl.setDisabled(false).setCaption("<strong>$RAD.spabuilder.st_send</strong>");
                }, function (rsp) {
                    ns.showErr(rsp);
                    ctrl.setDisabled(false).setCaption("<strong>$RAD.spabuilder.st_send</strong>");
                }, null, options);
            } else {
                ood.message(ood.getRes("RAD.spabuilder.st_nodata"));
            }
        },
        showErr: function (msg) {
            ood.alert(msg);
        },
        showResult: function (obj) {
            var ns = this;
            ns.ctl_result.setValue(ood.Coder.formatText(ood.stringify(obj)), true);
        },
        _ctl_sbutton6_onclick: function (profile, e, src, value) {
            var ns = this, uictrl = profile.boxing(),
                uri = ns.ctl_uri.getValue(),
                str_query = ns.ctl_query.getValue(),
                method = ns.ctl_method.getValue();
            var code = 'ood.request("$1", ' +
                '$2, ' + '\n' +
                'function(rsp){' + '\n' +
                '    var rspobj = rsp;' + '\n' +
                '    if(rspobj){' + '\n' +
                '        // handle result' + '\n' +
                '    }else{' + '\n' +
                '        // handle exception' + '\n' +
                '    }' + '\n' +
                '}, function(rsp){' + '\n' +
                '    // handle exception' + '\n' +
                '}, null, $3);';
            code = code.replace('$1', uri).replace('$2', ood.Coder.formatText(str_query || "")).replace('$3', method == "auto" ? "null" : ("{method:'" + method + "'}"));
            ns.ctl_result.setValue(code, true);
        },
        _dlg_beforeclose: function (profile) {
            this.dlg.hide();
            return false;
        },
        _ctl_uri_onclick: function (profile, node) {
            var ns = this, uictrl = profile.boxing();
            ood.Dom.submit(uictrl.getValue());
        }
    }
});
﻿ood.Class('RAD.SelRenderMode', 'ood.Module',{
    Instance:{
        iniComponents : function(){
            // [[Code created by ESDUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"mainDlg")
                .setLeft("13.125em")
                .setTop("0.625em")
                .setHeight("20.166666666666668em")
                .setResizer(false)
                .setCaption("$RAD.pageEditor.modeDlgCap")
                .setMinBtn(false)
                .setMaxBtn(false)
                .setOverflow("hidden")
            );
            
            host.mainDlg.append(
                ood.create("ood.UI.List")
                .setHost(host,"modeList")
                .setDirtyMark(false)
                .setLeft("0.1875em")
                .setTop("0.3125em")
                .setWidth("23.916666666666668em")
                .setHeight("13.75em")
                .setBorderType("inset")
                .setValue("a")
                .onDblclick("_modelist_ondblclick")
                .setCustomStyle({
                    "EXTRA":"float:right;display:inline;"
                }
                )
                );
            
            host.mainDlg.append(
                ood.create("ood.UI.Button")
                .setHost(host,"ctl_sbutton5")
                .setLeft("13.25em")
                .setTop("14.5em")
                .setWidth("5.166666666666667em")
                .setHeight("2.1666666666666665em")
                .setCaption("$RAD.ok")
                .onClick("_ctl_sbutton5_onclick")
                );
            
            host.mainDlg.append(
                ood.create("ood.UI.Button")
                .setHost(host,"ctl_sbutton26")
                .setLeft("5.75em")
                .setTop("14.5em")
                .setWidth("5.166666666666667em")
                .setHeight("2.1666666666666665em")
                .setCaption("$RAD.cancel")
                .onClick("_ctl_sbutton26_onclick")
                );
            
            return children;
            // ]]Code created by ESDUI RAD Studio
        },
        events:{"onReady":"_com_onready"},
        _com_onready:function (com, threadid){
            var arr=[];
            ood.arr.each(CodeMirror.modeInfo,function(o,i){
                arr.push({
                    id:o.mime+":"+o.mode,
                    mode:o.mode,
                    mime:o.mime,
                    name:o.name,
                    caption:o.name,
                    ext:"<i style='color:#0000ff;'>"+o.mime+"&nbsp;&nbsp;&nbsp;</i>"
                });
            });
            
            this.modeList.setItems(arr).setValue(null,true);
        },
        _ctl_sbutton26_onclick:function (profile, e, src, value){
            var ns = this;
            ns.fireEvent("onSel", [null]);
            ns.mainDlg.close();
        },
        _ctl_sbutton5_onclick:function (profile, e, src, value){
            var ns = this,
                v = ns.modeList.getUIValue(),
                item=ns.modeList.getItemByItemId(v);
            ns.fireEvent("onSel", [item]);
            ns.mainDlg.close();
        },
        _modelist_ondblclick:function (profile, item, e, src){
             this._ctl_sbutton5_onclick();
        }
    }
});

ood.Class('RAD.About', 'ood.Module',{
    Instance:{
        initialize : function(){
        },
        Dependencies:[],
        Required:[],
        properties : {

        },

        events:{},
        functions:{},
        iniComponents : function(){
            // [[Code created by JDSEasy RAD Studio
            var host=this, children=[], properties={}, append=function(child){children.push(child.get(0));};
            ood.merge(properties, this.properties);

            // 使用命令方式组合视图并设置组件属性
            var dialog = ood.create("ood.UI.Dialog");
            dialog.setHost(host,"ood_ui_dialog17");
            dialog.setLeft("9.166666666666666em");
            dialog.setTop("5.833333333333333em");
            dialog.setWidth("32.833333333333336em");
            dialog.setHeight("17.833333333333332em");
            dialog.setResizer(false);
            dialog.setCaption("$RAD.menu.about");
            dialog.setMinBtn(false);
            dialog.setMaxBtn(false);
            dialog.setOverflow("hidden");
            append(dialog);

            host.ood_ui_dialog17.append(
                ood.create("ood.UI.Div")
                    .setHost(host,"ood_ui_div43")
                    .setLeft("1.6666666666666667em")
                    .setTop("0.625em")
                    .setWidth("27.916666666666668em")
                    .setHeight("3.75em")
                    .setHtml("<b><i>onecode<br>" + ood.getRes('RADAbout.description') + "</i></b>")
            );

            host.ood_ui_dialog17.append(
                ood.create("ood.UI.Button")
                    .setHost(host,"ood_ui_button23")
                    .setLeft("11.666666666666666em")
                    .setTop("11.583333333333334em")
                    .setWidth("9.166666666666666em")
                    .setHeight("2.5em")
                    .setZIndex("10")
                    .setCaption("$inline.ok")
                    .onClick([
                        {
                            "desc": ood.getRes('RADAbout.action1'),
                            "type":"page",
                            "target":"RAD.About",
                            "args":[ ],
                            "method":"destroy"
                        }
                    ])
            );

            host.ood_ui_dialog17.append(
                ood.create("ood.UI.Image")
                    .setHost(host,"ood_ui_image13")
                    .setLeft("15.833333333333334em")
                    .setTop("-2.0833333333333335em")
                    .setWidth("3.8333333333333335em")
                    .setHeight("3.4166666666666665em")
                    .setActiveItem("/RAD/img/logo.png")
                    .onClick([
                        {
                            "desc":"url",
                            "type":"other",
                            "target":"url",
                            "params":[
                                "http://www.itjds.com:81"
                            ],
                            "method":"open--_blank"
                        }
                    ])
            );

            host.ood_ui_dialog17.append(
                ood.create("ood.UI.Label")
                    .setHost(host,"ood_ui_label29")
                    .setLeft("5.833333333333333em")
                    .setTop("6.666666666666667em")
                    .setWidth("17.25em")
                    .setCaption(ood.getRes('RADAbout.contact'))
            );

            host.ood_ui_dialog17.append(
                ood.create("ood.UI.Label")
                    .setHost(host,"ood_ui_label30")
                    .setLeft("10.416666666666666em")
                    .setTop("7.916666666666667em")
                    .setWidth("12.666666666666666em")
                    .setHeight("2.4166666666666665em")
                    .setCaption(ood.getRes('RADAbout.wechat'))
            );

            return children;
            // ]]Code created by JDSEasy RAD Studio
        }
    } ,
    Static:{}
});
﻿ood.Class('RAD.GridBorder', 'ood.Module',{
    Instance:{
        iniComponents : function(){
            // [[Code created by EUSUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Block")
                .setHost(host,"mainPane")
                .setLeft("0.8333333333333334em")
                .setTop("0.8333333333333334em")
                .setWidth("19.166666666666668em")
                .setHeight("12em")
                .setShadow(true)
                .setBorderType("flat")
                .setOverflow("hidden")
            );
            
            host.mainPane.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"b_style")
                .setDirtyMark(false)
                .setLeft("0.8333333333333334em")
                .setTop("0.8333333333333334em")
                .setWidth("11.666666666666666em")
                .setDisplay("none")
                .setLabelSize("5em")
                .setLabelGap("auto")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Style")
                .setLabelHAlign("")
                .setHAlign("center")
                .setType("listbox")
                .setItems([
                    {
                        "id":"solid",
                        "caption":"$RAD.custom_dlg.borderdlg.solid"
                    },
                    {
                        "id":"dashed",
                        "caption":"$RAD.custom_dlg.borderdlg.dashed"
                    },
                    {
                        "id":"dotted",
                        "caption":"$RAD.custom_dlg.borderdlg.dotted"
                    },
                    {
                        "id":"double",
                        "caption":"$RAD.custom_dlg.borderdlg.double"
                    }
                ])
                .setShowMode("compact")
                .setValue("solid")
                .afterPopShow("_afterPop")
                );
            
            host.mainPane.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"b_bold")
                .setDirtyMark(false)
                .setLeft("0.8333333333333334em")
                .setTop("4.166666666666667em")
                .setWidth("11.666666666666666em")
                .setDisplay("none")
                .setLabelSize("5em")
                .setLabelGap("auto")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Width")
                .setLabelHAlign("left")
                .setType("counter")
                .setShowMode("compact")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(1)
                .setMax(10)
                .setValue(1)
                );
            
            host.mainPane.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"b_color")
                .setDirtyMark(false)
                .setLeft("1.6666666666666667em")
                .setTop("0.5em")
                .setWidth("15.833333333333334em")
                .setLabelSize("5em")
                .setLabelGap("auto")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Color")
                .setLabelHAlign("left")
                .setType("color")
                .setShowMode("compact")
                .setValue("#000000")
                .afterPopShow("_afterPop")
                );
            
            host.mainPane.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ood_ui_block7")
                .setLeft("0.8333333333333334em")
                .setTop("2.8333333333333335em")
                .setWidth("17.5em")
                .setHeight("8.333333333333334em")
                .setBorderType("flat")
                );
            
            host.ood_ui_block7.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"btn_all")
                .setClassName("ood-css-cyz")
                .setLeft("0.8333333333333334em")
                .setTop("0.5em")
                .setWidth("3.25em")
                .setHeight("3.25em")
                .setCaption("all")
                .onClick("_btn_all_onclick")
                );
            
            host.ood_ui_block7.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"btn_inner")
                .setClassName("ood-css-cyz")
                .setLeft("9.166666666666666em")
                .setTop("0.5em")
                .setWidth("3.25em")
                .setHeight("3.25em")
                .setCaption("inner")
                .onClick("_btn_inner_onclick")
                );
            
            host.ood_ui_block7.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"btn_outer")
                .setClassName("ood-css-cyz")
                .setLeft("5em")
                .setTop("0.5em")
                .setWidth("3.25em")
                .setHeight("3.25em")
                .setCaption("outer")
                .onClick("_btn_outer_onclick")
                );
            
            host.ood_ui_block7.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"btn_none")
                .setClassName("ood-css-cyz")
                .setLeft("13.333333333333334em")
                .setTop("0.5em")
                .setWidth("3.25em")
                .setHeight("3.25em")
                .setCaption("none")
                .onClick("_btn_none_onclick")
                );
            
            host.ood_ui_block7.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"btn_left")
                .setClassName("ood-css-cyz")
                .setLeft("0.8333333333333334em")
                .setTop("4.416666666666667em")
                .setWidth("3.25em")
                .setHeight("3.25em")
                .setCaption("left")
                .onClick("_btn_left_onclick")
                );
            
            host.ood_ui_block7.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"btn_top")
                .setClassName("ood-css-cyz")
                .setLeft("9.166666666666666em")
                .setTop("4.416666666666667em")
                .setWidth("3.25em")
                .setHeight("3.25em")
                .setCaption("top")
                .onClick("_btn_top_onclick")
                );
            
            host.ood_ui_block7.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"btn_right")
                .setClassName("ood-css-cyz")
                .setLeft("5em")
                .setTop("4.416666666666667em")
                .setWidth("3.25em")
                .setHeight("3.25em")
                .setCaption("right")
                .onClick("_btn_right_onclick")
                );
            
            host.ood_ui_block7.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"btn_bottom")
                .setClassName("ood-css-cyz")
                .setLeft("13.333333333333334em")
                .setTop("4.416666666666667em")
                .setWidth("3.25em")
                .setHeight("3.25em")
                .setCaption("bottom")
                .onClick("_btn_bottom_onclick")
                );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood_ui_cssbox1")
                .setClassName("ood-css-cyz")
                .setNormalStatus({
                    "color":"#222222",
                    "background-color":"#F4F5F5",
                    "background-image":"none",
                    "border-top":"none",
                    "border-right":"none",
                    "border-bottom":"none",
                    "border-left":"none",
                    "border-radius":"6px",
                    "text-shadow":"0 -1px 0 #ffffff",
                    "box-shadow":"none",
                    "cursor":"pointer"
                })
            );
            
            return children;
            // ]]Code created by EUSUI RAD Studio
        },
        events:{
            "onReady":"_page_onready"
        },
        _afterPop:function(profile, drop){
            drop.$parentPopMenu = profile.$parentPopMenu;
        },
        _page_onready:function(module, threadid){
            this.fillBtns();
        },
        fillBtns:function(){
            var ns=this,
                makeTable = function(h1,h2,h3,v1,v2,v3){
                    var s = 'width:1em;height:1em;', solid = ':solid 1px #000000;', shadow = ':solid 1px #ccc;';
                    v1 = 'border-left' + (v1?solid:shadow);
                    v2 = 'border-right' + (v2?solid:shadow);
                    v3 = 'border-right' + (v3?solid:shadow);
                    h1 = 'border-top' + (h1?solid:shadow);
                    h2 = 'border-bottom' + (h2?solid:shadow);
                    h3 = 'border-bottom' + (h3?solid:shadow);
                    return '<table style="border-collapse:collapse"><tbody><tr>'+
                        '<td style="'+s+v1+v2+h1+h2+'"></td>'+
                        '<td style="'+s+v3+h1+h2+'"></td>'+ '</tr><tr style="">'+
                        '<td style="'+s+v1+v2+h3+'"></td>'+ 
                        '<td style="'+s+v3+h3+'"></td>'+ '</tr></tbody></table>';
                };
            ns.btn_all.setCaption(makeTable(1,1,1,1,1,1));
            ns.btn_outer.setCaption(makeTable(1,0,1,1,0,1));
            ns.btn_inner.setCaption(makeTable(0,1,0,0,1,0));
            ns.btn_none.setCaption(makeTable());
            ns.btn_left.setCaption(makeTable(0,0,0,1,0,0));
            ns.btn_right.setCaption(makeTable(0,0,0,0,0,1));
            ns.btn_top.setCaption(makeTable(1));
            ns.btn_bottom.setCaption(makeTable(0,0,1,0,0,0));
        },
        _btn_all_onclick:function(profile, e, src){
            this.selectBorder("all");
        },
        _btn_outer_onclick:function(profile, e, src){
            this.selectBorder("outer");
        },
        _btn_inner_onclick:function(profile, e, src){
            this.selectBorder("inner");
        },
        _btn_none_onclick:function(profile, e, src){
            this.selectBorder("none");
        },
        _btn_left_onclick:function(profile, e, src){
            this.selectBorder("left");
        },
        _btn_right_onclick:function(profile, e, src){
            this.selectBorder("right");
        },
        _btn_top_onclick:function(profile, e, src){
            this.selectBorder("top");
        },
        _btn_bottom_onclick:function(profile, e, src){
            this.selectBorder("bottom");
        },
        selectBorder:function(type){
            var ns=this,
                style = ns.b_style.getUIValue(),
                width = ns.b_bold.getUIValue(),
                color = ns.b_color.getUIValue();
            ns.fireEvent("onApplyBorder", [type,style,width,color], ns);
        }
    }
});
ood.Class('RAD.CustomDecoration', 'ood.Module',{
    Instance:{
        initialize : function(){
            this.autoDestroy = true;
            this.properties = {};
        },
        iniComponents : function(){
            // [[Code created by EUSUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"dialog")
                .setLeft("13.125em")
                .setTop("1.25em")
                .setWidth("17.666666666666668em")
                .setHeight("40.416666666666664em")
                .setShadow(false)
                .setResizer(false)
                .setCaption("$(RAD.custom_dlg.Custom Decoration)")
                .setMinBtn(false)
                .setMaxBtn(false)
                .setOverflow("visible")
                .beforeClose("_dialog_beforeclose")
            );
            
            host.dialog.append(
                ood.create("ood.UI.Group")
                .setHost(host,"grpNodes")
                .setLeft("0em")
                .setTop("0.25em")
                .setWidth("16.916666666666668em")
                .setHeight("11.416666666666666em")
                .setCaption("grpNodes")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.TreeView")
                .setHost(host,"tv")
                .setDirtyMark(false)
                .onItemSelected("_tv_onitemselected")
                .setCustomStyle({
                    "BOX":"background-color:transparent;"
                }
                )
                );
            
            host.dialog.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ctl_block3")
                .setLeft("0em")
                .setTop("13.416666666666666em")
                .setWidth("16.916666666666668em")
                .setHeight("23.666666666666668em")
                .setBorderType("inset")
                .setBackground("#fff")
                );
            
            host.ctl_block3.append(
                ood.create("ood.UI.TreeGrid")
                .setHost(host,"tg")
                .setDirtyMark(false)
                .setEditMode("hover")
                .setRowHandler(false)
                .setColSortable(false)
                .setHeader([{
                    "id":"key",
                    "width":"7.5em",
                    "type":"label",
                    "caption":"$RAD.custom_dlg.Attribute"
                },
                {
                    "id":"value",
                    "editable":true,
                    "width":"11.166666666666666em",
                    "flexSize":true,
                    "type":"input",
                    "caption":"$RAD.custom_dlg.Value"
                }])
                .afterCellUpdated("_tg_aftercellupdated")
                .beforeComboPop("_tg_beforeComboPop")
                .setCustomStyle({
                    "SCROLL":{
                        "overflowX":"hidden",
                        "overflowY":"auto"
                    }
                }
                )
                );
            
            host.dialog.append(
                ood.create("ood.UI.Input")
                .setHost(host,"ctl_input1")
                .setReadonly(true)
                .setLeft("0em")
                .setTop("11.666666666666666em")
                .setWidth("16.916666666666668em")
                .setLabelCaption("ctl_input1")
                );
            
            return children;
            // ]]Code created by EUSUI RAD Studio
        },
        customAppend : function(parent, subId, left, top){
             var ns=this,
                prop=ns.properties;

            ns.setTargetProfile(prop.targetProfile);
                        
            ood("body").append(ns.dialog);
            ns.dialog.getRoot()
            .popToTop(prop.src, 2)
            .setBlurTrigger("RAD.CustomDecoration",function(){
                ns.dialog.close();
            });
            
            ns.dialog.activate();

            return true;
        },
        setTargetProfile:function(profile){
            var ns=this,items=[],rootItem;
            var fun=function(hash, subMap, arr, tag){
                var item;
                for(var i in hash){
                    if(i.charAt(0)!='$' && hash[i]){
                        var tagName=(hash[i]&&hash[i].tagName||"span").toLowerCase();
                        if(!/[a-z]/.test(i)){    
                            item={
                                id:i,
                                caption:i+" ["+tagName.toUpperCase()+"]",
                                imageClass:'ri-code-line'
                            };
                            
                            if(subMap && hash[i].text && subMap[(tag?(tag+"."):'')+hash[i].text.replace(/^{(.*)}$/,'$1')]){
                                item.sub=[];
                                var tag=(tag?(tag+"."):'')+hash[i].text.replace(/^{(.*)}$/,'$1');
                                
                                //special for TreeGrid
                                if(tag=='rows.cells')
                                    tag='rows.cells.input';
                                
                                arguments.callee(subMap[tag], subMap, item.sub, tag);
                                if(tagName=="text" && item.sub.length)
                                    item=item.sub[0];
                            }
                            else if(tagName=="text" && !hash[i].svg){
                                continue;
                            }
                            else if(typeof hash[i] == 'object' && tagName!="text"){
                                item.sub=[];
                                arguments.callee(hash[i], subMap, item.sub, tag);
                            }

                            if(!item.sub || !item.sub.length)
                                delete item.sub;
                            arr[arr.length]=item;
                        }
                    }
                };
            };
            var i="_",
                hash=profile.box.$Templates,
                tagName=(hash[i].tagName||"span").toLowerCase();
                
            items.push(rootItem={
                id:"KEY",
                caption:"ROOT" + " ["+tagName.toUpperCase()+"]",
                imageClass:'ri-code-line',
                sub:[]
            });
            
            var subMap = hash[i].$submap;
            if(subMap && hash[i].text && subMap[hash[i].text.replace(/^{(.*)}$/,'$1')]){
                var tag=hash[i].text.replace(/^{(.*)}$/,'$1');
                fun(subMap[tag], subMap, rootItem.sub, tag);
                if(tagName=="text" && rootItem.sub.length)
                    rootItem=rootItem.sub[0];
            }

            fun(hash[i], subMap, rootItem.sub, null);
            if(!rootItem.sub.length)
                delete rootItem.sub;

            ns.grpNodes.setCaption(profile.key.slice(profile.key.lastIndexOf('.')+1) +" : "+profile.alias +" $RAD.custom_dlg.Nodes");
            ns.tv.setTagVar(profile);
            ns.tv.setItems(items);

            ns.tg.updateCellByRowCol('classname','value',{value:""},false,false);
            ns.tg.updateCellByRowCol('font-family','value',{value:"",disabled:tagName=="image"},false,false);
            ns.tg.updateCellByRowCol('font-size','value',{value:"",disabled:tagName=="image"},false,false);
            ns.tg.updateCellByRowCol('font-weight','value',{value:"",disabled:tagName=="image"},false,false);
            ns.tg.updateCellByRowCol('font-style','value',{value:"",disabled:tagName=="image"},false,false);
            ns.tg.updateCellByRowCol('color','value',{value:tagName=="image"?"#EBEADB":"",disabled:tagName=="image"},false,false);
            ns.tg.updateCellByRowCol('background-color','value',{value:""},false,false);
            ns.tg.updateCellByRowCol('background-image','value',{value:""},false,false);
            ns.tg.updateCellByRowCol('background-position','value',{value:""},false,false);
            ns.tg.updateCellByRowCol('background-repeat','value',{value:""},false,false);
            ns.tg.updateCellByRowCol('background-attachment','value',{value:""},false,false);
/*
            ns.tg.updateCellByRowCol('background-size','value',{value:""},false,false);
            ns.tg.updateCellByRowCol('background-origin','value',{value:""},false,false);
            ns.tg.updateCellByRowCol('background-clip','value',{value:""},false,false);
*/
            ns.tg.updateCellByRowCol('border-left','value',{value:""},false,false);
            ns.tg.updateCellByRowCol('border-right','value',{value:""},false,false);
            ns.tg.updateCellByRowCol('border-top','value',{value:""},false,false);
            ns.tg.updateCellByRowCol('border-bottom','value',{value:""},false,false);
            ns.tg.updateCellByRowCol('border-radius','value',{value:""},false,false);
            ns.tg.updateCellByRowCol('padding','value',{value:""},false,false);
            ns.tg.updateCellByRowCol('margin','value',{value:""},false,false);

            ns.tg.updateCellByRowCol('text-decoration','value',{value:"",disabled:tagName=="image"},false,false);
            ns.tg.updateCellByRowCol('text-align','value',{value:"",disabled:tagName=="image"},false,false);
            ns.tg.updateCellByRowCol('text-shadow','value',{value:"",disabled:tagName=="image"},false,false);
            ns.tg.updateCellByRowCol('cursor','value',{value:""},false,false);
            ns.tg.updateCellByRowCol('overflow','value',{value:"",disabled:tagName=="image"},false,false);
            ns.tg.updateCellByRowCol('line-height','value',{value:"",disabled:tagName=="image"},false,false);
            ns.tg.updateCellByRowCol('opacity','value',{value:1},false,false);
            ns.tg.updateCellByRowCol('transform','value',{value:""},false,false);
            ns.tg.updateCellByRowCol('box-shadow','value',{value:""},false,false);
            ns.tg.updateCellByRowCol('$gradient','value',{value:""},false,false);
            ns.tg.updateCellByRowCol('$zoom','value',{value:""},false,false);


            ns.tg.setDisabled(true);
            ns.ctl_input1.setValue("");

            ns.tv.toggleNode('KEY', true, true);
            ns.tv.fireItemClickEvent('KEY');            
        },
        _tv_onitemselected : function (profile, item, e) {
            var ns = this,
                prf=profile.boxing().getTagVar();

            ns.tg.setDisabled(false);
                        
            if(!ns.$coverMark){
                ns.$coverMark=ood.create('<div style="z-index:2000;border:solid 1px;background-color:#ff0000;position:absolute;font-size:0;line-height:0;display:none;">').css('opacity',0.3);
                ood('body').append(ns.$coverMark);
                ns.$coverMarkTask=ood.Thread.repeat(function(){
                    ns.$coverMarkTask.$_mark = !ns.$coverMarkTask.$_mark;
                    ns.$coverMark.css('backgroundColor',ns.$coverMarkTask.$_mark?'#0000ff':'#ff0000');
                    ns.$coverMark.css('border-color',ns.$coverMarkTask.$_mark?'#fff':'#000');
                }, 500);
            }
            if(item.id=='KEY'){
                ns.$coverMark.css('display','none');
                var node=prf.getRootNode();

                var nodeText = "<"+node.tagName+" id='"+node.id+"' class='"+node.className+"' style='"+ood(node).attr('style')+"'>";
                ns.ctl_input1.setValue(nodeText).setTips(nodeText.replace(/</,'&lt;'));
            }else{
                var nodes=prf.getSubNode(item.id,true);
                if(nodes.get(0)){
                    var set=false;
                    nodes.each(function(node){
                        if(node.offsetWidth){
                            var region=ood(node).offset();
                            region.width=node.offsetWidth;
                            region.height=node.offsetHeight;

                            if(region.width<=0)region.width=2;else region.width-=2;
                            if(region.height<=0)region.height=2;else region.height-=2;
                            if(region.width<=0)region.width=2;
                            if(region.height<=0)region.height=2;
                            
                            ns.$coverMark.cssRegion(region).css('display','block');

                            var nodeText = "<"+node.tagName+" id='"+node.id+"' class='"+node.className+"' style='"+ood(node).attr('style')+"'>";
                            ns.ctl_input1.setValue(nodeText).setTips(nodeText.replace(/</,'&lt;'));
                            
                            set=true;
                            return false;
                        }       
                    });
                    if(!set)
                        ns.$coverMark.css('display','none');
                }else{
                    ns.$coverMark.css('display','none');
                }
            }
            
            ns.tg.updateCellByRowCol('classname','value',{value:prf.CC[item.id]||null},false,false);
            
            var cs=prf.CS[item.id],
                csaMap={}, t;
            if(cs){
                if(ood.isStr(cs)){
                    var csa=cs.split(/\s*;+\s*/);
                    ood.arr.each(csa,function(style){
                        if(style){
                            var kv=style.split(/\s*:\s*/);
                            if(kv.length==2){
                                csaMap[kv[0]]=kv[1];
                            }
                        }
                    });
                }else{
                    csaMap=cs;
                }
            }

            ns.tg.updateCellByRowCol('font-family','value',{
                value:csaMap['font-family']||""
            },false,false);
            ns.tg.updateCellByRowCol('font-size','value',{
                value:csaMap['font-size']||""
            },false,false);
            ns.tg.updateCellByRowCol('font-weight','value',{
                value:csaMap['font-weight']||""
            },false,false);
            ns.tg.updateCellByRowCol('font-style','value',{
                value:csaMap['font-style']||""
            },false,false);
            ns.tg.updateCellByRowCol('color','value',{
                value:csaMap['color']||""
            },false,false);
            ns.tg.updateCellByRowCol('background-color','value',{
                value:csaMap['background-color']||""
            },false,false);
            ns.tg.updateCellByRowCol('background-image','value',{
                value:csaMap['background-image']||""
            },false,false);
            ns.tg.updateCellByRowCol('background-position','value',{
                value:csaMap['background-position']||""
            },false,false);
            ns.tg.updateCellByRowCol('background-repeat','value',{
                value:csaMap['background-repeat']||""
            },false,false);
            ns.tg.updateCellByRowCol('background-attachment','value',{
                value:csaMap['background-attachment']||""
            },false,false);
 /*
            ns.tg.updateCellByRowCol('background-size','value',{
                value:csaMap['background-size']||""
            },false,false);
            ns.tg.updateCellByRowCol('background-origin','value',{
                value:csaMap['background-origin']||""
            },false,false);
            ns.tg.updateCellByRowCol('background-clip','value',{
                value:csaMap['background-clip']||""
            },false,false);
*/
            ns.tg.updateCellByRowCol('border-top','value',{
                value:(t=csaMap['border-top'])?t:(t=csaMap['border'])?t:''
            },false,false);
            ns.tg.updateCellByRowCol('border-right','value',{
                value:(t=csaMap['border-right'])?t:(t=csaMap['border'])?t:''
            },false,false);
            ns.tg.updateCellByRowCol('border-bottom','value',{
                value:(t=csaMap['border-bottom'])?t:(t=csaMap['border'])?t:''
            },false,false);
            ns.tg.updateCellByRowCol('border-left','value',{
                value: (t=csaMap['border-left'])?t:(t=csaMap['border'])?t:''
            },false,false);

            ns.tg.updateCellByRowCol('border-radius','value',{
                value:csaMap['border-radius']||""
            },false,false);
            ns.tg.updateCellByRowCol('padding','value',{
                value:(t=csaMap['padding'])?t:((t=(csaMap['padding-top']||'0') + ' ' +(csaMap['padding-right']||'0') + ' ' +(csaMap['padding-bottom']||'0') + ' ' +(csaMap['padding-left']||'0') )!= '0 0 0 0')?t:""
            },false,false);
            ns.tg.updateCellByRowCol('margin','value',{
                value:(t=csaMap['margin'])?t:((t=(csaMap['margin-top']||'0') + ' ' +(csaMap['margin-right']||'0') + ' ' +(csaMap['margin-bottom']||'0') + ' ' +(csaMap['margin-left']||'0') )!= '0 0 0 0')?t:""
            },false,false);
            ns.tg.updateCellByRowCol('text-align','value',{
                value:csaMap['text-align']||""
            },false,false);
            ns.tg.updateCellByRowCol('text-decoration','value',{
                value:csaMap['text-decoration']||""
            },false,false);
            ns.tg.updateCellByRowCol('text-shadow','value',{
                value:csaMap['text-shadow']||""
            },false,false);
            ns.tg.updateCellByRowCol('box-shadow','value',{
                value:csaMap['box-shadow']||""
            },false,false);
            ns.tg.updateCellByRowCol('$gradient','value',{
                value:csaMap['$gradient']||""
            },false,false);
            ns.tg.updateCellByRowCol('$zoom','value',{
                value:csaMap['$zoom']||""
            },false,false);
            ns.tg.updateCellByRowCol('cursor','value',{
                value:csaMap['cursor']||""
            },false,false);
            ns.tg.updateCellByRowCol('overflow','value',{
                value:csaMap['overflow']||""
            },false,false);
            ns.tg.updateCellByRowCol('line-height','value',{
                value:csaMap['line-height']||""
            },false,false);
            ns.tg.updateCellByRowCol('opacity','value',{
                value:(parseFloat(csaMap['opacity'])||parseFloat(csaMap['opacity'])===0)?csaMap['opacity']:1
            },false,false);
            ns.tg.updateCellByRowCol('transform','value',{
                value:csaMap['transform']||""
            },false,false);
             
            profile.boxing().setTag(item.id);
        },
        events : {"beforeShow":"_com_beforeShow", "onDestroy":"_com_ondestroy"},
        _com_beforeShow : function (com, threadid) {
            var ns=this,rows=[],
                  target=ns.properties.targetProfile.boxing(),
                  bcell=function(cell, key){
                    // Give a chance to modify editor setting for value cell
                    window.SPA && SPA.fe("onInitPropValueCell", ['CS:'+ns.tv.getTag(),key, cell.value, "RAD.CustomDecoration", target, cell, ns.tg]);
                    return cell;
                };
            rows.push({id:'classname',cellStyle:"font-weight:bold;",cells:[{id:'class',caption:"$RAD.custom_dlg.classname"},bcell({value:""},"classname")]});

            rows.push({id:'color',cells:[{id:'color',caption:"$RAD.custom_dlg.color"},bcell({
                type:"color"
            },"color")]});
            rows.push({id:'background-color',cells:[{id:'background-color',caption:"$(RAD.custom_dlg.background$-color)"},bcell({
                type:"color"
            },'background-color')]});
            rows.push({id:'background-image',cells:[{id:'background-image',caption:"$(RAD.custom_dlg.background$-image)"},bcell({
                type:CONF.getClientMode() == 'singlepage'?"input":"popbox",
                event : function(profile, cell,editorprf){
                    var node = profile.getSubNode('CELL', cell._serialId),
                        _cb=function(path){
                            editorprf.boxing().setUIValue("url("+CONF.adjustRelativePath(path)+")");
                            node.focus();
                        };
                    if(window.SPA && false===SPA.fe("beforeURISelectorPop", 
                    ['CS:'+ns.tv.getTag()+':background-image', cell.value, _cb,
                        'RAD.CustomDecoration',target,node.get(0), cell, profile.boxing(), editorprf&&editorprf.boxing()
                    ]))return;

                    if(CONF.getClientMode() !='singlepage'){
                        ood.ComFactory.getCom('RAD.ImageSelector',function(){
                            this.setProperties({
                                    fromRegion:node.cssRegion(true),
                                    onOK:function(obj, path){
                                        _cb(path);
                                    }
                            });
                            this.show();
                        });
                    }
                }
            },'background-image')]});
            rows.push({id:'background-position',cells:[{id:'background-position',caption:"$(RAD.custom_dlg.background$-position)"},bcell({
               type:"combobox", editorListItems:CONF.designer_background_position
            },'background-position')]});
            rows.push({id:'background-repeat',cells:[{id:'background-repeat',caption:"$(RAD.custom_dlg.background$-repeat)"},bcell({
               type:"combobox", editorListItems:CONF.designer_background_repeat
            },'background-repeat')]});
            rows.push({id:'background-attachment',cells:[{id:'background-attachment',caption:"$(RAD.custom_dlg.background$-attachment)"},bcell({
               type:"combobox", editorListItems:CONF.designer_background_attachment
            },'background-attachment')]});
/*
            rows.push({id:'background-size',cells:[{id:'background-size',caption:"$(RAD.custom_dlg.background$-size)"},bcell({
               type:"combobox", editorListItems:CONF.designer_background_size
            },'background-size')]});
           rows.push({id:'background-origin',cells:[{id:'background-origin',caption:"$(RAD.custom_dlg.background$-origin)"},bcell({
               type:"combobox", editorListItems:CONF.designer_background_origin
            },'background-origin')]});
            rows.push({id:'background-clip',cells:[{id:'background-clip',caption:"$(RAD.custom_dlg.background$-clip)"},bcell({
               type:"combobox", editorListItems:CONF.designer_background_clip
            },'background-clip')]});
*/
            rows.push({id:'font-family',cells:[{id:'font-family',caption:"$(RAD.custom_dlg.font$-family)"},bcell({
                type:"helpinput", editorListItems:CONF.designer_data_fontfamily
            },'font-family')]});
            rows.push({id:'font-size',cells:[{id:'font-size',caption:"$(RAD.custom_dlg.font$-size)"},bcell({
                type:"combobox", editorListItems:CONF.designer_data_fontsize
            },'font-size')]});
            rows.push({id:'font-weight',cells:[{id:'font-weight',caption:"$(RAD.custom_dlg.font$-weight)"},bcell({
                type:"combobox", editorListItems:CONF.designer_data_fontweight
            },'font-weight')]});
            rows.push({id:'font-style',cells:[{id:'font-style',caption:"$(RAD.custom_dlg.font$-style)"},bcell({
                type:"combobox", editorListItems:CONF.designer_data_fontstyle
            },'font-style')]});
            
            rows.push({id:'border-top',cells:[{id:'border-top',caption:"$(RAD.custom_dlg.border$-top)"},bcell({
                type:"popbox"
            },'border-top')]});
            rows.push({id:'border-right',cells:[{id:'border-right',caption:"$(RAD.custom_dlg.border$-right)"},bcell({
                type:"popbox"
            },'border-right')]});
            rows.push({id:'border-bottom',cells:[{id:'border-bottom',caption:"$(RAD.custom_dlg.border$-bottom)"},bcell({
                type:"popbox"
            },'border-bottom')]});
            rows.push({id:'border-left',cells:[{id:'border-left',caption:"$(RAD.custom_dlg.border$-left)"},bcell({
                type:"popbox"
            },'border-left')]});
            if(ood.Dom.css3Support("border-radius")){
                rows.push({id:'border-radius',cells:[{id:'border-radius',caption:"$(RAD.custom_dlg.border$-radius)"},bcell({
                    type:"popbox"
                },'border-radius')]});
            }
            rows.push({id:'padding',cells:[{id:'padding',caption:"$RAD.custom_dlg.padding"},bcell({
                type:"popbox"
            },'padding')]});
            rows.push({id:'margin',cells:[{id:'margin',caption:"$RAD.custom_dlg.margin"},bcell({
                type:"popbox"
            },'margin')]});
            rows.push({id:'text-align',cells:[{id:'text-align',caption:"$(RAD.custom_dlg.text$-align)"},bcell({
                type:"combobox", editorListItems:CONF.designer_data_textalign
            },'text-align')]});
            rows.push({id:'text-decoration',cells:[{id:'text-decoration',caption:"$(RAD.custom_dlg.text$-decoration)"},bcell({
                type:"combobox", editorListItems:CONF.designer_data_textdecoration
            },'text-decoration')]});
            if(ood.Dom.css3Support("text-shadow")){
                rows.push({id:'text-shadow',cells:[{id:'text-shadow',caption:"$(RAD.custom_dlg.text$-shadow)"},bcell({
                    type:"popbox"
                },'text-shadow')]});
            }
            if(ood.Dom.css3Support("box-shadow")){
                rows.push({id:'box-shadow',cells:[{id:'box-shadow',caption:"$(RAD.custom_dlg.box$-shadow)"},bcell({
                    type:"popbox"
                },'box-shadow')]});
            }
            if(ood.Dom.css3Support("gradient")){
                rows.push({id:'$gradient',cells:[{id:'gradients',caption:"$RAD.custom_dlg.gradients"},bcell({
                    type:"popbox", editorReadonly:true
                },'gradient')]});
            }
            if(ood.Dom.css3Support("transform")){
                rows.push({id:'transform',cells:[{id:'transform',caption:"$RAD.custom_dlg.transform"},bcell({
                    type:"popbox"
                },'transform')]});
            }
            rows.push({id:'$zoom',cells:[{id:'zoom',caption:"$RAD.custom_dlg.zoom"},bcell({
                type:"spin", min:0.1,max:10,increment:0.1,precision:1
            },'zoom')]});
            rows.push({id:'cursor',cells:[{id:'cursor',caption:"$RAD.custom_dlg.cursor"},bcell({
                type:"combobox", editorListItems:CONF.designer_data_cursor
            },'cursor')]});
            rows.push({id:'overflow',cells:[{id:'overflow',caption:"$RAD.custom_dlg.overflow"},bcell({
                type:"combobox", editorListItems:CONF.designer_data_overflow
            },'overflow')]});
            rows.push({id:'line-height',cells:[{id:'line-height',caption:"$(RAD.custom_dlg.line$-height)"},bcell({
                type:"combobox", editorListItems:[1,1.22,1.5,2]
            },'lien-height')]});
            if(ood.Dom.css3Support("opacity")){
                rows.push({id:'opacity',cells:[{id:'opacity',caption:"$RAD.custom_dlg.opacity"},bcell({
                    type:"progress", editorProperties:{
                        min:0,max:1
                    }
                },'opacity')]});
            }
            // Give a chance to modify editor setting for rows
            window.SPA && SPA.fe("onInitEditorRows", ['CS', null, ns.properties.targetProfile.CS, 
                'RAD.CustomDecoration', ns.properties.targetProfile,  rows, ns.tg]);

            ns.tg.setRows(rows);
        },
        _ctl_sbutton1_onclick : function (profile) {
            this.setTargetProfile(this.ctl_panel3.get(0));
        },
        _ctl_sbutton37_onclick : function (profile, e, src, value) {
            this.setTargetProfile(this.ctl_tabs2.get(0));
        },
        _com_ondestroy : function (com) {
            if(this.$coverMark)
                this.$coverMark.remove();
            if(this.$coverMarkTask)
                this.$coverMarkTask.abort();
        },
        _dialog_beforeclose : function (profile) {
            this.dialog.getRoot().setBlurTrigger("RAD.CustomDecoration");
            profile.boxing().hide();
            this.$coverMark.css('display','none');
            this.tv.setValue(null,true);
            this.fireEvent('onFinished');
            return false;
        },
        _tg_beforeComboPop:function(profile, cell, editorprf, pos, e, src){
            var ns=this,
                prf=ns.tv.getTagVar(),
                tplKey=ns.tv.getTag(),
                cls;
 
            if(window.SPA && false===SPA.fe("beforeEditorComboPop", [
                'CS:'+tplKey, cell._row.id, cell.value, function(value){
                    editorprf.boxing().setUIValue(value||"",true);
                }, "RAD.CustomDecoration", ns.properties.targetProfile.boxing(), pos, profile.getSubNode('CELL', cell._serialId).get(0), cell, ns.tg ,editorprf&&editorprf.boxing()
                ] ))return false;

            switch(cell._row.id){
                case "border-top":
                case "border-right":
                case "border-bottom":
                case "border-left":
                case "border-radius":
                case "padding":
                case "margin":
                    cls="RAD.CustomBorder";
                    break;
                case "text-shadow":
                    cls="RAD.CustomTextShadow";
                    break;
                case "box-shadow":
                    cls="RAD.CustomBoxShadow";
                    break;
                case "transform":
                    cls="RAD.CustomTransform";
                    break;
                case "$gradient":
                    cls="RAD.CustomGradients";
                    break;
            }
            if(cls){
                ood.ComFactory.getCom(cls,function(){
                    this.init(prf,tplKey,{
                        pro:editorprf,
                        cell:cell,
                        isSvg:0,
                        grid:ns.tg
                    });
                    this.setEvents({
                        onChange:function(str){
                            switch(cell._row.id){
                                case "border-top":
                                    editorprf.boxing().setUIValue(str['border']['top']||"",true);
                                    break;
                                case "border-right":
                                    editorprf.boxing().setUIValue(str['border']['right']||"",true);
                                    break;
                                case "border-bottom":
                                    editorprf.boxing().setUIValue(str['border']['bottom']||"",true);
                                    break;
                                case "border-left":
                                    editorprf.boxing().setUIValue(str['border']['left']||"",true);
                                    break;
                                case "border-radius":
                                case "padding":
                                case "margin":
                                    editorprf.boxing().setUIValue(str[cell._row.id]||"",true);
                                    break;
                                default:
                                    editorprf.boxing().setUIValue(str?ood.isStr(str)?str:"[object]":"",true);
                            }
                            switch(cell._row.id){
                                case "border-top":
                                case "border-right":
                                case "border-bottom":
                                case "border-left":
                                case "border-radius":
                                case "padding":
                                case "margin":
                                    profile.boxing().updateCellByRowCol('padding','value',{value:str['padding']||""},false,true);
                                    profile.boxing().updateCellByRowCol('margin','value',{value:str['margin']||""},false,true);
                                    profile.boxing().updateCellByRowCol('border-radius','value',{value:str['border-radius']||""},false,true);
                                    profile.boxing().updateCellByRowCol('border-left','value',{value:str['border']['left']||""},false,true);
                                    profile.boxing().updateCellByRowCol('border-right','value',{value:str['border']['right']||""},false,true);
                                    profile.boxing().updateCellByRowCol('border-top','value',{value:str['border']['top']||""},false,true);
                                    profile.boxing().updateCellByRowCol('border-bottom','value',{value:str['border']['bottom']||""},false,true);
                                    break;
                                default:
                                    profile.boxing().updateCell(cell,{value:str||""},false,true);
                                    if(ood.isHash(str)){
                                        profile.boxing().updateCell(cell,{caption:"[object]"},false,true);
                                    }
                                    if(ood.isNull(str)){
                                            profile.boxing().updateCell(cell,{caption:""},false,true);
                                    }
                            }
                        }
                    });
                    this.render();
                    var r=this.mainPane.getRoot();
                    r.popToTop(editorprf.getRoot());
                    r.setBlurTrigger(r.$xid, function(){
                        r.setBlurTrigger(r.$xid);
                        r.hide();
                    });
                    editorprf.boxing().setPopWnd(this);
                });
            }
        },
        _tg_aftercellupdated : function (profile, cell, options) {
            if("value" in options){
                var ns=this,
                    grid=ns.tg,
                    prf=ns.tv.getTagVar(),
                    tplKey=ns.tv.getTag();
                if(prf && tplKey){
                    var className="",
                        hash={},
                        cells=grid.getCells(null,'value');
                    
                    ood.each(cells,function(cell){
                        if(cell._row.id=="classname"){
                            if(ood.str.trim(cell.value)!=="")
                                className=ood.str.trim(cell.value);
                        }else{
                            var v="",rid=cell._row.id;
                            if(rid=="$gradient"){
                                hash[rid]=cell.value;
                                if(!cell.value)delete hash[rid];
                            }else if(rid=="$zoom"){
                                if(parseFloat(cell.value)!==1.0){
                                    v=parseFloat(cell.value);
                                    hash[rid]=v;
                                    if(v==1)delete hash[rid];
                                }
                            }else if(rid=="opacity"){
                                if(parseFloat(cell.value)!==1.0){
                                    v=parseFloat(cell.value);
                                    hash[rid]=v;
                                    if(v==1)delete hash[rid];
                                }
                            }else if(ood.isStr(cell.value) && ood.str.trim(cell.value)!==""){
                                v=ood.str.trim(cell.value);
                                hash[rid]=v;
                            }
                        }
                    });
                    // custom class
                    prf.boxing().setCustomClass(tplKey, className||null);
                    // custom style
                    prf.boxing().setCustomStyle(tplKey, ood.isEmpty(hash)?null:hash);
                    
                    // try to resize it
                   //ood.UI.$tryResize(prf, prf.properties.width, prf.properties.height,true);
                    // adjust  
                    prf.boxing().reLayout();

                    // try to pos+size resizer
                    ns.properties.page.resizer.rePosSize();
                    
                    ns.fireEvent('onDirty');
                }
            }
        }
    }
});
﻿ood.Class('RAD.CustomDecoration2', 'ood.Module',{
    Instance:{
        initialize : function(){
            this.autoDestroy = true;
            this.properties = {};
        },
        iniComponents : function(){
            // [[Code created by EUSUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"dialog")
                .setLeft("17.5em")
                .setTop("1.6666666666666667em")
                .setWidth("39.166666666666664em")
                .setHeight("37.5em")
                .setShadow(false)
                .setResizer(false)
                .setMinBtn(false)
                .setMaxBtn(false)
                .setOverflow("visible")
                .beforeClose("_dialog_beforeclose")
            );
            
            host.dialog.append(
                ood.create("ood.UI.Group")
                .setHost(host,"grpNodes")
                .setLeft("12.166666666666666em")
                .setTop("0.25em")
                .setWidth("26.083333333333332em")
                .setHeight("17.3333em")
                .setOverflow("hidden")
                .setCaption("$(RAD.custom_dlg.Gradient Patterns)")
                .setToggleBtn(false)
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton6")
                .setClassName("ood-predifined-css-1")
                .setLeft("0.5833333333333334em")
                .setTop("0.833333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton19")
                .setClassName("ood-predifined-css-2")
                .setLeft("5.583333333333333em")
                .setTop("0.833333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton20")
                .setClassName("ood-predifined-css-3")
                .setLeft("10.583333333333334em")
                .setTop("0.833333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton21")
                .setClassName("ood-predifined-css-4")
                .setLeft("15.666666666666666em")
                .setTop("0.833333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton22")
                .setClassName("ood-predifined-css-5")
                .setLeft("20.666666666666668em")
                .setTop("0.833333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton23")
                .setClassName("ood-predifined-css-6")
                .setLeft("0.5833333333333334em")
                .setTop("3.83333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton24")
                .setClassName("ood-predifined-css-7")
                .setLeft("5.583333333333333em")
                .setTop("3.83333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton25")
                .setClassName("ood-predifined-css-8")
                .setLeft("10.583333333333334em")
                .setTop("3.83333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton26")
                .setClassName("ood-predifined-css-9")
                .setLeft("15.666666666666666em")
                .setTop("3.83333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton27")
                .setClassName("ood-predifined-css-10")
                .setLeft("20.666666666666668em")
                .setTop("3.83333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton28")
                .setClassName("ood-predifined-css-11")
                .setLeft("0.5833333333333334em")
                .setTop("6.83333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton29")
                .setClassName("ood-predifined-css-12")
                .setLeft("5.583333333333333em")
                .setTop("6.83333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton30")
                .setClassName("ood-predifined-css-13")
                .setLeft("10.583333333333334em")
                .setTop("6.83333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton31")
                .setClassName("ood-predifined-css-14")
                .setLeft("15.666666666666666em")
                .setTop("6.83333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton32")
                .setClassName("ood-predifined-css-15")
                .setLeft("20.666666666666668em")
                .setTop("6.83333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton33")
                .setClassName("ood-predifined-css-16")
                .setLeft("0.5833333333333334em")
                .setTop("9.83333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton34")
                .setClassName("ood-predifined-css-17")
                .setLeft("5.583333333333333em")
                .setTop("9.83333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton35")
                .setClassName("ood-predifined-css-18")
                .setLeft("10.583333333333334em")
                .setTop("9.83333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton36")
                .setClassName("ood-predifined-css-19")
                .setLeft("15.666666666666666em")
                .setTop("9.83333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton37")
                .setClassName("ood-predifined-css-20")
                .setLeft("20.666666666666668em")
                .setTop("9.83333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton38")
                .setClassName("ood-predifined-css-21")
                .setLeft("0.5833333333333334em")
                .setTop("12.8333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton39")
                .setClassName("ood-predifined-css-22")
                .setLeft("5.583333333333333em")
                .setTop("12.8333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton40")
                .setClassName("ood-predifined-css-23")
                .setLeft("10.583333333333334em")
                .setTop("12.8333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton41")
                .setClassName("ood-predifined-css-24")
                .setLeft("15.666666666666666em")
                .setTop("12.8333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.HTMLButton")
                .setHost(host,"ctl_htmlbutton42")
                .setClassName("ood-predifined-css-25")
                .setLeft("20.666666666666668em")
                .setTop("12.8333em")
                .setWidth("4.75em")
                .setHeight("2.5em")
                .setHtml("$RAD.custom_dlg.Text")
                .onClick("_btnclick")
                );
            
            host.dialog.append(
                ood.create("ood.UI.Group")
                .setHost(host,"ctl_group11")
                .setLeft("0.3333333333333333em")
                .setTop("0.25em")
                .setWidth("11em")
                .setHeight("17.3333em")
                .setOverflow("hidden")
                .setCaption("$(RAD.custom_dlg.Color Patterns)")
                .setToggleBtn(false)
                .setCustomStyle({
                    "PANEL":"padding:2px;"
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr1")
                .setTagVar({
                    "clr1":"#4BA3CC",
                    "clr2":"#3289B2",
                    "clr3":"#3899C6 ",
                    "clr4":"#2D7A9E",
                    "boxshadow1":"#87C1DD",
                    "boxshadow2":"#297192"
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #3899C6",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#4ba3cc"
                            },
                            {
                                "pos":"100%",
                                "clr":"#3289B2"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr2")
                .setTagVar({
                    "clr1":"#A5B8DA",
                    "clr2":"#7089B3",
                    "clr3":"#819bcb",
                    "clr4":"#536f9d",
                    "boxshadow1":"#87C1DD",
                    "boxshadow2":"#297192"
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #819bcb",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#A5B8DA"
                            },
                            {
                                "pos":"100%",
                                "clr":"#7089B3"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr3")
                .setTagVar({
                    "clr1":"#ffd65e",
                    "clr2":"#febf04",
                    "clr3":"#ffd65e",
                    "clr4":"#ce9a01",
                    "boxshadow1":"#FFEC93",
                    "boxshadow2":"#B28C00"
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #ffc926",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#ffd65e"
                            },
                            {
                                "pos":"100%",
                                "clr":"#febf04"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr4")
                .setTagVar({
                    "clr1":"#606c88",
                    "clr2":"#3f4c6b",
                    "clr3":"#4b546a",
                    "clr4":"#2c354b",
                    "boxshadow1":"#A7AEC2",
                    "boxshadow2":"#272742"
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #4b546a",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#606c88"
                            },
                            {
                                "pos":"100%",
                                "clr":"#3f4c6b"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr5")
                .setTagVar({
                    "clr1":"#d5cea6",
                    "clr2":"#b7ad70",
                    "clr3":"#c5bb83",
                    "clr4":"#a29752",
                    "boxshadow1":"#E1E1B6",
                    "boxshadow2":"#8C8F42"
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #c5bb83",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#d5cea6"
                            },
                            {
                                "pos":"100%",
                                "clr":"#b7ad70"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr6")
                .setTagVar({
                    "clr1":"#a90329",
                    "clr2":"#6d0019",
                    "clr3":"#77021d",
                    "clr4":"#3a000d",
                    "boxshadow1":"#D9D961",
                    "boxshadow2":"#000000"
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #77021d",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#a90329"
                            },
                            {
                                "pos":"100%",
                                "clr":"#6d0019"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr7")
                .setTagVar({
                    "clr1":"#4ba614",
                    "clr2":"#008c00",
                    "clr3":"#36780f",
                    "clr4":"#005900",
                    "boxshadow1":"#9FD53E",
                    "boxshadow2":"#002F00"
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #36780f",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#4ba614"
                            },
                            {
                                "pos":"100%",
                                "clr":"#008c00"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr8")
                .setTagVar({
                    "clr1":"#ff5db1",
                    "clr2":"#ef007c",
                    "clr3":"#ff2a98",
                    "clr4":"#bc0062",
                    "boxshadow1":"#FFBAE8",
                    "boxshadow2":"#880037"
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #ff2a98",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#ff5db1"
                            },
                            {
                                "pos":"100%",
                                "clr":"#ef007c"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span500")
                .setTagVar({
                    "clr1":"#7d7e7d",
                    "clr2":"#0e0e0e",
                    "clr3":"#646464",
                    "clr4":"#282828",
                    "boxshadow1":"#C9C9CD",
                    "boxshadow2":"#121212"
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #819bcb",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#7d7e7d"
                            },
                            {
                                "pos":"100%",
                                "clr":"#0e0e0e"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span501")
                .setTagVar({
                    "clr1":"#cef8ff",
                    "clr2":"#7fe0f8",
                    "clr3":"#9bf1ff",
                    "clr4":"#4fd4f5",
                    "boxshadow1":"#ffffff",
                    "boxshadow2":"#239397 "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #9bf1ff",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#cef8ff"
                            },
                            {
                                "pos":"100%",
                                "clr":"#7fe0f8"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span502")
                .setTagVar({
                    "clr1":"#f2f9fe",
                    "clr2":"#d6f0fd",
                    "clr3":"#c3e3fa",
                    "clr4":"#a5defb",
                    "boxshadow1":"#ffffff",
                    "boxshadow2":"#6884FF "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #c3e3fa",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#f2f9fe"
                            },
                            {
                                "pos":"100%",
                                "clr":"#d6f0fd"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span503")
                .setTagVar({
                    "clr1":"#fb83fa",
                    "clr2":"#e93cec",
                    "clr3":"#f952f8",
                    "clr4":"#dc16df",
                    "boxshadow1":"#FDD9FA",
                    "boxshadow2":"#5908C9 "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #f952f8",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#fb83fa"
                            },
                            {
                                "pos":"100%",
                                "clr":"#e93cec"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span504")
                .setTagVar({
                    "clr1":"#3093c7",
                    "clr2":"#1c5a85",
                    "clr3":"#26759e",
                    "clr4":"#133d5b",
                    "boxshadow1":"#65B6EC",
                    "boxshadow2":"#04233A "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #26759e",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#3093c7"
                            },
                            {
                                "pos":"100%",
                                "clr":"#1c5a85"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span505")
                .setTagVar({
                    "clr1":"#a9db80",
                    "clr2":"#96c56f",
                    "clr3":"#8ed058",
                    "clr4":"#7bb64b",
                    "boxshadow1":"#C9F0B6",
                    "boxshadow2":"#598F33 "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #8ed058",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#a9db80"
                            },
                            {
                                "pos":"100%",
                                "clr":"#96c56f"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span506")
                .setTagVar({
                    "clr1":"#cef8ff",
                    "clr2":"#7fe0f8",
                    "clr3":"#9bf1ff",
                    "clr4":"#4fd4f5",
                    "boxshadow1":"#ffffff",
                    "boxshadow2":"#239397 "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #819bcb",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#A5B8DA"
                            },
                            {
                                "pos":"100%",
                                "clr":"#7089B3"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span507")
                .setTagVar({
                    "clr1":"#b29af8",
                    "clr2":"#9174ed",
                    "clr3":"#8e6af5",
                    "clr4":"#6d47e7",
                    "boxshadow1":"#4E2B78",
                    "boxshadow2":"#239397 "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #8e6af5",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#b29af8"
                            },
                            {
                                "pos":"100%",
                                "clr":"#9174ed"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span508")
                .setTagVar({
                    "clr1":"#f2f5f6",
                    "clr2":"#c8d7dc",
                    "clr3":"#d4dee1",
                    "clr4":"#a9c0c8",
                    "boxshadow1":"#ffffff",
                    "boxshadow2":"#699B9F "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #d4dee1",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#f2f5f6"
                            },
                            {
                                "pos":"100%",
                                "clr":"#c8d7dc"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span509")
                .setTagVar({
                    "clr1":"#ffc579",
                    "clr2":"#fb9d23",
                    "clr3":"#ffaf46",
                    "clr4":"#e78404",
                    "boxshadow1":"#FFE8B6",
                    "boxshadow2":"#885D00 "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #ffaf46",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#ffc579"
                            },
                            {
                                "pos":"100%",
                                "clr":"#fb9d23"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span510")
                .setTagVar({
                    "clr1":"#d3d3d3",
                    "clr2":"#707070",
                    "clr3":"#bababa",
                    "clr4":"#575757",
                    "boxshadow1":"#E8E8E8",
                    "boxshadow2":"#373737 "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #bababa",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#d3d3d3"
                            },
                            {
                                "pos":"100%",
                                "clr":"#707070"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span511")
                .setTagVar({
                    "clr1":"#fcfac0",
                    "clr2":"#f6f283",
                    "clr3":"#faf68f",
                    "clr4":"#f3ed53",
                    "boxshadow1":"#FFFFE8",
                    "boxshadow2":"#C2CD3A "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #faf68f",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#fcfac0"
                            },
                            {
                                "pos":"100%",
                                "clr":"#f6f283"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span512")
                .setTagVar({
                    "clr1":"#f4f5f5",
                    "clr2":"#dfdddd",
                    "clr3":"#d9dddd",
                    "clr4":"#c6c3c3",
                    "boxshadow1":"#ffffff",
                    "boxshadow2":"#8C8989 "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #d9dddd",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#f4f5f5"
                            },
                            {
                                "pos":"100%",
                                "clr":"#dfdddd"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span513")
                .setTagVar({
                    "clr1":"#f7e3e3",
                    "clr2":"#ffd7d7",
                    "clr3":"#ecbbbb",
                    "clr4":"#ffa4a4",
                    "boxshadow1":"#ffffff",
                    "boxshadow2":"#887178 "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #ecbbbb",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#f7e3e3"
                            },
                            {
                                "pos":"100%",
                                "clr":"#ffd7d7"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span514")
                .setTagVar({
                    "clr1":"#ff9a9a",
                    "clr2":"#ff4040",
                    "clr3":"#ff6767",
                    "clr4":"#ff0d0d",
                    "boxshadow1":"#FFC2D9",
                    "boxshadow2":"#AE0000 "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #ff6767",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#ff9a9a"
                            },
                            {
                                "pos":"100%",
                                "clr":"#ff4040"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span515")
                .setTagVar({
                    "clr1":"#a9a588",
                    "clr2":"#8e865b",
                    "clr3":"#938e6b",
                    "clr4":"#6f6947",
                    "boxshadow1":"#D5C2B2",
                    "boxshadow2":"#42331C "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #938e6b",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#a9a588"
                            },
                            {
                                "pos":"100%",
                                "clr":"#8e865b"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span516")
                .setTagVar({
                    "clr1":"#f62b2b",
                    "clr2":"#d20202",
                    "clr3":"#e40a0a",
                    "clr4":"#9f0202",
                    "boxshadow1":"#FF938C",
                    "boxshadow2":"#610000 "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #e40a0a",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#f62b2b"
                            },
                            {
                                "pos":"100%",
                                "clr":"#d20202"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span517")
                .setTagVar({
                    "clr1":"#a67939",
                    "clr2":"#845108",
                    "clr3":"#805d2c",
                    "clr4":"#543305",
                    "boxshadow1":"#E1BA8C",
                    "boxshadow2":"#1F1800 "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #805d2c",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#a67939"
                            },
                            {
                                "pos":"100%",
                                "clr":"#845108"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span518")
                .setTagVar({
                    "clr1":"#d2d2f9",
                    "clr2":"#a6a6f2",
                    "clr3":"#a5a5f3",
                    "clr4":"#7a7aeb",
                    "boxshadow1":"#ffffff",
                    "boxshadow2":"#273A8F "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #a5a5f3",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#d2d2f9"
                            },
                            {
                                "pos":"100%",
                                "clr":"#a6a6f2"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span519")
                .setTagVar({
                    "clr1":"#49c0f0",
                    "clr2":"#2cafe3",
                    "clr3":"#1ab0ec",
                    "clr4":"#1a92c2",
                    "boxshadow1":"#8FECFF",
                    "boxshadow2":"#005D71 "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #1ab0ec",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#49c0f0"
                            },
                            {
                                "pos":"100%",
                                "clr":"#2cafe3"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span520")
                .setTagVar({
                    "clr1":"#cedce7",
                    "clr2":"#596a72",
                    "clr3":"#acc4d6",
                    "clr4":"#434f55",
                    "boxshadow1":"#ffffff",
                    "boxshadow2":"#182F33 "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #acc4d6",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#cedce7"
                            },
                            {
                                "pos":"100%",
                                "clr":"#596a72"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span521")
                .setTagVar({
                    "clr1":"#b6e026",
                    "clr2":"#abdc28",
                    "clr3":"#95b91a",
                    "clr4":"#8bb41d",
                    "boxshadow1":"#C9EC78",
                    "boxshadow2":"#4E550C "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #95b91a",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#b6e026"
                            },
                            {
                                "pos":"100%",
                                "clr":"#abdc28"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span522")
                .setTagVar({
                    "clr1":"#eab92d",
                    "clr2":"#c79810",
                    "clr3":"#cf9f15",
                    "clr4":"#98740c",
                    "boxshadow1":"#F8D980",
                    "boxshadow2":"#524600 "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #cf9f15",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#eab92d"
                            },
                            {
                                "pos":"100%",
                                "clr":"#c79810"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span523")
                .setTagVar({
                    "clr1":"#45484d",
                    "clr2":"#000000",
                    "clr3":"#9bf1ff",
                    "clr4":"#1a1a1a",
                    "boxshadow1":"#9F9F9B",
                    "boxshadow2":"#000 "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #819bcb",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#45484d"
                            },
                            {
                                "pos":"100%",
                                "clr":"#000000"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span524")
                .setTagVar({
                    "clr1":"#6bbed2",
                    "clr2":"#76bdd1",
                    "clr3":"#6bbed2",
                    "clr4":"#50abc4",
                    "boxshadow1":"#C6E8F8",
                    "boxshadow2":"#275588 "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #6bbed2",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#6bbed2"
                            },
                            {
                                "pos":"100%",
                                "clr":"#76bdd1"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span525")
                .setTagVar({
                    "clr1":"#6bbed2",
                    "clr2":"#23538a",
                    "clr3":"#82bbd1",
                    "clr4":"#193b61",
                    "boxshadow1":"#ffffff",
                    "boxshadow2":"#001F33 "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #82bbd1",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#6bbed2"
                            },
                            {
                                "pos":"100%",
                                "clr":"#23538a"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span760")
                .setTagVar({
                    "clr1":"#e6e6e6",
                    "clr2":"#cccccc",
                    "clr3":"#a3a3a3",
                    "clr4":"#999",
                    "boxshadow1":"#ffffff",
                    "boxshadow2":"#444 "
                }
                )
                .setWidth("1.6666666666666667em")
                .setHeight("1.6666666666666667em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border":"1px solid #e6e6e6",
                        "border-radius":"6px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#e6e6e6"
                            },
                            {
                                "pos":"100%",
                                "clr":"#cccccc"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.dialog.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ctl_block3")
                .setLeft("0.5em")
                .setTop("20.833333333333332em")
                .setWidth("37.5833em")
                .setHeight("13.333333333333334em")
                .setBorderType("inset")
                .setBackground("#ffffff")
                );
            
            host.ctl_block3.append(
                ood.create("ood.UI.TreeGrid")
                .setHost(host,"tg")
                .setDirtyMark(false)
                .setRowHandler(false)
                .setColResizer(false)
                .setColSortable(false)
                .setHeader([{
                    "id":"key",
                    "caption":"$RAD.custom_dlg.Attribute",
                    "width":"7em",
                    "type":"label"
                },
                {
                    "id":"normal",
                    "caption":"$RAD.custom_dlg.normal",
                    "width":"7em",
                    "flexSize":true,
                    "type":"input",
                    "editable":true
                },
                {
                    "id":"hover",
                    "caption":"$RAD.custom_dlg.hover",
                    "width":"7em",
                    "flexSize":true,
                    "type":"input",
                    "editable":true
                },
                {
                    "id":"active",
                    "caption":"$RAD.custom_dlg.active",
                    "width":"7em",
                    "flexSize":true,
                    "type":"input",
                    "editable":true
                },
                {
                    "id":"focus",
                    "caption":"$RAD.custom_dlg.focus",
                    "width":"7em",
                    "flexSize":true,
                    "type":"input",
                    "editable":true
                }])
                .afterCellUpdated("_tg_aftercellupdated")
                .beforeComboPop("_tg_beforeComboPop")
                .setCustomStyle({
                    "SCROLL":{
                        "overflowX":"hidden",
                        "overflowY":"auto"
                    }
                }
                )
                );
            
            host.dialog.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ood_ui_block6")
                .setLeft("0.8333333333333334em")
                .setTop("19.166666666666668em")
                .setWidth("36.666666666666664em")
                .setHeight("0em")
                .setZIndex(0)
                );
            
            host.dialog.append(
                ood.create("ood.UI.StatusButtons")
                .setHost(host,"ood_ui_statusbuttons3")
                .setDirtyMark(false)
                .setItems([{
                    "id":"normal",
                    "caption":"$RAD.custom_dlg.normal",
                    "disabled":true
                },
                {
                    "id":"hover",
                    "caption":"$RAD.custom_dlg.hover"
                },
                {
                    "id":"active",
                    "caption":"$RAD.custom_dlg.active"
                },
                {
                    "id":"focus",
                    "caption":"$RAD.custom_dlg.focus"
                }])
                .setDock("center")
                .setLeft("4.083333333333333em")
                .setTop("17.916666666666668em")
                .setWidth("auto")
                .setHeight("auto")
                .setSelMode("multi")
                .setBorderType("none")
                .setLabelGap("0.3333333333333333em")
                .setItemWidth("6em")
                .setValue("active;focus;hover;normal")
                .onChange("_ood_ui_statusbuttons3_onchange")
                );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-25")
                .setClassName("ood-predifined-css-25")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-12")
                .setClassName("ood-predifined-css-12")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-24")
                .setClassName("ood-predifined-css-24")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-7")
                .setClassName("ood-predifined-css-7")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-5")
                .setClassName("ood-predifined-css-5")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-3")
                .setClassName("ood-predifined-css-3")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-10")
                .setClassName("ood-predifined-css-10")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-13")
                .setClassName("ood-predifined-css-13")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-1")
                .setClassName("ood-predifined-css-1")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-8")
                .setClassName("ood-predifined-css-8")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-2")
                .setClassName("ood-predifined-css-2")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-15")
                .setClassName("ood-predifined-css-15")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-22")
                .setClassName("ood-predifined-css-22")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-11")
                .setClassName("ood-predifined-css-11")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-18")
                .setClassName("ood-predifined-css-18")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-20")
                .setClassName("ood-predifined-css-20")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-14")
                .setClassName("ood-predifined-css-14")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-16")
                .setClassName("ood-predifined-css-16")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-21")
                .setClassName("ood-predifined-css-21")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-19")
                .setClassName("ood-predifined-css-19")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-4")
                .setClassName("ood-predifined-css-4")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-6")
                .setClassName("ood-predifined-css-6")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-23")
                .setClassName("ood-predifined-css-23")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-9")
                .setClassName("ood-predifined-css-9")
            );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ood-predifined-css-17")
                .setClassName("ood-predifined-css-17")
            );
            
            return children;
            // ]]Code created by EUSUI RAD Studio
        },
        customAppend : function(parent, subId, left, top){
            var ns=this,
                prop=ns.properties;

            ns.setTargetProfile(prop.targetProfile);

            ood("body").append(ns.dialog);
            ns.dialog.getRoot()
            .popToTop(prop.src, 2)
            .setBlurTrigger("RAD.CustomDecoration2",function(){
                ns.dialog.close();
            });
            
            ns.clr1.getRoot().onClick(true);
            
            ns.dialog.activate();

            return true;
        },
        _attr:['font-family','font-size','font-weight','font-style','color','background-color','background-image',
               'background-position','background-repeat','background-attachment',
               //'background-size','background-origin','background-clip',
               'border-top','border-right','border-bottom','border-left','border-radius','padding','margin',
                'text-align','text-decoration','text-shadow','box-shadow','$gradient','cursor','overflow','line-height'//,'transform'
              ],
        setTargetProfile:function(profile){
            var ns=this, arr=['normal'],
                prop=profile.properties,
                mapNormal=prop.normalStatus,
                mapHover=prop.hoverStatus,
                mapActive=prop.activeStatus,
                mapFocus=prop.focusStatus;

            if(!ood.isEmpty(mapHover))arr.push('hover');
            if(!ood.isEmpty(mapActive))arr.push('active');
            if(mapFocus && !ood.isEmpty(mapFocus))arr.push('focus');

            ns._targetPrf=profile;
            if(profile['ood.UIProfile'])profile.getRoot().css({left:'10px',top:'10px',visibility:'visible',display:'block'}).topZindex(true);
            ood.arr.each(ns._attr,function(key){
                ns.tg.updateCellByRowCol(key,'normal',{value:mapNormal[key]||"", caption:ood.isHash(mapNormal[key])?'[object]':null},false,false);
                ns.tg.updateCellByRowCol(key,'hover',{value:mapHover[key]||"", caption:ood.isHash(mapHover[key])?'[object]':null},false,false);
                ns.tg.updateCellByRowCol(key,'active',{value:mapActive[key]||"", caption:ood.isHash(mapActive[key])?'[object]':null},false,false);
                if(mapFocus)ns.tg.updateCellByRowCol(key,'focus',{value:mapFocus[key]||"", caption:ood.isHash(mapFocus[key])?'[object]':null},false,false);
            });
            var opacity=(parseFloat(mapNormal.opacity)||parseFloat(mapNormal.opacity)===0)?mapNormal.opacity:1;
            ns.tg.updateCellByRowCol('opacity','normal',{value:opacity},false,false);
            ns.tg.updateCellByRowCol('opacity','hover',{value:opacity},false,false);
            ns.tg.updateCellByRowCol('opacity','active',{value:opacity},false,false);
            ns.tg.updateCellByRowCol('opacity','focus',{value:opacity},false,false);

            if(profile._noFocusStatus)
                ns.ood_ui_statusbuttons3.removeItems('focus');
            ns.ood_ui_statusbuttons3.setUIValue(arr.join(';'),true);

            ns.dialog.setCaption("$(RAD.custom_dlg."+(profile._title||"CSS Box Editor")+")")
        },
        events : {"onReady":"_com_onready", "onDestroy":"_com_ondestroy"},
        _com_onready : function (com, threadid) {
            var ns=this,rows=[],cell;
            cell={
                type:"color"
            };
            rows.push({id:'color',cells:[{id:'color',caption:"$RAD.custom_dlg.color"},cell,cell,cell,cell]});
            rows.push({id:'background-color',cells:[{id:'background-color',caption:"$(RAD.custom_dlg.background$-color)"},cell,cell,cell,cell]});

            cell={
                type:CONF.getClientMode() == 'singlepage'?"input":"popbox",
                event : function(profile, cell,editorprf){
                    var node = profile.getSubNode('CELL', cell._serialId),
                        _cb=function(path){
                            editorprf.boxing().setUIValue("url("+CONF.adjustRelativePath(path)+")");
                            node.focus();
                        };

                    if(window.SPA && false===SPA.fe("beforeURISelectorPop", 
                    [cell._col.id + 'Status:background-image', cell.value, _cb,
                        'RAD.CustomDecoration2',ns.properties.targetProfile.boxing(),node.get(0), cell, profile.boxing(), editorprf&&editorprf.boxing()
                    ]))return;

                    if(CONF.getClientMode() !='singlepage'){
                         ood.ComFactory.getCom('RAD.ImageSelector',function(){
                            this.setProperties({
                                fromRegion:node.cssRegion(true),
                                onOK:function(obj, path){
                                    _cb(path);
                                }
                            });
                            this.show();
                        });
                    }
                }
            };
            rows.push({id:'background-image',cells:[{id:'background-image',caption:"$(RAD.custom_dlg.background$-image)"},cell,cell,cell,cell]});

            cell={
                type:"combobox", editorListItems:CONF.designer_background_position
            };
            rows.push({id:'background-position',cells:[{id:'background-position',caption:"$(RAD.custom_dlg.background$-position)"},cell,cell,cell,cell]});

            cell={
                type:"combobox", editorListItems:CONF.designer_background_repeat
            };
            rows.push({id:'background-repeat',cells:[{id:'background-repeat',caption:"$(RAD.custom_dlg.background$-repeat)"},cell,cell,cell,cell]});

            cell={
                type:"combobox", editorListItems:CONF.designer_background_attachment
            };
            rows.push({id:'background-attachment',cells:[{id:'background-attachment',caption:"$(RAD.custom_dlg.background$-attachment)"},cell,cell,cell,cell]});
            /*
            cell={
               type:"combobox", editorListItems:CONF.designer_background_size
            };
           rows.push({id:'background-size',cells:[{id:'background-size',caption:"$(RAD.custom_dlg.background$-size)"},cell,cell,cell,cell]});
           cel=,{
               type:"combobox", editorListItems:CONF.designer_background_origin
            };
           rows.push({id:'background-origin',cells:[{id:'background-origin',caption:"$(RAD.custom_dlg.background$-origin)"},cell,cell,cell,cell]});
           cell={
               type:"combobox", editorListItems:CONF.designer_background_clip
            };
            rows.push({id:'background-clip',cells:[{id:'background-clip',caption:"$(RAD.custom_dlg.background$-clip)"},cell,cell,cell,cell]});
            */
            cell={
                type:"helpinput", editorListItems:CONF.designer_data_fontfamily
            };
            rows.push({id:'font-family',cells:[{id:'font-family',caption:"$(RAD.custom_dlg.font$-family)"},cell,cell,cell,cell]});
            cell={
                type:"combobox", editorListItems:CONF.designer_data_fontsize
            };
            rows.push({id:'font-size',cells:[{id:'font-size',caption:"$(RAD.custom_dlg.font$-size)"},cell,cell,cell,cell]});
            cell={
                type:"combobox", editorListItems:CONF.designer_data_fontweight
            };
            rows.push({id:'font-weight',cells:[{id:'font-weight',caption:"$(RAD.custom_dlg.font$-weight)"},cell,cell,cell,cell]});
            cell={
                type:"combobox", editorListItems:CONF.designer_data_fontstyle
            };
            rows.push({id:'font-style',cells:[{id:'font-style',caption:"$(RAD.custom_dlg.font$-style)"},cell,cell,cell,cell]});

            cell={
                type:"popbox"
            };
            rows.push({id:'border-top',cells:[{id:'border-top',caption:"$(RAD.custom_dlg.border$-top)"},cell,cell,cell,cell]});
            rows.push({id:'border-right',cells:[{id:'border-right',caption:"$(RAD.custom_dlg.border$-right)"},cell,cell,cell,cell]});
            rows.push({id:'border-bottom',cells:[{id:'border-bottom',caption:"$(RAD.custom_dlg.border$-bottom)"},cell,cell,cell,cell]});
            rows.push({id:'border-left',cells:[{id:'border-left',caption:"$(RAD.custom_dlg.border$-left)"},cell,cell,cell,cell]});
            if(ood.Dom.css3Support("border-radius")){
                rows.push({id:'border-radius',cells:[{id:'border-radius',caption:"$(RAD.custom_dlg.border$-radius)"},cell,cell,cell,cell]});
            }
            rows.push({id:'padding',cells:[{id:'padding',caption:"$RAD.custom_dlg.padding"},cell,cell,cell,cell]});
            rows.push({id:'margin',cells:[{id:'margin',caption:"$RAD.custom_dlg.margin"},cell,cell,cell,cell]});

            cell={
                type:"combobox", editorListItems:CONF.designer_data_textalign
            };
            rows.push({id:'text-align',cells:[{id:'text-align',caption:"$(RAD.custom_dlg.text$-align)"},cell,cell,cell,cell]});
            
            cell={
                type:"combobox", editorListItems:CONF.designer_data_textdecoration
            };
            rows.push({id:'text-decoration',cells:[{id:'text-decoration',caption:"$(RAD.custom_dlg.text$-decoration)"},cell,cell,cell,cell]});
            if(ood.Dom.css3Support("text-shadow")){
                cell={
                    type:"popbox"
                };
                rows.push({id:'text-shadow',cells:[{id:'text-shadow',caption:"$(RAD.custom_dlg.text$-shadow)"},cell,cell,cell,cell]});
            }
            if(ood.Dom.css3Support("box-shadow")){
                cell={
                    type:"popbox"
                };
                rows.push({id:'box-shadow',cells:[{id:'box-shadow',caption:"$(RAD.custom_dlg.box$-shadow)"},cell,cell,cell,cell]});
            }
            if(ood.Dom.css3Support("gradient")){
                cell={
                    type:"cmdbox", editorReadonly:true
                };
                rows.push({id:'$gradient',cells:[{id:'gradients',caption:"$RAD.custom_dlg.gradients"},cell,cell,cell,cell]});
            }
            /*
            if(ood.Dom.css3Support("transform")){
                cell={
                    type:"popbox"
                };
                rows.push({id:'transform',cells:[{id:'transform',caption:"$RAD.custom_dlg.transform"},cell,cell,cell,cell]});
            }*/
            cell={
                type:"combobox", editorListItems:CONF.designer_data_cursor
            };
            rows.push({id:'cursor',cells:[{id:'cursor',caption:"$RAD.custom_dlg.cursor"},cell,cell,cell,cell]});
            cell={
                type:"combobox", editorListItems:CONF.designer_data_overflow
            };
            rows.push({id:'overflow',cells:[{id:'overflow',caption:"$RAD.custom_dlg.overflow"},cell,cell,cell,cell]});
            cell={
                type:"combobox", editorListItems:[1,1.22,1.5,2]
            };
            rows.push({id:'line-height',cells:[{id:'line-height',caption:"$(RAD.custom_dlg.line$-height)"},cell,cell,cell,cell]});

            if(ood.Dom.css3Support("opacity")){
                cell={
                    value:1,
                    type:"progress", editorProperties:{
                        min:0,max:1
                    }
                };
                rows.push({id:'opacity',cells:[{id:'opacity',caption:"$RAD.custom_dlg.opacity"},cell,cell,cell,cell]});
            }
 
            ns.tg.setRows(rows);

        },
        _dialog_beforeclose : function (profile) {
            var ns=this;
            ns.dialog.getRoot().setBlurTrigger("RAD.CustomDecoration2");
            if(ns._targetPrf){
                ood.arr.each(ns._attr,function(key){
                    ns.tg.updateCellByRowCol(key,'normal',{value:""},false,false);
                    ns.tg.updateCellByRowCol(key,'hover',{value:""},false,false);
                    ns.tg.updateCellByRowCol(key,'active',{value:""},false,false);
                    ns.tg.updateCellByRowCol(key,'focus',{value:""},false,false);
                });
                ns.tg.updateCellByRowCol('opacity','normal',{value:1},false,false);
                ns.tg.updateCellByRowCol('opacity','hover',{value:1},false,false);
                ns.tg.updateCellByRowCol('opacity','active',{value:1},false,false);
                ns.tg.updateCellByRowCol('opacity','focus',{value:1},false,false);
    
                ns.fireEvent('onFinished');
                if(ns._targetPrf['ood.UIProfile'])
                    ns._targetPrf.getRoot().css({left:ood.Dom.HIDE_VALUE,top:ood.Dom.HIDE_VALUE,visibility:'hidden',display:'none','z-index':0});
                ns._targetPrf=null;
    
                profile.boxing().hide();
            }

            return false;
        },
        _tg_beforeComboPop:function(profile, cell, editorprf, pos, e, src){
            var ns=this,
                prf=ns._targetPrf,
                prop=prf.properties,
                colId=cell._col.id,
                attr={},
                getV=function(key){return ood.get(prop,[colId+"Status",key])||""},
                cls,t;

            switch(cell._row.id){
                case "border-top":
                case "border-right":
                case "border-bottom":
                case "border-left":
                case "border-radius":
                case "padding":
                case "margin":
                    attr.border = { 
                        top: getV('border-top') || getV('border'),
                        right: getV('border-right') || getV('border'),
                        bottom: getV('border-bottom') || getV('border'),
                        left: getV('border-left') || getV('border')
                    };
                    attr['border-radius'] = getV('border-radius');
                    attr['padding'] = getV('padding');
                    attr['margin'] = getV('margin');
                    break;
                default:
                    attr = getV(cell._row.id);
            }
            switch(cell._row.id){
                case "border-top":
                case "border-right":
                case "border-bottom":
                case "border-left":
                case "border-radius":
                case "padding":
                case "margin":
                    cls="RAD.CustomBorder";
                    break;
                case "text-shadow":
                    cls="RAD.CustomTextShadow";
                    break;
                case "box-shadow":
                    cls="RAD.CustomBoxShadow";
                    break;
                /*
                case "transform":
                    cls="RAD.CustomTransform";
                    break;
                */
                case "$gradient":
                    cls="RAD.CustomGradients";
                    break;
            }
            if(cls){
                ood.ComFactory.getCom(cls,function(){
                    this.init(prf,attr,{
                        pro:editorprf,
                        cell:cell,
                        isSvg:0,
                        grid:ns.tg
                    },2);
                    this.setEvents({
                        onChange:function(str){
                            switch(cell._row.id){
                                case "border-top":
                                    editorprf.boxing().setUIValue(str['border']['top']||"",true);
                                    break;
                                case "border-right":
                                    editorprf.boxing().setUIValue(str['border']['right']||"",true);
                                    break;
                                case "border-bottom":
                                    editorprf.boxing().setUIValue(str['border']['bottom']||"",true);
                                    break;
                                case "border-left":
                                    editorprf.boxing().setUIValue(str['border']['left']||"",true);
                                    break;
                                case "border-radius":
                                case "padding":
                                case "margin":
                                    editorprf.boxing().setUIValue(str[cell._row.id]||"",true);
                                    break;
                                default:
                                    if(ood.isHash(str)){
                                        editorprf.boxing().setCaption("[object]",true);
                                    }else if(ood.isNull(str)){
                                            editorprf.boxing().setCaption(null,true);
                                    }
                                    editorprf.boxing().setUIValue(str?ood.isStr(str)?str:"[object]":"",true);
                            }
                            switch(cell._row.id){
                                case "border-top":
                                case "border-right":
                                case "border-bottom":
                                case "border-left":
                                case "border-radius":
                                case "padding":
                                case "margin":
                                    profile.boxing().updateCellByRowCol('padding',colId,{value:str['padding']||""},false,true);
                                    profile.boxing().updateCellByRowCol('margin',colId,{value:str['margin']||""},false,true);
                                    profile.boxing().updateCellByRowCol('border-radius',colId,{value:str['border-radius']||""},false,true);
                                    profile.boxing().updateCellByRowCol('border-left',colId,{value:str['border']['left']||""},false,true);
                                    profile.boxing().updateCellByRowCol('border-right',colId,{value:str['border']['right']||""},false,true);
                                    profile.boxing().updateCellByRowCol('border-top',colId,{value:str['border']['top']||""},false,true);
                                    profile.boxing().updateCellByRowCol('border-bottom',colId,{value:str['border']['bottom']||""},false,true);
                                    break;
                                default:
                                    if(ood.isHash(str)){
                                        profile.boxing().updateCell(cell,{caption:"[object]"},false,true);
                                    }else if(ood.isNull(str)){
                                        profile.boxing().updateCell(cell,{caption:""},false,true);
                                    }
                                    profile.boxing().updateCell(cell,{value:str||""},false,true);
                            }
                        }
                    });
                    this.render();
                    var r=this.mainPane.getRoot();
                    r.popToTop(editorprf.getRoot());
                    r.setBlurTrigger(r.$xid, function(){
                        r.setBlurTrigger(r.$xid);
                        r.hide();
                    });
                });
            }
        },
        _tg_aftercellupdated : function (profile, cell, options) {
            if("value" in options){
                var ns=this,
                    grid=ns.tg,
                    key=cell._col.id;
                hash={};
                ood.each(grid.getCells(null,key),function(cell){
                    var v="";
                    if(cell._row.id=="$gradient"){
                        hash[cell._row.id]=cell.value;
                        if(!cell.value)delete hash[cell._row.id];
                    }else if(cell._row.id=="opacity"){
                        if(parseFloat(cell.value)!==1.0){
                            v=parseFloat(cell.value);
                            hash[cell._row.id]=v;
                            if(v==1)delete hash[cell._row.id];
                        }
                    }else if(ood.str.trim(cell.value)!==""){
                        v=ood.str.trim(cell.value);
                        hash[cell._row.id]=v;
                    }
                });
                // custom style
                ns._targetPrf.boxing()['set'+ood.str.initial(key)+"Status"](hash);
                ns.fireEvent('onDirty');
            }
        },
        _clrpatternclicked:function(profile){
            this._applyClrs(profile.properties.tagVar);
        },
        _applyClrs:function(setting){
            var ns=this;
            var simplePattern=[
                {"color":"{txtclr}", "border":"solid {clr3} 1px", "border-radius":"6px", "box-shadow":"inset 0px 1px 0px {boxshadow1}",  "text-shadow":"{txtshadow}","$gradient":{"stops":[{"pos":"0%", "clr":"{clr2}"}, {"pos":"100%", "clr":"{clr3}"}], "type":"linear", "orient":"T"}, "cursor":"pointer"},
                {"$gradient":{"stops":[{"pos":"0%", "clr":"{clr3}"}, {"pos":"100%", "clr":"{clr4}"}], "type":"linear", "orient":"T"}},
                {"box-shadow":"inset 0px 1px 2px {boxshadow2}","background-image":"none","background-color":"{clr1}"},
                {}
            ],
            mattePattern=[
                {"color":"{txtclr}", "border":"solid {clr3} 1px", "border-radius":"6px", "box-shadow":"inset 0px 1px 0px {boxshadow1}",  "text-shadow":"{txtshadow}","$gradient":{"stops":[{"pos":"0%", "clr":"{clr1}"}, {"pos":"70%", "clr":"{clr2}"}], "type":"linear", "orient":"T"}, "cursor":"pointer"},
                {"$gradient":{"stops":[{"pos":"3%", "clr":"{clr3}"}, {"pos":"95%", "clr":"{clr4}"}], "type":"linear", "orient":"T"}},
                {"box-shadow":"inset 0px 1px 2px {boxshadow2}","background-image":"none","background-color":"{clr1}"},
                {}
            ],
            shinyPattern=[
                {"color":"{txtclr}", "border":"solid {clr3} 1px", "border-radius":"6px", "box-shadow":"inset 0px 1px 0px {boxshadow1}",  "text-shadow":"{txtshadow}","$gradient":{"stops":[{"pos":"0%", "clr":"{clr1}"}, {"pos":"50%", "clr":"{clr2}"}, {"pos":"100%", "clr":"{clr3}"}], "type":"linear", "orient":"T"}, "cursor":"pointer"},
                {"$gradient":{"stops":[{"pos":"0%", "clr":"{clr3}"}, {"pos":"50%", "clr":"{clr4}"}, {"pos":"100%", "clr":"{boxshadow2}"}], "type":"linear", "orient":"T"}},
                {"box-shadow":"inset 0px 1px 2px {boxshadow2}","background-image":"none","background-color":"{clr1}"},
                {}
            ],
            classPattern=[
                {"color":"{txtclr}", "border":"solid {clr3} 1px", "border-radius":"6px", "box-shadow":"inset 0px 1px 0px {boxshadow1}",  "text-shadow":"{txtshadow}","$gradient":{"stops":[{"pos":"50%", "clr":"{clr1}"}, {"pos":"51%", "clr":"{clr2}"}], "type":"linear", "orient":"T"}, "cursor":"pointer"},
                {"$gradient":{"stops":[{"pos":"50%", "clr":"{clr3}"}, {"pos":"51%", "clr":"{clr4}"}], "type":"linear", "orient":"T"}},
                {"box-shadow":"inset 0px 1px 2px {boxshadow2}","background-image":"none","background-color":"{clr1}"},
                {}
            ],
            flatPattern=[
                {"color":"{txtclr}", "border":"none","border-radius":"6px", "text-shadow":"{txtshadow}","background-color":"{clr1}", "cursor":"pointer"},
                {"background-color":"{clr2}"},
                {"background-color":"{clr4}"},
                {}
            ];

 
            var patternArray=[simplePattern,mattePattern,shinyPattern,classPattern,flatPattern];
            var textColorSetting=["#eeeeee","#eeeeee","#eeeeee","#222222","#222222"];
            var textshadowSetting=["none","0 -1px 0 {boxshadow2}","0 1px 0 {boxshadow2}","0 1px 0 {boxshadow1}","0 -1px 0 {boxshadow1}"];
            var rep=function(str){
                return str.replace("{clr1}",setting.clr1).replace("{clr2}",setting.clr2).replace("{clr3}",setting.clr3).replace("{clr4}",setting.clr4)
                    .replace("{boxshadow1}",setting.boxshadow1).replace("{boxshadow2}",setting.boxshadow2);
            };

            for(var i=1;i<=25;i++){
                var j=i%5 || 5, k=parseInt((i-1)/5,10), o,
                      pattern=ood.clone(patternArray[k]);
                if(!pattern[0])continue;

                o=pattern[0];
                if(o.color)o.color=rep(textColorSetting[j-1]);
                o["text-shadow"]=o["text-shadow"]?rep(textshadowSetting[j-1]):"";
                o["box-shadow"]=o["box-shadow"]?rep(o["box-shadow"]):'none';
                if(o.border){
                    o.border=rep(o.border);
                    o['border-top']=o.border;
                    o['border-right']=o.border;
                    o['border-bottom']=o.border;
                    o['border-left']=o.border;
                    delete o.border;
                }
                if(o['background-color'])o['background-color']=rep(o['background-color']);
                if(o['background-image'])o['background-image']=rep(o['background-image']);
                if(o.$gradient){
                    ood.arr.each(o.$gradient.stops,function(a,i){
                        if(a.clr)a.clr=rep(a.clr);
                    });
                }else{
                    if(!o['background-image'])o['background-image']='none';
                }
        
                if(o=pattern[1]){
                    if(o.color)o.color=rep(textColorSetting[j-1]);
                    if(o["text-shadow"])o["text-shadow"]=rep(textshadowSetting[j-1]);
                    if(o["box-shadow"])o["box-shadow"]=rep(o["box-shadow"]);
                    if(o.border){
                        o.border=rep(o.border);
                        o['border-top']=o.border;
                        o['border-right']=o.border;
                        o['border-bottom']=o.border;
                        o['border-left']=o.border;
                        delete o.border;
                    }
                    if(o['background-color'])o['background-color']=rep(o['background-color']);
                    if(o['background-image'])o['background-image']=rep(o['background-image']);
                    if(o.$gradient){
                        ood.arr.each(o.$gradient.stops,function(a,i){
                            if(a.clr)a.clr=rep(a.clr);
                        });
                    }else{
                        if(!o['background-image'])o['background-image']='none';
                    }
                }
        
                if(o=pattern[2]){
                    if(o.color)o.color=rep(textColorSetting[j-1]);
                    if(o["text-shadow"])o["text-shadow"]=rep(textshadowSetting[j-1]);
                    if(o["box-shadow"])o["box-shadow"]=rep(o["box-shadow"]);
                    if(o.border){
                        o.border=rep(o.border);
                        o['border-top']=o.border;
                        o['border-right']=o.border;
                        o['border-bottom']=o.border;
                        o['border-left']=o.border;
                        delete o.border;
                    }
                    if(o['background-color'])o['background-color']=rep(o['background-color']);
                    if(o['background-image'])o['background-image']=rep(o['background-image']);
                    if(o.$gradient){
                        ood.arr.each(o.$gradient.stops,function(a,i){
                            if(a.clr)a.clr=rep(a.clr);
                        });
                    }else{
                        if(!o['background-image'])o['background-image']='none';
                    }
                }
                if(o=pattern[3]){
                    if(o.color)o.color=rep(textColorSetting[j-1]);
                    if(o["text-shadow"])o["text-shadow"]=rep(textshadowSetting[j-1]);
                    if(o["box-shadow"])o["box-shadow"]=rep(o["box-shadow"]);
                    if(o.border){
                        o.border=rep(o.border);
                        o['border-top']=o.border;
                        o['border-right']=o.border;
                        o['border-bottom']=o.border;
                        o['border-left']=o.border;
                        delete o.border;
                    }
                    if(o['background-color'])o['background-color']=rep(o['background-color']);
                    if(o['background-image'])o['background-image']=rep(o['background-image']);
                }
                ns["ood-predifined-css-"+i].setNormalStatus(pattern[0]).setHoverStatus(pattern[1]).setActiveStatus(pattern[2]).setFocusStatus(pattern[3]||{});
            }
        },
        _btnclick:function (profile, e, value){
            var ns = this, 
                target=ns._targetPrf,
                ins=target.boxing(),
                cls=profile.properties.className,
                arr=ns.ood_ui_statusbuttons3.getUIValue(true);
            //cope pattern
            ins.setNormalStatus(ood.clone(ns[cls].getNormalStatus()));
            if(ood.arr.indexOf(arr,'hover')!=-1)
                ins.setHoverStatus(ood.clone(ns[cls].getHoverStatus()));
            if(ood.arr.indexOf(arr,'active')!=-1)
                ins.setActiveStatus(ood.clone(ns[cls].getActiveStatus()));
            if(ood.arr.indexOf(arr,'focus')!=-1)
                ins.setFocusStatus(ood.clone(ns[cls].getFocusStatus()));
            //reset
            ns.setTargetProfile(target);
            ns.fireEvent('onDirty');
        },
        _ood_ui_statusbuttons3_onchange:function (profile, oldValue, newValue, force, tag){
            var ns = this, 
                tg = ns.tg, 
                arr = newValue.split(';'),
                target = ns._targetPrf,
                ins=target.boxing && target.boxing();
            ood.arr.each(['normal','hover','active','focus'],function(colId){
                tg.showColumn(colId, ood.arr.indexOf(arr,colId)!=-1);
            });
            if(ins){
                if(ood.arr.indexOf(arr,"hover")==-1)
                    ins.setHoverStatus({},true);
                if(ood.arr.indexOf(arr,"active")==-1)
                    ins.setActiveStatus({},true);
                if(ood.arr.indexOf(arr,"focus")==-1)
                    ins.setFocusStatus({},true);
            }
        }
    }
});
﻿ood.Class('RAD.CustomBorder', 'ood.Module',{
    Instance:{
        iniComponents : function(){
            // [[Code created by ESDUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"mainPane")
                .setLeft("0.8333333333333334em")
                .setTop("0.8333333333333334em")
                .setWidth("40em")
                .setHeight("30.833333333333332em")
                .setCaption("$(RAD.custom_dlg.borderdlg.Custom padding, margin and border)")
                .setMinBtn(false)
                .setMaxBtn(false)
                .setRestoreBtn(false)
                .setOverflow("hidden")
            );
            
            host.mainPane.append(
                ood.create("ood.UI.Div")
                .setHost(host,"ood_ui_div46")
                .setLeft("28.25em")
                .setTop("0.9166666666666666em")
                .setHeight("2.5em")
                .setCustomStyle({
                    "KEY":{
                        "background-color":"#E9967A"
                    }
                }
                )
                );
            
            host.ood_ui_div46.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ood_ui_span1")
                .setLeft("3.25em")
                .setTop("0.6666666666666666em")
                .setWidth("3.6666666666666665em")
                .setHeight("1.5833333333333333em")
                .setHtml("$(RAD.custom_dlg.borderdlg.Margin)")
                );
            
            host.mainPane.append(
                ood.create("ood.UI.Div")
                .setHost(host,"ood_ui_div48")
                .setLeft("28.25em")
                .setTop("3.4166666666666665em")
                .setHeight("2.5em")
                .setCustomStyle({
                    "KEY":{
                        "background-color":"#00FF00"
                    }
                }
                )
                );
            
            host.ood_ui_div48.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ood_ui_span92")
                .setLeft("3.25em")
                .setTop("0.6666666666666666em")
                .setWidth("3.6666666666666665em")
                .setHeight("1.5833333333333333em")
                .setHtml("$(RAD.custom_dlg.borderdlg.Border)")
                );
            
            host.mainPane.append(
                ood.create("ood.UI.Div")
                .setHost(host,"ood_ui_div47")
                .setLeft("28.25em")
                .setTop("5.916666666666667em")
                .setHeight("2.5em")
                .setCustomStyle({
                    "KEY":{
                        "background-color":"#FFA07A"
                    }
                }
                )
                );
            
            host.ood_ui_div47.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ood_ui_span91")
                .setLeft("3.25em")
                .setTop("0.6666666666666666em")
                .setWidth("3.6666666666666665em")
                .setHeight("1.5833333333333333em")
                .setHtml("$(RAD.custom_dlg.borderdlg.Padding)")
                );
            
            host.mainPane.append(
                ood.create("ood.UI.Div")
                .setHost(host,"ood_ui_div_realo")
                .setLeft("28.333333333333332em")
                .setTop("10.083333333333334em")
                .setWidth("auto")
                .setHeight("auto")
                .setCustomStyle({
                    "KEY":{
 
                        background:"url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI1IiBoZWlnaHQ9IjUiPgo8cmVjdCB3aWR0aD0iNSIgaGVpZ2h0PSI1IiBmaWxsPSIjZmZmIj48L3JlY3Q+CjxyZWN0IHdpZHRoPSIxIiBoZWlnaHQ9IjEiIGZpbGw9IiNjY2MiPjwvcmVjdD4KPC9zdmc+)"
                    }
                })
                );
            
            host.ood_ui_div_realo.append(
                ood.create("ood.UI.Div")
                .setHost(host,"ood_ui_div_real")
                .setWidth("auto")
                .setHeight("auto")
                .setPosition("relative")
                .setCustomStyle({
                    "KEY":{
                        background:"url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHhtbG5zOnhsaW5rPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5L3hsaW5rIiB3aWR0aD0iNiIgaGVpZ2h0PSI2Ij4KPHJlY3Qgd2lkdGg9IjYiIGhlaWdodD0iNiIgZmlsbD0iI2VlZSI+PC9yZWN0Pgo8ZyBpZD0iYyI+CjxyZWN0IHdpZHRoPSIzIiBoZWlnaHQ9IjMiIGZpbGw9IiNlNmU2ZTYiPjwvcmVjdD4KPHJlY3QgeT0iMSIgd2lkdGg9IjMiIGhlaWdodD0iMiIgZmlsbD0iI2Q4ZDhkOCI+PC9yZWN0Pgo8L2c+Cjx1c2UgeGxpbms6aHJlZj0iI2MiIHg9IjMiIHk9IjMiPjwvdXNlPgo8L3N2Zz4=)"
                    }
                })
                );
            
            host.ood_ui_div_real.append(
                ood.create("ood.UI.Div")
                .setHost(host,"ood_ui_div_reali")
                .setWidth("4em")
                .setHeight("4em")
                .setPosition("relative")
                .setCustomStyle({
                    "KEY":{
 
                        background:"url(data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCI+CjxyZWN0IHdpZHRoPSIyMCIgaGVpZ2h0PSIyMCIgZmlsbD0iI2ZmZiI+PC9yZWN0Pgo8cmVjdCB3aWR0aD0iMTAiIGhlaWdodD0iMTAiIGZpbGw9IiNjY2MiPjwvcmVjdD4KPHJlY3QgeD0iMTAiIHk9IjEwIiB3aWR0aD0iMTAiIGhlaWdodD0iMTAiIGZpbGw9IiNjY2MiPjwvcmVjdD4KPC9zdmc+)"
                    }
                } )
                );
            
            host.mainPane.append(
                ood.create("ood.UI.Button")
                .setHost(host,"ood_ui_button10")
                .setLeft("28.333333333333332em")
                .setTop("23.33333333333333em")
                .setWidth("10em")
                .setHeight("2.5em")
                .setCaption("$(RAD.Clear)")
                .onClick("_ood_ui_button10_onclick")
                );
            

            host.mainPane.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ood_ui_block27")
                .setLeft("0.08333333333333333em")
                .setTop("0em")
                .setWidth("26.5em")
                .setHeight("26.666666666666668em")
                .setBorderType("inset")
                .setOverflow("hidden")
                );
            
            host.ood_ui_block27.append(
                ood.create("ood.UI.SVGPaper")
                .setHost(host,"ood_ui_svgpaper1")
                .setLeft("-0.08333333333333333em")
                .setTop("0em")
                .setWidth("26.666666666666668em")
                .setHeight("26.666666666666668em")
                .setCustomStyle({
                    "KEY":"background-color:transparent"
                }
                )
                );
            
            host.ood_ui_svgpaper1.append(
                ood.create("ood.UI.Div")
                .setHost(host,"ood_ui_div1")
                .setLeft("0.8333333333333334em")
                .setTop("0.8333333333333334em")
                .setWidth("auto")
                .setHeight("auto")
                .setCustomStyle({
                    "KEY":{
                        "background-color":"#E9967A"
                    }
                }
                )
                );
            
            host.ood_ui_div1.append(
                ood.create("ood.UI.Div")
                .setHost(host,"ood_ui_div_demo")
                .setWidth("auto")
                .setHeight("auto")
                .setPosition("relative")
                .setCustomStyle({
                    "KEY":{
                        "background-color":"#FFA07A",
                        "border":"solid #00ff00 30px",
                        "padding":"30px",
                        "margin":"30px"
                    }
                }
                )
                );
            
            host.ood_ui_div_demo.append(
                ood.create("ood.UI.Div")
                .setHost(host,"ood_ui_div3")
                .setPosition("relative")
                .setCustomClass({
                    "KEY":"ood-uibar"
                }
                )
                );
            
            host.ood_ui_block27.append(
                ood.create("ood.UI.Div")
                .setHost(host,"ood_ui_block22")
                .setLeft("0em")
                .setTop("0em")
                .setWidth("14.083333333333334em")
                .setHeight("26.666666666666668em")
                .setCustomStyle({
                    "KEY":{
                        "opacity":0.9
                    }
                }
                )
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ood_ui_span110")
                .setLeft("11.416666666666666em")
                .setTop("12.583333333333334em")
                .setWidth("3.3333333333333335em")
                .setHtml("Matrix")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_radius_tl")
                .setDirtyMark(false)
                .setRotate(225)
                .setLeft("0.75em")
                .setTop("2.4166666666666665em")
                .setWidth("5em")
                .setHeight("1.8333333333333333em")
                .setLabelSize("9.166666666666666em")
                .setLabelPos("none")
                .setLabelGap("0.4166666666666667em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Radius")
                .setType("counter")
                .setShowMode("compact")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(0)
                .setMax(500)
                .onChange("_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_radius_tr")
                .setDirtyMark(false)
                .setRotate(315)
                .setLeft("20.75em")
                .setTop("2.4166666666666665em")
                .setWidth("5em")
                .setLabelSize("9.166666666666666em")
                .setLabelPos("none")
                .setLabelGap("0.4166666666666667em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Radius")
                .setType("counter")
                .setShowMode("compact")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(0)
                .setMax(500)
                .onChange("_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_margin_t")
                .setDirtyMark(false)
                .setLeft("10.5em")
                .setTop("1.1666666666666667em")
                .setWidth("5em")
                .setLabelSize("8em")
                .setLabelPos("none")
                .setType("counter")
                .setShowMode("compact")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Margin")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(-500)
                .setMax(500)
                .onChange("_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_border_t_s")
                .setDirtyMark(false)
                .setLeft("5.833333333333333em")
                .setTop("3.6666666666666665em")
                .setWidth("4.5em")
                .setLabelSize("6.666666666666667em")
                .setLabelPos("none")
                .setLabelGap("0.4166666666666667em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Style")
                .setLabelHAlign("")
                .setHAlign("center")
                .setType("listbox")
                .setShowMode("compact")
                .setValue("none")
                .onChange("_border_t_s_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_border_t_c")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("15.583333333333334em")
                .setTop("3.6666666666666665em")
                .setWidth("5em")
                .setLabelSize("6.666666666666667em")
                .setLabelPos("none")
                .setLabelGap("0.4166666666666667em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Color")
                .setType("color")
                .setShowMode("compact")
                .onChange("_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_border_t_w")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("10.5em")
                .setTop("3.6666666666666665em")
                .setWidth("5em")
                .setLabelSize("6.666666666666667em")
                .setLabelPos("none")
                .setLabelGap("0.4166666666666667em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Width")
                .setType("counter")
                .setShowMode("compact")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(0)
                .setMax(500)
                .onChange("_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_padding_t")
                .setDirtyMark(false)
                .setLeft("10.5em")
                .setTop("6.166666666666667em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Padding")                
                .setWidth("5em")
                .setLabelSize("8em")
                .setLabelPos("none")
                .setType("counter")
                .setShowMode("compact")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(0)
                .setMax(500)
                .onChange("_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_padding_r")
                .setDirtyMark(false)
                .setRotate(90)
                .setLeft("17em")
                .setTop("12.166666666666666em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Padding")                
                .setWidth("5em")
                .setLabelSize("8em")
                .setLabelPos("none")
                .setType("counter")
                .setShowMode("compact")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(0)
                .setMax(500)
                .onChange("_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_padding_b")
                .setDirtyMark(false)
                .setLeft("10.333333333333334em")
                .setTop("18.666666666666668em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Padding")                
                .setWidth("5em")
                .setLabelSize("8em")
                .setLabelPos("none")
                .setType("counter")
                .setShowMode("compact")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(0)
                .setMax(500)
                .onChange("_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_border_b_s")
                .setDirtyMark(false)
                .setLeft("5.75em")
                .setTop("21.166666666666668em")
                .setWidth("4.5em")
                .setLabelSize("6.666666666666667em")
                .setLabelPos("none")
                .setLabelGap("0.4166666666666667em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Style")
                .setHAlign("center")
                .setType("listbox")
                .setShowMode("compact")
                .setValue("none")
                .onChange("_border_b_s_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_margin_b")
                .setDirtyMark(false)
                .setLeft("10.416666666666666em")
                .setTop("23.583333333333332em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Margin")                
                .setWidth("5em")
                .setLabelSize("8em")
                .setLabelPos("none")
                .setType("counter")
                .setShowMode("compact")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(-500)
                .setMax(500)
                .onChange("_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_border_r_s")
                .setDirtyMark(false)
                .setRotate(90)
                .setLeft("19.75em")
                .setTop("7.333333333333333em")
                .setWidth("4.5em")
                .setLabelSize("6.666666666666667em")
                .setLabelPos("none")
                .setLabelGap("0.4166666666666667em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Style")
                .setHAlign("center")
                .setType("listbox")
                .setShowMode("compact")
                .setValue("none")
                .onChange("_border_r_s_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_border_r_c")
                .setDirtyMark(false)
                .setDisabled(true)
                .setRotate(90)
                .setLeft("19.5em")
                .setTop("17.083333333333332em")
                .setWidth("5em")
                .setLabelSize("6.666666666666667em")
                .setLabelPos("none")
                .setLabelGap("0.4166666666666667em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Color")
                .setType("color")
                .setShowMode("compact")
                .onChange("_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_border_r_w")
                .setDirtyMark(false)
                .setDisabled(true)
                .setRotate(90)
                .setLeft("19.5em")
                .setTop("12.083333333333334em")
                .setWidth("5em")
                .setLabelSize("6.666666666666667em")
                .setLabelPos("none")
                .setLabelGap("0.4166666666666667em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Width")
                
                .setType("counter")
                .setShowMode("compact")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(0)
                .setMax(500)
                .onChange("_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_radius_br")
                .setDirtyMark(false)
                .setRotate(45)
                .setLeft("20.75em")
                .setTop("22.416666666666668em")
                .setWidth("5em")
                .setLabelSize("9.166666666666666em")
                .setLabelPos("none")
                .setLabelGap("0.4166666666666667em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Radius")
                .setType("counter")
                .setShowMode("compact")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(0)
                .setMax(500)
                .onChange("_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_radius_bl")
                .setDirtyMark(false)
                .setRotate(135)
                .setLeft("0.75em")
                .setTop("22.416666666666668em")
                .setWidth("5em")
                .setLabelSize("9.166666666666666em")
                .setLabelPos("none")
                .setLabelGap("0.4166666666666667em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Radius")
                .setType("counter")
                .setShowMode("compact")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(0)
                .setMax(500)
                .onChange("_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_margin_r")
                .setDirtyMark(false)
                .setRotate(90)
                .setLeft("22em")
                .setTop("12.083333333333334em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Margin")
                .setWidth("5em")
                .setLabelSize("8em")
                .setLabelPos("none")
                .setType("counter")
                .setShowMode("compact")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(-500)
                .setMax(500)
                .onChange("_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_padding_l")
                .setDirtyMark(false)
                .setRotate(90)
                .setLeft("4.5em")
                .setTop("12.166666666666666em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Padding")                
                .setWidth("5em")
                .setLabelSize("8em")
                .setLabelPos("none")
                .setLabelGap("auto")
                .setType("counter")
                .setShowMode("compact")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(0)
                .setMax(500)
                .onChange("_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_border_l_c")
                .setDirtyMark(false)
                .setDisabled(true)
                .setRotate(90)
                .setLeft("2em")
                .setTop("17.25em")
                .setWidth("5em")
                .setLabelSize("6.666666666666667em")
                .setLabelPos("none")
                .setLabelGap("0.4166666666666667em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Color")
                .setType("color")
                .setShowMode("compact")
                .onChange("_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_border_l_w")
                .setDirtyMark(false)
                .setDisabled(true)
                .setRotate(90)
                .setLeft("2em")
                .setTop("12.25em")
                .setWidth("5em")
                .setLabelSize("6.666666666666667em")
                .setLabelPos("none")
                .setLabelGap("0.4166666666666667em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Width")
                
                .setType("counter")
                .setShowMode("compact")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(0)
                .setMax(500)
                .onChange("_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_margin_l")
                .setDirtyMark(false)
                .setRotate(90)
                .setLeft("-0.5em")
                .setTop("12.083333333333334em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Margin")                
                .setWidth("5em")
                .setLabelSize("8em")
                .setLabelPos("none")
                .setType("counter")
                .setShowMode("compact")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(-500)
                .setMax(500)
                .onChange("_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_border_l_s")
                .setDirtyMark(false)
                .setRotate(90)
                .setLeft("2.25em")
                .setTop("7.416666666666667em")
                .setWidth("4.5em")
                .setLabelSize("6.666666666666667em")
                .setLabelPos("none")
                .setLabelGap("0.4166666666666667em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Style")
                .setHAlign("center")
                .setType("listbox")
                .setShowMode("compact")
                .setValue("none")
                .onChange("_border_l_s_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_border_b_c")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("15.5em")
                .setTop("21.166666666666668em")
                .setWidth("5em")
                .setLabelSize("6.666666666666667em")
                .setLabelPos("none")
                .setLabelGap("0.4166666666666667em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Color")
                .setType("color")
                .setShowMode("compact")
                .onChange("_change")
                );
            
            host.ood_ui_block22.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"_border_b_w")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("10.416666666666666em")
                .setTop("21.166666666666668em")
                .setWidth("5em")
                .setLabelSize("6.666666666666667em")
                .setLabelPos("none")
                .setLabelGap("0.4166666666666667em")
                .setLabelCaption("$RAD.custom_dlg.borderdlg.Width")
                
                .setType("counter")
                .setShowMode("compact")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(0)
                .setMax(500)
                .onChange("_change")
                );
            
            return children;
            // ]]Code created by ESDUI RAD Studio
        },
        init:function(prf,obj,prop,type){
            var ns=this,n,adj;

            if(type==2){
                adj=function(){return ood.CSS.$px.apply(ood.CSS, arguments)||'';};
                n=ood(ood.$getGhostDiv());
                n.css({
                    borderLeft:obj.border&&obj.border.left||0,
                    borderTop:obj.border&&obj.border.top||0,
                    borderRight:obj.border&&obj.border.right||0,
                    borderBottom:obj.border&&obj.border.bottom||0,

                    borderRadius:obj['border-radius']||0,
                    margin:obj.margin||0,
                    padding:obj.padding||0
                });
            }else{
                adj=function(){return prf.$px.apply(prf, arguments)||'';};
                n=prf.getSubNode(obj);
            }
            var adj2=function(v){
                v = v.replace(/(?:rgb\((\d+), ?(\d+), ?(\d+)\)([^,]*))+/g,function(a,b,c,d,e){
                    return '#'+ood.UI.ColorPicker.rgb2hex(b, c, d) + e;
                });
                v = v.replace(/(?:rgba\((\d+), ?(\d+), ?(\d+), ?([.\d]+)\)([^,]*))+/g,function(a,b,c,d,e,f){
                    opacity = parseFloat(e)||1;
                    return '#'+ood.UI.ColorPicker.rgb2hex(b, c, d) + f;
                });
                return v;
            }
            ns._ignoreChange=1;
            //border top
            ns._border_t_s.setUIValue(n.css('borderTopStyle')||'none',true);
            ns._border_t_w.resetValue(adj(n.css('borderTopWidth')));
            ns._border_t_c.resetValue(adj2(n.css('borderTopColor')));

            //border right 
            ns._border_r_s.setUIValue(n.css('borderRightStyle')||'none',true);
            ns._border_r_w.resetValue(adj(n.css('borderRightWidth')));
            ns._border_r_c.resetValue(adj2(n.css('borderRightColor')));

            //border bottom
            ns._border_b_s.setUIValue(n.css('borderBottomStyle')||'none',true);
            ns._border_b_w.resetValue(adj(n.css('borderBottomWidth')));
            ns._border_b_c.resetValue(adj2(n.css('borderBottomColor')));

            //border left
            ns._border_l_s.setUIValue(n.css('borderLeftStyle')||'none',true);
            ns._border_l_w.resetValue(adj(n.css('borderLeftWidth')));
            ns._border_l_c.resetValue(adj2(n.css('borderLeftColor')));

            //padding
            ns._padding_t.resetValue(adj(n.css('paddingTop')));
            ns._padding_r.resetValue(adj(n.css('paddingRight')));
            ns._padding_b.resetValue(adj(n.css('paddingBottom')));
            ns._padding_l.resetValue(adj(n.css('paddingLeft')));

            //margin
            ns._margin_t.resetValue(adj(n.css('marginTop')));
            ns._margin_r.resetValue(adj(n.css('marginRight')));
            ns._margin_b.resetValue(adj(n.css('marginBottom')));
            ns._margin_l.resetValue(adj(n.css('marginLeft')));

            // radius
            ns._radius_tl.resetValue(adj(n.css("borderTopLeftRadius")));
            ns._radius_tr.resetValue(adj(n.css("borderTopRightRadius")));
            ns._radius_bl.resetValue(adj(n.css("borderBottomLeftRadius")));
            ns._radius_br.resetValue(adj(n.css("borderBottomRightRadius")));
            ns._ignoreChange=0;

            ns._change(false);
            n=null;
        },
        events:{
            "onReady":"_page_onready"
        },
        _page_onready:function (module, threadid){
            var ns=this,items=[
                {
                    "id":"none",
                    "caption":"$RAD.custom_dlg.borderdlg.none"
                },
                {
                    "id":"solid",
                    "caption":"$RAD.custom_dlg.borderdlg.solid"
                },
                {
                    "id":"dashed",
                    "caption":"$RAD.custom_dlg.borderdlg.dashed"
                },
                {
                    "id":"dotted",
                    "caption":"$RAD.custom_dlg.borderdlg.dotted"
                },
                {
                    "id":"double",
                    "caption":"$RAD.custom_dlg.borderdlg.double"
                }
            ];
            ns._border_l_s.setItems(items);
            ns._border_r_s.setItems(items);
            ns._border_t_s.setItems(items);
            ns._border_b_s.setItems(items);
        },
        _border_s_change:function(v, dir){
            var ns=this, b=v!='none',t;
            (t=ns['_border_' + dir + '_w']).setDisabled(!b);
            if(b){
                if(!t.getUIValue())t.setValue(1);
            }else{
                t.resetValue(null);
            }
            (t=ns['_border_' + dir + '_c']).setDisabled(!b);
            if(b){
                if(!t.getUIValue())t.setValue("#000000");
            }else{
                t.resetValue(null);
            }
            ns._change();
        },
        _border_t_s_change:function(prf,o,v){
            this._border_s_change(v, 't');
        },
        _border_b_s_change:function(prf,o,v){
            this._border_s_change(v, 'b');
        },
        _border_l_s_change:function(prf,o,v){
            this._border_s_change(v, 'l');
        },
        _border_r_s_change:function(prf,o,v){
            this._border_s_change(v, 'r');
        },
        
        _change:function(triggEvent){
            var ns=this;
            if(ns._ignoreChange)return;
            ood.resetRun("bs:"+ns.$xid,function(){
                var empty='',
                    borderL=empty, 
                    borderR=empty, 
                    borderT=empty, 
                    borderB=empty, 
                    margin=empty, 
                    padding=empty, 
                    radius=empty, 
                    t1, t2, t3, t4;
                // collect all
                
                //border top
                t1=ns._border_t_s.getUIValue();
                if(t1!='none')
                    borderT = t1 + ' ' + (ns._border_t_w.getUIValue()||0) + "px " + (ns._border_t_c.getUIValue()||''); 
                
                //border right 
                t2=ns._border_r_s.getUIValue();
                if(t2!='none')
                    borderR = t2 + ' ' + (ns._border_r_w.getUIValue()||0) + "px " + (ns._border_r_c.getUIValue()||''); 

                //border bottom
                t3=ns._border_b_s.getUIValue();
                if(t3!='none')
                    borderB = t3 + ' ' + (ns._border_b_w.getUIValue()||0) + "px " + (ns._border_b_c.getUIValue()||''); 
                
                //border left
                t4=ns._border_l_s.getUIValue();
                if(t4!='none')
                    borderL = t4 + ' ' + (ns._border_l_w.getUIValue()||0) + "px " + (ns._border_l_c.getUIValue()||''); 
                
                //padding
                t1=ns._padding_t.getUIValue()||0;
                t2=ns._padding_r.getUIValue()||0;
                t3=ns._padding_b.getUIValue()||0;
                t4=ns._padding_l.getUIValue()||0;
                if(t1 || t2 || t3 || t4)
                    padding = t1 +"px "+ t2 +"px "+ t3 +"px "+ t4 +"px";
                
                //margin
                t1=ns._margin_t.getUIValue()||0;
                t2=ns._margin_r.getUIValue()||0;
                t3=ns._margin_b.getUIValue()||0;
                t4=ns._margin_l.getUIValue()||0;
                if(t1 || t2 || t3 || t4)
                    margin = t1 +"px "+ t2 +"px "+ t3 +"px "+ t4 +"px";
                
                //radius 
                t1=parseInt(ns._radius_tl.getUIValue(),10)||0;
                t2=parseInt(ns._radius_tr.getUIValue(),10)||0;
                t3=parseInt(ns._radius_br.getUIValue(),10)||0;
                t4=parseInt(ns._radius_bl.getUIValue(),10)||0;
                if(t1 || t2 || t3 || t4)
                    radius = t1 +"px "+ t2 +"px "+ t3 +"px "+ t4 +"px";
                if(triggEvent!==false){
                    ns.fireEvent("onChange",[{
                        border:{
                            left:borderL,
                            top:borderT,
                            right:borderR,
                            bottom:borderB
                        },
                        margin:margin,
                        padding:padding,
                        "border-radius":radius
                    }]);
                }
                
                // show preview
                ns._preview(borderL, borderR, borderT, borderB, margin, padding, radius);                
            });
        },
        _preview:function(borderL, borderR, borderT, borderB, margin, padding, radius){
            var ns=this;
            ns.ood_ui_div_real.getRoot().css({
                borderLeft:borderL||0,
                borderTop:borderT||0,
                borderRight:borderR||0,
                borderBottom:borderB||0,
                margin:margin||0,
                padding:padding||0,
                borderRadius:radius||0
            });
        },
        _ood_ui_button10_onclick:function (profile, e, src, value){
           var ns=this;
            ns.init(null,{},null,2);
            ns._change(true);
        }
    }
});
﻿ood.Class('RAD.CustomBoxShadow', 'ood.Module',{
    Instance:{
        iniComponents : function(){
            // [[Code created by EUSUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"mainPane")
                .setLeft("5.833333333333333em")
                .setTop("3.3333333333333335em")
                .setWidth("18.333333333333332em")
                .setHeight("20em")
                .setShadow(false)
                .setResizer(false)
                .setCaption("$(RAD.custom_dlg.shadow.Custom Box Shadow)")
                .setMinBtn(false)
                .setMaxBtn(false)
                .beforeClose("_ctl_panel4_beforeclose")
            );
            
            host.mainPane.append(
                ood.create("ood.UI.Block")
                .setHost(host,"bg")
                .setDock("fill")
                .setBorderType("inset")
                .setOverflow("hidden")
                );
            
            host.bg.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"sd_clr")
                .setDirtyMark(false)
                .setLeft("0.75em")
                .setTop("3.3333333333333335em")
                .setWidth("15.833333333333334em")
                .setLabelSize(100)
                .setLabelGap("5.333333333333333px")
                .setLabelCaption("$(RAD.custom_dlg.shadow.Shadow Color)")
                .setType("color")
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.bg.append(
                ood.create("ood.UI.CheckBox")
                .setHost(host,"c_inset")
                .setDirtyMark(false)
                .setLeft("9.083333333333334em")
                .setTop("0.8333333333333334em")
                .setWidth("7.5em")
                .setCaption("$RAD.custom_dlg.shadow.Inset")
                .afterValueSet("_t_sd_afteruivalueset")
                );
            
            host.bg.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"sd_hl")
                .setDirtyMark(false)
                .setLeft("0.75em")
                .setTop("6em")
                .setWidth("15.833333333333334em")
                .setLabelSize(100)
                .setLabelGap("5.333333333333333px")
                .setLabelCaption("$(RAD.custom_dlg.shadow.Horizontal Length)")
                .setType("counter")
                .setUnit("px")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(0)
                .setMax(100)
                .onChange("_sd_hl_onchange")
                );
            
            host.bg.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"sd_vl")
                .setDirtyMark(false)
                .setLeft("0.75em")
                .setTop("8.916666666666666em")
                .setWidth("15.833333333333334em")
                .setLabelSize(100)
                .setLabelGap("5.333333333333333px")
                .setLabelCaption("$(RAD.custom_dlg.shadow.Vertical Length)")
                .setType("counter")
                .setUnit("px")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(0)
                .setMax(100)
                .onChange("_sd_vl_onchange")
                );
            
            host.bg.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"sd_br")
                .setDirtyMark(false)
                .setLeft("0.75em")
                .setTop("11.583333333333334em")
                .setWidth("15.833333333333334em")
                .setLabelSize(100)
                .setLabelGap("5.333333333333333px")
                .setLabelCaption("$(RAD.custom_dlg.shadow.Blur Radius)")
                .setType("counter")
                .setUnit("px")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(0)
                .setMax(100)
                .onChange("_sd_br_onchange")
                );
            
            host.bg.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"sd_sr")
                .setDirtyMark(false)
                .setLeft("0.75em")
                .setTop("14.166666666666666em")
                .setWidth("15.833333333333334em")
                .setLabelSize(100)
                .setLabelGap("5.333333333333333px")
                .setLabelCaption("$(RAD.custom_dlg.shadow.Spread Radius)")
                .setType("counter")
                .setUnit("px")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(0)
                .setMax(100)
                .onChange("_sd_sr_onchange")
                );
            
            return children;
            // ]]Code created by EUSUI RAD Studio
        },
        _getValues:function(){
            var ns=this;
            return {
                hl:parseInt(ns.sd_hl.getValue()),
                vl:parseInt(ns.sd_vl.getValue()),
                br:ns.sd_br.getValue(),
                sr:ns.sd_sr.getValue(),
                clr:ns.sd_clr.getValue(),
                inset:ns.c_inset.getValue()
            };
        },
        _t_sd_afteruivalueset : function (profile){
            ood.resetRun("boxShadow",this.setBR,0,null,this);
        },
        setBR:function(){
            var values = this._getValues(),v;
            if(!(values.clr || parseInt(values.hl) || parseInt(values.vl) || parseInt(values.br)|| parseInt(values.sr))){
                v='';
            }else{
                v=(values.inset?("inset "):"")+values.hl + "px " + values.vl + "px " + values.br + "px " + values.sr + "px " + values.clr;
            }
            this.fireEvent("onChange",[v]);
        },
        init:function(prf,tplkey,prop,type){
            var ns=this;
            ood.merge(ns.properties,prop,'all');

            var v = ((type==2 ? tplkey : ood.get(prf.CS,[tplkey, "box-shadow"]))||'').toLowerCase(),
                style, args, 
                hl,vl,br,sr,clr,opacity=1, inset;
            if(v){
                v = v.replace(/(?:rgb\((\d+), ?(\d+), ?(\d+)\)([^,]*))+/g,function(a,b,c,d,e){
                    return '#'+ood.UI.ColorPicker.rgb2hex(b, c, d) + e;
                });
                v = v.replace(/(?:rgba\((\d+), ?(\d+), ?(\d+), ?([.\d]+)\)([^,]*))+/g,function(a,b,c,d,e,f){
                    opacity = parseFloat(e)||1;
                    return '#'+ood.UI.ColorPicker.rgb2hex(b, c, d) + f;
                });
                ood.arr.each(v.split(/\s/),function(s){
                    if(/#/.test(s)){ 
                        clr = s;
                    }else if('inset'==s){
                        inset="inset";
                    }else{
                        if(!ood.isDefined(hl)) hl=parseFloat(s)||0;
                        else if(!ood.isDefined(vl)) vl=parseFloat(s)||0;
                        else if(!ood.isDefined(br)) br=parseFloat(s)||0;
                        else if(!ood.isDefined(sr)) sr=parseFloat(s)||0;
                    }
                });
            }
            
            if(!clr){
                hl=vl=br=sr=0;
                clr=inset='';
            }
            ns.c_inset.setValue(inset=="inset");
            ns.sd_hl.setValue(hl||0,true);
            ns.sd_vl.setValue(vl||0,true);
            ns.sd_br.setValue(br||0,true);
            ns.sd_sr.setValue(sr||0,true);
            ns.sd_clr.setValue(clr||0,true);
        },
        _ctl_panel4_beforeclose : function (profile){
            profile.boxing().hide();
            return false;
        },
        _sd_hl_onchange:function (profile){
            this._t_sd_afteruivalueset(profile);
        },
        _sd_vl_onchange:function (profile){
            this._t_sd_afteruivalueset(profile);
        },
        _sd_br_onchange:function (profile){
            this._t_sd_afteruivalueset(profile);
        },
        _sd_sr_onchange:function (profile){
            this._t_sd_afteruivalueset(profile);
        }
    }
});
﻿ood.Class('RAD.CustomTextShadow', 'ood.Module',{
    Instance:{
        iniComponents : function(){
            // [[Code created by ESDUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"mainPane")
                .setLeft("5.833333333333333em")
                .setTop("3.1666666666666665em")
                .setWidth("20em")
                .setHeight("15.166666666666666em")
                .setShadow(false)
                .setResizer(false)
                .setCaption("$(RAD.custom_dlg.shadow.Custom Text Shadow)")
                .setMinBtn(false)
                .setMaxBtn(false)
                .beforeClose("_ctl_panel4_beforeclose")
            );
            
            host.mainPane.append(
                ood.create("ood.UI.Block")
                .setHost(host,"bg")
                .setDock("fill")
                .setBorderType("inset")
                );
            
            host.bg.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"sd_clr")
                .setDirtyMark(false)
                .setLeft("1.5833333333333333em")
                .setTop("0.8333333333333334em")
                .setWidth("15.833333333333334em")
                .setLabelSize("108px")
                .setLabelCaption("$(RAD.custom_dlg.shadow.Shadow Color)")
                .setType("color")
                .onChange("_changed")
                );
            
            host.bg.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"sd_hl")
                .setDirtyMark(false)
                .setLeft("1.5833333333333333em")
                .setTop("3.5em")
                .setWidth("15.833333333333334em")
                .setLabelSize("108px")
                .setLabelCaption("$(RAD.custom_dlg.shadow.Horizontal Length)")
                .setType("counter")
                .setUnit("px")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(0)
                .setMax(100)
                .onChange("_changed")
                );
            
            host.bg.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"sd_vl")
                .setDirtyMark(false)
                .setLeft("1.5833333333333333em")
                .setTop("6.416666666666667em")
                .setWidth("15.833333333333334em")
                .setLabelSize("108px")
                .setLabelCaption("$(RAD.custom_dlg.shadow.Vertical Length)")
                .setType("counter")
                .setUnit("px")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(0)
                .setMax(100)
                .onChange("_changed")
                );
            
            host.bg.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"sd_br")
                .setDirtyMark(false)
                .setLeft("1.5833333333333333em")
                .setTop("9.083333333333334em")
                .setWidth("15.833333333333334em")
                .setLabelSize("108px")
                .setLabelCaption("$(RAD.custom_dlg.shadow.Blur Radius)")
                .setType("counter")
                .setUnit("px")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(0)
                .setMax(100)
                .onChange("_changed")
                );
            
            return children;
            // ]]Code created by ESDUI RAD Studio
        },
        _getValues:function(){
            var ns=this;
            return {
                hl:parseInt(ns.sd_hl.getValue()),
                vl:parseInt(ns.sd_vl.getValue()),
                br:ns.sd_br.getValue(),
                clr:ns.sd_clr.getValue()
            };
        },
        _changed : function (profile){
            ood.resetRun("textShadow",this.setBR,0,null,this);
        },
        setBR:function(){
            var values = this._getValues(),v;
            if(!(values.clr || parseInt(values.hl) || parseInt(values.vl) || parseInt(values.br))){
                v='';
            }else{
                v=values.hl + "px " + values.vl + "px " + values.br + "px " + values.clr;
            }
            this.fireEvent("onChange",[v]);
        },
        init:function(prf,tplkey,prop,type){
            var ns=this,
                hl,vl,br,clr,
                opacity=1;
            ood.merge(ns.properties,prop,'all');

            var v=type==2?tplkey:ood.get(prf.CS,[tplkey, "text-shadow"]);
            if(v){
                v = v.replace(/(?:rgb\((\d+), ?(\d+), ?(\d+)\)([^,]*))+/g,function(a,b,c,d,e){
                    return '#'+ood.UI.ColorPicker.rgb2hex(b, c, d) + e;
                });
                v = v.replace(/(?:rgba\((\d+), ?(\d+), ?(\d+), ?([.\d]+)\)([^,]*))+/g,function(a,b,c,d,e,f){
                    opacity = parseFloat(e)||1;
                    return '#'+ood.UI.ColorPicker.rgb2hex(b, c, d) + f;
                });
                var arr=/([\w]*)?\s*([-\.\d]+)(px)?\s*([-\.\d]+)(px)?\s*([-\.\d]+)(px)?\s*(\S*)?\s*([\w]*)?/.exec(v);
                if(arr&&arr.length){
                    hl=parseFloat(arr[2]);
                    vl=parseFloat(arr[4]);
                    br=parseFloat(arr[6]);
                    clr=arr[1]||arr[8];
                }
            }
            if(!clr){
                hl=vl=br=0;
                clr='';
            }
            ns.sd_hl.setValue(hl||0,true);
            ns.sd_vl.setValue(vl||0,true);
            ns.sd_br.setValue(br||0,true);
            ns.sd_clr.setValue(clr||0,true);
        },
        _ctl_panel4_beforeclose : function (profile){
            profile.boxing().hide();
            return false;
        }
    }
});
﻿ood.Class('RAD.CustomTransform', 'ood.Module',{
    Instance:{
        iniComponents : function(){
            // [[Code created by ESDUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"mainPane")
                .setLeft("3.125em")
                .setTop("0em")
                .setWidth("32.666666666666664em")
                .setHeight("14.916666666666666em")
                .setShadow(false)
                .setResizer(false)
                .setCaption("$(RAD.custom_dlg.trans.Custom Transform)")
                .setMinBtn(false)
                .setMaxBtn(false)
                .setOverflow("hidden")
                .beforeClose("_ctl_panel4_beforeclose")
            );
            
            host.mainPane.append(
                ood.create("ood.UI.Block")
                .setHost(host,"bg")
                .setDock("fill")
                .setBorderType("inset")
                .setOverflow("hidden")
                );
            
            host.bg.append(
                ood.create("ood.UI.Label")
                .setHost(host,"ctl_slabel4")
                .setLeft("0.9166666666666666em")
                .setTop("6.25em")
                .setWidth("5.25em")
                .setCaption("$(RAD.custom_dlg.trans.Scale X)")
                .setHAlign("left")
                );
            
            host.bg.append(
                ood.create("ood.UI.Label")
                .setHost(host,"ctl_slabel63")
                .setLeft("16.916666666666668em")
                .setTop("6.25em")
                .setWidth("5.25em")
                .setCaption("$(RAD.custom_dlg.trans.Scale Y)")
                .setHAlign("left")
                );
            
            host.bg.append(
                ood.create("ood.UI.Label")
                .setHost(host,"ctl_lblSkewX")
                .setLeft("0.9166666666666666em")
                .setTop("8.75em")
                .setWidth("5.25em")
                .setCaption("$(RAD.custom_dlg.trans.Skew X)")
                .setHAlign("left")
                );
            
            host.bg.append(
                ood.create("ood.UI.Label")
                .setHost(host,"ctl_slabel6")
                .setLeft("0.9166666666666666em")
                .setTop("3.75em")
                .setWidth("5.25em")
                .setCaption("$(RAD.custom_dlg.trans.Translate X)")
                .setHAlign("left")
                );
            
            host.bg.append(
                ood.create("ood.UI.Slider")
                .setHost(host,"t_Rotate")
                .setDirtyMark(false)
                .setLeft("6.666666666666667em")
                .setTop("0.8333333333333334em")
                .setWidth("25em")
                .setHeight("1.875em")
                .setSteps(360)
                .setIsRange(false)
                .setValue("0")
                .afterUIValueSet("_t_cs_afteruivalueset")
                );
            
            host.bg.append(
                ood.create("ood.UI.Slider")
                .setHost(host,"t_ScaleY")
                .setDirtyMark(false)
                .setLeft("22.25em")
                .setTop("5.916666666666667em")
                .setWidth("9.375em")
                .setHeight("1.875em")
                .setSteps(200)
                .setIsRange(false)
                .setValue("0")
                .afterUIValueSet("_t_cs_afteruivalueset")
                );
            
            host.bg.append(
                ood.create("ood.UI.Slider")
                .setHost(host,"t_ScaleX")
                .setDirtyMark(false)
                .setLeft("6.583333333333333em")
                .setTop("5.916666666666667em")
                .setWidth("9.375em")
                .setHeight("1.875em")
                .setSteps(200)
                .setIsRange(false)
                .setValue("0")
                .afterUIValueSet("_t_cs_afteruivalueset")
                );
            
            host.bg.append(
                ood.create("ood.UI.Label")
                .setHost(host,"ctl_slabel3")
                .setLeft("0.9166666666666666em")
                .setTop("1.25em")
                .setWidth("5.25em")
                .setCaption("$(RAD.custom_dlg.trans.Rotate)")
                .setHAlign("left")
                );
            
            host.bg.append(
                ood.create("ood.UI.Label")
                .setHost(host,"ctl_lblSkewY")
                .setLeft("16.916666666666668em")
                .setTop("8.75em")
                .setWidth("5.25em")
                .setCaption("$(RAD.custom_dlg.trans.Skew Y)")
                .setHAlign("left")
                );
            
            host.bg.append(
                ood.create("ood.UI.Label")
                .setHost(host,"ctl_slabel65")
                .setLeft("16.916666666666668em")
                .setTop("3.75em")
                .setWidth("5.25em")
                .setCaption("$(RAD.custom_dlg.trans.Translate Y)")
                .setHAlign("left")
                );
            
            host.bg.append(
                ood.create("ood.UI.Slider")
                .setHost(host,"t_SkewX")
                .setDirtyMark(false)
                .setLeft("6.583333333333333em")
                .setTop("8.416666666666666em")
                .setWidth("9.375em")
                .setHeight("1.875em")
                .setSteps(360)
                .setIsRange(false)
                .setValue("0")
                .afterUIValueSet("_t_cs_afteruivalueset")
                );
            
            host.bg.append(
                ood.create("ood.UI.Slider")
                .setHost(host,"t_SkewY")
                .setDirtyMark(false)
                .setLeft("22.25em")
                .setTop("8.416666666666666em")
                .setWidth("9.375em")
                .setHeight("1.875em")
                .setSteps(360)
                .setIsRange(false)
                .setValue("0")
                .afterUIValueSet("_t_cs_afteruivalueset")
                );
            
            host.bg.append(
                ood.create("ood.UI.Slider")
                .setHost(host,"t_TransY")
                .setDirtyMark(false)
                .setLeft("22.25em")
                .setTop("3.3333333333333335em")
                .setWidth("9.375em")
                .setHeight("1.875em")
                .setSteps(200)
                .setIsRange(false)
                .setValue("0")
                .afterUIValueSet("_t_cs_afteruivalueset")
                );
            
            host.bg.append(
                ood.create("ood.UI.Slider")
                .setHost(host,"t_TransX")
                .setDirtyMark(false)
                .setLeft("6.583333333333333em")
                .setTop("3.3333333333333335em")
                .setWidth("9.375em")
                .setHeight("1.875em")
                .setSteps(200)
                .setIsRange(false)
                .setValue("4")
                .afterUIValueSet("_t_cs_afteruivalueset")
                );
            
            return children;
            // ]]Code created by ESDUI RAD Studio
        },
        _getValues:function(){
            var ns=this;
            return {
                rotate:parseInt(ns.t_Rotate.getValue()),
                scale:[parseInt(ns.t_ScaleX.getValue())/100,  parseInt(ns.t_ScaleY.getValue())/100],
                skew:[parseInt(ns.t_SkewX.getValue())-180, parseInt(ns.t_SkewY.getValue())-180],
                translate:[parseInt(ns.t_TransX.getValue())-100, parseInt(ns.t_TransY.getValue())-100]
            };
        },
        _t_cs_afteruivalueset : function (profile){
            ood.resetRun("border_transform",this.setBR,0,null,this);
        },
        setBR:function(){
            var ns=this,prop=ns.properties,prop;
            var values = this._getValues(),v;
            if(prop.isSvg){
                if(!(parseInt(ns.t_Rotate.getValue()) || parseInt(ns.t_ScaleX.getValue(100)) || parseInt(ns.t_ScaleY.getValue(100))
                     || parseInt(ns.t_TransX.getValue()) || parseInt(ns.t_TransY.getValue())
                    )){
                    v='';
                }else{
                    v = "r"+values.rotate+"s"+values.scale.join(',')+"t"+values.translate.join(',');
                    v = v.replace("t0,0","").replace("s1,1","").replace("r0","");
                }
            }else{
                if(!(parseInt(ns.t_Rotate.getValue()) || parseInt(ns.t_ScaleX.getValue(100)) || parseInt(ns.t_ScaleY.getValue(100))
                     || parseInt(ns.t_SkewX.getValue()) || parseInt(ns.t_SkewY.getValue()) 
                     || parseInt(ns.t_TransX.getValue()) || parseInt(ns.t_TransY.getValue())
                    )){
                    v='';
                }else{
                    v =  ((values.translate[0]||values.translate[1])?("translate("+values.translate.join('px,')+"px) "):"") + 
                          (values.rotate?("rotate("+values.rotate+"deg) "):"") +  
                          ((values.scale[0]!=1||values.scale[1]!=1)?("scale("+values.scale.join(',')+") "):"") +  
                          ((values.skew[0]||values.skew[1])?("skew("+values.skew.join('deg,')+"deg)"):"") ;
                }
            }
            this.fireEvent("onChange",[v]);
        },
        init:function(prf,tplkey,prop,type){
            var ns=this;
            ood.merge(ns.properties,prop,'all');
            if(prop.isSvg){
                ns.ctl_lblSkewX.setDisplay('none',true);
                ns.ctl_lblSkewY.setDisplay('none',true);
                ns.t_SkewX.setDisplay('none',true);
                ns.t_SkewY.setDisplay('none',true);
                
                var v=prop.cell.value||"",
                    arr=Raphael.parseTransformString(v),
                    rotate=0,sx=100,sy=100,tx=100,ty=100;
                ood.arr.each(arr,function(a){
                    switch(a[0]){
                        case 'r':
                            rotate=ood.isSet(a[1])?a[1]:0;
                        break;
                        case 's':
                            sx=(ood.isSet(a[1])?a[1]:0)*100;
                            sy=(ood.isSet(a[2])?a[2]:0)*100;
                        break;
                        case 't':
                            tx=(ood.isSet(a[1])?a[1]:0)+100;
                            ty=(ood.isSet(a[2])?a[2]:0)+100;
                        break;
                    }
                });
                ns.t_Rotate.setValue(rotate);
                ns.t_ScaleX.setValue(sx);
                ns.t_ScaleY.setValue(sy);
                ns.t_TransX.setValue(tx);
                ns.t_TransY.setValue(ty);
            }else{
                var v=type==2?tplkey:ood.get(prf.CS,[tplkey, "transform"]),
                    arr=[null,0,1,1,0,0,0,0];
                if(v){
                    var functions = (v||"").match(/[A-z]+\([^\)]+/g) || [];
                    for (var k=0; k < functions.length; k++) {
                        //Prepare the function name and its value
                        var aa=functions[k].split('('),
                            func=aa[0],
                            value=aa[1],
                            values;
                        //Now we rotate through the functions and add it to our matrix
                        switch(func) {
                            case 'rotate':
                                arr[1]=parseFloat(value);
                                break;
                            case 'scale':
                                values = value.split(',');
                                arr[2]=parseFloat(values[0]);
                                arr[3]=parseFloat(values[1]);
                                break;
                            case 'scaleX':
                                arr[2]=parseFloat(values);
                                break;
                            case 'scaleY':
                                arr[3]=parseFloat(value);
                                break;
                            case 'skew':
                                values = value.split(',');
                                arr[4]=parseFloat(values[0]);
                                arr[5]=parseFloat(values[1]);
                                break;
                            case 'skewX':
                                arr[4]=parseFloat(value);
                                break;
                            case 'skewY':
                                arr[5]=parseFloat(value);
                                break;
                            case 'translate':
                                values = value.split(',');
                                arr[6]=parseFloat(values[0]);
                                arr[7]=parseFloat(values[1]);
                                break;
                            case 'translateX':
                                arr[6]=parseFloat(value);
                                break;
                            case 'translateY':
                                arr[7]=parseFloat(value);
                                break;
                            }
                    }
                }
 
                ns.ctl_lblSkewX.setDisplay('',true);
                ns.ctl_lblSkewY.setDisplay('',true);
                ns.t_SkewX.setDisplay('',true);
                ns.t_SkewY.setDisplay('',true);
    
                arr[1]=parseFloat(arr[1]);
                arr[2]=100*parseFloat(arr[2]);
                arr[3]=100*parseFloat(arr[3]);
                arr[4]=180+parseInt(arr[4]);
                arr[5]=180+parseInt(arr[5]);
                arr[6]=100+parseInt(arr[6]);
                arr[7]=100+parseInt(arr[7]);

                ns.t_Rotate.setValue(arr[1]);
                ns.t_ScaleX.setValue(arr[2]);
                ns.t_ScaleY.setValue(arr[3]);
                ns.t_SkewX.setValue(arr[4]);
                ns.t_SkewY.setValue(arr[5]);
                ns.t_TransX.setValue(arr[6]);
                ns.t_TransY.setValue(arr[7]);
            }
        },
        _ctl_panel4_beforeclose : function (profile){
            profile.boxing().hide();
            return false;
        }
    }
});
﻿// The default code is a com class (inherited from ood.Module)
ood.Class('RAD.CustomGradients', 'ood.Module',{
    Instance:{
        iniComponents : function(){
            // [[Code created by ESDUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"mainPane")
                .setLeft("4.375em")
                .setTop("1.875em")
                .setWidth("30.583333333333332em")
                .setHeight("24.416666666666668em")
                .setShadow(false)
                .setResizer(false)
                .setCaption("$(RAD.custom_dlg.gradlg.Custom Gradients)")
                .setMinBtn(false)
                .setMaxBtn(false)
                .beforeClose("_ctl_panel4_beforeclose")
            );
            
            host.mainPane.append(
                ood.create("ood.UI.Block")
                .setHost(host,"bg")
                .setDock("fill")
                .setBorderType("inset")
                .setOverflow("hidden")
                );
            
            host.bg.append(
                ood.create("ood.UI.Group")
                .setHost(host,"ctl_group11")
                .setLeft("0.8333333333333334em")
                .setTop("0.125em")
                .setWidth("27.5em")
                .setHeight("5.25em")
                .setOverflow("hidden")
                .setCaption("$(RAD.custom_dlg.Color Patterns)")
                .setCustomStyle({
                    "PANEL":"padding:2px;"
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr1")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#4ba3cc"
                            },
                            {
                                "pos":"50%",
                                "clr":"#3289B2"
                            },
                            {
                                "pos":"100%",
                                "clr":"#3899C6"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr2")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#A5B8DA"
                            },
                            {
                                "pos":"50%",
                                "clr":"#7089B3"
                            },
                            {
                                "pos":"100%",
                                "clr":"#819bcb"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr3")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#ffd65e"
                            },
                            {
                                "pos":"50%",
                                "clr":"#febf04"
                            },
                            {
                                "pos":"100%",
                                "clr":"#ffc926"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr4")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#606c88"
                            },
                            {
                                "pos":"50%",
                                "clr":"#3f4c6b"
                            },
                            {
                                "pos":"100%",
                                "clr":"#4b546a"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr5")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#d5cea6"
                            },
                            {
                                "pos":"50%",
                                "clr":"#b7ad70"
                            },
                            {
                                "pos":"100%",
                                "clr":"#c5bb83"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr6")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#a90329"
                            },
                            {
                                "pos":"50%",
                                "clr":"#6d0019"
                            },
                            {
                                "pos":"100%",
                                "clr":"#77021d"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr7")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#4ba614"
                            },
                            {
                                "pos":"50%",
                                "clr":"#008c00"
                            },
                            {
                                "pos":"100%",
                                "clr":"#36780f"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr8")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#ff5db1"
                            },
                            {
                                "pos":"50%",
                                "clr":"#ef007c"
                            },
                            {
                                "pos":"100%",
                                "clr":"#ff2a98"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span500")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#7d7e7d"
                            },
                            {
                                "pos":"50%",
                                "clr":"#0e0e0e"
                            },
                            {
                                "pos":"100%",
                                "clr":"#819bcb"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span501")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#cef8ff"
                            },
                            {
                                "pos":"50%",
                                "clr":"#7fe0f8"
                            },
                            {
                                "pos":"100%",
                                "clr":"#9bf1ff"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span502")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#f2f9fe"
                            },
                            {
                                "pos":"50%",
                                "clr":"#d6f0fd"
                            },
                            {
                                "pos":"100%",
                                "clr":"#c3e3fa"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span503")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#fb83fa"
                            },
                            {
                                "pos":"50%",
                                "clr":"#e93cec"
                            },
                            {
                                "pos":"100%",
                                "clr":"#f952f8"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span504")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#3093c7"
                            },
                            {
                                "pos":"50%",
                                "clr":"#1c5a85"
                            },
                            {
                                "pos":"100%",
                                "clr":"#26759e"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span505")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#a9db80"
                            },
                            {
                                "pos":"50%",
                                "clr":"#96c56f"
                            },
                            {
                                "pos":"100%",
                                "clr":"#8ed058"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span506")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#A5B8DA"
                            },
                            {
                                "pos":"50%",
                                "clr":"#7089B3"
                            },
                            {
                                "pos":"100%",
                                "clr":"#819bcb"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span507")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#b29af8"
                            },
                            {
                                "pos":"50%",
                                "clr":"#9174ed"
                            },
                            {
                                "pos":"100%",
                                "clr":"#8e6af5"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span508")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#f2f5f6"
                            },
                            {
                                "pos":"50%",
                                "clr":"#c8d7dc"
                            },
                            {
                                "pos":"100%",
                                "clr":"#d4dee1"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span509")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#ffc579"
                            },
                            {
                                "pos":"50%",
                                "clr":"#fb9d23"
                            },
                            {
                                "pos":"100%",
                                "clr":"#ffaf46"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span510")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#d3d3d3"
                            },
                            {
                                "pos":"50%",
                                "clr":"#707070"
                            },
                            {
                                "pos":"100%",
                                "clr":"#bababa"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span511")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#fcfac0"
                            },
                            {
                                "pos":"50%",
                                "clr":"#f6f283"
                            },
                            {
                                "pos":"100%",
                                "clr":"#faf68f"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span512")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#f4f5f5"
                            },
                            {
                                "pos":"50%",
                                "clr":"#dfdddd"
                            },
                            {
                                "pos":"100%",
                                "clr":"#d9dddd"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span513")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#f7e3e3"
                            },
                            {
                                "pos":"50%",
                                "clr":"#ffd7d7"
                            },
                            {
                                "pos":"100%",
                                "clr":"#ecbbbb"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span514")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#ff9a9a"
                            },
                            {
                                "pos":"50%",
                                "clr":"#ff4040"
                            },
                            {
                                "pos":"100%",
                                "clr":"#ff6767"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span515")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#a9a588"
                            },
                            {
                                "pos":"50%",
                                "clr":"#8e865b"
                            },
                            {
                                "pos":"100%",
                                "clr":"#938e6b"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span516")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#f62b2b"
                            },
                            {
                                "pos":"50%",
                                "clr":"#d20202"
                            },
                            {
                                "pos":"100%",
                                "clr":"#e40a0a"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span517")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#a67939"
                            },
                            {
                                "pos":"50%",
                                "clr":"#845108"
                            },
                            {
                                "pos":"100%",
                                "clr":"#805d2c"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span518")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#d2d2f9"
                            },
                            {
                                "pos":"50%",
                                "clr":"#a6a6f2"
                            },
                            {
                                "pos":"100%",
                                "clr":"#a5a5f3"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span519")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#49c0f0"
                            },
                            {
                                "pos":"50%",
                                "clr":"#2cafe3"
                            },
                            {
                                "pos":"100%",
                                "clr":"#1ab0ec"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span520")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#cedce7"
                            },
                            {
                                "pos":"50%",
                                "clr":"#596a72"
                            },
                            {
                                "pos":"100%",
                                "clr":"#acc4d6"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span521")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#b6e026"
                            },
                            {
                                "pos":"50%",
                                "clr":"#abdc28"
                            },
                            {
                                "pos":"100%",
                                "clr":"#95b91a"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span522")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#eab92d"
                            },
                            {
                                "pos":"50%",
                                "clr":"#c79810"
                            },
                            {
                                "pos":"100%",
                                "clr":"#cf9f15"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span523")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#45484d"
                            },
                            {
                                "pos":"50%",
                                "clr":"#000"
                            },
                            {
                                "pos":"100%",
                                "clr":"#819bcb"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span524")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#6bbed2"
                            },
                            {
                                "pos":"50%",
                                "clr":"#76bdd1"
                            },
                            {
                                "pos":"100%",
                                "clr":"#6bbed2"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span525")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#6bbed2"
                            },
                            {
                                "pos":"50%",
                                "clr":"#23538a"
                            },
                            {
                                "pos":"100%",
                                "clr":"#82bbd1"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.bg.append(
                ood.create("ood.UI.Label")
                .setHost(host,"ctl_slabel26")
                .setLeft("2.3333333333333335em")
                .setTop("6.5em")
                .setWidth("4em")
                .setHeight("0.875em")
                .setCaption("$RAD.custom_dlg.gradlg.Orientation")
                .setHAlign("left")
                );
            
            host.bg.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"t_otype")
                .setDirtyMark(false)
                .setLeft("7.416666666666667em")
                .setTop("6.25em")
                .setWidth("13.416666666666666em")
                .setType("listbox")
                .setItems([{
                    "id":"linear-LT",
                    "caption":"$(RAD.custom_dlg.gradlg.Linear $- from LeftTop)"
                },
                {
                    "id":"linear-T",
                    "caption":"$(RAD.custom_dlg.gradlg.Linear $- from Top)"
                },
                {
                    "id":"linear-RT",
                    "caption":"$(RAD.custom_dlg.gradlg.Linear $- from RightTop)"
                },
                {
                    "id":"linear-R",
                    "caption":"$(RAD.custom_dlg.gradlg.Linear $- from Right)"
                },
                {
                    "id":"linear-RB",
                    "caption":"$(RAD.custom_dlg.gradlg.Linear $- from RightBottom)"
                },
                {
                    "id":"linear-B",
                    "caption":"$(RAD.custom_dlg.gradlg.Linear $- from Bottom)"
                },
                {
                    "id":"linear-LB",
                    "caption":"$(RAD.custom_dlg.gradlg.Linear $- from LeftBottom)"
                },
                {
                    "id":"linear-L",
                    "caption":"$(RAD.custom_dlg.gradlg.Linear $- from Left)"
                },
                {
                    "id":"radial-C",
                    "caption":"$(RAD.custom_dlg.gradlg.Radial $- at Center)"
                },
                {
                    "id":"radial-LT",
                    "caption":"$(RAD.custom_dlg.gradlg.Radial $- at LeftTop)"
                },
                {
                    "id":"radial-T",
                    "caption":"$(RAD.custom_dlg.gradlg.Radial $- at Top)"
                },
                {
                    "id":"radial-RT",
                    "caption":"$(RAD.custom_dlg.gradlg.Radial $- at RightTop)"
                },
                {
                    "id":"radial-R",
                    "caption":"$(RAD.custom_dlg.gradlg.Radial $- at Right)"
                },
                {
                    "id":"radial-RB",
                    "caption":"$(RAD.custom_dlg.gradlg.Radial $- at RightBottom)"
                },
                {
                    "id":"radial-B",
                    "caption":"$(RAD.custom_dlg.gradlg.Radial $- at Bottom)"
                },
                {
                    "id":"radial-LB",
                    "caption":"$(RAD.custom_dlg.gradlg.Radial $- at LeftBottom)"
                },
                {
                    "id":"radial-L",
                    "caption":"$(RAD.custom_dlg.gradlg.Radial $- at Left)"
                }])
                .setValue("linear-T")
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.bg.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ctl_block3")
                .setLeft("1.25em")
                .setTop("8.75em")
                .setWidth("27.333333333333332em")
                .setHeight("1.5833333333333333em")
                .setBorderType("inset")
                .setOverflow("hidden")
                );
            
            host.ctl_block3.append(
                ood.create("ood.UI.Label")
                .setHost(host,"ctl_slabel5")
                .setLeft("23.25em")
                .setTop("0.1875em")
                .setCaption("$RAD.custom_dlg.gradlg.Opacity")
                );
            
            host.ctl_block3.append(
                ood.create("ood.UI.Label")
                .setHost(host,"ctl_slabel4")
                .setLeft("18.125em")
                .setTop("0.1875em")
                .setCaption("$RAD.custom_dlg.gradlg.Color")
                );
            
            host.ctl_block3.append(
                ood.create("ood.UI.Label")
                .setHost(host,"ctl_slabel3")
                .setLeft("9.875em")
                .setTop("0.1875em")
                .setCaption("$RAD.custom_dlg.gradlg.Offset")
                );
            
            host.ctl_block3.append(
                ood.create("ood.UI.Label")
                .setHost(host,"ctl_slabel6")
                .setLeft("1.875em")
                .setTop("0.125em")
                .setCaption("$RAD.custom_dlg.gradlg.Stops")
                );
            
            host.bg.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ctl_block7")
                .setLeft("1.25em")
                .setTop("10.333333333333334em")
                .setWidth("27.333333333333332em")
                .setBorderType("inset")
                .setOverflow("hidden")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.Slider")
                .setHost(host,"g_step1")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("5.583333333333333em")
                .setTop("0.4166666666666667em")
                .setWidth("10.166666666666666em")
                .setHeight("1.875em")
                .setSteps(100)
                .setIsRange(false)
                .setValue("0")
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"g_step1clr")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("15.833333333333334em")
                .setTop("0.4166666666666667em")
                .setWidth("6.583333333333333em")
                .setType("color")
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.Slider")
                .setHost(host,"g_step2")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("5.583333333333333em")
                .setTop("2.8333333333333335em")
                .setWidth("10.166666666666666em")
                .setHeight("1.875em")
                .setSteps(100)
                .setIsRange(false)
                .setValue("0")
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"g_step2clr")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("15.833333333333334em")
                .setTop("2.8333333333333335em")
                .setWidth("6.583333333333333em")
                .setType("color")
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.Slider")
                .setHost(host,"g_step3")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("5.583333333333333em")
                .setTop("5.166666666666667em")
                .setWidth("10.166666666666666em")
                .setHeight("1.875em")
                .setSteps(100)
                .setIsRange(false)
                .setValue("0")
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"g_step3clr")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("15.833333333333334em")
                .setTop("5.166666666666667em")
                .setWidth("6.583333333333333em")
                .setType("color")
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.CheckBox")
                .setHost(host,"c_step1")
                .setDirtyMark(false)
                .setLeft("0.5em")
                .setTop("0.5em")
                .setCaption("$(RAD.custom_dlg.gradlg.Stop 1)")
                .afterValueSet("_c_step1_aftervalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.CheckBox")
                .setHost(host,"c_step2")
                .setDirtyMark(false)
                .setLeft("0.5em")
                .setTop("2.9166666666666665em")
                .setCaption("$(RAD.custom_dlg.gradlg.Stop 2)")
                .afterValueSet("_c_step2_aftervalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.CheckBox")
                .setHost(host,"c_step3")
                .setDirtyMark(false)
                .setLeft("0.5em")
                .setTop("5.25em")
                .setCaption("$(RAD.custom_dlg.gradlg.Stop 3)")
                .afterValueSet("_c_step3_aftervalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.Slider")
                .setHost(host,"g_step4")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("5.583333333333333em")
                .setTop("7.583333333333333em")
                .setWidth("10.166666666666666em")
                .setHeight("1.875em")
                .setSteps(100)
                .setIsRange(false)
                .setValue("0")
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"g_step4clr")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("15.833333333333334em")
                .setTop("7.583333333333333em")
                .setWidth("6.583333333333333em")
                .setType("color")
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.CheckBox")
                .setHost(host,"c_step4")
                .setDirtyMark(false)
                .setLeft("0.5em")
                .setTop("7.666666666666667em")
                .setCaption("$(RAD.custom_dlg.gradlg.Stop 4)")
                .afterValueSet("_c_step4_aftervalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"g_step1o")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("22.5em")
                .setTop("0.4166666666666667em")
                .setWidth("4.333333333333333em")
                .setType("spin")
                .setIncrement(0.1)
                .setMin(0)
                .setMax(1)
                .setValue(1)
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"g_step2o")
                .setDirtyMark(false)
                .setLeft("22.5em")
                .setTop("2.8333333333333335em")
                .setWidth("4.333333333333333em")
                .setType("spin")
                .setIncrement(0.1)
                .setMin(0)
                .setMax(1)
                .setValue(1)
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"g_step3o")
                .setDirtyMark(false)
                .setLeft("22.5em")
                .setTop("5.166666666666667em")
                .setWidth("4.333333333333333em")
                .setType("spin")
                .setIncrement(0.1)
                .setMin(0)
                .setMax(1)
                .setValue(1)
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"g_step4o")
                .setDirtyMark(false)
                .setLeft("22.5em")
                .setTop("7.583333333333333em")
                .setWidth("4.333333333333333em")
                .setType("spin")
                .setIncrement(0.1)
                .setMin(0)
                .setMax(1)
                .setValue(0)
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.bg.append(
                ood.create("ood.UI.Button")
                .setHost(host,"ood_ui_button8")
                .setLeft("22.5em")
                .setTop("6.166666666666667em")
                .setWidth("5.833333333333333em")
                .setCaption("$(RAD.Clear)")
                .onClick("_ood_ui_button8_onclick")
                );
            
            return children;
            // ]]Code created by ESDUI RAD Studio
        },
        _getValues:function(){
            var ns=this,
                arr=[],h,i;

            if(ns.c_step1.getValue()){
                h={pos:ns.g_step1.getValue()+"%",clr:ns.g_step1clr.getValue()||"#ffffff"};
                i=ns.g_step1o.getValue();
                if(parseInt(i*100)!=100)
                    h.opacity=i;
                arr.push(h);
            }
            if(ns.c_step2.getValue()){
                h={pos:ns.g_step2.getValue()+"%",clr:ns.g_step2clr.getValue()||"#ffffff"};
                i=ns.g_step2o.getValue();
                if(parseInt(i*100)!=100)
                    h.opacity=i;
                arr.push(h);
            }
            if(ns.c_step3.getValue()){
                h={pos:ns.g_step3.getValue()+"%",clr:ns.g_step3clr.getValue()||"#ffffff"};
                i=ns.g_step3o.getValue();
                if(parseInt(i*100)!=100)
                    h.opacity=i;
                arr.push(h);
            }
            if(ns.c_step4.getValue()){
                h={pos:ns.g_step4.getValue()+"%",clr:ns.g_step4clr.getValue()||"#ffffff"};
                i=ns.g_step4o.getValue();
                if(parseInt(i*100)!=100)
                    h.opacity=i;
                arr.push(h);
            }
            if(arr.length)
                ood.arr.stableSort(arr,function(x,y){
                    return parseFloat(x.pos)>parseFloat(y.pos)?1:parseFloat(x.pos)==parseFloat(y.pos)?0:-1;
                });
            return  arr;
        },
        _t_sd_afteruivalueset : function (profile){
            ood.resetRun("Gradients",this.setTS,0,null,this);
        },
        setTS:function(){
            if(this._in_init)return;
                var ns=this,
                    ori = ns.t_otype.getValue();
            ood.resetRun("cgradies:"+this.$xid,function(){
                var v={
                    stops:ns._getValues()
                };
                ori=ori.split('-');
                v.type=ori[0];
                v.orient=ori[1];
                if(v.stops.length<=0)
                    v=null;
               
                ns.fireEvent("onChange",[v]);
            });
        },
        init:function(prf,tplkey,prop,type){
            var ns=this;
            ood.merge(ns.properties,prop,'all');

            ns._in_init=1;

            var v=type==2?tplkey:ood.get(prf.CS,[tplkey, "$gradient"]),
                type,op;
            if(!v){
               v={};
            }
            if(!v.type)v.type='linear';
            if(!v.orient)v.orient='T';
            if(!v.point)v.point='left';
            if(!v.stops)v.stops=[];

            type=v.type+"-"+v.orient;

            ns.t_otype.setValue(type);

            if(v.stops.length>0){
                ns.c_step1.setValue(true,true);
                ns.g_step1.setValue(v.stops[0].pos||0);
                ns.g_step1clr.setValue(v.stops[0].clr||"");
                op=v.stops[0].opacity;
                ns.g_step1o.setValue((op||op===0)?op:1);
            }else{
                ns.c_step1.setValue(false,true);
                ns.g_step1.setValue(0);
                ns.g_step1clr.setValue("");
                ns.g_step1o.setValue(1);
            }
            if(v.stops.length>1){
                ns.c_step2.setValue(true,true);
                ns.g_step2.setValue(v.stops[1].pos||0);
                ns.g_step2clr.setValue(v.stops[1].clr||"");
                op=v.stops[1].opacity;
                ns.g_step2o.setValue((op||op===0)?op:1);
            }else{
                ns.c_step2.setValue(false,true);
                ns.g_step2.setValue(0);
                ns.g_step2clr.setValue("");
                ns.g_step2o.setValue(1);
            }
            if(v.stops.length>2){
                ns.c_step3.setValue(true,true);
                ns.g_step3.setValue(v.stops[2].pos||0);
                ns.g_step3clr.setValue(v.stops[2].clr||"");
                op=v.stops[2].opacity;
                ns.g_step3o.setValue((op||op===0)?op:1);
            }else{
                ns.c_step3.setValue(false,true);
                ns.g_step3.setValue(0);
                ns.g_step3clr.setValue("");
                ns.g_step3o.setValue(1);
            }
            if(v.stops.length>3){
                ns.c_step4.setValue(true,true);
                ns.g_step4.setValue(v.stops[3].pos||0);
                ns.g_step4clr.setValue(v.stops[3].clr||"");
                op=v.stops[3].opacity;
                ns.g_step4o.setValue((op||op===0)?op:1);
            }else{
                ns.c_step4.setValue(false,true);
                ns.g_step4.setValue(0);
                ns.g_step4clr.setValue("");
                ns.g_step4o.setValue(1);
            }
            delete ns._in_init;
        },
        _ctl_panel4_beforeclose : function (profile){
            profile.boxing().hide();
            return false;
        },
        _c_step1_aftervalueset : function (profile, oldValue, newValue){
            var ns = this;
            ns.g_step1.setValue(0).setDisabled(!newValue);
            ns.g_step1clr.setValue("").setDisabled(!newValue);
            ns.g_step1o.setValue("1").setDisabled(!newValue);
            ns.setTS();
        },
        _c_step2_aftervalueset : function (profile, oldValue, newValue){
            var ns = this;
            ns.g_step2.setValue(0).setDisabled(!newValue);
            ns.g_step2clr.setValue("").setDisabled(!newValue);
            ns.g_step2o.setValue("1").setDisabled(!newValue);
            ns.setTS();
        },
        _c_step3_aftervalueset : function (profile, oldValue, newValue){
            var ns = this;
            ns.g_step3.setValue(0).setDisabled(!newValue);
            ns.g_step3clr.setValue("").setDisabled(!newValue);
            ns.g_step3o.setValue("1").setDisabled(!newValue);
            ns.setTS();
        },
        _c_step4_aftervalueset : function (profile, oldValue, newValue){
            var ns = this;
            ns.g_step4.setValue(0).setDisabled(!newValue);
            ns.g_step4clr.setValue("").setDisabled(!newValue);
            ns.g_step4o.setValue("1").setDisabled(!newValue);
            ns.setTS();
        },
        _clrpatternclicked:function (profile, e, value){
            var ns = this, cs=profile.CS.KEY,gradients=cs.$gradient,stops=gradients.stops;
           ns.c_step4.setValue(false,true);
           ns.g_step4.setValue(0);
           ns.g_step4clr.setValue("");
           ns.g_step4o.setValue(1);

           ns.c_step1.setValue(true,true);
           ns.g_step1.setValue(parseInt(stops[0].pos,10)||0);
           ns.g_step1clr.setValue(stops[0].clr||"");
           ns.g_step1o.setValue(1);

           ns.c_step2.setValue(true,true);
           ns.g_step2.setValue(parseInt(stops[1].pos,10)||0);
           ns.g_step2clr.setValue(stops[1].clr||"");
           ns.g_step2o.setValue(1);
           
            ns.c_step3.setValue(true,true);
            ns.g_step3.setValue(parseInt(stops[2].pos,10)||0);
            ns.g_step3clr.setValue(stops[2].clr||"");
            ns.g_step3o.setValue(1);
        },
        _ood_ui_button8_onclick:function (profile, e, src, value){
            var ns = this, uictrl = profile.boxing();
            ns.c_step4.setUIValue(false, true);
            ns.c_step3.setUIValue(false, true);
            ns.c_step2.setUIValue(false, true);
            ns.c_step1.setUIValue(false, true);
        }
    }
});
﻿ood.Class('RAD.CustomEffects', 'ood.Module',{
    Instance:{
        customAppend:function(){
            var ns=this,
                prop=ns.properties;
            ns.setTargetProfile(prop.targetProfile);
            ns.dialog.showModal();
            return true;
        },
        setTargetProfile:function(profile){
            var ns=this,
                prop=profile.properties,
                showEffects=prop.showEffects,
                hideEffects=prop.hideEffects;
            ns._resetEffects(showEffects, "show");
            ns._resetEffects(hideEffects, "hide");
        },
        iniComponents:function(){
            // [[Code created by EUSUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Gallery")
                .setHost(host,"gallery")
                .setShowEffects("Blur")
                .setLeft("0em")
                .setTop("0em")
                .setWidth(430)
                .setHeight(256)
                .setSelMode("none")
                .setItemWidth(84)
                .setItemHeight(84)
                .setImgWidth(80)
                .setImgHeight(80)
                .onItemSelected("_ctl_gallery_onitemselected")
                .setCustomStyle({
                    "ITEMS":{
                        "background-color":"#FFFFFF"
                    }
                }
                )
            );
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"dialog")
                .setLeft("9.875em")
                .setTop("1.75em")
                .setWidth("33.916666666666664em")
                .setHeight("23.416666666666668em")
                .setCaption("$(RAD.designer.effects.Custom Effects)")
                .setMinBtn(false)
                .setMaxBtn(false)
                .setRestoreBtn(false)
                .setOverflow("hidden")
                .beforeClose("_ctl_dialog_beforeclose")
            );
            
            host.dialog.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ctl_block192")
                .setDock("fill")
                .setDockMargin({
                    "left":0,
                    "top":0,
                    "right":0,
                    "bottom":34
                }
                )
                .setBorderType("inset")
                .setOverflow("hidden")
                );
            
            host.ctl_block192.append(
                ood.create("ood.UI.TreeGrid")
                .setHost(host,"tg")
                .setDirtyMark(false)
                .setEditable(true)
                .setGridHandlerCaption("$RAD.designer.effects.Attributes")
                .setRowHandlerWidth("7.5em")
                .setColSortable(false)
                .setHeader([{
                    "id":"show",
                    "caption":"$(RAD.designer.effects.Show Effects)",
                    "width":"11.666666666666666em",
                    "type":"input"
                },
                {
                    "id":"hide",
                    "caption":"$(RAD.designer.effects.Hide Effects)",
                    "width":"11.666666666666666em",
                    "type":"input"
                }])
                .setActiveMode("none")
                .setTreeMode('none')
                .setValue(",")
                .afterCellUpdated("_tg_aftercellupdated")
                );
            
            host.dialog.append(
                ood.create("ood.UI.Button")
                .setHost(host,"ctl_button15")
                .setLeft("18.25em")
                .setTop("17.75em")
                .setWidth("6.666666666666667em")
                .setImageClass("spafont spa-icon-cancel")
                .setCaption("$RAD.cancel")
                .onClick("_btncancel_onclick")
                );
            
            host.dialog.append(
                ood.create("ood.UI.Button")
                .setHost(host,"ctl_button16")
                .setLeft("25.75em")
                .setTop("17.75em")
                .setWidth("6.666666666666667em")
                .setImageClass("spafont spa-icon-ok")
                .setCaption("$RAD.ok")
                .onClick("_btnok_onclick")
                );
            
            host.dialog.append(
                ood.create("ood.UI.Button")
                .setHost(host,"btn_prev")
                .setTag("show")
                .setLeft("0.375em")
                .setTop("17.75em")
                .setWidth("7.5em")
                .setHeight("2.1666666666666665em")
                .setZIndex(1003)
                .setCaption("$(RAD.designer.effects.Preview Show)")
                .onClick("_ctl_preview_onclick")
                );
            
            host.dialog.append(
                ood.create("ood.UI.Button")
                .setHost(host,"ctl_next")
                .setTag("hide")
                .setLeft("8.333333333333334em")
                .setTop("17.75em")
                .setWidth("7.5em")
                .setHeight("2.1666666666666665em")
                .setZIndex(1003)
                .setCaption("$(RAD.designer.effects.Preview Hide)")
                .onClick("_ctl_preview_onclick")
                );
            
            append(
                ood.create("ood.UI.List")
                .setHost(host,"ctl_list")
                .setDirtyMark(false)
                .setLeft("0.5em")
                .setTop("13.625em")
                .setWidth("9.375em")
                .setHeight("auto")
                .onItemSelected("_ctl_list20_onitemselected")
            );
            
            return children;
            // ]]Code created by EUSUI RAD Studio
        }, 
        _sbutton3_onclick:function (profile, e, src, value) {
            var ns=this, args={},type=ns.list2.getUIValue(),fun=function(){
                if(ns.cWidth.getUIValue())args.width=[50,250];
                if(ns.cHeight.getUIValue())args.height=[50,250];
                if(ns.cLeft.getUIValue())args.left=[100,300];
                if(ns.cTop.getUIValue())args.top=[100,300];
                if(ns.cOpacity.getUIValue())args.opacity=[1,0.2];
                if(ns.cBackgroundColor.getUIValue())args.backgroundColor=['#ffffff','#000000'];
                if(ns.cScrollTop.getUIValue())args.scrollTop=[0,100];
                if(ns.cRotate.getUIValue())args.rotate=[0,360];
                if(ns.cscaleX.getUIValue())args.scaleX=[1,5];
                if(ns.cscaleY.getUIValue())args.scaleY=[1,5];
                if(ns.ctranslateX.getUIValue())args.translateX=[0,200];
                if(ns.ctranslateY.getUIValue())args.translateY=[0,200];
                if(ns.cskewX.getUIValue())args.skewX=[0,180];
                if(ns.cskewY.getUIValue())args.skewY=[0,180];

                if(!ood.isEmpty(args) && type){
                    var args2={}, target = ns.divDemo,
                        node=target.getRoot();
                    ood.each(args,function(o,i){
                        if(o[1])
                            args2[i]=[o[1],o[0]];
                        else
                            args2[i]=o;
                    });
                    node.animate(args,null,function(){
                        ood.asyRun(function(){
                            ns.divDemo.refresh();
                        },1000);
                    },300,0,type).start();
                }
            };
            fun();
        },
        events:{"onReady":"_com_onready", "onRender":"_com_onrender"},
        _com_onready:function (com, threadid){
            var ns=this,
                tg=ns.tg;

            var  rows = [];
            rows.push({
                "id":"predefined", 
                "caption":"$RAD.designer.effects.Predefined",
                "rowStyle":"font-weight:bold;text-align:center",
                "firstCellStyle":"font-weight:bold", 
                "type":"label",
                cells:[{
                },{
                }]
            });
            rows.push({
                "id":"type", 
                "caption":"$RAD.designer.effects.Type", 
                "type":"label",
                height:80,
                "rowStyle":"bold;text-align:center",
                cells:[{
                },{
                }]
            });
            rows.push({
                "id":"duration", 
                "caption":"$RAD.designer.effects.Duration(ms)", 
                "type":"spin", 
                numberTpl:'* ms',
                editorProperties:{
                    min:100,
                    max:5000,
                    increment:100,
                    precision:0
                },
                cells:[{
                },{
                }]
            });
            rows.push({
                "id":"opacity", 
                "caption":"$RAD.designer.effects.Opacity", 
                "type":"spin", 
                "value":100,
                numberTpl:'* %',
                editorProperties:{
                    min:0,
                    max:100,
                    increment:10,
                    precision:0
                },
                cells:[{
                },{
                }]
            });
            rows.push({
                "id":"rotate", 
                "caption":"$RAD.designer.effects.Rotate", 
                "type":"spin", 
                numberTpl:'* deg',
                editorProperties:{
                    min:0,
                    max:360,
                    increment:10,
                    precision:0
                },
                cells:[{
                },{
                }]
            });
            rows.push({
                "id":"scaleX", 
                "caption":"$(RAD.custom_dlg.trans.Scale X)", 
                "type":"spin", 
                precision:2,
                increment:0.1,
                cells:[{
                },{
                }]
            });
            rows.push({
                "id":"scaleY", 
                "caption":"$(RAD.custom_dlg.trans.Scale Y)", 
                "type":"spin", 
                precision:2,
                increment:0.1,
                cells:[{
                },{
                }]
            });
            rows.push({
                "id":"translateX", 
                "caption":"$(RAD.custom_dlg.trans.Translate X)", 
                "type":"spin", 
                numberTpl:'* %',
                editorProperties:{
                    min:-500,
                    max:500,
                    increment:10,
                    precision:0
                },
                cells:[{
                },{
                }]
            });
            rows.push({
                "id":"translateY", 
                "caption":"$(RAD.custom_dlg.trans.Translate Y)", 
                "type":"spin", 
                numberTpl:'* %',
                editorProperties:{
                    min:-500,
                    max:500,
                    increment:10,
                    precision:0
                },
                cells:[{
                },{
                }]
            });
            rows.push({
                "id":"skewX", 
                "caption":"$(RAD.custom_dlg.trans.Skew X)", 
                "type":"spin", 
                numberTpl:'* deg',
                editorProperties:{
                    min:0,
                    max:360,
                    increment:5,
                    precision:0
                },
                cells:[{
                },{
                }]
            });
            rows.push({
                "id":"skewY", 
                "caption":"$(RAD.custom_dlg.trans.Skew Y)", 
                "type":"spin", 
                numberTpl:'* deg',
                editorProperties:{
                    min:0,
                    max:360,
                    increment:5,
                    precision:0
                },
                cells:[{
                },{
                }]
            });
            tg.setRows(rows);
            
            
            var items=[{
                    id:'None',
                    caption:"$(RAD.designer.effects.None)"
                }];
            ood.each(ood.Dom.$preDefinedEffects,function(o,i){
                items.push({
                    id:i,
                    caption:'$(RAD.designer.effects.'+i+")",
                    data:o
                });
            });
            ns.ctl_list.setItems(items);

            items=[{
                id:"none",
                name:"none",
                imgWidth:60,
                imgHeight:60,
                image:ood.ini.img_blank
            }];
            ood.each(ood.Dom.$AnimateEffects,function(o,id){
                items.push({
                    id:id,
                    name:id,
                    image:ood.getPath("/RAD/img/","animate/"+id+".gif")
                });
            });
            ns.gallery.setItems(items);
        },
        _ctl_preview_onclick:function (profile, e, src, value){
            var ns = this,
                tag=profile.properties.tag,
                actor = ns.dialog.getRoot(),
                arr= ns._collectEffects();

            if(tag=="show"){
                var effects = arr[0] || ood.Dom._getEffects(arr[2],1);
                if(effects){
                    actor.css('visibility','hidden');
                    ood.asyRun(function(){
                        actor.css('visibility','visible');
                        actor.animate(effects.endpoints, null,null, effects.duration, null, effects.type).start();
                    },800);
                }
            }

            if(tag=="hide"){
                var effects = arr[1] || ood.Dom._getEffects(arr[3],0);
                if(effects){
                    actor.animate(effects.endpoints, null, function(){
                        ood.asyRun(function(){
                            actor.css({transform:"",opacity:"1", visibility:'visible'});
                        },800);
                    }, effects.duration, null, effects.type).start();
                }
            }
        },
        _collectEffects:function(){
            var ns=this, tg=ns.tg, rows=tg.getRows("data"), 
                showEffects={
                    endpoints:{}
                }, hideEffects={
                    endpoints:{}
                },s2,h2;
            
            ood.arr.each(rows,function(row){
                var cells= row.cells,v1=cells[0].value,v2=cells[1].value;
                switch(row.id){
                    case "predefined":
                        if(v1!="None")s2=v1;
                        if(v2!="None")h2=v2;
                        break;
                    case "type":
                        if(v1)showEffects.type=v1;
                        if(v2)hideEffects.type=v2;
                        break;
                    case "duration":
                        if(v1)showEffects.duration=v1;
                        if(v2)hideEffects.duration=v2;
                        break;
                    case "opacity":
                        if(v1||v1===0)
                            showEffects.endpoints.opacity=[parseFloat(v1)/100,1];
                        if(v2||v2===0)
                            hideEffects.endpoints.opacity=[1,parseFloat(v2)/100];
                        break;
                    case "rotate":
                        if(v1||v1===0)
                            showEffects.endpoints.rotate=[parseFloat(v1),0];
                        if(v2||v2===0)
                            hideEffects.endpoints.rotate=[0,parseFloat(v2)];
                        break;
                    case "scaleX":
                        if(v1||v1===0)
                            showEffects.endpoints.scaleX=[parseFloat(v1),1];
                        if(v2||v2===0)
                            hideEffects.endpoints.scaleX=[1,parseFloat(v2)];
                        break;
                    case "scaleY":
                        if(v1||v1===0)
                            showEffects.endpoints.scaleY=[parseFloat(v1),1];
                        if(v2||v2===0)
                            hideEffects.endpoints.scaleY=[1,parseFloat(v2)];
                        break;
                    case "translateX":
                        if(v1||v1===0)
                            showEffects.endpoints.translateX=[parseFloat(v1)+"%","0%"];
                        if(v2||v2===0)
                            hideEffects.endpoints.translateX=["0%",parseFloat(v2)+"%"];
                        break;
                    case "translateY":
                        if(v1||v1===0)
                            showEffects.endpoints.translateY=[parseFloat(v1)+"%","0%"];
                        if(v2||v2===0)
                            hideEffects.endpoints.translateY=["0%",parseFloat(v2)+"%"];
                        break;
                    case "skewX":
                        if(v1||v1===0)
                            showEffects.endpoints.skewX=[parseFloat(v1),0];
                        if(v2||v2===0)
                            hideEffects.endpoints.skewX=[0,parseFloat(v2)];
                        break;
                    case "skewY":
                        if(v1||v1===0)
                            showEffects.endpoints.skewY=[parseFloat(v1),0];
                        if(v2||v2===0)
                            hideEffects.endpoints.skewY=[0,parseFloat(v2)];
                        break;

                }
            });
            
            if(!showEffects.type||!showEffects.duration||!showEffects.endpoints||ood.isEmpty(showEffects.endpoints))showEffects=null;
            if(!hideEffects.type||!hideEffects.duration||!hideEffects.endpoints||ood.isEmpty(hideEffects.endpoints))hideEffects=null;
            return [showEffects, hideEffects, s2, h2];
        },
        _ctl_dialog_beforeclose:function (profile){
            profile.boxing().hide();
            return false;
        },
        _resetEffects:function(effects, colId){
            var ns=this, 
                tg=ns.tg,
                index=colId=="show"?0:1,
                values={}, endpoints,code="None",
                fun=function(o){return o||o===0?o:"";};

            if(ood.isStr(effects)){
                var conf=ood.Dom.$preDefinedEffects[effects];
                if(conf){
                    code=effects;
                    effects=conf[index];
                }
            }
            tg.updateCellByRowCol("predefined",colId, {value:code, caption:"$(RAD.designer.effects."+code+")"},false,false);

            endpoints=effects && effects.endpoints;

            tg.updateCellByRowCol("type", colId, {value:effects&&effects.type||""},false,true);
            tg.updateCellByRowCol("duration", colId, {value:fun(effects&&effects.duration||"")});
            tg.updateCellByRowCol("opacity", colId, {value:fun(endpoints&&endpoints.opacity && parseInt(endpoints.opacity[index]*100,10))});
            tg.updateCellByRowCol("rotate", colId, {value:fun(endpoints&&endpoints.rotate&&endpoints.rotate[index])});
            tg.updateCellByRowCol("scaleX", colId, {value:fun(endpoints&&endpoints.scaleX&&endpoints.scaleX[index])});
            tg.updateCellByRowCol("scaleY", colId, {value:fun(endpoints&&endpoints.scaleY&&endpoints.scaleY[index])});
            tg.updateCellByRowCol("translateX", colId, {value:fun(endpoints&&endpoints.translateX&&endpoints.translateX[index])});
            tg.updateCellByRowCol("translateY", colId, {value:fun(endpoints&&endpoints.translateY&&endpoints.translateY[index])});
            tg.updateCellByRowCol("skewX", colId, {value:fun(endpoints&&endpoints.skewY&&endpoints.skewY[index])});
            tg.updateCellByRowCol("skewY", colId, {value:fun(endpoints&&endpoints.skewY&&endpoints.skewY[index])});
        },
        _tg_aftercellupdated:function (profile, cell, options, isHotRow){
            if(!('value' in options))return ;
            
            var ns = this, uictrl = profile.boxing(),
                tg= ns.tg,
                col = uictrl.getColByCell(cell),
                row = uictrl.getRowbyCell(cell);
            switch(row.id){
                case "predefined":
                    ns._resetEffects(options.value, col.id);
                    break;

                case "type":
                    tg.getSubNodeInGrid("CELL","type",col.id)
                    .css('background', (cell.value&&cell.value!='none')? ('url(' +ood.getPath('/RAD/img/animate/',cell.value+".gif")+') center center no-repeat '): 'transparent');
                    if(cell.value=='none'){
                        ns._resetEffects({}, col.id);
                    }
                    break;
                default:
                    tg.updateCellByRowCol("predefined",col.id, {value:"None", caption:"$(RAD.designer.effects.None)"},false,false);
            }
                    
        },
        _btncancel_onclick:function (profile, e, src, value){
            this.dialog.close();
        },
        _btnok_onclick:function (profile, e, src, value){
            var ns = this,
                prop=ns.properties,
                target= prop.targetProfile,
                arr= ns._collectEffects();

            target.boxing().setShowEffects(arr[2]||arr[0]||"").setHideEffects(arr[3]||arr[1]||"");
            ns.fireEvent("onDirty");
            ns.fireEvent('onFinished');
            
            this.dialog.close();
        },
        _ctl_gallery_onitemselected:function(profile, item){
            profile.boxing().hide();
            this.tg.updateCellByRowCol("type",profile.properties.tag, {value:item.id},false,true);
        },
        _ctl_list20_onitemselected:function (profile, item, e, src, type){
            profile.boxing().hide();
            this.tg.updateCellByRowCol("predefined",profile.properties.tag, {value:item.id, caption:item.caption},false,true);
        },
        _com_onrender:function (com, threadid){
            com.tg.getSubNodeInGrid("CELL","type","show").hoverPop(com.gallery,'12',function(){
                com.gallery.setUIValue(null,true);
                com.gallery.setTag('show');
            },null,null,"$asdfa");
            com.tg.getSubNodeInGrid("CELL","type","hide").hoverPop(com.gallery,'12',function(){
                com.gallery.setUIValue(null,true);
                com.gallery.setTag('hide');
            },null,null,"$asdfa");
            com.tg.getSubNodeInGrid("CELL","predefined","show").hoverPop(com.ctl_list,'12',function(){
                com.ctl_list.setUIValue(null,true);
                com.ctl_list.setTag('show');
            },null,null,"$asdfb");
            com.tg.getSubNodeInGrid("CELL","predefined","hide").hoverPop(com.ctl_list,'12',function(){
                com.ctl_list.setUIValue(null,true);
                com.ctl_list.setTag('hide');
            },null,null,"$asdfb");
        }
    }
});
ood.Class('RAD.ActionsEditor', 'ood.Module', {
    Instance: {
        CAPMAP: {
            actiongroup: {
                'none:none': "None",
                'other:callback': "Function Calls",
                'other:var': "Assignment",
                'other:msg': "Message",
                'other:url': "System Functions",
                page: 'Page',
                'control': 'Control',
                module: 'Module'
            },
            action: {
                none: "None",
                'anim apply': 'Apply the animation to',
                setQueryData: "Set Query Data",
                setProperties: "Modify Properties",
                invoke: "Invoke",
                destroy: "Destroy",
                updateValue: "Update Value",
                resetValue: "Reset Value",
                clearValue: "Clear Value",
                getDirtied: "Get Dirtied",
                updateDataFromUI: "Update Data from UI",
                updateDataToUI: "Update Data to UI",
                start: "Start",
                suspend: "Suspend",
                animate: "Animate",
                activate: "Activate",
                disable: "Disable",
                enable: "Enable",
                hideItems: "Hide Items",
                showItems: "Show Items",
                busy: "Lock Screen",
                free: "Unlock Screen",
                show: "Show",
                hide: "Hide",
                popUp: "Pop to Front",
                setFormValues: "Fill Form",
                checkValid: "Form Validation",
                isDirtied: "Determine dirtied",
                setData: "Set Data",
                showModule2: "showModule2",
                getDate: "Get Data",
                checkRequired: "Check Required",
                formSubmit: "Submit Form",
                getFormValues: "Get form values",
                formReset: "Reset Form",
                formClear: "Clear Form",
                updateFormValues: "Update Form",
                getUIValue: "Get value",
                setUIValue: "Set value",
                setCaption: "Set caption",
                activeItem: "Activate Item",
                fireClickEvent: "Click it",
                fireItemClickEvent: "Click Item",
                dumpContainer: "Dump Container",
                setToggle: "Expand or Folding",
                toggleNode: "Expand or Folding",
                getHotRow: "Get hot row",
                isCellDirtied: "Is cell dirtied",
                updateCellValue: "Remove cell dirty",
                isRowDirtied: "Is row dirtied",
                updateRowValue: "Remove row dirty",
                updateHotRow: "Update hot row",
                getRowMap: "Get Cells Data",
                getHeaderByCell: "Get column by cell",
                getRowbyCell: "Get row by cell",
                resetCellValue: "Reset cell value",
                updateGridValue: "Remove grid dirty",
                toggleRow: "Expand or Folding",
                insertItems: "Add Items",
                updateItem: "Update Item",
                removeItems: "Remove Items",
                clearItems: "Clear Items",
                updateCellByRowCol2: "Update Cell",
                triggerFormulas: "Calculate grid formulas",
                setActiveRow: "Active Row",

                sortColumn: "Sort column",
                showColumn: "Show column",
                getActiveRow: "Get active row",
                autoRowHeight: "Auto row height",
                getCellbyRowCol: "Get cell",
                editCellbyRowCol: "To edit cell",
                focusCellbyRowCol: "Focus cell",
                getActiveCell: "Get active cell",
                setActiveCell: "Set active cell",
                getEditor: "Get editor",
                getEditCell: "Get cell in edit",
                offEditor: "Off editor",
                updateEditor: "Update editor",

                getRawData: "Get mapped rows",
                setRawData: "Set mapped rows",
                insertRows: "Add Rows",
                updateRow: "Update Row",
                setRowMap: "Update Cells",
                removeRows: "Remove Rows",
                removeAllRows: "Clear Rows",
                insertCol: "Add Column",
                updateHeader: "Update Header",
                removeCols: "Remove Columns",
                setHeader: "Clear All",
                editItem: "Edit Item",
                close: "Close Window",
                close2: "Close Dialog",
                showModal: "show modal",
                "open----_self": "Open in Currrent Window",
                "open----_blank": "Open to New Window",
                mailTo: "Send Email",
                selectFile: "Select File from Local Disk",
                readText: "Read Text form URL",
                readJSON: "Read JSON form URL",
                temp: "to Temp Object",
                "global": "to Global Object",
                "constant": "Constant",
                page: "to Page Object",
                "page.properties": "to Page Properties",
                "call": "Call Function",
                "set": "Set Function Global Reference",
                setCookies: "Set Cookies",
                setFI: "Set Fragment Identifier",
                message: "Open Float Message",
                pop: "Open Message Dialog",
                "alert": "Open Alert Dialog",
                "confirm": "Open Confirm Dialog",
                "prompt": "Open Prompt Dialog",
                "log": "Log to Console",
                "echo": "Echo to Debug Window",
                setProfiles: "Fill profile",
                setData: "Fill data",
                setValue: "Fill value",
                open: "Open in New Window",
                show2: "Switch to the page",
                initData: "initData",
                reloadParent: "reloadParent",
                postMessage: "Post Message to",
                broadcast: "Broadcast Message",
                getHooks: "Get hook",
                setHooks: "Set hook",
                notifyHooks: 'Notify hook',
                callFunction: 'Call function',
                fireEvent: 'Fire event',
                setTotalCount: "Set total count",
                getPage: "Get page",
                setPage: "Set page",
                getTotalPages: "get total page number",
                getJSONData: 'Get JSON Data',
                setJSONData: 'Set JSON Data',
                getXMLData: 'Get XML Data',
                setXMLData: 'Set XML Data',
                updateData: 'Update Data',
                setTheme: 'Set Theme',
                fillData: 'Fill Data',
                refreshChart: 'Refresh Chart',
                setSrc: 'Set media source',
                play: "Play",
                pause: "Pause",

                connect: "Connect",
                disconnect: "Disconnect",
                subscribe: "Subscribe",
                unsubscribe: "Unsubscribe",
                publish: "Publish"
            }
        },
        customAppend: function (parent, subId, left, top) {
            var ns = this,
                map1 = ns.CAPMAP.actiongroup,
                prop = ns.properties;

            ns.propFilter.setValue("", true);

            ns._hiddenDiv = ood.Dom.getEmptyDiv();
            //occupy it
            ns._hiddenDiv.html(" ");

            var fun = function (o) {
                o.id = ood.getClassName(o.id);
                if (!o.type) o.group = true;
                o._type = "page";
                delete o.tips;
                o.sub = true;
                // if (o.sub) {
                //     ood.filter(o.sub, function (o) {
                //         return o.id != SPA.currentPage;
                //     });
                //     ood.arr.each(o.sub, fun);
                // }
            };
            // for global functions setting dlg
            if (ood.get(prop.parent, ["_cls"])) {
                ood.filter(prop.pages, function (o) {
                    return o.id != SPA.currentPage;
                });
            }
            ood.arr.each(prop.pages, fun);


            var items = [{
                id: "none:none",
                caption: "$RAD.action." + map1["none:none"],
                imageClass: 'ri-checkbox-blank-line',
                cat: 'none',
                _type: "none"
            }, {
                id: 'other:msg',
                caption: "$(RAD.action." + map1["other:msg"] + ")",
                mageClass: 'ri-notification-line',
                _type: 'other'
            }, {
                id: 'other:var',
                caption: "$(RAD.action." + map1["other:var"] + ")",
                "imageClass": 'ri-text',
                _type: 'other'
            }, {
                id: 'other:callback',
                caption: "$(RAD.action." + map1["other:callback"] + ")",
                "imageClass": 'ri-function-line',
                _type: 'other'
            }, {
                id: 'other:url',
                caption: "$(RAD.action." + map1["other:url"] + ")",
                imageClass: 'ri-settings-line',
                _type: 'other'
            }];
            // for global functions setting dlg
            if (ood.get(prop.parent, ["_cls"])) {
                items.push({
                    id: SPA.currentPage ? ood.getClassName(SPA.currentPage) : (prop.className || "App"),
                    caption: "$(RAD.action." + map1['page'] + ")",
                    value: SPA.currentPage || "CurPage",
                    "imageClass": 'ri-file-list-line',
                    sub: prop.controls,
                    _type: "page"
                });
            }

            ns._tagVar = null;

            // if (prop.pages) {
            //     items.push({
            //         id: 'group:pages',
            //         caption: "$(RAD.action.Other Pages)",
            //         group: true,
            //         sub: prop.pages
            //     });
            // }

            items.push({
                id: 'group:pages',
                caption: "$(RAD.action.Other Pages)",
                group: true,
                sub: true
            });

            ns.tb_cat.setItems(items).setUIValue(null);

            ns.dialog.setCaption("$(RAD.action.Actions Editor)  " + (prop._cap ? (" : " + prop._cap) : ""));

            var panelitems = [{
                _iscon: 1,
                id: "none",
                caption: "$RAD.action.None",
                imageClass: 'ri-forbid-2-line'
            }], fun = function (alias, children) {
                if (children && children.length) {
                    ood.arr.each(children, function (o) {
                        var prf = o["0"];
                        if (prf.behavior && prf.behavior.PanelKeys && prf.behavior.PanelKeys.length) {
                            var a = ood.copy(alias);
                            var item = {};
                            a.push(prf.alias);
                            ood.arr.each(a, function (s) {
                                item["parent:" + s] = 1;
                            });

                            if (prf.properties.items) {
                                var ivs = [];
                                ood.arr.each(prf.properties.items, function (v) {
                                    var iv = ood.copy(item);
                                    iv.id = "{page." + prf.alias + "." + v.id + "}";
                                    iv.con = "{page." + prf.alias + "}";
                                    iv.consub = v.id;
                                    iv.caption = v.caption || v.id;
                                    iv._iscon = 1;
                                    ivs.push(iv);
                                });
                                var iv = ood.copy(item);
                                iv.id = "{page." + prf.alias + ".[key]}";
                                iv.con = "{page." + prf.alias + "}";
                                iv.consub = "[key]";
                                iv._iscon = 1;
                                iv.caption = "$(RAD.action.Other sub$-container)";
                                ivs.push(iv);

                                item.id = "{page." + prf.alias + "}";
                                item.caption = o.caption;
                                item.image = o.image;
                                item.imagePos = o.imagePos;
                                item.group = true;
                                item._iscon = 1;
                                item.sub = ivs;
                            } else {
                                item.id = item.con = "{page." + prf.alias + "}";
                                item.consub = null;
                                item.caption = o.caption;
                                item.image = o.image;
                                item.imagePos = o.imagePos;
                                item._iscon = 1;
                            }
                            panelitems.push(item);

                            if (o.sub) fun(a, o.sub);
                        }
                    });
                }
            };
            fun([], prop.controls);
            ns._panelitems = panelitems;
            ns._initctrls(true, true);

            ns.btn_ok.activate();

            ns.dialog.showModal(null, null, null, function () {
                var listitems = [];
                // set
                if (prop.actionConf) {
                    if (ood.isArr(prop.actionConf) || ood.isHash(prop.actionConf)) {
                        var arr = ood.isArr(prop.actionConf) ? prop.actionConf : prop.actionConf.actions,
                            rtn = ood.isHash(prop.actionConf) ? prop.actionConf['return'] : null;
                        if (arr) {
                            ood.arr.each(arr, function (o, i) {
                                if (ood.isHash(o)) {
                                    var item = {
                                        id: i + "",
                                        caption: o.desc || "",
                                        imageClass: 'ri-settings-line',
                                        tagVar: ood.clone(o, true)
                                    };
                                    // compatible
                                    if (item.tagVar && ('params' in item.tagVar)) {
                                        item.tagVar.args = item.tagVar.params;
                                        delete item.tagVar.params;
                                    }
                                    listitems.push(item);
                                }
                                else {
                                    // ignore string or function
                                }
                            });

                            ns.tb_actions.setItems(listitems);
                            if (listitems.length) {
                                ns._enablectrls();
                                ns.tb_actions.setUIValue(null);
                                // fire onchange,
                                // *** must aysc first time for load deep coms
                                ood.asyRun(function () {
                                    if (ns.tb_actions)
                                        ns.tb_actions.setUIValue(listitems[prop._selected || 0].id);
                                });
                            }

                            ns.btn_ok.activate();
                        }
                        if (rtn) {
                            ns.ood_returns.setValue(rtn, true);
                        }
                    } else {
                        // string or function
                    }
                }


                if (!listitems.length)
                    ns.addAction(ood.getRes("RAD.action.Action") + " 1");
                ns.markDirty(0);
            });

            ns._targetshadow = ns._targetshadow2 = null;
            return true;
        },
        markDirty: function (flag) {
            var ns = this;
            if (!flag || !ns._initvalue) {
                ns._dirty = flag;
            }
        },
        _initctrls: function (all, includeRtn) {
            var ns = this;
            if (all) ns.tb_actions.clearItems();
            ns.tb_actions.setUIValue(null).setDisabled(true);

            ns.ctl_grpp.setHtml("", true);

            // after tb_actions
            ns._initvalue = 1;
            if (includeRtn) ns.ood_returns.setValue("", true);
            ns.i_conl1.setValue("", true).setDisabled(true);
            ns.ctl_symbol1.setValue("defined", true).setDisabled(true);
            ns.i_conr1.setValue("", true).setDisabled(true);
            ns.i_conl2.setValue("", true).setDisabled(true);
            ns.ctl_symbol2.setValue("defined", true).setDisabled(true);
            ns.i_conr2.setValue("", true).setDisabled(true);
            ns.i_conl3.setValue("", true).setDisabled(true);
            ns.ctl_symbol3.setValue("defined", true).setDisabled(true);
            ns.i_conr3.setValue("", true).setDisabled(true);

            ns.add_pos.setValue("before", true).setDisabled(true);
            ns.add_target.setValue("", true).setDisabled(true);

            ns.log_v1.setValue("", true).setDisabled(false);
            ns.log_v2.setValue("", true).setDisabled(false);
            ns.log_v3.setValue("", true).setDisabled(false);
            ns.log_v4.setValue("", true).setDisabled(false);
            ns.log_v5.setValue("", true).setDisabled(false);

            ns.tb_mixsub.setValue("", true).setDisabled(true);
            ns.tb_consub.setValue("", true).setDisabled(true);

            ns.ctl_animate.setValue("blinkAlert", true).setDisabled(true);
            ns.ctl_animate.setTagVar(null).setInputReadonly(false, true).setCommandBtn("none", true);

            ns.ctl_varfrom.setValue("", true).setDisabled(true);
            ns.ctl_varfrom.setTagVar(null).setInputReadonly(false, true).setCommandBtn("none", true);
            ns.ctl_varfrompath.setValue("", true).setTagVar(null);

            ns.ctl_varto.setValue("", true).setDisabled(true);
            ns.ctl_adjust.setValue("", true).setDisabled(true);


            ns.cb_asy.setValue(false).setDisabled(true);
            ns.spin_asy.setValue(0).setDisabled(true);
            ns.cb_false.setValue(false).setDisabled(true);
            ns.tb_cat.setDisabled(true);
            ns.tb_action.setDisabled(true);

            ns.tb_cat.setValue("none:none", true);

            ns.cb_setid.setValue("").setDisabled(true);
            ns.cb_setvalue.setValue("").setDisabled(true);
            ns.cb_callid.setValue("").setDisabled(true);
            ns.grid_params.removeAllRows();
            ns.cb_callreturnto.setValue("none").setDisabled(true);
            ns.cb_callreturn.setValue("").setDisabled(true);
            ns.conf_return_exp.setHtml('');

            ns._initvalue = 0;
            // others
        },
        _enablectrls: function () {
            var ns = this;
            ns.tb_actions.setDisabled(false);
            ns.i_conl1.setDisabled(false);
            ns.ctl_symbol1.setDisabled(false);
            ns.i_conr1.setDisabled(true);
            ns.i_conl2.setDisabled(false);
            ns.ctl_symbol2.setDisabled(false);
            ns.i_conr2.setDisabled(true);
            ns.i_conl3.setDisabled(false);
            ns.ctl_symbol3.setDisabled(false);
            ns.i_conr3.setDisabled(true);
            ns.add_pos.setDisabled(false);

            ns.log_v1.setDisabled(false);
            ns.log_v2.setDisabled(false);
            ns.log_v3.setDisabled(false);
            ns.log_v4.setDisabled(false);
            ns.log_v5.setDisabled(false);

            ns.add_target.setDisabled(false);
            ns.ctl_animate.setDisabled(false);
            ns.ctl_varfrom.setDisabled(false);
            ns.ctl_varfrompath.setDisabled(false);
            ns.ctl_varto.setDisabled(false);
            ns.ctl_adjust.setDisabled(false);
            ns.tb_mixsub.setDisabled(false);
            ns.tb_consub.setDisabled(false);
            ns.cb_asy.setDisabled(false);
            ns.cb_false.setDisabled(false);
            ns.tb_cat.setDisabled(false);
            ns.tb_action.setDisabled(false);

            ns.cb_setid.setDisabled(false);
            ns.cb_setvalue.setDisabled(false);
            ns.cb_callid.setDisabled(false);
            ns.cb_callreturnto.setDisabled(false);
            ns.cb_callreturn.setDisabled(false);
        },
        iniComponents: function () {
            // [[Code created by EUSUI RAD Studio
            var host = this, children = [], append = function (child) {
                children.push(child.get(0));
            };

            append(
                ood.create("ood.UI.Dialog")
                    .setHost(host, "dialog")
                    .setLeft("0em")
                    .setTop("0em")
                    .setWidth("70em")
                    .setHeight("40em")
                    .setZIndex(1004)
                    .setCaption("$(RAD.action.Actions Editor)")
                    .setImageClass("ri-settings-line")
                    .setMinBtn(false)
                    .beforeClose("_beforeclose")
            );

            host.dialog.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ctl_block18")
                    .setDock("fill")
                    .setBorderType("none")
            );

            host.ctl_block18.append(
                ood.create("ood.UI.Layout")
                    .setHost(host, "ctl_layout11")
                    .setItems([
                        {
                            "id": "before",
                            "pos": "before",
                            "size": 130,
                            "min": 10,
                            "locked": false,
                            "folded": false,
                            "hidden": false,
                            "cmd": false
                        },
                        {
                            "id": "main",
                            "size": 642,
                            "min": 10
                        },
                        {
                            "id": "after",
                            "pos": "after",
                            "size": 29,
                            "min": 10,
                            "locked": false,
                            "folded": false,
                            "hidden": true,
                            "cmd": false
                        }
                    ])
                    .setType("horizontal")
                    .setCustomClass({
                        "PANEL": "ri-bg-bar"
                    })
            );

            host.ctl_layout11.append(
                ood.create("ood.UI.Panel")
                    .setHost(host, "ctl_panel16")
                    .setCaption("$(RAD.action.Actions List)")
                    .setBorderType("none")
                    .setNoFrame(true)
                , "before");

            host.ctl_panel16.append(
                ood.create("ood.UI.TreeView")
                    .setHost(host, "tb_actions")
                    .setInitFold(false)
                    .setDropKeys("_tb_action_configure")
                    .setDragKey("_tb_action_configure")
                    .onChange("_tb_actions_onchange")
                    .beforeEditApply("_tb_beforeapply")
                    .onDblclick("_tb_actions_ondblclick")
                    .afterDrop("_tb_action_drop")
            );

            host.ctl_panel16.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ctl_block66")
                    .setDock("top")
                    .setDockMargin({
                        "left": -3,
                        "top": 0,
                        "right": -3,
                        "bottom": 0
                    })
                    .setHeight("2.4166666666666665em")
                    .setBorderType("ridge")
                    .setOverflow("hidden")
            );

            host.ctl_block66.append(
                ood.create("ood.UI.ToolBar")
                    .setHost(host, "toolbar")
                    .setItems([
                        {
                            "id": "grp1",
                            "sub": [
                                {
                                    "id": "add",
                                    "caption": "",
                                    "imageClass": "ri-add-line",
                                    "tips": "$(RAD.action.Add Action)"
                                },
                                {
                                    "id": "remove",
                                    "caption": "",
                                    "imageClass": "ri-subtract-line",
                                    "tips": "$(RAD.action.Remove Action)"
                                },
                                {
                                    "id": "edit",
                                    "imageClass": "ri-edit-line",
                                    "caption": "",
                                    "tips": "$(RAD.action.Edit Item)"
                                }
                            ],
                            "caption": "grp1"
                        },
                        {
                            "id": "grp2",
                            "sub": [
                                {
                                    "id": "clear",
                                    "imageClass": "ri-delete-bin-line",
                                    "caption": "",
                                    "tips": "$(RAD.action.Clear All)"
                                }
                            ],
                            "caption": "grp2"
                        }
                    ])
                    .setHandler(false)
                    .setHAlign("center")
                    .onClick("_toolbar_onclick")
                    .setCustomStyle({
                        "ITEMS": "border-width:0 "
                    })
            );

            host.ctl_panel16.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ood_ui_block32")
                    .setDock("bottom")
                    .setLeft("5em")
                    .setTop("31.666666666666668em")
                    .setHeight("4.333333333333333em")
                    .setBorderType("none")
            );

            host.ood_ui_block32.append(
                ood.create("ood.UI.Input")
                    .setHost(host, "ood_returns")
                    .setTag(1)
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "left": 6,
                        "top": 0,
                        "right": 6,
                        "bottom": 0
                    })
                    .setLeft("0.75em")
                    .setTop("0.25em")
                    .setWidth("6.583333333333333em")
                    .setHeight("3.8333333333333335em")
                    .setLabelSize("1.8em")
                    .setLabelPos("top")
                    .setLabelCaption("$(RAD.action.Return value)")
                    .setLabelHAlign("left")
                    .onChange("_i_rtn_onchange")
            );

            host.ctl_layout11.append(
                ood.create("ood.UI.Group")
                    .setHost(host, "ctl_group1")
                    .setDock("width")
                    .setDockMargin({
                        "left": 10,
                        "top": 0,
                        "right": 100,
                        "bottom": 0
                    })
                    .setTop("0.4166666666666667em")
                    .setHeight("8.25em")
                    .setOverflow("hidden")
                    .setCaption("$(RAD.action.Action Conditions)")
                    .setToggleBtn(false)
                , "main");

            host.ctl_group1.append(
                ood.create("ood.UI.Div")
                    .setHost(host, "pan_condition")
                    .setDock("width")
                    .setLeft("0.8333333333333334em")
                    .setTop("0em")
                    .setWidth("40em")
                    .setHeight("2.1666666666666665em")
                    .setOverflow("hidden")
            );

            host.pan_condition.append(
                ood.create("ood.UI.Label")
                    .setHost(host, "ctl_slabel1")
                    .setLeft("0.75em")
                    .setTop("0.375em")
                    .setWidth("2.6666666666666665em")
                    .setCaption("$RAD.action.If")
            );

            host.pan_condition.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "i_conl1")
                    .setTag(1)
                    .setDirtyMark(false)
                    .setLeft("4.25em")
                    .setTop("0.125em")
                    .setWidth("19.666666666666668em")
                    .setType("none")
                    .onChange("_i_conl_onchange")
            );

            host.pan_condition.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "i_conr1")
                    .setTag(1)
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12,
                        "top": undefined,
                        "left": undefined,
                        "bottom": undefined
                    })
                    .setDockStretch("rearward")
                    .setLeft("31.416666666666668em")
                    .setTop("0.125em")
                    .setWidth("8em")
                    .setType("none")
                    .onChange("_i_conr_onchange")
            );

            host.pan_condition.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "ctl_symbol1")
                    .setTag(1)
                    .setDirtyMark(false)
                    .setLeft("24.25em")
                    .setTop("0.125em")
                    .setWidth("7em")
                    .setType("listbox")
                    .setDropListWidth(160)
                    .setItems([
                        {
                            "id": "defined",
                            "caption": "$(RAD.action.symbol.defined)"
                        },
                        {
                            "id": "undefined",
                            "caption": "$(RAD.action.symbol.undefined)"
                        },
                        {
                            "id": "empty",
                            "caption": "$(RAD.action.symbol.Is empty)"
                        },
                        {
                            "id": "non-empty",
                            "caption": "$(RAD.action.symbol.Is not empty)"
                        },
                        {
                            "id": "=",
                            "caption": "$(RAD.action.symbol.is)"
                        },
                        {
                            "id": "!=",
                            "caption": "$(RAD.action.symbol.is not)"
                        },
                        {
                            "id": ">",
                            "caption": "$(RAD.action.symbol.>)"
                        },
                        {
                            "id": "<",
                            "caption": "$(RAD.action.symbol.<)"
                        },
                        {
                            "id": ">=",
                            "caption": "$(RAD.action.symbol.>=)"
                        },
                        {
                            "id": "<=",
                            "caption": "$(RAD.action.symbol.<=)"
                        },
                        {
                            "id": "include",
                            "caption": "$(RAD.action.symbol.Contains)"
                        },
                        {
                            "id": "exclude",
                            "caption": "$(RAD.action.symbol.Does't Contain)"
                        },
                        {
                            "id": "start",
                            "caption": "$(RAD.action.symbol.Starts With)"
                        },
                        {
                            "id": "end",
                            "caption": "$(RAD.action.symbol.Ends With)"
                        },
                        {
                            "id": "objhaskey",
                            "caption": "$(RAD.action.symbol.Object contains key)"
                        },
                        {
                            "id": "objnokey",
                            "caption": "$(RAD.action.symbol.Object no key)"
                        },
                        {
                            "id": "arrhasvalue",
                            "caption": "$(RAD.action.symbol.Array contains value)"
                        },
                        {
                            "id": "arrnovalue",
                            "caption": "$(RAD.action.symbol.Array no value)"
                        },
                        {
                            "id": "objarrhaskey",
                            "caption": "$(RAD.action.symbol.Items contains id)"
                        },
                        {
                            "id": "objarrnokey",
                            "caption": "$(RAD.action.symbol.Items no id)"
                        }
                    ])
                    .setValue("defined")
                    .onChange("_ctl_symbol_onchange")
            );

            host.ctl_group1.append(
                ood.create("ood.UI.Div")
                    .setHost(host, "ctl_pane39")
                    .setDock("width")
                    .setLeft("0.8333333333333334em")
                    .setTop("2.1666666666666665em")
                    .setWidth("40em")
                    .setHeight("2.1666666666666665em")
                    .setOverflow("hidden")
            );

            host.ctl_pane39.append(
                ood.create("ood.UI.Label")
                    .setHost(host, "ctl_slabel41")
                    .setLeft("0.75em")
                    .setTop("0.375em")
                    .setWidth("2.6666666666666665em")
                    .setCaption("$(RAD.action.And)")
            );

            host.ctl_pane39.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "i_conl2")
                    .setTag(2)
                    .setDirtyMark(false)
                    .setLeft("4.25em")
                    .setTop("0.125em")
                    .setWidth("19.666666666666668em")
                    .setType("none")
                    .onChange("_i_conl_onchange")
            );

            host.ctl_pane39.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "i_conr2")
                    .setTag(2)
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12,
                        "top": undefined,
                        "left": undefined,
                        "bottom": undefined
                    })
                    .setDockStretch("rearward")
                    .setLeft("31.416666666666668em")
                    .setTop("0.125em")
                    .setWidth("8em")
                    .setType("none")
                    .onChange("_i_conr_onchange")
            );

            host.ctl_pane39.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "ctl_symbol2")
                    .setTag(2)
                    .setDirtyMark(false)
                    .setLeft("24.25em")
                    .setTop("0.125em")
                    .setWidth("7em")
                    .setType("listbox")
                    .setDropListWidth(160)
                    .setItems([
                        {
                            "id": "defined",
                            "caption": "$(RAD.action.symbol.defined)"
                        },
                        {
                            "id": "undefined",
                            "caption": "$(RAD.action.symbol.undefined)"
                        },
                        {
                            "id": "empty",
                            "caption": "$(RAD.action.symbol.Is empty)"
                        },
                        {
                            "id": "non-empty",
                            "caption": "$(RAD.action.symbol.Is not empty)"
                        },
                        {
                            "id": "=",
                            "caption": "$(RAD.action.symbol.is)"
                        },
                        {
                            "id": "!=",
                            "caption": "$(RAD.action.symbol.is not)"
                        },
                        {
                            "id": ">",
                            "caption": "$(RAD.action.symbol.>)"
                        },
                        {
                            "id": "<",
                            "caption": "$(RAD.action.symbol.<)"
                        },
                        {
                            "id": ">=",
                            "caption": "$(RAD.action.symbol.>=)"
                        },
                        {
                            "id": "<=",
                            "caption": "$(RAD.action.symbol.<=)"
                        },
                        {
                            "id": "include",
                            "caption": "$(RAD.action.symbol.Contains)"
                        },
                        {
                            "id": "exclude",
                            "caption": "$(RAD.action.symbol.Does't Contain)"
                        },
                        {
                            "id": "start",
                            "caption": "$(RAD.action.symbol.Starts With)"
                        },
                        {
                            "id": "end",
                            "caption": "$(RAD.action.symbol.Ends With)"
                        },
                        {
                            "id": "objhaskey",
                            "caption": "$(RAD.action.symbol.Object contains key)"
                        },
                        {
                            "id": "objnokey",
                            "caption": "$(RAD.action.symbol.Object no key)"
                        },
                        {
                            "id": "arrhasvalue",
                            "caption": "$(RAD.action.symbol.Array contains value)"
                        },
                        {
                            "id": "arrnovalue",
                            "caption": "$(RAD.action.symbol.Array no value)"
                        },
                        {
                            "id": "objarrhaskey",
                            "caption": "$(RAD.action.symbol.Items contains id)"
                        },
                        {
                            "id": "objarrnokey",
                            "caption": "$(RAD.action.symbol.Items no id)"
                        }
                    ])
                    .setValue("defined")
                    .onChange("_ctl_symbol_onchange")
            );

            host.ctl_group1.append(
                ood.create("ood.UI.Div")
                    .setHost(host, "ctl_pane41")
                    .setDock("width")
                    .setLeft("0.8333333333333334em")
                    .setTop("4.25em")
                    .setWidth("40em")
                    .setHeight("2.1666666666666665em")
                    .setOverflow("hidden")
            );

            host.ctl_pane41.append(
                ood.create("ood.UI.Label")
                    .setHost(host, "ctl_slabel42")
                    .setLeft("0.75em")
                    .setTop("0.375em")
                    .setWidth("2.6666666666666665em")
                    .setCaption("$(RAD.action.And)")
            );

            host.ctl_pane41.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "i_conl3")
                    .setTag(3)
                    .setDirtyMark(false)
                    .setLeft("4.25em")
                    .setTop("0.125em")
                    .setWidth("19.666666666666668em")
                    .setType("none")
                    .onChange("_i_conl_onchange")
            );

            host.ctl_pane41.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "i_conr3")
                    .setTag(3)
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12,
                        "top": undefined,
                        "left": undefined,
                        "bottom": undefined
                    })
                    .setDockStretch("rearward")
                    .setLeft("31.416666666666668em")
                    .setTop("0.125em")
                    .setWidth("8em")
                    .setType("none")
                    .onChange("_i_conr_onchange")
            );

            host.ctl_pane41.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "ctl_symbol3")
                    .setTag(3)
                    .setDirtyMark(false)
                    .setLeft("24.25em")
                    .setTop("0.125em")
                    .setWidth("7em")
                    .setType("listbox")
                    .setDropListWidth(160)
                    .setItems([
                        {
                            "id": "defined",
                            "caption": "$(RAD.action.symbol.defined)"
                        },
                        {
                            "id": "undefined",
                            "caption": "$(RAD.action.symbol.undefined)"
                        },
                        {
                            "id": "empty",
                            "caption": "$(RAD.action.symbol.Is empty)"
                        },
                        {
                            "id": "non-empty",
                            "caption": "$(RAD.action.symbol.Is not empty)"
                        },
                        {
                            "id": "=",
                            "caption": "$(RAD.action.symbol.is)"
                        },
                        {
                            "id": "!=",
                            "caption": "$(RAD.action.symbol.is not)"
                        },
                        {
                            "id": ">",
                            "caption": "$(RAD.action.symbol.>)"
                        },
                        {
                            "id": "<",
                            "caption": "$(RAD.action.symbol.<)"
                        },
                        {
                            "id": ">=",
                            "caption": "$(RAD.action.symbol.>=)"
                        },
                        {
                            "id": "<=",
                            "caption": "$(RAD.action.symbol.<=)"
                        },
                        {
                            "id": "include",
                            "caption": "$(RAD.action.symbol.Contains)"
                        },
                        {
                            "id": "exclude",
                            "caption": "$(RAD.action.symbol.Does't Contain)"
                        },
                        {
                            "id": "start",
                            "caption": "$(RAD.action.symbol.Starts With)"
                        },
                        {
                            "id": "end",
                            "caption": "$(RAD.action.symbol.Ends With)"
                        },
                        {
                            "id": "objhaskey",
                            "caption": "$(RAD.action.symbol.Object contains key)"
                        },
                        {
                            "id": "objnokey",
                            "caption": "$(RAD.action.symbol.Object no key)"
                        },
                        {
                            "id": "arrhasvalue",
                            "caption": "$(RAD.action.symbol.Array contains value)"
                        },
                        {
                            "id": "arrnovalue",
                            "caption": "$(RAD.action.symbol.Array no value)"
                        },
                        {
                            "id": "objarrhaskey",
                            "caption": "$(RAD.action.symbol.Items contains id)"
                        },
                        {
                            "id": "objarrnokey",
                            "caption": "$(RAD.action.symbol.Items no id)"
                        }
                    ])
                    .setValue("defined")
                    .onChange("_ctl_symbol_onchange")
            );

            host.ctl_layout11.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ctl_block14")
                    .setDock("fill")
                    .setDockMargin({
                        "left": 0,
                        "top": 110,
                        "right": 0,
                        "bottom": 0
                    })
                    .setBorderType("none")
                , "main");

            host.ctl_block14.append(
                ood.create("ood.UI.Div")
                    .setHost(host, "ctl_pane17")
                    .setDock("fill")
            );

            host.ctl_pane17.append(
                ood.create("ood.UI.Layout")
                    .setHost(host, "ctl_layout8")
                    .setItems([
                        {
                            "id": "before",
                            "size": 200,
                            "min": 10,
                            "locked": false,
                            "folded": false,
                            "hidden": false,
                            "cmd": false,
                            "pos": "before"
                        },
                        {
                            "id": "main",
                            "size": 492,
                            "min": 10
                        },
                        {
                            "id": "after",
                            "size": 80,
                            "min": 10,
                            "locked": false,
                            "folded": false,
                            "hidden": true,
                            "cmd": false,
                            "pos": "after"
                        }
                    ])
                    .setType("horizontal")
                    .setCustomClass({
                        "PANEL": "ri-bg-bar"
                    })
            );

            host.ctl_layout8.append(
                ood.create("ood.UI.Panel")
                    .setHost(host, "ctl_panel7")
                    .setCaption("1.$(RAD.action.Select category/target)")
                    .setBorderType("none")
                    .setNoFrame(true)
                , "before");

            host.ctl_panel7.append(
                ood.create("ood.UI.TreeView")
                    .setHost(host, "tb_cat")
                    .setInitFold(false)
                    .onChange("_tb_cat_onchange")
                    .onGetContent("_treebarprj_onGetContent")
            );

            host.ctl_panel7.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "blk_target")
                    .setDock("top")
                    .setDockMargin({
                        "left": -3,
                        "top": 0,
                        "right": -3,
                        "bottom": 0
                    })
                    .setHeight("2.25em")
                    .setBorderType("ridge")
                    .setOverflow("hidden")
                    .setCustomStyle({
                        "PANEL": "white-space: nowrap;"
                    })
            );

            host.blk_target.append(
                ood.create("ood.UI.Label")
                    .setHost(host, "lbl_target")
                    .setLeft("0.625em")
                    .setTop("0.3125em")
                    .setWidth("7.6875em")
                    .setCaption("")
                    .setHAlign("left")
                    .setCustomStyle({
                        "KEY": {
                            "overflow": "visible"
                        }
                    })
            );

            host.ctl_layout8.append(
                ood.create("ood.UI.Layout")
                    .setHost(host, "ctl_layout17")
                    .setItems([
                        {
                            "id": "before",
                            "size": 180,
                            "min": 10,
                            "locked": false,
                            "folded": false,
                            "hidden": false,
                            "cmd": false,
                            "pos": "before"
                        },
                        {
                            "id": "main",
                            "size": 372,
                            "min": 10
                        },
                        {
                            "id": "after",
                            "size": 29,
                            "min": 10,
                            "locked": false,
                            "folded": false,
                            "hidden": true,
                            "cmd": false,
                            "pos": "after"
                        }
                    ])
                    .setType("horizontal")
                    .setCustomClass({
                        "PANEL": "ri-bg-bar"
                    })
                , "main");

            host.ctl_layout17.append(
                ood.create("ood.UI.Panel")
                    .setHost(host, "ctl_panel8")
                    .setCaption("2.$(RAD.action.Select action)")
                    .setBorderType("none")
                    .setNoFrame(true)
                , "before");

            host.ctl_panel8.append(
                ood.create("ood.UI.TreeView")
                    .setHost(host, "tb_action")
                    .setInitFold(false)
                    .onChange("_tb_action_onchange")
            );

            host.ctl_panel8.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ctl_action")
                    .setDock("top")
                    .setDockMargin({
                        "left": -3,
                        "top": 0,
                        "right": -3,
                        "bottom": 0
                    })
                    .setHeight("2.25em")
                    .setBorderType("ridge")
                    .setOverflow("hidden")
                    .setCustomStyle({
                        "PANEL": "white-space: nowrap;"
                    })
            );

            host.ctl_action.append(
                ood.create("ood.UI.Label")
                    .setHost(host, "lbl_action")
                    .setLeft("0.75em")
                    .setTop("0.3125em")
                    .setWidth("5.5625em")
                    .setCaption("")
                    .setHAlign("left")
                    .setCustomStyle({
                        "KEY": {
                            "overflow": "visible"
                        }
                    })
            );

            host.ctl_layout17.append(
                ood.create("ood.UI.Panel")
                    .setHost(host, "ctl_panel9")
                    .setPanelBgClr("#FFFFFF")
                    .setCaption("3.$(RAD.action.Configure action)")
                    .setBorderType("none")
                    .setNoFrame(true)
                , "main");

            host.ctl_panel9.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ctl_block103")
                    .setDock("top")
                    .setDockMargin({
                        "left": -3,
                        "top": 0,
                        "right": -3,
                        "bottom": 0
                    })
                    .setHeight("2.25em")
                    .setZIndex(5)
                    .setBorderType("ridge")
                    .setOverflow("hidden")
            );

            host.ctl_block103.append(
                ood.create("ood.UI.CheckBox")
                    .setHost(host, "cb_asy")
                    .setDirtyMark(false)
                    .setLeft("0.9375em")
                    .setTop("0.08333333333333333em")
                    .setWidth("7.333333333333333em")
                    .setHeight("1.5833333333333333em")
                    .setCaption("$RAD.action.Async")
                    .onChange("_cb_asy_onchange")
            );

            host.ctl_block103.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "spin_asy")
                    .setDirtyMark(false)
                    .setLeft("8.25em")
                    .setTop("0.08333333333333333em")
                    .setWidth("5.833333333333333em")
                    .setHeight("1.75em")
                    .setType("spin")
                    .setPrecision(0)
                    .setIncrement(100)
                    .setValue(0)
                    .onChange("_spin_asy_onchange")
            );

            host.ctl_block103.append(
                ood.create("ood.UI.Label")
                    .setHost(host, "ctl_slabel25")
                    .setLeft("14.25em")
                    .setTop("0.3333333333333333em")
                    .setHeight("1.0833333333333333em")
                    .setCaption("$RAD.action.ms")
            );

            host.ctl_block103.append(
                ood.create("ood.UI.CheckBox")
                    .setHost(host, "cb_false")
                    .setDirtyMark(false)
                    .setLeft("17.333333333333332em")
                    .setTop("0.08333333333333333em")
                    .setWidth("23.333333333333332em")
                    .setHeight("1.5833333333333333em")
                    .setCaption("$(RAD.action.Abort subsequent execution)")
                    .onChange("_false_change")
            );

            host.ctl_panel9.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ctl_block33")
                    .setDock("fill")
                    .setDockMargin({
                        "left": -3,
                        "top": -3,
                        "right": 0,
                        "bottom": 0
                    })
                    .setZIndex(4)
                    .setBorderType("inset")
            );

            host.ctl_block33.append(
                ood.create("ood.UI.Tabs")
                    .setHost(host, "tab_conf")
                    .setItems([
                        {
                            "id": "none",
                            "caption": "none"
                        },
                        {
                            "id": "selfile",
                            "caption": "selfile"
                        },
                        {
                            "id": "page",
                            "caption": "page"
                        },
                        {
                            "id": "fmsg",
                            "caption": "fmsg"
                        },
                        {
                            "id": "datatransfer",
                            "caption": "datatransfer"
                        },
                        {
                            "id": "url",
                            "caption": "url"
                        },
                        {
                            "id": "prop",
                            "caption": "prop"
                        },
                        {
                            "id": "json",
                            "caption": "json"
                        },
                        {
                            "id": "con",
                            "caption": "con"
                        },
                        {
                            "id": "msg",
                            "caption": "msg"
                        },
                        {
                            "id": "data",
                            "caption": "data"
                        },
                        {
                            "id": "switch",
                            "caption": "switch"
                        },
                        {
                            "id": "var",
                            "caption": "var"
                        },
                        {
                            "id": "mix",
                            "caption": "mix"
                        },
                        {
                            "id": "setcb",
                            "caption": "setcb"
                        },
                        {
                            "id": "callcb",
                            "caption": "callcb"
                        },
                        {
                            "id": "log",
                            "caption": "log"
                        },
                        {
                            "id": "animate",
                            "caption": "animate"
                        }
                    ])
                    .setNoHandler(true)
                    .setValue("callcb")
            );

            host.tab_conf.append(
                ood.create("ood.UI.Span")
                    .setHost(host, "ctl_span1")
                    .setLeft("15.416666666666666em")
                    .setTop("11.083333333333334em")
                    .setWidth("1.625em")
                    .setHtml("px")
                , "fmsg");

            host.tab_conf.append(
                ood.create("ood.UI.Span")
                    .setHost(host, "ctl_span2")
                    .setLeft("15.416666666666666em")
                    .setTop("13.75em")
                    .setWidth("2.25em")
                    .setHtml("$RAD.action.ms")
                , "fmsg");

            host.tab_conf.append(
                ood.create("ood.UI.Panel")
                    .setHost(host, "ctl_tocon")
                    .setCaption("$(RAD.action.Select Target Node)")
                , "con");

            host.ctl_tocon.append(
                ood.create("ood.UI.TreeView")
                    .setHost(host, "tb_con")
                    .setInitFold(false)
                    .onChange("_tb_con_onchange")
            );

            host.tab_conf.append(
                ood.create("ood.UI.Span")
                    .setHost(host, "msg_inputm")
                    .setLeft("0.9166666666666666em")
                    .setTop("11.583333333333334em")
                    .setWidth("24.25em")
                    .setHeight("1.3333333333333333em")
                    .setHtml("$(RAD.action.msg.Notice: The prompt input will be set to {temp$.okData})")
                , "msg");

            host.tab_conf.append(
                ood.create("ood.UI.Span")
                    .setHost(host, "msg_m")
                    .setDock("bottom")
                    .setDockMargin({
                        "left": 10,
                        "top": 0,
                        "right": 10,
                        "bottom": 2
                    })
                    .setHeight("auto")
                    .setHtml("<div style='color:red;'> $(RAD.action.msg.Asynchronous action causes the later actions to be blocked until it succeeds or fails) </div>")
                , "msg");

            host.tab_conf.append(
                ood.create("ood.UI.Panel")
                    .setHost(host, "ctl_panel29")
                    .setCaption("$(RAD.action.Select Target Node)")
                , "mix");

            host.ctl_panel29.append(
                ood.create("ood.UI.TreeView")
                    .setHost(host, "add_target")
                    .setInitFold(false)
                    .onChange("_add_target_onchange")
            );

            host.tab_conf.append(
                ood.create("ood.UI.Group")
                    .setHost(host, "ctl_group35")
                    .setDock("bottom")
                    .setDockMargin({
                        "left": 6,
                        "top": 4,
                        "right": 4,
                        "bottom": 8
                    })
                    .setHeight("5.333333333333333em")
                    .setOverflow("hidden")
                    .setCaption("$(RAD.action.Set return value to)")
                    .setToggleBtn(false)
                , "callcb");

            host.ctl_group35.append(
                ood.create("ood.UI.Span")
                    .setHost(host, "conf_return_exp")
                    .setDock("bottom")
                    .setDockMargin({
                        "left": 10,
                        "top": 0,
                        "right": 12,
                        "bottom": 2
                    })
                    .setHeight("auto")
                    .setHtml("<font color=\"#ff0000\">&nbsp;</font>")
                    .setCustomStyle({
                        "KEY": {
                            "color": "#FF0000",
                            "text-align": "right"
                        }
                    })
            );

            host.ctl_group35.append(
                ood.create("ood.UI.Input")
                    .setHost(host, "cb_callreturn")
                    .setTagVar("none")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "left": 140,
                        "top": 0,
                        "right": 4,
                        "bottom": 0
                    })
                    .setTop("0.1875em")
                    .setZIndex(1002)
                    .setLabelSize("6.666666666666667em")
                    .setLabelCaption("$(RAD.action.Key)")
                    .onChange("_cb_callreturn_onchange")
            );

            host.ctl_group35.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "cb_callreturnto")
                    .setDirtyMark(false)
                    .setLeft("1em")
                    .setTop("0.25em")
                    .setType("listbox")
                    .setItems([
                        {
                            "id": "none",
                            "caption": "$(RAD.action.Doesn't set at all)"
                        },
                        {
                            "id": "temp",
                            "caption": "$(RAD.action.to Temp Object)",
                            "image": ""
                        },
                        {
                            "id": "global",
                            "caption": "$(RAD.action.to Global Object)",
                            "image": ""
                        },
                        {
                            "id": "page",
                            "caption": "$(RAD.action.to Page Object)",
                            "image": "",
                            "disabled": false
                        },
                        {
                            "id": "page.properties",
                            "caption": "$(RAD.action.to Page Properties)",
                            "image": ""
                        }
                    ])
                    .setValue("none")
                    .onChange("_cb_callreturnto_onchange")
            );

            host.tab_conf.append(
                ood.create("ood.UI.Group")
                    .setHost(host, "ctl_grpp")
                    .setDock("width")
                    .setDockMargin({
                        "right": 12,
                        "top": undefined,
                        "left": undefined,
                        "bottom": undefined
                    })
                    .setDockStretch("rearward")
                    .setLeft("1.25em")
                    .setTop("8.583333333333334em")
                    .setWidth("25.25em")
                    .setHeight("auto")
                    .setCaption("$RAD.action.Parameters")
                    .setToggleBtn(false)
                , "setcb");

            host.tab_conf.append(
                ood.create("ood.UI.Span")
                    .setHost(host, "msg_m2")
                    .setDock("bottom")
                    .setDockMargin({
                        "left": 0,
                        "top": 0,
                        "right": 10,
                        "bottom": 2
                    })
                    .setHeight("1.1666666666666667em")
                    .setHtml("<div style='color:red;text-align:right'> $(RAD.action.msg.Asynchronous action: the later actions will be blocked until it succeeds or fails. 'Stop' will not prevent next actions, but can stop the follow up process for 'beforeXXX' event.) </div>")
                , "datatransfer");

            host.tab_conf.append(
                ood.create("ood.UI.Group")
                    .setHost(host, "ood_ui_g21")
                    .setDock("fill")
                    .setDockMargin({
                        "left": 0,
                        "top": 42,
                        "right": 0,
                        "bottom": 0
                    })
                    .setCaption("$RAD.action.Parameters")
                    .setToggleBtn(false)
                , "url");

            host.ood_ui_g21.append(
                ood.create("ood.Module.JSONEditor", "ood.Module")
                    .setHost(host, "_jsoneditor2")
                    .setProperties({
                        "multiLineValue": false
                    })
                    .setEvents({
                        "onEdit": "_jsonedit",
                        "onchange": "_jsoneditorchanged2"
                    })
            );

            host.tab_conf.append(
                ood.create("ood.UI.Span")
                    .setHost(host, "ood_var_right")
                    .setDock("bottom")
                    .setDockMargin({
                        "left": 10,
                        "top": 0,
                        "right": 10,
                        "bottom": 2
                    })
                    .setHeight("auto")
                    .setHtml("DataAdjustment( ValueSource[ValuePath] )")
                    .setCustomStyle({
                        "KEY": {
                            "text-align": "right"
                        }
                    })
                , "var");

            host.tab_conf.append(
                ood.create("ood.UI.Span")
                    .setHost(host, "conf_var_left")
                    .setDock("bottom")
                    .setDockMargin({
                        "left": 10,
                        "top": 0,
                        "right": 10,
                        "bottom": 2
                    })
                    .setHeight("auto")
                    .setHtml("<font color=\"#ff0000\">&nbsp;</font>")
                    .setCustomStyle({
                        "KEY": {
                            "color": "#FF0000"
                        }
                    })
                , "var");

            host.tab_conf.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "propFilter")
                    .setTagVar("none")
                    .setDirtyMark(false)
                    .setDock("top")
                    .setDockMargin({
                        "left": 4,
                        "top": 4,
                        "right": 4,
                        "bottom": 4
                    })
                    .setTips("$(RAD.designer.tool.Filter) ")
                    .setHeight("2em")
                    .setDynCheck(true)
                    .setType("input")
                    .setImageClass("ri-filter-line")
                    .setUnit("Show All")
                    .setUnits("Show All;Modified Only")
                    .setCommandBtn("delete")
                    .onChange("_propFilter_onchange")
                    .onCommand("_propFilter_oncmd")
                    .afterUnitUpdated("_propFilter_unit")
                , "prop");

            host.tab_conf.append(
                ood.create("ood.UI.TreeGrid")
                    .setHost(host, "profileGrid")
                    .setDirtyMark(false)
                    .setSelMode("multibycheckbox")
                    .setEditable(true)
                    .setRowHandler(false)
                    .setColSortable(false)
                    .setHeader([
                        {
                            "id": "key",
                            "caption": "$RAD.designer.gridcol1",
                            "width": "10em",
                            "type": "label"
                        },
                        {
                            "id": "value",
                            "caption": "$RAD.designer.gridcol2",
                            "width": "10em",
                            "type": "input",
                            "flexSize": 1
                        },
                        {
                            "id": "value2",
                            "caption": "$(RAD.designer.Variable)",
                            "width": "10em",
                            "type": "input",
                            "flexSize": 1
                        }
                    ])
                    .setRowOptions({
                        "rowRenderer": function (prf, row) {
                            if (row.group) prf.getSubNode('MARK', row._serialId).css('display', 'none');
                        }
                    })
                    .setTreeMode("infirstcell")
                    .setValue("")
                    .onShowTips("$tg_tips")
                    .onRowSelected("$profilegrid__rowsel")
                    .beforeRowActive(function () {
                        return false;
                    })
                    .beforeCellUpdated("$profilegrid_beforecellvalueset")
                    .afterCellUpdated("$tg_cellupd")
                    .onDblclickRow("$tg_dblclick")
                    .onBeginEdit("$tg_beginedit")
                    .setCustomStyle({
                        "HFMARK": "display:none"
                    })
                , "prop");

            host.tab_conf.append(
                ood.create("ood.UI.Input")
                    .setHost(host, "url_address")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12,
                        "top": undefined,
                        "left": undefined,
                        "bottom": undefined
                    })
                    .setDockStretch("rearward")
                    .setLeft("0.5em")
                    .setTop("0.9375em")
                    .setWidth("26.166666666666668em")
                    .setLabelSize("6.666666666666667em")
                    .setLabelCaption("$RAD.action.url.Address")
                    .onChange("_url_address_onchange")
                , "url");

            host.tab_conf.append(
                ood.create("ood.UI.Input")
                    .setHost(host, "fileurl_address")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12
                    })
                    .setDockStretch("rearward")
                    .setLeft("0.5em")
                    .setTop("0.9375em")
                    .setWidth("26.166666666666668em")
                    .setLabelSize("6.666666666666667em")
                    .setLabelCaption("$(RAD.action.url.File URL)")
                    .onChange("_url_address_onchange")
                , "datatransfer");

            host.tab_conf.append(
                ood.create("ood.UI.Label")
                    .setHost(host, "ctl_slabel57")
                    .setLeft("0.5em")
                    .setTop("4em")
                    .setCaption("$(RAD.action.msg.Notice: The result will be set to {temp$.okData}, and the error will be set to {temp$.koData})")
                    .setHAlign("left")
                , "datatransfer");

            host.tab_conf.append(
                ood.create("ood.Module.JSONEditor", "ood.Module")
                    .setHost(host, "_jsoneditor")
                    .setProperties({
                        "multiLineValue": false
                    })
                    .setEvents({
                        "onEdit": "_jsonedit",
                        "onchange": "_jsoneditorchanged"
                    })
                , "json");

            host.tab_conf.append(
                ood.create("ood.UI.Input")
                    .setHost(host, "msg_cap")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12
                    })
                    .setDockStretch("rearward")
                    .setLeft("0.5em")
                    .setTop("0.9375em")
                    .setWidth("25.333333333333332em")
                    .setLabelSize("6.666666666666667em")
                    .setLabelCaption("$RAD.action.fmsg.Title")
                    .onChange("_msg_cap_onchange")
                , "fmsg");

            host.tab_conf.append(
                ood.create("ood.UI.Input")
                    .setHost(host, "msg_body")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12
                    })
                    .setDockStretch("rearward")
                    .setLeft("0.5em")
                    .setTop("3.25em")
                    .setWidth("25.333333333333332em")
                    .setHeight("6.875em")
                    .setLabelSize("6.666666666666667em")
                    .setLabelCaption("$RAD.action.fmsg.Body")
                    .setMultiLines(true)
                    .onChange("_msg_body_onchange")
                , "fmsg");

            host.tab_conf.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "msg_width")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12
                    })
                    .setDockStretch("rearward")
                    .setLeft("0.5em")
                    .setTop("10.75em")
                    .setWidth("14.333333333333334em")
                    .setHeight("1.8333333333333333em")
                    .setLabelSize("6.666666666666667em")
                    .setLabelCaption("$RAD.action.fmsg.Width")
                    .setType("spin")
                    .setPrecision(0)
                    .setIncrement(100)
                    .setMin(0)
                    .setMax(10000)
                    .onChange("_msg_width_onchange")
                , "fmsg");

            host.tab_conf.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "msg_duration")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12
                    })
                    .setDockStretch("rearward")
                    .setLeft("0.5em")
                    .setTop("13.333333333333334em")
                    .setWidth("14.416666666666666em")
                    .setHeight("1.8333333333333333em")
                    .setLabelSize("6.666666666666667em")
                    .setLabelCaption("$RAD.action.fmsg.Duration")
                    .setType("spin")
                    .setPrecision(0)
                    .setIncrement(100)
                    .setMin(0)
                    .setMax(10000)
                    .onChange("_msg_duration_onchange")
                , "fmsg");

            host.tab_conf.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ctl_blockcon")
                    .setDock("bottom")
                    .setHeight("2.75em")
                    .setOverflow("hidden")
                , "con");

            host.ctl_blockcon.append(
                ood.create("ood.UI.Input")
                    .setHost(host, "tb_consub")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12
                    })
                    .setDockStretch("rearward")
                    .setLeft("0.625em")
                    .setTop("0.25em")
                    .setWidth("21.75em")
                    .setLabelSize("10em")
                    .setLabelCaption("$(RAD.action.Selected Node) :")
                    .onChange("_tb_consub_onchange")
            );

            host.ctl_blockcon.append(
                ood.create("ood.UI.RadioBox")
                    .setHost(host, "toggle_value")
                    .setDirtyMark(false)
                    .setItems([
                        {
                            "id": "expand",
                            "caption": "$RAD.action.Expand"
                        },
                        {
                            "id": "folding",
                            "caption": "$RAD.action.Folding"
                        }
                    ])
                    .setLeft("13.75em")
                    .setTop("0.08333333333333333em")
                    .setWidth("0em")
                    .setHeight("2.4166666666666665em")
                    .setValue("expand")
                    .onChange("_toggle_value_onchange")
            );

            host.tab_conf.append(
                ood.create("ood.UI.CheckBox")
                    .setHost(host, "ctl_cache")
                    .setDirtyMark(false)
                    .setLeft("1.875em")
                    .setTop("0.9375em")
                    .setCaption("$(RAD.action.Cache Page)")
                    .onChange("_ctl_cache_onchange")
                , "switch");

            host.tab_conf.append(
                ood.create("ood.UI.Input")
                    .setHost(host, "msg_title")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12,
                        "top": undefined,
                        "left": undefined,
                        "bottom": undefined
                    })
                    .setDockStretch("rearward")
                    .setLeft("0.5em")
                    .setTop("0.9375em")
                    .setWidth("24.5em")
                    .setLabelSize("6.666666666666667em")
                    .setLabelCaption("$RAD.action.msg.Title")
                    .onChange("_msg_title_onchange")
                , "msg");

            host.tab_conf.append(
                ood.create("ood.UI.Input")
                    .setHost(host, "msg_message")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12,
                        "top": undefined,
                        "left": undefined,
                        "bottom": undefined
                    })
                    .setDockStretch("rearward")
                    .setLeft("0.5em")
                    .setTop("3.25em")
                    .setWidth("24.5em")
                    .setHeight("3.6666666666666665em")
                    .setLabelSize("6.666666666666667em")
                    .setLabelCaption("$RAD.action.msg.Message")
                    .setMultiLines(true)
                    .onChange("_msg_message_onchange")
                , "msg");

            host.tab_conf.append(
                ood.create("ood.UI.Input")
                    .setHost(host, "msg_input")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12,
                        "top": undefined,
                        "left": undefined,
                        "bottom": undefined
                    })
                    .setDockStretch("rearward")
                    .setLeft("0.5em")
                    .setTop("7.416666666666667em")
                    .setWidth("24.5em")
                    .setHeight("3.6666666666666665em")
                    .setLabelSize("6.666666666666667em")
                    .setLabelCaption("$(RAD.action.msg.Default Input)")
                    .setMultiLines(true)
                    .onChange("_msg_input_onchange")
                , "msg");

            host.tab_conf.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "data_source")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12,
                        "top": undefined,
                        "left": undefined,
                        "bottom": undefined
                    })
                    .setDockStretch("rearward")
                    .setLeft("0.5em")
                    .setTop("0.9375em")
                    .setWidth("25.333333333333332em")
                    .setLabelSize("8.333333333333334em")
                    .setLabelCaption("$(RAD.action.Data Source)")
                    .setType("helpinput")
                    .onChange("_ds_onchange")
                    .beforeComboPop("_data_source_beforecombopop")
                , "data");

            host.tab_conf.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "blk_itempos")
                    .setDock("bottom")
                    .setDockOrder(3)
                    .setHeight("9em")
                    .setOverflow("hidden")
                , "mix");

            host.blk_itempos.append(
                ood.create("ood.UI.RadioBox")
                    .setHost(host, "add_pos")
                    .setDirtyMark(false)
                    .setItems([
                        {
                            "id": "last",
                            "caption": "$(RAD.action.To the last)"
                        },
                        {
                            "id": "first",
                            "caption": "$(RAD.action.To the top)"
                        },
                        {
                            "id": "before",
                            "caption": "$(RAD.action.Before the selected node)"
                        },
                        {
                            "id": "after",
                            "caption": "$(RAD.action.After the selected node)"
                        },
                        {
                            "id": "curbefore",
                            "caption": "$(RAD.action.Before the current node)"
                        },
                        {
                            "id": "curafter",
                            "caption": "$(RAD.action.After the current node)"
                        },
                        {
                            "id": "sublast",
                            "caption": "$(RAD.action.To the last of selected node)"
                        },
                        {
                            "id": "subfirst",
                            "caption": "$(RAD.action.To the first of selected node)"
                        },
                        {
                            "id": "cursubfirst",
                            "caption": "$(RAD.action.To the first of current node)"
                        },
                        {
                            "id": "cursublast",
                            "caption": "$(RAD.action.To the last of current node)"
                        }
                    ])
                    .setDock("fill")
                    .setLeft("0.4375em")
                    .setTop("0.125em")
                    .setWidth("auto")
                    .setHeight("11.5em")
                    .setValue("last")
                    .onChange("_tb_mixsub_onchange")
            );

            host.tab_conf.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ctl_block143")
                    .setDock("bottom")
                    .setHeight("2.5833333333333335em")
                    .setOverflow("hidden")
                , "mix");

            host.ctl_block143.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "ctl_itemvar")
                    .setTag("purevar")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12,
                        "top": undefined,
                        "left": undefined,
                        "bottom": undefined
                    })
                    .setDockStretch("rearward")
                    .setLeft("0.75em")
                    .setTop("0.4166666666666667em")
                    .setWidth("25em")
                    .setHeight("1.8333333333333333em")
                    .setZIndex(1002)
                    .setLabelSize("4em")
                    .setLabelCaption("$(RAD.action.Data)")
                    .setType("none")
                    .onChange("_ctl_itemvar_onchange")
                    .onCommand("_ctl_varfrom_cmd")
            );

            host.tab_conf.append(
                ood.create("ood.UI.Input")
                    .setHost(host, "ctl_varto")
                    .setTagVar("none")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12,
                        "top": undefined,
                        "left": undefined,
                        "bottom": undefined
                    })
                    .setDockStretch("rearward")
                    .setLeft("1.125em")
                    .setTop("1.25em")
                    .setWidth("25.5em")
                    .setZIndex(1002)
                    .setLabelSize("10em")
                    .setLabelCaption("$(RAD.action.Key)")
                    .setValueFormat("^[\\w]*$")
                    .onChange("_ctl_varto_onchange")
                , "var");

            host.tab_conf.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "ctl_varfrom")
                    .setTag("purevar")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12,
                        "top": undefined,
                        "left": undefined,
                        "bottom": undefined
                    })
                    .setDockStretch("rearward")
                    .setLeft("1.125em")
                    .setTop("3.8333333333333335em")
                    .setWidth("25.5em")
                    .setHeight("1.8333333333333333em")
                    .setZIndex(1002)
                    .setLabelSize("10em")
                    .setLabelCaption("$(RAD.action.Value Source)")
                    .setType("helpinput")
                    .onChange("_ctl_varfrom_onchange")
                    .onCommand("_ctl_varfrom_cmd")
                    .beforeComboPop("_data_source_beforecombopop")
                , "var");

            host.tab_conf.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "ctl_animate")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12
                    })
                    .setDockStretch("rearward")
                    .setLeft("1.125em")
                    .setTop("1.25em")
                    .setWidth("25.5em")
                    .setHeight("1.8333333333333333em")
                    .setZIndex(1002)
                    .setLabelSize("8em")
                    .setLabelCaption("$(RAD.action.Animate Setting)")
                    .setType("listbox")
                    .beforeUIValueSet("_animate_buis")
                    .onChange("_ctl_animate_onchange")
                    .onCommand("_ctl_varfrom_cmd")
                    .beforeComboPop("_animate_beforecombopop")
                , "animate");

            host.tab_conf.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "ctl_varfrompath")
                    .setTag("purevar")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12,
                        "top": undefined,
                        "left": undefined,
                        "bottom": undefined
                    })
                    .setDockStretch("rearward")
                    .setLeft("1.125em")
                    .setTop("6.333333333333333em")
                    .setWidth("25.5em")
                    .setHeight("1.8333333333333333em")
                    .setZIndex(1002)
                    .setLabelSize("10em")
                    .setLabelCaption("$(RAD.action.Value Path)")
                    .setType("input")
                    .onChange("_ctl_varfrompath_onchange")
                    .onCommand("_ctl_varfrompath_cmd")
                , "var");

            host.tab_conf.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "ctl_adjust")
                    .setTagVar("adjustdata")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12,
                        "top": undefined,
                        "left": undefined,
                        "bottom": undefined
                    })
                    .setDockStretch("rearward")
                    .setLeft("1.125em")
                    .setTop("8.833333333333334em")
                    .setWidth("25.5em")
                    .setHeight("1.8333333333333333em")
                    .setLabelSize("10em")
                    .setLabelCaption("$(RAD.action.Data Adjustment)")
                    .setType("helpinput")
                    .setItems([
                        {
                            "id": "serialize",
                            "caption": "$RAD.action.Serialize"
                        },
                        {
                            "id": "stringify",
                            "caption": "$RAD.action.Stringify"
                        },
                        {
                            "id": "unserialize",
                            "caption": "$RAD.action.Unserialize"
                        },
                        {
                            "id": "urlDecode",
                            "caption": "$RAD.action.urlDecode"
                        },
                        {
                            "id": "urlEncode",
                            "caption": "$RAD.action.urlEncode"
                        }
                    ])
                    .onChange("_ctl_adjust_onchange")
                , "var");

            host.tab_conf.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "log_v1")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12
                    })
                    .setDockStretch("rearward")
                    .setLeft("1.25em")
                    .setTop("1.0833333333333333em")
                    .setWidth("24.583333333333332em")
                    .setZIndex(1002)
                    .setLabelSize("6.666666666666667em")
                    .setLabelCaption("$(RAD.action.Parameter) 1")
                    .setType("input")
                    .onChange("_log_v1_onchange")
                    .onCommand("_ctl_varfrom_cmd")
                , "log");

            host.tab_conf.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "log_v2")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12
                    })
                    .setDockStretch("rearward")
                    .setLeft("1.25em")
                    .setTop("3.6666666666666665em")
                    .setWidth("24.583333333333332em")
                    .setZIndex(1002)
                    .setLabelSize("6.666666666666667em")
                    .setLabelCaption("$(RAD.action.Parameter) 2")
                    .setType("input")
                    .onChange("_log_v2_onchange")
                    .onCommand("_ctl_varfrom_cmd")
                , "log");

            host.tab_conf.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "log_v3")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12
                    })
                    .setDockStretch("rearward")
                    .setLeft("1.25em")
                    .setTop("6.166666666666667em")
                    .setWidth("24.583333333333332em")
                    .setZIndex(1002)
                    .setLabelSize("6.666666666666667em")
                    .setLabelCaption("$(RAD.action.Parameter) 3")
                    .setType("input")
                    .onChange("_log_v3_onchange")
                    .onCommand("_ctl_varfrom_cmd")
                , "log");

            host.tab_conf.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "log_v4")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12
                    })
                    .setDockStretch("rearward")
                    .setLeft("1.25em")
                    .setTop("8.666666666666666em")
                    .setWidth("24.583333333333332em")
                    .setZIndex(1002)
                    .setLabelSize("6.666666666666667em")
                    .setLabelCaption("$(RAD.action.Parameter) 4")
                    .setType("input")
                    .onChange("_log_v4_onchange")
                    .onCommand("_ctl_varfrom_cmd")
                , "log");

            host.tab_conf.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "log_v5")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12
                    })
                    .setDockStretch("rearward")
                    .setLeft("1.25em")
                    .setTop("11.166666666666666em")
                    .setWidth("24.583333333333332em")
                    .setZIndex(1002)
                    .setLabelSize("6.666666666666667em")
                    .setLabelCaption("$(RAD.action.Parameter)  5")
                    .setType("input")
                    .onChange("_log_v5_onchange")
                , "log");

            host.tab_conf.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ctl_group13")
                    .setDock("fill")
                    .setDockMargin({
                        "left": 6,
                        "top": 54,
                        "right": 4,
                        "bottom": 4
                    })
                    .setBorderType("flat")
                    .setOverflow("hidden")
                , "callcb");

            host.ctl_group13.append(
                ood.create("ood.UI.TreeGrid")
                    .setHost(host, "grid_params")
                    .setDirtyMark(false)
                    .setRowHandler(false)
                    .setColSortable(false)
                    .setHeader([
                        {
                            "id": "key",
                            "caption": "$RAD.action.Parameter",
                            "width": "14em",
                            "type": "label"
                        },
                        {
                            "id": "value",
                            "caption": "$RAD.action.Value",
                            "width": "10em",
                            "type": "input",
                            "editable": true,
                            "flexSize": true,
                            "editMode": "inline"
                        }
                    ])
                    .setTreeMode('none')
                    .afterCellUpdated("_grid_params_aftercellupdated")
                    .onBeginEdit("_grid_params_onbe")
            );

            host.tab_conf.append(
                ood.create("ood.UI.Input")
                    .setHost(host, "cb_callid")
                    .setTagVar("callback")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "left": 6,
                        "top": 0,
                        "right": 4,
                        "bottom": 0
                    })
                    .setTop("0.375em")
                    .setHeight("3.6666666666666665em")
                    .setZIndex(1002)
                    .setLabelSize("1.8333333333333333em")
                    .setLabelPos("top")
                    .setLabelCaption("$(RAD.action.Function Expression, or Global Reference Key)")
                    .setLabelHAlign("left")
                    .onChange("_cb_callid_onchange")
                , "callcb");

            host.tab_conf.append(
                ood.create("ood.UI.Label")
                    .setHost(host, "ctl_slabel55")
                    .setLeft("1.75em")
                    .setTop("0.9375em")
                    .setCaption("$(RAD.action.No configuration items)")
                    .setHAlign("left")
                , "none");

            host.tab_conf.append(
                ood.create("ood.UI.Label")
                    .setHost(host, "ctl_slabel56")
                    .setLeft("1.75em")
                    .setTop("0.9375em")
                    .setCaption("$(RAD.action.msg.Notice: The local file object will be set to {temp$.okData})")
                    .setHAlign("left")
                , "selfile");

            host.tab_conf.append(
                ood.create("ood.UI.Input")
                    .setHost(host, "cb_setid")
                    .setTagVar("none")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12,
                        "top": undefined,
                        "left": undefined,
                        "bottom": undefined
                    })
                    .setDockStretch("rearward")
                    .setLeft("1.25em")
                    .setTop("0.625em")
                    .setWidth("25.416666666666668em")
                    .setHeight("3.75em")
                    .setZIndex(1002)
                    .setLabelSize("1.8333333333333333em")
                    .setLabelPos("top")
                    .setLabelCaption("$(RAD.action.Global Reference Key)")
                    .setLabelHAlign("left")
                    .onChange("_cb_setid_onchange")
                , "setcb");

            host.tab_conf.append(
                ood.create("ood.UI.Input")
                    .setHost(host, "cb_setvalue")
                    .setTagVar("callback")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12,
                        "top": undefined,
                        "left": undefined,
                        "bottom": undefined
                    })
                    .setDockStretch("rearward")
                    .setLeft("1.25em")
                    .setTop("4.333333333333333em")
                    .setWidth("25.416666666666668em")
                    .setHeight("3.6666666666666665em")
                    .setZIndex(1002)
                    .setLabelSize("1.8333333333333333em")
                    .setLabelPos("top")
                    .setLabelCaption("$(RAD.action.Target Function Expression)")
                    .setLabelHAlign("left")
                    .onChange("_cb_setvalue_onchange")
                , "setcb");

            host.tab_conf.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ood_block_mix")
                    .setDock("bottom")
                    .setHeight("2.5833333333333335em")
                    .setOverflow("hidden")
                , "mix");

            host.ood_block_mix.append(
                ood.create("ood.UI.Input")
                    .setHost(host, "tb_mixsub")
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "right": 12,
                        "top": undefined,
                        "left": undefined,
                        "bottom": undefined
                    })
                    .setDockStretch("rearward")
                    .setLeft("0.75em")
                    .setTop("0.25em")
                    .setWidth("25em")
                    .setLabelSize("10em")
                    .setLabelCaption("$(RAD.action.Selected Node) :")
                    .onChange("_tb_mixsub_onchange")
            );

            host.ctl_layout11.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ctl_block37")
                    .setTop("0.6666666666666666em")
                    .setWidth("8.166666666666666em")
                    .setHeight("8.416666666666666em")
                    .setRight("0em")
                    .setBorderType("none")
                    .setBackground("transparent")
                    .setOverflow("hidden")
                , "main");

            host.ctl_block37.append(
                ood.create("ood.UI.Button")
                    .setHost(host, "ctl_button23")
                    .setLeft("0.625em")
                    .setTop("5.166666666666667em")
                    .setWidth("6.833333333333333em")
                    .setHeight("2.5em")
                    .setImageClass("ri-close-line")
                    .setCaption("$RAD.cancel")
                    .onClick("_btncancel_onclick")
            );

            host.ctl_block37.append(
                ood.create("ood.UI.Button")
                    .setHost(host, "btn_ok")
                    .setDefaultFocus(true)
                    .setLeft("0.6875em")
                    .setTop("0.9166666666666666em")
                    .setWidth("6.833333333333333em")
                    .setHeight("2.5em")
                    .setImageClass("ri-check-line")
                    .setCaption("$RAD.ok")
                    .onClick("_btnonok_onclick")
            );

            append(
                ood.create("ood.UI.Block")
                    .setHost(host, "blk_float")
                    .setLeft("0em")
                    .setTop("31.25em")
                    .setWidth("40em")
                    .setHeight("20em")
                    .setZIndex(1002)
                    .setVisibility("visible")
                    .setShadow(true)
                    .setResizer(true)
                    .setBorderType("flat")
            );

            host.blk_float.append(
                ood.create("ood.UI.TreeView")
                    .setHost(host, "tv_var")
                    .setAnimCollapse(false)
                    .setSingleOpen(true)
                    .onChange("_tv_var_onchange")
                    .onClick("_tv_var_onclick")
                    .onCmd("_tv_fun_opt")
                    .onGetContent("_tv_var_ongetcontent")
                    .onItemSelected("_tv_var_onsel")
            );
            host.blk_float.append(
                ood.create("ood.UI.Icon")
                    .setHost(host, "ood_ui_icon1")
                    .setTop("0em")
                    .setRight("0em")
                    .setImageClass("ri-close-line")
                    .setIconFontSize("2em")
                    .setCustomStyle({KEY: {margin: 0}})
                    .onClick("_ood_closefloat")
            );

            append(
                ood.create("ood.UI.Block")
                    .setHost(host, "blk_float2")
                    .setLeft("25.625em")
                    .setTop("31.25em")
                    .setWidth("40em")
                    .setHeight("20em")
                    .setVisibility("visible")
                    .setShadow(true)
                    .setResizer(true)
                    .setBorderType("flat")
            );


            host.blk_float2.append(
                ood.create("ood.UI.TreeView")
                    .setHost(host, "tv_fun")
                    .setAnimCollapse(false)
                    .setSingleOpen(true)
                    .onChange("_tv_var_onchange")
                    .onClick("_tv_var_onclick")
                    .onCmd("_tv_fun_opt")
                    .onGetContent("_tv_fun_ongetcontent")
                    .onItemSelected("_tv_var_onsel")
            );

            host.blk_float2.append(
                ood.create("ood.UI.Icon")
                    .setHost(host, "ood_ui_icon2")
                    .setTop("0em")
                    .setRight("0em")
                    .setImageClass("ri-close-line")
                    .setIconFontSize("2em")
                    .setCustomStyle({KEY: {margin: 0}})
                    .onClick("_ood_closefloat")
            );
            return children;
            // ]]Code created by EUSUI RAD Studio
        },
        _treebarprj_onGetContent: function (profile, item, callback) {
            buildComponent = function (subitems) {
                ood.arr.each(subitems, function (item) {
                    if (item.sub) {
                        item.sub = buildComponent(item.sub);
                    }
                    if (item.key && CONF.mapWidgets[item.key]) {
                        var p = CONF.mapWidgets[item.key];
                        item.imageClass = CONF.mapWidgets[item.key].imageClass;
                    }
                });
                return subitems;
            };

            if (item.id == 'group:pages') {
                ood.Ajax(CONF.getAllClasses, {
                    projectName: item.projectName ? item.projectName : SPA.curProjectName,
                    className:SPA.getCurrentClassName(),
                    draggable: 'false'
                }, function (txt) {
                    var obj = txt;
                    if (!obj || obj.error) {
                        ood.message("No module in this project!");
                        callback(false);
                    } else {
                        var items = [];
                        ood.arr.each(obj.data, function (o, i) {
                            var subitem = [];
                            if (o.sub && ood.isArr(o.sub)) {
                                ood.arr.each(o.sub, function (o) {
                                    if (o.id != SPA.getCurrentClassName()) {
                                        subitem.push(o)
                                    }
                                });
                            }
                            items.push({
                                id: o.id,
                                cls: o.cls,
                                key: "jds.localModule",
                                path: o.location,
                                draggable: false,
                                sub: subitem,
                                //  type: 'otherModuleCall',
                                //initFold: true,
                                projectName: o.projectName,
                                imageClass: 'ri-grid-line',
                                name: o.caption,
                                iniProp: o.iniProp,
                                caption: o.className
                            });

                        });
                        callback(items);
                    }
                }, function (txt) {
                    callback(false);
                }, 0, {asy: false}).start();

            } else {

                ood.Ajax(CONF.getAllComponentsByClass, {
                    className: item.className,
                    draggable: 'false',
                    projectName: item.projectName ? item.projectName : SPA.curProjectName
                }, function (txt) {
                    var obj = txt;
                    if (obj && !obj.error) {
                        var root = {
                            sub: buildComponent(obj.data)
                        };
                        callback(root.sub);
                    } else ood.message(ood.get(obj, ['error', 'errdes']) || obj || 'no response!');
                }, function (txt) {
                    callback(false);
                }, 0, {asy: true}).start();


            }
        },
        _buildsubtree: function (item) {

            if (!item["0"]) {
                if (item.key && item.key != 'ood.Module') {
                    var component = ood.create(item.key)
                        .setAlias(item.alias)
                        .setProperties(item.properties)
                    item["0"] = component["n0"];
                    item._type = "control";
                } else if (item.className && item.className != SPA.getCurrentClassName()) {
                    item._type = "otherModuleCall";
                } else if (item.id && item.id == SPA.getCurrentClassName()) {
                    item._type = "page";
                }
            }

            var items, options = {
                    imageClass: 'ri-settings-2-line',
                    className: item.className
                },
                map2 = this.CAPMAP.action;

            switch (item._type) {
                case "none":
                    items = [{
                        id: "none",
                        caption: "$RAD.action." + map2["none"],
                        imageClass: 'ri-forbid-2-line',
                        cat: "none"
                    }];
                    break;
                case 'control':
                    if (item["0"].key == "ood.MQTT") {
                        items = [{
                            id: "none",
                            caption: "$RAD.action." + map2["none"],
                            imageClass: 'ri-forbid-2-line',
                            cat: "none"
                        }, {
                            id: "setProperties",
                            cat: 'prop',
                            caption: "$(RAD.action." + map2["setProperties"] + ")"
                        }, {
                            id: "connect",
                            cat: 'callcb',
                            redirection: 'other:callback:call',
                            _tpl: "{page.*.connect()}",
                            caption: "$(RAD.action." + map2["connect"] + ")",
                            "0": item["0"]
                        }, {
                            id: "disconnect",
                            cat: 'callcb',
                            redirection: 'other:callback:call',
                            _tpl: "{page.*.disconnect()}",
                            caption: "$(RAD.action." + map2["disconnect"] + ")",
                            "0": item["0"]
                        }, {
                            id: "subscribe",
                            cat: 'callcb',
                            redirection: 'other:callback:call',
                            _tpl: "{page.*.subscribe()}",
                            caption: "$(RAD.action." + map2["subscribe"] + ")",
                            "0": item["0"]
                        }, {
                            id: "unsubscribe",
                            cat: 'callcb',
                            redirection: 'other:callback:call',
                            _tpl: "{page.*.unsubscribe()}",
                            caption: "$(RAD.action." + map2["unsubscribe"] + ")",
                            "0": item["0"]
                        }, {
                            id: "publish",
                            cat: 'callcb',
                            redirection: 'other:callback:call',
                            _tpl: "{page.*.publish()}",
                            caption: "$(RAD.action." + map2["publish"] + ")",
                            "0": item["0"]
                        }, {type: 'split'}, {
                            id: "destroy",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["destroy"] + ")"
                        }];
                    } else if (item["0"].key == "ood.APICaller") {
                        items = [{
                            id: "none",
                            caption: "$RAD.action." + map2["none"],
                            imageClass: 'ri-forbid-2-line',
                            cat: "none"
                        }, {
                            id: "setProperties",
                            cat: 'prop',
                            caption: "$(RAD.action." + map2["setProperties"] + ")"
                        }, {
                            id: "setQueryData",
                            cat: 'callcb',
                            redirection: 'other:callback:call',
                            _tpl: "{page.*.setQueryData()}",
                            caption: "$(RAD.action." + map2["setQueryData"] + ")"
                        }, {
                            id: "invoke",
                            // cat: 'datatransfer',

                            cat: 'callcb',
                            redirection: 'other:callback:call',
                            _tpl: "{page.*.invoke()}",
                            caption: "$(RAD.action." + map2["invoke"] + ")"
                        }, {type: 'split'}, {
                            id: "destroy",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["destroy"] + ")"
                        }];
                    } else if (item["0"].key == "ood.DataBinder") {
                        items = [{
                            id: "none",
                            caption: "$RAD.action." + map2["none"],
                            imageClass: 'ri-forbid-2-line',
                            cat: "none"
                        }, {
                            id: "setProperties",
                            cat: 'prop',
                            caption: "$(RAD.action." + map2["setProperties"] + ")"
                        }, {
                            id: "updateValue",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["updateValue"] + ")"
                        }, {
                            id: "resetValue",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["resetValue"] + ")"
                        }, {
                            id: "clearValue",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["clearValue"] + ")"
                        }, {
                            id: "updateDataFromUI",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["updateDataFromUI"] + ")"
                        }, {
                            id: "updateDataToUI",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["updateDataToUI"] + ")"
                        }, {
                            id: "getDirtied",
                            cat: 'callcb',
                            redirection: 'other:callback:call',
                            _tpl: "{page.*.getDirtied()}",
                            caption: "$(RAD.action." + map2["getDirtied"] + ")",
                            "0": item["0"]
                        },
                            {type: 'split'},
                            {
                                id: "checkValid",
                                cat: 'con',
                                args: [],
                                caption: "$(RAD.action." + map2["checkValid"] + ")",
                                "0": item[0]
                            },
                            {
                                id: "checkRequired",
                                cat: 'con',
                                args: [],
                                caption: "$(RAD.action." + map2["checkRequired"] + ")",
                                "0": item[0]
                            }, {
                                id: "isDirtied",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.isDirtied()}",
                                caption: "$(RAD.action." + map2["isDirtied"] + ")",
                                "0": item["0"]
                            }, {
                                id: "getData",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.getData()}",
                                caption: "$(RAD.action." + map2["getDate"] + ")",
                                "0": item["0"]
                            }, {
                                id: "setData",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.setData()}",
                                caption: "$(RAD.action." + map2["setData"] + ")",
                                "0": item["0"]
                            },
                            {type: 'split'}, {
                                id: "destroy",
                                cat: 'none',
                                caption: "$(RAD.action." + map2["destroy"] + ")"
                            }];
                    } else if (item["0"].key == "ood.UI.CSSBox") {
                        items = [{
                            id: "none",
                            caption: "$RAD.action." + map2["none"],
                            imageClass: 'ri-forbid-2-line',
                            cat: "none"
                        }, {
                            id: "destroy",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["destroy"] + ")"
                        }];
                    } else if (item["0"].key == "ood.AnimBinder") {
                        items = [{
                            id: "none",
                            caption: "$RAD.action." + map2["none"],
                            imageClass: 'ri-forbid-2-line',
                            cat: "none"
                        }, {
                            id: "setProperties",
                            cat: 'prop',
                            caption: "$(RAD.action." + map2["setProperties"] + ")"
                        }, {
                            id: "apply",
                            cat: 'callcb',
                            redirection: 'other:callback:call',
                            _tpl: "{page.*.apply()}",
                            caption: "$(RAD.action." + map2["anim apply"] + ")",
                            "0": item["0"]
                        }, {type: 'split'}, {
                            id: "destroy",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["destroy"] + ")"
                        }];
                    } else if (item["0"].box["ood.UI.Audio"]) {
                        items = [{
                            id: "none",
                            caption: "$RAD.action." + map2["none"],
                            imageClass: 'ri-forbid-2-line',
                            cat: "none"
                        }, {
                            id: "setProperties",
                            cat: 'prop',
                            caption: "$(RAD.action." + map2["setProperties"] + ")"
                        },
                            {type: 'split'},
                            {
                                id: "busy",
                                cat: 'none',
                                args: [],
                                caption: "$(RAD.action." + map2["busy"] + ")"
                            },
                            {
                                id: "free",
                                cat: 'none',
                                args: [],
                                caption: "$(RAD.action." + map2["free"] + ")"
                            },
                            {type: 'split'},
                            {
                                id: "setSrc",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.setSrc()}",
                                caption: "$(RAD.action." + map2["setSrc"] + ")"
                            }, {
                                id: "play",
                                cat: 'none',
                                caption: "$(RAD.action." + map2["play"] + ")"
                            }, {
                                id: "pause",
                                cat: 'none',
                                caption: "$(RAD.action." + map2["pause"] + ")"
                            }, {type: 'split'}, {
                                id: "destroy",
                                cat: 'none',
                                caption: "$(RAD.action." + map2["destroy"] + ")"
                            }];
                    } else if (item["0"].box["ood.UI.FileUpload"]) {
                        items = [{
                            id: "none",
                            caption: "$RAD.action." + map2["none"],
                            imageClass: 'ri-forbid-2-line',
                            cat: "none"
                        }, {
                            id: "setProperties",
                            cat: 'prop',
                            caption: "$(RAD.action." + map2["setProperties"] + ")"
                        },
                            {
                                id: "setUploadUrl",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.setUploadUrl()}",
                                caption: "$RAD.action.esd.setUploadUrl"
                            },
                            {
                                id: "setQueryData",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.setQueryData()}",
                                caption: "$RAD.action.esd.setQueryData"
                            }, {type: 'split'}, {
                                id: "destroy",
                                cat: 'none',
                                caption: "$(RAD.action." + map2["destroy"] + ")"
                            }];
                    } else if (item["0"].key == "ood.Timer") {
                        items = [{
                            id: "none",
                            caption: "$RAD.action." + map2["none"],
                            imageClass: 'ri-forbid-2-line',
                            cat: "none"
                        }, {
                            id: "setProperties",
                            cat: 'prop',
                            caption: "$(RAD.action." + map2["setProperties"] + ")"
                        }, {
                            id: "start",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["start"] + ")"
                        }, {
                            id: "suspend",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["suspend"] + ")"
                        }, {type: 'split'}, {
                            id: "destroy",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["destroy"] + ")"
                        }];
                    } else if (item["0"].key == "ood.MessageService") {
                        items = [{
                            id: "none",
                            caption: "$RAD.action." + map2["none"],
                            imageClass: 'ri-forbid-2-line',
                            cat: "none"
                        }, {
                            id: "setProperties",
                            cat: 'prop',
                            caption: "$(RAD.action." + map2["setProperties"] + ")"
                        }, {
                            id: "broadcast",
                            cat: 'callcb',
                            redirection: 'other:callback:call',
                            _tpl: "{page.*.broadcast()}",
                            caption: "$(RAD.action." + map2["broadcast"] + ")",
                            "0": item["0"]
                        }, {type: 'split'}, {
                            id: "destroy",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["destroy"] + ")"
                        }];
                    } else {
                        items = [{
                            id: "none",
                            caption: "$RAD.action." + map2["none"],
                            imageClass: 'ri-forbid-2-line',
                            cat: "none"
                        }, {
                            id: "animate",
                            caption: "$RAD.action." + map2["animate"],
                            cat: "animate"
                        }];
                        var prf = item["0"];
                        if (prf.boxing().activate) {
                            items.push({
                                id: "activate",
                                cat: 'none',
                                caption: "$(RAD.action." + map2["activate"] + ")"
                            });
                        }
                        items.push({type: 'split'});

                        Array.prototype.push.apply(items, [{
                            id: "setProperties",
                            cat: 'prop',
                            caption: "$(RAD.action." + map2["setProperties"] + ")"
                        }, {
                            id: "popUp",
                            cat: 'callcb',
                            redirection: 'other:callback:call',
                            _tpl: "{page.*.popUp()}",
                            caption: "$(RAD.action." + map2["popUp"] + ")",
                            "0": item["0"]
                        }, {
                            id: "disable",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["disable"] + ")"
                        }, {
                            id: "enable",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["enable"] + ")"
                        }, {
                            id: "show",
                            cat: 'con',
                            caption: "$(RAD.action." + map2["show"] + ")"
                        }, {
                            id: "hide",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["hide"] + ")"
                        }]);
                        if (prf.box["ood.UI.FusionChartsXT"]) {
                            items.push({type: 'split'});
                            items.push({
                                id: "getJSONData",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.getJSONData()}",
                                caption: "$(RAD.action." + map2["getJSONData"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "setJSONData",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.setJSONData()}",
                                caption: "$(RAD.action." + map2["setJSONData"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "getXMLData",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.getXMLData()}",
                                caption: "$(RAD.action." + map2["getXMLData"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "setXMLData",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.setXMLData()}",
                                caption: "$(RAD.action." + map2["setXMLData"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "updateData",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.updateData()}",
                                caption: "$(RAD.action." + map2["updateData"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "fillData",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.fillData()}",
                                caption: "$(RAD.action." + map2["fillData"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "setTheme",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.setTheme()}",
                                caption: "$(RAD.action." + map2["setTheme"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "refreshChart",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.refreshChart()}",
                                caption: "$(RAD.action." + map2["refreshChart"] + ")",
                                "0": item["0"]
                            });
                        }
                        if (prf.box['ood.absValue']) {
                            items.push({type: 'split'});
                            items.push({
                                id: "getUIValue",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.getUIValue()}",
                                caption: "$(RAD.action." + map2["getUIValue"] + ")",
                                "0": item["0"]
                            });

                            items.push({
                                id: "setUIValue",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.setUIValue()}",
                                caption: "$(RAD.action." + map2["setUIValue"] + ")",
                                "0": item["0"]
                            });
                        }
                        if (prf.boxing().setCaption && ('caption' in prf.properties)) {
                            items.push({
                                id: "setCaption",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.setCaption()}",
                                caption: "$(RAD.action." + map2["setCaption"] + ")",
                                "0": item["0"]
                            });
                        }

                        if (prf.boxing().hideItems) {
                            items.push({
                                id: "hideItems",
                                cat: 'con',
                                caption: "$(RAD.action." + map2["hideItems"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "showItems",
                                cat: 'con',
                                caption: "$(RAD.action." + map2["showItems"] + ")",
                                "0": item["0"]
                            });
                        }
                        if (prf.behavior && prf.behavior.PanelKeys && prf.behavior.PanelKeys.length) {
                            items.push({type: 'split'});
                            items.push({
                                id: "busy",
                                cat: 'none',
                                args: [],
                                caption: "$(RAD.action." + map2["busy"] + ")"
                            });
                            items.push({
                                id: "free",
                                cat: 'none',
                                args: [],
                                caption: "$(RAD.action." + map2["free"] + ")"
                            });
                            items.push({type: 'split'});
                            items.push({
                                id: "setFormValues",
                                cat: 'mix',
                                args: [],
                                caption: "$(RAD.action." + map2["setFormValues"] + ")",
                                "0": item[0]
                            });
                            items.push({
                                id: "checkValid",
                                cat: 'con',
                                args: [],
                                caption: "$(RAD.action." + map2["checkValid"] + ")",
                                "0": item[0]
                            });
                            items.push({
                                id: "checkRequired",
                                cat: 'con',
                                args: [],
                                caption: "$(RAD.action." + map2["checkRequired"] + ")",
                                "0": item[0]
                            });
                            items.push({
                                id: "isDirtied",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.isDirtied()}",
                                caption: "$(RAD.action." + map2["isDirtied"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "getFormValues",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.getFormValues()}",
                                caption: "$(RAD.action." + map2["getFormValues"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "formSubmit",
                                cat: 'con',
                                args: [],
                                caption: "$(RAD.action." + map2["formSubmit"] + ")",
                                "0": item[0]
                            });

                            items.push({
                                id: "setChildren",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.setChildren()}",
                                caption: ood.getRes('RAD.actions.dynamicLoad') || "动态装载组件",
                                "0": item[0]
                            });

                            items.push({
                                id: "formReset",
                                cat: 'con',
                                args: [],
                                caption: "$(RAD.action." + map2["formReset"] + ")",
                                "0": item[0]
                            });
                            items.push({
                                id: "updateFormValues",
                                cat: 'con',
                                args: [],
                                caption: "$(RAD.action." + map2["updateFormValues"] + ")",
                                "0": item[0]
                            });
                            items.push({
                                id: "formClear",
                                cat: 'con',
                                args: [],
                                caption: "$(RAD.action." + map2["formClear"] + ")",
                                "0": item[0]
                            });
                        }

                        if (prf.boxing().fireClickEvent) {
                            items.push({type: 'split'});
                            items.push({
                                id: "fireClickEvent",
                                cat: 'none',
                                caption: "$(RAD.action." + map2["fireClickEvent"] + ")"
                            });
                        }
                        if (prf.boxing().fireItemClickEvent) {
                            items.push({type: 'split'});
                            items.push({
                                id: "fireItemClickEvent",
                                cat: 'con',
                                caption: "$(RAD.action." + map2["fireItemClickEvent"] + ")",
                                "0": item["0"]
                            });
                        }
                        if (prf.boxing().dumpContainer) {
                            items.push({
                                id: "dumpContainer",
                                cat: 'con',
                                caption: "$(RAD.action." + map2["dumpContainer"] + ")",
                                "0": item["0"]
                            });
                        }

                        if ('toggle' in prf.properties) {
                            items.push({type: 'split'});
                            items.push({
                                id: "setToggle",
                                cat: 'con',
                                _toggle: true,
                                caption: "$(RAD.action." + map2["setToggle"] + ")"
                            });
                        } else if (prf.box["ood.UI.Dialog"]) {
                            items.push({type: 'split'});
                            items.push({
                                id: "close",
                                cat: 'none',
                                caption: "$(RAD.action." + map2["close2"] + ")"
                            });
                            items.push({
                                id: "showModal",
                                cat: 'none',
                                caption: "$(RAD.action." + map2["showModal"] + ")"
                            });
                        } else if (prf.box["ood.UI.PageBar"]) {
                            items.push({type: 'split'});
                            items.push({
                                id: "getPage",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.getPage()}",
                                caption: "$(RAD.action." + map2["getPage"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "getTotalPages",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.getTotalPages()}",
                                caption: "$(RAD.action." + map2["getTotalPages"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "buindAPI",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.buindAPI()}",
                                caption: "$(RAD.action.esd.buindAPI)",
                                "0": item["0"]
                            });

                            items.push({
                                id: "setPage",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.setPage()}",
                                caption: "$(RAD.action." + map2["setPage"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "setTotalCount",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.setTotalCount()}",
                                caption: "$(RAD.action." + map2["setTotalCount"] + ")",
                                "0": item["0"]
                            });
                        } else if (prf.box["ood.UI.TreeBar"]) {
                            items.push({type: 'split'});
                            items.push({
                                id: "toggleNode",
                                cat: 'con',
                                _toggle: true,
                                hassub: 1,
                                caption: "$(RAD.action." + map2["toggleNode"] + ")",
                                "0": item["0"]
                            });
                        }
                        if ((prf.properties.items && !prf.box['ood.UI.ComboInput']) ||
                            ((prf.properties.type == "helpinput" || prf.properties.type == "combobox" || prf.properties.type == "listbox") && prf.box['ood.UI.ComboInput'])
                        ) {
                            items.push({type: 'split'});
                            if (!prf.box['ood.UI.ComboInput']) {
                                if (prf.boxing().setValue) {
                                    items.push({
                                        id: "setValue",
                                        cat: 'con',
                                        caption: "$(RAD.action." + map2["activeItem"] + ")",
                                        "0": item["0"]
                                    });
                                }
                            }
                            if (prf.key != "ood.UI.ToolBar" && prf.key != "ood.UI.Layout") {
                                items.push({
                                    id: "insertItems",
                                    cat: 'mix',
                                    caption: "$(RAD.action." + map2["insertItems"] + ")",
                                    "0": item["0"]
                                });
                            }
                            items.push({
                                id: "updateItem",
                                cat: 'mix',
                                caption: "$(RAD.action." + map2["updateItem"] + ")",
                                "0": item["0"]
                            });
                            if (prf.key != "ood.UI.ToolBar" && prf.key != "ood.UI.Layout") {
                                items.push({
                                    id: "removeItems",
                                    cat: 'con',
                                    caption: "$(RAD.action." + map2["removeItems"] + ")",
                                    "0": item["0"]
                                });
                            }
                            items.push({
                                id: "clearItems",
                                cat: 'none',
                                caption: "$(RAD.action." + map2["clearItems"] + ")"
                            });
                        } else if (prf.box["ood.UI.TreeGrid"]) {
                            items.push({type: 'split'});
                            items.push({
                                id: "isDirtied",
                                cat: 'none',
                                caption: "$(RAD.action." + map2["isDirtied"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "updateGridValue",
                                cat: 'none',
                                caption: "$(RAD.action." + map2["updateGridValue"] + ")",
                                "0": item["0"]
                            });

                            items.push({
                                id: "toggleRow",
                                cat: 'con',
                                _toggle: true,
                                hassub: 1,
                                caption: "$(RAD.action." + map2["toggleRow"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "triggerFormulas",
                                cat: 'none',
                                caption: "$(RAD.action." + map2["triggerFormulas"] + ")"
                            });
                            items.push({type: 'split'});
                            items.push({
                                id: "isCellDirtied",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.isCellDirtied()}",
                                caption: "$(RAD.action." + map2["isCellDirtied"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "updateCellValue",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.updateCellValue()}",
                                caption: "$(RAD.action." + map2["updateCellValue"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "focusCellbyRowCol",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.focusCellbyRowCol()}",
                                caption: "$(RAD.action." + map2["focusCellbyRowCol"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "getCellbyRowCol",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.getCellbyRowCol()}",
                                caption: "$(RAD.action." + map2["getCellbyRowCol"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "getActiveCell",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.getActiveCell()}",
                                caption: "$(RAD.action." + map2["getActiveCell"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "setActiveCell",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.setActiveCell()}",
                                caption: "$(RAD.action." + map2["setActiveCell"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "updateCellByRowCol2",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.updateCellByRowCol2()}",
                                caption: "$(RAD.action." + map2["updateCellByRowCol2"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "updateCellValue",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.updateCellValue()}",
                                caption: "$(RAD.action." + map2["updateCellValue"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "resetCellValue",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.resetCellValue()}",
                                caption: "$(RAD.action." + map2["resetCellValue"] + ")",
                                "0": item["0"]
                            });
                            items.push({type: 'split'});
                            items.push({
                                id: "isRowDirtied",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.isRowDirtied()}",
                                caption: "$(RAD.action." + map2["isRowDirtied"] + ")",
                                "0": item["0"]
                            });

                            items.push({
                                id: "updateRowValue",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.updateRowValue()}",
                                caption: "$(RAD.action." + map2["updateRowValue"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "editCellbyRowCol",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.editCellbyRowCol()}",
                                caption: "$(RAD.action." + map2["editCellbyRowCol"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "getEditor",
                                cat: 'none',
                                caption: "$(RAD.action." + map2["getEditor"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "getEditCell",
                                cat: 'none',
                                caption: "$(RAD.action." + map2["getEditCell"] + ")"
                            });
                            items.push({
                                id: "updateEditor",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.updateEditor()}",
                                caption: "$(RAD.action." + map2["updateEditor"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "offEditor",
                                cat: 'none',
                                caption: "$(RAD.action." + map2["offEditor"] + ")",
                                "0": item["0"]
                            });

                            items.push({type: 'split'});
                            items.push({
                                id: "getRowbyCell",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.getRowbyCell()}",
                                caption: "$(RAD.action." + map2["getRowbyCell"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "getActiveRow",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.getActiveRow()}",
                                caption: "$(RAD.action." + map2["getActiveRow"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "autoRowHeight",
                                cat: 'none',
                                caption: "$(RAD.action." + map2["autoRowHeight"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "setActiveRow",
                                cat: 'mix',
                                caption: "$(RAD.action." + map2["setActiveRow"] + ")",
                                "0": item["0"]
                            });

                            items.push({
                                id: "getRawData",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.getRawData()}",
                                caption: "$(RAD.action." + map2["getRawData"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "setRawData",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.setRawData()}",
                                caption: "$(RAD.action." + map2["setRawData"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "insertRows",
                                cat: 'mix',
                                caption: "$(RAD.action." + map2["insertRows"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "updateRow",
                                cat: 'mix',
                                caption: "$(RAD.action." + map2["updateRow"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "setRowMap",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.setRowMap()}",
                                caption: "$(RAD.action." + map2["setRowMap"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "getRowMap",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.getRowMap()}",
                                caption: "$(RAD.action." + map2["getRowMap"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "getHotRow",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.getHotRow()}",
                                caption: "$(RAD.action." + map2["getHotRow"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "updateHotRow",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.updateHotRow()}",
                                caption: "$(RAD.action." + map2["updateHotRow"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "removeRows",
                                cat: 'con',
                                caption: "$(RAD.action." + map2["removeRows"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "removeAllRows",
                                cat: 'none',
                                caption: "$(RAD.action." + map2["removeAllRows"] + ")"
                            });
                            /*
                            items.push({
                                id:"insertCol",
                                cat:'mix',
                                caption:"$(RAD.action."+map2["insertCol"]+")",
                                "0":item["0"]
                            });
                            */
                            items.push({type: 'split'});
                            items.push({
                                id: "getHeaderByCell",
                                cat: 'callcb',
                                redirection: 'other:callback:call',
                                _tpl: "{page.*.getHeaderByCell()}",
                                caption: "$(RAD.action." + map2["getHeaderByCell"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "sortColumn",
                                cat: 'mix',
                                caption: "$(RAD.action." + map2["sortColumn"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "showColumn",
                                cat: 'mix',
                                caption: "$(RAD.action." + map2["showColumn"] + ")",
                                "0": item["0"]
                            });

                            items.push({
                                id: "updateHeader",
                                cat: 'mix',
                                caption: "$(RAD.action." + map2["updateHeader"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "removeCols",
                                cat: 'mix',
                                caption: "$(RAD.action." + map2["removeCols"] + ")",
                                "0": item["0"]
                            });
                            items.push({
                                id: "setHeader",
                                cat: 'none',
                                caption: "$(RAD.action." + map2["setHeader"] + ")"
                            });
                        }
                        if (prf.boxing().editItem) {
                            items.push({
                                id: "editItem",
                                cat: 'con',
                                caption: "$(RAD.action." + map2["editItem"] + ")",
                                "0": item["0"]
                            });
                        }
                        items.push({type: 'split'}, {
                            id: "destroy",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["destroy"] + ")"
                        });
                    }
                    break;
                case 'other':
                    if (item.id == "other:url") {
                        items = [{
                            id: "none",
                            caption: "$RAD.action." + map2["none"],
                            imageClass: 'ri-forbid-2-line',
                            cat: "none"
                        }, {

                            id: "showModule2",
                            caption: "$RAD.action.esd.showModule2",
                            redirection: 'other:callback:call',
                            _tpl: "{ood.showModule2()}",
                            cat: 'callcb',

                        }, {
                            id: "close",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["close"] + ")"
                        }, {
                            id: "open----_self",
                            cat: 'url',
                            caption: "$(RAD.action." + map2["open----_self"] + ")"
                        }, {
                            id: "open----_blank",
                            cat: 'url',
                            caption: "$(RAD.action." + map2["open----_blank"] + ")"
                        }, {
                            id: "mailTo",
                            cat: 'url',
                            caption: "$(RAD.action." + map2["mailTo"] + ")"
                        },
                            {type: 'split'},
                            {
                                id: "selectFile",
                                cat: 'selfile',
                                caption: "$(RAD.action." + map2["selectFile"] + ")"
                            }, {
                                id: "readText",
                                cat: 'datatransfer',
                                caption: "$(RAD.action." + map2["readText"] + ")"
                            }, {
                                id: "readJSON",
                                cat: 'datatransfer',
                                caption: "$(RAD.action." + map2["readJSON"] + ")"
                            }];
                    } else if (item.id == "other:var") {
                        items = [{
                            id: "none",
                            caption: "$RAD.action." + map2["none"],
                            imageClass: 'ri-forbid-2-line',
                            cat: "none"
                        }, {
                            id: "temp",
                            cat: 'var',
                            args: [],
                            caption: "$(RAD.action." + map2["temp"] + ")"
                        }, {
                            id: "global",
                            cat: 'var',
                            args: [],
                            caption: "$(RAD.action." + map2["global"] + ")"
                        }, {
                            id: "page",
                            cat: 'var',
                            args: [],
                            caption: "$(RAD.action." + map2["page"] + ")"
                        }, {
                            id: "page.properties",
                            cat: 'var',
                            args: [],
                            caption: "$(RAD.action." + map2["page.properties"] + ")"
                        }];
                    } else if (item.id == "other:callback") {
                        items = [{
                            id: "none",
                            caption: "$RAD.action." + map2["none"],
                            imageClass: 'ri-forbid-2-line',
                            cat: "none"
                        }, {
                            id: "call",
                            cat: 'callcb',
                            args: [],
                            caption: "$(RAD.action." + map2["call"] + ")"
                        }, {
                            id: "set",
                            cat: 'setcb',
                            args: [],
                            caption: "$(RAD.action." + map2["set"] + ")"
                        }, {id: "xxx", type: 'split'}, {
                            id: "setCookies",
                            cat: 'json',
                            caption: "$(RAD.action." + map2["setCookies"] + ")"
                        }, {
                            id: "setFI",
                            cat: 'json',
                            caption: "$(RAD.action." + map2["setFI"] + ")"
                        }
                        ];
                    } else if (item.id == "other:msg") {
                        items = [{
                            id: "none",
                            caption: "$RAD.action." + map2["none"],
                            imageClass: 'ri-forbid-2-line',
                            cat: "none"
                        },
                            {
                                id: "log",
                                cat: 'log',
                                caption: "$(RAD.action." + map2["log"] + ")"
                            }, {
                                id: "echo",
                                cat: 'log',
                                caption: "$(RAD.action." + map2["echo"] + ")"
                            },
                            {type: 'split'},
                            {
                                id: "message",
                                cat: 'fmsg',
                                args: [],
                                caption: "$(RAD.action." + map2["message"] + ")"
                            }, {
                                id: "pop",
                                cat: 'msg',
                                args: [],
                                caption: "$(RAD.action." + map2["pop"] + ")"
                            }, {
                                id: "alert",
                                cat: 'msg',
                                args: [],
                                caption: "$(RAD.action." + map2["alert"] + ")"
                            }, {
                                id: "confirm",
                                cat: 'msg',
                                args: [],
                                caption: "$(RAD.action." + map2["confirm"] + ")"
                            }, {
                                id: "prompt",
                                cat: 'msg',
                                args: [],
                                caption: "$(RAD.action." + map2["prompt"] + ")"
                            },
                            {type: 'split'},
                            {
                                id: "busy",
                                cat: 'none',
                                args: [],
                                caption: "$(RAD.action." + map2["busy"] + ")"
                            }, {
                                id: "free",
                                cat: 'none',
                                args: [],
                                caption: "$(RAD.action." + map2["free"] + ")"
                            }];
                    }
                    break;
                case 'module':
                    items = [{
                        id: "popUp",
                        cat: 'callcb',
                        redirection: 'other:callback:call',
                        _tpl: "{page.*.popUp()}",
                        caption: "$(RAD.action." + map2["popUp"] + ")"
                    }, {
                        id: "show",
                        cat: 'con',
                        caption: "$(RAD.action." + map2["show"] + ")"
                    }, {
                        id: "hide",
                        cat: 'none',
                        caption: "$(RAD.action." + map2["hide"] + ")"
                    },
                        {type: 'split'},
                        {
                            id: "postMessage",
                            cat: 'callcb',
                            redirection: 'other:callback:call',
                            _tpl: "{page.*.postMessage()}",
                            caption: "$(RAD.action." + map2["postMessage"] + ")"
                        },
                        {
                            id: "setHooks",
                            cat: 'callcb',
                            redirection: 'other:callback:call',
                            _tpl: "{page.*.setHooks()}",
                            caption: "$(RAD.action." + map2["setHooks"] + ")"
                        },
                        {
                            id: "notifyHooks",
                            cat: 'callcb',
                            redirection: 'other:callback:call',
                            _tpl: "{page.*.notifyHooks()}",
                            caption: "$(RAD.action." + map2["notifyHooks"] + ")"
                        },
                        {
                            id: "callFunction",
                            cat: 'callcb',
                            redirection: 'other:callback:call',
                            _tpl: "{page.*.callFunction()}",
                            caption: "$(RAD.action." + map2["callFunction"] + ")"
                        },
                        {
                            id: "fireEvent",
                            cat: 'callcb',
                            redirection: 'other:callback:call',
                            _tpl: "{page.*.fireEvent()}",
                            caption: "$(RAD.action." + map2["fireEvent"] + ")"
                        },
                        {type: 'split'},
                        {
                            id: "setProperties",
                            cat: 'json',
                            caption: "$(RAD.action." + map2["setProperties"] + ")"
                        }, {
                            id: "setProfiles",
                            cat: 'data',
                            caption: "$(RAD.action." + map2["setProfiles"] + ")"
                        },
                        {
                            id: "initData",
                            cat: 'none',
                            caption: "$(RAD.action.esd.initData)"
                        },
                        {
                            id: "reloadParent",
                            cat: 'none',
                            caption: "$(RAD.action.esd.reloadParent)"
                        },

                        {
                            id: "setData",
                            cat: 'data',
                            caption: "$(RAD.action." + map2["setData"] + ")"
                        }, {
                            id: "setValue",
                            cat: 'data',
                            caption: "$(RAD.action." + map2["setValue"] + ")"
                        }, {
                            id: "destroy",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["destroy"] + ")"
                        }];
                    items.unshift({
                        id: "none",
                        caption: "$RAD.action." + map2["none"],
                        imageClass: 'ri-forbid-2-line',
                        cat: "none"
                    });
                    break;
                case "otherModuleCall":
                    items = [{
                        id: "open",
                        cat: 'none',
                        caption: "$(RAD.action." + map2["open"] + ")"
                    },
                        {
                            id: "show2",
                            cat: 'callcb',
                            redirection: 'page',
                            _tpl: "{page.show2()}",
                            caption: "$(RAD.action." + map2["show2"] + ")"
                        },
                        {
                            id: "initData",
                            cat: 'callcb',
                            redirection: 'page',
                            _tpl: "{page.initData()}",
                            caption: "$(RAD.action.esd.initData)"
                        },

                        {
                            id: "popUp",
                            cat: 'callcb',
                            redirection: 'page::',
                            _tpl: "{page.popUp()}",
                            caption: "$(RAD.action." + map2["popUp"] + ")"
                        }, {
                            id: "show",
                            cat: 'con',
                            caption: "$(RAD.action." + map2["show"] + ")"
                        }, {
                            id: "hide",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["hide"] + ")"
                        }, {
                            id: "destroy",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["destroy"] + ")"
                        },
                        {type: 'split'},
                        {
                            id: "postMessage",
                            cat: 'callcb',
                            redirection: 'page::',
                            _tpl: "{page.postMessage()}",
                            caption: "$(RAD.action." + map2["postMessage"] + ")"
                        },
                        {
                            id: "setHooks",
                            cat: 'callcb',
                            redirection: 'page::',
                            _tpl: "{page.setHooks()}",
                            caption: "$(RAD.action." + map2["setHooks"] + ")"
                        },
                        {
                            id: "notifyHooks",
                            cat: 'callcb',
                            redirection: 'page::',
                            _tpl: "{page.notifyHooks()}",
                            caption: "$(RAD.action." + map2["notifyHooks"] + ")"
                        },
                        {
                            id: "callFunction",
                            cat: 'callcb',
                            // redirection: 'other:callback:call',
                            caption: "$(RAD.action." + map2["callFunction"] + ")"
                        },
                        {
                            id: "fireEvent",
                            cat: 'callcb',
                            redirection: 'page::',
                            _tpl: "{page.fireEvent()}",
                            caption: "$(RAD.action." + map2["fireEvent"] + ")"
                        },
                        {type: 'split'},
                        {
                            id: "setProperties",
                            cat: 'json',
                            caption: "$(RAD.action." + map2["setProperties"] + ")"
                        }, {
                            id: "setProfiles",
                            cat: 'data',
                            caption: "$(RAD.action." + map2["setProfiles"] + ")"
                        }, {
                            id: "setData",
                            cat: 'data',
                            caption: "$(RAD.action." + map2["setData"] + ")"
                        }, {
                            id: "setValue",
                            cat: 'data',
                            caption: "$(RAD.action." + map2["setValue"] + ")"
                        }];
                    if (SPA.currentPage == item.id)
                        items.shift();
                    items.unshift({
                        id: "none",
                        caption: "$RAD.action." + map2["none"],
                        imageClass: 'ri-forbid-2-line',
                        cat: "none"
                    });
                    break;
                case "page":
                    items = [{
                        id: "open",
                        cat: 'none',
                        caption: "$(RAD.action." + map2["open"] + ")"
                    },
                        {
                            id: "checkValid",
                            cat: 'callcb',
                            redirection: 'page',
                            _tpl: "{page.checkValid()}",
                            caption: ood.getRes('RAD.actions.validateData') || "验证数据"
                        },
                        {
                            id: "show2",
                            cat: 'callcb',
                            redirection: 'page',
                            _tpl: "{page.show2()}",
                            caption: "$(RAD.action." + map2["show2"] + ")"
                        },
                        {
                            id: "initData",
                            cat: 'callcb',
                            redirection: 'page',
                            _tpl: "{page.initData()}",
                            caption: "$(RAD.action.esd.initData)"
                        },
                        {
                            id: "reloadParent",
                            cat: 'callcb',
                            redirection: 'page',
                            _tpl: "{page.reloadParent()}",
                            caption: "$(RAD.action.esd.reloadParent)"
                        },


                        {
                            id: "popUp",
                            cat: 'callcb',
                            redirection: 'page::',
                            _tpl: "{page.popUp()}",
                            caption: "$(RAD.action." + map2["popUp"] + ")"
                        }, {
                            id: "show",
                            cat: 'con',
                            caption: "$(RAD.action." + map2["show"] + ")"
                        }, {
                            id: "hide",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["hide"] + ")"
                        }, {
                            id: "destroy",
                            cat: 'none',
                            caption: "$(RAD.action." + map2["destroy"] + ")"
                        },
                        {type: 'split'},
                        {
                            id: "postMessage",
                            cat: 'callcb',
                            redirection: 'page::',
                            _tpl: "{page.postMessage()}",
                            caption: "$(RAD.action." + map2["postMessage"] + ")"
                        },
                        {
                            id: "setHooks",
                            cat: 'callcb',
                            redirection: 'page::',
                            _tpl: "{page.setHooks()}",
                            caption: "$(RAD.action." + map2["setHooks"] + ")"
                        },
                        {
                            id: "notifyHooks",
                            cat: 'callcb',
                            redirection: 'page::',
                            _tpl: "{page.notifyHooks()}",
                            caption: "$(RAD.action." + map2["notifyHooks"] + ")"
                        },
                        {
                            id: "callFunction",
                            cat: 'callcb',
                            // redirection: 'other:callback:call',
                            caption: "$(RAD.action." + map2["callFunction"] + ")"
                        },
                        {
                            id: "fireEvent",
                            cat: 'callcb',
                            redirection: 'page::',
                            _tpl: "{page.fireEvent()}",
                            caption: "$(RAD.action." + map2["fireEvent"] + ")"
                        },
                        {type: 'split'},
                        {
                            id: "setProperties",
                            cat: 'json',
                            caption: "$(RAD.action." + map2["setProperties"] + ")"
                        }, {
                            id: "setProfiles",
                            cat: 'data',
                            caption: "$(RAD.action." + map2["setProfiles"] + ")"
                        }, {
                            id: "setData",
                            cat: 'data',
                            caption: "$(RAD.action." + map2["setData"] + ")"
                        }, {
                            id: "setValue",
                            cat: 'data',
                            caption: "$(RAD.action." + map2["setValue"] + ")"
                        }];
                    if (SPA.currentPage == item.id)
                        items.shift();
                    items.unshift({
                        id: "none",
                        caption: "$RAD.action." + map2["none"],
                        imageClass: 'ri-forbid-2-line',
                        cat: "none"
                    });
                    break;

                default:

            }


            var t = ood.get(CONF, ["CustomActions", item._type, item.id.split(":")[1], "items"]);
            if (t) ood.arr.insertAny(items, t);

            ood.arr.each(items, function (o) {
                ood.merge(o, options);
            });
            this.tb_action.setItems(items);
            return items;
        },
        _beforeclose: function () {
            var ns = this;
            ns.blk_float.hide();
            var prf = ns.blk_float.getTag();
            if (prf) prf.getSubNode('INPUT').blur();

            if (ns._hiddenDiv) {
                ns._hiddenDiv.html('');
                ns._hiddenDiv = null;
            }
            if (ns._dirty) {
                ood.confirm(ood.getRes('RAD.notsave'), ood.getRes('RAD.notsave2'), function () {
                    ns.dialog.hide();
                });
            } else
                ns.dialog.hide();
            return false;
        },
        _tb_action_drop: function (profile, e, src, key, data, item) {
            if (data._new)
                profile.boxing().setUIValue(data._new.id, true);
            this.markDirty(1);
        },
        _tb_actions_onchange: function (profile, oldValue, newValue) {
            if (!newValue) return;
            var ns = this, t, o,
                subvalue = "none:none",
                item = profile.getItemByItemId(newValue),
                tagVar = item.tagVar;
            ns._enablectrls();

            ns._initvalue = 1;

            // set target event object
            ns._tagVar = tagVar;

            if ('timeout' in tagVar) {
                // 1
                ns.spin_asy.setUIValue(parseInt(tagVar.timeout, 10) || 0);
                // 2
                ns.cb_asy.setUIValue(true);
            } else {
                ns.cb_asy.setUIValue(false);
            }
            if (('return' in tagVar) && tagVar['return'] === false) {
                ns.cb_false.setUIValue(true);
            } else {
                ns.cb_false.setUIValue(false);
            }

            if ((t = tagVar["target"])) {
                if (tagVar.type == "none") {
                    subvalue = "none:" + t;
                } else if (tagVar.type == "page") {
                    subvalue = t;
                } else if (tagVar.type == "other") {
                    subvalue = "other:" + t;
                } else {
                    subvalue = t;
                }
            }

            ns.i_conl1.setValue("", true);
            ns.i_conr1.setValue("", true);
            ns.ctl_symbol1.setValue("defined", true);
            ns.i_conl2.setValue("", true);
            ns.i_conr2.setValue("", true);
            ns.ctl_symbol2.setValue("defined", true);
            ns.i_conl3.setValue("", true);
            ns.i_conr3.setValue("", true);
            ns.ctl_symbol3.setValue("defined", true);

            if ((t = tagVar["conditions"])) {
                if ((o = t[0])) {
                    if (o.left) ns.i_conl1.setValue(o.left, true);
                    if (o.symbol) ns.ctl_symbol1.setUIValue(o.symbol, true);
                    if (o.right) ns.i_conr1.setValue(o.right, true);
                }
                if ((o = t[1])) {
                    if (o.left) ns.i_conl2.setValue(o.left, true);
                    if (o.symbol) ns.ctl_symbol2.setUIValue(o.symbol, true);
                    if (o.right) ns.i_conr2.setValue(o.right, true);
                }
                if ((o = t[2])) {
                    if (o.left) ns.i_conl3.setValue(o.left, true);
                    if (o.symbol) ns.ctl_symbol3.setUIValue(o.symbol, true);
                    if (o.right) ns.i_conr3.setValue(o.right, true);
                }
            }

            // if (tagVar.className && tagVar.className != SPA.currentClassName){
            //     item.className=tagVar.className;
            // }
            item.className = tagVar.className;

            if (tagVar.type == "page") {
                ns.tb_cat.setUIValue(subvalue, true);
            } else if (tagVar.className && tagVar.className != SPA.getCurrentClassName()) {
                if (ns.tb_cat.getItemByItemId(subvalue)) {
                    ns.tb_cat.setUIValue(subvalue);
                } else {
                    ood.getModule(tagVar.className);
                    ns.tb_cat.toggleNode(tagVar.className, true, true, true, function () {
                        this.setUIValue(subvalue);
                    });
                }

            } else {
                ns.tb_cat.setUIValue(ns.tb_cat.getItemByItemId(subvalue) ? subvalue : "none:none", true);
            }
            //


            ns._initvalue = 0;
        },
        _tb_con_onchange: function (profile, oldValue, newValue) {
            var ns = this, tagVar = ns._tagVar,
                arr = newValue.split(profile.properties.valueSeparator),
                id = arr[0],
                item = profile.getItemByItemId(id);
            if (tagVar) {
                tagVar.args = tagVar.args || [];
                // for selecting container
                if (item) {
                    if (item._iscon) {
                        if (!newValue) return;
                        if (item && newValue != "none") {
                            if (item.con) tagVar.args[0] = item.con;
                            if (item.consub) {
                                if (item.consub != "[key]") {
                                    ns.tb_consub.setReadonly(true);
                                    ns.tb_consub.setUIValue(item.consub, true);
                                } else {
                                    ns.tb_consub.setReadonly(false);
                                    ns.tb_consub.setUIValue("", true);
                                    //ood.asyRun(function(){ns.tb_consub.activate()});
                                }
                            } else {
                                ns.tb_consub.setUIValue("");
                                ns.tb_consub.setReadonly(true);
                            }
                        }
                    } else {
                        var other;
                        for (var i = 0, l = arr.length; i < l; i++) {
                            if (arr[i] == "[key]" || !profile.getItemByItemId(arr[i])) {
                                other = true;
                                break;
                            }
                        }

                        if (!other) {
                            ns.tb_consub.setReadonly(true);
                            ns.tb_consub.setUIValue(newValue == '[key]' ? '' : newValue, true);
                        } else {
                            ns.tb_consub.setReadonly(false);
                            ns.tb_consub.setUIValue(newValue == '[key]' ? '' : newValue, true);
                            // ood.asyRun(function(){ns.tb_consub.activate()});
                        }
                    }
                } else {
                    ns.tb_consub.setUIValue("").setReadonly(true);
                    tagVar.args = [];
                }
                ns.markDirty(1);
            }
        },
        _add_target_onchange: function (profile, oldValue, newValue, force, tag) {
            var ns = this;

            ns.tb_mixsub.setReadonly(newValue !== "[key]", true);
            ns.tb_mixsub.setUIValue(newValue == "[key]" ? "" : newValue, true);
        },
        _tb_mixsub_onchange: function (profile, oldValue, newValue, force, tag) {
            var ns = this,
                tagVar = ns._tagVar,
                pos = ns.add_pos.getUIValue(),
                sub = ns.tb_mixsub.getUIValue(),
                mem = ns.add_target.getTagVar(),
                hasSub = mem.hasSub,
                args;
            if (tagVar) {
                args = tagVar.args = tagVar.args || [];
                if (mem.insert) {
                    //treebar/treeview
                    if (hasSub) {
                        switch (pos) {
                            case "before":
                                args[1] = "";
                                args[2] = sub;
                                args[3] = true;
                                ns.ood_block_mix.setDisplay("").adjustDock();
                                break;
                            case "after":
                                args[1] = "";
                                args[2] = sub;
                                args[3] = false;
                                ns.ood_block_mix.setDisplay("").adjustDock();
                                break;
                            case "first":
                                args[1] = "";
                                args[2] = "";
                                args[3] = true;
                                ns.tb_mixsub.setValue("", true);
                                ns.add_target.setValue("", true);
                                ns.ood_block_mix.setDisplay("none").getParent().adjustDock(true);
                                break;
                            case "last":
                                args[1] = "";
                                args[2] = "";
                                args[3] = false;
                                ns.tb_mixsub.setValue("", true);
                                ns.add_target.setValue("", true);
                                ns.ood_block_mix.setDisplay("none").getParent().adjustDock(true);
                                break;
                            case "curbefore":
                                args[1] = "";
                                args[2] = true;
                                args[3] = true;
                                ns.ood_block_mix.setDisplay("none").getParent().adjustDock(true);
                                break;
                            case "curafter":
                                args[1] = "";
                                args[2] = true;
                                args[3] = false;
                                ns.ood_block_mix.setDisplay("none").getParent().adjustDock(true);
                                break;
                            case "subfirst":
                                args[1] = sub;
                                args[2] = "";
                                args[3] = true;
                                ns.ood_block_mix.setDisplay("").adjustDock();
                                break;
                            case "sublast":
                                args[1] = sub;
                                args[2] = "";
                                args[3] = false;
                                ns.ood_block_mix.setDisplay("").adjustDock();
                                break;
                            case "cursubfirst":
                                args[1] = true;
                                args[2] = "";
                                args[3] = true;
                                ns.ood_block_mix.setDisplay("none").getParent().adjustDock(true);
                                break;
                            case "cursublast":
                                args[1] = true;
                                args[2] = "";
                                args[3] = false;
                                ns.ood_block_mix.setDisplay("none").getParent().adjustDock(true);
                                break;
                        }
                    } else {
                        switch (pos) {
                            case "before":
                                args[1] = sub;
                                args[2] = true;
                                ns.ood_block_mix.setDisplay("").adjustDock();
                                break;
                            case "after":
                                args[1] = sub;
                                args[2] = false;
                                ns.ood_block_mix.setDisplay("").adjustDock();
                                break;
                            case "first":
                                args[1] = "";
                                args[2] = true;
                                ns.tb_mixsub.setValue("", true);
                                ns.add_target.setValue("", true);
                                ns.ood_block_mix.setDisplay("none").getParent().adjustDock(true);
                                break;
                            case "last":
                                args[1] = "";
                                args[2] = false;
                                ns.tb_mixsub.setValue("", true);
                                ns.add_target.setValue("", true);
                                ns.ood_block_mix.setDisplay("none").getParent().adjustDock(true);
                            case "curbefore":
                                args[1] = true;
                                args[2] = true;
                                ns.ood_block_mix.setDisplay("none").getParent().adjustDock(true);
                                ns.tb_mixsub.setValue("", true);
                                ns.add_target.setValue("", true);
                                break;
                            case "curafter":
                                args[1] = true;
                                args[2] = false;
                                ns.ood_block_mix.setDisplay("none").getParent().adjustDock(true);
                                ns.tb_mixsub.setValue("", true);
                                ns.add_target.setValue("", true);
                                break;
                                break;
                        }
                    }
                } else {
                    args[0] = sub;
                }
                ns.markDirty(1);
            }
        },
        _tb_consub_onchange: function (profile, oldValue, newValue, te, tag) {
            var ns = this, tagVar = ns._tagVar,
                tag = profile.properties.tag;
            if (tagVar) {
                tagVar.args = tagVar.args || [];
                if (tag == "con") {
                    tagVar.args[1] = newValue || null;
                } else {
                    tagVar.args[0] = newValue || null;
                }
                ns.markDirty(1);
            }
        },
        _toggle_value_onchange: function (profile, oldValue, newValue) {
            var ns = this, tagVar = ns._tagVar;
            if (tagVar) {
                tagVar.args = tagVar.args || [];
                tagVar.args[profile.properties.tag ? 1 : 0] = newValue == "expand";
                ns.markDirty(1);
            }
        },
        _cb_setid_onchange: function (profile, oldValue, newValue, force, tag) {
            var ns = this, tagVar = ns._tagVar;
            if (tagVar) {
                tagVar.args = tagVar.args || [];
                tagVar.args[0] = newValue;
                ns.markDirty(1);
            }
        },
        _cb_setvalue_onchange: function (profile, oldValue, newValue, force, tag) {
            var ns = this, tagVar = ns._tagVar;
            if (tagVar) {
                tagVar.args = tagVar.args || [];
                tagVar.args[1] = newValue;
                ns.markDirty(1);

                ns.ctl_grpp.setHtml("", true);
                var t = newValue, m, gotit, _ns = ns.getScope();
                if (/^\s*\{[\w][\w\.\s*]+[\w]\s*(\[[\d\s]+\])?(\(\s*\))?\s*\}\s*$/.test(newValue)) {
                    t = newValue.split(/\s*\.\s*/);
                    if (t.length === 1) {
                        m = newValue.replace(/[{}()\s]/g, '');
                        t = '{window}';
                    } else {
                        m = t.pop().replace(/[()}\s]/g, '');
                        t = t.join(".") + "}";
                    }
                    t = ood.adjustVar(t, _ns);
                    if (t && ood.isFun(t[m])) {
                        gotit = 1;
                    }
                }
                if (gotit) {
                    if (t.$key) {
                        path = t.$key;
                        if (!t.$oodclass$) path += ".prototype";
                        path += "." + m;
                    } else {
                        path = newValue.replace(/[{\s}]/g, "")
                    }

                    var doc = RAD.EditorTool.getDoc(path, false, true);
                    var arr = doc && doc.$paras;
                    if (!arr && ood.str.trim(ood.fun.body(t[m])) != "[native code]") arr = ood.fun.args(t[m]);
                    if (arr && arr.length) {
                        for (var i = 0, j, l = arr.length; i < l; i++) {
                            j = arr[i].indexOf("[");
                            if (j != -1)
                                arr[i] = "<strong>" + arr[i].substr(0, j) + "</strong>" + arr[i].substr(j, arr[i].length);
                        }
                        ns.ctl_grpp.setHtml("<ol style='padding-left:20px;margin: 8px;line-height: 20px;'><li>" + arr.join("</li><li>") + "</li></ol>", true);
                    }
                }
            }
        },
        _cb_callid_onchange: function (profile, oldValue, newValue, force, tag) {
            var ns = this, tagVar = ns._tagVar;
            if (tagVar) {
                if (!newValue) {
                    tagVar.args = [];
                    ns.grid_params.removeAllRows();
                    return;
                }

                tagVar.args = tagVar.args || [];
                tagVar.args[0] = newValue;
                ns.markDirty(1);

                var t = newValue, tt, m, funType, _ns = ns.getScope();
                if (/^\s*\{[\w][\w\.\s*]+[\w]\s*(\[[\d\s]+\])?(\(\s*\))?\s*\}\s*$/.test(newValue)) {
                    t = newValue.split(/\s*\.\s*/);
                    if (t.length === 1) {
                        m = newValue.replace(/[{}()\s]/g, '');
                        t = '{window}';
                    } else {
                        m = t.pop().replace(/[()}\s]/g, '');
                        t = t.join(".") + "}";
                    }
                    if (tagVar.className && ood.getModule(tagVar.className)) {
                        t = ood.adjustVar(tt = t, {page: ood.getModule(tagVar.className)});
                    } else {
                        t = ood.adjustVar(tt = t, _ns);
                    }

                    if (!ood.isDefined(t)) {
                        funType = ood.str.trim(ood.fun.body(m)) == "[native code]" ? 'nvative' : 'external';
                    } else if (t && t[m]) {
                        if (ood.isFun(t[m])) {
                            // for native function
                            funType = ood.str.trim(ood.fun.body(t[m])) == "[native code]" ? 'native' : 'function';
                        } else if (t[m].args && ood.isArr(t[m].args) && t[m].args.length) {
                            t = t[m].args;
                            funType = 'pusedo';
                        } else {
                            funType = 'unknow';
                        }
                    }

                } else {
                    tagVar.args = [];
                    ns.grid_params.removeAllRows();
                    return;
                }

                var rows = ns.grid_params.getRows(),
                    len = rows.length,
                    maxlen = 10,
                    path;

                if (funType == 'function') {
                    if (t.$key) {
                        path = t.$key;
                        if (!t.$oodclass$) path += ".prototype";
                        path += "." + m;
                    } else {
                        path = newValue.replace(/[{\s}]/g, "")
                    }

                    var doc = RAD.EditorTool.getDoc(path, false, true);
                    var arr = doc && doc.$paras;
                    if (!arr) arr = ood.fun.args(t[m]);
                    if (arr && arr.length) {
                        var len2 = arr.length;
                        if (len > len2) {
                            for (var i = len; i >= len2; i--)
                                ns.grid_params.removeRows("" + (i + 3));
                        } else if (len < len2) {
                            for (var i = len, l = len2; i < l; i++)
                                ns.grid_params.insertRows([{id: "" + (i + 3), cells: ["", ""]}]);
                        }
                        for (var i = 0, l = len2; i < l; i++)
                            ns.grid_params.updateCellByRowCol("" + (i + 3), "key", arr[i], false, false);
                        return;
                    }
                }
                else if (funType == 'pusedo') {
                    var arr = t;
                    var len2 = arr.length;
                    if (len > len2) {
                        for (var i = len; i >= len2; i--)
                            ns.grid_params.removeRows("" + (i + 3));
                    } else if (len < len2) {
                        for (var i = len, l = len2; i < l; i++)
                            ns.grid_params.insertRows([{id: "" + (i + 3), cells: ["", ""]}]);
                    }
                    for (var i = 0, l = len2; i < l; i++)
                        ns.grid_params.updateCellByRowCol("" + (i + 3), "key", arr[i].id + " : " + arr[i].type + (arr[i].des ? ", " + arr[i].des : ""), false, false);
                    return;
                }

                if (len < maxlen) {
                    for (var i = len, l = maxlen; i < l; i++)
                        ns.grid_params.insertRows([{id: "" + (i + 3), cells: ["", ""]}]);
                }
                for (var i = 0, l = maxlen; i < l; i++) {
                    ns.grid_params.updateCellByRowCol("" + (i + 3), "key", " " + ood.getRes("$RAD.action.Parameter") + " " + (i + 1), false, false);
                }
            }
        },
        _cb_callreturnto_onchange: function (profile, oldValue, newValue, force, tag) {
            var ns = this, tagVar = ns._tagVar;
            if (tagVar) {
                tagVar.args = tagVar.args || [];
                tagVar.args[1] = newValue;
                ns.markDirty(1);
                var tt = tagVar.args;
                ns.conf_return_exp.setHtml(tt[1] && tt[1] != 'none' ? '${' + (tt[1] + '.') + (tt[2] ? tt[2] : '?') + '}' : '');
            }
        },
        _cb_callreturn_onchange: function (profile, oldValue, newValue, force, tag) {
            var ns = this, tagVar = ns._tagVar;
            if (tagVar) {
                tagVar.args = tagVar.args || [];
                tagVar.args[2] = newValue;
                ns.markDirty(1);
                var tt = tagVar.args;
                ns.conf_return_exp.setHtml(tt[1] && tt[1] != 'none' ? '${' + (tt[1] + '.') + (tt[2] ? tt[2] : '?') + '}' : '');
            }
        },

        _tb_cat_onchange: function (profile, oldValue, newValue) {
            if (!newValue) return;
            var ns = this, t,
                subvalue = "none",
                item = profile.getItemByItemId(newValue);

            if (item) {
                ns.lbl_target.setCaption((item && item.caption || "").split("<br />")[0]);
                var items = ns._buildsubtree(item);
                if (items && items.length) subvalue = items[0].id;

                var method;
                if (ns._tagVar) {
                    if (item.className && item.className != SPA.getCurrentClassName()) {
                        ns._tagVar["className"] = item.className;
                    }
                    if (item.euClassName && item.euClassName != SPA.getCurrentClassName()) {
                        ns._tagVar["euClassName"] = item.euClassName;
                    } else {
                        //  delete ns._tagVar.className ;
                    }
                    ns._tagVar["type"] = item._type;
                    t = item.id;
                    if (item._type == "none") {
                        t = t.replace("none:", "");
                    }
                    if (item._type == "page" || item._type == "module") {
                        //t=t;
                    } else if (item._type == "other") {
                        t = t.replace("other:", "");
                    }

                    if (oldValue && oldValue != 'none:none') {
                        //ns._tagVar["args"]=[] ;
                        // delete  ns._tagVar["method"] ;
                    }
                    ns._tagVar["target"] = t;

                    if (ood.arr.subIndexOf(items, "id", ns._tagVar.method) != -1) {
                        subvalue = ns._tagVar.method;
                    }
                    ns.markDirty(1);
                }
            }
            ns.tb_action.setUIValue(ns.tb_action.getItemByItemId(subvalue) ? subvalue : "none", true);
        },
        _tb_action_onchange: function (profile, oldValue, newValue) {
            if (!newValue) return;
            var ns = this,
                prop = ns.properties,
                parent = prop.parent,
                tagVar = ns._tagVar,
                subvalue = "none",
                item = profile.getItemByItemId(newValue);

            if (tagVar && !ns._initvalue && oldValue) {
                tagVar.args = ood.isSet(item.args) ? ood.copy(item.args) : [];
                delete tagVar.onOK;
                delete tagVar.onKO;
                delete tagVar.adjust;
                delete tagVar.redirection;
            }
            ns.markDirty(1);
            ns._targetshadow = ns._targetshadow2 = null;

            var nv, ov = ns.tab_conf.getUIValue();
            if (item) {
                if (ns.tab_conf.getItemByItemId(item.cat)) {
                    nv = item.cat;
                } else if (item.customUI) {
                    item.customUI(ns, ns.tab_conf);
                    nv = item.cat;
                }
            }
            if (!nv) nv = "none";

            ns.tab_conf.setUIValue(nv, true);

            if (tagVar && !ns._initvalue && nv != ov) tagVar["args"] = ood.isSet(item.args) ? ood.copy(item.args) : tagVar["args"];

            if (item) {
                ns.lbl_action.setCaption(item && item.caption || "");

                if (tagVar) {
                    tagVar["method"] = item.id;
                    delete tagVar.onOK;
                    delete tagVar.onKO;
                }

                // must reset here
                ns.add_target.setTagVar(null, true);

                switch (item.cat) {
                    case 'animate':
                        tagVar.onOK = 1;
                        var value = ood.get(tagVar, ["args", 0]) || "blinkAlert";
                        ns.iniPureValue(ns.ctl_animate, value);
                        break;
                    case 'selfile':
                        if (item.id == 'selectFile') {
                            tagVar.onOK = 0;
                        }
                        break;
                    case 'fmsg':
                        ns.msg_body.setUIValue(ood.get(tagVar, ["args", 0]) || "");
                        ns.msg_cap.setUIValue(ood.get(tagVar, ["args", 1]) || "");
                        ns.msg_width.setUIValue(ood.get(tagVar, ["args", 2]) || 200);
                        ns.msg_duration.setUIValue(ood.get(tagVar, ["args", 3]) || 5000);
                        break;
                    case "log":
                        ns.log_v1.setValue(ood.get(tagVar, ["args", 0]) || "");
                        ns.log_v2.setValue(ood.get(tagVar, ["args", 1]) || "");
                        ns.log_v3.setValue(ood.get(tagVar, ["args", 2]) || "");
                        ns.log_v4.setValue(ood.get(tagVar, ["args", 3]) || "");
                        ns.log_v5.setValue(ood.get(tagVar, ["args", 4]) || "");
                        break;
                    case "msg":
                        ns.msg_title.setUIValue(ood.get(tagVar, ["args", 0]) || "");
                        ns.msg_message.setUIValue(ood.get(tagVar, ["args", 1]) || "");
                        if (item.id == "alert" || item.id == "confirm") {
                            ns.msg_m.setDisplay('');
                            tagVar.onOK = 2;
                            if (item.id == "confirm") {
                                tagVar.onKO = 3;
                                tagVar.okFlag = "_confirm_yes";
                                tagVar.koFlag = "_confirm_no";
                            }
                        } else if (item.id == "prompt") {
                            ns.msg_m.setDisplay('');
                            tagVar.onOK = 3;
                            tagVar.onKO = 4;
                            tagVar.okFlag = "_prompt_ok";
                            tagVar.koFlag = "_prompt_cancel";
                        } else
                            ns.msg_m.setDisplay('none');
                        if (item.id == "prompt") {
                            ns.msg_input.setDisplay('');
                            ns.msg_inputm.setDisplay('');
                            ns.msg_input.setUIValue(ood.get(tagVar, ["args", 2]) || "");
                        } else {
                            ns.msg_input.setDisplay('none');
                            ns.msg_inputm.setDisplay('none');
                        }
                        break;
                    case "url":
                        ns.url_address.setUIValue(ood.get(tagVar, ["args", 0]) || "");
                        ns._jsoneditor2.render();
                        ns._jsoneditor2.setValue(ood.get(tagVar, ["args", 1]) || {});
                        break;
                    case "datatransfer":
                        if (item.id == "invoke") {
                            ns.fileurl_address.setDisplay('none');
                            ns.ctl_slabel57.setTop('.5em');
                            tagVar.onOK = 0;
                            tagVar.onKO = 1;

                            tagVar.okFlag = "_DI_succeed";
                            tagVar.koFlag = "_DI_fail";
                        } else {
                            ns.ctl_slabel57.setTop('4em');
                            ns.fileurl_address.setDisplay('')
                                .setUIValue(ood.get(tagVar, ["args", 0]) || "");
                            if (item.id == 'readText') {
                                tagVar.onOK = 1;
                                tagVar.onKO = 2;
                                tagVar.okFlag = "_DI_succeed";
                                tagVar.koFlag = "_DI_fail";
                            } else if (item.id == 'readJSON') {
                                tagVar.onOK = 1;
                                tagVar.onKO = 2;
                                tagVar.okFlag = "_DI_succeed";
                                tagVar.koFlag = "_DI_fail";
                            }
                        }
                        break;
                    case 'mix':
                        var prf = item["0"],
                            prop = prf.properties,
                            method = tagVar.method,
                            hasSub = prf.box['ood.UI.TreeBar'] || (prf.box['ood.UI.TreeGrid'] && method == "insertRows"),
                            insert = method == "insertItems" || method == "insertRows" || method == "insertCol",
                            specialUpdate = method == "setFormValues",
                            update = /^(update|set)/.test(method),
                            keyN = (method == "insertRows" || method == "updateRow" || method == "setActiveRow" || method == "updateCellByRowCol2") ? "rows" :
                                (method == "insertCol" || method == "updateHeader" || method == "removeCols" || method == "showColumn" || method == "sortColumn") ? "header" :
                                    "items",
                            org = prop[keyN],
                            items;

                        if (method == "updateCellByRowCol2") {
                            items = [];
                            var fun = function (rows, items, pk) {
                                ood.arr.each(rows, function (row, i) {
                                    if (row.id == ood.UI.TreeGrid._temprowid) return;

                                    var sub = [];
                                    items.push({
                                        id: pk + ":" + i,
                                        caption: ood.getRes("RAD.action.Row $0", pk + i),
                                        group: true,
                                        sub: sub
                                    });
                                    ood.arr.each(prop.header, function (col, j) {
                                        sub.push({
                                            id: pk + i + ":" + j,
                                            row: i,
                                            col: j,
                                            caption: ood.getRes("RAD.action.Row $0", pk + i) + "  , " + ood.getRes("RAD.action.Column $0", j)
                                        })
                                    });
                                });
                            };
                            fun(prop.rows, items, "");
                        } else {
                            items = ood.clone(org, true);
                            ood.filter(items, function (o) {
                                if (o.id == ood.UI.TreeGrid._temprowid) return false;
                                return true;
                            });
                        }
                        ;
                        if (!items || !items.length) items = [];
                        if (method == "setFormValues") {
                        } else {
                            items.push({
                                id: "[key]",
                                caption: "$(RAD.action.Other sub$-item (Empty means current$))"
                            });
                        }
                        ns.add_target.setItems(items);

                        // List.insertItems(arr, base, before
                        // TreeBar.insertItems(arr, pid, base, before
                        ns.add_target.setTagVar({
                            hasSub: hasSub,
                            insert: insert,
                            update: update,
                            specialUpdate: specialUpdate,
                            clsN: prf.box.KEY,
                            keyN: keyN
                        });

                        //init
                        ns.blk_itempos.setDisplay(insert ? '' : 'none', true).setDockIgnore(!insert, true);
                        if (hasSub) {
                            ns.add_pos.showItems(['subfirst', 'sublast', 'cursubfirst', 'cursublast']);
                        } else {
                            ns.add_pos.showItems(['subfirst', 'sublast', 'cursubfirst', 'cursublast'], false);
                        }
                        var item_id, value;
                        if (insert) {
                            //default is string
                            value = ood.get(tagVar, ["args", 0]) || "";

                            //treebar/treeview/treegrid.rows
                            if (hasSub) {
                                var pid = ood.get(tagVar, ["args", 1]) || "",
                                    baseid = ood.get(tagVar, ["args", 2]) || "",
                                    before = ood.get(tagVar, ["args", 3]),
                                    pos

                                if (pid) {
                                    if (pid === true) {
                                        pos = before ? "cursubfirst" : "cursublast";
                                        ns.ood_block_mix.setDisplay("none").getParent().adjustDock(true);
                                        ns.add_target.setValue("[key]", true);
                                        ns.add_pos.setValue(pos, true);
                                    } else {
                                        pos = before ? "subfirst" : "sublast";
                                        ns.ood_block_mix.setDisplay("").adjustDock();
                                        ns.tb_mixsub.setReadonly(pid != "[key]" && !!ns.add_target.getItemByItemId(pid), true);
                                        ns.tb_mixsub.setValue(pid, true);
                                        if (ns.add_target.getItemByItemId(pid))
                                            ns.add_target.setValue(pid, true);
                                        else
                                            ns.add_target.setValue("[key]", true);
                                        ns.add_pos.setValue(pos, true);
                                    }
                                } else {
                                    if (baseid) {
                                        if (baseid === true) {
                                            pos = before ? "curbefore" : "curafter";
                                            ns.ood_block_mix.setDisplay("none").getParent().adjustDock(true);
                                        } else {
                                            pos = before ? "before" : "after";
                                            ns.ood_block_mix.setDisplay("").adjustDock();
                                            ns.tb_mixsub.setReadonly(baseid != "[key]" && !!ns.add_target.getItemByItemId(baseid), true);
                                        }
                                    } else {
                                        pos = before ? "first" : "last";
                                        ns.ood_block_mix.setDisplay("none").getParent().adjustDock(true);
                                    }
                                    ns.tb_mixsub.setValue(baseid, true);
                                    if (ns.add_target.getItemByItemId(baseid))
                                        ns.add_target.setValue(baseid, true);
                                    else
                                        ns.add_target.setValue("[key]", true);
                                    ns.add_pos.setUIValue(pos, true);
                                }
                            } else {
                                var baseid = ood.get(tagVar, ["args", 1]) || "",
                                    before = ood.get(tagVar, ["args", 2]),
                                    pos;
                                if (baseid) {
                                    if (baseid === true) {
                                        pos = before ? "curbefore" : "curafter";
                                        ns.ood_block_mix.setDisplay("none").getParent().adjustDock(true);
                                    } else {
                                        pos = before ? "before" : "after";
                                        ns.ood_block_mix.setDisplay("").adjustDock();
                                        ns.tb_mixsub.setReadonly(baseid != "[key]" && !!ns.add_target.getItemByItemId(baseid), true);
                                    }
                                } else {
                                    pos = before ? "first" : "last";
                                    ns.ood_block_mix.setDisplay("none").getParent().adjustDock(true);
                                }
                                ns.tb_mixsub.setValue(baseid, true);
                                if (ns.add_target.getItemByItemId(baseid))
                                    ns.add_target.setValue(baseid, true);
                                else
                                    ns.add_target.setValue("[key]", true);
                                ns.add_pos.setUIValue(pos, true);
                            }
                        } else {
                            if (specialUpdate) {
                                value = ood.get(tagVar, ["args", 0]) || "";
                                item_id = null;
                            } else {
                                //default is string
                                value = ood.get(tagVar, ["args", 1]) || "";
                                item_id = ood.get(tagVar, ["args", 0]) || "";
                            }

                            if (ns.add_target.getItemByItemId(item_id)) {
                                ns.add_target.setValue(item_id, true);
                                ns.tb_mixsub.setValue(item_id, true);
                                ns.ood_block_mix.setDisplay("").adjustDock();
                                ns.tb_mixsub.setReadonly(item_id != "[key]", true);
                            } else {
                                if (item_id) {
                                    ns.add_target.setValue("[key]", true);
                                    ns.tb_mixsub.setValue(item_id, true);
                                    ns.ood_block_mix.setDisplay("").adjustDock();
                                    ns.tb_mixsub.setReadonly(false, true);
                                } else {
                                    if (items.length) {
                                        ns.add_target.setUIValue(item_id, true);
                                        item_id = items[0].id
                                        ns.tb_mixsub.setUIValue(item_id == "[key]" ? "" : item_id, true);
                                        ns.ood_block_mix.setDisplay("").adjustDock();
                                        ns.tb_mixsub.setReadonly(true, true);
                                    }
                                    // no-items case for [setFormValues]
                                    else {
                                        ns.ood_block_mix.setDisplay("none").getParent().adjustDock(true);
                                        ns.tb_mixsub.setReadonly(false, false);
                                    }
                                }
                            }
                        }

                        ns.iniPureValue(ns.ctl_itemvar, value);
                        break;
                    case "con":
                        // prepare UI
                        ns.tb_con.setSelMode('single');
                        ns.ctl_blockcon.setDisplay("block");
                        ns.ctl_tocon.setDisplay("block");

                        switch (tagVar.method) {
                            case "showItems":
                            case "hideItems":
                            case "setValue":
                            case "fireItemClickEvent":
                            case "editItem":
                            case "removeItems":
                            case "setActiveRow":
                            case "removeRows":
                            case "removeCols ":
                            case "dumpContainer":
                            case "isDirtied":
                            case "checkValid":
                            case "checkRequired":
                            case "getFormValues":
                            case "formSubmit":
                            case "formReset":
                            case "formClear":
                            case "updateFormValues":
                                // mark it first
                                ns.tb_consub.setTag('fireitem');

                                if (tagVar.method != "setValue"
                                    && tagVar.method != "fireItemClickEvent"
                                    && tagVar.method != "editItem"
                                    && tagVar.method != "checkValid"
                                    && tagVar.method != "isDirtied"
                                    && tagVar.method != "checkRequired"
                                    && tagVar.method != "getFormValues"
                                    && tagVar.method != "formSubmit"
                                    && tagVar.method != "formReset"
                                    && tagVar.method != "formClear"
                                    && tagVar.method != "updateFormValues"
                                ) {
                                    ns.tb_con.setSelMode('multibycheckbox');
                                }
                                ns.toggle_value.setDisplay('none');

                                var org = item["0"].properties[tagVar.method == "removeRows" || tagVar.method == "setActiveRow" ? "rows" : tagVar.method == "removeCols" ? "header" : "items"],
                                    items = [];
                                if (org && ood.isArr(org)) {
                                    items = ood.clone(org, true);
                                    items.push({
                                        id: "[key]",
                                        caption: "$(RAD.action.Other sub$-item (Empty means current$))"
                                    });
                                } else {
                                    ns.ctl_blockcon.setDisplay("none");
                                    ns.ctl_tocon.setDisplay("none");
                                }
                                ns.tb_con.setItems(items, true);
                                break;
                            case "setToggle":
                            case "toggleNode":
                            case "toggleRow":
                                // mark it first
                                ns.tb_consub.setTag('toggle');

                                ns.toggle_value.setDisplay('');
                                ns.toggle_value.setTag(item.hassub);
                                // setToggle/toggleRow/toggleNode has different args
                                if (item.hassub) {
                                    var items = ood.clone(item["0"].properties.items || item["0"].properties.rows, function (v, i) {
                                        if (v && v.group) delete v.group;
                                        return (i == "sub" && typeof(v[0]) == "object") || (typeof(v) == "object" ? !!v.sub : (i + "").charAt(0) != "_");
                                    });
                                    items.push({
                                        id: "[key]",
                                        caption: "$(RAD.action.Other sub$-item (Empty means current$))"
                                    });
                                    ns.tb_con.setItems(items);
                                    ns.tb_consub.setDisplay('');
                                } else {
                                    ns.tb_con.setItems([]);
                                    ns.tb_consub.setDisplay('none');
                                }
                                break;
                            case "show":
                                var id = ood.get(tagVar, ["args", 0]);

                                // mark it first
                                ns.tb_consub.setTag('con');

                                ns.toggle_value.setDisplay('none');
                                // keep _iscon
                                ns.tb_con.setItems(ood.clone(ns._panelitems));

                                var ii = ns.tb_con.getItems();
                                for (var i = 0, l = ii.length; i < l; i++) {
                                    if (ii[i].id != "none" && (
                                        // currentpage no container
                                        ((ood.getClassName(SPA.currentPage) == tagVar["target"]) || ii[i]["parent:" + tagVar["target"]])
                                    )
                                    ) {
                                        ns.tb_con.showItems(ii[i].id, false);
                                    } else
                                        ns.tb_con.showItems(ii[i].id);
                                }
                                break;
                        }
                        // set value to UI
                        switch (tagVar.method) {
                            case "setValue":
                            case "fireItemClickEvent":
                            case "editItem":
                                var id = ood.get(tagVar, ["args", 0]) || "";
                                if (ns.tb_con.getItemByItemId(id)) {
                                    ns.tb_consub.setReadonly(true, true);
                                    ns.tb_con.setValue(id);
                                } else {
                                    ns.tb_con.setValue("[key]");
                                    ns.tb_consub.setReadonly(false, true);
                                }
                                ns.tb_consub.setUIValue(id == '[key]' ? '' : id, true);
                                break;
                            case "showItems":
                            case "hideItems":
                            case "removeItems":
                            case "setActiveRow":
                            case "removeRows":
                            case "removeCols ":
                            case "dumpContainer":
                                var id = ood.get(tagVar, ["args", 0]) || "";
                                var arr = (id + "").split(";"), other;
                                for (var i = 0, l = arr.length; i < l; i++) {
                                    if (!ns.tb_con.getItemByItemId(arr[i])) {
                                        other = true;
                                        break;
                                    }
                                }
                                if (other) {
                                    ns.tb_con.setValue("[key]", true);
                                    ns.tb_consub.setReadonly(false, true);
                                } else {
                                    ns.tb_con.setValue(id, true);
                                    ns.tb_consub.setReadonly(true, true);
                                }
                                ns.tb_consub.setValue(id, true);
                                break;
                            case "setToggle":
                            case "toggleNode":
                            case "toggleRow":
                                if (!item.hassub) {
                                    ns.toggle_value.setUIValue(ood.get(tagVar, ["args", 0]) ? "expand" : "folding", true);
                                    ns.tb_con.setValue("", true);
                                    ns.tb_consub.setValue("", true);
                                } else {
                                    ns.toggle_value.setUIValue(ood.get(tagVar, ["args", 1]) ? "expand" : "folding", true);
                                    var id = ood.get(tagVar, ["args", 0]) || "";
                                    if (!ns.tb_con.getItemByItemId(id)) {
                                        ns.tb_con.setValue("[key]", true);
                                        ns.tb_consub.setReadonly(false, true);
                                    } else {
                                        ns.tb_con.setValue(id, true);
                                        ns.tb_consub.setReadonly(true, true);
                                    }
                                    ns.tb_consub.setValue(id, true);
                                }
                                break;
                            case "show":
                                var id = ood.get(tagVar, ["args", 0]) || "";
                                var subid = ood.get(tagVar, ["args", 1]) || "";
                                if (subid) {
                                    var t = id.replace('}', "." + subid + '}');
                                    if (ns.tb_con.getItemByItemId(t)) {
                                        ns.tb_con.setValue(t, true);
                                        ns.tb_consub.setReadonly(true, true);
                                    } else {
                                        ns.tb_con.setValue(id.replace('}', ".[key]}"), true);
                                        ns.tb_consub.setReadonly(false, true);
                                    }
                                    ns.tb_consub.setValue(subid, true);
                                } else {
                                    ns.tb_con.setValue(id, true);
                                    ns.tb_consub.setValue("", true);
                                }
                                break;
                        }
                        break;
                    case "json":
                        if (!tagVar["args"]) tagVar["args"] = [];
                        if (!ood.isHash(tagVar["args"][0])) tagVar["args"][0] = {};
                        ns._jsoneditor.render();
                        ns._jsoneditor.setValue(tagVar["args"][0]);
                        break;
                    case "prop":
                        var alias = tagVar.target,
                            target = parent.getByAlias(alias, true);

                        if (!tagVar["args"]) tagVar["args"] = [];
                        if (!ood.isHash(tagVar["args"][0])) tagVar["args"][0] = {};
                        if (!ood.isHash(tagVar["args"][1])) tagVar["args"][1] = {};

                        var targetshadow = target.boxing().clone().get(0),
                            targetshadow2 = {properties: {}};

                        ns._hiddenDiv.html("");
                        if (targetshadow.box['ood.UI'])
                            ns._hiddenDiv.append(targetshadow);
                        var param = tagVar["args"][0],
                            param1 = tagVar["args"][1],
                            grid = ns.profileGrid,
                            arr = [];

                        for (var i in param) {
                            if (i == 'CC') {
                                targetshadow.CC = ood.clone(param.CC);
                                if (ood.arr.indexOf(arr, 'CS') == -1) arr.push('CS');
                            } else if (i == 'CS') {
                                targetshadow.CS = ood.clone(param.CS);
                                if (ood.arr.indexOf(arr, 'CS') == -1) arr.push('CS');
                            } else {
                                targetshadow.properties[i] = typeof(param[i]) == "object" ? ood.clone(param[i]) : param[i];
                                if (ood.arr.indexOf(arr, i) == -1) arr.push("properties:" + i);
                            }
                        }
                        for (var i in param1) {
                            if (i == 'CC') {
                                targetshadow2.CC = ood.clone(param.CC);
                                if (ood.arr.indexOf(arr, 'CS') == -1) arr.push('CS');
                            } else if (i == 'CS') {
                                targetshadow2.CS = ood.clone(param.CS);
                                if (ood.arr.indexOf(arr, 'CS') == -1) arr.push('CS');
                            } else {
                                targetshadow2.properties[i] = typeof(param[i]) == "object" ? ood.clone(param[i]) : param[i];
                                if (ood.arr.indexOf(arr, i) == -1) arr.push("properties:" + i);
                            }
                        }

                        ns._targetshadow = targetshadow;
                        ns._targetshadow2 = targetshadow2;
                        grid.get(0).$widget = targetshadow.boxing();
                        var rows = parent._buildPropRows(targetshadow, null, null, true, grid), cellv;
                        // set row manually
                        ood.arr.each(rows, function (row) {
                            row.initFold = false;
                            ood.arr.each(row.sub, function (r) {
                                r.rulerWidth = '.5em';
                                r.cells[1]._ov = r.cells[1].value;

                                // for value var column
                                r.cells[2] = {value: ""};
                                if (param1 && (cellv = param1[r.id.replace("properties:", "")])) {
                                    r.cells[2].value = cellv;
                                    if (/^\s*\{([\S]+)\}\s*$/.test(cellv)) {
                                        r.cells[2]._$caption = '$' + cellv;
                                    }
                                }
                            });
                        });
                        grid.setRows(rows);
                        //ns.propFilter.setValue("",true);
                        grid.setValue(arr);
                        this._propFilter_();
                        break;
                    case "data":
                        ns.data_source.setUIValue((ood.get(tagVar, ["args", 0]) || ""));
                        break;
                    case "switch":
                        var v = ood.get(tagVar, ["args", 0]);
                        ns.ctl_cache.setUIValue(v !== false, true);
                        break;
                    case "var":
                        ns.ctl_varto.setUIValue(ood.get(tagVar, ["args", 0]) || "");

                        var value = ood.get(tagVar, ["args", 1]) || "",
                            vpath = ood.get(tagVar, ["args", 2]) || "";

                        ns.iniPureValue(ns.ctl_varfrom, value);

                        ns.ctl_varfrompath.setValue(vpath, true).setTagVar(vpath || null);

                        ns.ctl_adjust.setUIValue(ood.get(tagVar, ["adjust"]) || "");

                        var s = "${" + tagVar.method + "." + (ood.get(tagVar, ["args", 0]) || "?") + "} = ";
                        ns.conf_var_left.setHtml(s);
                        break;
                    case "setcb":
                        ns.cb_setid.setUIValue(ood.get(tagVar, ["args", 0]) || "");
                        ns.cb_setvalue.setUIValue(ood.get(tagVar, ["args", 1]) || "");
                        break;
                    case "callcb":
                        if (item.redirection && item._tpl) {
                            var alias = tagVar.target;
                            if (alias.indexOf(".") > -1) {
                                alias = alias.split(".")[alias.split(".").length - 1]
                            }
                            var value = item._tpl.replace('*', alias);
                            // tagVar.itaget = alias;
                            //  var value=value.replace(item.className+".","");
                            //   var value = item._tpl.replace('*', tagVar.target);

                            // if (item.className) {
                            //     value = value.replace("page." + item.className, item.className + ".getInstance()");
                            // }

                            ns.cb_callid.setUIValue(value, true);
                            ns.cb_callid.setDisabled(true);
                            tagVar.redirection = item.redirection;
                        } else {
                            ns.cb_callid.setDisabled(false);
                            ns.cb_callid.setUIValue(ood.get(tagVar, ["args", 0]) || "", true);

                            if (item.redirection) tagVar.redirection = item.redirection;
                            else delete tagVar.redirection;
                        }
                        var w = ood.get(tagVar, ["args", 1]) || "none", itms = ns.cb_callreturnto.getItems();
                        if (ood.arr.subIndexOf(itms, 'id', w) == -1) w = 'none';
                        ns.cb_callreturnto.setUIValue(w);
                        ns.cb_callreturn.setUIValue(ood.get(tagVar, ["args", 2]) || "");

                        var tt = tagVar.args;
                        ns.conf_return_exp.setHtml(tt[1] && tt[1] != 'none' ? '${' + (tt[1] + '.') + (tt[2] ? tt[2] : '?') + '}' : '');

                        var l = ns.grid_params.getRows().length;
                        if (!l) l = 10;
                        for (var i = 0; i < l; i++) {
                            ns.grid_params.updateCellByRowCol("" + (i + 3), "value", {
                                value: tagVar.args[i + 3]
                            }, false, false);
                        }
                        ns.grid_params.offEditor(true);
                        break;
                    default:
                        if (item.initUI) item.initUI(ns, tagVar);
                        break;
                }
            }
        },
        _toolbar_onclick: function (profile, tool, grp, e, src) {
            var ns = this,
                tb = ns.tb_actions,
                items = tb.getItems(),
                cur = tb.getUIValue(),
                item = tb.getItemByItemId(cur);
            switch (tool.id) {
                case "add":
                    var i = items.length + 1,
                        name = ood.adjustRes("$RAD.action.Action");
                    while (ood.arr.subIndexOf(items, "caption", name + " " + i) !== -1) i++;
                    var nitem = ns.addAction(name + " " + i);
                    tb.editItem(nitem.id);
                    break;
                case "edit":
                    if (cur) tb.editItem(cur);
                    break;
                case "remove":
                    var v = tb.getUIValue();
                    if (!v) return;
                    ood.confirm("$RAD.Remove", ood.adjustRes("$(RAD.Are You Sure to remove this row)?"), function () {
                        tb.removeItems(v);
                        var items = tb.getItems();
                        if (items && items.length)
                            tb.setUIValue(items[0].id);
                        else
                            ns._initctrls();
                        ns.markDirty(1);
                    });
                    break;
                case "clear":
                    ood.confirm("$RAD.Remove", ood.adjustRes("$(RAD.Are You Sure to remove all)?"), function () {
                        ns._initctrls(true);
                        ns.markDirty(1);
                    });
                    break;
                default:
            }
        },
        _tb_beforeapply: function (profile, item, nv, editor) {
            var items = profile.properties.items,
                index = ood.arr.subIndexOf(items, 'caption', nv);
            if (index != -1 && items[index] != item) {
                ood.alert(ood.adjustRes("$RAD.Message"), ood.adjustRes("$(RAD.action.This Action Name exists alerady)"), function () {
                    editor.activate();
                });
                return false;
            }
            if (!ood.str.trim(nv)) {
                ood.alert(ood.adjustRes("$RAD.Message"), ood.adjustRes("$(RAD.action.Specify Action Description please)"), function () {
                    editor.activate();
                });
                return false;
            }
            item.tagVar.desc = nv;
            this.markDirty(1);
        },
        addAction: function (desc) {
            var ns = this,
                items = ns.tb_actions.getItems();
            if (ood.arr.subIndexOf(items, 'caption', desc) != -1) {
                ood.alert(ood.adjustRes("$(RAD.action.This Action Name exists alerady)"));
                return false;
            }
            if (!ood.str.trim(desc)) {
                ood.alert(ood.adjustRes("$RAD.Message"), ood.adjustRes("$(RAD.action.Specify Action Description please)"));
                return false;
            }
            var hash = {
                desc: desc,
                type: "none",
                target: "none",
                args: []
            };
            var id = ood.stamp() + "",
                item = {
                    id: id,
                    caption: desc,
                    imageClass: "ri-settings-line",
                    tagVar: hash
                };
            ns.tb_actions.insertItems([item]);

            ns._enablectrls();
            ns.markDirty(1);
            ns.tb_actions.setUIValue(id, true);
            return item;
        },

        _url_address_onchange: function (profile, oldValue, newValue) {
            var ns = this;
            ns._tagVar["args"][0] = newValue;
            ns.markDirty(1);
        },
        _msg_title_onchange: function (profile, oldValue, newValue) {
            var ns = this;
            ns._tagVar["args"][0] = newValue;
            ns.markDirty(1);
        },
        _msg_message_onchange: function (profile, oldValue, newValue) {
            var ns = this;
            ns._tagVar["args"][1] = newValue;
            ns.markDirty(1);
        },
        _msg_input_onchange: function (profile, oldValue, newValue) {
            var ns = this;
            ns._tagVar["args"][2] = newValue;
            ns.markDirty(1);
        },
        _msg_cap_onchange: function (profile, oldValue, newValue) {
            var ns = this;
            ns._tagVar["args"][1] = newValue;
            ns.markDirty(1);
        },
        _msg_body_onchange: function (profile, oldValue, newValue) {
            var ns = this;
            ns._tagVar["args"][0] = newValue;
            ns.markDirty(1);
        },
        _msg_duration_onchange: function (profile, oldValue, newValue) {
            var ns = this;
            ns._tagVar["args"][3] = newValue;
            ns.markDirty(1);
        },
        _msg_width_onchange: function (profile, oldValue, newValue) {
            var ns = this;
            ns._tagVar["args"][2] = newValue;
            ns.markDirty(1);
        },
        _ds_onchange: function (profile, oldValue, newValue) {
            var ns = this;
            ns._tagVar["args"][0] = newValue || "";
            ns.markDirty(1);
        },
        _ctl_cache_onchange: function (profile, oldValue, newValue) {
            var ns = this;
            ns._tagVar["args"][0] = !!newValue;
            ns.markDirty(1);
        },
        _ctl_symbol_onchange: function (profile, oldValue, newValue, force, tag) {
            if (oldValue == newValue) return;
            var ns = this, tagVar = ns._tagVar, tag = profile.properties.tag;
            if (tagVar) {
                if (!tagVar.conditions) tagVar.conditions = [];
                if (!tagVar.conditions[tag - 1])
                    tagVar.conditions[tag - 1] = {
                        left: "",
                        symbol: "defined",
                        right: ""
                    };
                var con = tagVar.conditions[tag - 1];
                con.symbol = newValue;
                ns.markDirty(1);
                if (newValue == "defined" || newValue == "undefined" || newValue == "empty" || newValue == "non-empty") {
                    ns['i_conr' + tag].setUIValue("", true);
                    ns['i_conr' + tag].setDisabled(true, true);
                } else {
                    ns['i_conr' + tag].setDisabled(false, true);
                }
            }
        },
        _grid_params_onbe: function (profile, cell, editor) {
            editor.setTag('purevar');
            this.iniPureValue(editor, cell.value);
            this._enhanceInputs(editor.reBoxing('ood.UI.Input'));
        },
        _grid_params_aftercellupdated: function (profile, cell, options, isHotRow) {
            var ns = this, tagVar = ns._tagVar;
            if (tagVar)
                tagVar.args = tagVar.args || [];
            if ("value" in cell) {
                // from 3
                tagVar.args[parseInt(cell._row.id, 10)] = cell.tagVar || cell.value;
                ns.markDirty(1);
            }
        },
        _cb_asy_onchange: function (profile, oldValue, newValue) {
            var ns = this, tagVar = ns._tagVar;
            ns.spin_asy.setDisabled(!newValue);
            if (tagVar) {
                if (newValue) {
                    tagVar.timeout = ns.spin_asy.getUIValue();
                } else {
                    ns.spin_asy.setUIValue(0, true);
                    delete tagVar.timeout;
                }
                ns.markDirty(1);
            }
        },
        _spin_asy_onchange: function (profile, oldValue, newValue) {
            var ns = this, tagVar = ns._tagVar;
            if (tagVar) {
                tagVar.timeout = newValue || 0;
                ns.markDirty(1);
            }
        },
        _jsoneditorchanged: function (module) {
            var ns = this,
                tagVar = ns._tagVar;
            if (tagVar) {
                tagVar.args[0] = module.getValue(true);
                ns.markDirty(1);
            }
        },
        _jsoneditorchanged2: function (module) {
            var ns = this,
                tagVar = ns._tagVar;
            if (tagVar) {
                tagVar.args[1] = module.getValue(true);
                ns.markDirty(1);
            }
        },
        _false_change: function (profile, oldValue, newValue) {
            var ns = this, tagVar = ns._tagVar;
            if (tagVar) {
                if (newValue)
                    tagVar["return"] = false;
                else if (tagVar["return"] === false)
                    delete tagVar["return"];
                ns.markDirty(1);
            }
        },
        $tg_tips: function () {
            var ns = this,
                prop = ns.properties,
                parent = prop.parent;
            return parent.$tg_tips.apply(parent, arguments);
        },
        markProperty: function (key, value, value2, setParam) {
            var ns = this,
                grid = ns.profileGrid,
                //CC and CSS are not prop, they are special in the editor
                // ** only CS here, CC will be included in CS
                rowid = key == "CS" ? "CS" : key == "CC" ? "CS" : ("properties:" + key),
                tagVar = ns._tagVar,
                args = tagVar.args || [],
                param, param1;
            if (!ood.isHash(args[0])) args[0] = {};
            if (!ood.isHash(args[1])) args[1] = {};
            param = args[0];
            param1 = args[1];

            if (ood.isSet(value2)) {
                if (rowid == "CS") {
                    ns._targetshadow2[key] = value2;
                } else {
                    ns._targetshadow2.properties[key] = value2;
                }
            } else if (ood.isSet(value)) {
                if (rowid == "CS") {
                    ns._targetshadow[key] = value;
                    delete ns._targetshadow2[key];
                } else {
                    ns._targetshadow.properties[key] = value;
                    delete ns._targetshadow2.properties[key];
                }
            }

            if (setParam) {
                delete param[key];
                delete param1[key];
                if (ood.isSet(value2))
                    param1[key] = value2;
                else if (ood.isSet(value))
                    param[key] = ood.clone(value, true);

                ns.markDirty(1);
            }
        },
        $profilegrid__rowsel: function (profile, row, e, src, type) {
            var ns = this,
                rowid = row.id,
                sh = ns._targetshadow,
                sh2 = ns._targetshadow2;

            if (rowid == "CS") {
                ns.markProperty("CC", type == -1 ? null : sh.CC, type == -1 ? null : sh2.CC, true);
                ns.markProperty("CS", type == -1 ? null : sh.CS, type == -1 ? null : sh2.CS, true);
            } else {
                var key = rowid.replace("properties:", "");
                ns.markProperty(key, type == -1 ? null : sh.properties[key], type == -1 ? null : sh2.properties[key], true);
            }
        },
        _propFilter_oncmd: function () {
            var w = this.propFilter;
            if (w.getUnit() != 'Show All') {
                w.setUnit("Show All");
            } else {
                w.resetValue("");
            }
            this._propFilter_();
        },
        '_propFilter_unit': function (profile, unit) {
            var w = this.propFilter;
            if (unit == 'Show All') {
                w.setInputReadonly(false);
            } else {
                w.resetValue("").setInputReadonly(true);
            }
            this._propFilter_();
        },
        _propFilter_onchange: function (profile, oldValue, newValue) {
            ood.resetRun('_propFilter_2', this._propFilter_, 500, [], this);
        },
        _propFilter_: function (newValue) {
            var page = this,
                newValue = page.propFilter.getUIValue(),
                unit = page.propFilter.getUnit(),
                makeReg = function () {
                    return new RegExp("\:\\w*" + newValue || "", 'i');
                };

            this.profileGrid.doFilter(unit != "Show All" || newValue ? function (row, helper, profile) {
                var self = arguments.callee, rtn;
                if (row == 'begin') {
                    if (unit == "Show All") {
                        if (!self._$reg)
                            self._$reg = makeReg(newValue);
                    }
                }
                else if (row == 'end') {
                    if (helper != 'prepareItem') {
                    }
                }
                else {
                    if (unit != "Show All") {
                        rtn = row.group || row.sub ? false : !row._selected;
                    } else if (newValue) {
                        rtn = row.group || row.sub ? false : !self._$reg.test(row.id);
                    }

                    if (helper != 'prepareItem' && row.id && row.sub && !row._checked) {
                        profile.boxing().toggleRow(row.id, true, false, true);
                    }

                    return rtn;
                }
            } : null);
        },
        $profilegrid_beforecellvalueset: function (profile, cell, hash, h, ext) {
            var ns = this,
                row = cell._row;
            if (cell._col.id == 'value') {
                if (ext && ext._ext) {
                    ood.each(ext._ext, function (value, key) {
                        ns.markProperty(key, value, null, !!row._selected);
                    });
                } else {
                    if (!('value' in hash) && !('unit' in hash)) return;

                    var target = profile.$widget, attr, funName, property, value;

                    value = hash.value;
                    // check properties name
                    if ((attr = cell._row.id.split(':')).length > 1) {
                        type = attr[0];
                        property = attr[1];
                    } else {
                        property = cell._row.id;
                    }
                    if (property == "width" && (ood.get(target.get(0), ['parent', 'properties', 'conDockRelative']) || ood.get(target.get(0), ['parent', 'properties', 'conLayoutColumns']))) {
                        return false;
                    } else {
                        var precision = cell.unit == 'em' ? 4 : 0;
                        if (target.get(0).box.$DataModel[property].$spaceunit) {
                            if ('value' in hash) {
                                hash.value = String(
                                    (value == 'auto') ? value :
                                        (parseFloat(value) === 0 ? 0 + (hash.unit || cell.unit || "") :
                                                parseFloat(value) ? parseFloat(value) : 'auto'
                                        )
                                );
                            }
                            hash.precision = precision;
                            //if the value changed in the process
                            if (value !== hash.value || hash.unit !== cell.unit || hash.precision !== precision) {
                                profile.boxing().updateCell(cell, hash);
                            }
                            value = hash.value == 'auto' ? 'auto' : cell.value + cell.unit;
                        }
                    }
                    var key = row.id.replace("properties:", "");
                    ns.markProperty(key, value, null, !!row._selected);
                }
            } else if (cell._col.id == 'value2') {
                if (!('value' in hash) && !('unit' in hash)) return;

                var target = profile.$widget, attr, funName, property, value;

                value = hash.value;
                // check properties name
                if ((attr = cell._row.id.split(':')).length > 1) {
                    type = attr[0];
                    property = attr[1];
                } else {
                    property = cell._row.id;
                }
                if (property == "width" && (ood.get(target.get(0), ['parent', 'properties', 'conDockRelative']) || ood.get(target.get(0), ['parent', 'properties', 'conLayoutColumns']))) {
                    return false;
                }

                if (/^\s*\{([\S]+)\}\s*$/.test(value)) {
                    hash._$caption = '$' + value;
                }

                var key = row.id.replace("properties:", "");
                // if has value, set it
                ns.markProperty(key, null, value || null, !!value);
            }
        },
        $tg_cellupd: function (profile, cell) {
            var ns = this, grid = profile.boxing(), arr;
            if (!cell._row._selected) {
                arr = grid.getUIValue(true);
                arr.push(cell._row.id);
                grid.setValue(arr);
                // add a row, trigger event
                grid.onRowSelected(profile, cell._row, null, null, 1);
            } else {
                if (cell._col.id == 'value') {
                    arr = grid.getUIValue(true);
                    if (cell.value === cell._ov) {
                        ood.arr.removeValue(arr, cell._row.id);
                    }
                    grid.setValue(arr);
                    // remove a row, trigger event
                    grid.onRowSelected(profile, cell._row, null, null, 0);
                } else if (cell._col.id == 'value2') {
                    arr = grid.getUIValue(true);
                    if (!cell.value) {
                        ood.arr.removeValue(arr, cell._row.id);
                    }
                    grid.setValue(arr);
                    // remove a row, trigger event
                    grid.onRowSelected(profile, cell._row, null, null, 0);
                }
            }
            // set the counterpart to original value
            if (cell._col.id == 'value') {
                grid.updateCell(cell._row.cells[2], {value: ""}, false, false);
            } else if (cell._col.id == 'value2') {
                grid.updateCell(cell._row.cells[1], {value: cell._row.cells[1]._ov}, false, false);
            }
        },
        $tg_beginedit: function (profile, cell, editor, type) {
            if (cell._col.id == 'value2') {
                this._enhanceInputs(editor.reBoxing('ood.UI.Input'));
            }
        },
        $tg_dblclick: function () {
            var ns = this,
                prop = ns.properties,
                parent = prop.parent;
            parent.$tg_dblclick.apply(ns, arguments);
        },
        _animate_buis: function (prf, ov, nv) {
            if (nv == "[customize]") {
                //****** todo
                return false;
            }
        },
        _animate_beforecombopop: function (profile, pos, e, src) {
            if (profile.properties.items.length) return;

            var ns = this, ins = profile.boxing();
            var items = [];
            ood.each(ood.Dom.$preDefinedAnims, function (v, i) {
                items.push(i);
            });
            /*
           /***** todo
           items.push({type:'split'});
           items.push({
               id:"[customize]",
               caption:"$(RAD.action.[customize])"
           });
           */
            ins.setItems(items);
        },
        _data_source_beforecombopop: function (profile, pos, e, src) {
            var ns = this, ins = profile.boxing();
            ood.Dom.busy();
            // avoid syn call
            ood.asyRun(function () {

                ood.Ajax(CONF.openFolderService, {
                        path: SPA.curProjectPath + "/data",
                        hashCode: ood.id(),
                        curProjectPath: SPA.curProjectPath
                    }
                    , function (txt) {
                        var obj = txt;
                        if (obj && !obj.error) {
                            var items = [];
                            obj.data.files = ood.arr.stableSort(obj.data.files, function (x, y) {
                                return x.layer > y.layer ? -1 : x.layer < y.layer ? 1 : x.location > y.location ? 1 : -1;
                            });
                            ood.arr.each(obj.data.files, function (o) {
                                if (o.type === 1 && /.+\.(js|json|txt)$/.test(o.location)) {
                                    o = o.location.replace(SPA.curProjectPath + "/", "");
                                    items.push({
                                        id: '[data]' + o,
                                        caption: o
                                    });
                                }
                            });
                            ins.setItems(items);
                            ins.expand();
                        }
                        // dont show message
                        ood.Dom.free();
                    }, function (obj) {
                        // dont show message
                        //ood.message(ood.get(obj,['error','message'])||obj||'no response!');
                        ood.Dom.free();
                    });
            });
        },
        _btncancel_onclick: function (profile, e, src, value) {
            var ns = this;
            ns.markDirty(0);
            ns.tab_conf.setValue('none', true);
            ns.dialog.close();
        },
        _btnonok_onclick: function (profile, e, src, value) {
            var ns = this,
                prop = ns.properties,
                items = ns.tb_actions.getItems(),
                evs = [],
                tmp = [];
            ns._tagVar = null;
            if (ns._dirty) {
                // collect string/function first
                if (prop.actionConf) {
                    if (ood.isFun(prop.actionConf) || ood.isStr(prop.actionConf)) {
                        tmp.push(prop.actionConf);
                    } else {
                        var arr = ood.isArr(prop.actionConf) ? prop.actionConf : prop.actionConf.actions;
                        ood.arr.each(arr, function (o, i) {
                            if (ood.isStr(o) || ood.isFun(o)) {
                                tmp.push(o);
                            }
                        });
                    }
                }
                if (items.length) {
                    ood.arr.each(items, function (o) {
                        if (o.tagVar && !o.tagVar._ignore &&
                            (("return" in o.tagVar) || (o.tagVar.target != "none" && o.tagVar.method != "none"))
                        ) {
                            var t = o.tagVar;
                            if (t.type == "other" && t.target == "var" && (!t.args || !t.args[0])) return;
                            if (t.type == "control" && t.method == "setProperties" && (!t.args || (!t.args[0] && !t.args[1]) || (ood.isEmpty(t.args[0]) && ood.isEmpty(t.args[1])))) return;

                            // save expression first
                            if (t.type == "control" && t.method == "setProperties") {
                                ood.filter(t.args[0], function (i) {
                                    return !t.args[1][i];
                                });
                            }

                            var cons = t.conditions;
                            t.conditions = [];
                            ood.arr.each(cons, function (v) {
                                if (!v) return;
                                if (v.symbol == "defined" || v.symbol == "undefined"
                                    || v.symbol == "exists" || v.symbol == "non-exists"
                                    || v.symbol == "empty" || v.symbol == "non-empty") {
                                    if (v.left) {
                                        t.conditions.push(v);
                                    }
                                } else {
                                    if (v.left && v.right) {
                                        t.conditions.push(v);
                                    }
                                }
                            });
                            if (!t.conditions.length) delete t.conditions;
                            t.desc = o.caption;

                            if (t.target.indexOf(".") == -1) {
                                if (t.redirection && ood.str.startWith('otherModuleCall', t.redirection)) {
                                    delete t.redirection;
                                }
                                delete t.className;
                                if (t.type == 'page' || t.type == 'otherModuleCall') {
                                    t.type = 'control';
                                }

                            } else if (t.className && t.className != SPA.getCurrentClassName()) {
                                var tagter = t.target;

                                if (tagter != t.className) {
                                    var itagter = tagter.split(".")[tagter.split(".").length - 1]
                                    tagter = t.className + "##" + itagter;
                                    t.redirection = "otherModuleCall:" + tagter + ":" + t.method;
                                    t.type = "otherModuleCall"
                                } else {
                                    t.type = 'page';
                                }

                            } else if (t && ood.str.startWith("otherModuleCall:")) {
                                delete t.redirection;
                            }
                            evs.push(t);
                        }
                    });
                }

                var eventPos = -1;
                if (prop.argsvar && evs.length) {
                    eventPos = ood.arr.indexOf(prop.argsvar, "e");
                    if (-1 != eventPos) evs[0].event = eventPos;
                    else delete evs[0].event;
                }
                ood.arr.insertAny(evs, tmp, -1);

                var evsConf = {}, t = ns.ood_returns.getUIValue();
                if (t) evsConf['return'] = t;
                if (evs.length) {
                    if (t) evsConf.actions = evs;
                    else evsConf = evs;
                }

                ns.fireEvent('onDirty', [prop.target, prop._eventkey, ood.isEmpty(evsConf) ? null : evsConf]);
            }
            ns.markDirty(0);
            ns._targetshadow = null;

            ns.tab_conf.setValue('none', true);
            ns.dialog.close();
        },
        _tv_var_onclick: function (profile, item) {
            if (profile.boxing().getUIValue() == item.id) {
                this._tv_var_onchange(profile, '', item.id, false, 'click');
            }
        },
        _tv_var_onchange: function (profile, oldValue, newValue, a, from) {
            if (!newValue || oldValue == newValue) return;
            var ns = this, uictrl = profile.boxing(),
                target = uictrl.getTag(),
                item = profile.getItemByItemId(newValue);

            if (item.realValue) newValue = item.realValue;

            if (target && (target = target.boxing())) {
                var vtype = newValue;
                if (vtype == "hash" || vtype == "array" || vtype == "function") {
                    var label = "#" + ood.adjustRes(item.caption) + "#",
                        imageClass = vtype == "function" ? 'ri-function-line' : vtype == "array" ? 'ri-braces-line' : ' ',
                        inicode = vtype == "function" ? 'function(){\n//code here\n}' : vtype == "array" ? '[\n//\n]' : '{\n//\n}';

                    ns._editMixData(target, vtype, inicode, label, imageClass);

                    ood().setBlurTrigger("-action-float-inoodb", true);
                    return;
                }

                target.setUIValue(newValue);

                if (from == "click") {
                    ood.asyRun(function () {
                        var ip = target.getSubNode("INPUT"), pos, pos1 = 0, pos2 = 0;
                        if (newValue == "{}") pos1 = pos2 = 1;
                        else if (/\(\'[^']*\'\)/.test(newValue)) {
                            pos1 = newValue.indexOf("\'") + 1;
                            pos2 = newValue.lastIndexOf("\'");
                        } else if (/\(\"[^"]*\"\)/.test(newValue)) {
                            pos1 = newValue.indexOf("\"") + 1;
                            pos2 = newValue.lastIndexOf("\"");
                        } else {
                            pos = newValue.lastIndexOf("}");
                            if (pos != -1) pos1 = pos2 = pos;
                        }
                        // stop the default focus event handler
                        target.get(0).$ignoreFocus = 1;
                        ip.caret(pos1, pos2);
                        delete target.get(0).$ignoreFocus;
                    });
                }
            }
        },
        _getFunCap: function (str) {
            var arr = [];
            if (ood.isHash(str)) {
                doc = str;
            } else {
                doc = RAD.EditorTool.getDoc(str, false, true);
            }
            if (doc) {
                if (doc.$paras && doc.$paras.length) {
                    ood.arr.each(doc.$paras, function (o) {
                        if (o = /([\w]+)[^:]+:\s*([\w/.]+[\w])/.exec(o)) {
                            arr.push(o[1] + '<span style="color:#888">/*' + o[2] + '*/</span>');
                        } else {
                            arr.push("?")
                        }
                    });
                }
                return "(" + arr.join(', ') + " ) " + (doc.$desc ? (": " + doc.$desc) : "");
            } else {
                return "( )";
            }
        },
        _tiggerNavTreeCur: function () {
        },
        _autoNavTree: function (type, value, noui) {
            var ns = this,
                tv = type == "callback" || type == "adjustdata" ? ns.tv_fun : ns.tv_var,
                item, info = [];
            var adjustId = function (str) {
                var arr = (str || "").split("(");
                if (arr.length == 2) {
                    return arr[0] + "()}";
                }
                return str;
            };
            delete ns._potentialStep;

            value = ood.str.trim(value || "");
            if (value.charAt(0) == "{") {
                //var arr=value.replace(".n0.properties","\x01").replace(/[{}]/g,"").split("."),step,t="";
                var arr = value.replace(/[{}]/g, "").split("."), step, step2, t = "";
                for (var i = 0, l = arr.length; i < l; i++) {
                    //if(!arr[i])continue;
                    t += (t ? "." : "") + arr[i];//.replace("\x01",".n0.properties");
                    step = "{" + t + "}";
                    if (noui) {
                        var items = tv.getItems();
                        if (!items || !items[0]) {
                            if (type == "callback" || type == "adjustdata")
                                ns._buildVarTree2(type == "adjustdata");
                            else
                                ns._buildVarTree(ns.tv_var.get(0));
                        }
                        var rs = tv.get(0).queryItems(items, function (v, k) {
                            return v.id == step;
                        }, 1, 1), item;
                        if (rs && rs[0]) {
                            item = rs[0];
                            if (item.sub === true) {
                                if (type == "callback" || type == "adjustdata") {
                                    ns._tv_fun_ongetcontent(tv.get(0), item, function (r) {
                                        item.sub = r;
                                    });
                                } else {
                                    items.sub = ns._tv_var_ongetcontent(tv.get(0), item, function (r) {
                                        item.sub = r;
                                    });
                                }
                            }
                            if (item.id != "[key]")
                                info.push(ood.adjustRes(item.caption));
                        } else {
                            info.push(arr[i]);
                        }
                    } else {
                        if (item = tv.getItemByItemId(step)) {
                            // for native var
                            if (item.pid) {
                                var pi = tv.getItemByItemId(item.pid);
                                if (!item._checked) {
                                    tv.toggleNode(item.pid, true, false);
                                }
                            }

                            if (item.sub && !item._checked) {
                                tv.toggleNode(step, true, false);
                                if (i == l - 1 && !item.group) {
                                    if (adjustId(tv.getUIValue()) !== adjustId(step)) {
                                        tv.setValue(adjustId(ns._potentialStep = step), true);
                                    }
                                }
                            } else {
                                if (adjustId(tv.getUIValue()) !== adjustId(step)) {
                                    tv.setValue(adjustId(ns._potentialStep = step), true);
                                }
                            }
                            if (item.id != "[key]")
                                info.push(ood.adjustRes(item.caption));
                        } else {
                            info.push(arr[i]);
                            var ok, item;
                            step2 = step.replace(/\.([^.]+)\}$/, "}");
                            step = step.replace(/\}$/, "");

                            if (item = tv.getItemByItemId(step2)) {
                                if (item.sub) {
                                    ood.arr.each(item.sub, function (o) {
                                        if (ood.str.startWith(adjustId(o.id), adjustId(step))) {
                                            if (adjustId(tv.getUIValue()) !== adjustId(o.id)) {
                                                tv.setValue(adjustId(ns._potentialStep = o.id), true);
                                            }
                                            ok = 1;
                                        }
                                    });
                                }
                            }
                            if (!ok) {
                                if (adjustId(tv.getUIValue()) !== adjustId(step)) {
                                    var id = adjustId(step2), id2;
                                    // to the input one
                                    if (tv.getItemByItemId(id2 = id.replace("}", ".}"))) {
                                        tv.setValue(ns._potentialStep = id2, true);
                                        ok = 1;
                                    }
                                    if (tv.getItemByItemId(id2 = id.replace(".}", "}"))) {
                                        tv.setValue(ns._potentialStep = id2, true);
                                        ok = 1;
                                    }
                                    if (!ok) {
                                        // to first
                                        tv.setValue(ns._potentialStep = "{}", true);
                                        ok = 1;
                                    }
                                }
                                if (!ok) {
                                    if (adjustId(tv.getUIValue()) !== adjustId(step2)) {
                                        var id = adjustId(step2);
                                        // to the right one
                                        if (tv.getItemByItemId(id)) {
                                            tv.setValue(ns._potentialStep = id, true);
                                        } else {
                                            // to first
                                            tv.setValue(ns._potentialStep = "{}", true);
                                        }
                                    }
                                }
                            }
                        }
                    }
                }
            } else {
                if (!noui) {
                    //tid="{}";
                    //if(tv.getUIValue()!==tid){
                    //    tv.setUIValue(tid, true);
                    //}
                }
            }
            return info;
        },
        _buildGlobalfuns: function () {
            var infuns = [], imgcls = 'ri-function-line';

            // SPA.curProjectConfig.$GlobalFunctions =>map to=> ood.$cache.functions
            if (ood.get(SPA, ["curProjectConfig", '$GlobalFunctions'])) {
                ood.each(SPA.curProjectConfig.$GlobalFunctions, function (o, i) {

                    if (i.charAt(0) == '$' || i.charAt(0) == '!') return;

                    var str = [];
                    ood.arr.each(o.params, function (o) {
                        str.push(o.id + (o.type ? ("<span style='color:#888'>/*" + o.type + "*/</span>") : ""));
                    });

                    infuns.push({
                        id: "{functions." + i + "}",
                        caption: i + "( " + str.join(", ") + " )" + (o.desc ? (" : " + o.desc) : ""),
                        imageClass: imgcls
                    });
                });
            }
            infuns.push({
                id: "{functions.}",
                caption: "$(RAD.action.fun.[key])",
                imageClass: imgcls
            });
            return infuns;
        },
        _buildConstantData: function (type) {
            var indata = [], imgcls = 'ri-book-open-line';

            // SPA.curProjectConfig.$ConstantData =>map to=> ood.$cache.data
            if (ood.get(SPA, ["curProjectConfig", '$ConstantData'])) {
                ood.each(SPA.curProjectConfig.$ConstantData, function (o, i) {
                    if (i.charAt(0) == '$' || i.charAt(0) == '!') return;
                    indata.push({
                        id: "{constant." + i + "}",
                        caption: i,
                        imageClass: imgcls
                    });
                });
            }
            indata.push({
                id: "{constant.}",
                caption: "$(RAD.action." + type + ".[key])",
                imageClass: imgcls
            });
            return indata;
        },
        _buildGlobalData: function (type) {
            var indata = [], imgcls = type == 'var' ? 'ri-book-open-line' : 'ri-function-line';

            // SPA.curProjectConfig.$GlobalData =>map to=> ood.$cache.data
            if (ood.get(SPA, ["curProjectConfig", '$GlobalData'])) {
                ood.each(SPA.curProjectConfig.$GlobalData, function (o, i) {
                    if (i.charAt(0) == '$' || i.charAt(0) == '!') return;
                    indata.push({
                        id: "{global." + i + "}",
                        caption: i,
                        imageClass: imgcls
                    });
                });
            }
            indata.push({
                id: "{global.}",
                caption: "$(RAD.action." + type + ".[key])",
                imageClass: imgcls
            });
            return indata;
        },
        _buildVarTree3: function (alias) {
            var ns = this,
                tv = ns.tv_fun,
                prop = ns.properties,
                controls = prop.controls,
                _ns = ns.getScope(),
                imageClassMan = 'ri-book-open-line',
                imageClassFun = 'ri-function-line',
                items = [{
                    id: "{}",
                    caption: "$(RAD.action.fun.Input Function)",
                    imageClass: imageClassMan
                }];


            ood.arr.each(['getProperties', 'triggerExcelFormulas'], function (i) {
                if (ns._ignoreFuns1[i]) return;
                if (i.charAt(0) == "_" || i.charAt(0) == "$") return;
                items.push({
                    id: "{page." + (alias ? alias + "." : "") + i + "()}",
                    caption: i + ns._getFunCap("ood.Module.prototype." + i),
                    imageClass: imageClassFun
                });
            });


            ood.arr.each(['getProperties', 'triggerExcelFormulas'], function (i) {
                if (ns._ignoreFuns1[i]) return;
                if (i.charAt(0) == "_" || i.charAt(0) == "$") return;
                items.push({
                    id: "{page." + (alias ? alias + "." : "") + i + "()}",
                    caption: i + ns._getFunCap("ood.Module.prototype." + i),
                    imageClass: imageClassFun
                });
            });
            if (alias) {
                items.push({type: 'split'});
                var getArts = function (fun, argsvar, argsdoc) {
                    var arr = (fun + "").split("("), str;
                    arr.shift();
                    str = arr.join('(');
                    str.replace(/\s*((\w)+)(\s*\/\*[^*]*\*+([^\/][^*]*\*+)*\/)?|(\s*\/\/[^\n]*)|(\)[\s\S]*)/g, function (o, a, b, c, d, e) {
                        if (o.charAt(0) != ')') {
                            e = c ? c.replace(/^\s*\/\*/, '').replace(/\s*\*\/\s*$/, '').replace(/\s*[\n\r]+\s*\*\s*/g, ' ').replace(/^\s*/, '') : '';
                            o = e.split(/[^\w\.]+/);
                            d = o[0];

                            argsvar.push({
                                ori: d || "Object",
                                type: (d || "Object") + ".prototype"
                            });
                            argsdoc.push(a + " : " + e);
                        }
                    });
                };
                var customFuns = ood.get(_ns, ['page', alias, 'Class', '$Functions']);
                if (customFuns) {
                    ood.each(customFuns, function (o, i) {
                        var argsvar = [], argsdoc = [];
                        getArts(o, argsvar, argsdoc);
                        items.push({
                            id: "{page." + alias + "." + i + "()}",
                            caption: i + ns._getFunCap({
                                $paras: argsdoc,
                                $desc: ""
                            }),
                            imageClass: imageClassFun
                        });
                    });
                }
            }
            tv.setItems(items).setUIValue("");

        },
        _buildVarTree2: function (adjustFun) {
            var ns = this,
                tv = ns.tv_fun,
                prop = ns.properties,
                controls = prop.controls,
                _ns = ns.getScope(),
                imageClassMan = 'ri-book-open-line',
                imageClassFun = 'ri-function-line',
                items = [{
                    id: "{}",
                    caption: "$(RAD.action.fun.Input Function)",
                    imageClass: imageClassMan
                }];


            var f1 = function (items) {
                ood.arr.each(items, function (o) {
                    var a = ood.copy(o);
                    a.id = "{page." + o.id + "}";
                    a.__ = o["0"].key;
                    a.group = true;
                    a.sub = true;
                    inpage.push(a);
                    if (o.sub) f1(o.sub);
                });
            }, f4 = function () {
                var itemsi = [];
                ood.arr.each(prop.args, function (o, i) {
                    if (prop.argsdoc && (o == "callback" || o == "callback" || /[\w\s]+\:\s*(Function)/.test(prop.argsdoc[i] || ""))) {
                        itemsi.push({
                            id: "{args[" + i + "]()}",
                            caption: prop.argsdoc && prop.argsdoc[i] || o,
                            imageClass: imageClassFun
                        });
                    }
                });
                if (itemsi.length) {
                    items.push({
                        id: "{args}",
                        caption: "$(RAD.action.fun.in Parameters)",
                        group: true,
                        sub: itemsi
                    });
                }
            };

            //inargs
            f4();

            var inargs = [], inpage = [], _ignore = {}, inmodule = [];
            f1(controls);


            // inpage
            ood.each(ood.Module.prototype, function (o, i) {
                if (ns._ignoreFuns1[i]) return;
                if (i.charAt(0) == "_" || i.charAt(0) == "$") return;
                if (typeof o == "function") {
                    if (!o.$oodclass$) {
                        _ignore[i] = 1;
                        inpage.push({
                            id: "{page." + i + "()}",
                            caption: i + ns._getFunCap("ood.Module.prototype." + i),
                            imageClass: imageClassFun
                        });
                    }
                }
            });
            if (ood.get(prop.parent, ["_cls", "Instance"])) {
                ood.each(prop.parent._cls.Instance, function (o, i) {
                    if (ns._ignoreFuns1[i]) return;
                    if (i.charAt(0) == "_" || i.charAt(0) == "$") return;
                    if (typeof o == "function") {
                        if (!o.$oodclass$ && !_ignore[i]) {
                            inpage.push({
                                id: "{page." + i + "()}",
                                caption: i + ns._getFunCap("ood.Module.prototype." + i),
                                imageClass: imageClassFun
                            });
                        }
                    }
                });
            }
            ood.arr.stableSort(inpage, function (x, y) {
                if (x.__) {
                    if (!y.__) return -1;
                    else return 0
                } else {
                    if (y.__) return 1;
                    else return x.id.toLowerCase() > y.id.toLowerCase() ? 1 : x.id.toLowerCase() < y.id.toLowerCase() ? -1 : 0;
                }
            });

            //inmodule
            if (ood.get(prop.parent, ["_cls", "Instance", 'functions'])) {
                ood.each(prop.parent._cls.Instance.functions, function (o, i) {
                    var str = [];
                    ood.arr.each(o.params, function (o) {
                        str.push(o.id + (o.type ? ("<span style='color:#888'>/*" + o.type + "*/</span>") : ""));
                    });

                    inmodule.push({
                        id: "{page.functions." + i + "}",
                        caption: i + "( " + str.join(", ") + " )" + (o.desc ? (" : " + o.desc) : ""),
                        imageClass: imageClassFun
                    });
                });
            }
            inmodule.push({
                id: "{functions.}",
                caption: "$(RAD.action.fun.[key])",
                imageClass: imageClassFun
            });
            Array.prototype.push.apply(items, [{
                id: "{page.functions}",
                caption: "$(RAD.action.fun.Module Function Collection)",
                group: true,
                initFold: false,
                sub: inmodule
            }, {
                id: "{functions}",
                caption: "$(RAD.action.fun.Global Function Collection)",
                group: true,
                sub: ns._buildGlobalfuns()
            }, {
                id: "{temp}",
                caption: "$(RAD.action.fun.in Temp Object)",
                group: true,
                sub: [
                    {
                        id: "{temp.}",
                        caption: "$(RAD.action.fun.[key])",
                        imageClass: imageClassMan
                    }
                ]
            }, {
                id: "{global}",
                caption: "$(RAD.action.fun.in Global Object)",
                group: true,
                sub: ns._buildGlobalData('fun')
            }]);

            if (ood.get(prop.parent, ["_cls"])) {
                items.push({
                    id: "{page}",
                    caption: "$(RAD.action.fun.in Current Page)",
                    group: true,
                    sub: inpage
                });
            }

            if (!adjustFun)
                items.push({
                    id: "{ood}",
                    caption: "$(RAD.action.fun.in ood Namespace)",
                    group: true,
                    sub: true
                });

            tv.setItems(items).setUIValue("");
        },
        _buildVarTree: function (tprf) {
            var ns = this,
                tv = ns.tv_var,
                map2 = ns.CAPMAP.action,
                alias = tprf.alias,
                mem = alias == "ctl_itemvar" && ns.add_target.getTagVar(),
                imageClassMan = 'ri-book-open-line',
                imageClassFun = 'ri-function-line',
                imageClassArr = 'ri-list-unordered',
                imageClassHash = 'ri-braces-line',
                imageClassVar = 'ri-text';

            var args = [],
                // maybe changed
                global = [], temp = [], pageprop = [], funs = [],
                pagectls = [{
                    id: "{page.getProfile()}",
                    caption: "$(RAD.designer.tool.Profile Map)",
                    tagCmds: [{buttonType: 'text', 'tagCmdsAlign': 'left', caption: '', itemClass: 'ri-question-line'}],
                    idn: "ood.Module.prototype.getProfile",
                    imageClass: imageClassHash
                }, {
                    id: "{page.getData()}",
                    caption: "$(RAD.designer.tool.Data Map)",
                    tagCmds: [{buttonType: 'text', 'tagCmdsAlign': 'left', caption: '', itemClass: 'ri-question-line'}],
                    idn: "ood.Module.prototype.getData",
                    imageClass: imageClassHash
                }, {
                    id: "{page.getValue()}",
                    caption: "$(RAD.designer.tool.Value Map)",
                    tagCmds: [{buttonType: 'text', 'tagCmdsAlign': 'left', caption: '', itemClass: 'ri-question-line'}],
                    idn: "ood.Module.prototype.getValue",
                    imageClass: imageClassHash
                }, {
                    id: "{page.properties}",
                    caption: "$(RAD.action.var.Page Properties)",
                    imageClass: imageClassHash,
                    tagCmds: [{buttonType: 'text', 'tagCmdsAlign': 'left', caption: '', itemClass: 'ri-question-line'}],
                    idn: "ood.Module.prototype.getProperties",
                    sub: pageprop
                }/*,{
                    id:"{page.functions}",
                    caption:"$(RAD.action.var.Page functions)",
                    imageClass:imageClassHash,
                    tagCmds:[{type:'text','location':'left',caption:'',itemClass:'ri-question-line'}],
                    idn:"ood.Module.prototype.getFunctions",
                    sub:funs
                }*/];

            var prop = ns.properties,
                target = prop.target,
                pp = ood.get(prop.cls, ["Instance", "properties"]) || {},
                //ff=ood.get(prop.cls,["Instance","functions"])||{},
                controls = prop.controls,
                f1 = function (items) {
                    ood.arr.each(items, function (o) {
                        var a = ood.copy(o);
                        a.id = "{page." + o.id + "}";
                        a.__ = o["0"].key;
                        a.sub = true;
                        pagectls.push(a);
                        if (o.sub) f1(o.sub);
                    });
                }, f2 = function (pp) {
                    for (var i  in pp) {
                        var t = pp[i];
                        pageprop.push({
                            id: "{page.properties." + i + "}",
                            caption: i,
                            imageClass: ood.isArr(t) ? imageClassArr : ood.isHash(t) ? imageClassHash : imageClassVar,
                            sub: (ood.isArr(t) || ood.isHash(t)) ? true : null
                        });
                    }
                    pageprop.push({
                        id: "{page.properties.}",
                        caption: "$(RAD.action.var.[key])",
                        imageClass: imageClassMan
                    });
                }, f3 = function (ff) {
                    for (var i  in ff) {
                        var str = [], o = ff[i];
                        ood.arr.each(o.params, function (o) {
                            str.push(o.id + (o.type ? ("<span style='color:#888'>/*" + o.type + "*/</span>") : ""));
                        });

                        funs.push({
                            id: "{page.functions." + i + "}",
                            caption: i + "( " + str.join(", ") + " )" + (o.desc ? (" : " + o.desc) : ""),
                            imageClass: imageClassFun
                        });

                    }
                    funs.push({
                        id: "{page.functions.}",
                        caption: "$(RAD.action.var.[key])",
                        imageClass: imageClassFun
                    });
                }, f4 = function () {
                    var argsvar = prop.argsvar || [], t;
                    ood.arr.each(prop.args, function (o, i) {
                        args.push({
                            id: "{args[" + i + "]}",
                            caption: prop.argsdoc && prop.argsdoc[i] || o,
                            imageClass: ood.isArr(t) ? imageClassArr : ood.isHash(t) ? imageClassHash : imageClassVar,
                            _paramName: argsvar[i] == "e" ? "keyboard" : null,
                            sub: argsvar[i] == "e" ? true :
                                // onlly for event handler
                                argsvar[i] == "curProfile" ? [{
                                        id: "{args[" + i + "].boxing()}",
                                        caption: "$(RAD.action.var.Current Control)",
                                        imageClass: imageClassHash,
                                        __: target ? target.key : null,
                                        referer: target ? "{page." + target.alias + "}" : "",
                                        sub: true
                                    }] :
                                    (ood.isArr(argsvar[i]) || ood.isHash(argsvar[i]) || ood.isObj(argsvar[i])) ? true :
                                        null
                        });
                    });
                };
            f1(controls);
            f2(pp);
            //f3(ff);
            f4();

            var items = [{
                id: "{}",
                caption: "$(RAD.action.var.Input Var)",
                imageClass: imageClassMan
            }, {
                id: "{getCookies()}",
                hidden: !!mem,
                realValue: "{getCookies(\"key\")}",
                caption: "$(RAD.action.var.Get Cookies)",
                imageClass: imageClassMan
            }, {
                id: "{getFI()}",
                hidden: !!mem,
                realValue: "{getFI(\"key\")}",
                caption: "$(RAD.action.var.Get Fragment Identifier)",
                imageClass: imageClassMan
            }, {
                id: "{native}",
                caption: "$(RAD.action.var.Native Var)",
                hidden: !!mem,
                imageClass: "ri-code-box-line",
                group: true,
                sub: [{
                    pid: "{native}",
                    id: "{true}",
                    caption: "true",
                    imageClass: imageClassVar
                }, {
                    pid: "{native}",
                    id: "{false}",
                    caption: "false",
                    imageClass: imageClassVar
                }, {
                    pid: "{native}",
                    id: "{NaN}",
                    caption: "NaN",
                    imageClass: imageClassVar
                }, {
                    pid: "{native}",
                    id: "{null}",
                    caption: "null",
                    imageClass: imageClassVar
                }, {
                    pid: "{native}",
                    id: "{undefined}",
                    caption: "undefined",
                    imageClass: imageClassVar
                }, {
                    pid: "{native}",
                    id: "{}",
                    caption: "$(RAD.action.var.Empty String)",
                    imageClass: imageClassVar
                }, {
                    pid: "{native}",
                    id: "{-0.00}",
                    caption: "$(RAD.action.var.Number)",
                    imageClass: imageClassVar
                }]
            }, {
                id: "{args}",
                caption: "$(RAD.action.var.Parameters)",
                group: true,
                initFold: false,
                imageClass: "ri-arrow-right-circle-line",
                tagCmds: [{buttonType: 'text', 'tagCmdsAlign': 'left', caption: '', itemClass: 'ri-question-line'}],
                idn: target ? target.key + ".prototype." + prop._eventkey : "",
                sub: args
            }, {
                id: "{temp}",
                caption: "$(RAD.action.var.Temp)",
                imageClass: "ri-time-line",
                group: true,
                sub: [{
                    id: "{temp.okData}",
                    caption: "$(RAD.action.var.Returned data)",
                    imageClass: imageClassVar
                }, {
                    id: "{temp.koData}",
                    caption: "$(RAD.action.var.Failure message)",
                    imageClass: imageClassVar
                },
                    {type: 'split'},
                    {
                        id: "{temp._confirm_yes}",
                        caption: "$(RAD.action.var.Select [yes] in confirm dialog)",
                        imageClass: imageClassVar
                    },
                    {
                        id: "{temp._confirm_no}",
                        caption: "$(RAD.action.var.Select [no] in confirm dialog)",
                        imageClass: imageClassVar
                    },
                    {type: 'split'},
                    {
                        id: "{temp._prompt_ok}",
                        caption: "$(RAD.action.var.Select [ok] in prompt dialog)",
                        imageClass: imageClassVar
                    },
                    {
                        id: "{temp._prompt_cancel}",
                        caption: "$(RAD.action.var.Select [cancel] in prompt dialog)",
                        imageClass: imageClassVar
                    },
                    {type: 'split'},
                    {
                        id: "{temp._DI_succeed}",
                        caption: "$(RAD.action.var.Data interaction succeeded)",
                        imageClass: imageClassVar
                    },
                    {
                        id: "{temp._DI_fail}",
                        caption: "$(RAD.action.var.Data interaction failed)",
                        imageClass: imageClassVar
                    },
                    {type: 'split'},
                    {
                        id: "{temp.}",
                        caption: "$(RAD.action.var.[key])",
                        imageClass: imageClassMan
                    }]
            }, {
                id: "{global}",
                caption: "$(RAD.action.var.Global)",
                imageClass: "ri-globe-line",
                group: true,
                sub: ns._buildGlobalData('var')
            }, {
                id: "{constant}",
                imageClass: "ri-check-double-line",
                caption: "$(RAD.action.var.Constant)",
                group: true,
                sub: ns._buildConstantData('var')
            }];
            if (ood.get(prop.parent, ["_cls"])) {
                items.push({
                    id: "{page}",
                    caption: "$(RAD.action.Current Page)",
                    imageClass: "ri-file-list-line",
                    sub: pagectls
                });
            }
            if (tprf.properties.tag == "purevar") {
                var mem = ns.add_target.getTagVar(),
                    iitems = [];
                // not for items /insert case
                if (!(mem && mem.insert)) {
                    iitems.push({
                        id: "hash",
                        caption: "$(RAD.action.var.Hash Var)",
                        imageClass: imageClassHash
                    });
                }
                // not for items /update case
                if (!(mem && (mem.update || mem.specialUpdate))) {
                    iitems.push({
                        id: "array",
                        caption: "$(RAD.action.var.Array Var)",
                        imageClass: imageClassArr
                    });
                }
                // not for items case
                if (!mem) {
                    iitems.push({
                        id: "function",
                        caption: "$(RAD.action.var.Function Var)",
                        imageClass: imageClassFun
                    });
                }

                ood.arr.insertAny(items, iitems, 1);
            }
            tv.setItems(items).setUIValue("");
        },
        _log_v5_onchange: function (profile, oldValue, newValue, force, tag) {
            var ns = this, tagVar = ns._tagVar;
            if (tagVar) {
                tagVar.args = tagVar.args || [];
                tagVar.args[4] = newValue;
                ns.markDirty(1);
            }
        },
        _log_v4_onchange: function (profile, oldValue, newValue, force, tag) {
            var ns = this, tagVar = ns._tagVar;
            if (tagVar) {
                tagVar.args = tagVar.args || [];
                tagVar.args[3] = newValue;
                ns.markDirty(1);
            }
        },
        _log_v3_onchange: function (profile, oldValue, newValue, force, tag) {
            var ns = this, tagVar = ns._tagVar;
            if (tagVar) {
                tagVar.args = tagVar.args || [];
                tagVar.args[2] = newValue;
                ns.markDirty(1);
            }
        },
        _log_v2_onchange: function (profile, oldValue, newValue, force, tag) {
            var ns = this, tagVar = ns._tagVar;
            if (tagVar) {
                tagVar.args = tagVar.args || [];
                tagVar.args[1] = newValue;
                ns.markDirty(1);
            }
        },
        _log_v1_onchange: function (profile, oldValue, newValue, force, tag) {
            var ns = this, tagVar = ns._tagVar;
            if (tagVar) {
                tagVar.args = tagVar.args || [];
                tagVar.args[0] = newValue;
                ns.markDirty(1);
            }
        },
        _i_rtn_onchange: function (profile, oldValue, newValue) {
            if (oldValue == newValue) return;
            this._dirty = true;
        },
        _i_conl_onchange: function (profile, oldValue, newValue, force, tag) {
            if (oldValue == newValue) return;
            var ns = this, tagVar = ns._tagVar, tag = profile.properties.tag;

            var tagVar = ns._tagVar;
            if (tagVar) {
                if (!tagVar.conditions) tagVar.conditions = [];
                if (!tagVar.conditions[tag - 1])
                    tagVar.conditions[tag - 1] = {
                        left: "",
                        symbol: "defined",
                        right: ""
                    };
                var con = tagVar.conditions[tag - 1];
                con.left = newValue;
                ns.markDirty(1);
            }
        },
        _i_conr_onchange: function (profile, oldValue, newValue, force, tag) {
            if (oldValue == newValue) return;
            var ns = this, tagVar = ns._tagVar, tag = profile.properties.tag;

            var tagVar = ns._tagVar;
            if (tagVar) {
                if (!tagVar.conditions) tagVar.conditions = [];
                if (!tagVar.conditions[tag - 1])
                    tagVar.conditions[tag - 1] = {
                        left: "",
                        symbol: "defined",
                        right: ""
                    };
                var con = tagVar.conditions[tag - 1];
                con.right = newValue;
                ns.markDirty(1);
            }
        },
        _ctl_adjust_onchange: function (profile, oldValue, newValue, force, tag) {
            if (oldValue == newValue) return;
            var ns = this, tagVar = ns._tagVar;
            if (tagVar) {
                tagVar.adjust = newValue;
            }
            // do Map UI and Function
        },
        _ctl_varto_onchange: function (profile, oldValue, newValue, force, tag) {
            if (oldValue == newValue) return;
            var ns = this, tagVar = ns._tagVar;
            if (tagVar) {
                tagVar.args = tagVar.args || [];
                tagVar.args[0] = newValue;

                var s = "${" + tagVar.method + "." + (newValue || "?") + "} = ";
                ns.conf_var_left.setHtml(s);

                ns.markDirty(1);
            }
        },
        _ctl_varfrom_cmd: function (profile) {
            profile.boxing().setTagVar(null, true);
            profile.boxing().setCommandBtn('none', true).setInputReadonly(false, true).setUIValue("", true);
            ood.asyRun(function () {
                profile.boxing().activate();
            });
        },
        _ctl_varfrompath_cmd: function (profile) {
            profile.boxing().setTagVar(null, true);
            profile.boxing().setCommandBtn('none', true).setInputReadonly(false, true).setUIValue("", true);
            ood.asyRun(function () {
                profile.boxing().activate();
            });
        },
        _ctl_animate_onchange: function (profile, oldValue, newValue, force, tag) {
            var ns = this, tagVar = ns._tagVar;
            if (tagVar) {
                tagVar.args = tagVar.args || [];
                tagVar.args[0] = profile.properties.tagVar || newValue;
                ns.markDirty(1);
                if (ood.isStr(tagVar.args[0]))
                    profile.boxing().animate(tagVar.args[0]);
            }
        },
        _ctl_itemvar_onchange: function (profile, oldValue, newValue, force, tag) {
            var ns = this, prop = ns.properties,
                tagVar = ns._tagVar,
                mem = ns.add_target.getTagVar();
            if (tagVar) {
                tagVar.args = tagVar.args || [];
                if (mem.insert || mem.specialUpdate) {
                    tagVar.args[0] = profile.properties.tagVar || newValue;
                } else {
                    tagVar.args[1] = profile.properties.tagVar || newValue;
                }
                ns.markDirty(1);
            }
        },
        _ctl_varfrom_onchange: function (profile, oldValue, newValue, force, tag) {
            var ns = this, tagVar = ns._tagVar;
            if (tagVar) {
                tagVar.args = tagVar.args || [];
                tagVar.args[1] = profile.properties.tagVar || newValue;
                ns.markDirty(1);
            }
        },
        _ctl_varfrompath_onchange: function (profile, oldValue, newValue, force, tag) {
            var ns = this, tagVar = ns._tagVar;
            if (tagVar) {
                tagVar.args = tagVar.args || [];
                tagVar.args[2] = profile.properties.tagVar || newValue;
                ns.markDirty(1);
            }
        },
        _tv_var_onsel: function (profile, item) {
            if (item.sub && !item._checked) {
                profile.boxing().toggleNode(item.id, true, false);
            }
        },
        getScope: function (type) {
            var ns = this,
                prop = ns.properties,
                page = {};
            return {
                "ood": ood,
                "page": ood.get(prop.parent, ["_cls"]) ? ood.merge(ood.merge(ood.merge(page, prop.parent._cls.Instance, 'without'), prop.parent.$host, 'without'), ood.Module.prototype, 'without') : {},
                "prop": ood.get(prop.cls, ["Instance", "properties"]) || {},
                "args": prop.argsvar || [],
                "functions": SPA.curProjectConfig && SPA.curProjectConfig.$GlobalFunctions,//ood.$cache.functions,
                "constant": SPA.curProjectConfig && SPA.curProjectConfig.$ConstantData,//ood.constant
                "global": SPA.curProjectConfig && SPA.curProjectConfig.$GlobalData//ood.$cache.data
            };
        },
        _ignoreFuns1: {
            "upper": 1,
            "Before": 1,
            "After": 1,
            "Constructor": 1,
            "constructor": 1,
            "Initialize": 1
        },
        _ignoreFuns2: {
            addTemplateKeys: 1,
            getTemplateKeys: 1,
            buildCSSText: 1,
            cacheData: 1,
            getCachedData: 1,
            setAppearance: 1,
            getAppearance: 1,
            getTemplate: 1,
            setTemplate: 1,
            pickAlias: 1,
            plugIn: 1,
            getBehavior: 1,
            setBehavior: 1,
            setDataModel: 1,
            setEventHandlers: 1,
            pickAlias: 1,
            pack: 1,
            plugIn: 1
        },
        _tv_fun_opt: function (profile, item) {
            if (item.idn) {
                CONF.openAPI(item.idn);
            }
        },
        _tv_fun_ongetcontent: function (profile, item, callback) {
            var ns = this,
                tv = ns.tv_var,
                imageClassMan = 'ri-book-open-line',
                imageClassFun = 'ri-function-line',
                imageClassArr = 'ri-list-unordered',
                imageClassHash = 'ri-braces-line',
                imageClassVar = 'ri-text',
                id = item.id,
                iid = id.replace(/[{}]/g, ""),
                arr = /^\s*\{([\w]+)/.exec(id),
                key = arr && arr[1],
                items = [];

            if (!key) callback(items);

            switch (key) {
                case "ood":
                    ood.each(ood.SC(iid), function (o, i) {
                        var idn = iid + "." + i;

                        if (idn == "ood.Locale" || idn == "ood.ini" || idn == "ood.browser" || idn == "ood.pseudocode") return;
                        if (ns._ignoreFuns1[i]) return;
                        if (o && o.$abstract) return;
                        if (ns._ignoreFuns2[i] && (idn.indexOf("ood.CSSBox") === 0 || idn.indexOf("ood.Timer") === 0 || idn.indexOf("ood.AnimBinder") === 0 || idn.indexOf("ood.MessageService") === 0 || idn.indexOf("ood.DataBinder") === 0 || idn.indexOf("ood.APICaller") === 0 || idn.indexOf("ood.UI") === 0 || idn.indexOf("ood.svg") === 0)) return;
                        if (i.charAt(0) == "_" || i.charAt(0) == "$") return;

                        if (typeof o == "function") {
                            var info = ood.get(RAD.EditorTool.getDoc(idn, false, true), "$desc") || "";
                            if (o.$oodclass$) {
                                items.push({
                                    id: "{" + idn + "}",
                                    caption: i + (info ? (" : " + info) : ""),
                                    tagCmds: [{
                                        buttonType: 'text',
                                        'tagCmdsAlign': 'left',
                                        caption: '',
                                        itemClass: 'ri-question-line'
                                    }],
                                    idn: idn,
                                    group: true,
                                    sub: true
                                });
                            } else {
                                //    if(o.$original$ && o.$original$!=iid)return;
                                items.push({
                                    id: "{" + idn + "()}",
                                    caption: i + ns._getFunCap(idn),
                                    tagCmds: [{
                                        buttonType: 'text',
                                        'tagCmdsAlign': 'left',
                                        caption: '',
                                        itemClass: 'ri-question-line'
                                    }],
                                    idn: idn,
                                    imageClass: imageClassFun
                                });
                            }
                        } else if (ood.isHash(o)) {
                            items.push({
                                id: "{" + idn + "}",
                                tagCmds: [{
                                    buttonType: 'text',
                                    'tagCmdsAlign': 'left',
                                    caption: '',
                                    itemClass: 'ri-question-line'
                                }],
                                idn: idn,
                                caption: i,
                                group: true,
                                sub: true
                            });
                        }
                    });
                    ood.arr.stableSort(items, function (x, y) {
                        if (x.group) {
                            if (!y.group) return 1;
                            else return x.id.toLowerCase() > y.id.toLowerCase() ? 1 : x.id.toLowerCase() < y.id.toLowerCase() ? -1 : 0;
                        } else {
                            if (y.group) return -1;
                            else return x.id.toLowerCase() > y.id.toLowerCase() ? 1 : x.id.toLowerCase() < y.id.toLowerCase() ? -1 : 0;
                        }
                    });
                    break;
                default:
                    if (item.__) {
                        ood.each(item["0"].boxing(), function (o, i) {
                            var idn = item.__ + ".prototype." + i;
                            if (i.charAt(0) == "_" || i.charAt(0) == "$") return;
                            if (typeof o == "function") {
                                if (i == "toHtml" || i == "size" || i == "get" || i == "merge" || i == "each" || i == "host" || i == "render" || i == "renderOnto") return;
                                if (o.$event$) return;
                                items.push({
                                    id: "{" + iid + "." + i + "()}",
                                    caption: i + ns._getFunCap(idn),
                                    tagCmds: [{
                                        buttonType: 'text',
                                        'tagCmdsAlign': 'left',
                                        caption: '',
                                        itemClass: 'ri-question-line'
                                    }],
                                    idn: idn,
                                    imageClass: imageClassFun
                                });
                            }
                        });
                    }
            }
            ood.arr.stableSort(items, function (x, y) {
                if (x.group) {
                    if (!y.group) return -1;
                    else return x.id.toLowerCase() > y.id.toLowerCase() ? 1 : x.id.toLowerCase() < y.id.toLowerCase() ? -1 : 0;
                } else {
                    if (y.group) return 1;
                    return x.id.toLowerCase() > y.id.toLowerCase() ? 1 : x.id.toLowerCase() < y.id.toLowerCase() ? -1 : 0;
                }
            });
            callback(items);
        },
        _tv_var_ongetcontent: function (profile, item, callback) {
            var ns = this,
                prop = ns.properties,
                argsdoc = prop.argsdoc,
                args = prop.args,
                tv = ns.tv_var,
                imageClassMan = 'ri-book-open-line',
                imageClassArr = 'ri-list-unordered',
                imageClassHash = 'ri-braces-line',
                imageClassVar = 'ri-text',
                items = [];
            var scope = ns.getScope();

            var v = ood.adjustVar(item.referer || item.id, scope), t;
            if (item._paramName == "keyboard") {
                items = [{
                    id: "{" + item.id.replace(/[{}]/g, "") + ".key}",
                    caption: "$(RAD.action.var.Keyboard Code)",
                    imageClass: imageClassVar
                }, {
                    id: "{" + item.id.replace(/[{}]/g, "") + ".ctrlKey}",
                    caption: "$(RAD.action.var.Ctrl Key)",
                    imageClass: imageClassVar
                }, {
                    id: "{" + item.id.replace(/[{}]/g, "") + ".shiftKey}",
                    caption: "$(RAD.action.var.Shift key)",
                    imageClass: imageClassVar
                }, {
                    id: "{" + item.id.replace(/[{}]/g, "") + ".altKey}",
                    caption: "$(RAD.action.var.Alt Key)",
                    imageClass: imageClassVar
                }];
                if (item._paramName == "keyboard") {
                    Array.prototype.unshift.apply(items, [{
                        id: "{" + item.id.replace(/[{}]/g, "") + ".button}",
                        caption: "$(RAD.action.var.Mouse Button)",
                        imageClass: imageClassVar
                    }, {
                        id: "{" + item.id.replace(/[{}]/g, "") + ".pageX}",
                        caption: "$(RAD.action.var.Cursor PageX)",
                        imageClass: imageClassVar
                    }, {
                        id: "{" + item.id.replace(/[{}]/g, "") + ".pageY}",
                        caption: "$(RAD.action.var.Cursor PageY)",
                        imageClass: imageClassVar
                    }]);
                }
            } else if (ood.isArr(v)) {
                for (var i = 0, l = v.length; i < l; i++) {
                    t = v[i];
                    items.push({
                        id: "{" + item.id.replace(/[{}]/g, "") + "." + i + "}",
                        caption: (ood.isArr(v[i]) || ood.isHash(v[i])) ? i : v[i],
                        imageClass: ood.isArr(t) ? imageClassArr : ood.isHash(t) ? imageClassHash : imageClassVar,
                        sub: (ood.isArr(t) || ood.isHash(t)) ? true : null
                    });
                }
                items.push({
                    id: "{" + item.id.replace(/[{}]/g, "") + ".length}",
                    caption: "$(RAD.action.var.Array Length)",
                    imageClass: imageClassMan
                });
            } else if (ood.isHash(v)) {
                for (var i in v) {
                    t = v[i];
                    items.push({
                        id: "{" + item.id.replace(/[{}]/g, "") + "." + i + "}",
                        caption: item.id.indexOf("{args[") === 0 ? v[i] : i,
                        imageClass: ood.isArr(t) ? imageClassArr : ood.isHash(t) ? imageClassHash : imageClassVar,
                        sub: (ood.isArr(t) || ood.isHash(t)) ? true : null
                    });
                }
                items.push({
                    id: "{" + item.id.replace(/[{}]/g, "") + ".}",
                    caption: "$(RAD.action.var.[key])",
                    imageClass: imageClassMan
                });
            } else if (item.__) {
                var pp = v, special = {
                        getAlias: true,
                        getProperties: true,
                        serialize: true,

                        isDestroyed: true,
                        busy: true,
                        free: true,
                        reLayout: true,
                        hide: true,
                        show: true,
                        refresh: true,
                        adjustDock: true,

                        isDirtied: true,
                        checkValid: true,
                        checkRequired: true,
                        getUIValue: true,
                        getData: true,
                        setData: true,
                        resetValue: true,
                        clearValue: true,
                        updateValue: true,
                        updateDataFromUI: true,
                        updateDataToUI: true,

                        play: true,
                        pause: true
                    },
                    getName = function (i) {
                        return special[i] ? i : "get" + ood.str.initial(i);
                    };
                v = v.get(0).properties;

                v = ood.copy(v);
                if (pp.Class['ood.absObj']) {
                    ood.merge(v, {
                        getAlias: true,
                        getProperties: true,
                        selectedItem: true,
                        getCaptionValue: true,
                        serialize: true
                    });
                }
                if (pp.Class['ood.UI']) {
                    ood.merge(v, {
                        isDestroyed: true,
                        busy: true,
                        free: true,
                        reLayout: true,
                        hide: true,
                        show: true,
                        refresh: true,
                        adjustDock: true
                    });
                }

                // add extra prop
                if (pp.Class["ood.DataBinder"]) {
                    ood.merge(v, {
                        isDirtied: true,
                        checkValid: true,
                        checkRequired: true,
                        getUIValue: true,
                        getData: true,
                        setData: true,

                        resetValue: true,
                        clearValue: true,
                        updateValue: true,
                        updateDataFromUI: true,
                        updateDataToUI: true
                    });
                } else if (pp.Class["ood.UI.Audio"]) {
                    ood.merge(v, {
                        play: true,
                        pause: true
                    });
                } else if (pp.Class["ood.UI.FusionChartsXT"]) {
                    ood.merge(v, {
                        ChartAttribute: {},
                        updateData: true,
                        setTheme: true,
                        fillData: true,
                        refreshChart: true
                    });
                } else if (pp.Class["ood.absContainer"]) {
                    ood.merge(v, {
                        formValues: {},
                        addPanel: true,
                        removePanel: true,
                        getPanelPara: true,
                        dumpContainer: true,
                        getPanelChildren: true,
                        getFormValues: true,
                        setFormValues: true,
                        getFormElements: true,
                        isDirtied: true,
                        checkValid: true,
                        checkRequired: true,
                        formClear: true,
                        formReset: true,
                        updateFormValues: true,
                        formSubmit: true
                    });
                } else if (pp.Class["ood.UI.TreeGrid"]) {
                    ood.merge(v, {
                        isDirtied: true,
                        sortColumn: true,
                        showColumn: true,

                        getActiveRow: true,
                        setActiveRow: true,
                        updateRow: true,
                        autoRowHeight: true,

                        getCellbyRowCol: true,
                        editCellbyRowCol: true,
                        focusCellbyRowCol: true,
                        getActiveCell: true,
                        setActiveCell: true,
                        updateCellByRowCol2: true,

                        getEditor: true,
                        updateEditor: true,
                        getEditCell: true,
                        offEditor: true
                    });
                }

                for (var i in v) {
                    if (i.charAt(0) == "$" || i.charAt(0) == "_") continue;
                    t = v[i];
                    var idn = item.__ + ".prototype." + getName(i);

                    var item1 = {
                        id: "{" + item.id.replace(/[{}]/g, "") + "." + getName(i) + "()}",
                        caption: getName(i) + ns._getFunCap(idn),
                        tagCmds: [{
                            buttonType: 'text',
                            'tagCmdsAlign': 'left',
                            caption: '',
                            itemClass: 'ri-question-line'
                        }],
                        idn: idn,
                        imageClass: ood.isArr(t) ? imageClassArr : ood.isHash(t) ? imageClassHash : imageClassVar,
                        sub: (ood.isArr(t) || ood.isHash(t)) ? true : null
                    };
                    if (item.referer)
                        item1.referer = "{" + item.referer.replace(/[{}]/g, "") + "." + getName(i) + "()}";
                    items.push(item1);
                }
                ood.arr.stableSort(items, function (x, y) {
                    return x.id > y.id ? 1 : x.id == y.id ? 0 : -1;
                });
            }
            return items;
        },
        _tb_actions_ondblclick: function (profile, item, e, src) {
            profile.boxing().editItem(item.id);
        },
        events: {"onReady": "_onready"},
        _onready: function () {
            var inputs = this.getAllComponents().reBoxing('ood.UI.Input');
            ood.filter(inputs._nodes, function (o) {
                if (o.alias == 'propFilter') return false;
                if (o.alias == 'ctl_animate') return false;
            });

            this._enhanceInputs(inputs);
        },
        _editMixData: function (target, vtype, inicode, label, imageClass, editorPrf) {
            var ns = this,
                mem = ns.add_target.getTagVar();
            // for those item setting
            if (target.getAlias() == "ctl_itemvar" && mem.keyN) {
                var prop = ns.properties,
                    parent = prop.parent,
                    src = target.getRoot().xid(),
                    tagVar = ns._tagVar,
                    targetCtrl = parent.getByAlias(tagVar.target, true);
                if (mem.insert) {
                    var obj = ood.get(tagVar, ["args", 0]) || [];
                    parent._showMixedEditor(targetCtrl, targetCtrl.key, "tagVar", mem.keyN, obj, src, function (data) {
                        var tagVar = ns._tagVar;
                        if (tagVar) {
                            tagVar.args = tagVar.args || [];
                            if (data && data.length) {
                                delete tagVar._ignore;
                            } else {
                                //if empty, ignore it
                                tagVar._ignore = 1;
                            }

                            // first
                            target.setTagVar(data, true);
                            target.setInputReadonly(true).setCommandBtn("delete");
                            target.setUIValue(label, true);
                        }
                    });
                } else {
                    var obj = ood.get(tagVar, ["args", 1]) || {};
                    parent._showEditor(targetCtrl, targetCtrl.key, mem.keyN, obj, src, function (data) {
                        var tagVar = ns._tagVar;
                        if (tagVar) {
                            tagVar.args = tagVar.args || [];
                            if (data && !ood.isEmpty(data)) {
                                delete tagVar._ignore;
                            } else {
                                //if empty, ignore it
                                tagVar._ignore = 1;
                            }

                            // first
                            target.setTagVar(data, true);
                            target.setInputReadonly(true).setCommandBtn("delete");
                            target.setUIValue(label, true);
                        }
                    }, tagVar.method == "updateCellByRowCol2" ?
                        CONF.widgets_itemsProp.rows["ood.UI.TreeGrid"].subheader :
                        null);
                }
            }
            else {
                var text = ood.Coder.formatText(inicode),
                    type = vtype == "function" ? 'funEditor' : 'jsonEditor',
                    _cb = function (code) {
                        var o = vtype == "function" ? ood.unserialize("function(" + ood.fun.args(code).join(", ") + "){" + ood.fun.body(code) + "}") : ood.unserialize(code);
                        // first
                        target.setTagVar(o, true);
                        target.setInputReadonly(true).setCommandBtn("delete");
                        target.setUIValue(label, true);
                    };
                if (window.SPA && false === SPA.fe("beforeObjectEditorPop", [
                    type, null, text, _cb,
                    "RAD.ActionsEditor", target, editorPrf && editorPrf.getSubNode('BOX').get(0), null, null, editorPrf && editorPrf.boxing()])) return;

                ood.getModule(type, function () {
                    this.setProperties({
                        caption: label,
                        imageClass: imageClass,
                        text: text,
                        onOK: function (obj) {
                            _cb(obj.properties.result.code);
                        }
                    }, true);
                    this.show(function (tid, module) {
                        //if(module.activate)module.activate();
                    });
                });
            }
        },
        iniPureValue: function (ctl, value) {
            if (ood.isObj(value)) {
                ctl.setTagVar(value);
                var label = label = "#" + ood.adjustRes("$(RAD.action.var." +
                    (typeof value == "function" ? "Function" : ood.isArr(value) ? "Array" : "Hash") +
                    " Var)") + "#";
                ctl.setInputReadonly(true).setCommandBtn("delete");
                ctl.setValue(label, true);
            } else {
                ctl.setTagVar(null);
                ctl.setInputReadonly(false, true).setCommandBtn("none", true);
                ctl.setValue(value, true);
            }
        },
        _jsonedit: function (col, input) {
            if (col == 'value') this._enhanceInputs(input, true);
        },
        _enhanceInputs: function (inputs, noDyncheck) {
            var ns = this,
                _check = function (profile) {
                    var type = profile.properties.tagVar;
                    if (profile.properties.multiLines) return false;
                    if (profile.properties.inputReadonly) return 0;
                    if (type == "none") return false;
                    switch (profile.properties.type) {
                        case 'file':
                        case 'spin':
                        case 'currency':
                        case 'number':
                        case 'listbox':
                            return false;
                    }
                    ;
                    return true;
                },
                _onchange = function (profile, oldValue, newValue, force, tag) {
                    if (!_check(profile)) return;
                    var type = profile.properties.tagVar;
                    if (oldValue != newValue) {
                        ns._autoNavTree(type, newValue);
                    }
                },
                _onTips = function (profile, node, pos) {
                    if (!_check(profile)) return true;
                    var type = profile.properties.tagVar;
                    var uictrl = profile.boxing(), v = uictrl.getUIValue();
                    if (v && /^\s*\{([\S]+)\}\s*$/.test(v)) {

                        var arr = ns._autoNavTree(type, v, true),
                            info = ood.adjustRes("$(RAD.action.Var Path is)") + "&nbsp;<b>:</b>&nbsp;<span style='text-decoration: underline;'>" + arr.join("</span>&nbsp;<b>&gt;</b>&nbsp;<span style='text-decoration: underline;'>") + "</span>";

                        ood.Tips.show(pos, "<div style='line-height:20px;'>" + info + "</div>");
                    } else if (v) ood.Tips.show(pos, v);
                    return false;
                },
                _onfocus = function (profile) {
                    if (profile.properties.disabled || profile.properties.readonly) return false;

                    var c = _check(profile);
                    if (c === 0) {
                        var inicode = profile.properties.tagVar,
                            alias = profile.alias,
                            target = profile.boxing();

                        if (!inicode || typeof(inicode) == "string") return;

                        var vtype = typeof inicode,
                            label = profile.properties.value,
                            imageClass = vtype == "function" ? 'ri-function-line' : vtype == "array" ? 'ri-braces-line' : ' ';
                        inicode = ood.serialize(inicode);

                        ns._editMixData(target, vtype, inicode, label, imageClass, profile);
                        return;
                    }

                    if (!_check(profile)) {
                        return;
                    }

                    //for sepcial function list
                    if (profile.alias == 'cb_callid' && 'callFunction' == ns.tb_action.getUIValue() && ('module' == ns._tagVar.type || 'page' == ns._tagVar.type)) {
                        if ((!ns.tv_fun.getTag() || profile.alias != ns.tv_fun.getTag().alias) && profile.getSubNode('BOX').get(0).offsetWidth) {
                            ns._buildVarTree3('module' == ns._tagVar.type ? ns._tagVar.target : null);
                            ns.tv_fun.setTag(profile);
                            ns._helperPop = ns.tv_fun;
                            ns.blk_float2.getRoot().popToTop(profile.getSubNode('BOX'))
                                .setBlurTrigger("-action-float-inoodb", function () {
                                    ns._helperPop = null;
                                    ns.tv_fun.setTag(null);
                                    ns.blk_float2.hide();
                                    profile.getSubNode('INPUT').blur();
                                }, ood([ns.blk_float2.getRoot().xid(), profile.getSubNode('BOX').xid()]));

                            ns._autoNavTree(type, profile.boxing().getUIValue());
                        }
                    } else {
                        var type = profile.properties.tagVar;
                        if (type == "callback" || type == "adjustdata") {
                            if ((!ns.tv_fun.getTag() || profile.alias != ns.tv_fun.getTag().alias) && profile.getSubNode('BOX').get(0).offsetWidth) {
                                ns._buildVarTree2(type == "adjustdata");
                                ns.tv_fun.setTag(profile);
                                ns._helperPop = ns.tv_fun;
                                ns.blk_float2.getRoot().popToTop(profile.getSubNode('BOX'))
                                    .setBlurTrigger("-action-float-inoodb", function () {
                                        ns._helperPop = null;
                                        ns.tv_fun.setTag(null);
                                        ns.blk_float2.hide();
                                        profile.getSubNode('INPUT').blur();
                                    }, ood([ns.blk_float2.getRoot().xid(), profile.getSubNode('BOX').xid()]));

                                ns._autoNavTree(type, profile.boxing().getUIValue());
                            }
                        } else {
                            if ((!ns.tv_var.getTag() || profile.alias != ns.tv_var.getTag().alias) && profile.getSubNode('BOX').get(0).offsetWidth) {
                                ns._buildVarTree(profile);
                                ns.tv_var.setTag(profile);
                                ns._helperPop = ns.tv_var;
                                ns.blk_float.getRoot().popToTop(profile.getSubNode('BOX'))
                                    .setBlurTrigger("-action-float-inoodb", function () {
                                        ns.tv_var.setTag(null);
                                        ns._helperPop = null;
                                        ns.blk_float.hide();
                                        profile.getSubNode('INPUT').blur();
                                    }, ood([ns.blk_float.getRoot().xid(), profile.getSubNode('BOX').xid()]));

                                ns._autoNavTree(type, profile.boxing().getUIValue());
                            }
                        }
                    }

                    ood.asyRun(function () {
                        var newValue = profile.boxing().getUIValue();
                        var ip = profile.getSubNode("INPUT"), pos, pos1 = 0, pos2 = 0;
                        if (newValue == "{}") pos1 = pos2 = 1;
                        else if (/\(\'[^']*\'\)/.test(newValue)) {
                            pos1 = newValue.indexOf("\'") + 1;
                            pos2 = newValue.lastIndexOf("\'");
                        } else if (/\(\"[^"]*\"\)/.test(newValue)) {
                            pos1 = newValue.indexOf("\"") + 1;
                            pos2 = newValue.lastIndexOf("\"");
                        } else {
                            pos = newValue.lastIndexOf("}");
                            if (pos != -1) pos1 = pos2 = pos;
                        }
                        // stop the default focus event handler
                        profile.$ignoreFocus = 1;
                        ip.focus();
                        ip.caret(pos1, pos2);
                        delete profile.$ignoreFocus;
                    });
                    return false;
                },
                _tabhander = function (profile, keyboard) {
                    if (ns._potentialStep && (keyboard.key == 'tab')) {
                        profile.boxing().setUIValue(ns._potentialStep, true);
                        return false;
                    } else if (keyboard.key == 'up' || keyboard.key == 'esc') {
                        ns._ood_closefloat(profile);

                        return false;
                    } else if (keyboard.key == 'down') {
                        _onfocus(profile);
                    }
                };

            if (!noDyncheck)
                inputs.setDynCheck(true, true);

            inputs.onShowTips(_onTips)
                .beforeFocus(_onfocus)
                // use the inner onchange
                ._onChange(_onchange)
                .onHotKeydown(_tabhander)
                .each(function (profile) {
                    if (profile.properties.multiLines) return;
                    if (profile.properties.tagVar == "none") return;
                    switch (profile.properties.type) {
                        case 'file':
                        case 'spin':
                        case 'currency':
                        case 'number':
                        case 'listbox':
                            return;
                    }
                    ;
                    var flag = profile.properties.tagVar == "callback" || profile.properties.tagVar == "adjustdata";
                    profile.boxing().setCustomStyle({
                        "INPUT": "background-color:" + (flag ? "#00FFFF" : "#FFF8DC") + ";color:" + (flag ? "#000000" : "#000000")
                    });
                });

            ns.grid_params.updateHeader("value", {
                editorProperties: {
                    dynCheck: true
                },
                editorCS: {
                    "INPUT": "background-color:#FFF8DC"
                },
                editorEvents: {
                    onShowTips: _onTips,
                    beforeFocus: _onfocus,
                    _onChange: _onchange,
                    onHotKeydown: _tabhander,
                    onCommand: function (profile) {
                        profile.boxing().setTagVar(null, true);
                        profile.boxing().setCommandBtn('none', true).setInputReadonly(false, true).setUIValue("", true);
                        ood.asyRun(function () {
                            profile.boxing().activate();
                        });
                    }
                }
            });
        },
        _ood_closefloat: function (profile, e, value) {
            var ns = this;
            if (ns._helperPop == ns.tv_fun) {
                ns.tv_fun.setTag(null);
                ns.blk_float2.hide();
            } else {
                ns.tv_var.setTag(null);
                ns.blk_float.hide();
            }
            ns._helperPop = null;
        }
    }
});ood.Class('RAD.InteractionMap', 'ood.Module', {
    Instance: {
        iniComponents: function () {
            // [[Code created by ESDUI RAD Studio
            var host = this, children = [], append = function (child) {
                children.push(child.get(0));
            };

            append(
                ood.create("ood.UI.Dialog")
                    .setHost(host, "ood_ui_dialog1")
                    .setLeft("0em")
                    .setTop("0em")
                    .setWidth("66.66666666666667em")
                    .setHeight("37.5em")
                    .setCaption("$(RAD.inter.Interaction Map)")
                    .setMinBtn(false)
                    .setModal(true)
                    .beforeClose("_close")
            );

            host.ood_ui_dialog1.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ood_ui_block2")
                    .setDock("fill")
                    .setLeft("16.666666666666668em")
                    .setTop("4.166666666666667em")
                    .setBorderType("inset")
            );

            host.ood_ui_block2.append(
                ood.create("ood.UI.TreeGrid")
                    .setHost(host, "grid")
                    .setDisableHoverEffect("CELL")
                    .setLeft("0em")
                    .setTop("0em")
                    .setRowHandler(false)
                    .setColSortable(false)
                    .setHeader([
                        {
                            "id": "name",
                            "caption": "$(RAD.inter.Name)",
                            "flexSize": true,
                            "width": "10em",
                            "type": "label"
                        },
                        {
                            "id": "cat",
                            "caption": "$(RAD.inter.Category)",
                            "flexSize": true,
                            "width": "10em",
                            "type": "label"
                        },
                        {
                            "id": "action",
                            "caption": "$(RAD.inter.Action)",
                            "flexSize": true,
                            "width": "10em",
                            "type": "label"
                        },
                        {
                            "id": "cond",
                            "caption": "$(RAD.inter.Conditions)",
                            "width": "6em",
                            "type": "label",
                            "cellStyle": "text-align:center"
                        },
                        {
                            "id": "asyn",
                            "caption": "$(RAD.inter.Asyn)",
                            "width": "4em",
                            "type": "checkbox"
                        },
                        {
                            "id": "stop",
                            "caption": "$(RAD.inter.Abort)",
                            "width": "4em",
                            "type": "checkbox"
                        }
                    ])
                    .setTagCmds([
                        {
                            "id": "add",
                            "itemClass": "ri-add-line",
                            "tips": "Add an event handler"
                        }
                    ])
                    .setActiveMode("none")
                    .setTreeMode("infirstcell")
                    .onCmd("_grid_oncmd")
            );

            return children;
            // ]]Code created by ESDUI RAD Studio
        },
        refreshInterMap: function (page) {
            var ns = this;
            if (page) ns._page = page;
            page = ns._page;

            //get all widgets
            var items = [],
                map = CONF.mapWidgets, item,
                getCap = function (profile) {
                    var prop = profile.properties,
                        type = profile['ood.Module'] ? "module" : "control",
                        cls = profile.key.split(".").pop(),
                        cap;
                    if (type == "module") {
                        cap = /*"$RAD.action.Module " + */profile.getAlias() + " ( " + profile.key + " )";
                    } else {
                        cap = /*"$RAD.action.Control " + */profile.alias + " ( " + cls + " )";
                        if (prop.name || prop.desc) cap += " <span style='color:#888;font-style: italic;font-weight:normal;'>[ " + (prop.name || "") + (prop.name ? " - " : "") + (prop.desc || "") + " ]</span>";
                        if (prop.caption || prop.labelCaption || prop.html) cap += " <span style='color:#888;font-style: italic;font-weight:normal;'>[ " + (prop.caption || prop.labelCaption || prop.html).substr(0, 10) + " ]</span>";
                    }
                    return cap;
                },
                buildEvent = function (id, cap, conf, name) {
                    var sub = [];
                    if (!conf) {
                       return false;
                    }
                    if (conf.actions) {
                        conf = conf.actions;
                    }
                    if (!ood.isArr(conf)) conf = [conf];
                    ood.arr.each(conf, function (a, i) {
                        if (a) {
                            var isStr = ood.isStr(a), map = RAD.ActionsEditor.prototype.CAPMAP,
                                map1 = map.actiongroup,
                                map2 = map.action;
                            sub.push({
                                id: id + ":" + i,
                                caption: isStr ? ("<span style='font-weight: normal;' class='ri-code-line'></span> " + a + " [code ] ") : null,
                                group: isStr,
                                cells: isStr ? null : [
                                    " <span style='font-weight: normal;' class='oodcon spafont spa-icon-action'></span> " + (a.desc || ""),
                                    "$(RAD.action." + map1[a.type == "page" ? "page" :
                                        a.type == "control" ? "control" :
                                            a.type == "module" ? "module" :
                                                a.type == "other" ? (a.type + ":" + a.target) : "-"]
                                    + ")"
                                    + (a.type == "control" || a.type == "module" ? (" - " + a.target) : ""),
                                    "$(RAD.action." + map2[a.method] + ")",
                                    a.conditions && a.conditions.length || "",
                                    ('timeout' in a),
                                    a['return'] === false
                                ],
                                tagCmds: isStr ? ns._actionCmds2 : ns._actionCmds
                            });
                        }

                    });
                    if (sub.length) {
                        var preName = cap.charAt(0) == 'b' ? "$(RAD.designer.eventbfrtag)" :
                            cap.charAt(0) == 'a' ? "$(RAD.designer.eventafttag)" :
                                "$(RAD.designer.eventontag)";
                        return {
                            id: id,
                            caption: " " + preName + "<span style='font-weight: normal;' class='oodcon spafont  spa-icon-arr'></span>" + RAD.EditorTool.getEventName(name, cap, true)
                            + " - <span style='color:#888;font-style: italic;font-weight:normal;'>" + (ood.get(RAD.EditorTool.getDoc(name + ".prototype." + cap, null, true), ["$desc"]) || "").split('.')[0] + "</span>",
                            group: true,
                            rowClass: "ood-treegrid-cells1-alt",
                            initFold: false,
                            tagCmds: ns._eventCmds,
                            sub: sub
                        };
                    } else {
                        return null;
                    }
                },
                rows = [], sub,
                scr = ns.grid.getSubNode('SCROLL22'),
                scrollTop = scr.get(0) && scr.scrollTop();

            // page
            sub = [];
            ood.each(ood.get(page._cls, ['Instance', 'events']), function (o, i) {
                if (i = buildEvent('-page:' + i, i, o, "ood.Module"))
                    sub.push(i);
            });

            if (sub.length) {
                rows.push({
                    group: true,
                    rowClass: "ood-treegrid-cells1-alt",
                    initFold: false,

                    id: "-page",
                    caption: "<span style='font-weight: normal;' class='" + "oodcon spafont spa-icon-page" + "'></span> $(RAD.action.var.Current Page) ( " + page._className + " )",
                    tagVar: page,
                    tagCmds: ns._pageCmds,
                    sub: sub
                });
            }

            // inner controls & modules
            ood.each(page.$host, function (ins, i) {
                if (i == "$inDesign" || !ins['ood.absBox'] || !ins.n0) return;

                var profile = ins.get(0),
                    cls = profile.key.split(".").pop(),
                    t = map[profile.box.KEY];
                sub = [];
                ood.each(profile.getEvents(), function (o, i) {
                    if (!o) return;
                    if (i = buildEvent(profile.alias + ':' + i, i, o, profile.box.KEY))
                        sub.push(i);
                });
                if (sub.length) {
                    rows.push({
                        group: true,
                        rowClass: "ood-treegrid-cells1-alt",
                        initFold: false,

                        id: profile.alias,
                        caption: "<span class='" + (t && t.imageClass || '') + "'></span> " + getCap(profile),
                        tagVar: profile,
                        tagCmds: ns._pageCmds,
                        sub: sub
                    });
                }
            });

            ns.grid.setRows(rows);

            if (scrollTop) ns.grid.getSubNode('SCROLL22').scrollTop(scrollTop);
        },
        events: {
            "onReady": "_page_onready"
        },
        _page_onready: function (module, threadid) {
            var ns = this;
            ns._pageCmds = [
                {
                    "id": "add1",
                    "itemClass": "oodcon ood-uicmd-add",
                    "tips": "Add an event handler"
                }
            ];
            ns._eventCmds = [
                {
                    "id": "edit2",
                    "itemClass": "ri-external-link-line",
                    "tips": "Edit this event handler"
                },
                {
                    "id": "remove2",
                    "itemClass": "ri-close-line",
                    "tips": "Remove this event handler"
                }
            ];
            ns._actionCmds = [
                {
                    "id": "edit3",
                    "itemClass": "ri-check-line",
                    "tips": "Edit this action"
                },
                {
                    "id": "remove3",
                    "itemClass": "oodcon ood-uicmd-close",
                    "tips": "Remove this action"
                }
            ];
            ns._actionCmds2 = [
                {
                    "id": "none",
                    "itemClass": "ri-square-line"
                },
                {
                    "id": "remove3",
                    "itemClass": "oodcon ood-uicmd-close",
                    "tips": "Remove this action"
                }
            ];
        },
        _close: function () {
            this._page._refreshProfileGrid(null, null, true);
        },
        _grid_oncmd: function (profile, row, cmdkey, e, src) {
            var ns = this,
                page = ns._page,
                grid = profile.boxing(),
                ae = RAD.Designer.prototype.$showActionEditor,
                arr = row ? row.id.split(":") : ["-page", null, 0],
                isCanvas = arr[0] === "-page",
                target = (isCanvas ? ns._page.canvas : ns._page.$host[arr[0]]).get(0),
                evtKey = arr[1],
                cap = "$(RAD.action." + (isCanvas ? "Page" : target['ood.Module'] ? "Module" : "Control") + " Action) => " + (isCanvas ? "" : target.alias + " - ") + RAD.EditorTool.getEventName(isCanvas ? 'ood.Module' : target.key, evtKey, true),
                selected = arr[2];
            // refersh after added or modified
            var callback = function () {
                ns.refreshInterMap();
            };
            if (row) {
                switch (cmdkey) {
                    // add to control
                    case 'add1':
                        ood.getModule('RAD.EventPicker', function (prf) {
                            this.refreshList(page, isCanvas ? "-page" : target.alias);
                            this.setEvents({
                                onSel: function (id, evtKey) {
                                    isCanvas = id === "-page";
                                    target = (isCanvas ? ns._page.canvas : ns._page.$host[id]).get(0);
                                    cap = "$(RAD.action." + (isCanvas ? "Page" : target['ood.Module'] ? "Module" : "Control") + " Action) => " + (isCanvas ? "" : target.alias + " - ") + RAD.EditorTool.getEventName(isCanvas ? 'ood.Module' : target.key, evtKey, true);
                                    ae(page, target, evtKey, cap, null, null, callback, profile, null);
                                }
                            });
                            this.show();
                        });
                        break;


                    // edit event
                    case 'edit2':
                        ae(page, target, evtKey, cap, null, null, callback, profile, null);
                        break;
                    // remove event
                    case 'remove2':
                        ood.confirm(ood.getRes('RAD.designer.confirmdel'), ood.getRes('RAD.action.Do you wanna delete the event handler') + '?', function () {
                            if (isCanvas) {
                                var em = ood.get(page._cls, ['Instance', 'events']);
                                if (!em) ood.set(page._cls, ['Instance', 'events'], em = {});
                                delete em[evtKey];
                                page._canvaseventdirty = true;
                            } else if (target['ood.Module']) {
                                target.events[evtKey] = null;
                                page._dirty = 1;
                            } else {
                                target[evtKey] = null;
                                page._dirty = 1;
                            }
                            grid.removeRows(row);
                        });
                        break;

                    // edit action
                    case 'edit3':
                        ae(page, target, evtKey, cap, selected, null, callback, profile, null);
                        break;
                    // remove action
                    case 'remove3':
                        ood.confirm(ood.getRes('RAD.designer.confirmdel'), ood.getRes('RAD.action.Do you wanna delete the action') + '?', function () {
                            var evs;
                            if (isCanvas) {
                                var em = ood.get(page._cls, ['Instance', 'events']);
                                if (!em) ood.set(page._cls, ['Instance', 'events'], em = {});
                                evs = em[evtKey];
                                var oarr= evs.actions?evs.actions:evs;
                                ood.arr.removeFrom(oarr, selected);
                                page._canvaseventdirty = true;
                            } else if (target['ood.Module']) {
                                evs = target.events[evtKey];
                                var oarr= evs.actions?evs.actions:evs;
                                ood.arr.removeFrom(oarr, selected);
                                page._dirty = 1;
                            } else {
                                evs = target[evtKey];
                                var oarr= evs.actions?evs.actions:evs;
                                ood.arr.removeFrom(oarr, selected);
                                page._dirty = 1;
                            }
                            grid.removeRows(row);
                        });
                        break;
                }
            } else {
                switch (cmdkey) {
                    // add all
                    case 'add':
                        ood.getModule('RAD.EventPicker', function (prf) {
                            this.refreshList(page, "-page");
                            this.setEvents({
                                onSel: function (id, evtKey) {
                                    isCanvas = id === "-page";
                                    target = (isCanvas ? ns._page.canvas : ns._page.$host[id]).get(0);
                                    cap = "$(RAD.action." + (isCanvas ? "Page" : target['ood.Module'] ? "Module" : "Control") + " Action) => " + (isCanvas ? "" : target.alias + " - ") + RAD.EditorTool.getEventName(isCanvas ? 'ood.Module' : target.key, evtKey, true);
                                    ae(page, target, evtKey, cap, null, null, callback, profile, null);
                                }
                            });
                            this.show();
                        });
                }
            }
        }
    }
});
﻿ood.Class('RAD.AnimationConf', 'ood.Module',{
    Instance:{
        iniComponents : function(){
            // [[Code created by ESDUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"ood_ui_dialog1")
                .setLeft("0em")
                .setTop("0em")
                .setWidth("66.66666666666667em")
                .setHeight("46.666666666666664em")
                .setCaption("Animation editor")
                .setMinBtn(false)
                .setModal(true)
            );
            
            host.ood_ui_dialog1.append(
                ood.create("ood.UI.Panel")
                .setHost(host,"ood_ui_panel3")
                .setDock("right")
                .setLeft("40.833333333333336em")
                .setTop("8.333333333333334em")
                .setWidth("18.75em")
                .setCaption("Frame Setting")
                .setBorderType("none")
                );
            
            host.ood_ui_panel3.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ood_ui_block35")
                .setDock("top")
                .setLeft("2.5em")
                .setTop("4.166666666666667em")
                .setHeight("8.25em")
                .setBorderType("none")
                .setOverflow("hidden")
                );
            
            host.ood_ui_block35.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"c_type")
                .setName("type")
                .setShowDirtyMark(false)
                .setLeft("0.8333333333333334em")
                .setTop("0.8333333333333334em")
                .setWidth("16.583333333333332em")
                .setLabelSize("6em")
                .setLabelCaption("Type")
                .setType("listbox")
                .setItems([
                    {
                        "id":"a",
                        "caption":"item 1",
                        "imageClass":"ood-icon-number1"
                    },
                    {
                        "id":"b",
                        "caption":"item 2",
                        "imageClass":"ood-icon-number2"
                    },
                    {
                        "id":"c",
                        "caption":"item 3",
                        "imageClass":"ood-icon-number3"
                    },
                    {
                        "id":"d",
                        "caption":"item 4",
                        "imageClass":"ood-icon-number4",
                        "disabled":true
                    }
                ])
                .setValue("liner")
                .onChange("_c_onchange")
                );
            
            host.ood_ui_block35.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"c_duration")
                .setName("duration")
                .setShowDirtyMark(false)
                .setLeft("0.75em")
                .setTop("3.3333333333333335em")
                .setWidth("16.666666666666668em")
                .setLabelSize("6em")
                .setLabelCaption("Duration")
                .setType("spin")
                .setUnit("ms")
                .setPrecision(0)
                .setIncrement(100)
                .setMin(100)
                .setMax(600000)
                .setValue(200)
                .onChange("_c_onchange")
                );
            
            host.ood_ui_block35.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"c_times")
                .setName("times")
                .setShowDirtyMark(false)
                .setLeft("0.75em")
                .setTop("5.833333333333333em")
                .setLabelSize("6em")
                .setLabelCaption("Times")
                .setType("spin")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(1)
                .setMax(99)
                .setValue(1)
                .onChange("_c_onchange")
                );
            
            host.ood_ui_block35.append(
                ood.create("ood.UI.CheckBox")
                .setHost(host,"c_restore")
                .setName("restore")
                .setShowDirtyMark(false)
                .setLeft("11.166666666666666em")
                .setTop("5.916666666666667em")
                .setWidth("6.25em")
                .setCaption("Restore")
                .onChange("_c_onchange")
                );
            
            host.ood_ui_panel3.append(
                ood.create("ood.UI.TreeGrid")
                .setHost(host,"c_grid")
                .setShowDirtyMark(false)
                .setLeft("0em")
                .setTop("0em")
                .setEditable(true)
                .setRowHandler(false)
                .setHeader([
                    {
                        "id":"key",
                        "caption":"Property",
                        "type":"label",
                        "width":"8em"
                    },
                    {
                        "id":"value",
                        "caption":"Value",
                        "type":"input",
                        "flexSize":true,
                        "width":"8em"
                    }
                ])
                .setActiveMode("none")
                .afterCellUpdated("_c_grid_aftercellupdated")
                );
            
            host.ood_ui_dialog1.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ood_ui_block2")
                .setDock("fill")
                .setDockMargin({
                    "left":0,
                    "top":0,
                    "right":0,
                    "bottom":-1
                })
                .setLeft("12.5em")
                .setTop("15.833333333333334em")
                .setBorderType("inset")
                .setBackground("#FFFFFF")
                );
            
            host.ood_ui_block2.append(
                ood.create("ood.UI.Div")
                .setHost(host,"ood_ui_div13")
                .setDock("origin")
                .setLeft("20em")
                .setTop("7.5em")
                .setWidth("6em")
                .setHeight("6em")
                .setOverflow("visible")
                .setCustomStyle({
                    "KEY":{
                        "background-color":"#FAFAD2",
                        "opacity":0
                    }
                })
                );
            
            host.ood_ui_div13.append(
                ood.create("ood.UI.Div")
                .setHost(host,"c_demo")
                .setClassName("ood-uibar")
                .setLeft("0em")
                .setTop("0em")
                .setWidth("6em")
                .setHeight("6em")
                .setSelectable(false)
                .setHtml("<div style=\"text-align: center;\">&lt; l i n e 1 &gt;</div><div style=\"text-align: center;\">&lt; l i n e 2 &gt;</div><div style=\"text-align: center;\">&lt; l i n e 3 &gt;</div><div style=\"text-align: center;\">&lt; l i n e 4 &gt;</div><div style=\"text-align: center;\">&lt; l i n e 5 &gt;</div>")
                );
            
            host.ood_ui_dialog1.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ood_ui_block14")
                .setDock("bottom")
                .setDockOrder(2)
                .setLeft("44.583333333333336em")
                .setTop("3.75em")
                .setHeight("4.5em")
                .setBorderType("inset")
                .setBackground("#FFFFF0")
                );
            
            host.ood_ui_block14.append(
                ood.create("ood.UI.Icon")
                .setHost(host,"ood_ui_icon1")
                .setTips("Add a frame")
                .setTop("0.75em")
                .setWidth("3.8333333333333335em")
                .setHeight("3.3333333333333335em")
                .setRight("0em")
                .setImageClass("ood-uicmd-add")
                .setIconFontSize("3em")
                .onClick("_ood_ui_icon1_onclick")
                .setCustomStyle({
                    "KEY":{
                        "cursor":"pointer"
                    }
                })
                );
            
            host.ood_ui_block14.append(
                ood.create("ood.UI.Icon")
                .setHost(host,"c_play")
                .setTips("Play the animation")
                .setLeft("0em")
                .setTop("0.75em")
                .setWidth("3.8333333333333335em")
                .setHeight("3.3333333333333335em")
                .setImageClass("ood-uicmd-toggle")
                .setIconFontSize("3em")
                .onClick("_c_play_onclick")
                .setCustomStyle({
                    "KEY":{
                        "cursor":"pointer"
                    }
                })
                );
            
            host.ood_ui_block14.append(
                ood.create("ood.UI.Gallery")
                .setHost(host,"c_gallery")
                .setShowDirtyMark(false)
                .setItems([
                    {
                        "id":"frame1",
                        "caption":"",
                        "imageClass":"ood-icon-number1",
                        "flagText":"",
                        "flagClass":"",
                        "flagStyle":""
                    }
                ])
                .setDock("bottom")
                .setDockMargin({
                    "left":50,
                    "top":0,
                    "right":50,
                    "bottom":0
                })
                .setLeft("10.833333333333334em")
                .setTop("23.333333333333332em")
                .setHeight("4.333333333333333em")
                .setBorderType("none")
                .setIconOnly(true)
                .setIconFontSize("2.5em ")
                .setValue("")
                .onItemSelected("_c_gallery_onitemselected")
                .onFlagClick("_c_gallery_onflagclick")
                .setCustomStyle({
                    "ITEMS":{
                        "overflow":"overflow-x:auto;overflow-y:hidden"
                    }
                })
                );
            
            host.ood_ui_dialog1.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ood_ui_block18")
                .setDock("bottom")
                .setLeft("52.5em")
                .setTop("0em")
                .setHeight("3em")
                .setBorderType("none")
                .setOverflow("hidden")
                );
            
            host.ood_ui_block18.append(
                ood.create("ood.UI.Button")
                .setHost(host,"ctl_ba")
                .setLeft("6.583333333333333em")
                .setTop("0.6666666666666666em")
                .setWidth("6.583333333333333em")
                .setHeight("2em")
                .setCaption("$RAD.designer.attreditor.Apply")
                .onClick("_ctl_ba_onclick")
                );
            
            host.ood_ui_block18.append(
                ood.create("ood.UI.Button")
                .setHost(host,"ctl_bc")
                .setLeft("19.083333333333332em")
                .setTop("0.6666666666666666em")
                .setWidth("6.583333333333333em")
                .setHeight("2em")
                .setCaption("$RAD.designer.attreditor.Cancel")
                .onClick("_ctl_bc_onclick")
                );
            
            return children;
            // ]]Code created by ESDUI RAD Studio
        },
        _c_gallery_onflagclick:function (profile,item,e,src){
            var ns = this, uictrl = profile.boxing(),
                oitem = uictrl.getSelectedItem(),
                items = profile.properties.items;
            if(item.id==oitem.id){
                uictrl.fireItemClickEvent(items[0].id);
            }

            uictrl.removeItems(item.id);
            ns._dirty = 1;

            ood.arr.each(items,function(item, i){
                if(i<1)return;
                uictrl.updateItem(item.id, {"imageClass":"ood-icon-number" + (i+1)});
            });
        },
        setUItoForm:function(frame){
            var ns=this;
            if(frame){
                ns.c_duration.setUIValue(frame.duration||200,true).setDisabled(false);
                ns.c_restore.setUIValue(frame.restore||false,true).setDisabled(false);
                ns.c_times.setUIValue(frame.times||1,true).setDisabled(false);
                ns.c_type.setUIValue(frame.type||"liner",true).setDisabled(false);
            }else{
                ns.c_duration.setValue('',true).setDisabled(true);
                ns.c_restore.setValue(false,true).setDisabled(true);
                ns.c_times.setValue('',true).setDisabled(true);
                ns.c_type.setValue('',true).setDisabled(true);
            }
        },
        getDefaultStatus:function(){
            return {

            };
        },
        addFrame:function(){
            var ns = this,
                gal = ns.c_gallery,
                items = gal.getItems(),
                num = items.length + 1,
                id  = "frame" + ood.rand(),
                frame;
            // 1. copy setting from the previous one 
            frame = ood.clone(items[items.length-1]._frame);
            // If it's first frame, no following setting
            frame = ood.merge(frame, {
                type:'liner',
                times:1,
                duration:200,
                restore:false
            });

            // 2. add to gallery
            gal.insertItems([
                {
                    "id":id,
                    "caption":"",
                    "imageClass":"ood-icon-number" + num,
                    "flagClass":"oodcon ood-uicmd-close",
                    "flagStyle":"margin:0; cursor: default;",
                    _frame:frame
                }
            ]);
            // 3. select the new one
            gal.fireItemClickEvent(id);
        },
        _c_gallery_onitemselected:function (profile, item){
            var ns=this,tg=ns.c_grid;
            ns._currentFrame = item._frame;
            // set this frame's setting to ui
            ns.setUItoForm( item.id=="frame1" ? null :item._frame );

            // status
            var rows=ood.clone(ns._dft_rows);
            ood.arr.each(profile.properties.items,function(ii){
                ood.arr.each(rows,function(row){
                    if(row.id in ii._frame.status){
                        row.cells[1].value = ii._frame.status[row.id];
                    }
                });
                if(ii==item){
                    return false;
                }
            });

            tg.setRows(rows);
            ood.arr.each(rows,function(row){
                ns.resetDemo(row.id, row.cells[1].value, row.cells[1].unit);
            });
        },
        _ood_ui_icon1_onclick:function (profile, e, value){
            var ns = this, uictrl = profile.boxing();
            if(ns.c_gallery.getItems().length >= 9){
                ood.alert("It allowes 9 frames only");
            }else{
                ns.addFrame();
                ns._dirty = 1;
            }
        },
        _ctl_bc_onclick:function (profile, e, src, value){
            this.ood_ui_dialog1.close();
        },
        getAnimFrames:function(){
            var ns = this, 
                conf = [];
            ood.each(ns.c_gallery.getItems(),function(item){
                conf.push(item._frame);
            });
            return conf;
        },
        _ctl_ba_onclick:function (profile, e, src, value){
            var ns = this,
                conf = ns.getAnimFrames();
            ns.fireEvent("onchange",[conf]);
            ns.ood_ui_dialog1.close();
        },
        events:{
            "onRender":"_page_onrender",
            "onReady":"_page_onready"
        },
        _dft_rows:[
            {id:'left',cells:[{id:'left',caption:"$(RAD.custom_dlg.left)"},{
                type:"spin", unit:'em', editorProperties:{
                    precision:1,increment:1, units:'px;em'
                }
            }]},
            {id:'top',cells:[{id:'top',caption:"$(RAD.custom_dlg.top)"},{
                type:"spin", unit:'em', editorProperties:{
                    precision:1,increment:1, units:'px;em'
                }
            }]},
            {id:'width',cells:[{id:'width',caption:"$(RAD.custom_dlg.width)"},{
                type:"spin", unit:'em',editorProperties:{
                    precision:1,increment:1,  units:'px;em'
                }
            }]},
            {id:'height',cells:[{id:'height',caption:"$(RAD.custom_dlg.height)"},{
                type:"spin", unit:'em',editorProperties:{
                    precision:1,increment:1,  units:'px;em'
                }
            }]},
            {id:'opacity',cells:[{id:'opacity',caption:"$RAD.custom_dlg.opacity"},{
                type:"progress", value :1, editorProperties:{
                    min:0,max:1
                }
            }]},
            {id:'rotate',cells:[{id:'rotate',caption:"$(RAD.custom_dlg.rotate)"},{
                type:"spin", unit:'deg', editorProperties:{
                    precision:0,increment:1, min:0,max:360
                }
            }]},
            {id:'translateX',cells:[{id:'translateX',caption:"$(RAD.custom_dlg.translateX)"},{
                type:"spin", editorProperties:{
                    precision:1,increment:1
                }
            }]},
            {id:'translateY',cells:[{id:'translateY',caption:"$(RAD.custom_dlg.translateY)"},{
                type:"spin", editorProperties:{
                    precision:1,increment:1
                }
            }]},
            {id:'scaleX',cells:[{id:'scaleX',value:1,caption:"$(RAD.custom_dlg.scaleX)"},{
                type:"spin", editorProperties:{
                    precision:1,increment:0.1
                }
            }]},
            {id:'scaleY',cells:[{id:'scaleY',value:1,caption:"$(RAD.custom_dlg.scaleY)"},{
                type:"spin", editorProperties:{
                    precision:1,increment:0.1
                }
            }]},
            {id:'skewX',cells:[{id:'skewX',caption:"$(RAD.custom_dlg.skewX)"},{
                type:"spin", unit:'deg', editorProperties:{
                    precision:0,increment:1, min:-180,max:180
                }
            }]},
            {id:'skewY',cells:[{id:'skewY',caption:"$(RAD.custom_dlg.skewY)"},{
                type:"spin", unit:'deg', editorProperties:{
                    precision:0,increment:1, min:-180,max:180
                }
            }]},
            {id:'color',cells:[{id:'color',caption:"$RAD.custom_dlg.color"},{
                type:"color"
            }]},
            {id:'fontSize',cells:[{id:'fontSize',caption:"$(RAD.custom_dlg.font$-size)"},{
                type:"spin", unit:'em', editorProperties:{
                    min:0,max:10,precision:0,increment:1, units:'em;px;pt'
                }
            }]},
            {id:'lineHeight',cells:[{id:'lineHeight',caption:"$(RAD.custom_dlg.line$-height)"},{
                type:"spin", editorProperties:{
                    min:0,max:10,precision:1,increment:0.1
                }
            }]},
            {id:'backgroundColor',cells:[{id:'backgroundColor',caption:"$(RAD.custom_dlg.background$-color)"},{
                type:"color"
            }]},
            {id:'backgroundPositionX',cells:[{id:'backgroundPositionX',caption:"$(RAD.custom_dlg.background$-position$-x)"},{
                type:"spin", unit:'%', editorProperties:{
                    precision:1,increment:1,  units:'px;em;%'
                }
            }]},
            {id:'backgroundPositionY',cells:[{id:'backgroundPositionY',caption:"$(RAD.custom_dlg.background$-position$-y)"},{
                type:"spin", unit:'%', editorProperties:{
                    precision:1,increment:1, units:'px;em;%'
                }
            }]}
        ],
        _page_onready:function(){
            var ns=this;
            ns.c_type.setItems((function(h){
                var arr=[];
                ood.each(h,function(o,i){
                    arr.push({
                        id:i,
                        tips:'<img width=80 height=80 src="/RAD/img/animate/'+i+'.gif" /> '
                    });
                });
                return arr;
            })(ood.Dom.$AnimateEffects));    
        },
        _page_onrender:function (module, threadid){
            var ns=this;
            // ensure frames
            var prop = this.properties, frames=prop.frames;
            
            var h=ns._initedRegion={};
            h.left = ns.c_demo.getLeft();
            h.top = ns.c_demo.getTop();
            h.right = ns.c_demo.getRight();
            h.bottom = ns.c_demo.getBottom();
            h.width = ns.c_demo.getWidth();
            h.height = ns.c_demo.getHeight();

            if(!frames || frames.length===0 || (frames.length===1 && !frames[0].status) ){
                frames = [{status: ns.getDefaultStatus()}];
            }

            // set to gallery
            var items = [];
            ood.arr.each(frames, function(frame, num){
                frame.status = frame.status ||{};
                num += 1;
                if(num===1){
                    frame = {status:frame.status};
                    items.push({
                        "id":'frame' + num,
                        "imageClass":"ood-icon-number" + num,
                        "flagStyle":"margin:0; cursor: default;",
                        _frame:frame
                    });         
                }else{
                    items.push({
                        "id":'frame' + num,
                        "imageClass":"ood-icon-number" + num,
                        "flagClass":"oodcon ood-uicmd-close",
                        "flagStyle":"margin:0; cursor: default;",
                        _frame:frame
                    }); 
                } 
            });
            ns.c_gallery.setItems(items);

            // select the first one
            ns.c_gallery.selectItem("frame1");
        },
        _c_onchange:function (profile, oldValue, newValue, force, tag){
            var ns = this;
            ns._currentFrame[profile.properties.name] = newValue;
        },
        _c_grid_aftercellupdated:function (profile, cell, options, isHotRow){
            var ns = this, 
                obj = ns._currentFrame.status,
                rowId = cell._row.id;
            ns.resetStatus(obj, rowId, cell.value, cell.unit);
            ns.resetDemo(rowId, cell.value, cell.unit);
        },
        resetStatus:function(status, key, value, unit){
            switch(key){
                case 'left':
                case 'top':
                case 'right':
                case 'bottom':
                case 'width':
                case 'height':
                case 'rotate':
                case 'skewX':
                case 'skewY':
                case 'fontSize':
                case 'backgroundPositionX':
                case 'backgroundPositionY':
                    if(ood.isEmpty(value))delete status[key];
                    else status[key]=ood.isSet(value)?(value + (unit||'')):null;
                    break;
                case 'opacity':
                case 'translateX':
                case 'translateY':
                case 'scaleX':
                case 'scaleY':
                case 'lineHeight':
                case 'color':
                case 'backgroundColor':
                    if(ood.isEmpty(value))delete status[key];
                    else status[key]=value;
                    break;
                      }
        },
        _map:{left:1,right:1,top:1,bottom:1,width:1,height:1},
        _get : function(node, ctrl, key, t){
            var ns=this;
            return (ns._map[key] && ctrl && ood.isFun(ctrl[t='get'+ood.str.initial(key)])) ? ns._initedRegion[key] : node[key] ? node[key]() :node.css(key);
        },
        _set : function(node, ctrl, key, value, t){
            var ns=this;
            return (ns._map[key] && ctrl && ood.isFun(ctrl[t='set'+ood.str.initial(key)])) ? ctrl[t](value) : node[key] ? node[key](value) :node.css(key, value);
        },        
        resetDemo:function(key, value, unit){
            var ns=this;
            value = ood.isSet(value)?(value + (unit||'')):'';

            var node=ns.c_demo.getRoot(),
                ctrl=ns.c_demo;
            value  = ns._map[key] ? (value || ns._get(node, ctrl, key)) : value;
            return ns._set(node, ctrl, key, value);
        },
        _c_play_onclick:function (profile, e, value){
            var ns = this, items = ns.c_gallery.getItems();
            ood.Dom.busy("temp_animation");

            ns.c_gallery.selectItem(items[0].id);
            ood.asyRun(function(){
                var anm = new ood.AnimBinder(), i=0;
                anm.setFrames(ns.getAnimFrames());
                anm.beforeFrame(function(p, frame){
                    ns.c_gallery.setUIValue(items[++i].id,true);
                });
                anm.onEnd(function(){
                    // set to the last frame
                    var offset = (items[items.length-1]._frame.restore?1:0);
                    ns.c_gallery.selectItem(items[items.length-1-offset].id);
                    ns._c_gallery_onitemselected(ns.c_gallery.get(0), items[items.length-1 - offset]);
                    ood.Dom.free("temp_animation");
                });
                anm.apply(ns.c_demo.getRoot());
            },200);
        }
    }
});
﻿ood.Class('RAD.EventPicker', 'ood.Module',{
    Instance:{
        iniComponents : function(){
            // [[Code created by ESDUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"ood_ui_dialog1")
                .setLeft("0em")
                .setTop("0em")
                .setWidth("59.166666666666664em")
                .setHeight("33.333333333333336em")
                .setCaption("$(RAD.inter.Event Picker)")
                .setMinBtn(false)
                .setMaxBtn(false)
                .setModal(true)
                .beforeClose("_close")
            );
            
            host.ood_ui_dialog1.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ood_ui_block2")
                .setDock("fill")
                .setLeft("16.666666666666668em")
                .setTop("4.166666666666667em")
                .setBorderType("inset")
                );
            
            host.ood_ui_block2.append(
                ood.create("ood.UI.Layout")
                .setHost(host,"ood_ui_layout3")
                .setItems([
                    {
                        "id":"before",
                        "size":80,
                        "min":10,
                        "locked":false,
                        "folded":false,
                        "hidden":false,
                        "cmd":false,
                        "pos":"before"
                    },
                    {
                        "id":"main",
                        "size":120,
                        "min":10
                    },
                    {
                        "id":"after",
                        "size":80,
                        "min":10,
                        "locked":false,
                        "folded":false,
                        "hidden":true,
                        "cmd":false,
                        "pos":"after"
                    }
                ])
                .setLeft("0em")
                .setTop("0em")
                .setType("horizontal")
                .setFlexSize(true)
                );
            
            host.ood_ui_layout3.append(
                ood.create("ood.UI.List")
                .setHost(host,"list_all")
                .setDirtyMark(false)
                .setDock("fill")
                .setLeft("3.3333333333333335em")
                .setTop("1.6666666666666667em")
                .setWidth("26.666666666666668em")
                .setBorderType("none")
                .setLabelSize("8.333333333333334em")
                .setLabelPos("none")
                .onItemSelected("_list_all_onitemselected")
                , "before");
            
            host.ood_ui_layout3.append(
                ood.create("ood.UI.TreeBar")
                .setHost(host,"event_all")
                .setDirtyMark(false)
                .setLeft("0em")
                .setTop("0em")
                .setSelMode("none")
                .onItemSelected("_event_all_onitemselected")
                , "main");
            
            host.ood_ui_layout3.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"filter1")
                .setDirtyMark(false)
                .setDock("top")
                .setDockMargin({
                    "left":0,
                    "top":0,
                    "right":0,
                    "bottom":4
                })
                .setTips("$(RAD.designer.tool.Filter) ")
                .setHeight("4.25em")
                .setDynCheck(true)
                .setLabelSize("2em")
                .setLabelPos("top")
                .setLabelCaption("$(RAD.inter.Select the target Modue or Control)")
                .setLabelHAlign("center")
                .setType("input")
                .setImageClass("ood-icon-filter")
                .setCommandBtn("delete")
                .onChange("_propFilter_onchange")
                .onCommand("_propFilter_oncmd")
                .setCustomClass({
                    "KEY":"ood-uibar"
                })
                , "before");
            
            host.ood_ui_layout3.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"filter2")
                .setDirtyMark(false)
                .setDock("top")
                .setDockMargin({
                    "left":0,
                    "top":0,
                    "right":0,
                    "bottom":4
                })
                .setTips("$(RAD.designer.tool.Filter) ")
                .setHeight("4.25em")
                .setDynCheck(true)
                .setLabelSize("2em")
                .setLabelPos("top")
                .setLabelCaption("$(RAD.inter.Pick the target event)")
                .setLabelHAlign("center")
                .setType("input")
                .setImageClass("ood-icon-filter")
                .setCommandBtn("delete")
                .onChange("_propFilter2_onchange")
                .onCommand("_propFilter2_oncmd")
                .setCustomClass({
                    "KEY":"ood-uibar"
                })
                , "main");
            
            return children;
            // ]]Code created by ESDUI RAD Studio
        },
        events:{onRender:'_onrender'},
        _onrender:function(){
            var ns=this;
            if(ns._alias)
                ns.list_all.selectItem(ns._alias);
        },
        refreshList:function(page, alias){
            var ns=this;
            ns._alias=alias;

            //get items
            var items=[], moduleHash={},
                getCap=function(profile){
                    var prop=profile.properties,
                        type = (profile['ood.Module'] || profile.moduleClass) ?"module":"control", 
                        cls = profile.key.split(".").pop(),
                        cap;
                     if(type=="module"){
                        cap = "$(RAD.action.Module) - " + profile.getAlias() + " ( "+ profile.key +" )";
                    }else{
                        cap = "$(RAD.action.Control) - " + profile.alias + " ( "+cls+" )";
                        if(prop.name || prop.desc)cap += " <br />[ " + (prop.name ||"") + (prop.name?" - ":"") + (prop.desc||"")  +" ]";
                        if(prop.caption||prop.labelCaption) cap += " [ "+  (prop.caption||prop.labelCaption)  +" ]";
                    }
                    return cap;
                },
                fun = function(profile, items, map, layer){
                    if((page.$inplaceEditor&&page.$inplaceEditor.get(0))==profile)
                        return;
                    var type = profile.moduleClass?"module":"control", 
                          key = type=="module"?"ood.Module":profile.box.KEY,
                          z;
                    ++layer;
                    if(type=="module"){
                        /// get the top module only
                        profile = profile.getModule(true);
                        if(moduleHash[z = profile.KEY+"["+profile.$xid+"]"])return;
                        moduleHash[z] = 1;
                    }
                    var self=arguments.callee,
                        t = map[key],
                        item = {
                            id:layer==1?"-page":profile.alias, 
                            type:type,
                            target:layer==1?(new ood.Module):profile,
                            itemStyle:"padding-left:"+(layer-1)*2+"em;",
                            imageClass: layer==1?"oodcon spafont spa-icon-page":t&&t.imageClass||'',
                            tag: layer==1?"page":getCap(profile).replace(/\<[^>]+\>/g,''),
                            caption: layer==1?"$(RAD.action.var.Current Page)":getCap(profile)
                        };
                    items.push(item);
                    if(type=="module"){
                        return ;
                    }
                    if(profile.children && profile.children.length){
                        ood.arr.each(profile.children,function(o){
                            self.call(null, o[0], items, map, layer);
                        });
                    }
                };
            fun(page.canvas.get(0), items, CONF.mapWidgets, 0);
            
            ns.list_all.setItems(items);
        },
        _propFilter_oncmd:function(){
            this._propFilter1_("");
        },
        _propFilter_onchange:function(profile, oldValue, newValue){
            ood.resetRun('_propFilter1_',this._propFilter1_,500,[newValue],this);
        },
        _propFilter1_:function(newValue){
            var  v=this.list_all.getValue();
            this.list_all.doFilter(newValue ? function(item){
                if(v==item.id)return false;
                 var reg = new RegExp(newValue||"",'i');
                  return !reg.test(item.tag);
            } : null);
        },
        _propFilter2_oncmd:function(){
            this._propFilter2_("");
        },
        _propFilter2_onchange:function(profile, oldValue, newValue){
            ood.resetRun('_propFilter2_',this._propFilter2_,500,[newValue],this);
        },
        _propFilter2_:function(newValue){
            this.event_all.doFilter(newValue ? function(item){
                 var reg = new RegExp(newValue||"",'i');
                  return !reg.test(item.caption);
            } : null);
        },
        _list_all_onitemselected:function (profile, item, e, src, type){
            var ns = this, uictrl = profile.boxing(),
                target = item.target,
                isCanvas = item.id=='-page',
                arr=[];
            ood.each(isCanvas?ood.Module.$EventHandlers : target.box.$EventHandlers,function(o,i){
                if(i.charAt(0)=="_")return;
                if(CONF.widgets_hiddenEvents[i])return;
                if(ood.get(CONF.widgets_hiddenEvents,[target.box.KEY, i]))return;
                if(CONF.widgets_hiddenEvents_filter && false===CONF.widgets_hiddenEvents_filter(target.box.KEY, i)) return;

                var preName = i.charAt(0)=='b'?"$(RAD.designer.eventbfrtag)":
                            i.charAt(0)=='a'?"$(RAD.designer.eventafttag)":
                            "$(RAD.designer.eventontag)",
                    ic = RAD.EditorTool.getEventName(isCanvas?'ood.Module':target.key, i, true);

                arr.push( {
                        id: i, 
                        caption: preName + ic + " - <span style='color:#888;font-style: italic;font-weight:normal;'>" + (ood.get(RAD.EditorTool.getDoc(target.box.KEY+".prototype."+i,null,true),["$desc"])||"").split('.')[0]  + '</span>'
                    });
            });

 
            var arrCat=[],a;
            ood.arr.each(CONF.widgets_events_cat,function(sub){
                a=[];
                ood.arr.each(sub.items,function(id, k){
                    if((k=ood.arr.subIndexOf(arr, 'id', id)) != -1){
                        a.push(arr[k]);
                        arr[k]=null;
                    }
                });
                if(a.length)
                    arrCat.push({
                        id:"sub:"+sub.id,
                        caption:"<span style='font-weight:normal'>$(RAD.designer.conf.propcat."+sub.id+")</span>",
                        group:true,
                        initFold:false,
                        cellStyle:'font-weight:normal',
                        sub: a
                    });
            });
            ood.filter(arr,function(o){
                return !!o;
            });
            if(arr.length){
                ood.arr.stableSort(arr,function(x,y){
                    return x.id>y.id?1:-1;
                });
                arrCat.push({
                    id:"sub:featured",
                    caption:"<span style='font-weight:normal'>$(RAD.designer.conf.propcat.Featured Events)</span>",
                    group:true,
                    initFold:false,
                    sub: arr
                });
                if(arrCat.length>=2){
                    var a = arrCat[arrCat.length-1];
                    arrCat[arrCat.length-1] = arrCat[arrCat.length-2];
                    arrCat[arrCat.length-2] = a;
                }
            }
            ns.event_all.setItems(arrCat);
        },
        _event_all_onitemselected:function (profile, item, e, src, type){
            var ns = this, uictrl = profile.boxing(),
                v1 = ns.list_all.getValue(),
                v2 = item.id;
            ns.fireEvent("onSel", [v1, v2]);
            ns.ood_ui_dialog1.close();
        }
    }
});
ood.Class('RAD.SVGCustomDecoration', 'ood.Module',{
    Instance:{
        initialize : function(){
            this.autoDestroy = true;
            this.properties = {};
        },
        iniComponents : function(){
            // [[Code created by ESDUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"dialog")
                .setLeft("13.125em")
                .setTop("1.25em")
                .setWidth("21.75em")
                .setHeight("36.25em")
                .setResizer(false)
                .setCaption("$(RAD.custom_dlg.Custom Decoration)")
                .setMinBtn(false)
                .setMaxBtn(false)
                .setOverflow("visible")
                .beforeClose("_dialog_beforeclose")
            );
            
            host.dialog.append(
                ood.create("ood.UI.Group")
                .setHost(host,"grpNodes")
                .setLeft("0em")
                .setTop("0.25em")
                .setWidth("20.916666666666668em")
                .setHeight("10.5em")
                .setCaption("grpNodes")
                .setToggleBtn(false)
                );
            
            host.grpNodes.append(
                ood.create("ood.UI.TreeView")
                .setHost(host,"tv")
                .setDirtyMark(false)
                .onItemSelected("_tv_onitemselected")
                .setCustomStyle({
                    "BOX":"background-color:transparent;"
                })
                );
            
            host.dialog.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ctl_block3")
                .setLeft("0em")
                .setTop("12.75em")
                .setWidth("20.916666666666668em")
                .setHeight("20em")
                .setBorderType("inset")
                .setBackground("#fff")
                );
            
            host.ctl_block3.append(
                ood.create("ood.UI.TreeGrid")
                .setHost(host,"tg")
                .setDirtyMark(false)
                .setRowHandler(false)
                .setColSortable(false)
                .setHeader([{
                    "id":"key",
                    "width":"7.5em",
                    "type":"label",
                    "caption":"$RAD.custom_dlg.Attribute"
                },
                {
                    "id":"value",
                    "editable":true,
                    "width":"11.166666666666666em",
                    "type":"input",
                    "caption":"$RAD.custom_dlg.Value"
                }])
                .afterCellUpdated("_tg_aftercellupdated")
                .beforeComboPop("_tg_beforeComboPop")
                .setCustomStyle({
                    "SCROLL":"overflow-x:hidden;overflow-y:auto;"
                })
                );
            
            host.dialog.append(
                ood.create("ood.UI.Input")
                .setHost(host,"ctl_input1")
                .setReadonly(true)
                .setLeft("0em")
                .setTop("10.833333333333334em")
                .setWidth("20.916666666666668em")
                .setHeight("1.8333333333333333em")
                );
            
            return children;
            // ]]Code created by ESDUI RAD Studio
        },
        customAppend : function(parent, subId, left, top){
             var ns=this,
                prop=ns.properties;

            ns.setTargetProfile(prop.targetProfile);
                        
            ood("body").append(ns.dialog);
            ns.dialog.getRoot()
            .popToTop(ood(prop.src), 2)
            .setBlurTrigger("RAD.SVGCustomDecoration",function(){
                ns.dialog.close();
            });
            
            ns.dialog.activate();

            return true;
        },
        setTargetProfile:function(profile){
            var ns=this,items=[],rootItem,
                tagName,hash,item;
            ns.$target = profile;

            tagName =  profile.box.$tagName.KEY;
            items.push(rootItem={
                id:"KEY",
                caption:"ROOT" + " ["+tagName+"]",
                tagName:tagName,
                imageClass:'ri ri-git-branch-line',
                sub:[]
            });
            
            hash=profile.properties.attr;
            if(hash.KEY&&ood.isHash(hash.KEY)){
                for(var i in hash){
                    if(i!=="KEY"){
                        tagName = profile.box.$tagName[i]|| i.split("_")[0].toLowerCase();
                        item={
                            id:i,
                            caption:i+" ["+tagName+"]",
                            tagName:tagName,
                            imageClass:'ri ri-git-branch-line'
                        };
                        rootItem.sub.push(item);
                    }
                }
            }
            if(!rootItem.sub.length)
                delete rootItem.sub;

            ns.grpNodes.setCaption(profile.key.slice(profile.key.lastIndexOf('.')+1) +" : "+profile.alias +" $RAD.custom_dlg.Nodes");
            ns.tv.setTagVar(profile);
            ns.tv.setItems(items);

            ns.tg.setDisabled(true);
            ns.ctl_input1.setValue("");

            ns.tv.toggleNode('KEY', true, true);
            ns.tv.fireItemClickEvent('KEY');            
        },
        _tv_onitemselected : function (profile, item, e) {
            var ns = this,
                ignorelist={href:1,target:1,'letter-spacing':1, blur:1, font:1/*, cx:1, cy:1, x:1, y:1, width:1, height:1*/},
                prf=profile.boxing().getTagVar(),
                rows=[],
                getDftValue=function(tagName, key){
                    if(tagName=='text'){
                        if(key=='stroke') return "none";
                        if(key=='fill') return "#000";
                    }
                    return Raphael._availableAttrs[key];
                };
            
            ns.tg.removeAllRows().setDisabled(false);
                        
            var node=prf.getSubNode(item.id), attr=prf.boxing().getAttr(item.id);

            if(node=node.get(0)){
                var nodeText = "<"+node.tagName+" id='"+node.id+"' style='"+ood(node).attr('style')+"'>";
                ns.ctl_input1.setValue(nodeText).setTips(nodeText.replace(/</,'&lt;'));                            
            }else
                ns.ctl_input1.setValue("").setTips("");

            ood.each(ood.svg.$attr[item.tagName],function(v,k){
                if(ignorelist[k])
                    return;
                switch(item.tagName){
                case "text":
                    if( k=='arrow-start' 
                        || k=='arrow-end' 
                        || k=="stroke-dasharray"
                        || k=="stroke-linecap"
                        || k=="stroke-linejoin"
                        || k=="stroke-miterlimit"
                        || k=="stroke-opacity"
                        || k=="stroke-width")
                        return;
                    if( prf.box["ood.svg.absComb"] &&  (k=='transform'||k=='text-anchor') )
                        return;
                    break;
                case "rect":
                case "circle":
                case "ellipse":
                case "image":
                    if( k=='arrow-start' 
                        || k=='arrow-end')
                        return;
                break;
                }                
                
                var row=null,
                    dftV = (k in attr)?attr[k]:getDftValue(item.tagName,k);
                switch(k){
                    case "arrow-end":
                        row={id:k,cells:[{id:k,caption:"$(RAD.custom_dlg.arrow$-end)"},{
                            type:"popbox", value: dftV || ""
                        }]};
                    break;
                    case "arrow-start":
                        row={id:k,cells:[{id:k,caption:"$(RAD.custom_dlg.arrow$-start)" },{
                            type:"popbox" , value: dftV || ""
                        }]};
                    break;
                    case "fill":
// add gradient after fill
                        row={id:k,cells:[{id:k,caption:"$RAD.custom_dlg."+k },{
                            type:"popbox", value: dftV||""
                        }]};
                    break;
                    case "stroke":
                        row={id:k,cells:[{id:k,caption:"$RAD.custom_dlg."+k },{
                            type:"color", value: dftV||""
                        }]};
                    break;
                    case "font-family":
                        row={id:k,cells:[{id:k,caption:"$(RAD.custom_dlg."+k.replace(/-/g,"$-")+")" },{
                            type:"helpinput", editorListItems:CONF.designer_data_fontfamily, value: dftV||""
                        }]};
                    break;
                    case "font-size":
                        row={id:k,cells:[{id:k,caption:"$(RAD.custom_dlg."+k.replace(/-/g,"$-")+")" },{
                            type:"combobox", editorListItems:CONF.designer_data_fontsize, value: dftV||""
                        }]};
                    break;
                    case "font-style":
                        row={id:k,cells:[{id:k,caption:"$(RAD.custom_dlg."+k.replace(/-/g,"$-")+")" },{
                            type:"combobox", editorListItems:CONF.designer_data_fontstyle, value: dftV||""
                        }]};
                    break;
                    case "font-weight":
                        row = {id:k,cells:[{id:k,caption:"$(RAD.custom_dlg."+k.replace(/-/g,"$-") +")" },{
                            type:"combobox", editorListItems:CONF.designer_data_fontweight, value: dftV||""
                        }]};
                    break;
                    case "opacity":
                    case "stroke-opacity":
                    case "fill-opacity":
                        row = {id:k,cells:[{id:k,caption:"$(RAD.custom_dlg."+k.replace(/-/g,"$-")+")" },{
                            type:"progress", editorProperties:{
                                min:0,max:1
                            },
                            value : (parseFloat(dftV)||parseFloat(dftV)===0)?dftV:1
                        }]};
                    break;
                    case "src":
                        row  = {id:k,cells:[{id:k,caption:"$RAD.custom_dlg."+k },{
                            value: dftV||"",
                            type:CONF.getClientMode() == 'singlepage'?"input":"popbox",
                            event :  function(profile, cell,editorprf){
                                var node = profile.getSubNode('CELL', cell._serialId),
                                    _cb = function(path){
                                        editorprf.boxing().setUIValue(CONF.adjustRelativePath(path));
                                        node.focus();
                                    };
                                if(window.SPA && false===SPA.fe("beforeURISelectorPop", 
                                ['src', cell.value, _cb,
                                    'RAD.SVGCustomDecoration',ns.$target.boxing(),node.get(0), cell, profile.boxing(), editorprf&&editorprf.boxing()
                                ] ))return;
                                if(CONF.getClientMode() !='singlepage'){
                                    ood.ComFactory.getCom('RAD.ImageSelector',function(){
                                        this.setProperties({
                                                fromRegion:node.cssRegion(true),
                                                onOK:function(obj, path){
                                                    _cb(path);
                                                }
                                        });
                                        this.show();
                                    });
                                }
                            }
                    }]};
                    break;
                    break;
                    case "path":
                    case "text":
                        row  = {id:k,cells:[{id:k,caption:"$RAD.custom_dlg."+k },{
                            type:"textarea", value: dftV||""
                        }]};
                    break;

                    case "cx":
                    case "cy":
                    case "x":
                    case "y":
                    case "width":
                    case "height":
                    case "r":
                    case "rx":
                    case "ry":
                    case "stroke-width":
                        row  = {id:k,cells:[{id:k,caption:"$(RAD.custom_dlg."+k.replace(/-/g,"$-")+")"},{
                            type:"spin", increment:1, precision:0, min:0, value: dftV||0
                        }]};
                     break;
                    case "stroke-miterlimit":
                        row  = {id:k,cells:[{id:k,caption:"$(RAD.custom_dlg.stroke$-miterlimit)"},{
                            type:"spin", increment:1, precision:0, min:0, value: dftV||0
                        }]};
                    break;
                    case "stroke-dasharray":
                        row = {id:k,cells:[{id:k,caption:"$(RAD.custom_dlg.stroke$-dasharray)"},{
                        type:"combobox", editorListItems:CONF.designer_data_strokedasharray, value: dftV||""
                        }]};
                    break;
                    case "stroke-linecap":
                        row = {id:k,cells:[{id:k,caption:"$(RAD.custom_dlg.stroke$-linecap)"},{
                            type:"listbox", editorListItems:CONF.designer_data_strokelinecap, value: dftV||""
                        }]};
                    break;
                    case "stroke-linejoin":
                        row = {id:k,cells:[{id:k,caption:"$(RAD.custom_dlg.stroke$-linejoin)" },{
                            type:"listbox", editorListItems:CONF.designer_data_strokelinejoin, value: dftV||""
                        }]};
                    break;
                    case "text-anchor":
                        row  = {id:k,cells:[{id:k,caption:"$(RAD.custom_dlg.text$-anchor)"},{
                            type:"listbox", editorListItems:CONF.designer_data_textalign
                        }]};
                    break;
                    case "transform":
                        row={id:k,cells:[{id:k,caption:"$RAD.custom_dlg."+k },{
                            type:"popbox", value: dftV||""
                        }]};
                    break;
                    case "cursor":
                        row={id:k,cells:[{id:k,caption:"$RAD.custom_dlg."+k },{
                            type:"combobox", editorListItems:CONF.designer_data_cursor, value: dftV || ""
                        }]};
                    break;
                    case "title":
                        row  = {id:k,cells:[{id:k,caption:"$RAD.custom_dlg."+k },{
                            type:"input", value: dftV||""
                        }]};
                    break;
                }
                if(row){
                    rows.push(row);
                }
            });

            // Give a chance to modify editor setting for rows
            window.SPA && SPA.fe("onInitEditorRows", ['attr', item.tagName, ns.$target.properties.attr, 
                'RAD.SVGCustomDecoration', ns.$target,  rows, ns.tg]);

            if(window.SPA && SPA.events.onInitPropValueCell){
                ood.arr.each(rows,function(row){
                    ood.arr.each(row.cells,function(cell,i){
                         // Give a chance to modify editor setting for value cell
                        window.SPA && SPA.fe("onInitPropValueCell", ['attr', item.tagName, cell.value, "RAD.SVGCustomDecoration", ns.$target, cell, ns.tg] );
                    });
                });
            }
            ns.tg.setRows(rows).setTag(item.tagName);
 
            profile.boxing().setTag(item.id);
        },
        _ctl_sbutton1_onclick : function (profile) {
            this.setTargetProfile(this.ctl_panel3.get(0));
        },
        _ctl_sbutton37_onclick : function (profile, e, src, value) {
            this.setTargetProfile(this.ctl_tabs2.get(0));
        },
        _dialog_beforeclose : function (profile) {
            this.dialog.getRoot().setBlurTrigger("RAD.SVGCustomDecoration");
            profile.boxing().hide();
            this.tv.setValue(null,true);
            this.fireEvent('onFinished');
            return false;
        },
        _tg_beforeComboPop:function(profile, cell, pro, pos, e, src){
            var ns=this,
                prf=ns.tv.getTagVar(),
                tplKey=ns.tv.getTag(),
                cls,onChange;
            
            if(window.SPA && false===SPA.fe("beforeEditorComboPop", [
                'attr:'+tplKey,cell._row.id, cell.value, function(value){
                    editorprf.boxing().setUIValue(value||"",true);
                }, "RAD.SVGCustomDecoration", ns.properties.targetProfile.boxing(), pos, profile.getSubNode('CELL', cell._serialId).get(0), cell, ns.tg ,pro&&pro.boxing()
                ] ))return false;

            switch(cell._row.id){
                case "arrow-start":
                    cls="RAD.CustomArrows";
                    onChange = function(str){
                        var pro=this.properties.pro,
                            grid=ns.tg,
                            start=str[0]&&str[0].split('-'),
                            end=str[1]&&str[1].split('-'),
                            cell;

                        if(start[0]=='none')str[0]="none";
                        cell=grid.getCellbyRowCol("arrow-start","value");
                        if(cell)grid.updateCell(cell,{value:str[0]},false,true);

                        if(end[0]=='none')str[1]="none";
                        cell=grid.getCellbyRowCol("arrow-end","value");
                        if(cell)grid.updateCell(cell,{value:str[1]},false,true);
                        
                        if(!pro.destroyed)pro.boxing().setValue(str[0],true);
                    }
                    break;                    
                case "arrow-end":
                    cls="RAD.CustomArrows";
                    onChange = function(str){
                        var pro=this.properties.pro,
                            grid=ns.tg,
                            start=str[0]&&str[0].split('-'),
                            end=str[1]&&str[1].split('-'),
                            cell;
                        
                        if(start[0]=='none')str[0]="none";
                        cell=grid.getCellbyRowCol("arrow-start","value");
                        if(cell)grid.updateCell(cell,{value:str[0]},false,true);

                        if(end[0]=='none')str[1]="none";
                        cell=grid.getCellbyRowCol("arrow-end","value");
                        if(cell)grid.updateCell(cell,{value:str[1]},false,true);

                        if(!pro.destroyed)pro.boxing().setValue(str[1],true);
                    }
                    break;
                case "transform":
                    cls="RAD.CustomTransform";
                    onChange = function(str){
                        var pro=this.properties.pro,
                            cell=this.properties.cell;

                        if(!pro.destroyed)pro.boxing().setValue(ood.isStr(str)?str:"[object]",true);
                        profile.boxing().updateCell(cell,{value:str},false,true);
                    }
                    break;
                case "fill":
                    cls="RAD.SVGCustomGradients";
                    onChange = function(str){
                        var pro=this.properties.pro,
                            cell=this.properties.cell;

                        if(!pro.destroyed)pro.boxing().setValue(ood.isStr(str)?str:"[object]",true);
                        profile.boxing().updateCell(cell,{value:str},false,true);
                    }
                    break;
            }
            if(cls){
                ood.ComFactory.getCom(cls,function(){
                    this.init(prf,tplKey,{
                        pro:pro,
                        cell:cell,
                        grid:ns.tg,
                        isSvg:1
                    });
                    this.setEvents({
                        onChange:onChange
                    });
                    this.render();
                    var r=this.mainPane.getRoot();
                    r.popToTop(pro.getRoot());
                    r.setBlurTrigger(r.$xid, function(){
                        r.setBlurTrigger(r.$xid);
                        r.hide();
                    });
                });
            }
        },
        _tg_aftercellupdated : function (profile, cell, options) {
            var map={"path":1,"text":1,"cx":1,"cy":1,"x":1,"y":1,"width":1,"height":1,"r":1,"rx":1,"ry":1,"stroke-width":1};
            if("value" in options){
                var ns=this,
                    prf=ns.tv.getTagVar(),
                    hash={},
                    tplKey=ns.tv.getTag();
                if(prf && tplKey){
                    hash[cell._row.id]=options.value;
                    prf.boxing().setAttr(tplKey, hash, false);
                    ns.fireEvent('onDirty',[map[cell._row.id]]);
                }
            }
        }
    }
});
﻿// The default code is a com class (inherited from ood.Com)
ood.Class('RAD.SVGCustomGradients', 'ood.Module',{
    Instance:{
        iniComponents : function(){
            // [[Code created by EUSUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"mainPane")
                .setLeft("4.375em")
                .setTop("1.875em")
                .setWidth("32.25em")
                .setHeight("28.083333333333332em")
                .setShadow(false)
                .setResizer(false)
                .setCaption("$(RAD.custom_dlg.gradlg.Custom Fill)")
                .setMinBtn(false)
                .setMaxBtn(false)
                .setOverflow("hidden")
                .beforeClose("_ctl_panel4_beforeclose")
            );
            
            host.mainPane.append(
                ood.create("ood.UI.Block")
                .setHost(host,"bg")
                .setDock("fill")
                .setBorderType("inset")
                .setOverflow("hidden")
                );
            
            host.bg.append(
                ood.create("ood.UI.Group")
                .setHost(host,"ctl_group11")
                .setLeft("1.6666666666666667em")
                .setTop("0.75em")
                .setWidth("28.333333333333332em")
                .setHeight("4.916666666666667em")
                .setOverflow("hidden")
                .setCaption("$(RAD.custom_dlg.Color Patterns)")
                .setToggleBtn(false)
                .setCustomStyle({
                    "PANEL":"padding:2px;"
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr1")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#4ba3cc"
                            },
                            {
                                "pos":"50%",
                                "clr":"#3289B2"
                            },
                            {
                                "pos":"100%",
                                "clr":"#3899C6"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr2")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#A5B8DA"
                            },
                            {
                                "pos":"50%",
                                "clr":"#7089B3"
                            },
                            {
                                "pos":"100%",
                                "clr":"#819bcb"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr3")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#ffd65e"
                            },
                            {
                                "pos":"50%",
                                "clr":"#febf04"
                            },
                            {
                                "pos":"100%",
                                "clr":"#ffc926"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr4")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#606c88"
                            },
                            {
                                "pos":"50%",
                                "clr":"#3f4c6b"
                            },
                            {
                                "pos":"100%",
                                "clr":"#4b546a"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr5")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#d5cea6"
                            },
                            {
                                "pos":"50%",
                                "clr":"#b7ad70"
                            },
                            {
                                "pos":"100%",
                                "clr":"#c5bb83"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr6")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#a90329"
                            },
                            {
                                "pos":"50%",
                                "clr":"#6d0019"
                            },
                            {
                                "pos":"100%",
                                "clr":"#77021d"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr7")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#4ba614"
                            },
                            {
                                "pos":"50%",
                                "clr":"#008c00"
                            },
                            {
                                "pos":"100%",
                                "clr":"#36780f"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"clr8")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#ff5db1"
                            },
                            {
                                "pos":"50%",
                                "clr":"#ef007c"
                            },
                            {
                                "pos":"100%",
                                "clr":"#ff2a98"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span500")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#7d7e7d"
                            },
                            {
                                "pos":"50%",
                                "clr":"#0e0e0e"
                            },
                            {
                                "pos":"100%",
                                "clr":"#819bcb"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span501")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#cef8ff"
                            },
                            {
                                "pos":"50%",
                                "clr":"#7fe0f8"
                            },
                            {
                                "pos":"100%",
                                "clr":"#9bf1ff"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span502")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#f2f9fe"
                            },
                            {
                                "pos":"50%",
                                "clr":"#d6f0fd"
                            },
                            {
                                "pos":"100%",
                                "clr":"#c3e3fa"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span503")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#fb83fa"
                            },
                            {
                                "pos":"50%",
                                "clr":"#e93cec"
                            },
                            {
                                "pos":"100%",
                                "clr":"#f952f8"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span504")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#3093c7"
                            },
                            {
                                "pos":"50%",
                                "clr":"#1c5a85"
                            },
                            {
                                "pos":"100%",
                                "clr":"#26759e"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span505")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#a9db80"
                            },
                            {
                                "pos":"50%",
                                "clr":"#96c56f"
                            },
                            {
                                "pos":"100%",
                                "clr":"#8ed058"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span506")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#A5B8DA"
                            },
                            {
                                "pos":"50%",
                                "clr":"#7089B3"
                            },
                            {
                                "pos":"100%",
                                "clr":"#819bcb"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span507")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#b29af8"
                            },
                            {
                                "pos":"50%",
                                "clr":"#9174ed"
                            },
                            {
                                "pos":"100%",
                                "clr":"#8e6af5"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span508")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#f2f5f6"
                            },
                            {
                                "pos":"50%",
                                "clr":"#c8d7dc"
                            },
                            {
                                "pos":"100%",
                                "clr":"#d4dee1"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span509")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#ffc579"
                            },
                            {
                                "pos":"50%",
                                "clr":"#fb9d23"
                            },
                            {
                                "pos":"100%",
                                "clr":"#ffaf46"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span510")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#d3d3d3"
                            },
                            {
                                "pos":"50%",
                                "clr":"#707070"
                            },
                            {
                                "pos":"100%",
                                "clr":"#bababa"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span511")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#fcfac0"
                            },
                            {
                                "pos":"50%",
                                "clr":"#f6f283"
                            },
                            {
                                "pos":"100%",
                                "clr":"#faf68f"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span512")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#f4f5f5"
                            },
                            {
                                "pos":"50%",
                                "clr":"#dfdddd"
                            },
                            {
                                "pos":"100%",
                                "clr":"#d9dddd"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span513")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#f7e3e3"
                            },
                            {
                                "pos":"50%",
                                "clr":"#ffd7d7"
                            },
                            {
                                "pos":"100%",
                                "clr":"#ecbbbb"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span514")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#ff9a9a"
                            },
                            {
                                "pos":"50%",
                                "clr":"#ff4040"
                            },
                            {
                                "pos":"100%",
                                "clr":"#ff6767"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span515")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#a9a588"
                            },
                            {
                                "pos":"50%",
                                "clr":"#8e865b"
                            },
                            {
                                "pos":"100%",
                                "clr":"#938e6b"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span516")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#f62b2b"
                            },
                            {
                                "pos":"50%",
                                "clr":"#d20202"
                            },
                            {
                                "pos":"100%",
                                "clr":"#e40a0a"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span517")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#a67939"
                            },
                            {
                                "pos":"50%",
                                "clr":"#845108"
                            },
                            {
                                "pos":"100%",
                                "clr":"#805d2c"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span518")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#d2d2f9"
                            },
                            {
                                "pos":"50%",
                                "clr":"#a6a6f2"
                            },
                            {
                                "pos":"100%",
                                "clr":"#a5a5f3"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span519")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#49c0f0"
                            },
                            {
                                "pos":"50%",
                                "clr":"#2cafe3"
                            },
                            {
                                "pos":"100%",
                                "clr":"#1ab0ec"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span520")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#cedce7"
                            },
                            {
                                "pos":"50%",
                                "clr":"#596a72"
                            },
                            {
                                "pos":"100%",
                                "clr":"#acc4d6"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span521")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#b6e026"
                            },
                            {
                                "pos":"50%",
                                "clr":"#abdc28"
                            },
                            {
                                "pos":"100%",
                                "clr":"#95b91a"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span522")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#eab92d"
                            },
                            {
                                "pos":"50%",
                                "clr":"#c79810"
                            },
                            {
                                "pos":"100%",
                                "clr":"#cf9f15"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span523")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#45484d"
                            },
                            {
                                "pos":"50%",
                                "clr":"#000"
                            },
                            {
                                "pos":"100%",
                                "clr":"#819bcb"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span524")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#6bbed2"
                            },
                            {
                                "pos":"50%",
                                "clr":"#76bdd1"
                            },
                            {
                                "pos":"100%",
                                "clr":"#6bbed2"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.ctl_group11.append(
                ood.create("ood.UI.Span")
                .setHost(host,"ctl_span525")
                .setWidth("1.25em")
                .setHeight("1.25em")
                .setPosition("relative")
                .onClick("_clrpatternclicked")
                .setCustomStyle({
                    "KEY":{
                        "margin":"2px",
                        "cursor":"pointer",
                        "border-radius":"2px",
                        "$gradient":{
                            "stops":[{
                                "pos":"0%",
                                "clr":"#6bbed2"
                            },
                            {
                                "pos":"50%",
                                "clr":"#23538a"
                            },
                            {
                                "pos":"100%",
                                "clr":"#82bbd1"
                            }],
                            "type":"linear",
                            "orient":"T"
                        }
                    }
                }
                )
                );
            
            host.bg.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ctl_block7")
                .setLeft("0.5em")
                .setTop("14.75em")
                .setWidth("29.5em")
                .setHeight("9.166666666666666em")
                .setBorderType("inset")
                .setOverflow("hidden")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.Slider")
                .setHost(host,"g_step1")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("5.833333333333333em")
                .setTop("0.4166666666666667em")
                .setWidth("14.375em")
                .setHeight("1.875em")
                .setSteps(100)
                .setIsRange(false)
                .setValue("0")
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"g_step1clr")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("20.833333333333332em")
                .setTop("0.4166666666666667em")
                .setWidth("7.5em")
                .setType("color")
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.Slider")
                .setHost(host,"g_step2")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("5.833333333333333em")
                .setTop("2.5em")
                .setWidth("14.375em")
                .setHeight("1.875em")
                .setSteps(100)
                .setIsRange(false)
                .setValue("0")
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"g_step2clr")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("20.833333333333332em")
                .setTop("2.5em")
                .setWidth("7.5em")
                .setType("color")
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.Slider")
                .setHost(host,"g_step3")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("5.833333333333333em")
                .setTop("4.583333333333333em")
                .setWidth("14.375em")
                .setHeight("1.875em")
                .setSteps(100)
                .setIsRange(false)
                .setValue("0")
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"g_step3clr")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("20.833333333333332em")
                .setTop("4.583333333333333em")
                .setWidth("7.5em")
                .setType("color")
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.CheckBox")
                .setHost(host,"c_step1")
                .setDirtyMark(false)
                .setLeft("0.625em")
                .setTop("0.5em")
                .setCaption("$(RAD.custom_dlg.gradlg.Stop 1)")
                .afterUIValueSet("_c_step1_afterUIValueSet")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.CheckBox")
                .setHost(host,"c_step2")
                .setDirtyMark(false)
                .setLeft("0.625em")
                .setTop("2.5833333333333335em")
                .setCaption("$(RAD.custom_dlg.gradlg.Stop 2)")
                .afterUIValueSet("_c_step2_afterUIValueSet")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.CheckBox")
                .setHost(host,"c_step3")
                .setDirtyMark(false)
                .setLeft("0.625em")
                .setTop("4.75em")
                .setCaption("$(RAD.custom_dlg.gradlg.Stop 3)")
                .afterUIValueSet("_c_step3_afterUIValueSet")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.Slider")
                .setHost(host,"g_step4")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("5.833333333333333em")
                .setTop("6.75em")
                .setWidth("14.375em")
                .setHeight("1.875em")
                .setSteps(100)
                .setIsRange(false)
                .setValue("0")
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"g_step4clr")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("20.833333333333332em")
                .setTop("6.75em")
                .setWidth("7.5em")
                .setType("color")
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.ctl_block7.append(
                ood.create("ood.UI.CheckBox")
                .setHost(host,"c_step4")
                .setDirtyMark(false)
                .setLeft("0.625em")
                .setTop("6.916666666666667em")
                .setCaption("$(RAD.custom_dlg.gradlg.Stop 4)")
                .afterUIValueSet("_c_step4_afterUIValueSet")
                );
            
            host.bg.append(
                ood.create("ood.UI.Label")
                .setHost(host,"ctl_slabel473")
                .setLeft("23.083333333333332em")
                .setTop("11em")
                .setCaption("$(RAD.custom_dlg.gradlg.Y$-axis)")
                );
            
            host.bg.append(
                ood.create("ood.UI.CheckBox")
                .setHost(host,"ctl_l")
                .setDirtyMark(false)
                .setLeft("1.3333333333333333em")
                .setTop("8.666666666666666em")
                .setCaption("$(RAD.custom_dlg.gradlg.Linear Gradient Angle)")
                .beforeUIValueSet("_ctl_l_before")
                );
            
            host.bg.append(
                ood.create("ood.UI.CheckBox")
                .setHost(host,"ctl_r")
                .setDirtyMark(false)
                .setLeft("1.3333333333333333em")
                .setTop("10.75em")
                .setCaption("$(RAD.custom_dlg.gradlg.Radial Gradient Point)")
                .beforeUIValueSet("_ctl_r_before")
                );
            
            host.bg.append(
                ood.create("ood.UI.Label")
                .setHost(host,"ctl_slabel472")
                .setLeft("15em")
                .setTop("11em")
                .setCaption("$(RAD.custom_dlg.gradlg.X$-axis)")
                );
            
            host.bg.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ctl_block3")
                .setLeft("0.5em")
                .setTop("13.166666666666666em")
                .setWidth("29.5em")
                .setHeight("1.5833333333333333em")
                .setBorderType("inset")
                .setOverflow("hidden")
                );
            
            host.ctl_block3.append(
                ood.create("ood.UI.Label")
                .setHost(host,"ctl_slabel4")
                .setLeft("22.5em")
                .setTop("0.1875em")
                .setCaption("$(RAD.custom_dlg.gradlg.Color)")
                );
            
            host.ctl_block3.append(
                ood.create("ood.UI.Label")
                .setHost(host,"ctl_slabel3")
                .setLeft("11.583333333333334em")
                .setTop("0.1875em")
                .setCaption("$(RAD.custom_dlg.gradlg.Offset)")
                );
            
            host.ctl_block3.append(
                ood.create("ood.UI.Label")
                .setHost(host,"ctl_slabel6")
                .setLeft("2.5833333333333335em")
                .setTop("0.125em")
                .setCaption("$(RAD.custom_dlg.gradlg.Stops)")
                );
            
            host.bg.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"ctl_rx")
                .setDirtyMark(false)
                .setLeft("18.333333333333332em")
                .setTop("10.75em")
                .setWidth("3.75em")
                .setType("spin")
                .setNumberTpl("*%")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(0)
                .setMax(100)
                .setValue(0)
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.bg.append(
                ood.create("ood.UI.Slider")
                .setHost(host,"ctl_lv")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("13.333333333333334em")
                .setTop("8.583333333333334em")
                .setWidth("16.875em")
                .setHeight("1.875em")
                .setSteps(360)
                .setIsRange(false)
                .setValue("0")
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            host.bg.append(
                ood.create("ood.UI.CheckBox")
                .setHost(host,"ctl_c")
                .setDirtyMark(false)
                .setLeft("1.3333333333333333em")
                .setTop("6.583333333333333em")
                .setCaption("$(RAD.custom_dlg.gradlg.Fill Solid Color Only)")
                .beforeUIValueSet("_ctl_c_before")
                );
            
            host.bg.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"ctl_cv")
                .setDirtyMark(false)
                .setDisabled(true)
                .setLeft("13.333333333333334em")
                .setTop("6.666666666666667em")
                .setWidth("16.666666666666668em")
                .setType("color")
                .afterUIValueSet("_ctl_cv_afteruivalueset")
                );
            
            host.bg.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"ctl_ry")
                .setDirtyMark(false)
                .setLeft("26em")
                .setTop("10.75em")
                .setWidth("3.75em")
                .setType("spin")
                .setNumberTpl("*%")
                .setPrecision(0)
                .setIncrement(1)
                .setMin(0)
                .setMax(100)
                .setValue(0)
                .afterUIValueSet("_t_sd_afteruivalueset")
                );
            
            return children;
            // ]]Code created by EUSUI RAD Studio
        },
        _getValues:function(){
            var ns=this,
                arr=[],h,i;

            if(ns.c_step1.getValue()){
                h={pos:ns.g_step1.getValue(),clr:ns.g_step1clr.getValue()||"#ffffff"};
                arr.push(h);
            }
            if(ns.c_step2.getValue()){
                h={pos:ns.g_step2.getValue(),clr:ns.g_step2clr.getValue()||"#ffffff"};
                arr.push(h);
            }
            if(ns.c_step3.getValue()){
                h={pos:ns.g_step3.getValue(),clr:ns.g_step3clr.getValue()||"#ffffff"};
                arr.push(h);
            }
            if(ns.c_step4.getValue()){
                h={pos:ns.g_step4.getValue(),clr:ns.g_step4clr.getValue()||"#ffffff"};
                arr.push(h);
            }
            if(arr.length)
                ood.arr.stableSort(arr,function(x,y){
                    return parseFloat(x.pos)>parseFloat(y.pos)?1:parseFloat(x.pos)==parseFloat(y.pos)?0:-1;
                });
            return  arr;
        },
        _t_sd_afteruivalueset : function (profile){
            ood.resetRun("Gradients",this.setTS,0,null,this);
        },
        setTS:function(){
            var ns=this,
                type=ns._type,
                stops=ns._getValues(),
                pretag;
            if(stops.length<=0)
                v="";
            else{
                if(type=='l') {
                    //angle
                    pretag=ns.ctl_lv.getUIValue()+"-";
                }else{
                    pretag='r('+ood.toFixedNumber(ns.ctl_rx.getUIValue()/100,2)+','+ood.toFixedNumber(ns.ctl_ry.getUIValue()/100,2)+')';
                }
                v = pretag;
                ood.arr.each(stops,function(o,i){
                    v +=(i?'-':'')+o.clr+":"+o.pos;
                });
            }
           ns.fireEvent("onChange",[ns._v_gradient=v||"none"]);
        },
        init:function(prf,tplkey,prop){
            var ns=this;
            ood.merge(ns.properties,prop,'all');
            var v=prop.cell.value, lv, xv, yv, t,
                tagName=prop.grid.getTag(),
                stops;
            ns._noRadio  = tagName!=='circle' && tagName!=='ellipse';
            ns.ctl_r.setDisabled(ns._noRadio);
            
            if(!v || v=='none' || v.charAt(0)=='#' || v=='transparent'){
                if(v=='none')v='';
                ns.ctl_cv.setValue(v||"",true);
                ns._setType('c',false);
            }else{
                if((!ns._noRadio) && v.charAt(0)=='r'){
                    v=/r\(([0-9.]+)\s*\,\s*([0-9.]+)\)(.+)/.exec(v);
                    if(v){
                        xv=v[1];
                        yv=v[2];
                        if(v[3])
                            t=v[3].split("-");
                        if(t&&t.length){
                            stops=[];
                            ood.arr.each(t,function(s,i){
                                s=s.split(':');
                                stops.push({pos:ood.isSet(s[1])?s[1]:(i===t.length-1?100:0),clr:s[0]});
                            });
                        }
                    }
                    if(!stops||!stops.length){
                        xv=yv=0;
                    }
                    ns.ctl_rx.setValue(xv,true);
                    ns.ctl_ry.setValue(yv,true);
                    
                    ns._setType('r',false);
                }else{
                    v=/([0-9]+)-(.*)/.exec(v);
                    if(v){
                        lv=v[1]||0;
                        if(v[2])
                            t=v[2].split("-");
                        if(t&&t.length){
                            stops=[];
                            ood.arr.each(t,function(s,i){
                                s=s.split(':');
                                stops.push({pos:ood.isSet(s[1])?s[1]:(i===t.length-1?100:0),clr:s[0]});
                            });
                        }
                    }
                    if(!stops||!stops.length){
                        lv=0;
                    }
                    ns.ctl_lv.setValue(lv,true);
                
                    ns._setType('l',false);
                }

                if(stops){
                    if(stops.length>0){
                        ns.c_step1.setValue(true,true);
                        ns.g_step1.setDisabled(false).setValue(stops[0].pos||0,true);
                        ns.g_step1clr.setDisabled(false).setValue(stops[0].clr||"",true);
                    }else{
                        ns.c_step1.setValue(false,true);
                        ns.g_step1.setValue(0,true);
                        ns.g_step1clr.setValue("",true);
                    }
                    if(stops.length>1){
                        ns.c_step2.setValue(true,true);
                        ns.g_step2.setDisabled(false).setValue(stops[1].pos||0,true);
                        ns.g_step2clr.setDisabled(false).setValue(stops[1].clr||"",true);
                    }else{
                        ns.c_step2.setValue(false,true);
                        ns.g_step2.setValue(0,true);
                        ns.g_step2clr.setValue("",true);
                    }
                    if(stops.length>2){
                        ns.c_step3.setValue(true,true);
                        ns.g_step3.setDisabled(false).setValue(stops[2].pos||0,true);
                        ns.g_step3clr.setDisabled(false).setValue(stops[2].clr||"",true);
                    }else{
                        ns.c_step3.setValue(false,true);
                        ns.g_step3.setValue(0,true);
                        ns.g_step3clr.setValue("",true);
                    }
                    if(stops.length>3){
                        ns.c_step4.setValue(true,true);
                        ns.g_step4.setDisabled(false).setValue(stops[3].pos||0,true);
                        ns.g_step4clr.setDisabled(false).setValue(stops[3].clr||"",true);
                    }else{
                        ns.c_step4.setValue(false,true);
                        ns.g_step4.setValue(0,true);
                        ns.g_step4clr.setValue("",true);
                    }
                }
            }
        },
        _ctl_panel4_beforeclose : function (profile){
            profile.boxing().hide();
            return false;
        },
        _c_step1_afterUIValueSet : function (profile, oldValue, newValue){
            var ns = this;
            ns.g_step1.setValue(0).setDisabled(!newValue);
            ns.g_step1clr.setValue("").setDisabled(!newValue);
            ns.setTS();
        },
        _c_step2_afterUIValueSet : function (profile, oldValue, newValue){
            var ns = this;
            ns.g_step2.setValue(0).setDisabled(!newValue);
            ns.g_step2clr.setValue("").setDisabled(!newValue);
            ns.setTS();
        },
        _c_step3_afterUIValueSet : function (profile, oldValue, newValue){
            var ns = this;
            ns.g_step3.setValue(0).setDisabled(!newValue);
            ns.g_step3clr.setValue("").setDisabled(!newValue);
            ns.setTS();
        },
        _c_step4_afterUIValueSet : function (profile, oldValue, newValue){
            var ns = this;
            ns.g_step4.setValue(0).setDisabled(!newValue);
            ns.g_step4clr.setValue("").setDisabled(!newValue);
            ns.setTS();
        },
        _setType:function(type, noEvent){
            var ns=this;
            switch(type){
                case 'c':{
                    ns.ctl_c.setValue(true,true);
                    ns.ctl_l.setValue(false,true);
                    ns.ctl_r.setValue(false,true);
    
                    ns.ctl_cv.setDisabled(false);
                    ns.ctl_lv.setValue(0,true).setDisabled(true);
                    ns.ctl_rx.setValue(0,true).setDisabled(true);
                    ns.ctl_ry.setValue(0,true).setDisabled(true);
                    for(var i=1;i<5;i++){
                        ns["c_step"+i].setValue(false,true).setDisabled(true);
                        ns["g_step"+i].setValue(0,true).setDisabled(true);
                        ns["g_step"+i+"clr"].setValue("",true).setDisabled(true);
                    }
                    ns._type='c';
                    
                    ns._v_gradient="none";

                    if(false!==noEvent)
                        ns.fireEvent("onChange",[ns._v_color||'none']);
    
                }break;
                case 'l':{
                    ns.ctl_c.setValue(false,true);
                    ns.ctl_l.setValue(true,true);
                    ns.ctl_r.setValue(false,true);
    
                    ns.ctl_cv.setValue("",true).setDisabled(true);
                    ns.ctl_lv.setDisabled(false);
                    ns.ctl_rx.setValue(0,true).setDisabled(true);
                    ns.ctl_ry.setValue(0,true).setDisabled(true);
                    if(ns._type!='r'){
                        for(var i=1;i<5;i++){
                            ns["c_step"+i].setValue(false,true).setDisabled(false);
                            ns["g_step"+i].setValue(0,true).setDisabled(true);
                            ns["g_step"+i+"clr"].setValue("",true).setDisabled(true);
                        }
                    }
                    ns._type='l';
                    
                    ns._v_color="none";
                    
                    if(false!==noEvent)
                        ns.setTS();
                }break;
                case 'r':{
                    ns.ctl_c.setValue(false,true);
                    ns.ctl_l.setValue(false,true);
                    ns.ctl_r.setValue(true,true);
    
                    ns.ctl_cv.setValue("",true).setDisabled(true);
                    ns.ctl_lv.setValue(0,true).setDisabled(true);
                    ns.ctl_rx.setDisabled(false);
                    ns.ctl_ry.setDisabled(false);
                    if(ns._type!='l'){
                        for(var i=1;i<5;i++){
                            ns["c_step"+i].setValue(false,true).setDisabled(false);
                            ns["g_step"+i].setValue(0,true).setDisabled(true);
                            ns["g_step"+i+"clr"].setValue("",true).setDisabled(true);
                        }
                    }
                    ns._type='r';
                    
                    ns._v_color="none";
                    
                    if(false!==noEvent)
                        ns.setTS();
                }break;
            }
        },
        _ctl_c_before:function (profile, oldValue, newValue){
            if(newValue)this._setType('c');
            else return false;
        },
        _ctl_l_before:function (profile, oldValue, newValue){
            if(newValue)this._setType('l');
            else return false;
        },
        _ctl_r_before:function (profile, oldValue, newValue){
            if(newValue)this._setType('r');
            else return false;
        },
        _ctl_cv_afteruivalueset:function (profile, oldValue, newValue){
            var ns = this;
            ns.fireEvent("onChange",[ns._v_color=newValue||"none"]);
        },
        _clrpatternclicked:function (profile, e, value){
            var ns = this, cs=profile.CS.KEY,gradients=cs.$gradient,stops=gradients.stops;
            if(ns.ctl_c.getValue()){
                    ns.ctl_cv.setUIValue(stops[0].clr);
            }else{
               ns.c_step4.setUIValue(false,true);
               ns.g_step4.setUIValue(0);
               ns.g_step4clr.setUIValue("");
    
               ns.c_step1.setUIValue(true,true);
               ns.g_step1.setUIValue(parseInt(stops[0].pos,10)||0);
               ns.g_step1clr.setUIValue(stops[0].clr||"");
    
               ns.c_step2.setUIValue(true,true);
               ns.g_step2.setUIValue(parseInt(stops[1].pos,10)||0);
               ns.g_step2clr.setUIValue(stops[1].clr||"");

                ns.c_step3.setUIValue(true,true);
                ns.g_step3.setUIValue(parseInt(stops[2].pos,10)||0);
                ns.g_step3clr.setUIValue(stops[2].clr||"");

            }
        }
    }
});
﻿ood.Class('RAD.ChartCustomSetting', 'ood.Module',{
    Instance:{
        iniComponents : function(){
            // [[Code created by EUSUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"dialog")
                .setLeft("0.8333333333333334em")
                .setTop("0.8333333333333334em")
                .setWidth("45em")
                .setHeight("30.833333333333332em")
                .setShadow(false)
                .setResizer(false)
                .setCaption("$(RAD.fc.Chart Configure)")
                .setMinBtn(false)
                .setMaxBtn(false)
                .beforeClose("_dialog_beforeclose")
            );
            
            host.dialog.append(
                ood.create("ood.UI.Span")
                .setHost(host,"btn_del")
                .setClassName("oodcon ood-uicmd-close")
                .setTips("$(RAD.fc.Remove the row)")
                .setTop("0.125em")
                .setWidth("height")
                .setDisplay("none")
                .onClick("_remove_clicked")
                .setCustomStyle({
                    "KEY":{
                        "font-size":"1.5em",
                        "cursor":"pointer"
                    }
                }
                )
                );
            
            host.dialog.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ctl_block1")
                .setDock("fill")
                .setBorderType("inset")
                );
            
            host.ctl_block1.append(
                ood.create("ood.UI.Tabs")
                .setHost(host,"tabs")
                .setItems([{
                    "id":"chart",
                    "caption":"$RAD.fc.grps.Chart"
                },
                {
                    "id":"data",
                    "caption":"$(RAD.fc.grps.Data Set)"
                },
                {
                    "id":"data2",
                    "caption":"$(RAD.fc.grps.Data Set)"
                },
                {
                    "id":"vsl",
                    "caption":"$(RAD.fc.grps.Vertical Lines)"
                },
                {
                    "id":"tl",
                    "caption":"$(RAD.fc.grps.Trend Lines)"
                },
                {
                    "id":"vl",
                    "caption":"$(RAD.fc.grps.Vertical Trend Lines)"
                },
                {
                    "id":"ann",
                    "caption":"$(RAD.fc.grps.Annotations)"
                }])
                .setValue("chart")
                .onIniPanelView("_tabs_oninipanelview")
                );
            
            host.tabs.append(
                ood.create("ood.UI.TreeGrid")
                .setHost(host,"gridSet")
                .setShowDirtyMark(false)
                .setRowNumbered(true)
                .setEditable(true)
                .setRowHandlerWidth("1.5em")
                .setHeader({}
                )
                .setGrpCols({}
                )
                .setRows({}
                )
                .setTreeMode('none')
                .setHotRowMode("show")
                .setDropKeys("single s")
                .setDragKey("single s")
                .beforeHotRowAdded("_gridSet_beforehotrowadded")
                .afterCellUpdated("_cellupdated")
                .onRowHover("_grid_onmousehover")
                .onDrop("_grid_ondrop")
                .onStartDrag("_grid_onstartdrag")
                , "data");
            
            host.tabs.append(
                ood.create("ood.UI.TreeGrid")
                .setHost(host,"gridSet2")
                .setShowDirtyMark(false)
                .setTips("$(RAD.fc.Click to configure categories)")
                .setEditable(true)
                .setGridHandlerCaption("$RAD.fc.Categories")
                .setHeaderHeight("1.5em")
                .setColSortable(false)
                .setColMovable(true)
                .setHeader({}
                )
                .setGrpCols({}
                )
                .setRows({}
                )
                .setActiveMode("none")
                .setTreeMode('none')
                .setDropKeys("multi s")
                .setDragKey("multi s")
                .beforeRender("_gridset2_bcr")
                .onRender("_gridset2_oncr")
                .afterCellUpdated("_cellupdated2")
                .onClickHeader("_gridSet2_onclickheader")
                .onClickRowHandler("_gridSet2_onclickrh")
                .onClickGridHandler("_gridSet2_onclickgh")
                .beforeComboPop("_gridSet2_pop")
                .onDropTest("_gridset2_dtest")
                .onDrop("_grid_ondrop")
                .onStartDrag("_gridset2_bds")
                .onGetDragData("_gridset2_dragdata")
                .setCustomStyle({
                    "FCELL":"border-left:0;border-top:0;cursor:pointer;",
                    "HCELL":"cursor:pointer;",
                    "FHCELL":"cursor:pointer;"
                }
                )
                , "data2");
            
            host.tabs.append(
                ood.create("ood.UI.TreeGrid")
                .setHost(host,"gridVSL")
                .setShowDirtyMark(false)
                .setRowNumbered(true)
                .setEditable(true)
                .setRowHandlerWidth("1.5em")
                .setHeader({}
                )
                .setGrpCols({}
                )
                .setRows({}
                )
                .setTreeMode('none')
                .setHotRowMode("show")
                .beforeHotRowAdded("_gridVSL_beforehotrowadded")
                .afterCellUpdated("_cellupdated")
                .onRowHover("_grid_onmousehover")
                , "vsl");
            
            host.tabs.append(
                ood.create("ood.UI.TreeGrid")
                .setHost(host,"gridVL")
                .setShowDirtyMark(false)
                .setRowNumbered(true)
                .setEditable(true)
                .setRowHandlerWidth("1.5em")
                .setHeader({}
                )
                .setGrpCols({}
                )
                .setRows({}
                )
                .setTreeMode('none')
                .setHotRowMode("show")
                .beforeHotRowAdded("_gridTrend_beforehotrowadded")
                .afterCellUpdated("_cellupdated")
                .onRowHover("_grid_onmousehover")
                .onStartDrag("_grid_onstartdrag")
                , "vl");
            
            host.tabs.append(
                ood.create("ood.UI.TreeGrid")
                .setHost(host,"gridTL")
                .setShowDirtyMark(false)
                .setRowNumbered(true)
                .setEditable(true)
                .setRowHandlerWidth("1.5em")
                .setHeader({}
                )
                .setGrpCols({}
                )
                .setRows({}
                )
                .setTreeMode('none')
                .setHotRowMode("show")
                .beforeHotRowAdded("_gridTrend_beforehotrowadded")
                .afterCellUpdated("_cellupdated")
                .onRowHover("_grid_onmousehover")
                .onStartDrag("_grid_onstartdrag")
                , "tl");
            
            host.tabs.append(
                ood.create("ood.UI.Layout")
                .setHost(host,"ctl_layout3")
                .setItems([{
                    "id":"before",
                    "pos":"before",
                    "min":10,
                    "size":213,
                    "locked":false,
                    "folded":false,
                    "hidden":false,
                    "cmd":false
                },
                {
                    "id":"main",
                    "min":10,
                    "size":80
                }])
                .setType("horizontal")
                , "chart");
            
            host.ctl_layout3.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ctl_block4")
                .setDock("fill")
                .setBorderType("none")
                , "before");
            
            host.ctl_block4.append(
                ood.create("ood.UI.TreeView")
                .setHost(host,"tv1")
                .setShowDirtyMark(false)
                .setInitFold(false)
                .onItemSelected("_tv1_onitemselected")
                );
            
            host.ctl_block4.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ctl_block87")
                .setDock("top")
                .setHeight("1.5833333333333333em")
                .setHtml("<div style=\"text-align: center;\"><b>$(RAD.fc.Attributes Type)</b></div>")
                );
            
            host.ctl_layout3.append(
                ood.create("ood.UI.TreeGrid")
                .setHost(host,"propGrid1")
                .setShowDirtyMark(false)
                .setEditable(true)
                    .setRowHandler(false)
                .setColSortable(false)
                .setHeader([
                    {
                        "id":"name",
                        "caption":"$RAD.fc.Attribute",
                        "width":"13.583333333333334em",
                        "type":"label"
                    },{
                    "id":"value",
                    "caption":"$RAD.fc.Value",
                    "width":"13.583333333333334em",
                    "type":"input"
                }])
                .afterCellUpdated("_propGrid1_aftercellupdated")
                , "main");
            
            host.ctl_layout3.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ctl_block85")
                .setDock("top")
                .setHeight("1.5833333333333333em")
                .setHtml("<div style=\"text-align: center;\"><b>$(RAD.fc.Attributes Editor)</b></div>")
                , "main");
            
            host.tabs.append(
                ood.create("ood.UI.Layout")
                .setHost(host,"ctl_layout4")
                .setItems([{
                    "id":"before",
                    "pos":"before",
                    "min":10,
                    "size":213,
                    "locked":false,
                    "folded":false,
                    "hidden":false,
                    "cmd":false
                },
                {
                    "id":"main",
                    "min":10,
                    "size":80
                }])
                .setType("horizontal")
                , "ann");
            
            host.ctl_layout4.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ctl_block5")
                .setDock("fill")
                .setBorderType("none")
                , "before");
            
            host.ctl_block5.append(
                ood.create("ood.UI.TreeView")
                .setHost(host,"tvann")
                .setShowDirtyMark(false)
                .setInitFold(false)
                .beforeClick("_tvann_beforeclick")
                .onCmd("_tvann_oncmd")
                .onItemSelected("_tvann_onitemselected")
                );
            
            host.ctl_block5.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ctl_block88")
                .setDock("top")
                .setHeight("1.6666666666666667em")
                .setHtml("<div style=\"text-align: center;\"><b>$(RAD.fc.grps.Annotations)</b></div>")
                );
            
            host.ctl_layout4.append(
                ood.create("ood.UI.TreeGrid")
                .setHost(host,"annGrid")
                .setShowDirtyMark(false)
                .setEditable(true)
                 .setRowHandler(false)
                .setColSortable(false)
                .setHeader([
                    {
                        "id":"name",
                        "caption":"$RAD.fc.Attribute",
                        "width":"13.583333333333334em",
                        "type":"label"
                    },{
                    "id":"value",
                    "caption":"$RAD.fc.Value",
                    "width":"13.583333333333334em",
                    "type":"input"
                }])
                .setGrpCols({}
                )
                .setRows({}
                )

                .afterCellUpdated("_anngrid_aftercellupdated")
                , "main");
            
            host.ctl_layout4.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ctl_block89")
                .setDock("top")
                .setHeight("1.6666666666666667em")
                .setHtml("<div style=\"text-align: center;\"><b>$(RAD.fc.Attributes Editor)</b></div>")
                , "main");
            
            host.ctl_block1.append(
                ood.create("ood.UI.Button")
                .setHost(host,"btnapply")
                .setTop("0.25em")
                .setWidth("5.25em")
                .setHeight("2.1666666666666665em")
                .setRight("0.5em")
                .setCaption("$RAD.fc.Apply")
                .onClick("_apply")
                );
            
            append(
                ood.create("ood.UI.PopMenu")
                .setHost(host,"popType")
                .setItems([{
                    "id":"text",
                    "caption":"$(RAD.fc.svgType.text)"
                },
                {
                    "id":"image",
                    "caption":"$(RAD.fc.svgType.image)"
                },
                {
                    "id":"line",
                    "caption":"$(RAD.fc.svgType.line)"
                },
                {
                    "id":"rectangle",
                    "caption":"$(RAD.fc.svgType.rectangle)"
                },
                {
                    "id":"circle",
                    "caption":"$(RAD.fc.svgType.circle)"
                },
                {
                    "id":"arc",
                    "caption":"$(RAD.fc.svgType.arc)"
                },
                {
                    "id":"polygon",
                    "caption":"$(RAD.fc.svgType.polygon)"
                },
                {
                    "id":"undefined",
                    "caption":"undefined"
                },
                {
                    "id":"path",
                    "caption":"$(RAD.fc.svgType.path)"
                }])
                .onMenuSelected("_poptype_clk")
            );
            
            return children;
            // ]]Code created by EUSUI RAD Studio
        },
        customAppend : function(parent, subId, left, top){
            return this._init();
        },
        _init : function (targetProfile) {
            var ns=this,
                prop=ns.properties,
                chart=targetProfile?(prop.targetProfile=targetProfile):prop.targetProfile,
                data=ood.clone(chart.boxing().getJSONData(),true),
                NoData={
//                    Bulb:1,
                    HLED:1,
                    VLED:1,
                    Cylinder:1,
                    Thermometer:1
                },
                NoTL={
                    Pie2D:1,
                    Pie3D:1,
                    Doughnut2D:1,
                    Doughnut3D:1,
                    Funnel:1,
                    Pyramid:1,
                    Radar:1,
                    Cylinder:1,
                    Thermometer:1
                },
                ColorRange={
//                    Bulb:1,
                    HLED:1,
                    VLED:1,
                    HLinearGauge:1,
                    AngularGauge:1
                },
                TrendPoint={
                    HLinearGauge:1,
                    AngularGauge:1
                };


            ns._dirty=false;
            ns.btnapply.setDisplay('none');

            ns._chartType = chart.properties.chartType;
            ns.DATA = data;
            ns._mutiser = !!FCCONF.attrCat[ns._chartType]["dataset"];
  
            ns._xyPlot=ns._chartType=='Scatter'||ns._chartType=='Bubble';
            
            ns.tabs.resetPanelView(true,false,false);

            ns.tabs.updateItem('tl',{hidden: ns.noTL = NoTL[ns._chartType]});
            ns.tabs.updateItem('vl',{hidden: ns.noVL = !FCCONF.attrCat[ns._chartType]["Vertical Trend Lines"] && !FCCONF.attrCat[ns._chartType]["Trend Point"]});
            ns.tabs.updateItem('vsl',{hidden: ns.noVSL=!FCCONF.attrCat[ns._chartType]["Vertical data separator lines"]});
            ns.tabs.updateItem('data',{hidden: ns.noData = ns._mutiser || NoData[ns._chartType]});
            ns.tabs.updateItem('data2',{hidden: ns.noData2 = !ns._mutiser || NoData[ns._chartType]});
            if(!ns.noTL){
                 if(ColorRange[ns._chartType]){
                     ns._TL_Type="colorrange"
                    ns.tabs.updateItem('tl',{caption:"$(RAD.fc.grps.Color Range)"});
                 }else{
                    ns._TL_Type="trendlines"
                    ns.tabs.updateItem('tl',{caption:"$(RAD.fc.grps.Trend Lines)"});
                }
            }
            if(!ns.noVL){
                 if(TrendPoint[ns._chartType]) {
                    ns._VL_Type="trendpoints";
                    ns.tabs.updateItem('vl',{caption:"$(RAD.fc.grps.Trend Point)"});
                 }else{
                   ns._VL_Type="vtrendlines";
                    ns.tabs.updateItem('vl',{caption:"$(RAD.fc.grps.Vertical Trend Lines)"});
                }
            }
            if(!ns.noData){
                if(ns._chartType=="HLinearGauge"){
                    ns._Data_Type="pointer"
                    ns.tabs.updateItem('data',{caption:"$(RAD.fc.grps.Pointers)"});
                }else if(ns._chartType=="AngularGauge"){
                    ns._Data_Type="dial"
                    ns.tabs.updateItem('data',{caption:"$(RAD.fc.grps.Dials)"});
               }else{
                    ns._Data_Type="data"
                    ns.tabs.updateItem('data',{caption:"$(RAD.fc.grps.Data Set)"});
                }
            }

            var grps = FCCONF.attrCat[ns._chartType].chart;
            ood.arr.each(grps,function(o,i){
                if(!o.caption){
                    o.caption="$(RAD.fc.grps2."+o.id+")";
                    ood.arr.each(o.sub,function(m){
                            m.caption="$(RAD.fc.cats."+m.id.replace(/([)-])/g,"$$$1")+")";
                    });
                }
            });
            ns.tv1.setItems(grps);
 
            ood("body").append(ns.dialog);
            ns.dialog.getRoot()
            .popToTop(ood(prop.src), 2)
            .setBlurTrigger("RAD.ChartCustomSetting",function(){
                ns.dialog.close();
            });

            ns.tabs.setValue('chart',true);
            ns.tv1.fireItemClickEvent("Titles (Axis) Names");

            ns.dialog.activate();
            
            return true;
        },
        _dialog_beforeclose : function (profile) {
            var ns=this;

            ns.DATA=ns._chartType=null;
            profile.boxing().hide();
            ns.gridSet.removeAllRows().setHeader([]);
            ns.gridSet2.removeAllRows().setHeader([]);
            ns.gridTL.removeAllRows().setHeader([]);
            ns.gridVL.removeAllRows().setHeader([]);
            ns.gridVSL.removeAllRows().setHeader([]);
            ns.tabs.setValue('chart',true);
            
            ns.fireEvent('onFinished');
            return false;
        },
        _tvann_oncmd:function(prf,item,key){
            var ns=this;
            ood.confirm('$RAD.Remove?', ood.getRes('RAD.fc.Are You Sure to remove this ' + item.type) +'?',function(){
                prf.boxing().removeItems(item.id);
                prf.boxing().fireItemClickEvent("root");
                ns._change();
            });
        },
        _tvann_beforeclick:function(prf,item,e,src){
             var ns=this,
                  ins=prf.boxing(), id="n_"+ood.stamp();
            if(item.type=='label1'){
                ins.insertItems({
                    type:'group',
                    caption:'$(RAD.fc.Annotation Group)',
                    tagCmds:[{
                        "id" : "Remove",
                        "type" : "text",
                        "caption":"&times;",
                        tips:"$(RAD.fc.Remove Annotation Group)"
                    }],
                    $data:{},
                    sub:[
                            {type:'label2', itemStyle:"font-style: italic;cursor:pointer;", image:"{ood.ini.img_bg}", caption:'$(RAD.fc.[ + Annotation Item])'}
                    ]
                },item._pid,item.id,true);
                ins.fireItemClickEvent(id);
                ns._change();

                return false;
            }
            if(item.type=="label2"){
                ns.popType.pop(ood.Event.getPos(e));
                // keep it
                ns.popType.setTag(item);
                return false;
            }
        },
        _poptype_clk:function(profile, item, src){
             var ns=this, ins=ns.tvann, id="n_"+ood.stamp(),
                tvitem=profile.boxing().getTag(),
                subtype=item.id;
            ins.insertItems({
                id:id,
                type:"item",
                subtype:subtype,
                caption:'$(RAD.fc.Annotation Item) - '  + item.caption,
                tagCmds:[{
                    "id" : "Remove",
                    type:'item',
                    "type" : "text",
                    "caption":"&times;",
                    tips:"$(RAD.fc.Remove Annotation Item)"
                }],
                $data:{type:subtype}
            },tvitem._pid,tvitem.id,true);
            
            ins.fireItemClickEvent(id);
            ns._change();
        },
        _tvann_onitemselected:function (profile, item, e, src, type){
            var ns = this,rows,
                data=item.$data||(item.$data={});
            switch(item.type){
                case 'root':
                    rows=ns._buildTG1("annotations", data, FCCONF.annotations.annotation);
                break;
                case 'group':
                    rows=ns._buildTG1("annotations", data, FCCONF.annotations.group);
                break;
                case 'item':
                    rows=ns._buildTG1("annotations", data, FCCONF.annotations[item.subtype]);
                break;
            }
            ns.annGrid.setRows(rows,true);
            ns.annGrid.get(0).$data=data;
        },
        _tv1_onitemselected:function (profile, item, e, src, type){
            var ns = this,rows;
            //special for single value
            if(item.root){
                rows=ns._buildTG1(item.id, ns.DATA, item.prop);
                ood.arr.each(rows,function(row){
                    row.root=true;
                });
            }else{
                rows=ns._buildTG1(item.id, ns.DATA.chart, item.prop);
            }
            ns.propGrid1.setRows(rows,true);
        },
        _buildTG1:function(id, data, arrSet){
            var ns=this,
            getV=function(id, type, data){
                var v=data[id.toLowerCase()];
                return type=='checkbox'?(v==='1'):v;
            },adjust=function(arr){
                var rows=[],cell;
                ood.arr.each(arr,function(o,i){
                    if(ood.isHash(o)){
                        cell=o;
                        cell.value=getV(o.id,o.type,data);
                    }else{
                        o=cell={id:o,value:"[Not Configured]",caption:"$(RAD.fc.[Not Configured])"};
                    }
                    rows.push({id:o.id, caption:"$RAD.fc.keys."+o.id, tips:o.id, cells:[{id:'name',caption:"$RAD.fc.keys."+o.id?"$RAD.fc.keys."+o.id:o.id},cell]});
                });
                return rows;
            };
            
            var items=[],attr=FCCONF.gridAttr,item,t;
            ood.arr.each(arrSet,function(k){
                if(t=ood.get(attr,[id,k])){
                    item=ood.copy(t);
                    item.id=k;
                }else if(t=attr[k]){
                    item=ood.copy(t);
                    item.id=k;
                }else{
                    item=k;
                }
                items.push(item);
            });
            return adjust(items);
        },
        _getV:function(cell){
            return cell.value===false?"0":cell.value===true?"1":((cell.value+"").replace(/^#/,''));
        },
        _anngrid_aftercellupdated:function (profile, cell, options, isHotRow){
            var ns=this, data=profile.$data;
            if("value" in cell){
                if(!ood.isSet(cell.value)||cell.value===""){
                    delete data[cell.id.toLowerCase()] ;
                }else{
                    if(ood.isStr(cell.value) && cell.value.charAt(0)=='#'){
                        cell.value=cell.value.replace('#','');
                    }
                    data[cell.id.toLowerCase()] = ns._getV(cell);
                }
                ns._change();
            }
        },
        _propGrid1_aftercellupdated:function (profile, cell, options, isHotRow){
            var ns=this;
            if("value" in cell){
                //special for single value
                var isroot=cell._row.root;
                if(!ood.isSet(cell.value)||cell.value===""){
                    if(isroot) delete ns.DATA[cell.id.toLowerCase()] ;
                    else delete ns.DATA.chart[cell.id.toLowerCase()] ;
                }else{
                    if(ood.isStr(cell.value) && cell.value.charAt(0)=='#'){
                        cell.value=cell.value.replace('#','');
                    }
                    if(isroot) ns.DATA[cell.id.toLowerCase()] = ns._getV(cell);
                    else  ns.DATA.chart[cell.id.toLowerCase()] = ns._getV(cell);
                }
                if(!isHotRow)
                    ns._change();
            }
        },
        _change:function(){
            var ns=this;
            ns._dirty=true;
            ns.btnapply.setDisplay('');
            ns.fireEvent('onChange');
        },
        _cellupdated2:function (profile, cell, options, isHotRow){
            var ns=this;
            if("value" in cell){
                if(ood.isStr(cell.value) && cell.value.charAt(0)=='#'){
                    cell.value=cell.value.replace('#','');
                }

                if(!cell.DATA)cell.DATA={};
                cell.DATA.value=cell.value;
                if(!isHotRow)
                    ns._change();
            }
        },
        _apply:function (){
            var ns=this,
                prop=ns.properties,
                chart=prop.targetProfile,
                tvann=ns.tvann,
                gridTL=ns.gridTL,
                gridVL=ns.gridVL,
                gridVSL=ns.gridVSL,
                rows,header,data;

            if(ns.DATA){
                var lines=[];
                header = gridTL.getHeader('min');
                if(header.length){
                    ood.arr.each(gridTL.getRows(),function(row){
                        if(ood.UI.TreeGrid.isHotRow(row))return;
                        data={};
                        ood.arr.each(row.cells,function(cell,i){
                            if(cell.needCollect)
                                data[header[i].toLowerCase()]=ns._getV(cell);
                        });
                        lines.push(data);
                    });
                    // for gauges
                    if(ns._TL_Type=="colorrange")
                        ood.set(ns.DATA,["colorrange","color"],lines);
                    else
                        ood.set(ns.DATA,["trendlines"], [{line:lines}]);
                }
                
                lines=[];
                header = gridVL.getHeader('min');
                if(header.length){
                    ood.arr.each(gridVL.getRows(),function(row){
                        if(ood.UI.TreeGrid.isHotRow(row))return;
                        data={};
                        ood.arr.each(row.cells,function(cell,i){
                            if(cell.needCollect)
                                data[header[i].toLowerCase()]=ns._getV(cell);
                        });
                        lines.push(data);
                    });
                    // for gauges
                    if(ns._VL_Type=="trendpoints")
                        ood.set(ns.DATA,["trendpoints","point"],lines);
                    else
                        ood.set(ns.DATA,["vtrendlines"], [{line:lines}]);
                }
                
                // 2-dimensions data
                if(ns._mutiser){
                    header = ns.gridSet2.getHeader();
                    rows = ns.gridSet2.getRows();
                    var datas=[],
                        vslcols=gridVSL.getHeader('min'),
                        vslrows=gridVSL.getRows();
                    // maybe no columns for Scatter
                    if((ns.noVSL || vslcols.length) && (header.length||rows.length)){
                        var categories={category:[]};
                        ood.arr.each(header,function(col){
                            categories.category.push(col.DATA);
                        });
                        if(vslcols&&vslcols.length){
                            ood.arr.each(vslrows, function(row){
                                if(ood.UI.TreeGrid.isHotRow(row))return;

                                var i=row.cells[0].value;
                                data={vline:"1"};
                                ood.arr.each(row.cells,function(cell,j){
                                    if(cell.needCollect)
                                        data[vslcols[j].toLowerCase()]=ns._getV(cell);
                                });
                                ood.arr.insertAny(categories.category, data, i);
                            },null,false);
                        }
                        ood.merge(categories, ns.gridSet2.getTagVar(), 'all');
                        
                        ns.DATA.categories=[categories];

                        var datasets=[],dataset,idatas;
                        ood.arr.each(rows,function(row,index){
                            if(row.type=='label'||row.type=='label2')return;
                            if(row.sub){
                                dataset={
                                    dataset:[]
                                };
                                ood.arr.each(row.sub,function(row,i){
                                    if(row.type=='label'||row.type=='label2')return;
                                    idatas={
                                        data:[]
                                    };
                                    if(!ood.isEmpty(row.DATA)){
                                        ood.merge(idatas, row.DATA, 'all');
                                    }
                                    ood.arr.each(row.cells,function(cell,i){
                                        idatas.data.push(cell.DATA||{});
                                    });
                                    dataset.dataset.push(idatas);
                                });
                                // for MSStackedColumn2DLineDY
                                if(row.lineset){
                                    ood.set(ns.DATA,["lineset"],dataset.dataset);
                                }else
                                    datasets.push(dataset);
                            }else{
                                dataset={
                                    data:[]
                                };
                                if(!ood.isEmpty(row.DATA)){
                                    ood.merge(dataset, row.DATA, 'all');
                                }
                                if(ns._xyPlot){
                                    dataset.data=row.DATA2;
                                }else{
                                    ood.arr.each(row.cells,function(cell,i){
                                        dataset.data.push(cell.DATA||{});
                                    });
                                }
                                datasets.push(dataset);
                            }
                        });
                        ood.set(ns.DATA,["dataset"],datasets);
                    }
                }else{
                    header = ns.gridSet.getHeader('min');
                    rows = ns.gridSet.getRows();
                    var datas=[],
                        vslcols=gridVSL.getHeader('min'),
                        vslrows=gridVSL.getRows();
                    if((ns.noVSL || vslcols.length) && (header.length||rows.length)){
                        ood.arr.each(rows,function(row,index){
                            if(ood.UI.TreeGrid.isHotRow(row))return;
                            data={};
                            ood.arr.each(row.cells,function(cell,i){
                                if(cell.needCollect)
                                    data[header[i].toLowerCase()]=ns._getV(cell);
                            });
                            datas.push(data);
                        });
                        if(ns._Data_Type=="pointer"){
                            ood.set(ns.DATA,["pointer","pointer"],datas);
                        }else if(ns._Data_Type=="dial"){
                            ood.set(ns.DATA,["dials","dial"],datas);
                        }else{
                            ood.set(ns.DATA,["data"],datas);
                            if(vslcols&&vslcols.length){
                                ood.arr.each(vslrows, function(row){
                                    if(ood.UI.TreeGrid.isHotRow(row))return;
    
                                    var i=row.cells[0].value;
                                    data={vline:"1"};
                                    ood.arr.each(row.cells,function(cell,j){
                                        if(cell.needCollect)
                                            data[vslcols[j].toLowerCase()]=ns._getV(cell);
                                    });
                                    ood.arr.insertAny(ns.DATA.data, data, i);
                                },null,false);
                            }
                        }
                    }
                }


                var items=tvann.getItems();
                 if(ood.get(items,[0,"sub"])){
                    var grp,item,ann={
                        groups:[]
                     };
                    ood.arr.each(items[0].sub,function(firstlayer){
                        if(firstlayer.sub&&firstlayer.sub.length){
                            grp={items:[]};
                            ood.arr.each(firstlayer.sub,function(secondlayer){
                                item=secondlayer.$data;
                                // if has content
                                if(!ood.isEmpty(item)){
                                    grp.items.push(item);
                                }
                            });
                            // if has sub content
                            if(grp.items.length){
                                ood.merge(grp, firstlayer.$data,'without');
                                ann.groups.push(grp);
                            }
                        }
                    });
                    // if has sub content
                    if(ann.groups.length){
                        ood.merge(ann, items[0].$data, 'without');
                        ns.DATA.annotations=ood.clone(ann, true);
                    }else
                        delete ns.DATA.annotations;                    
                }

                chart.boxing().setJSONData(ns.DATA, true);
                ns.fireEvent('onDirty');
             }            
             
            ns._dirty=false;
            ns.btnapply.setDisplay('none');
        },
        _buildGrid:function(type,data,grid,vline){
            var ns=this,
                attrCat=FCCONF.attrCat[ns._chartType],
                attr=FCCONF.gridAttr,
                header=[], col;

            if(vline){
                header.push({
                    id:'location',
                    caption:'$(RAD.fc.[Location])',
                    type:'spin',
                    precision:0,
                    increment:1,
                    min:0,
                    max:1000
                });
            }
            ood.arr.each(attrCat[type],function(key){
                var t;
                if(t=ood.get(attr,[type, key])){
                    col=ood.copy(t);
                    col.id=key;
                    col.caption="$RAD.fc.keys."+col.id;
                }else if(t=attr[key]){
                    col=ood.copy(t);
                    col.id=key;
                    col.caption="$RAD.fc.keys."+col.id;
                }else{
                    col={id:key,caption:"$(RAD.fc.[Not Configured])"};
                }
                header.push(col);
            });
            if(grid)ns[grid].setHeader(header);                

            if(data){
                var rows=[];
                ood.arr.each(data,function(line,i){
                    if(vline){
                        if(line.vline=="1"||line.vline=="true"){
                            var cells=[];
                            ood.arr.each(header,function(col){
                                if(col.id=="location"){
                                    cells.push({
                                        value: i
                                    });
                                }else{
                                    var id=col.id.toLowerCase();
                                    cells.push({
                                        value:id in line ? (col.type=='checkbox'?line[id]==="1"?true:false:line[id]) : "",
                                        needCollect: id in line
                                    });
                                }
                            });
                            rows.push({cells:cells});
                        }
                    }else{
                        if(line.vline!=="1"&&line.vline!=="true"){
                            var cells=[];
                            ood.arr.each(header,function(col,id){
                                id=col.id.toLowerCase();
                                cells.push({
                                    value:id in line ? (col.type=='checkbox'?line[id]==="1"?true:false:line[id]) : "",
                                    needCollect: id in line
                                });
                            });
                            rows.push({cells:cells});
                        }
                    }
                });
                if(rows.length){
                    if(grid)ns[grid].setRows(rows);
                }
            }
            if(grid)ns[grid].addHotRow(header[0]);
            
            return {header:header,rows:rows};
        },
        _tabs_oninipanelview:function (profile, item){
            var ns=this;
            switch(item.id){
                case 'data2':
                    if(profile._ining2)return;

                    var header=[],cells=[],rows=[];
                    var cs=ns.DATA.categories?ns.DATA.categories[0]:{category:[]};
                    // categories object
                    ns.gridSet2.setTagVar( ood.clone(cs,function(o,i){return 'category'!=i}) );
                    ood.arr.each(cs.category,function(cat,i){
                        if(cat.vline!=="1"&&cat.vline!=="true"){
                            header.push({
                                id:cat.label + ood.stamp(),
                                caption:"$(RAD.fc.keys."+cat.label+")",
                                type:'popbox',
                                tips:'$(RAD.fc.Click to configure category)',
                                // category object
                                DATA:ood.clone(cat)
                            });
                        }
                    });

                    if(ns._xyPlot){
                        ood.arr.each(ns.DATA.dataset,function(data,i){
                            rows.push({
                                caption:data.seriesname,
                                group:true,
                                xyPlot:1,
                                firstCellClass:"ood-treegrid-hcell",
                                tips:'$(RAD.fc.Click to configure dataset)',
                                // dataset object
                                DATA:ood.clone(data,function(o,i){return 'data'!=i}),
                                DATA2:ood.clone(data.data)
                            });
                        });
                        rows.push({type:'label',xyPlot:1,group:true,cellStyle:"font-weight:normal;font-style: italic;",caption:'$(RAD.fc.[ + Dataset])',tips:'$(RAD.fc.Add dataset)'});
                        ns.gridSet2.setTreeMode('inhandler').setRowHandlerWidth(100);
                    }else{
                        var msstack;
                        ood.arr.each(ns.DATA.dataset,function(data,i){
                            cells=[];
                            //for MSStackedColumn2D and MSStackedColumn2DLineDY
                            if(data.dataset){
                                msstack=1;
                                var sub=[];
                                rows.push({
                                    caption:'$(RAD.fc.Dataset group)',
                                    group:true,
                                    tips:'$(RAD.fc.Dataset group)',
                                    dragkey:'group',
                                    sub:sub
                                });
                                
                                ood.arr.each(data.dataset,function(data,i){
                                    cells=[];
                                    ood.arr.each(data.data,function(d,i){
                                        cells.push({
                                            value:d.value,
                                            // set object
                                            DATA:ood.clone(d)
                                        });
                                    });
                                    sub.push({
                                        caption:data.seriesname,
                                        cells:cells,
                                        firstCellClass:"ood-treegrid-hcell",
                                        tips:'$(RAD.fc.Click to configure dataset)',
                                        dragkey:'dataset',
                                        // dataset object
                                        DATA:ood.clone(data,function(o,i){return 'data'!=i})
                                    });
                                });
                                sub.push({type:'label', group:true, cellStyle:"font-weight:normal;font-style: italic;",caption:'$(RAD.fc.[ + Dataset])',tips:'$(RAD.fc.Add dataset)'});
                                
                            }else{
                                ood.arr.each(data.data,function(d,i){
                                    cells.push({
                                        value:d.value,
                                        // set object
                                        DATA:ood.clone(d)
                                    });
                                });
                                rows.push({
                                    caption:data.seriesname,
                                    cells:cells,
                                    firstCellClass:"ood-treegrid-hcell",
                                    tips:'$(RAD.fc.Click to configure dataset)',
                                    dragkey:'datset',
                                    // dataset object
                                    DATA:ood.clone(data,function(o,i){return 'data'!=i})
                                });
                            }
                        });
                        if(msstack){
                            if(ns._chartType=="MSStackedColumn2DLineDY"){
                                var sub=[];
                                // first
                                ood.arr.insertAny(rows,{
                                    caption:'$(RAD.fc.Lineset group)',
                                    group:true,
                                    tips:'$(RAD.fc.Lineset group)',
                                    lineset:true,
                                    sub:sub
                                },0);
                                ood.arr.each(ns.DATA.lineset,function(data,i){
                                    cells=[];
                                    ood.arr.each(data.data,function(d,i){
                                        cells.push({
                                            value:d.value,
                                            // set object
                                            DATA:ood.clone(d),
                                            special:'line'
                                        });
                                    });
                                    sub.push({
                                        caption:data.seriesname,
                                        cells:cells,
                                        firstCellClass:"ood-treegrid-hcell",
                                        tips:'$(RAD.fc.Click to configure lineset)',
                                        dragkey:'lineset',
                                        // dataset object
                                        DATA:ood.clone(data,function(o,i){return 'data'!=i}),
                                        special:'lineset',
                                        spceialcell:"line"
                                    });
                                });
                                sub.push({type:'label', group:true, cellStyle:"font-weight:normal;font-style: italic;",caption:'$(RAD.fc.[ + Lineset])',tips:'$(RAD.fc.Add lineset)'});
                            }
                            
                            rows.push({type:'label2',group:true,cellStyle:"font-weight:normal;font-style: italic;",caption:'$(RAD.fc.[ + Group])',tips:'$(RAD.fc.Add dataset group)'});
                            ns.gridSet2.setTreeMode('inhandler').setRowHandlerWidth(150)
                        }else{
                            rows.push({type:'label',group:true,cellStyle:"font-weight:normal;font-style: italic;",caption:'$(RAD.fc.[ + Dataset])',tips:'$(RAD.fc.Add dataset)'});
                            ns.gridSet2.setTreeMode('inhandler').setRowHandlerWidth(100);
                        }
                        if(FCCONF.attrCat[ns._chartType]["Vertical data separator lines"]){
                            profile._ining2=1;
                            profile.boxing().iniPanelView('vsl');
                            delete profile._ining2;
                        }
                    }
                    ns.gridSet2.setHeader(header).setRows(rows);
                    break;
                case 'data': 
                    if(profile._ining2)return;
                    var type,data;
                    // for HLinearGauge
                    if(ns._Data_Type=="pointer"){
                        type="pointer";
                        data=ood.get(ns.DATA,["pointers","pointer"]);
                    }
                    // for AngularGauge
                    else if(ns._Data_Type=="dial"){
                        type="dial";
                        data=ood.get(ns.DATA,["dials","dial"]);
                    }else{
                        type="set";
                        data=ood.get(ns.DATA,['data']);
                    }
                    ns._buildGrid(type, data, 'gridSet');

                    if(FCCONF.attrCat[ns._chartType]["Vertical data separator lines"]){
                        profile._ining2=1;
                        profile.boxing().iniPanelView('vsl');
                        delete profile._ining2;
                    }

                    break;
                case 'vsl':
                    if(profile._ining)return;
                    if(ns._mutiser){
                        ns._buildGrid('Vertical data separator lines', ood.get(ns.DATA,['categories',0,'category']), 'gridVSL', true);
                    }else{
                        ns._buildGrid('Vertical data separator lines', ood.get(ns.DATA,['data']), 'gridVSL', true);
                    }
                    profile._ining=1;
                    profile.boxing().iniPanelView(ns._mutiser?'data2':'data');
                    delete profile._ining;

                    break;
                case 'tl':
                    if(ns._TL_Type=="colorrange"){
                        ns._buildGrid('Color Range', ood.get(ns.DATA,["colorrange","color"]), 'gridTL');
                    }else{
                        ns._buildGrid('Trend Lines', ood.get(ns.DATA,["trendlines",0,"line"]), 'gridTL');
                    }
                    break;
                case 'vl':
                    if(ns._VL_Type=="trendpoints"){
                        ns._buildGrid('Trend Point', ood.get(ns.DATA,["trendpoints","point"]), 'gridVL');
                    }else{
                        ns._buildGrid('Vertical Trend Lines', ood.get(ns.DATA,["vtrendlines",0,"line"]), 'gridVL');
                    }
                    break;
                case 'ann':
                    var ann=ns.DATA.annotations,
                        items;
                    if(!ood.get(ann, ["groups",0,"items",0])){
                        items=[{
                            id:"root",
                            type:'root',
                            caption:"$(RAD.fc.Annotations)",
                            $data:{},
                            sub:[
                                {
                                    type:'group',
                                    caption:'$(RAD.fc.Annotation Group)',
                                    tagCmds:[{
                                        "id" : "Remove",
                                        type:'group',
                                        "type" : "text",
                                        "caption":"&times;",
                                        tips:"$(RAD.fc.Remove Annotation Group)"
                                    }],
                                    $data:{},
                                    sub:[
                                            {
                                                type:'item',
                                                subtype:'text',
                                                caption:'$(RAD.fc.Annotation Item) - ' + '$(RAD.fc.svgType.text) ',
                                                tagCmds:[{
                                                    "id" : "Remove",
                                                    "type" : "text",
                                                    "caption":"&times;",
                                                    tips:"$(RAD.fc.Remove Annotation Item)"
                                                }],
                                                $data:{type:"text"}
                                            },
                                            {type:'label2', itemStyle:"font-style: italic;cursor:pointer;", image:"{ood.ini.img_bg}", caption:'$(RAD.fc.[ + Annotation Item])'}
                                    ]
                                },
                                {type:'label1', itemStyle:"font-style: italic;cursor:pointer;", image:"{ood.ini.img_bg}",caption:'$(RAD.fc.[ + Annotation Group])'}
                            ]
                        }];
                    }else{
                        // root
                        var root={
                            id:"root",
                            type:'root',
                            caption:"$(RAD.fc.Annotations)",
                            $data:{},
                            sub:[]
                        },group,item;
                        items=[root];
                        ood.merge(root.$data,ann);
                        delete root.$data.groups; 
                        
                        ood.arr.each(ann.groups,function(grp){
                            group={
                                type:'group',
                                caption:'$(RAD.fc.Annotation Group)',
                                tagCmds:[{
                                    "id" : "Remove",
                                    type:'group',
                                    "type" : "text",
                                    "caption":"&times;",
                                    tips:"$(RAD.fc.Remove Annotation Group)"
                                }],
                                $data:{},
                                sub:[]
                            };
                            ood.merge(group.$data,grp);
                            delete group.$data.items; 
                            root.sub.push(group);
                            
                            ood.arr.each(grp.items,function(ii){
                                item={
                                    type:'item',
                                    subtype:ii.type,
                                    caption:'$(RAD.fc.Annotation Item) - '+ '$(RAD.fc.svgType.'+ii.type+') ',
                                    tagCmds:[{
                                        "id" : "Remove",
                                        "type" : "text",
                                        "caption":"&times;",
                                        tips:"$(RAD.fc.Remove Annotation Item)"
                                    }],
                                    $data:{}
                                };
                                ood.merge(item.$data,ii);
                                group.sub.push(item);
                            });
                            group.sub.push({type:'label2', itemStyle:"font-style: italic;cursor:pointer;", image:"{ood.ini.img_bg}", caption:'$(RAD.fc.[ + Annotation Item])'});
                        });
                        root.sub.push({type:'label1', itemStyle:"font-style: italic;cursor:pointer;", image:"{ood.ini.img_bg}",caption:'$(RAD.fc.[ + Annotation Group])'});
                    }
                    ns.tvann.setItems(items).fireItemClickEvent("root",true);
                break;
                default: 
            }
        },
        _gridSet_beforehotrowadded:function (profile, cellMap){
            if(cellMap){
                var ns = this, uictrl = profile.boxing();
                if(!cellMap[profile.properties.header[0].id])return false;
                else{
                    ns._change();
                    return true;
                }
            }
        },
        _gridVSL_beforehotrowadded:function (profile, cellMap){
            var ns = this, uictrl = profile.boxing();
            if(ood.isNumb(cellMap[profile.properties.header[0].id])){
                ns._change();
                return true;
            }else{
                return false;
            }
        },
        _gridTrend_beforehotrowadded:function (profile, cellMap){
            var ns = this, 
                uictrl = profile.boxing(),
                startValue=cellMap[profile.properties.header[0].id];
            if(startValue||startValue===0){
                ns._change();
                return true;
            }else{
                return false;
            }
        },
        _cellupdated:function(profile, cell, options, isHotRow){
            var ns=this;
            if("value" in cell){
                if(ood.isStr(cell.value) && cell.value.charAt(0)=='#'){
                    cell.value=cell.value.replace('#','');
                }
            }            
            cell.needCollect=1;
            if(!isHotRow)
                ns._change();
        },
        _grid_onstartdrag:function(profile){
            var ns=this,btn=ns.btn_del;
            btn.setDisplay("none");
            ns.dialog.append(btn);
            delete ns._curgrid;
            delete ns._currowid;
        },
        _grid_onmousehover:function(profile, row, hover, e, src){
            if(profile.box.isHotRow(row))return;
            var ns=this,grid=profile.boxing(),btn=ns.btn_del;
            ood.resetRun("TL_DEL",function(){
                if(hover){
                    var node=grid.getSubNode('SCROLL22').get(0);
                    btn.setLeft(node.scrollLeft + node.clientWidth - 20 );
                    ood(src).append(btn);
                    btn.setDisplay("");
                    
                    ns._curgrid=grid;
                    ns._currowid=row.id;
                }else{
                    btn.setDisplay("none");
                    ns.dialog.append(btn);

                    delete ns._curgrid;
                    delete ns._currowid;
                }
            });
        },
        _remove_clicked:function(p,e){
            var ns=this,btn=ns.btn_del;
            if(ns._curgrid && ns._currowid){
                var curgrid=ns._curgrid,
                    currowid=ns._currowid;
                var pos=ood.Event.getPos(e);
                ood.confirm('$RAD.Remove?',ood.getRes('RAD.Are You Sure to remove this row') + '?',function(){
                    btn.setDisplay("none");
                    ns.dialog.append(btn);
                    curgrid.removeRows([currowid]);
                    delete ns._curgrid;
                    delete ns._currowid;

                    ns._change();
                },null,null,null,ns.dialog.getRoot().cssRegion());
            }
        },
        _gridSet2_onclickheader:function(prf, col, e, src){
            var ns=this,id="category";
            ood.ComFactory.getCom('RAD.PropEditor', function(){
                this.setProperties({
                    targetProfile:ns.properties.targetProfile,
                    propKey:"JSONData.*",

                    fc:1,
                    realData:col.DATA,
                    uiData:ns._buildTG1(id, col.DATA, FCCONF.attrCat[ns._chartType][id]),
                    labelId:"label",
                    src:src
                });
                this.setEvents({
                    onLabelChanged:function(label){
                        prf.boxing().updateColumn(col.id, {caption:label});
                    },
                    onChanged:function(){
                        ns._change();
                    }
                });
                this.show();
            });
        },
        _gridSet2_onclickgh:function(prf,e,src){
            var ns=this,id="categories";
            ood.ComFactory.getCom('RAD.PropEditor', function(){
                this.setProperties({
                    targetProfile:ns.properties.targetProfile,
                    propKey:"JSONData.*",

                    fc:1,
                    realData:prf.properties.tagVar,
                    uiData:ns._buildTG1(id, prf.properties.tagVar, FCCONF.attrCat[ns._chartType][id]),
                    src:src
                });
                this.setEvents({
                    onChanged:function(){
                        ns._change();
                    }
                });
                this.show();
            });
        },
        _gridSet2_onclickrh:function(prf, row, e, src){
            var ns=this;
            if(row.type=='label'){
                if(row.xyPlot){
                    prf.boxing().insertRows([{
                        caption:"[dataset]",
                        xyPlot:1,
                        group:1,
                        firstCellClass:"ood-treegrid-hcell",
                        tips:'$(RAD.fc.Click to configure dataset)',
                        // dataset object
                        DATA:{
                            seriesname:"[dataset]"
                        }
                    }],null,row.id,true);
                    ns._change();
                }else{
                    var cells=[];
                    ood.arr.each(prf.boxing().getHeader(),function(col){
                        cells.push({
                            value:0,
                            special:row.lineset?"line":null,
                            DATA:{
                                value:0
                            }
                        });
                    });
                    prf.boxing().insertRows([{
                        caption:"[dataset]",
                        firstCellClass:"ood-treegrid-hcell",
                        tips:'$(RAD.fc.Click to configure '+(row.lineset?"lineset":"dataset") + ")",
                        special:row.lineset?"lineset":null,
                        spceialcell:row.lineset?"line":null,
                        cells:cells,
                        // dataset object
                        DATA:{
                            seriesname:row.lineset?"[lineset]":"[dataset]"
                        }
                    }],null,row.id,true);
                    ns._change();
                }
            }else if(row.type=='label2'){
                var sub=[];                
                sub.push({type:'label', group:true, caption:'[ + Dataset]',tips:'$(RAD.fc.Add dataset)'});
                prf.boxing().insertRows([{
                    caption:'Dataset group',
                    group:true,
                    tips:'$(RAD.fc.Dataset group)',
                    datagroup:1,
                    sub:sub
                }],null,row.id,true);
                ns._change();
            }else if(!row.group || row.xyPlot){
                var ns=this,id=row.special||"dataset";
                ood.ComFactory.getCom('RAD.PropEditor', function(){
                    this.setProperties({
                        targetProfile:ns.properties.targetProfile,
                        propKey:"JSONData.*",

                        fc:1,
                        realData:row.DATA,
                        uiData:ns._buildTG1(id, row.DATA, FCCONF.attrCat[ns._chartType][id]),
                        labelId:"seriesName",
                        src:src
                    });
                    this.setEvents({
                        onLabelChanged:function(label){
                            prf.boxing().updateRow(row.id, {caption:label});
                        },
                        onChanged:function(){
                            ns._change();
                        }
                    });
                    this.show();
                });
            }
        },
        _gridSet2_pop:function(profile, cell, proEditor, pos, e, src){
            var ns=this,id=cell.special||cell._row.spceialcell||"set";
            if(!cell.DATA)cell.DATA={};
            ood.ComFactory.getCom('RAD.PropEditor', function(){
                this.setProperties({
                    targetProfile:ns.properties.targetProfile,
                    propKey:"JSONData.*",

                    fc:1,
                    realData:cell.DATA,
                    uiData:ns._buildTG1(id, cell.DATA, FCCONF.attrCat[ns._chartType][id]),
                    labelId:"value",
                    src:src
                });
                this.setEvents({
                    onLabelChanged:function(value){
                        proEditor.boxing().setUIValue(value);
                    },
                    onChanged:function(){
                        ns._change();
                    }
                });
                this.show();
            });
        },
        _gridset2_bcr:function (prf, threadid){
            var ns=this;
            prf.boxing().setRowOptions({
                rowRenderer:function(prf,row){
                    if(row.type!='label'&&row.type!='label2'&&!row.lineset){
                        prf.getSubNode('FCELL',row._serialId).first().prepend(new ood.UI.Span({
                            position:'relative',
                            className: 'oodcon ood-uicmd-close',
                            width:'auto',
                            height:'auto',
                            right:0,
                            bottom:0,
                            tips:'$(RAD.fc.Remove this dataset)'
                        },{
                            beforeHoverEffect:function(profile, item, e, src, type){
                                ood(src).css({'border':type=='mouseover'?'solid 1px #ccc':'',
                                            'padding':type=='mouseover'?'':'1px'});
                            },
                            onClick:function(p,e){
                                var pos=ood.Event.getPos(e);
                                ood.confirm('$RAD.Remove?',ood.getRes('RAD.fc.Are You Sure to remove this dataset')+'?',function(){
                                    prf.boxing().removeRows([row.id]);
                                    ns._change();
                                });
                                ood.Event.stopBubble(e);
                            }
                        },null,null,{KEY:"padding:1px;cursor:pointer;"}));
                        
                        if(row.xyPlot){
                            prf.getSubNode('LCELL',row._serialId).append(new ood.UI.SButton({
                                position:'relative',
                                "imageClass":"ood-uicmd-opt",
                                caption:" $(RAD.fc.Data Configuration)"
                            },{
                                onClick:function(profile, e, src){
                                    ood.ComFactory.getCom('RAD.MixPropEditor', function(){
                                        var data=ns._buildGrid('set', row.DATA2);
                                        this.setProperties({
                                            targetProfile:ns.properties.targetProfile,
                                            propKey:'xyPlot',

                                            uiHeader:data.header,
                                            uiRows:data.rows,
                                            fc:1,
                                            src:src
                                        });
                                        this.setEvents({
                                            onChanged:function(rows){
                                                row.DATA2=rows;
                                                ns._change();
                                            }
                                        });
                                        this.show();
                                    });
                                }
                            }));
                        }
                    }
                }
            }).setColOptions({
                colRenderer:function(prf,col){
                    prf.getSubNode('HCELLA',col._serialId).append(new ood.UI.Span({
                        className: 'oodcon ood-uicmd-close',
                        left:'auto',
                        top:'auto',
                        width:'auto',
                        height:'auto',
                        right:0,
                        bottom:0,
                        tips:'$(RAD.fc.Remove this category)'
                    },{
                        beforeHoverEffect:function(profile, item, e, src, type){
                            ood(src).css({'border':type=='mouseover'?'solid 1px #ccc':'',
                                        'padding':type=='mouseover'?'':'1px'});
                        },
                        onClick:function(p,e){
                            var pos=ood.Event.getPos(e);
                            ood.confirm('$RAD.Remove?',ood.getRes('RAD.fc.Are You Sure to remove this category')+'?',function(){
                                prf.boxing().removeCols([col.id]);
                                ns._change();
                            },null,null,null,ns.dialog.getRoot().cssRegion());

                            ood.Event.stopBubble(e);
                        }
                    },null,null,{KEY:"padding:1px;cursor:pointer"}));
                }
            })
        },
        _gridset2_oncr:function (prf, threadid){
            var ns=this;
            prf.boxing().getSubNode('FHCELL').first().append(new ood.UI.Span({
                className: 'oodcon ood-uicmd-add',
                left:'auto',
                top:'auto',
                width:'auto',
                height:'auto',
                right:0,
                bottom:0,
                tips:'$(RAD.fc.Add category)'
            },{
                beforeHoverEffect:function(profile, item, e, src, type){
                    ood(src).css({'border':type=='mouseover'?'solid 1px #ccc':'',
                                'padding':type=='mouseover'?'':'1px'});
                },
                onClick:function(p,e){
                    var nid=ood.id()+ood.stamp();
                    prf.boxing().insertCol({
                        id:nid,
                        type:'popbox',
                        caption:"[category]",
                        tips:'$(RAD.fc.Click to cofigure category)',
                        DATA:{
                            label:"[category]"
                        }
                    });
                    ns._change();

                    ood.asyRun(function(){
                        if(!prf||prf.destroyed)return;
                        var a=prf.getSubNode('HCELLA',true);
                        if(a=a.get(a.size()-1))a.scrollIntoView();
                    });
                    ood.Event.stopBubble(e);
                }
            },null,null,{KEY:"padding:1px;cursor:pointer"}));
        },
        _gridset2_bds:function (prf, e, src){
            var row=prf.boxing().getRowByDom(src);
            if(row && (row.type=='label' || row.type=='label2' || row.lineset))
                return false;
        },
        _gridset2_dragdata:function (prf, e, src){
            var row=prf.boxing().getRowByDom(src);
            return row.dragkey||"normal";
        },
        _gridset2_dtest:function (prf, e, src){
            if(prf.getKey(src).split('-')[1]!=="CELLS")
                return false;

            var dp=ood.DragDrop.getProfile(),
                row=prf.boxing().getRowByDom(src);
            if(ood.get(dp,['dragData','data'])!==row.dragkey){
                    return false;                
            }
        },
        _grid_ondrop:function(profile){
            var ns=this;
            ns._change();
            return false;
        }
    }
});
﻿ood.Class('RAD.CustomArrows', 'ood.Module',{
    Instance:{
        iniComponents : function(){
            // [[Code created by EUSUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"mainPane")
                .setLeft("0.625em")
                .setTop("1.25em")
                .setWidth("41.833333333333336em")
                .setHeight("28.666666666666668em")
                .setShadow(false)
                .setResizer(false)
                .setCaption("$(RAD.custom_dlg.arrow.Custom Arrows)")
                .setMinBtn(false)
                .setMaxBtn(false)
                .beforeClose("_mainPane_beforeclose")
            );
            
            host.mainPane.append(
                ood.create("ood.UI.Block")
                .setHost(host,"bg")
                .setDock("fill")
                .setBorderType("inset")
                );
            
            host.bg.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ctl_block63")
                .setDock("fill")
                .setBorderType("none")
                .setOverflow("hidden")
                );
            
            host.ctl_block63.append(
                ood.create("ood.UI.Panel")
                .setHost(host,"ctl_panel3")
                .setDock("none")
                .setLeft("0.8333333333333334em")
                .setTop("3.125em")
                .setWidth("19.166666666666668em")
                .setHeight("21.75em")
                .setOverflow("hidden")
                .setCaption("$(RAD.custom_dlg.arrow.Arrow Start)")
                );
            
            host.ctl_panel3.append(
                ood.create("ood.UI.Group")
                .setHost(host,"ctl_group142")
                .setLeft("0.6875em")
                .setTop("0.6666666666666666em")
                .setWidth("7.75em")
                .setHeight("17.333333333333332em")
                .setOverflow("hidden")
                .setCaption("$RAD.custom_dlg.arrow.Type")
                );
            
            host.ctl_group142.append(
                ood.create("ood.UI.RadioBox")
                .setHost(host,"ctl_type")
                .setDirtyMark(false)
                .setItems([{
                    "id":"none",
                    "caption":"$RAD.custom_dlg.arrow.none"
                },
                {
                    "id":"classic",
                    "caption":"$RAD.custom_dlg.arrow.classic"
                },
                {
                    "id":"block",
                    "caption":"$RAD.custom_dlg.arrow.block"
                },
                {
                    "id":"open",
                    "caption":"$RAD.custom_dlg.arrow.open"
                },
                {
                    "id":"oval",
                    "caption":"$RAD.custom_dlg.arrow.oval"
                },
                {
                    "id":"diamond",
                    "caption":"$RAD.custom_dlg.arrow.diamond"
                }])
                .setDock("fill")
                .setLeft("0em")
                .setTop("0em")
                .setWidth("5.625em")
                .setValue("none")
                .afterUIValueSet("_ctl_afteruivalueset")
                .setCustomStyle({
                    "ITEM":"display:block"
                }
                )
                );
            
            host.ctl_panel3.append(
                ood.create("ood.UI.Group")
                .setHost(host,"ctl_group143")
                .setLeft("9.083333333333334em")
                .setTop("0.6666666666666666em")
                .setWidth("8.333333333333334em")
                .setHeight("8.333333333333334em")
                .setOverflow("hidden")
                .setCaption("$RAD.custom_dlg.arrow.Width")
                );
            
            host.ctl_group143.append(
                ood.create("ood.UI.RadioBox")
                .setHost(host,"ctl_width")
                .setDirtyMark(false)
                .setItems([{
                    "id":"narrow",
                    "caption":"$RAD.custom_dlg.arrow.narrow"
                },
                {
                    "id":"midium",
                    "caption":"$RAD.custom_dlg.arrow.midium"
                },
                {
                    "id":"wide",
                    "caption":"$RAD.custom_dlg.arrow.wide"
                }])
                .setDock("fill")
                .setLeft("0em")
                .setTop("0em")
                .setWidth("5.625em")
                .setHeight("5em")
                .setValue("narrow")
                .afterUIValueSet("_ctl_afteruivalueset")
                .setCustomStyle({
                    "ITEM":"display:block"
                }
                )
                );
            
            host.ctl_panel3.append(
                ood.create("ood.UI.Group")
                .setHost(host,"ctl_group144")
                .setLeft("9.083333333333334em")
                .setTop("9.666666666666666em")
                .setWidth("8.333333333333334em")
                .setHeight("8.333333333333334em")
                .setOverflow("hidden")
                .setCaption("$RAD.custom_dlg.arrow.Length")
                );
            
            host.ctl_group144.append(
                ood.create("ood.UI.RadioBox")
                .setHost(host,"ctl_length")
                .setDirtyMark(false)
                .setItems([{
                    "id":"short",
                    "caption":"$RAD.custom_dlg.arrow.short"
                },
                {
                    "id":"midium",
                    "caption":"$RAD.custom_dlg.arrow.midium"
                },
                {
                    "id":"long",
                    "caption":"$RAD.custom_dlg.arrow.long"
                }])
                .setDock("fill")
                .setLeft("0em")
                .setTop("0em")
                .setWidth("5.625em")
                .setHeight("5em")
                .setValue("short")
                .afterUIValueSet("_ctl_afteruivalueset")
                .setCustomStyle({
                    "ITEM":"display:block"
                }
                )
                );
            
            host.ctl_block63.append(
                ood.create("ood.UI.Panel")
                .setHost(host,"ctl_panel4")
                .setDock("none")
                .setLeft("20.583333333333332em")
                .setTop("3.125em")
                .setWidth("19.416666666666668em")
                .setHeight("21.75em")
                .setOverflow("hidden")
                .setCaption("$(RAD.custom_dlg.arrow.Arrow End)")
                );
            
            host.ctl_panel4.append(
                ood.create("ood.UI.Group")
                .setHost(host,"ctl_gtype2")
                .setLeft("0.6875em")
                .setTop("0.6666666666666666em")
                .setWidth("8.416666666666666em")
                .setHeight("17.333333333333332em")
                .setOverflow("hidden")
                .setCaption("$RAD.custom_dlg.arrow.Type")
                );
            
            host.ctl_gtype2.append(
                ood.create("ood.UI.RadioBox")
                .setHost(host,"ctl_type2")
                .setDirtyMark(false)
                .setItems([{
                    "id":"none",
                    "caption":"$RAD.custom_dlg.arrow.none"
                },
                {
                    "id":"classic",
                    "caption":"$RAD.custom_dlg.arrow.classic"
                },
                {
                    "id":"block",
                    "caption":"$RAD.custom_dlg.arrow.block"
                },
                {
                    "id":"open",
                    "caption":"$RAD.custom_dlg.arrow.open"
                },
                {
                    "id":"oval",
                    "caption":"$RAD.custom_dlg.arrow.oval"
                },
                {
                    "id":"diamond",
                    "caption":"$RAD.custom_dlg.arrow.diamond"
                }])
                .setDock("fill")
                .setLeft("0em")
                .setTop("0em")
                .setWidth("5.625em")
                .setValue("none")
                .afterUIValueSet("_ctl_afteruivalueset")
                .setCustomStyle({
                    "ITEM":"display:block"
                }
                )
                );
            
            host.ctl_panel4.append(
                ood.create("ood.UI.Group")
                .setHost(host,"ctl_group467")
                .setLeft("9.583333333333334em")
                .setTop("0.6666666666666666em")
                .setWidth("8.333333333333334em")
                .setHeight("8.333333333333334em")
                .setOverflow("hidden")
                .setCaption("$RAD.custom_dlg.arrow.Width")
                );
            
            host.ctl_group467.append(
                ood.create("ood.UI.RadioBox")
                .setHost(host,"ctl_width2")
                .setDirtyMark(false)
                .setItems([{
                    "id":"narrow",
                    "caption":"$RAD.custom_dlg.arrow.narrow"
                },
                {
                    "id":"midium",
                    "caption":"$RAD.custom_dlg.arrow.midium"
                },
                {
                    "id":"wide",
                    "caption":"$RAD.custom_dlg.arrow.wide"
                }])
                .setDock("fill")
                .setLeft("0em")
                .setTop("0em")
                .setWidth("6.25em")
                .setHeight("5em")
                .setValue("narrow")
                .afterUIValueSet("_ctl_afteruivalueset")
                .setCustomStyle({
                    "ITEM":"display:block"
                }
                )
                );
            
            host.ctl_panel4.append(
                ood.create("ood.UI.Group")
                .setHost(host,"ctl_group468")
                .setLeft("9.583333333333334em")
                .setTop("9.666666666666666em")
                .setWidth("8.333333333333334em")
                .setHeight("8.333333333333334em")
                .setOverflow("hidden")
                .setCaption("$RAD.custom_dlg.arrow.Length")
                );
            
            host.ctl_group468.append(
                ood.create("ood.UI.RadioBox")
                .setHost(host,"ctl_length2")
                .setDirtyMark(false)
                .setItems([{
                    "id":"short",
                    "caption":"$RAD.custom_dlg.arrow.short"
                },
                {
                    "id":"midium",
                    "caption":"$RAD.custom_dlg.arrow.midium"
                },
                {
                    "id":"long",
                    "caption":"$RAD.custom_dlg.arrow.long"
                }])
                .setDock("fill")
                .setLeft("0em")
                .setTop("0em")
                .setWidth("5.625em")
                .setHeight("5em")
                .setValue("short")
                .afterUIValueSet("_ctl_afteruivalueset")
                .setCustomStyle({
                    "ITEM":"display:block"
                }
                )
                );
            
            host.ctl_block63.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ctl_block64")
                .setLeft("5em")
                .setTop("0.3333333333333333em")
                .setWidth("30.833333333333332em")
                .setHeight("2.25em")
                .setBorderType("flat")
                .setBackground("#fff")
                .setOverflow("hidden")
                );
            
            host.ctl_block64.append(
                ood.create("ood.UI.SVGPaper")
                .setHost(host,"ctl_svgpaper80")
                .setLeft("0.625em")
                .setTop("0.125em")
                .setWidth("28.5em")
                .setHeight("1.75em")
                );
            
            host.ctl_svgpaper80.append(
                ood.create("ood.svg.path")
                .setHost(host,"ctl_line")
                .setSvgTag("Shapes:Line")
                .setAttr({
                    "path":"M,17,10L,327,10",
                    "stroke":"#bf852f",
                    "stroke-width":3
                }
                )
                );
            
            return children;
            // ]]Code created by EUSUI RAD Studio
        },
        _getValues:function(){
            var ns = this,
                type1 = ns.ctl_type.getUIValue(),
                width1 = ns.ctl_width.getUIValue(),
                length1 = ns.ctl_length.getUIValue(),
                type2 = ns.ctl_type2.getUIValue(),
                width2 = ns.ctl_width2.getUIValue(),
                length2 = ns.ctl_length2.getUIValue();
            return [type1 + "-" + width1 + "-" + length1, type2 + "-" + width2 + "-" + length2];
        },
        _ctl_afteruivalueset:function (profile){
            var ns=this,
                v=ns._getValues();
            ns.ctl_line.setAttr("KEY",{
                "arrow-start": v[0] ,
                "arrow-end": v[1]
            },false);
            ns.fireEvent("onChange",[v]);
        },
        init:function(prf,tplkey,prop){
            var ns=this,grid=prop.grid, cell;
            ood.merge(ns.properties,prop,'all');            

            cell=grid.getCellbyRowCol("arrow-start","value");
            if(cell){
                var start=cell.value&&cell.value.split('-');
                ns.ctl_type.setValue(start[0]||"none",true);
                ns.ctl_width.setValue(start[1]||"narrow",true);
                ns.ctl_length.setValue(start[2]||"short",true);
            }

            cell=grid.getCellbyRowCol("arrow-end","value");
            if(cell){
                var end=cell.value&&cell.value.split('-');
                ns.ctl_type2.setValue(end[0]||"none",true);
                ns.ctl_width2.setValue(end[1]||"narrow",true);
                ns.ctl_length2.setValue(end[2]||"short",true);
            }
            
            var v=ns._getValues();
            ns.ctl_line.setAttr("KEY",{
                "arrow-start": v[0] ,
                "arrow-end": v[1]
            },false);
        },
        _mainPane_beforeclose:function (profile){
            profile.boxing().hide();
            return false;
        }
    }
});
﻿ood.Class('RAD.PropEditor', 'ood.Module',{
    Instance:{
        iniComponents : function(){
            // [[Code created by ESDUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"dialog")
                .setLeft("10em")
                .setTop("2.5em")
                .setWidth("21.666666666666668em")
                .setHeight("22.5em")
                .setShadow(false)
                .setResizer(false)
                .setCaption("$(RAD.designer.attreditor.Attributes Editor)")
                .setMinBtn(false)
                .setMaxBtn(false)
                .beforeClose("_dialog_beforeclose")
            );
            
            host.dialog.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ctl_block1")
                .setDock("fill")
                .setBorderType("inset")
                );
            
            host.ctl_block1.append(
                ood.create("ood.UI.TreeGrid")
                .setHost(host,"grid")
                .setShowDirtyMark(false)
                .setEditable(true)
                .setRowHandler(false)
                .setColSortable(false)
                .setHeader([
                    {
                        "id":"name",
                        "caption":"$RAD.designer.attreditor.Attribute",
                        "width":"13.583333333333334em",
                        "type":"label"
                    },

                    {
                    "id":"value",
                    "caption":"$RAD.designer.attreditor.Value",
                    "flexSize":true,
                    "width":"10.666666666666666em",
                    "type":"input"
                }])
                .setTreeMode('none')
                .afterCellUpdated("_grid_aftercellupdated")
                .beforeComboPop('_grid_beforepop')
                );
            
            return children;
            // ]]Code created by ESDUI RAD Studio
        },
        customAppend : function(parent, subId, left, top){
            var ns=this,
                prop=ns.properties,
                target = prop.targetProfile.boxing()
                ;

            ns.DATA=prop.realData||{};

            // Give a chance to modify editor setting for rows
            //propName, subKey, propValue, clsName, target, cell, grid
            window.SPA && SPA.fe("onInitEditorRows", [prop.propKey, '', prop.realData, 
                'RAD.PropEditor', target,  prop.uiData, ns.grid]);

            if(window.SPA && SPA.events.onInitPropValueCell){
                ood.arr.each(prop.uiData,function(row){
                    ood.arr.each(row.cells,function(cell,i){
                         // Give a chance to modify editor setting for value cell
                        window.SPA && SPA.fe("onInitPropValueCell", [prop.propKey,prop.uiHeader[i].id, cell.value, "RAD.PropEditor", target, cell, ns.grid] );
                    });
                });
            }
            ns.grid.setRows(prop.uiData,true);
            
            var unFun=function(){
                ood.Event.keyboardHook('esc');
                ns.dialog.close();
            };
            ood("body").append(ns.dialog);
            ns.dialog.getRoot()
                .popToTop(ood(prop.src))
                .setBlurTrigger("RAD.PropEditor",unFun);
            ood.Event.keyboardHook('esc',0,0,0,unFun);

            ns.dialog.activate();
            
            ns._dirty=0;
            
            return true;
        },
        _grid_aftercellupdated:function (profile, cell, options, isHotRow){
            var ns=this;
            if("value" in cell){
                if(ns.properties.fc){
                    if(!ood.isSet(cell.value)||cell.value==="")
                        delete ns.DATA[cell.id.toLowerCase()] ;
                    else{
                        if(ood.isStr(cell.value) && cell.value.charAt(0)=='#'){
                            cell.value=cell.value.replace('#','');
                        }
                        ns.DATA[cell.id.toLowerCase()] = cell.value===false?"0":cell.value===true?"1":cell.value;
                    }
                }else{
                    if(!ood.isSet(cell.value)||cell.value==="")
                        delete ns.DATA[cell.id] ;
                    else{
                        ns.DATA[cell.id] = cell.value;
                    }
                }
            }
            var id = ns.properties.labelId;
            if(id && cell._row.id===id){
                ns.fireEvent('onLabelChanged',[cell.value]);
            }
            ns._dirty=1;
        },
        _grid_beforepop:function(profile, cell, editorprf, pos, e, src){
            var ns=this,
                target = prop.targetProfile.boxing(),
                prop=ns.properties;
            if(window.SPA && false===SPA.fe("beforeEditorComboPop", [
                prop.propKey, cell._col.id, cell.value, function(value){
                        editorprf.boxing().setUIValue(value||"",true);                    
                    }, "RAD.PropEditor", target, pos, profile.getSubNode('CELL', cell._serialId).get(0), cell, profile.boxing() ,editorprf&&editorprf.boxing()
                ] ))return false;
        },
        _dialog_beforeclose : function (profile) {
            var ns=this;

            if(ns._dirty){
                ns.fireEvent('onChanged',[ns.DATA]);
            }

            ns.DATA=null;
            profile.boxing().hide();
            ns.grid.removeAllRows();
            ns._dirty=0;
            return false;
        }
    }
});
﻿ood.Class('RAD.MixPropEditor', 'ood.Module', {
    Instance: {
        iniComponents: function () {
            // [[Code created by EUSUI RAD Studio
            var host = this, children = [], append = function (child) {
                children.push(child.get(0));
            };

            append(
                ood.create("ood.UI.Dialog")
                    .setHost(host, "dialog")
                    .setLeft("10em")
                    .setTop("2.5em")
                    .setWidth("44.166666666666664em")
                    .setHeight("22.5em")
                    .setShadow(false)
                    .setResizer(false)
                    .setCaption("$(RAD.designer.attreditor.Attributes Editor)")
                    .setMinBtn(false)
                    .onHotKeydown("_dialog_onhotkeydown")
                    .beforeClose("_dialog_beforeclose")
            );

            host.dialog.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ctl_block1")
                    .setDock("fill")
                    .setBorderType("inset")
            );

            host.ctl_block1.append(
                ood.create("ood.UI.TreeGrid")
                    .setHost(host, "grid")
                    .setShowDirtyMark(false)
                    .setRowNumbered(true)
                    .setEditable(true)
                    .setUidColumn('id')
                    .setRowHandlerWidth("6em")
                    .setTagCmds([
                        {
                            "id": "del1",
                            "location": "left",
                            "itemClass": "oodcon ood-uicmd-close",
                            "pos": "header",
                            "tips": "清空数据"
                        },
                        {
                            "id": "del2",
                            "location": "left",
                            "pos": "row",
                            "itemClass": "oodcon ood-uicmd-close",
                            "tips": "移除当前行"
                        }
                    ])
                    .setTreeMode('inhandler')
                    .setHotRowMode("show")
                    .setDropKeys("haha")
                    .setDragKey("haha")
                    .onInitHotRow("_grid_oninithotrow")
                    .beforeHotRowAdded("_gridTrend_beforehotrowadded")
                    .afterHotRowAdded("_gridTrend_afterHotRowAdded")
                    .onCmd("_grid_ontagcmd")
                    .beforeCellUpdated("_grid_beforecellupdated")
                    .afterCellUpdated("_grid_aftercellupdated")
                    .onClickCell("_grid_onclickcell")
                    .beforeComboPop("_grid_beforepop")
                    .onCommand("_grid_oncommand")
                    .onDrop("_grid_ondrop")
            );

            host.ctl_block1.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ctl_block4")
                    .setDock("bottom")
                    .setHeight("3.0833333333333335em")
            );

            host.ctl_block4.append(
                ood.create("ood.UI.Div")
                    .setHost(host, "ood_ui_div19")
                    .setTop("0em")
                    .setWidth("17.416666666666668em")
                    .setHeight("2.9166666666666665em")
                    .setRight("0em")
            );

            host.ood_ui_div19.append(
                ood.create("ood.UI.Button")
                    .setHost(host, "ctl_ba")
                    .setLeft("0em")
                    .setTop("0.5833333333333334em")
                    .setWidth("6.583333333333333em")
                    .setHeight("2em")
                    .setCaption("$RAD.designer.attreditor.Apply")
                    .onClick("_ctl_ba_onclick")
            );

            host.ood_ui_div19.append(
                ood.create("ood.UI.Button")
                    .setHost(host, "ctl_bc")
                    .setLeft("8.083333333333334em")
                    .setTop("0.5833333333333334em")
                    .setWidth("6.583333333333333em")
                    .setHeight("2em")
                    .setCaption("$RAD.designer.attreditor.Cancel")
                    .onClick("_ctl_bc_onclick")
            );

            host.ctl_block4.append(
                ood.create("ood.UI.Button")
                    .setHost(host, "ood_ui_button7")
                    .setLeft("1.5833333333333333em")
                    .setTop("0.5em")
                    .setWidth("6.583333333333333em")
                    .setHeight("2em")
                    .setCaption("[JSON]")
                    .onClick("_ood_ui_button7_onclick")
            );

            return children;
            // ]]Code created by EUSUI RAD Studio
        },
        customAppend: function (parent, subId, left, top) {
            var ns = this, prop = ns.properties
            target = prop.targetProfile.boxing()
            ;

            if (prop.subheader && prop.subheader.length) {
                prop.uiHeader.push({
                    id: "[sub]",
                    caption: '$(RAD.designer.attreditor.[sub])',
                    type: "button",
                    cellRenderer: function () {
                        return ood.getRes('RAD.designer.attreditor.' + prop.innerKey)
                    }
                });
            }

            // Give a chance to modify editor setting for rows
            window.SPA && SPA.fe("onInitEditorRows", [prop.propKey, prop.propN, prop.uiRows,
                'RAD.MixPropEditor', target, prop.uiRows, ns.grid]);

            if (window.SPA && SPA.events.onInitPropValueCell) {
                ood.arr.each(prop.uiRows, function (row) {
                    ood.arr.each(row.cells, function (cell, i) {
                        // Give a chance to modify editor setting for value cell
                        window.SPA && SPA.fe("onInitPropValueCell", [prop.propKey, prop.uiHeader[i].id, cell.value, "RAD.MixPropEditor", target, cell, ns.grid]);
                    });
                });
            }
            ns.grid.get(0)._targetProfile = prop.targetProfile;
            ns.grid.get(0)._targetPropKey = prop.propKey;

            ns.grid.setHeader(prop.uiHeader, true);
            ns.grid.setRows(prop.uiRows, true);

            ns._dirty = 0;

            var unFun = function () {
                ns.dialog.close();
            };
            ood("body").append(ns.dialog);
            ns.dialog.getRoot()
                .popToTop(ood(prop.src), null, null, function () {
                    if (prop.fixedRows) {
                        ns.grid.setHotRowMode('none');
                    } else {
                        ns.grid.setHotRowMode('show');
                        ns.grid.addHotRow();
                    }
                })
                .setBlurTrigger("RAD.MixPropEditor" + ns.$xid, unFun);

            if (prop.treeMode) {
                if (prop.treeMode == 'infirstcell') {
                    ns.grid.setTreeMode('infirstcell').setRowHandlerWidth('6em');
                } else if (prop.treeMode == 'none') {
                    ns.grid.setTreeMode('none').setRowHandlerWidth('4em');
                } else if (prop.treeMode == 'inhandler') {
                    ns.grid.setTreeMode('inhandler').setRowHandlerWidth('6em');
                }
            } else {
                ns.grid.setTreeMode('none').setRowHandlerWidth('4em');
            }


            ns.dialog.activate();

            return true;
        },
        _grid_beforecellupdated: function (profile, cell, options, isHotRow) {
            var ns = this;
            if ("value" in options && ns.properties.uniqueKey && ns.properties.uniqueKey === cell._col.id) {
                var grid = profile.boxing(), colid = cell._col.id, ok = true;
                ood.each(grid.getCells(null, colid, true), function (ac) {
                    if (cell !== ac && ac.value === options.value) return ok = false;
                });
                if (!ok) {
                    ood.message(ood.adjustRes("$(RAD.msg.$0 '$1' already exists-" + colid + "-" + options.value + ")"));
                    return false;
                }
            }
        },
        _grid_oninithotrow: function (profile) {
            var cols = profile.properties.header, cells = [];
            for (var i = 0, l = cols.length; i < l; i++)
                cells.push({});
            if (cols[cols.length - 1].id == "[sub]")
                cells[cols.length - 1].disabled = true;
            return cells;
        },
        _grid_aftercellupdated: function (profile, cell, options, isHotRow) {
            var ns = this;
            if ("value" in options) {
                if (ns.properties.fc) {
                    if (ood.isStr(cell.value) && cell.value.charAt(0) == '#') {
                        cell.value = cell.value.replace('#', '');
                    }
                }
            }
            cell.needCollect = 1;
            ns._dirty = 1;
        },
        _grid_ondrop: function (profile) {
            var ns = this;
            ns._dirty = 1;
            return false;
        },
        _grid_oncommand: function (profile, cell, proEditor, src, type) {
            var tagVar = cell._col.tagVar;
            if (tagVar) {
                if (tagVar.prop == 'imageClass') {
                    ood.getModule("RAD.SelFontAwesome", function (tid, module) {
                        module.render(true);
                        module.getRoot().popToTop(src)
                            .setBlurTrigger('design:pop:SelFontAwesome', function () {
                                module.destroy();
                            });

                        this.setEvents("onSel", function (value) {
                            if (proEditor) {
                                proEditor.boxing().setUIValue(value);
                            } else {
                                // 2. dont trigger onchange event
                                profile.boxing().updateCell(cell, {value: value});
                            }
                        });
                    });
                }
            }
        },
        _grid_ontagcmd: function (profile, row, cmdkey, e, src) {
            if (cmdkey != 'del1' && cmdkey != 'del2') return;

            var ns = this;
            ood.confirm('$RAD.Remove?', ood.getRes(row ? 'RAD.Are You Sure to remove this row' : 'Are You Sure to remove all') + '?', function () {
                if (row)
                    profile.boxing().removeRows([row.id]);
                else
                    profile.boxing().removeAllRows();
                ns._dirty = 1;
            }, null, null, null, ns.dialog.getRoot().cssRegion());
        },
        _grid_beforepop: function (profile, cell, editorprf, pos, e, src) {
            var prop = this.properties;
            if (window.SPA && false === SPA.fe("beforeEditorComboPop", [
                prop.propKey, cell._col.id, cell.value, function (value) {
                    editorprf.boxing().setUIValue(value || "", true);
                }, "RAD.MixPropEditor", prop.targetProfile.boxing(), pos, profile.getSubNode('CELL', cell._serialId).get(0), cell, profile.boxing(), editorprf && editorprf.boxing()
            ])) return false;
        },
        _gridTrend_afterHotRowAdded: function (profile, row) {
            var ns = this,
                prop = ns.properties;
            // special for treegrid row: to init cells
            if (prop.headerSize) {
                var cells = [];
                for (var i = 0, l = prop.headerSize; i < l; i++)
                    cells.push({value: ""});
                row._innerData = cells;
            }
            ood.arr.each(row.cells, function (cell) {
                if (cell.value) cell.needCollect = 1;
            });
        },
        _gridTrend_beforehotrowadded: function (profile, cellMap, row) {
            var ns = this,
                prop = ns.properties,
                uictrl = profile.boxing(),
                value = cellMap[profile.properties.header[0].id];
            if (ood.isSet(value) && value !== "") {
                if (ns.properties.treeMode)
                    row.sub = [];
                ood.arr.each(row.cells, function (cell) {
                    delete cell.disabled;
                });
                ns._dirty = 1;
                return true;
            } else {
                return false;
            }
        },

        _dialog_beforeclose: function (profile) {
            var ns = this;
            ns.dialog.getRoot().setBlurTrigger("RAD.MixPropEditor" + ns.$xid);

            if (!ns._noSave)
                ns._apply();

            ns.dialog.hide();
            ns.grid.removeAllRows();
            // reset row inner id
            ns.grid.get(0)._id = new ood.id();

            ood(ns.properties.src).focus();

            return false;
        },
        collectData: function (arows, header, brows) {
            var ns = this;
            if (!brows) brows = [];
            ood.arr.each(arows, function (row) {
                if (ood.UI.TreeGrid.isHotRow(row)) return;
                data = {};
                ood.arr.each(row.cells, function (cell, i) {
                    if (cell.needCollect) {
                        if (ns.properties.fc) {
                            data[header[i].toLowerCase()] = cell.value === false ? "0" : cell.value === true ? "1" : (cell.value + "");
                        } else {
                            data[header[i]] = cell.obj || cell.value;
                        }
                    }
                });
                if (row._innerData && ns.properties.innerKey) {
                    data[ns.properties.innerKey] = ood.clone(row._innerData, function (o, i) {
                        return (i + '').charAt(0) != '_'
                    })
                }
                brows.push(data);

                if (row.sub && row.sub.length) {
                    data.sub = [];
                    ns.collectData(row.sub, header, data.sub);
                }
            });
            return brows;
        },
        _apply: function () {
            var ns = this;
            if (ns._dirty) {
                var grid = ns.grid,
                    header = grid.getHeader('min');

                rows = ns.collectData(grid.getRows(), header);

                // avoid blurtrigger call _apply twice
                ns._dirty = 0;
                ns._noSave = 1;
                ns.fireEvent('onChanged', [rows, header]);
                delete ns._noSave;
            }
        },
        _ctl_ba_onclick: function (profile, e, src, value) {
            var ns = this;
            ns._apply();
            ns._noSave = 1;
            ns.dialog.close();
            delete ns._noSave;
        },
        _ctl_bc_onclick: function (profile, e, src, value) {
            var ns = this;
            ns._noSave = 1;
            ns.dialog.close();
            delete ns._noSave;
        },
        _grid_onclickcell: function (profile, cell, e, src) {
            var ns = this, prop = ns.properties;
            if (cell._col.id == "[sub]") {
                if (profile.box.isHotRow(cell._row)) return;

                if (!cell._row._innerData) cell._row._innerData = new Array(prop.fixedRows);

                var rows = [], row, acell;
                ood.arr.each(cell._row._innerData, function (item, index) {
                    row = {cells: []};
                    ood.arr.each(prop.subheader, function (col, j) {
                        var id = (col.id || col) + "";
                        //if(id=='renderer'/*||id=='tagVar'*/){
                        //    row.cells.push({disabled:true});
                        //    return;
                        //}
                        acell = {};
                        if (ood.isHash(item) && (id in item)) {
                            if (typeof item[id] == "object" || typeof item[id] == "function") {
                                acell.obj = item[id];
                            } else {
                                acell.value = item[id];
                            }
                            acell.needCollect = 1;
                        } else if (id == 'id') {
                            acell.value = item;
                            acell.needCollect = 1;
                        }
                        row.cells.push(acell);
                    });
                    rows.push(row);
                });

                ood.ComFactory.newCom('RAD.MixPropEditor', function () {
                    this.setProperties({
                        targetProfile: prop.targetProfile,
                        propKey: prop.propKey + "[sub]",

                        uiHeader: prop.subheader,
                        uiRows: rows,
                        treeMode: false,
                        fixedRows: prop.subFixedRows,
                        uniqueKey: prop.uniqueKey,
                        src: src
                    }).setEvents({
                        onChanged: function (items) {
                            cell._row._innerData = items;
                            ood(src).focus();

                            // parent editor
                            ns._dirty = 1;
                        }
                    });
                    this.show();
                });
            }
        },
        _dialog_onhotkeydown: function (profile, keyboard, e, src) {
            var ns = this;
            if (keyboard.key == 'esc')
                ns.dialog.close();
        },
        _ood_ui_button7_onclick: function (profile, e, src, value) {
            var ns = this,
                grid = ns.grid, target = grid;
            header = grid.getHeader('min'),
                rows = ns.collectData(grid.getRows(), header);
            var conf = {
                header: header,
                rows: rows,
                hasSub: true
            }


            ood.ModuleFactory.getCom('jsonEditor', function () {
                this.setProperties({
                    caption: 'Object Code',
                    imageClass: 'ri-braces-line',
                    text: rows,
                    onOK: function (obj, txt) {
                        ns._dirty = 1;
                        var collectData = function (items, rows) {
                            ood.arr.each(items, function (item, index) {
                                row = {'cells': []};
                                var ii = 0;
                                ood.arr.each(conf.header, function (col, j) {
                                    var id = (col.id || col) + "";
                                    //if(id=='renderer'/*||id=='tagVar'*/){
                                    //    row.cells.push({disabled:true});
                                    //    return;
                                    //}
                                    if (ood.absObj.$specialChars[id.charAt(0)]) return

                                    cell = {};
                                    if (conf.rows && conf.rows[item.id]) {
                                        cell = conf.rows[item.id].cells[j] ? ood.copy(conf.rows[item.id].cells[j]) : {};
                                        if (!('value' in cell)) {
                                            if (ood.isHash(item)) {
                                                if (id in item) {
                                                    if (typeof item[id] == "object" || typeof item[id] == "function") {
                                                        cell.obj = item[id];
                                                    } else {
                                                        cell.value = item[id];
                                                    }
                                                    cell.needCollect = 1;
                                                }
                                            } else if (id == 'id') {
                                                cell.value = item;
                                                cell.needCollect = 1;
                                            }
                                        }
                                    } else {
                                        if (ood.isHash(item) && (id in item)) {
                                            if (typeof item[id] == "object" || typeof item[id] == "function") {
                                                cell.obj = item[id];
                                            } else {
                                                cell.value = item[id];
                                            }
                                            cell.needCollect = 1;
                                        } else if (id == 'id') {
                                            cell.value = item;
                                            cell.needCollect = 1;
                                        }
                                    }
                                    // for those default is _true (For example: initFold )
                                    // if (!('value' in cell) && ('dftValue' in conf.header[ii])) {
                                    //     cell.value = header[ii].dftValue;
                                    // }
                                    row.cells.push(cell);
                                    // ignore hot row
                                    if (id == "id" && cell.value == ood.UI.TreeGrid._temprowid)
                                        row._ignore = 1;
                                    // this row cant be deleted
                                    if (conf.rows && conf.rows[item.id])
                                        row.tag = conf.rows[item.id].tag;
                                    ii++;
                                });
                                if (row._ignore) {
                                    return;
                                }
                                rows.push(row);
                                if (conf.innerKey) {
                                    row._innerData = ood.clone(item[conf.innerKey], function (o, i) {
                                        return (i + '').charAt(0) != '_'
                                    });
                                }
                                if (conf.hasSub) {
                                    row.sub = [];
                                    if (item.sub && item.sub.length) {
                                        item.sub = ood.UI.TreeGrid._adjustRows(ns, item.sub);

                                        var _id = new ood.id();
                                        ood.arr.each(item.sub, function (o, i) {
                                            if (ood.isHash(o) && !('id' in o)) o.id = item.id + "-" + _id.next();
                                        });

                                        collectData(item.sub, row.sub);
                                    }
                                }
                            });
                        };
                        var rows = [];
                        collectData(obj.properties.object, rows);
                        ns.grid.setRows(rows, true);

                    }
                });
                this.show();
            });
        }
    }
});
﻿ood.Class('RAD.CustomPackage', 'ood.Module',{
    Instance:{
        iniComponents : function(){
            // [[Code created by EUSUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"ctl_dialog")
                .setLeft("8.5em")
                .setTop("1.8333333333333333em")
                .setWidth("28.166666666666668em")
                .setHeight("21.416666666666668em")
                .setCaption("$(RAD.nwpackage.Build Options)")
                .setMinBtn(false)
                .setMaxBtn(false)
                .setOverflow("hidden")
                .beforeClose("_ctl_dialog_beforeclose")
            );
            
            host.ctl_dialog.append(
                ood.create("ood.UI.Group")
                .setHost(host,"ctl_group1")
                .setLeft("0.625em")
                .setTop("7.416666666666667em")
                .setWidth("11.833333333333334em")
                .setOverflow("hidden")
                .setCaption("$RAD.nwpackage.Appearance")
                .setToggleBtn(false)
                );
            
            host.ctl_group1.append(
                ood.create("ood.UI.RadioBox")
                .setHost(host,"ctl_lappearance")
                .setDirtyMark(false)
                .setDock("fill")
                .setLeft("0.625em")
                .setTop("0em")
                .setWidth("6.25em")
                .setHeight("6.25em")
                .setSelMode("multi")
                .setItemRow(true)
                .setCheckBox(true)
                .setValue("")
                );
            
            host.ctl_dialog.append(
                ood.create("ood.UI.Group")
                .setHost(host,"ctl_group3")
                .setLeft("13.333333333333334em")
                .setTop("0.625em")
                .setWidth("13.25em")
                .setHeight("13.416666666666666em")
                .setOverflow("hidden")
                .setCaption("$(RAD.nwpackage.Locale files)")
                .setToggleBtn(false)
                );
            
            host.ctl_group3.append(
                ood.create("ood.UI.RadioBox")
                .setHost(host,"ctl_llocale")
                .setDirtyMark(false)
                .setItems([{
                    "id":"en.js",
                    "caption":"$RAD.nwpackage.English",
                    "disabled":true
                },
                {
                    "id":"ru.js",
                    "caption":"$RAD.nwpackage.Russian",
                    "image":""
                },
                {
                    "id":"ja.js",
                    "caption":"$RAD.nwpackage.Japanese "
                },
                {
                    "id":"cn.js",
                    "caption":"$(RAD.nwpackage.Simplified Chinese)"
                },
                {
                    "id":"tw.js",
                    "caption":"$(RAD.nwpackage.Traditional Chinese)",
                    "image":""
                }])
                .setDock("fill")
                .setLeft("0.5625em")
                .setTop("0.375em")
                .setWidth("11.916666666666666em")
                .setHeight("10.5em")
                .setSelMode("multi")
                .setItemRow(true)
                .setCheckBox(true)
                .setValue("en.js")
                );
            
            host.ctl_dialog.append(
                ood.create("ood.UI.Group")
                .setHost(host,"ctl_group4")
                .setLeft("0.625em")
                .setTop("0.625em")
                .setWidth("11.833333333333334em")
                .setHeight("5.916666666666667em")
                .setOverflow("hidden")
                .setCaption("$(RAD.nwpackage.OOD core)")
                .setToggleBtn(false)
                );
            
            host.ctl_group4.append(
                ood.create("ood.UI.RadioBox")
                .setHost(host,"ctl_llib")
                .setDirtyMark(false)
                .setItems([{
                    "id":"ood-all.js",
                    "caption":"ood lib",
                    "image":"",
                    "disabled":true
                }])
                .setDock("fill")
                .setLeft("0.625em")
                .setTop("0.375em")
                .setWidth("6.25em")
                .setHeight("3.375em")
                .setSelMode("multi")
                .setItemRow(true)
                .setCheckBox(true)
                .setValue("ood-all.js")
                );
            
            host.ctl_dialog.append(
                ood.create("ood.UI.Button")
                .setHost(host,"ctl_ok")
                .setLeft("19.75em")
                .setTop("15.75em")
                .setWidth("4.375em")
                .setCaption("$inline.ok")
                .onClick("_ctl_ok_onclick")
                );
            
            host.ctl_dialog.append(
                ood.create("ood.UI.Button")
                .setHost(host,"ctl_cancel")
                .setLeft("14.166666666666666em")
                .setTop("15.75em")
                .setWidth("4.375em")
                .setCaption("$inline.cancel")
                .onClick("_ctl_cancel_onclick")
                );
            
            return children;
            // ]]Code created by EUSUI RAD Studio
        },
        customAppend : function(){
            var ns=this;
            var filename=SPA.curProjectPath + "/.settings/project.json",
                status=CONF.getStatus(filename),locale=["en.js"];

            status=status.Compile||{};
            
            if(status.lib){
                ns.ctl_llib.setValue(status.lib);
            }
            if(status.appearance){
                ns.ctl_lappearance.setValue(status.appearance);
            }
            
            if(status.locale){
                for(var i=0,l=status.locale.length,o;i<l;i++){
                    o=status.locale[i];
                    if(!ood.str.endWith(o,".js"))o=o+".js";
                    if(ood.arr.indexOf(locale, o)==-1){
                        locale.push(o);
                    }
                }
            }else  if(CONF.dftPackageLang){
                for(var i=0,l=CONF.dftPackageLang.length,o;i<l;i++){
                    o=CONF.dftPackageLang[i];
                    if(!ood.str.endWith(o,".js"))o=o+".js";
                    if(ood.arr.indexOf(locale, o)==-1){
                        locale.push(o);
                    }
                }
            }
            ns.ctl_llocale.setValue(locale);
            
            ns.ctl_dialog.showModal();
            return true;
        },
        _ctl_cancel_onclick:function (profile, e, src, value){
            this.ctl_dialog.close();
        },
        _ctl_ok_onclick:function (profile, e, src, value){
            var ns=this, conf={Compile:{
                lib:ns.ctl_llib.getValue(true), 
                appearance:ns.ctl_lappearance.getValue(true), 
                locale:ns.ctl_llocale.getValue(true)
            }};

            var filename=SPA.curProjectPath + "/.settings/project.json";
            var status=CONF.getStatus(filename);
            ood.merge(status,conf,'all');
            CONF.saveStatus(status, filename);
            
            ns.fireEvent("onOK", [conf.Compile.lib, conf.Compile.appearance, conf.Compile.locale]);
            ns._ok=1;
            ns.ctl_dialog.close();
        },
        _ctl_dialog_beforeclose:function (profile){
            if(!this._ok) this.fireEvent("onCancel");
        },
        events:{
            "onReady" : "_onReady"
        },
        _onReady:function (com, threadid){
            var items = [];
            ood.arr.each(CONF.designer_themes2,function(o){
                if(!o)return;
                items.push({
                    id:o,
                    caption:ood.str.initial(o),
                    disabled:o=="default"
                });
            });
            this.ctl_lappearance.setItems(items).setValue("default",true);
        }
    }
});
﻿ood.Class('RAD.APIConfig', 'ood.Module', {
    Instance: {
        iniComponents: function () {
            // [[Code created by EUSUI RAD Studio
            var host = this, children = [], append = function (child) {
                children.push(child.get(0));
            };

            append(
                ood.create("ood.UI.Dialog")
                    .setHost(host, "ood_ui_dialog2")
                    .setLeft("0em")
                    .setTop("0em")
                    .setWidth("66.667em")
                    .setHeight("43.333333333333336em")
                    .setCaption("$(RAD.api_dlg.Web API Caller)")
                    .setMinBtn(false)
                    .setMinWidth(780)
                    .setMinHeight(450)
                    .setModal(true)
                    .setConDockPadding({
                        "left": 4,
                        "top": 0,
                        "right": 4,
                        "bottom": 0
                    })
                    .setConDockSpacing({
                        "width": 0,
                        "height": 6
                    })
                    .beforeClose("_ood_ui_dialog2_beforeclose")
            );

            host.ood_ui_dialog2.append(
                ood.create("ood.UI.Div")
                    .setHost(host, "ood_ui_pane23")
                    .setDock("top")
                    .setWidth("8.334em")
                    .setHeight("2.8334em")
                    .setOverflow("hidden")
            );

            // host.ood_ui_pane23.append(
            //     ood.create("ood.UI.ComboInput")
            //         .setHost(host,"ood_url")
            //         .setDirtyMark(false)
            //         .setDock("top")
            //         .setDockMargin({
            //                 "left":0,
            //                 "top":3,
            //                 "right":0,
            //                 "bottom":4
            //             }
            //         )
            //         .setHeight("1.8333333333333333em")
            //         .setDynCheck(true)
            //         .setLabelSize(120)
            //         .setLabelCaption("$(RAD.Search)")
            //         .setType("none")
            //         .setImageClass("ood-icon-filter")
            //         .setCommandBtn("delete")
            //         .onChange("_ood_url_onChange")
            //         .onCommand("_ctl_input1_oncommand")
            // );

            host.ood_ui_pane23.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "ood_url")
                    //  .setRequired(true)
                    .setDirtyMark(false)
                    .setDock("width")
                    .setDockMargin({
                        "left": 0,
                        "top": 0,
                        "right": 260,
                        "bottom": 0
                    })
                    .setDockMinW("33.334em")
                    .setLeft("7em")
                    .setTop("0.75em")
                    .setWidth("16em")
                    .setHeight("1.75em")
                    .setLabelSize("8.334em")
                    .setLabelGap("0.334em")
                    .setLabelCaption(ood.getRes('$RAD.apiconfig.remoteURL') || "远程RUL:")
                    .setType("helpinput")
                    .setImageClass("ood-icon-filter")
                    .setCommandBtn("pop")
                    .onHotKeypress("_ctl_ood_url_onhotkey")
                    .onChange("_ctl_ood_url_onchange")
                    .onCommand("_ctl_ood_url_oncommand")
                    .beforePopShow("_ctl_ood_url_beforshow")
                // .onChange("_ood_url_onChange")
            );

            host.ood_ui_pane23.append(
                ood.create("ood.UI.CheckBox")
                    .setHost(host, "ood_asyn")
                    .setDirtyMark(false)
                    //.setDisabled(true)
                    .setTop("0.91667em")
                    .setRight("0.5em")
                    .setCaption("$(RAD.api_dlg.Asynchronous)")
                    .setValue(true)
            );
            host.ood_ui_pane23.append(
                ood.create("ood.UI.CheckBox")
                    .setHost(host, "autoRun")
                    .setDirtyMark(false)
                    //.setDisabled(true)
                    .setTop("0.91667em")
                    .setRight("7.5em")
                    .setCaption(ood.getRes('RAD.apiconfig.autoRun') || "自动运行")
                    .setValue(false)
            );
            host.ood_ui_pane23.append(
                ood.create("ood.UI.CheckBox")
                    .setHost(host, "isAllform")
                    .setDirtyMark(false)
                    //.setDisabled(true)
                    .setTop("0.91667em")
                    .setRight("15em")
                    .setCaption(ood.getRes('RAD.apiconfig.cascade') || "级联")
                    .setValue(false)
            );

            host.ood_ui_dialog2.append(
                ood.create("ood.UI.Div")
                    .setHost(host, "ood_ui_paneleft")
                    .setDock("left")
                    .setTop("5.8334em")
                    .setWidth("19.1667em")
                    .setHeight("32.5em")
            );

            host.ood_ui_paneleft.append(
                ood.create("ood.UI.Div")
                    .setHost(host, "ood_ui_pane272")
                    .setDock("top")
                    .setDockIgnoreFlexFill(true)
                    .setLeft("0em")
                    .setWidth("20em")
                    .setPosition(true)
                    .setConDockPadding({
                        "left": 4,
                        "top": 4,
                        "right": 4,
                        "bottom": 4
                    })
                    .setConDockSpacing({
                        "width": 0,
                        "height": 4
                    })
            );

            host.ood_ui_pane272.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "ood_reqtype")
                    .setDirtyMark(false)
                    .setLeft("0em")
                    .setTop("2.5em")
                    .setWidth("18.334em")
                    .setLabelSize("8.334em")
                    .setLabelGap("0.334em")
                    .setLabelCaption("$(RAD.api_dlg.Request Type)")
                    .setType("listbox")
                    .setItems([{
                        "id": "FORM",
                        "caption": "FORM"
                    },
                        {
                            "id": "JSON",
                            "caption": "JSON"
                        },
                        {
                            "id": "XML",
                            "caption": "XML"
                        },
                        {
                            "id": "SOAP",
                            "caption": "SOAP"
                        }])
                    .setValue("FORM")
            );

            host.ood_ui_pane272.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "ood_rsptype")
                    .setDirtyMark(false)
                    .setLeft("0em")
                    .setTop("5em")
                    .setWidth("18.334em")
                    .setLabelSize("8.334em")
                    .setLabelGap("0.334em")
                    .setLabelCaption("$(RAD.api_dlg.Response Type)")
                    .setType("listbox")
                    .setItems([{
                        "id": "JSON",
                        "caption": "JSON"
                    },
                        {
                            "id": "TEXT",
                            "caption": "TEXT"
                        },
                        {
                            "id": "XML",
                            "caption": "XML"
                        },
                        {
                            "id": "SOAP",
                            "caption": "SOAP"
                        }])
                    .setValue("JSON")
            );

            host.ood_ui_pane272.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "ood_method")
                    .setDirtyMark(false)
                    .setLeft("0em")
                    .setTop("7.5em")
                    .setWidth("18.334em")
                    .setLabelSize("8.334em")
                    .setLabelGap("0.334em")
                    .setLabelCaption("$(RAD.api_dlg.Query Method)")
                    .setType("listbox")
                    .setItems([{
                        "id": "auto",
                        "caption": "auto"
                    },
                        {
                            "id": "GET",
                            "caption": "GET"
                        },
                        {
                            "id": "POST",
                            "caption": "POST"
                        },
                        {
                            "id": "PUT",
                            "caption": "PUT"
                        },
                        {
                            "id": "DELETE",
                            "caption": "DELETE"
                        }])
                    .setValue("auto")
            );

            host.ood_ui_pane272.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "ood_proxytype")
                    .setDirtyMark(false)
                    .setLeft("0em")
                    .setTop("0em")
                    .setWidth("18.334em")
                    .setLabelSize("8.334em")
                    .setLabelGap("0.334em")
                    .setLabelCaption("$(RAD.api_dlg.Proxy Type)")
                    .setType("listbox")
                    .setItems([{
                        "id": "auto",
                        "caption": "auto"
                    },
                        {
                            "id": "AJAX",
                            "caption": "AJAX"
                        },
                        {
                            "id": "JSONP",
                            "caption": "JSONP"
                        },
                        {
                            "id": "XDMI",
                            "caption": "XDMI"
                        }])
                    .setValue("auto")
                    .afterValueSet("_ood_ui_comboinput207_aftervalueset")
            );

            host.ood_ui_paneleft.append(
                ood.create("ood.UI.Stacks")
                    .setHost(host, "ood_ui_foldingtabs1")
                    .setItems([{
                        "id": "a",
                        "caption": "$(RAD.api_dlg.Authorization)"
                    },
                        {
                            "id": "b",
                            "caption": "$(RAD.api_dlg.Request Header)"
                        },
                        {
                            "id": "c",
                            "caption": "$(RAD.api_dlg.Cookies Smulation)"
                        },
                        {
                            "id": "d",
                            "caption": "$(RAD.api_dlg.Other Query Options)"
                        }])
                    .setDockMargin({
                        "left": 0,
                        "top": 120,
                        "right": 0,
                        "bottom": 0
                    })
                    .setWidth("18.91667em")
                    .setHeight("25.5em")
                    .setValue("a")
            );

            host.ood_ui_foldingtabs1.append(
                ood.create("ood.Module.JSONEditor", "ood.Module")
                    .setHost(host, "m_header")
                    .setProperties({
                        "keyCaption": "$(RAD.api_dlg.Key)",
                        "valueCaption": "$(RAD.api_dlg.Value)",
                        "multiLineValue": false,
                        "notree": true
                    })
                , "b");

            host.ood_ui_foldingtabs1.append(
                ood.create("ood.Module.JSONEditor", "ood.Module")
                    .setHost(host, "m_cookies")
                    .setProperties({
                        "keyCaption": "$(RAD.api_dlg.Key)",
                        "valueCaption": "$(RAD.api_dlg.Value)",
                        "multiLineValue": false,
                        "notree": true
                    })
                , "c");

            host.ood_ui_foldingtabs1.append(
                ood.create("ood.Module.JSONEditor", "ood.Module")
                    .setHost(host, "m_options")
                    .setProperties({
                        "keyCaption": "$(RAD.api_dlg.Key)",
                        "valueCaption": "$(RAD.api_dlg.Value)",
                        "multiLineValue": false,
                        "notree": true
                    })
                , "d");

            host.ood_ui_foldingtabs1.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "ood_token")
                    .setDirtyMark(false)
                    .setLeft("0em")
                    .setTop("0.8334em")
                    .setWidth("18.334em")
                    .setLabelSize("8.334em")
                    .setLabelGap("0.334em")
                    .setLabelCaption("$(RAD.api_dlg.OAuth2Token)")
                    .setType("input")
                , "a");

            host.ood_ui_foldingtabs1.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "ood_username")
                    .setDirtyMark(false)
                    .setLeft("0em")
                    .setTop("3.334em")
                    .setWidth("18.334em")
                    .setLabelSize("8.334em")
                    .setLabelGap("0.334em")
                    .setLabelCaption("$(RAD.api_dlg.User Name)")
                    .setType("input")
                , "a");

            host.ood_ui_foldingtabs1.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "ood_password")
                    .setDirtyMark(false)
                    .setLeft("0em")
                    .setTop("5.8334em")
                    .setWidth("18.334em")
                    .setLabelSize("8.334em")
                    .setLabelGap("0.334em")
                    .setLabelCaption("$(RAD.api_dlg.Password)")
                    .setType("input")
                , "a");

            host.ood_ui_dialog2.append(
                ood.create("ood.UI.Div")
                    .setHost(host, "ood_ui_pane22")
                    .setDock("fill")
                    .setDockMargin({
                        "left": 6,
                        "top": 0,
                        "right": 0,
                        "bottom": 0
                    })
                    .setLeft("25.833333333333332em")
                    .setTop("9.1667em")
                    .setWidth("12.1667em")
                    .setHeight("12.91667em")
                    .setConDockPadding({
                        "left": 0,
                        "top": 0,
                        "right": 0,
                        "bottom": 2
                    })
                    .setConDockSpacing({
                        "width": 0,
                        "height": 4
                    })
            );

            host.ood_ui_pane22.append(
                ood.create("ood.UI.HTMLButton")
                    .setHost(host, "ood_ui_htmlbutton3")
                    .setDock("bottom")
                    .setDockOrder(3)
                    .setDockMargin({
                        "left": 6,
                        "top": 2,
                        "right": 6,
                        "bottom": 2
                    })
                    .setWidth("11em")
                    .setHeight("1.8334em")
                    .setHtml("$(RAD.api_dlg.Test the Web API)")
                    .onClick("_ood_ui_htmlbutton3_onclick")
            );

            host.ood_ui_pane22.append(
                ood.create("ood.UI.Layout")
                    .setType("vertical")
                    .setHost(host, "ood_ui_layout7")
                    .setItems([{
                        "id": "before",
                        "size": 100,
                        "min": 10,
                        "locked": false,
                        "folded": false,
                        "hidden": false,
                        "cmd": false,
                        "pos": "before"
                    },
                        {
                            "id": "main",
                            "size": 120,
                            "min": 10
                        }])
                    .setLeft("0em")
                    .setTop("0em")
                    .setFlexSize(true)
                    .setTransparent(true)
            );

            host.ood_ui_layout7.append(
                ood.create("ood.UI.Group")
                    .setHost(host, "ood_ui_group7")
                    .setDock("fill")
                    .setDockOrder(2)
                    .setLeft("5.8334em")
                    .setWidth("8.334em")
                    .setHeight("15em")
                    .setConDockPadding({
                        "left": 4,
                        "top": 4,
                        "right": 4,
                        "bottom": 4
                    })
                    .setConDockSpacing({
                        "width": 4,
                        "height": 0
                    })
                    .setCaption("$(RAD.api_dlg.Request Data Setting)")
                    .setToggleBtn(false)
                , "before");

            host.ood_ui_group7.append(
                ood.create("ood.UI.Div")
                    .setHost(host, "ood_ui_pane15")
                    .setDock("left")
                    .setTop("0.8334em")
                    .setWidth("26em")
                    .setHeight("8.334em")
                    .setConDockSpacing({
                        "width": 0,
                        "height": 4
                    })
                    .setConDockFlexFill("height")
            );

            host.ood_ui_pane15.append(
                ood.create("ood.UI.Stacks")
                    .setHost(host, "ood_ui_foldingtabs11")
                    .setItems([
                        {
                            "id": "b",
                            "caption": "$(RAD.api_dlg.Request Datasource)",
                            "height": 180
                        }, {
                            "id": "c",
                            "caption": "$(RAD.api_dlg.Request Parameters)",
                            "height": 170,
                            "imageClass": ""
                        }])
                    .setLeft("9.58334em")
                    .setTop("0em")
                    .setWidth("8.41667em")
                    .setHeight("21em")
                    .setValue("b")
            );

            host.ood_ui_foldingtabs11.append(
                ood.create("ood.UI.TreeGrid")
                    .setHost(host, "ood_reqds")
                    .setDirtyMark(false)
                    .setShowDirtyMark(false)
                    .setLeft("0em")
                    .setTop("0em")
                    .setSelMode("multibycheckbox")
                    .setEditable(true)
                    .setRowHandlerWidth("4em")
                    .setColSortable(false)
                    .setHeader([{
                        "id": "source",
                        "caption": "$(RAD.api_dlg.Datasource)",
                        "width": "6.667em",
                        "type": "label"
                    },
                        {
                            "id": "path",
                            "caption": "$(RAD.api_dlg.To Data Path)",
                            "width": "6.667em",
                            "flexSize": true,
                            "type": "input",
                            "editable": true
                        },

                        {
                            "id": "desc",
                            "caption": ood.getRes('RAD.apiconfig.paramUsage') || "参数用途",
                            "width": "6.667em",
                            "flexSize": true,
                            "type": "input",
                            "editable": false
                        }])
                    .setGrpCols({})
                    .setRows({})
                    .setTreeMode("none")
                    .setValue("")
                    .onChange("_ood_reqds_onchange")
                    .onRowSelected("_ontrows")
                    .beforeRowActive("_tg_beforerowactive")
                    .beforeCellUpdated("_acu")
                    .afterCellUpdated("_ood_reqds_bcellupdated")
                    .setCustomClass({
                        "HFMARK": "ood-uicmd-none"
                    })
                , "b");

            host.ood_ui_foldingtabs11.append(
                ood.create("ood.Module.JSONEditor", "ood.Module")
                    .setHost(host, "m_reqparams")
                    .setProperties({
                        "keyCaption": "$(RAD.api_dlg.Key)",
                        "valueCaption": "$(RAD.api_dlg.Value)",
                        "multiLineValue": false
                    })
                    .setEvents({
                        "onchange": "_m_reqparams_onchange"
                    })
                , "c");

            host.ood_ui_group7.append(
                ood.create("ood.UI.Panel")
                    .setHost(host, "ood_ui_panel44")
                    .setLeft("19.58334em")
                    .setTop("0.8334em")
                    .setWidth("24.5em")
                    .setHeight("17.083333333333332em")
                    .setConDockSpacing({
                        "width": 0,
                        "height": 4
                    })
                    .setCaption("$(RAD.api_dlg.Request Data)")
                    .setBorderType("none")
                    .setNoFrame(true)
                    .setCustomClass({
                        "INFO": "ood-uicmd-land"
                    })
            );

            host.ood_ui_panel44.append(
                ood.create("ood.UI.Input")
                    .setHost(host, "ood_reqtext")
                    .setDisabled(true)
                    .setDock("fill")
                    .setLeft("6.667em")
                    .setTop("4.1667em")
                    .setHeight("10em")
                    .setLabelGap("0.334em")
                    .setMultiLines(true)
            );

            host.ood_ui_layout7.append(
                ood.create("ood.UI.Group")
                    .setHost(host, "ood_ui_group10")
                    .setDock("fill")
                    .setLeft("6.667em")
                    .setWidth("8.334em")
                    .setHeight("19.1667em")
                    .setConDockPadding({
                        "left": 4,
                        "top": 4,
                        "right": 4,
                        "bottom": 4
                    })
                    .setConDockSpacing({
                        "width": 4,
                        "height": 0
                    })
                    .setCaption("$(RAD.api_dlg.Response Data Setting)")
                    .setToggleBtn(false)
                , "main");

            host.ood_ui_group10.append(
                ood.create("ood.UI.Panel")
                    .setHost(host, "ood_ui_panel45")
                    .setDock("left")
                    .setTop("1.667em")
                    .setWidth("30em")
                    .setHeight("17.08333em")
                    .setCaption("$(RAD.api_dlg.Response to Target)")
                    .setBorderType("flat")
                    .setNoFrame(true)
                    .setCustomClass({
                        "INFO": "ood-uicmd-land"
                    })
            );

            host.ood_ui_panel45.append(
                ood.create("ood.UI.TreeGrid")
                    .setHost(host, "ood_rsptarget")
                    .setDirtyMark(false)
                    .setShowDirtyMark(false)
                    .setLeft("0em")
                    .setTop("0em")
                    .setSelMode("multibycheckbox")
                    .setEditable(true)
                    .setRowHandlerWidth("5em")
                    .setColSortable(false)
                    .setHeader(
                        [
                            {
                                "id": "name",
                                "caption": ood.getRes('RAD.apiconfig.componentName') || "组件名称",
                                "width": "10em",
                                "flexSize": true,
                                "type": "label",
                                "editable": true
                            },
                            {
                                "id": "path",
                                "caption": ood.getRes('RAD.apiconfig.mappingAddress') || "映射地址",
                                "width": "10em",
                                "flexSize": true,
                                "type": "input"
                            },
                            {
                                "id": "type",
                                "caption": ood.getRes('RAD.apiconfig.componentType') || "组件类型",
                                "width": "8em",
                                "flexSize": true,
                                "type": "label",
                                "editable": false
                            }
                        ])
                    //.setTreeMode("none")
                    .setValue("")
                    .onRowSelected("_ontrows2")
                    .beforeRowActive("_tg_beforerowactive")
                    .beforeCellUpdated("_acu")
                    .setCustomClass({
                        "HFMARK": "ood-uicmd-none"
                    })
            );

            host.ood_ui_group10.append(
                ood.create("ood.UI.Panel")
                    .setHost(host, "ood_ui_panel17")
                    .setLeft("20.41667em")
                    .setTop("1.667em")
                    .setWidth("24.5em")
                    .setHeight("17.08333em")
                    .setConDockSpacing({
                        "width": 0,
                        "height": 4
                    })
                    .setCaption("$(RAD.api_dlg.Response Callback)")
                    .setNoFrame(true)
            );

            host.ood_ui_panel17.append(
                ood.create("ood.UI.TreeGrid")
                    .setHost(host, "ood_rspfun")
                    .setDirtyMark(false)
                    .setShowDirtyMark(false)
                    .setLeft("0em")
                    .setTop("0em")
                    .setSelMode("multibycheckbox")
                    .setEditable(true)
                    .setRowHandlerWidth("2em")
                    .setColSortable(false)
                    .setHeader([{
                        "id": "type",
                        "caption": "$(RAD.api_dlg.Callback Type)",
                        "flexSize": true,
                        "width": "6em",
                        "type": "label"
                    },
                        {
                            "id": "source",
                            "flexSize": true,
                            "caption": "$(RAD.api_dlg.Callback)",
                            "width": "12em",
                            "type": "label"
                        }])
                    .setTreeMode("none")
                    .setValue("")
                    .onRowSelected("_ontrows")
                    .beforeRowActive("_tg_beforerowactive")
                    .setCustomClass({
                        "HFMARK": "ood-uicmd-none"
                    })
            );

            return children;
            // ]]Code created by EUSUI RAD Studio
        },
        events: {
            onReady: "_onready"
        },
        _onready: function () {

            if (CONF.getClientMode() != 'project') this.ood_url.setType('none');

        },

        _ctl_ood_url_onhotkey: function (profile, keyboard, e, src) {
            if (keyboard[0] == '/') {
                this._reSetValue(profile);
            }
        },

        _ctl_ood_url_beforshow: function (profile) {
            var ns = this,
                newValue = ns.ood_url.getValue();
            newValue = newValue || '/' + SPA.getCurrentClassName().replace('.', '/');
            this._reSetValue(profile, newValue);
            // if (newValue && newValue == '') {
            //     this._reSetValue(profile);
            // }
        },


        _reSetValue: function (profile, newValue) {
            var ns = this,
                prop = ns.properties;
            //    newValue=ns.ood_url.getValue();
            var ns = this, ins = profile.boxing(), t = SPA.curProjectConfig.$ConstantData;
            var items = [];

            ns._filter = ".*" + newValue + ".*";
            ood.Dom.busy();
            var apipath = '';
            if (SPA.curProjectConfig.$ConstantData && SPA.curProjectConfig.$ConstantData.apipath) {
                apipath = SPA.curProjectConfig.$ConstantData.apipath;
            }
            ood.Ajax(CONF.getAPIService, {
                    "path": apipath,
                    'currentClassName': SPA.getCurrentClassName(),
                    pattern: ns._filter
                },
                function (txt) {
                    var obj = txt.data;
                    if (obj && !obj.error) {
                        ood.arr.each(obj, function (o) {
                            items.push({
                                id: o.id,
                                caption: o.caption,
                                disabled: o.disabled,
                                properties: o.properties,
                                getProperties: function () {
                                    return this.properties;
                                }

                            });
                        });
                    }

                    if (!obj || obj.length == 0) {
                        items.push({
                            id: newValue,
                            caption: ood.getRes('RAD.apiconfig.noAPIFound') || '没有发现匹配的API!',
                        });
                    }

                    try {
                        ins.expand();
                    } catch (e) {

                    }
                    ins.setItems(items);

                    ood.Dom.free();
                }, function (obj) {
                    ins.setItems(items);
                    ood.Dom.free();
                }, null, {method: 'post'}).start();

        },


        _ctl_ood_url_onchange: function (profile, oldValue, newValue) {
            var ns = this;
            var item = profile.boxing().getItemByItemId(newValue);
            if (item) {
                this.setDataToEditor(item, ns._host)
            } else {
                this._reSetValue(profile, newValue);
            }

        },

        _ctl_ood_url_oncommand: function (profile, src) {
            var ns = this, prop = this.getDataFromEditor(), queryArgs = prop.queryArgs;

            profile.boxing().setValue("/LOCALESD/executeCMD", true);

            var expression = queryArgs.expression;

            ood.getModule("RAD.expression.ExpressionTemp", function () {
                this.setData({projectName: SPA.curProjectName, className: SPA.getCurrentClassName()});
                this.setDataToEditor(ns._host, ns._cls, prop);
                this.setEvents("onDestroy", function () {
                    ns.m_reqparams.setProperties("value", prop.queryArgs);
                    ns.updateRequestData(prop.queryArgs);

                });
                this.show();
                this.initData();
                this._fireEvent('afterShow');

            });
            // this._reSetValue(profile, "");
        },


        // object to editor
        setDataToEditor: function (api, host, cls) {
            var ns = this,
                prop = api.getProperties(),
                arr, v, values, t, m;
            ns._oldprop = prop;
            ns._host = host;
            ns.cls = cls;

            var packageName =SPA.getCurrentClassName().substring(0, SPA.getCurrentClassName().lastIndexOf("."));

            var queryURL = prop.queryURL || '/' + packageName.replaceAll('.', '/');
            ns.ood_url.setValue(queryURL);
            if (!prop.queryAsync && (prop.queryAsync == false || prop.queryAsync == 'false')) {
                ns.ood_asyn.setValue(false);
            } else {
                ns.ood_asyn.setValue(true);
            }

            ns.autoRun.setValue(prop.autoRun);
            ns.isAllform.setValue(prop.isAllform);
            ns.ood_method.setValue(prop.queryMethod);
            ns.ood_username.setValue(prop.queryUserName);
            ns.ood_password.setValue(prop.queryPassword);
            ns.ood_reqtype.setValue(prop.requestType);
            ns.ood_rsptype.setValue(prop.responseType);
            ns.ood_proxytype.setValue(prop.proxyType);
            ns.ood_token.setValue(prop.oAuth2Token);


            // requestDataSource
            (function () {
                arr = [];
                v = {};
                values = [];
                ood.arr.each(prop.requestDataSource, function (o) {
                    v[o.type + "-" + o.name] = o.path;

                    if (o.type == 'SPA') {
                        m = "SPA" + "-" + o.name;
                        values.push(m);
                        arr.push({
                            id: m,
                            bindertype: "SPA",
                            cells: [o.name, o.path, "SPA参数"]
                        });
                    }
                });


                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.DataBinder'])
                        return;
                    t = db.getName();
                    m = "DATABINDER" + "-" + t;
                    if (m in v) values.push(m);
                    arr.push({
                        id: m,
                        bindertype: "DATABINDER",
                        cells: [t, v[m] || "", "自定义"]
                    });
                });


                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.PageBar'])
                        return;

                    t = db.getAlias();

                    m = "PAGEBAR" + "-" + t;

                    if (m in v) values.push(m);
                    arr.push({
                        id: m,
                        bindertype: "PAGEBAR",
                        cells: [t, v[m] || "", "分页参数"]
                    });
                });


                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.TreeView'])
                        return;
                    t = db.getAlias();

                    m = "TREEVIEW" + "-" + t;
                    if (m in v) values.push(m);
                    arr.push({
                        id: m,
                        bindertype: "TREEVIEW",
                        cells: [t, v[m] || "", "当前选中行"]
                    });
                });

                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.FusionChartsXT'])
                        return;
                    t = db.getAlias();

                    m = "FCHART" + "-" + t;

                    if (m in v) values.push(m);

                    arr.push({
                        id: m,
                        bindertype: "FCHART",
                        cells: [t, v[m] || "", "当前选中"]
                    });
                });


                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.Gallery'])
                        return;
                    t = db.getAlias();
                    m = "GALLERY" + "-" + t;
                    if (m in v) values.push(m);
                    arr.push({
                        id: m,
                        bindertype: "GALLERY",
                        cells: [t, v[m] || "", "当前选中"]
                    });
                });

                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.ContentBlock'])
                        return;
                    t = db.getAlias();
                    m = "CONTENTBLOCK" + "-" + t;
                    if (m in v) values.push(m);
                    arr.push({
                        id: m,
                        bindertype: "CONTENTBLOCK",
                        cells: [t, v[m] || "", "当前选中"]
                    });
                });

                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.TitleBlock'])
                        return;
                    t = db.getAlias();
                    m = "TITLEBLOCK" + "-" + t;
                    if (m in v) values.push(m);
                    arr.push({
                        id: m,
                        bindertype: "TITLEBLOCK",
                        cells: [t, v[m] || "", "当前选中"]
                    });
                });

                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.Module'])
                        return;
                    t = db.getName();

                    m = "MODULE" + "-" + t;

                    if (m in v) values.push(m);

                    arr.push({
                        id: m,
                        bindertype: "MODULE",
                        cells: [t, v[m] || t, "子模块"]
                    });
                });


                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.TreeGrid'])
                        return;
                    t = db.getAlias();

                    m = "TREEGRID" + "-" + t;

                    if (m in v) values.push(m);

                    arr.push({
                        id: m,
                        bindertype: "TREEGRID",
                        cells: [t, v[m] || "", "所有选中行ID"]
                    });
                });
                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.TreeGrid'])
                        return;
                    t = db.getAlias();

                    m = "TREEGRID" + "-" + t;

                    if (m in v) values.push(m);

                    arr.push({
                        id: m,
                        bindertype: "TREEGRID",
                        cells: [t, v[m] || "", "所有选中行ID"]
                    });
                });

                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.TreeGrid'])
                        return;
                    t = db.getAlias();

                    m = "TREEGRIDROW" + "-" + t;

                    if (m in v) values.push(m);

                    arr.push({
                        id: m,
                        bindertype: "TREEGRIDROW",
                        cells: [t, v[m] || "", "当前选中行"]
                    });
                });


                ood.each(host, function (ui) {
                    if (!ui || !ui.Class || !ui.Class['ood.absContainer'] || ui.getFormElements().isEmpty())
                        return;
                    t = ui.getAlias();
                    m = "FORM" + "-" + t;
                    if (m in v) values.push(m);
                    arr.push({
                        id: m,
                        bindertype: "FORM",
                        cells: [t, v[m] || "", "表单数据"]
                    });
                });


                ns.ood_reqds.setRows(arr).setValue(values.join(";"));
            }());

            // responseDataTarget
            (function () {
                arr = [];
                v = {};
                values = [];
                ood.arr.each(prop.responseDataTarget, function (o) {
                    v[o.type + "-" + (o.name || "")] = o.path;
                });


                if (m in v) values.push(m);

                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.DataBinder'])
                        return;
                    t = db.getName();
                    m = "DATABINDER" + "-" + t;
                    if (m in v) values.push(m);
                    arr.push({
                        id: m,
                        bindertype: "DATABINDER",
                        cells: ["数据绑定", t, v[m] || ""]
                    });
                });

                //表单数据
                var formRow = [], hasFormValue = false;

                ood.each(host, function (ui) {
                    if (!ui || !ui.Class || !ui.Class['ood.absContainer'] || ui.getFormElements().isEmpty())
                        return;
                    t = ui.getAlias();
                    m = "FORM" + "-" + t;

                    if (m in v) {
                        values.push(m)
                        hasFormValue = true;
                    }
                    formRow.push({
                        id: m,
                        bindertype: "FORM",
                        cells: [t, v[m] || "data", "表单"]
                    });
                });

                if (formRow.length > 0) {
                    arr.push({
                        id: 'ALLFORM',
                        bindertype: "FORM",
                        initFold: !hasFormValue,
                        cells: ["<b>表单</b>"],
                        sub: formRow
                    })
                }


                //组件列表
                var gridRow = [], hasGridValue = false;

                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.TreeGrid'])
                        return;
                    t = db.getAlias();
                    m = "TREEGRID" + "-" + t;

                    if (m in v) {
                        values.push(m)
                        hasGridValue = true;
                    }

                    gridRow.push({
                        id: m,
                        bindertype: "TREEGRID",
                        cells: [t, v[m] || "data", "GRID"]
                    });
                });

                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.Gallery'])
                        return;
                    t = db.getAlias();
                    m = "GALLERY" + "-" + t;

                    if (m in v) values.push(m);
                    gridRow.push({
                        id: m,
                        bindertype: "GALLERY",
                        cells: [t, v[m] || "data", "GALLERY"]
                    });
                });


                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.PageBar'])
                        return;
                    t = db.getAlias();
                    m = "PAGEBAR" + "-" + t;
                    if (m in v) values.push(m);
                    gridRow.push({
                        id: m,
                        bindertype: "PAGEBAR",
                        cells: [t, v[m] || "size", "设置最大记录数"]
                    });
                });

                if (gridRow.length > 0) {
                    arr.push({
                        id: 'GRID',
                        initFold: !hasGridValue,
                        bindertype: "GRID",
                        cells: ["<b>Grid列表</b>"],
                        sub: gridRow
                    })
                }


                //TitleBlcok列表
                var titleBlockRow = [], hasTitleBlockValue = false;
                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.TitleBlock'] )
                        return;
                    t = db.getAlias();
                    m = "TITLEBLOCK" + "-" + t;
                    if (m in v) {
                        values.push(m)
                        hasTitleBlockValue = true;
                    }
                    ;
                    titleBlockRow.push({
                        id: m,
                        bindertype: "TITLEBLOCK",
                        cells: [t, v[m] || "data", "摘要项填充"]
                    });
                });

                if (titleBlockRow.length > 0) {
                    arr.push({
                        id: 'TITLEBLOCK',
                        initFold: !hasTitleBlockValue,
                        bindertype: "TITLEBLOCK",
                        cells: ["<b>标题摘要</b>"],
                        sub: titleBlockRow
                    })
                }


                //TitleBlcok列表
                var contentBlockRow = [], hasContentBlockValue = false;
                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.ContentBlock'] )
                        return;
                    t = db.getAlias();
                    m = "CONTENTBLOCK" + "-" + t;
                    if (m in v) {
                        values.push(m)
                        hasContentBlockValue = true;
                    }

                    contentBlockRow.push({
                        id: m,
                        bindertype: "CONTENTBLOCK",
                        cells: [t, v[m] || "data", "内容块填充"]
                    });
                });

                if (contentBlockRow.length > 0) {
                    arr.push({
                        id: 'CONTENTBLOCK',
                        initFold: !hasContentBlockValue,
                        bindertype: "CONTENTBLOCK",
                        cells: ["<b>内容块</b>"],
                        sub: contentBlockRow
                    })
                }



                //组件列表
                var tabsRow = [], hasTabsValue = false;
                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.Tabs'] || !db.Class['ood.UI.Tabs'])
                        return;
                    t = db.getAlias();
                    m = "TABS" + "-" + t;
                    if (m in v) {
                        values.push(m)
                        hasTabsValue = true;
                    }
                    ;
                    tabsRow.push({
                        id: m,
                        bindertype: "TABS",
                        cells: [t, v[m] || "data", "动态Tabs"]
                    });
                });

                if (tabsRow.length > 0) {
                    arr.push({
                        id: 'TABS',
                        initFold: !hasTabsValue,
                        bindertype: "TABS",
                        cells: ["<b>Tabs导航</b>"],
                        sub: tabsRow
                    })
                }


                //组件列表
                var treeRow = [], hasTreeValue = false;
                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.TreeView'])
                        return;
                    t = db.getAlias();
                    m = "TREEVIEW" + "-" + t;

                    if (m in v) {
                        values.push(m);
                        hasTreeValue = true;
                    }
                    treeRow.push({
                        id: m,
                        bindertype: "TREEVIEW",
                        cells: [t, v[m] || "data", "绑定树形"]
                    });
                });

                if (treeRow.length > 0) {
                    arr.push({
                        id: 'TREEVIEW',
                        initFold: !hasTreeValue,
                        bindertype: "TREEVIEW",
                        cells: ["<b>Tree树形</b>"],
                        sub: treeRow
                    })
                }


                //组件列表
                var fchartRow = [], hasFchartValue = false;
                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.FusionChartsXT'])
                        return;
                    t = db.getAlias();
                    m = "FCHART" + "-" + t;


                    fchartRow.push({
                        id: m,
                        bindertype: "FCHART",
                        cells: [t, v[m] || "data", "绑定统计图"]
                    });
                    if (m in v) {
                        values.push(m);
                        hasFchartValue = true;
                    }

                    var mm = "FCHARTTRENDLINES-" + t;
                    fchartRow.push({
                        id: mm,
                        bindertype: "FCHARTTRENDLINES",
                        cells: [t, v[mm] || "data", "分析线"]
                    });


                    if (mm in v) {
                        values.push(mm);
                        hasFchartValue = true;
                    }
                    mm = "FCHARTDATASET-" + t;
                    fchartRow.push({
                        id: mm,
                        bindertype: "FCHARTDATASET",
                        cells: [t, v[mm] || "data", "数据集合"]
                    });
                    if (mm in v) {
                        values.push(mm);
                        hasFchartValue = true;
                    }
                    mm = "FCHARTCATEGORIES-" + t;
                    fchartRow.push({
                        id: mm,
                        bindertype: "FCHARTCATEGORIES",
                        cells: [t, v[mm] || "data", "数据分类"]
                    });
                    if (mm in v) {
                        values.push(mm);
                        hasFchartValue = true;
                    }

                });

                if (fchartRow.length > 0) {
                    arr.push({
                        id: 'FCHART',
                        initFold: !hasFchartValue,
                        bindertype: "FCHART",
                        cells: ["<b>统计图</b>"],
                        sub: fchartRow
                    })
                }


                //组件列表
                var svgpaperRow = [], hasSvgValue = false;
                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.SVGPaper'])
                        return;
                    t = db.getAlias();
                    m = "SVGPAGPER" + "-" + t;
                    if (m in v) {
                        values.push(m);
                        hasSvgValue = true;
                    }
                    svgpaperRow.push({
                        id: m,
                        bindertype: "SVGPAPER",
                        cells: [t, v[m] || "data", "SVG图形"]
                    });
                });
                if (svgpaperRow.length > 0) {
                    arr.push({
                        id: 'SVGPAGPER',
                        initFold: !hasSvgValue,
                        bindertype: "SVGPAGPER",
                        cells: ["<b>SVG图形</b>"],
                        sub: svgpaperRow
                    })
                }

                //组件列表
                var dicRow = [], hasDivValue = false;
                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.absList'])
                        return;
                    t = db.getAlias();
                    m = "LIST" + "-" + t;

                    if (m in v) {
                        values.push(m);
                        hasDivValue = true;
                    }

                    dicRow.push({
                        id: m,
                        bindertype: "LIST",
                        cells: [t, v[m] || "data", "List字典表"]
                    });
                });
                if (dicRow.length > 0) {
                    arr.push({
                        id: 'LIST',
                        initFold: !hasDivValue,
                        bindertype: "LIST",
                        cells: ["<b>List字典表</b>"],
                        sub: dicRow
                    })
                }

                //组件更新
                var componentRow = [], hasComValue = false;


                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.Dialog'])
                        return;
                    t = db.getAlias();
                    m = "COMPONENT" + "-" + t;

                    if (m in v) values.push(m);
                    componentRow.push({
                        id: m,
                        bindertype: "COMPONENT",
                        cells: [t, v[m] || "data", "Dialog"]
                    });
                });


                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.Block'])
                        return;
                    t = db.getAlias();
                    m = "COMPONENT" + "-" + t;

                    if (m in v) {
                        values.push(m);
                        hasComValue = true;
                    }

                    componentRow.push({
                        id: m,
                        bindertype: "COMPONENT",
                        cells: [t, v[m] || "data", "BLOCK"]
                    });
                });

                if (componentRow.length > 0) {
                    arr.push({
                        id: 'COMPONENT',
                        initFold: !hasComValue,
                        bindertype: "COMPONENT",
                        cells: ["<b>动态重绘</b>"],
                        sub: componentRow
                    })
                }

                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.Module'])
                        return;
                    t = db.getName();
                    m = "MODULE" + "-" + t;

                    if (m in v) {
                        values.push(m);
                    }

                    arr.push({
                        id: m,
                        bindertype: "MODULE",
                        cells: [t, "模块", v[m] || 'data.' + t]
                    });
                });

                var expressionRow = [], hasExpressionValue = false;
                ood.each(host, function (ui) {
                    if (!ui || !ui.Class || !ui.Class['ood.absContainer'] || ui.getFormElements().isEmpty())
                        return;
                    t = ui.getAlias();
                    m = "EXPRESSION" + "-" + t;

                    if (m in v) {
                        values.push(m);
                        hasExpressionValue = true;
                    }

                    expressionRow.push({
                        id: m,
                        bindertype: "EXPRESSION",
                        cells: [t, ui.key, v[m] || "data"]

                    });
                });
                if (expressionRow.length > 0) {
                    arr.push({
                        id: 'EXPRESSION',
                        initFold: !hasExpressionValue,
                        bindertype: "EXPRESSION",
                        cells: ["<b>表达式</b>"],
                        sub: expressionRow
                    })
                }

                var systemRow = [];

                m = "log-console.log";
                systemRow.push({
                    id: m,
                    bindertype: "LOG",
                    cells: ["console.log", v[m] || ""]
                });
                if (m in v) values.push(m);

                m = "alert-alert";
                systemRow.push({
                    id: m,
                    bindertype: "ALERT",
                    cells: ["ALERT", v[m] || ""]
                });

                if (systemRow.length > 0) {
                    arr.push({
                        id: 'LOG',
                        bindertype: "LOG",
                        cells: ["", '', "本地功能"],
                        sub: systemRow
                    })
                }

                ns.ood_rsptarget.setRows(arr).setValue(values.join(";"));
            }());

            // responseCallback
            (function () {
                arr = [];
                v = {};
                values = [];
                ood.arr.each(prop.responseCallback, function (o) {
                    v[o.type + "-" + (o.name || "")] = o.type;
                });
                if (cls && cls.Instance && cls.Instance.functions) {
                    ood.each(cls.Instance.functions, function (conf, id) {
                        t = id;
                        m = "host" + "-" + t;
                        if (m in v) values.push(m);
                        arr.push({
                            id: m,
                            bindertype: "host",
                            cells: ["page", t]
                        });
                    });
                }
                if (SPA.curProjectConfig && SPA.curProjectConfig.$GlobalFunctions){
                    ood.each(SPA.curProjectConfig.$GlobalFunctions, function (conf, id) {
                        t = id;
                        m = "global" + "-" + t;
                        if (m in v) values.push(m);
                        arr.push({
                            id: m,
                            bindertype: "global",
                            cells: ["global", t]
                        });
                    });
                }


                ns.ood_rspfun.setRows(arr).setValue(values.join(";"));
            }());

            // queryArgs
            ns.m_reqparams.setProperties("value", prop.queryArgs);

            // fake cookies
            ns.m_cookies.setProperties("value", prop.fakeCookies);

            // header
            if (prop.queryHeader && !ood.isEmpty(prop.queryHeader)) {
                ns.m_header.setProperties("value", prop.queryHeader);
            }

            // queryOptions
            ns.m_options.setProperties("value", prop.queryOptions);

            // here, must give prop.queryArgs 
            ns.updateRequestData(prop.queryArgs, prop.requestDataSource);
        },
        // editor to object
        getDataFromEditor: function () {
            var ns = this,
                oldprop = ns._oldprop,
                hash = {
                    requestDataSource: oldprop.requestDataSource,
                    responseDataTarget: oldprop.responseDataTarget,
                    responseCallback: oldprop.responseCallback
                },
                arr, v;

            hash.queryURL = ns.ood_url.getValue();
            hash.queryAsync = ns.ood_asyn.getValue();
            hash.autoRun = ns.autoRun.getValue();
            hash.queryMethod = ns.ood_method.getValue();
            hash.queryUserName = ns.ood_username.getValue();
            hash.queryPassword = ns.ood_password.getValue();
            hash.isAllform = ns.isAllform.getValue();
            hash.proxyType = ns.ood_proxytype.getValue();
            hash.requestType = ns.ood_reqtype.getValue();
            hash.responseType = ns.ood_rsptype.getValue();
            hash.oAuth2Token = ns.ood_token.getValue();


            // requestDataSource
            if (ns.ood_reqds.getRootNode()) {
                arr = [];
                ood.arr.each(ns.ood_reqds.getRows(), function (o) {
                    if (o._selected) {
                        arr.push({
                            type: o.bindertype,
                            name: o.cells[0].value,
                            path: o.cells[1].value
                        });
                    }
                });
                hash.requestDataSource = arr;
            }
            // responseDataTarget
            if (ns.ood_rsptarget.getRootNode()) {
                arr = [];
                ood.arr.each(ns.ood_rsptarget.getRows(), function (o) {
                    if (o.sub && o.sub.length > 0) {
                        ood.arr.each(o.sub, function (oo) {
                            if (oo._selected) {
                                arr.push({
                                    type: oo.bindertype,
                                    name: oo.cells[0].value,
                                    path: oo.bindertype == 'log' || oo.bindertype == 'alert' ? "" : oo.cells[1].value
                                });
                            }
                        })

                    } else {
                        if (o._selected) {
                            arr.push({
                                type: o.bindertype,
                                name: o.cells[0].value,
                                path: o.bindertype == 'log' || o.bindertype == 'alert' ? "" : o.cells[1].value
                            });
                        }
                    }

                });
                hash.responseDataTarget = arr;
            }
            // responseCallback
            if (ns.ood_rspfun.getRootNode()) {
                arr = [];
                ood.arr.each(ns.ood_rspfun.getRows(), function (o) {
                    if (o._selected) {
                        arr.push({
                            type: o.bindertype,
                            name: o.cells[1].value
                        });
                    }
                });
                hash.responseCallback = arr;
            }

            // queryArgs
            // m_reqparams
            v = ns.m_reqparams.getValue(true);
            hash.queryArgs = v || {};


            // fake cookies
            v = ns.m_cookies.getValue(true);
            hash.fakeCookies = v || {};

            // header
            v = ns.m_header.getValue(true);
            hash.queryHeader = v || {};

            // queryOptions
            v = ns.m_options.getValue(true);
            if (v && v.header && ood.isHash(v.header)) {
                ood.merge(hash.queryHeader, v.header);
                delete v.header;
            }
            hash.queryOptions = v || {};

            return hash;
        },

        // update request data
        updateRequestData: function (queryArgs, requestDataSource) {
            var ns = this;

            queryArgs = queryArgs ? ood.clone(queryArgs) : ns.m_reqparams.getValue(true);
            requestDataSource = requestDataSource || [];
            if (!requestDataSource.length) {
                ood.arr.each(ns.ood_reqds.getRows(), function (o) {
                    if (o._selected) {
                        requestDataSource.push({
                            type: o.bindertype,
                            name: o.cells[0].value,
                            path: o.cells[1].value
                        });
                    }
                });
            }

            // merge request data
            if (requestDataSource && requestDataSource.length) {
                for (var i in requestDataSource) {
                    var o = requestDataSource[i], t, v, path;
                    switch (o.type.toUpperCase() ) {
                        case "DATABINDER":
                            if ((t = ns._host[o.name]) && t.Class['ood.DataBinder']) {
                                if (!t.updateDataFromUI()) {
                                    return;
                                } else {
                                    path = (o.path || "").split('.');
                                    if (ood.isHash(v = ood.get(queryArgs, path))) ood.merge(v, t.getData());
                                    else ood.set(queryArgs, o.path.split('.'), t.getData());
                                }
                            }
                            break;
                        case "PAGEBAR":
                            if (t = ns._host[o.name]) {
                                var pageparams = {pageSize: t.getPageCount(), pageIndex: t.getPage()};
                                if (ood.isHash(v = ood.get(queryArgs, path))) ood.merge(v, pageparams);
                                else ood.set(queryArgs, path, pageparams);
                            }
                            break;

                        case "STAGVAR":
                            if (ns.sTagVar) {
                                var sTagVar = {};
                                ood.each(ns.sTagVar, function (value, key) {
                                    sTagVar['s' + key] = value;
                                })
                                ood.set(queryArgs, path, sTagVar);
                            }
                            break;


                        case "TREEGRID":
                            if (t = ns._host[o.name]) {
                                path = (o.path || t.getUidColumn()).split('.');
                                ood.set(queryArgs, path, t.getUIValue());
                            }
                            break;

                        case "TREEGRIDROW":
                            if (t = ns._host[o.name]) {
                                path = (o.path || t.getUidColumn()).split('.');
                                if (t.getActiveRow('map')) {
                                    ood.set(queryArgs, path, t.getActiveRow('map')[t.getUidColumn()]);
                                }
                            }
                            break;

                        case "TREEVIEW":
                            if (t = ns._host[o.name]) {
                                path = (o.path || "").split('.');
                                ood.set(queryArgs, path, t.getUIValue());
                                ood.set(queryArgs, path + 'Caption', t.getUICationValue());
                            }
                            break;
                        case "FCHART":
                            if (t = ns._host[o.name]) {
                                path = (o.path || "").split('.');
                                ood.set(queryArgs, path, t.getUIValue());
                                ood.set(queryArgs, path + 'Caption', t.getUICationValue());
                            }
                            break;
                        case "FCHARTCATEGORIES":
                            if (t = ns._host[o.name]) {
                                path = (o.path || "").split('.');
                                ood.set(queryArgs, path, t.getUIValue());
                                ood.set(queryArgs, path + 'Caption', t.getUICationValue());
                            }
                            break;
                        case "FCHARTDATASET":
                            if (t = ns._host[o.name]) {
                                path = (o.path || "").split('.');
                                ood.set(queryArgs, path, t.getUIValue());
                                ood.set(queryArgs, path + 'Caption', t.getUICationValue());
                            }
                            break;
                        case "FCHARTTRENDLINES":
                            if (t = ns._host[o.name]) {
                                path = (o.path || "").split('.');
                                ood.set(queryArgs, path, t.getUIValue());
                                ood.set(queryArgs, path + 'Caption', t.getUICationValue());
                            }
                            break;
                        case "FORM":
                            if ((t = ns._host[o.name]) && t.Class['ood.absContainer'] && t.getFormElements().size() && t.getRootNode()) {
                                // if(!t.checkValid() || !t.checkRequired()){
                                //     return;
                                // }else{
                                path = (o.path || "").split('.');
                                if (ood.isHash(v = ood.get(queryArgs, path))) ood.merge(v, t.getFormValues());
                                else ood.set(queryArgs, path, t.getFormValues());
                                //}
                            }
                            break;
                        case "MODULE":
                            if ((t = ns._host[o.name]) && t.Class['ood.Module']) {
                                path = (o.path || o.name).split('.');
                                ood.set(queryArgs, path, t.getValue(true));

                            }
                            break;
                    }
                }
            }

            var code = ood.stringify(queryArgs);
            if (ood.Coder) {
                code = ood.Coder.formatText(code);
            }

            ns.ood_reqtext.setValue(code);
        },
        _m_reqparams_onchange: function (module) {
            this.updateRequestData();
        },
        _ood_reqds_onchange: function () {
            this.updateRequestData();
        },
        _ood_reqds_bcellupdated: function () {
            this.updateRequestData();
        },


        // try to call api
        _ood_ui_htmlbutton3_onclick: function () {
            var ns = this,
                prop = ns.getDataFromEditor();

            var url = prop.queryURL || "";
            if (/\s*\{ood.constant\.[\w]+\}\s*/.test(url)) {
                url = ood.adjustVar(url, {ood: {constant: SPA.curProjectConfig.$ConstantData}});
            }
            prop.queryURL = url;

            if (!prop.queryURL) {
                ood.alert(ood.adjustRes("$inline.required"), ood.adjustRes(ns.ood_url.getLabelCaption()), function () {
                    ns.ood_url.activate();
                });
                return;
            }

            delete prop.responseDataTarget;
            delete prop.responseCallback;

            var api = new ood.APICaller(),
                callback = function (state, rsp) {
                    console.log(state, rsp);
                    if (ood.isObj(rsp)) {
                        rsp = ood.stringify(rsp);
                        if (ood.Coder) {
                            rsp = "Response Object:\n\r\n\r" + ood.Coder.formatText(rsp);
                        }
                    }
                    api.destroy();
                    window.alert(rsp);
                };
            api.setHost(ns._host);
            api.setProperties(prop);

            api.invoke(function (rsp) {
                callback('Response Sucessful', rsp);
            }, function (rsp) {
                callback('Response Error', rsp);
            });
        },

        // setBack
        _ood_ui_dialog2_beforeclose: function (profile) {
            var ns = this, prop = ns.getDataFromEditor();
            ns.fireEvent("onchange", [prop]);
            delete ns._oldprop;
        },

        _ontrows: function (profile, row, e, src, type) {
            //if (type == -1)
            //   profile.boxing().updateCell(row.cells[1], {value: ""}, false, false);
            this.updateRequestData();
        },

        _ontrows2: function (profile, row, e, src, type) {
            //if (type == -1)
            //    profile.boxing().updateCell(row.cells[0], {value: ""}, false, false);
            this.updateRequestData();
        },
        _acu: function (profile, cell, options) {
            if (!cell._row._selected && options.value) {
                var ins = profile.boxing();
                var arr = ins.getValue(true);
                arr.push(cell._row.id);
                ood.arr.removeDuplicate(arr);
                ood.arr.removeValue(arr, "");
                ins.setValue((arr && arr.length) ? arr.join(";") : null);
            }
            this.updateRequestData();
        },
        _tg_beforerowactive: function () {
            return false;
        },
        _ood_ui_comboinput207_aftervalueset: function (profile, oldValue, newValue, force, tag) {
            var ns = this,
                req = ns.ood_reqtype.getValue(),
                m = ns.ood_method.getValue(),

                reqItems = "FORM,JSON,XML,SOAP".split(","),
                mItems = "auto,GET,POST,PUT,DELETE".split(",");

            switch (newValue.toUpperCase() ) {
                case "JSONP":
                    reqItems.pop();
                    reqItems.pop();
                    mItems.pop();
                    mItems.pop();
                    mItems.pop();

                    ns.ood_reqtype.setItems(reqItems);
                    ns.ood_method.setItems(mItems);
                    if (req == 'XML' || req == 'SOAP') {
                        ns.ood_reqds.setValue('FORM');
                    }
                    if (m == 'POST' || req == 'PUB' || req == 'DELETE') {
                        ns.ood_method.setValue('auto');
                    }
                    break;
                case "XDMI":
                    reqItems.pop();
                    reqItems.pop();
                    mItems.pop();
                    mItems.pop();

                    ns.ood_reqtype.setItems(reqItems);
                    ns.ood_method.setItems(mItems);
                    if (req == 'XML' || req == 'SOAP') {
                        ns.ood_reqds.setValue('FORM');
                    }
                    if (req == 'PUB' || req == 'DELETE') {
                        ns.ood_method.setValue('auto');
                    }
                    break;
                default:
                    ns.ood_reqtype.setItems(reqItems);
                    ns.ood_method.setItems(mItems);
            }
        }
    }
});
﻿ood.Class('RAD.SwitchWorkspace', 'ood.Module',{
    Instance:{
        customAppend:function(){
            var self=this,
                dlg=self.dialog;
            dlg.show(self.parent, true);
        },
        iniComponents : function(){
            // [[Code created by ESDUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"dialog")
                .setLeft("3.125em")
                .setTop("1.875em")
                .setWidth("32.666666666666664em")
                .setHeight("18.833333333333332em")
                .setCaption("$(RAD.ws.Move/Switch Workspace)")
                .setMinBtn(false)
                .setMaxBtn(false)
                .setOverflow("visible")
                .onHotKeydown("_dialog_onhotkey")
                .beforeClose("_dialog_beforeclose")
            );
            
            host.dialog.append(
                ood.create("ood.UI.Div")
                .setHost(host,"ctl_pane68")
                .setDock("bottom")
                .setHeight("3.5em")
                .setOverflow("visible")
                );
            
            host.ctl_pane68.append(
                ood.create("ood.UI.Button")
                .setHost(host,"btnCancel")
                .setTop("0.75em")
                .setWidth("7em")
                .setRight("10em")
                .setZIndex("1")
                .setImageClass("ri-close-line") // 替换 "spafont spa-icon-cancel"
                .setCaption("$RAD.cancel")
                .onClick("_btncancel_onclick")
                );
            
            host.ctl_pane68.append(
                ood.create("ood.UI.Button")
                .setHost(host,"btnOK")
                .setTop("0.75em")
                .setWidth("8em")
                .setRight("1em")
                .setZIndex("1")
                .setImageClass("ri-check-line") // 替换 "spafont spa-icon-ok"
                .setCaption("$RAD.ok")
                .onClick("_btnok_onclick")
                );
            
            host.dialog.append(
                ood.create("ood.UI.Group")
                .setHost(host,"ctl_group1")
                .setLeft("0.625em")
                .setTop("3.3333333333333335em")
                .setWidth("31em")
                .setHeight("8.333333333333334em")
                .setOverflow("hidden")
                .setCaption("$(RAD.ws.Select target folder)")
                .setToggleBtn(false)
                );
            
            host.ctl_group1.append(
                ood.create("ood.UI.ComboInput")
                .setHost(host,"ctl_comboinput14")
                .setDirtyMark(false)
                .setLeft("9.083333333333334em")
                .setTop("4.75em")
                .setWidth("20.833333333333332em")
                .setType("popbox")
                .setCachePopWnd(false)
                .setInputReadonly(true)
                .beforeComboPop("_beforepopshow")
                );
            
            host.ctl_group1.append(
                ood.create("ood.UI.RadioBox")
                .setHost(host,"ctl_radiobox4")
                .setDirtyMark(false)
                .setItems([{
                    "id":"move",
                    "caption":"$RAD.ws.Move"
                },
                {
                    "id":"switch",
                    "caption":"$RAD.ws.Switch"
                }])
                .setLeft("0.375em")
                .setTop("0.0625em")
                .setWidth("28.666666666666668em")
                .setHeight("2.5em")
                .afterUIValueSet("_ctl_radiobox4_afteruivalueset")
                );
            
            host.ctl_group1.append(
                ood.create("ood.UI.Label")
                .setHost(host,"ctl_tips")
                .setLeft("1.25em")
                .setTop("2.5em")
                .setWidth("28.666666666666668em")
                .setHeight("2.1875em")
                .setCaption("")
                .setHAlign("left")
                .setCustomStyle({
                    "KEY":{
                        "color":"#544444",
                        "text-decoration":"underline"
                    }
                }
                )
                );
            
            host.ctl_group1.append(
                ood.create("ood.UI.Label")
                .setHost(host,"ctl_slabel8")
                .setLeft("0.1875em")
                .setTop("5.083333333333333em")
                .setWidth("8.083333333333334em")
                .setHeight("1em")
                .setCaption("$(RAD.ws.Target Folder)")
                );
            
            host.dialog.append(
                ood.create("ood.UI.Label")
                .setHost(host,"ctl_slabel1")
                .setLeft("1.6666666666666667em")
                .setTop("0.5em")
                .setWidth("28.166666666666668em")
                .setHeight("2.8333333333333335em")
                .setCaption("$(RAD.ws.ESDUI stores your projects in a  folder, called OODWorkspace$. Choose a folder to move/switch your OODWorkspace to).")
                .setHAlign("left")
                );
            
            return children;
            // ]]Code created by ESDUI RAD Studio
        },
        init:function(){
            this.ctl_radiobox4.setUIValue("switch",true);
            this.ctl_comboinput14.setUIValue(CONF.wsPath,true);
        },
        _beforepopshow : function (profile, popCtl){
            var ctrl=profile.boxing();
            NWUtil.popSaveAsDlg("", "", function(v){
                v=v.replace(/\\/g,"/");
                ctrl.setValue(v,true);
            }, true);
            return false;
        },
        _btncancel_onclick:function(){
            this.dialog.close();
        },
        _btnok_onclick:function(){
             var ns=this,
                 path = ns.ctl_comboinput14.getUIValue(),
                 b=ns.ctl_radiobox4.getUIValue();
            if(path==CONF.wsPath)
                return;

            NWUtil.moveWorksapceTo(path, b, function(){
                ns.dialog.close();
                ood.alert(ood.adjustRes("$(RAD.ws.Your OODWorkSpace has been $0 to '$1' successfully-"+(b?"moved":"switched")+"-"+path+")!"));
            },function(error){
                ood.alert(ood.get(error,['error','errdes'])||error||'no response!');
            });
        },
        _dialog_beforeclose:function(profile){
            this.dialog.hide();
            return false;
        },
        _dialog_onhotkey:function(profile, key){
            if(key.key=='esc')
                profile.boxing().close();
        },
        _ctl_radiobox4_afteruivalueset:function (profile, oldValue, newValue){
            if(newValue=="move"){
                this.ctl_tips.setCaption("$(RAD.ws.Switch OOD Workspace to following target folder, move all project files into it, and remove the old OOD Workspace folder).");
            }else{
                this.ctl_tips.setCaption("$(RAD.ws.Switch OOD Workspace to following target folder only, don't move any project files, don't remove the old OOD Workspace)");
            }
            
        }
    }
});
ood.Class('RAD.UIDesigner', 'ood.Module', {
    Instance: {
        $classEditor: null,
        $pageviewType: 'ood.UI.Tabs',
        $firstView: "design",
        $dftCodePath: '/template/',
        $dftCodeFileName: 'index.js',
        $fetchedCode: '',
        $iniCode: '',
        $url: '',

        $dirty: false,
        fe: function (evtName, evtParams) {
            if (this.events[evtName]) return this.fireEvent(evtName, evtParams);
        },
        onDestroy: function () {
            this.$classEditor.destroy();
        },
        events: {
            onReady: function () {
                SPA = this;
                ood.ComFactory.setProfile(CONF.ModuleFactoryProfile);
            },
            onRender: function (com, threadid) {
                com.setValue(com.$fetchedCode || com.$iniCode, com.$fetchedurl);
                //   com.$classEditor.setDftPage(com.$firstView);
                ood.CSS.addStyleSheet(ood.UI.buildCSSText({
                    '.ood-designer-root .ood-designer-canvas': {
                        'background-image': 'url(' + ood.getPath('img/designer/', 'bg.gif') + ')',
                        'background-position': 'left top',
                        'background-repeat': 'repeat',
                        "background-color": '',
                        "background-attachment": ''
                    }
                }), 'ood.UI.design', null, true);
            },
            afterIniComponents: function () {
                var self = this, items;
                self.appRoot
                    .append(self.$btnRun = new ood.UI.Button(
                        {
                            caption: ood.wrapRes('RAD.builder.run'),
                            tips: '$RAD.builder.runTips',
                            zIndex: 100,
                            left: 'auto',
                            top: 6,
                            right: 300,
                            width: '6em',
                            height: '5em',
                            type: 'custom',
                            border: true,
                            renderer: function (item) {
                                return '<img src=img/run.gif /><br />' + item.caption;
                            }
                        },
                        {
                            onClick: function () {
                                var content = self.getValue(),
                                    clsName = RAD.ClassTool.getClassName(content);
                                if (false === content) return;
                                if (!clsName) {
                                    ood.message(ood.getRes('RAD.classtool.noClass'));
                                    return false;
                                }
                                CONF.debugApp(CONF.testPath, "", {
                                    testTpl: CONF.testTpl,
                                    clsName: clsName,
                                    content: content,
                                    path: path,
                                    theme: SPA.$curTheme || 'default',
                                    lang: ood.getLang()
                                }, true, 'post');
                            }
                        })
                    );


                self.appRoot.append(self.$btnSave = new ood.UI.Button(
                    {
                        id: 'save',
                        caption: "保存",
                        tips: "保存",
                        zIndex: 101,
                        left: 'auto',
                        top: 6,
                        right: 210,
                        width: '6em',
                        height: '5em',
                        type: 'custom',
                        border: true,
                        renderer: function (item) {
                            return '<img src=img/save.png /><br />' + "保存本地";
                        }
                    },
                    {
                        onClick: function () {
                            var content = self.getValue();
                            if (path.indexOf('.vv') > -1 || path.indexOf('.cls') > -1 || path.indexOf('.module') > -1 || path.indexOf('.js') > -1) {

                                clsName = RAD.ClassTool.getClassName(content);
                                if (false === content) return;
                                if (!clsName) {
                                    ood.message(ood.getRes('RAD.classtool.noClass'));
                                    return false;
                                }
                            }
                            CONF.saveAS("/RAD/save", {
                                content: content,
                                path: path
                            }, 'post');
                        }
                    })
                );


            }
        },
        iniResource: function (com, threadid) {
            if (ood.Dom.byId('_post_data')) {
                var pd = ood('_post_data').text();
                pd = ood.str.trim(pd);
                if (pd && pd.length > 1) {
                    com.$iniCode = com.$fetchedCode = pd;
                    return;
                }
            }
            //Load default code(insert to the current thread)
            var com = this,
                url = ood.urlDecode(location.href.split('#')[1], 'url');

            ood.Thread.suspend(threadid);
            var finish1 = false, finish2 = false,
                fun = function () {
                    if (finish1 && finish2)
                        ood.Thread.resume(threadid);
                };
            if (!url) {
                finish2 = true;
            }

            CONF.getLocalFile(CONF.mapServerPath(com.$dftCodePath) + ood.getLang() + "/" + (CONF.initFilePath || com.$dftCodeFileName), function (code) {
                com.$iniCode = code;
                finish1 = true;
                fun();
            }, function () {
                finish1 = true;
                fun();
                alert(ood.getRes('RAD.builder.noexist', CONF.mapServerPath(com.$dftCodePath)));
            });

            if (url) {
                com.$url = url;
                CONF.callService({
                    key: CONF.requestKey2,
                    paras: {
                        action: 'fetchwebfile',
                        path: url
                    }
                }, function (txt) {
                    var obj = txt;
                    if (!obj.error) {
                        com.$fetchedCode = obj.data;
                        com.$fetchedurl = url;
                    } else
                        ood.message(obj.error.message);
                    finish2 = true;
                    fun();
                }, function () {
                    finish2 = true;
                    fun();
                    alert(ood.getRes('RAD.builder.noexist', url));
                });
            }
        },
        iniExComs: function (com, threadid) {
            var com = this;
            //New an instance of RAD.JSEditor
            ood.ComFactory.newCom('RAD.JSEditor', function (err, icom, threadid) {
                var inn = this;
                inn.host = com;
                inn.setEvents('onValueChanged', function (ns, flag) {
                    com.$dirty = flag;
                });

                //Create it first
                inn.create(function (o, threadid) {
                    inn.paneMain.setDockMargin({"left": 0, "top": 40, "right": 0, "bottom": 0});
                    //Replace the Tag one
                    com.appRoot.append(inn);
                }, threadid);

                com.$classEditor = inn;

                ood.newCom("RAD.ToolBox", function () {
                    icom._designer.layoutBase.updateItem('before', {hidden: false});
                    icom._designer.layoutBase.append(this.dlg, 'before');
                    this.render();
                    this.fillContent();

                    this.setEvents({
                        afterPop: function () {
                            icom._designer.layoutBase.updateItem('before', {hidden: true});
                        },
                        afterLand: function (toolbox) {
                            icom._designer.layoutBase.updateItem('before', {hidden: false});
                            toolbox.dlg.append(toolbox.treebarCom);
                        }
                    });

                    com.toolBoxBlock = this;
                });
            }, threadid, {$pageviewType: com.$pageviewType});
        },
        getValue: function () {
            return this.$classEditor.getValue();
        },
        setValue: function (str, url) {
            var self = this;
            if (str)
                self.$classEditor.setValue(str);
            if (url)
                self.$url = url;
            var dis = self.$url ? !ood.absIO.isCrossDomain(self.$url) ? '' : 'none' : 'none';

            self.$dirty = false;
        },
        _pop_onmenuselected: function (profile, item, src) {
            var ns = this,
                lang = item.id;
            if (ood.getLang() == lang) return;
            SPA.$btnLang.setCaption(ood.wrapRes('RAD.' + lang));
            ood.setLang(lang);
            ns.ctl_menubar1.clearPopCache();
            ood.include("ood.Locale." + item.id + ".app", CONF.getAPIPath() + "Locale/" + item.id + ".js", function () {
                if (!ood.Locale[lang].doc)
                    ood.Locale[lang].doc = ood.Locale.en.doc;
            });
            //use no-exist id
            ood.include("lang." + lang, CONF.getAPIPath() + "Locale/" + lang + ".js");
        },

        iniComponents: function () {
            // [[Code created by ESDUI RAD Studio
            var host = this, children = [], append = function (child) {
                children.push(child.get(0))
            };

            append(
                (new ood.UI.PopMenu)
                    .setHost(host, "popLang")
                    .onMenuSelected("_pop_onmenuselected")
            );
            append(
                (new ood.UI.Pane)
                    .setHost(host, "appRoot")
                    .setDock("fill")
                    .setWidth(800)
                    .setHeight(600)
                    .setDockMinW(600)
                    .setDockMinH(300)
            );


            host.appRoot.append(
                (new ood.UI.MenuBar)
                    .setHost(host, "ctl_menubar1")
                    .setItems([
                        {
                            id: 'tools', "caption": '$RAD.menu.tools',
                            imageClass: 'ri-tools-line',
                            sub: [
                                {id: 'editorTheme', caption: '$RAD.menu.editorTheme'},
                                {type: 'split'},
                                {id: 'command', caption: '$RAD.menu.command'},
                                {type: 'split'},
                                {id: 'api', caption: '$RAD.menu.api'},
                            ]
                        }
                    ])
                    .setHandler(false)
                    .setDockFloat(true)
                    .setDockMargin({top: 6, left: 2, right: 0, bottom: 0})
                    .setCustomStyle({"BORDER": "border:none;background:none;"})
                    .onMenuSelected('_menubar_selected')
                    .setZIndex(5)
            )


            return children;
            // ]]Code created by ESDUI RAD Studio
        },
        _image1_onclick: function () {
            CONF.openURL(CONF.path_website);
        },
        _menubar_selected: function (profile, popProfile, item, src) {
            var self = this;
            switch (item.id) {
                case 'cookbook':
                    CONF.openBook();
                    break;
                case 'api':
                    CONF.openAPI();
                    break;
                case 'jsoneditor':
                    CONF.openJSONEditor();
                    break;
                case 'command':
                    ood.Debugger.log('Ready');
                    break;

            }
        },
        _onmenusel: function (profile, item) {
            var id = item.id;
            if ((SPA.$curTheme || 'default') == id) return;
            ood.setTheme(id, true, function () {
                SPA.$curTheme = id;
                SPA.$btnTheme.setCaption(ood.wrapRes(item.caption));
            });
        },

        //////
        // public APIs
        //////
        // get the designer
        getDesigner: function () {
            return this.$classEditor._designer;
        },
        getViewSize: function () {
            return ood.copy(this.getDesigner().$curViewSize);
        },
        // size:{width:,height:}
        setViewSize: function (size) {
            this.getDesigner().setViewSize(size);
        },
        getSelected: function () {
            var sel = this.getDesigner().tempSelected,
                out;
            if (sel && sel.length) {
                out = [];
                ood.arr.each(sel, function (o) {
                    out.push(ood.getObject(o));
                });
            }
            return out;
        },
        selectByAlias: function (alias) {
            var des = this.getDesigner(),
                hash = des.getNames();
            if (hash[alias]) {
                des.selectWidget(hash[alias].$xid);
            }
        },
        clearSelected: function () {
            var des = this.getDesigner();
            des._clearSelect();
            des._setSelected(null, true);
        },
        delSelected: function () {
            this.getDesigner()._deleteSelected(true);
        },
        getWidgetByAlias: function (alias) {
            var des = this.getDesigner(),
                hash = des.getNames();
            return hash[alias];
        },
        addWidget: function (widget, parentAlias, subId) {
            if (widget.$key == "ood.UIProfile")
                widget = widget.boxing();

            if (widget["ood.UI"]) {
                var des = this.getDesigner(),
                    p = this.getWidgetByAlias(parentAlias);
                if (p && p.behavior.PanelKeys && p.behavior.PanelKeys.length)
                    p = p.boxing();
                else
                    p = des.canvas;

                p.append(widget, subId);
                des._designable(widget.get(0));

                des._dirty = true;
            }
        },
        removeWidgetByAlias: function (alias) {
            var des = this.getDesigner(),
                n = this.getWidgetByAlias(alias);
            if (n) {
                n.boxing().destroy();
                des._dirty = true;
            }
            this.clearSelected();
        },
        getRootWidgets: function () {
            return this.getDesigner().getWidgets();
        },
        getAllWidgets: function () {
            return this.getDesigner().getNames();
        },
        getJSCode: function () {
            var des = this.getDesigner(),
                code = des.getJSCode(des.getWidgets());
            code = code.replace(/^return ood.create\(/, '');
            code = code.replace(/\)\.get\(\);$/, '');
            return code;
        },
        getJSONCode: function () {
            var des = this.getDesigner(),
                code = des.getJSONCode(des.getWidgets());
            code = code.replace(/^return ood.create\(/, '');
            code = code.replace(/\)\.get\(\);$/, '');
            return code;
        },
        clearCode: function () {
            var des = this.getDesigner();
            des._clearSelect();
            des.canvas.removeChildren(null, true);
            des._dirty = true;
            des.resetCodeFromDesigner(true);
        },

        setJSCode: function (code) {
            var des = this.getDesigner();
            this.clearCode();
            des.refreshView(code, true);
            des._dirty = true;
            des.resetCodeFromDesigner(false);
        },

        setJSONCode: function (json) {
            this.setJSCode('return ood.UI.unserialize(' + json + ').get();');
        },
        isDirtied: function () {
            return this.getDesigner().isDirty();
        },
        markDirty: function (flag) {
            var des = this.getDesigner();
            if (flag) des._dirty = true;
            else des.clearDirty();
        }
    }
});
ood.Class('RAD.SelFontAwesome', 'ood.Module', {
    Instance: {
        iniComponents: function () {
            // [[Code created by ESDUI RAD Studio
            var host = this, children = [], append = function (child) {
                children.push(child.get(0));
            };

            append(
                ood.create("ood.UI.Dialog")
                    .setHost(host, "ood_ui_dialog2")
                    .setLeft("1.6666666666666667em")
                    .setTop("1.6666666666666667em")
                    .setWidth("62.5em")
                    .setHeight("31.666666666666668em")
                    .setCaption("图标选择")
                    .setMinBtn(false)
            );

            host.ood_ui_dialog2.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ood_ui_panel9")
                    .setDock("left")
                    .setWidth("13.25em")
                    .setZIndex(1)
                    //   .setBorderType("none")
                    .setLeft("undefinedem")
                    .setRight("undefinedem")
                    .setBottom("undefinedem")
            );


            host.ood_ui_panel9.append(
                ood.create("ood.UI.TreeView")
                    .setHost(host, "ood_ui_lst")
                    .setDirtyMark(false)
                    .setInitFold(false)
                    .setSingleOpen(true)
                    .setValue("allicon")
                    .setDock("fill")
                    .setTop("0em")
                    .setWidth("18.166666666666666em")
                    .onChange("_ood_ui_lst_onchange")
            );

            host.ood_ui_panel9.append(
                (new ood.UI.ToolBar())
                    .setHost(host, "servicetool")
                    // .setDisplay("none")
                    .setHandler(false)
                    .onClick("_toolbar_onclick")
                // .setCustomStyle({
                //     "ITEMS": "border-width:0 0 1px 0;"
                // }
                // )
            );

            var items = [{
                id: 'any', sub: [
                    {
                        id: 'refresh',
                        imageClass: 'ri ri-refresh-line',
                        caption: '刷新',
                        tips: '$RAD.tool2.refresh'
                    },
                    {
                        id: 'import',
                        imageClass: 'ri ri-upload-line',
                        caption: '导入',
                        tips: '$RAD.esdmenu.localicon'
                    }
                ]
            }];

            host.servicetool.setItems(items);

            host.ood_ui_panel9.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ood_ui_block4")
                    .setDock("top")
                    .setLeft("0em")
                    .setHeight("2.8333333333333335em")
                    .setBorderType("none")
                    .setTop("undefinedem")
                    .setRight("undefinedem")
                    .setBottom("undefinedem")
            );

            host.ood_ui_block4.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "ood_ui_comboinput33")
                    .setDock("width")
                    .setLeft("0em")
                    .setTop("0.25em")
                    .setHeight("2.3333333333333335em")
                    .setDynCheck(true)
                    .setType("input")
                    .setImageClass("ri ri-filter-line")
                    .setCommandBtn("delete")
                    .onChange("_ood_ui_comboinput33_onchange")
            );

            host.ood_ui_dialog2.append(
                ood.create("ood.UI.Div")
                    .setHost(host, "ood_ui_div15")
                    .setDock("fill")
                    .setLeft("23.333333333333332em")
                    .setTop("0.8333333333333334em")
            );

            host.ood_ui_div15.append(
                ood.create("ood.UI.Gallery")
                    .setHost(host, "ood_ui_gallery1")
                    .setDirtyMark(false)
                    .setDock("fill")
                    .setIconFontSize('2em')
                    .setLeft("22.5em")
                    .setColumns(6)
                    .setTop("8.333333333333334em")
                    .setBorderType("none")
                    .setValue("a")
                    .onItemSelected("_ood_ui_gallery1_onitemselected")
            );

            host.ood_ui_div15.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ood_ui_block4")
                    .setDock("bottom")
                    .setLeft("13.333333333333334em")
                    .setHeight("2.8333333333333335em")
                    .setOverflow("hidden")
                    .setTop("undefinedem")
                    .setRight("undefinedem")
                    .setBottom("undefinedem")
            );

            host.ood_ui_block4.append(
                ood.create("ood.UI.StatusButtons")
                    .setHost(host, "ood_ui_statusbuttons2")
                    .setDirtyMark(false)
                    .setItems([{
                        "id": "normal",
                        "caption": "normal",
                        "imageClass": "ri ri-shield-line"
                    },
                        {
                            "id": "fa-rotate-90",
                            "caption": "Rotate 90",
                            "imageClass": "ri ri-shield-line fa-rotate-90"
                        },
                        {
                            "id": "fa-rotate-180",
                            "caption": "Rotate 180",
                            "imageClass": "ri ri-shield-line fa-rotate-180"
                        },
                        {
                            "id": "fa-rotate-270",
                            "caption": "Rotate 270",
                            "imageClass": "ri ri-shield-line fa-rotate-270"
                        },
                        {
                            "id": "fa-flip-horizontal",
                            "caption": "Flip Horizontal",
                            "imageClass": "ri ri-shield-line fa-flip-horizontal"
                        },
                        {
                            "id": "fa-flip-vertical",
                            "caption": "Flip Vertical",
                            "imageClass": "ri ri-shield-line fa-flip-vertical"
                        }])
                    .setDock("width")
                    .setLeft("0.16666666666666666em")
                    .setTop("0.08333333333333333em")
                    .setWidth("39.916666666666664em")
                    .setHeight("3.25em")
                    .setBorderType("none")
                    .setItemMargin("2px 4px")
                    .setConnected(true)
                    .setValue("normal")
                    .onItemSelected("_ood_ui_statusbuttons2_onitemselected")
            );

            return children;
            // ]]Code created by ESDUI RAD Studio
        },
        events: {
            "onReady": "_page_onready",
            "onRender": "_page_onrender"
        },
        _reload: function () {

            var ns = this;
            ns._db = {};
            addTodb = function (data) {
                if (data.glyphs) {
                    ood.each(data.glyphs, function (item) {
                        item.code = data.font_family + " " + data.css_prefix_text;
                    })
                    ns._db[data.id] = data.glyphs
                }
                ood.each(data.sub, function (item) {
                    addTodb(item)
                })

            };


            ns.ood_ui_statusbuttons2.setValue('normal');

            ood.Ajax(CONF.getSelFontServcie, {
                projectName: SPA.curProjectName
            }, function (txt) {
                ns.ood_ui_lst.setItems(txt.data);
                ood.each(txt.data, function (item) {
                    addTodb(item)
                })
                ns._refreshIcons(txt.data[0].id, ns._rotateType);
            }, function (txt) {

            }, null, null, {method: 'POST'}).start();
        }
        ,
        _page_onready: function (module, threadid) {
            this._reload();
        },

        _toolbar_onclick: function (profile, item, group, e, src) {

            var ns = this;
            switch (item.id) {
                case 'import':
                    ood.showModule("RAD.resource.FontTree", function () {
                        this.setEvents("onOk", function (lib, appearance, locale) {
                             ood.CSS.includeLink(path + 'theme.css', id);
                            ns._reload();
                            ood.message("添加成功，您需要刷新浏览器以便于更改！");
                        });
                        this.setData({projectName: SPA.curProjectName});
                        this.show();
                        this.initData();
                        this._fireEvent('afterShow');
                    });
                    break;
                case 'refresh':
                    ns._reload();
                    break;
            }

        },

        _page_onrender: function (module, threadid) {
            this.ood_ui_lst.fireItemClickEvent("allicon");
        },
        _ood_ui_lst_onchange: function (profile, oldValue, newValue, force, tag) {
            this._refreshIcons(newValue, this._rotateType);
        },

        _ood_ui_lst_onchange: function (profile, oldValue, newValue, force, tag) {
            this._refreshIcons(newValue, this._rotateType);
        },

        _refreshIcons: function (newValue, type) {
            var ns = this;
            var items = [];
            ood.arr.each(ns._db[newValue], function (s) {
                var comment = {comment: s.name, imageClass: s.code + s.font_class, caption: '', code: s.code};
                items.push(comment);
            });
            ns.ood_ui_gallery1.setItems(items);
        },
        _ood_ui_statusbuttons2_onitemselected: function (profile, item, e, src, type) {
            var ns = this;
            ns.ood_ui_gallery1.getSubNode('ICON', true).removeClass("fa-rotate-90 fa-rotate-180 fa-rotate-270 fa-flip-vertical fa-flip-horizontal");
            if ((ns._rotateType = item.id == 'normal' ? '' : ' ' + item.id)) {
                ns.ood_ui_gallery1.getSubNode('ICON', true).addClass(ns._rotateType);
            }
        },
        _ood_ui_gallery1_onitemselected: function (profile, item, e, src, type) {
            var ns = this, uictrl = profile.boxing();
            ns.fireEvent("onSel", [item.imageClass]);
            ns.destroy();
        },
        _ood_ui_comboinput33_onchange: function (profile, oldValue, newValue, force, tag) {
            var ns = this, uictrl = profile.boxing();
            ood.resetRun(ns.$xid + ':_ood_ui_comboinput33_onchange', function () {
                ns.ood_ui_lst.setUIValue(null);
                ns.ood_ui_lst.setDisabled(true);
                var results = [];
                if (newValue) {
                    ood.each(ns._db, function (o) {
                        ood.arr.each(o, function (s) {
                            if (s.code.indexOf(newValue) != -1
                                || s.unicode.indexOf(newValue) != -1
                                || s.name.indexOf(newValue) != -1
                                || s.font_class.indexOf(newValue) != -1
                            ) {
                                results.push(s);
                            }
                        });
                    });

                    var items = [];
                    ood.arr.each(results, function (s) {
                        var comment = {comment: s.name, imageClass: s.code + s.font_class, caption: '', code: s.code};
                        items.push(comment);
                    });
                    ns.ood_ui_gallery1.setItems(items);
                } else {
                    ns._setEmpty();
                }
            }, 500);
        },
        _setEmpty: function () {
            var ns = this;
            // dont trigger onchange event
            ns.ood_ui_comboinput33.setValue(null, true);
            ns.ood_ui_lst.setDisabled(false);
            ns.ood_ui_lst.fireItemClickEvent("allicon");
        }
    }
});
﻿ood.Class('OODBuilder', 'ood.Module',{
    Initialize:function(){
        window.ARGS = ood.urlDecode(location.search.replace('?', ''));

        if(!window.CONF)CONF={};
        CONF.clientMode='component';

        if(ARGS.conf && parent!==window)
            ood.merge(CONF, parent.CONF,'all');
    },
    Instance:{
        $classEditor:null,
        $pageviewType:'ood.UI.Tabs',
        $firstView:"design",
        $dirty:false,
        customAppend:function(parent){
            parent.append(this.$classEditor);
        },
        fe:function(evtName, evtParams){
            if(this.events[evtName])return this.fireEvent(evtName,evtParams);
        },
        events:{
            onReady:function(){
                SPA=this;
                SPA.$classEditor.setDftPage(SPA.$firstView);
                ood.CSS.addStyleSheet(ood.UI.buildCSSText({
                    '.ood-designer-root .ood-designer-canvas':{
                        'background-image' : 'url('+ood.getPath('img/designer/','bg.gif')+')',
                        'background-position' : 'left top',
                        'background-repeat': 'repeat',
                        "background-color": '',
                        "background-attachment": ''
                    }
                }),'ood.UI.design',null,true);
                ood.ComFactory.setProfile(CONF.ModuleFactoryProfile);

                var p=SPA.properties;
                if(!p.pageInitCode) p.pageInitCode = CONF.DefaultOODClassCode;

                SPA.fe("onDesignerReady",  [p]);

                SPA.$classEditor.setValue(p.pageInitCode);
            },
            onRender:function(com, threadid){
            },
            onDestroy:function(){
                this.$classEditor.destroy();
            }
        },
        iniExComs:function(com, threadid){
            var com=this;
            //New an instance of RAD.JSEditor
            ood.ComFactory.newCom('RAD.JSEditor',function(err,icom,threadid){
                var inn=this;
                inn.host = com;
                inn.setEvents('onValueChanged',function(page, flag){
                    com.$dirty=flag;

                    ood.resetRun(com.KEY+":onValueChanged", function(){
                        SPA.fe("onValueChanged",  [flag]);
                    },200);
                });

                //Create it first
                inn.create(function(o,threadid){
                    inn.buttonview.setNoHandler(true);
                },threadid);

                com.$classEditor=inn;

                ood.newModule("RAD.ToolBox",function(){
                    icom._designer.layoutBase.updateItem('before',{hidden:false});
                    icom._designer.layoutBase.append(this.dlg,'before');
                    this.render();
                    this.fillContent();
                    
                    this.setEvents({
                        afterPop:function(){
                             icom._designer.layoutBase.updateItem('before',{hidden:true});
                        },
                        afterLand:function(toolbox){
                            icom._designer.layoutBase.updateItem('before',{hidden:false});
                            toolbox.dlg.append(toolbox.treebarCom);
                        }
                    });
                });
            },threadid,{$pageviewType:com.$pageviewType});
        },
        iniComponents:function(){
            // [[Code created by EUSUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0))};
            
            return children;
            // ]]Code created by EUSUI RAD Studio
        },

         //////
        // public APIs
        //////
        setReletivePath:function(path){
            window['/']=path;
        },
        busy:function(html, busyIcon,cursor,bgStyle){
            return ood.busy("OOD as Componnet", html||"", busyIcon,cursor,bgStyle);
        },
        free:function(){
            return ood.free("OOD as Componnet");
        },
        getValue:function(){
            return this.$classEditor.getValue();
        },
        getPropBinderKeys:function(){
            if(CONF.grid_showPropBinder){
                var init = ood.get(RAD.ClassTool.getClassStruct(this.$classEditor.getValue()),["sub","Instance","sub","iniComponents"]);
                if(init){
                    var module=new ood.Module();
                    module.iniComponents=ood.unserialize(init.code);
                    return module.getPropBinderKeys();
                }
            }
            return [];
        },
        setValue:function(str, force){
            var self=this;
            if(str)
                self.$classEditor.setValue(str,false, force);
            self.$dirty=false;
            self.getDesigner().refreshFromCode(true);
        },
        resetValue:function(){
            this.setValue(this.properties.pageInitCode);
        },
        keepValue:function(){
            self.$dirty=false;
            var des = this.getDesigner();
            des.markDirty(false);
        },
        // get the designer 
        getDesigner:function(){
            return this.$classEditor._designer;
        },
        getViewSize:function(){
            return ood.copy(this.getDesigner().$curViewSize);
        },
        // size:{width:,height:}
        setViewSize:function(size){
            this.getDesigner().setViewSize(size);
        },
        getSelected:function(returnPrf){
            var sel=this.getDesigner().tempSelected,
                out;
            if(sel && sel.length){
                out=[];
                ood.arr.each(sel,function(o){
                    o=ood.getObject(o);
                    out.push(returnPrf?o:o.alias);
                });
            }
            return out;
        },
        selectWidgetsByAlias:function(alias){
            var des=this.getDesigner(),
                hash = des.getNames();
            if(ood.isArr(alias)){
                var arr=[];
                ood.arr.each(alias,function(s){
                    if(hash[s])arr.push(hash[s].$xid);
                });
                if(arr.length)
                    des.selectWidget(arr);
            }else if(hash[alias]){
                des.selectWidget(hash[alias].$xid);
            }
        },
        clearSelected:function(){
            var des=this.getDesigner();
            des._clearSelect();
            des._setSelected(null,true);
        },
        delSelected:function(){
            this.getDesigner()._deleteSelected(true);
        },
        getWidgetByAlias:function(alias){
             var des=this.getDesigner();
             return des.getNames()[alias];
        },
        addWidget:function(widget,parentAlias,subId){
            if(widget.$key=="ood.UIProfile")
                widget=widget.boxing();

            if(widget["ood.UI"]){
                var des=this.getDesigner(),
                    p= this.getWidgetByAlias(parentAlias);
                if(p && p.behavior.PanelKeys&& p.behavior.PanelKeys.length)
                    p=p.boxing();
                else
                    p=des.canvas;

                p.append(widget,subId);
                des._designable(widget.get(0));
                
                des.markDirty(true);
            }
        },
        removeWidgetByAlias:function(alias){
            var des = this.getDesigner(),
                n=this.getWidgetByAlias(alias);
            if(n){
                n.boxing().destroy();
                des.markDirty(true);
            }
            this.clearSelected();
        },
        getRootWidgets:function(){
            return this.getDesigner().getWidgets();
        },
        getAllWidgets:function(){
            return this.getDesigner().getNames();
        },
        getJSCode:function(){
            var des = this.getDesigner(),
                code = des.getJSCode(des.getWidgets());
            code=code.replace(/^ood.create\(/,'');
            code=code.replace(/\)\.get\(\);$/,''); ;
            return code;
        },
        getJSONCode:function(format){
            var des = this.getDesigner(),
                code = des.getJSONCode(des.getWidgets(), format);
            code=code.replace(/^ood.create\(/,'');
            code=code.replace(/\)\.get\(\);$/,'');
            return code;
        },
        clearCode:function(){
            var des=this.getDesigner();
            des._clearSelect();
            des.canvas.removeChildren(null,true);
            des.markDirty(true);
            des.resetCodeFromDesigner(true);
        },
        setJSCode:function(code){
            var des = this.getDesigner();
            this.clearCode();
            des.refreshView(code, true);
            des.markDirty(true);
            des.resetCodeFromDesigner(false);            
        },
        setJSONCode:function(json){
            this.setJSCode('return ood.UI.unserialize(' + json + ').get();');
        },
        isDirtied:function(){
            return this.$dirty=this.getDesigner().isDirty();
        },
        markDirty:function(flag){
            this.$dirty=!!flag;

            var des = this.getDesigner();
            if(flag)des.markDirty();
            else  des.clearDirty(true);
        }
    }
});
﻿ood.Class('RAD.AddFile', 'ood.Module', {
    Instance: {
        _serial: 1,
        ajax: {},
        customAppend: function (parent) {
            var ns = this,
                dlg = ns.dialog,
                prop = ns.properties,
                pp = prop.parent;

            if (!dlg.get(0).renderId)
                dlg.render();

            var fileName = prop.fileName || "newFileName";
            var parentPath = prop.parentPath;

            if (SPA.curProjectPath) {
                var curProjectPath = SPA.curProjectPath;
                if (curProjectPath.indexOf("VVVERSION") > -1) {
                    curProjectPath = curProjectPath.replace("VVVERSION", "(V") + ")";
                }
                if (parentPath == curProjectPath) {
                    parentPath = "";
                } else if (parentPath + '/' == curProjectPath) {
                    parentPath = "";
                } else {
                    parentPath = ood.replace(prop.parentPath, curProjectPath, "");
                }
            }


            var title = "$RAD.addfile.addfile";
            var v = parentPath;
            ns.input.setType("input");
            ns.input.resetValue(fileName);
            if (parentPath) {
                parentPath = ood.replace(parentPath, '\\.', "/");
                if (!ood.str.endWith(parentPath, "/")) {
                    parentPath = parentPath + "/"
                }
            }
            title = "$RAD.addfile.newpage";
            v = parentPath + fileName;
            ns.dialog.setCaption(title);
            ns._pPath = parentPath;


            //  v = ns._pPath + "/" + fileName + prop.tailTag;
            ns.inputTarget.resetValue(v).setTips(v);
            ns.blockTypeCap.setHtml("<div style='padding:2px 0 0 2px'>" + prop.typeCaption + "</div>");
            //  ns._refresh();
            dlg.showModal(parent);
            return true;
        },
        reset: function () {
            var ns = this;
            ns.input.setValue("", true).setType("none");
            ns.inputTarget.setValue("", true).setTips("");
        },
        iniComponents: function () {
            // [[Code created by EUSUI RAD Studio
            var host = this, children = [], append = function (child) {
                children.push(child.get(0));
            };

            append(
                ood.create("ood.UI.Dialog")
                    .setHost(host, "dialog")
                    .setLeft("8.625em")
                    .setTop("3.625em")
                    .setWidth("40em")
                    .setHeight("13.5em")
                    .setResizer(false)
                    .setImageClass("cb-icon-file-plus")
                    .setMinBtn(false)
                    .setMaxBtn(false)
                    .setOverflow("hidden")
                    .onHotKeydown("_dialog_onhotkey")
                    .beforeClose("_dialog_beforeclose")
            );

            host.dialog.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ctl_block8")
                    .setLeft("0.375em")
                    .setTop("0.3125em")
                    .setWidth("37.916666666666664em")
                    .setHeight("5.916666666666667em")
                    .setBorderType("inset")
                    .setOverflow("hidden")
            );

            host.ctl_block8.append(
                ood.create("ood.UI.Label")
                    .setHost(host, "label3")
                    .setLeft("24.083333333333332em")
                    .setTop("3.5833333333333335em")
                    .setWidth("4.375em")
                    .setCaption("$RAD.addfile.filetype")
            );

            host.ctl_block8.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "input")
                    .setDefaultFocus(true)
                    .setLeft("1.25em")
                    .setTop("3.25em")
                    .setWidth("22em")
                    .setDynCheck(true)
                    .setLabelSize("8.333333333333334em")
                    .setLabelCaption("$RAD.addfile.filename")
                    .setType("none")
                    .beforeUIValueSet("_beforeInpuSet")
                    .afterUIValueSet("_refresh")
            );

            host.ctl_block8.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "inputTarget")
                    .setReadonly(true)
                    .setLeft("1.25em")
                    .setTop("0.75em")
                    .setWidth("35.5em")
                    .setLabelSize("8.333333333333334em")
                    .setLabelCaption("$RAD.addfile.target")
                    .setType("none")
            );

            host.ctl_block8.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "blockTypeCap")
                    .setLeft("28.833333333333332em")
                    .setTop("3.3333333333333335em")
                    .setWidth("7.916666666666667em")
                    .setHeight("1.75em")
                    .setBorderType("inset")
            );

            host.dialog.append(
                ood.create("ood.UI.Button")
                    .setHost(host, "btnCancel")
                    .setLeft("10.833333333333334em")
                    .setTop("7.166666666666667em")
                    .setWidth("7.833333333333333em")
                    .setTabindex(3)
                    .setImageClass("cb-icon-close")
                    .setCaption("$RAD.cancel")
                    .onClick("_btncancel_onclick")
            );

            host.dialog.append(
                ood.create("ood.UI.Button")
                    .setHost(host, "btnOK")
                    .setLeft("21.416666666666668em")
                    .setTop("7.166666666666667em")
                    .setWidth("7.833333333333333em")
                    .setTabindex(4)
                    .setImageClass("cb-icon-check")
                    .setCaption("$RAD.ok")
                    .onClick("_btnok_onclick")
            );

            return children;
            // ]]Code created by EUSUI RAD Studio
        },
        _dialog_beforeclose: function (profile) {
            this.properties = {};
            this.dialog.hide();
            return false;
        },
        _btncancel_onclick: function (profile, e, value) {
            this.dialog.close();
        },
        _beforeInpuSet: function (profile, ov, nv) {

        },
        _refresh: function (profile, oldValue, newValue) {
            var ns = this,
                path = ns._pPath,
                prop = ns.properties;
            var newValue = ns._adjuestFileName(newValue);
            prop.type = 'file';
            if (path) {
                path = ood.replace(path, '\\.', "/");
                if (!ood.str.endWith(path, "/")) {
                    path = path + "/"
                }
            }
            if (newValue.indexOf(".") > -1) {
                ns.blockTypeCap.setHtml("<div style='padding:2px 0 0 2px'>" + newValue.substring(newValue.indexOf(".")) + "</div>");
                newValue = path + newValue;

            } else {
                newValue = newValue + ".js";
                if (path) {
                    newValue = path + "/" + newValue;
                }
            }
            ns.inputTarget.resetValue(newValue);
        },
        _adjuestFileName: function (fileName) {
            return fileName.replace(/^ +/, "").replace(/[\. ]*$/, "").replace(/\"/g, "");
        },
        _btnok_onclick: function (profile, e, value) {
            this._apply();
        },
        _apply: function () {
            var ns = this,
                fileName = ns.input.getUIValue(),
                fullPath=ns.inputTarget.getUIValue(),
            fileName = ns._adjuestFileName(fileName);
            if (!fileName) {
                ood.message(ood.getRes('RAD.addfile.notarget'));
                return;
            } else {
                ns.dialog.busy(ood.adjustRes("$(RAD.tpl.Building the template)..."));
                ns.ajax.setQueryData({
                    projectName: SPA.curProjectName,
                    parentPath: ns._pPath,
                    fullPath: fullPath,
                    fileName: fileName
                });
                ns.ajax.invoke(
                    function (txt) {
                        var obj = txt;
                        ns.dialog.free();
                        if (obj && obj.requestStatus != -1) {
                            ns.dialog.close();
                            ns.fireEvent('onOK', [obj.data, "file"]);
                        } else if (obj && !obj.error) {
                            ood.message(ood.get(obj, ['error', 'errdes']) || obj || 'no response!')

                        } else ood.message(ood.get(obj, ['error', 'errdes']) || obj || 'no response!');
                    }
                );
            }
        },
        _dialog_onhotkey: function (profile, key) {
            if (key.key == 'esc')
                profile.boxing().close();
        }
    }
});
﻿ood.Class('RAD.ProjectPro', 'ood.Module', {
    Instance: {
        customAppend: function (parent) {
            var ns = this,
                prop = ns.properties,
                pp = prop.parent,
                dlg = ns.dialog;

            if (!dlg.get(0).renderId) {
                dlg.render();
            }
            ns.ctl_tabs2.setUIValue("local");

            //asy
            dlg.showModal(parent, null, null, function () {
                //ns.lastbtn.adjustDock();
            });

        },
        iniComponents: function () {
            // [[Code created by EUSUI RAD Studio
            var host = this, children = [], append = function (child) {
                children.push(child.get(0));
            };


            append((new ood.UI.Dialog())
                .setHost(host, "dialog")
                //.setDockMargin({"left": 10, "top": 10, "right": 10, "bottom": 10})
                .setLeft(-2)
                .setTop(-2)
                .setWidth(700)
                .setHeight(398)
                .setResizer(false)
                .setCaption("新建工程")
                .setImageClass("spafont spa-icon-project")
                .setMinBtn(false)
                .setMinWidth(700)
                .setMinHeight(400)
                .onHotKeydown("_dialog_onhotkey")
                .beforeClose("_dialog_beforeclose")
            );

            host.dialog.append((new ood.UI.Block())
                .setHost(host, "ctl_block75")
                .setDock("fill")
                .setBorderType("inset")
            );

            host.ctl_block75.append((new ood.UI.Tabs())
                    .setHost(host, "ctl_tabs2")
                    .setItems([
                        {"id": "local", "caption": "从模板新建", "image": ""},
                        {"id": "online", "caption": "模板市场", "image": ""},
                        {"id": "blank", "caption": "空白工程"}])
                    .setDock("top")
                    .setDockOrder(3)
                    .setHeight("auto")
                    .setLazyAppend(false)
                    .setNoPanel(true)
                    .beforeUIValueSet("_ctl_tabs2_beforepage")
                    .setCustomStyle({"ITEMS": {"padding-left": "4px"}})
              );

            host.ctl_block75.append((new ood.UI.Block())
                    .setHost(host, "ctl_block10")
                    .setDock("fill")
                    .setBorderType("none"));

            host.ctl_block10.append((new ood.UI.Pane())
                .setHost(host, "ctl_pane56")
                .setClassName("ood-uibg-base")
                .setDock("fill")
            );

            host.ctl_pane56.append((new ood.UI.Layout())
                .setHost(host, "ctl_layout6")
                .setItems([{
                    "id": "before",
                    "pos": "before",
                    "size": 150,
                    "min": 10,
                    "locked": false,
                    "folded": false,
                    "hidden": false,
                    "cmd": true
                }, {"id": "main", "min": 10, "size": 390}, {
                    "id": "after",
                    "pos": "after",
                    "size": 80,
                    "min": 10,
                    "locked": false,
                    "folded": false,
                    "hidden": true,
                    "cmd": false,
                    "itemDisplay": "display:none;"
                }])
                .setType("horizontal")
            );

            host.ctl_layout6.append(
                (new ood.UI.Pane())
                    .setHost(host, "ctl_ads")
                    .setDock("bottom")
                    .setHeight(0)
                , "main");

            host.ctl_layout6.append((new ood.UI.Gallery())
                    .setHost(host, "ctl_gallery")
                    .setDirtyMark(false)
                    .setDisableTips(true)
                    .setDock("fill")
                    .setSelMode("none")
                    .setBorderType("none")
                    .setItemMargin(2)
                    .setItemWidth(124)
                    .setItemHeight(120)
                    .setImgWidth(120)
                    .setImgHeight(80)
                    .onItemSelected("_ctl_gallery_onitemselected")
                    .setCustomStyle({
                        "IMAGE": {
                            "border": "solid #dddddd 1px"
                        }
                    })
                , "main");

            host.ctl_layout6.append((new ood.UI.TreeView())
                    .setHost(host, "ctl_list")
                    .setDirtyMark(false)
                    .onGetContent("_ctl_list_ongetcontent")
                    .onItemSelected("_ctl_list_onitemselected")
                , "before");

            return children;
            // ]]Code created by EUSUI RAD Studio
        },
        events: {"onReady": "_onready", "onRender": "_onrender"},
        _onready: function () {
            var ns = this;

            ns._preview = new RAD.TemplatePreview();
            ns._preview.setEvents({
                onOK: function (ppath, pname) {

                    ns.dialog.hide();
                    CONF.openProject(pname, ns.properties.onOK1, ns.properties.onOK2, function () {
                    }, ns.properties.namespace);
                }
            });
        },
        _onrender: function () {
            var ns = this,
                preview = ns._preview,
                items = ns.ctl_gallery.getItems();
            ns._preview.render();
            ns.ctl_gallery.hoverPop(preview.blkMain, 12, function (profile, node, e, src, item) {
                preview.init(item, items, ns.properties);
            }, function () {
                return !preview.isStopHover();
            });
        },
        _dialog_beforeclose: function (profile) {
            this.ctl_tabs2.setUIValue(null);
            profile.boxing().hide();
            return false;
        },
        _dialog_onhotkey: function (profile, key) {
            if (key.key == 'esc')
                profile.boxing().close();
        },
        getImagePreTag: function (type) {
            return type == "online" ? CONF.onlineTempalteLibPath :
                type == "local" ? CONF.serviceType == "node-webkit" ? CONF.adjustProtocol('') : '' :
                    "";
        },
        _ctl_tabs2_beforepage: function (profile, oldValue, newValue) {
            var ns = this;
            switch (newValue) {
                case 'blank':

                    ood.showCom("RAD.AddProject",function(){
                        this.setProperties(null);
                        this.setProperties({
                            fileName:ns._item['name'].replace(/^[\w]+_tpl(code)?_/,""),
                            tempName:ns._item.name,
                            item:ns._item,
                            prop:ns.prop
                        });
                        this.setEvents({
                            onOK:function(){
                                ns._item=ns._items=null;
                                ns.blkMain.hide();
                                ns.fireEvent('onOK', ood.toArr(arguments),this);
                            }
                        });
                    },null,null,true);

                    ood.showCom("RAD.AddProject", function () {
                        this.setProperties(null);
                        this.setProperties({
                            fileName: "newProject",
                            item:{desc:'空白工程',url:'http://dev.itjds.net'},
                            tempName:'defaultProjectTemplat'

                        });
                        this.setEvents({
                            onOK: function (ppath, pname) {
                                ns.dialog.hide();
                                CONF.openProject(pname, ns.properties.onOK1, ns.properties.onOK2, function () {
                                }, ns.properties.namespace);
                            }
                        });
                    }, null, null, true);
                    return false;
            }

            ns.ctl_gallery.resetValue().clearItems();
            ns.ctl_list.resetValue().clearItems();

            ood.asyRun(function () {
                var callback = function (txt) {
                    ns.ctl_list.free();
                    var obj = txt;
                    if (!obj || obj.error) {
                        switch (obj.error.id) {
                            case 3005:
                                ood.alert(ood.adjustRes('$(RAD.msg.$0 dones not exit-URI)'));
                                break;
                            default:
                                ood.message(ood.get(obj, ['error', 'errdes']) || obj || 'no response!');
                        }
                    } else {
                        var items = [],
                            conf = obj.data.conf ? ood.unserialize(obj.data.conf) : false,
                            sortby = {},
                            map = {};
                        if (conf) {
                            if (conf.list)
                                ood.arr.each(conf.list, function (o, i) {
                                    map[o.id] = o;
                                    sortby[o.id] = i;
                                });
                        }
                        ;
                        if (obj.data) {
                            ood.arr.each(obj.data, function (o, i) {
                                items.push({
                                    id: o.type,
                                    name: o.name,
                                    // sub:true,
                                    caption: ood.get(map, [o.name, 'caption', ood.getLang()]) || o.name
                                });
                            });
                        }
                        if (!ood.isEmpty(sortby)) {
                            ood.arr.stableSort(items, function (x, y) {
                                x = sortby[x.name] || -1;
                                y = sortby[y.name] || -1;
                                return x > y ? 1 : x == y ? 0 : -1;
                            });
                        }
                        ns.ctl_list.setItems(items);
                        if (items[0]) {
                            ns.ctl_list.fireItemClickEvent(items[0].id);
                        }
                    }
                };
                switch (newValue) {
                    case "local":
                        ns.ctl_list.busy(true);
                        ood.Ajax(CONF.getProjectTempType, {path: CONF.localProjectLibPath}, callback).start();
                        break;
                    case "online":
                        // ns.ctl_list.busy(true);

                        break;
                }
            });
        },
        _ctl_list_onitemselected: function (profile, item, e, src, type) {
            var ns = this,
                tabs = ns.ctl_tabs2,
                tabpage = tabs.getUIValue(),
                remote = tabpage == "online",
                preTag = ns.getImagePreTag(tabpage),
                callback = function (txt) {
                    ns.ctl_gallery.free();
                    var obj = txt;
                    if (!obj || obj.error)
                        ood.message(ood.get(obj, ['error', 'errdes']) || 'no response!');
                    else {
                        var items = [],
                            conf = obj.data.conf ? ood.unserialize(obj.data.conf) : false,
                            sortby = {},
                            map = {};
                        if (conf) {
                            if (conf.list)
                                ood.arr.each(conf.list, function (o, i) {
                                    map[o.id] = o;
                                    sortby[o.id] = i;
                                });
                        }
                        ;
                        if (obj.data) {
                            ood.arr.each(obj.data, function (o, i) {
                                var item = {
                                    id: o.location,
                                    url: o.url,
                                    desc: o.desc,
                                    name: o.name,
                                    caption: null,
                                    comment: o.desc || o.name,
                                    image: o.image || "/RAD/img/project.png"
                                };
                                var prop = ood.get(map, [o.name, 'prop']);
                                if (prop && prop.charged) {
                                    item.flagStyle = "top:0;font-size:1.5em;";
                                    item.prop = prop;
                                    item.flagClass = "spafont spa-icon-coin";
                                }
                                items.push(item);

                            });
                        }

                        if (!ood.isEmpty(sortby)) {
                            ood.arr.stableSort(items, function (x, y) {
                                x = sortby[x.name] || -1;
                                y = sortby[y.name] || -1;
                                return x > y ? 1 : x == y ? 0 : -1;
                            });
                        }

                        ns.ctl_gallery.resetValue();
                        ns.ctl_gallery.setItems(items);
                    }
                };
            ns.ctl_gallery.resetValue().clearItems();
            ns.ctl_gallery.busy(true);
            switch (tabpage) {
                case "local":
                case "self":
                    ood.Ajax(CONF.getProjectTemp,
                        {
                            type: item.id
                        }, function (txt) {
                            callback.call(ns, txt);
                        }).start();


                    break;
            }
            if (item.sub && !item._checked)
                ns.ctl_list.toggleNode(item.id, true);
        },
        _ctl_list_ongetcontent: function (profile, item, setsub) {
            var ns = this,
                tabs = ns.ctl_tabs2,
                tabpage = tabs.getUIValue(),
                callback = function (txt) {
                    var obj = txt;
                    if (!obj || obj.error)
                        ood.message(ood.get(obj, ['error', 'errdes']) || 'no response!');
                    else {
                        var items = [],
                            conf = obj.data.conf ? ood.unserialize(obj.data.conf) : false,
                            sortby = {},
                            map = {};
                        if (conf) {
                            if (conf.list)
                                ood.arr.each(conf.list, function (o, i) {
                                    map[o.id] = o;
                                    sortby[o.id] = i;
                                });
                        }
                        ;
                        if (obj.data.files) {
                            ood.arr.each(obj.data.files, function (o, i) {
                                if (o.name.charAt(0) != ".'" && !ood.str.startWith(o.name, CONF.ood_project_tpl_tag))
                                    items.push({
                                        id: o.location,
                                        name: o.name,
                                        sub: true,
                                        caption: ood.get(map, [o.name, 'caption', ood.getLang()]) || o.name
                                    });
                            });
                        }
                        if (!ood.isEmpty(sortby)) {
                            ood.arr.stableSort(items, function (x, y) {
                                x = sortby[x.name] || -1;
                                y = sortby[y.name] || -1;
                                return x > y ? 1 : x == y ? 0 : -1;
                            });
                        }
                        setsub(items.length === 0 ? false : items);
                        //if(items&&items.length)
                        //    profile.boxing().fireItemClickEvent(items[0].id);
                    }
                };
            switch (tabpage) {
                case "self":
                case "local":

                    ood.Ajax(CONF.openFolderService,
                        {
                            path: item.id
                        }, function (txt) {
                            callback.call(ns, txt);
                        }, null, null, {method: 'POST'}).start();

                    break;

            }
        },
        _ctl_gallery_onitemselected: function (profile, item, e, src, type) {
            this._preview._apply(item);
        },


    }
});
﻿ood.Class('RAD.TemplatePreview', 'ood.Module',{
    Instance:{
        iniComponents : function(){
            // [[Code created by EUSUI RAD Studio
            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Div")
                .setHost(host,"blkMain")
                .setDock('none')
                .setDockIgnore(false)
                .setDockFloat(true)
                .setShowEffects("Classic")
                .setHideEffects("Classic")
                .setLeft(0)
                .setTop(0)
                .setWidth(130)
                .setHeight(0)
                .setOverflow("visible")
            );
            
            host.blkMain.append(
                ood.create("ood.UI.Div")
                .setHost(host,"blkMain2")
                .setLeft("0em")
                .setTop("0em")
                .setWidth("10.833333333333334em")
                .setHeight("0em")
                .setZIndex(1002)
                .setOverflow("visible")
                );
            
            host.blkMain2.append(
                ood.create("ood.UI.Image")
                .setHost(host,"ctl_image45")
                .setClassName("ood-css-kf")
                .setTips("$RAD.tpl.Apply")
                .setTop("-2.6666666666666665em")
                .setRight("0em")
                .setSrc("{ood.ini.releasePath}img/copy.png")
                .setCursor("")
                .onClick("_btn_apply_onclick")
                );
            
            host.blkMain2.append(
                ood.create("ood.UI.Image")
                .setHost(host,"ctl_image46")
                .setClassName("ood-css-kf")
                .setTips("$RAD.tpl.Preview")
                .setLeft("0em")
                .setTop("-2.6666666666666665em")
                .setSrc("{ood.ini.releasePath}img/preview.png")
                .setCursor("")
                .onClick("_btn_preview_onclick")
                );
            
            append(
                ood.create("ood.UI.CSSBox")
                .setHost(host,"ctl_cssbox2")
                .setClassName("ood-css-kf")

                .setNormalStatus({
                    "background-color":"#FFFFFF",
                    "border-radius":"16px",
                    "box-shadow":"0px 0px 6px #4B0082",
                    "cursor":"pointer"
                }
                )
                .setHoverStatus({
                    "box-shadow":"1px 1px 10px #4B0082",
                    "transform":"rotate(0deg) scale(1,1) skew(0deg,0deg) translate(-1px,-1px)"
                }
                )
                .setActiveStatus({
                    "box-shadow":"0px 0px 6px #4B0082",
                    "transform":"rotate(0deg) scale(0.99,0.99) skew(0deg,0deg) translate(0px,0px)"
                }
                )
            );
            
            return children;
            // ]]Code created by EUSUI RAD Studio
        },
        customAppend : function(parent, subId, left, top){
            return true;
        },
        initPage:function(item){
            if(!item)return;
            var ns=this,
                id=item.id,
                prop=item.prop;
                ns._item=item;
        },
        init:function(item,items,prop){
            var ns=this;            
            ns._items=items;
            ns.properties=ood.copy(prop);
            ns._maxed=0;
            ns.initPage(item);
        },
        isStopHover:function(){
            return this._maxed;
        },
        _btn_preview_onclick:function (profile, e, src){
            var ns = this;
                ood.Dom.submit(ns._previewURL);
        },
        _apply:function(item){
            var ns=this;
            if(item)ns._item=item;

            ns._btn_apply_onclick();
        },
         _btn_apply_onclick:function (){
            var ns = this,
                prop=ns.properties,
                fun=function(){
                    ood.showCom("RAD.AddProject",function(){
                        this.setProperties(null);
                        this.setProperties({
                            fileName:ns._item['name'].replace(/^[\w]+_tpl(code)?_/,""),
                            tempName:ns._item.name,
                            item:ns._item,
                            prop:ns.prop
                        });
                        this.setEvents({
                            onOK:function(){
                                ns._item=ns._items=null;
                                ns.blkMain.hide();
                                ns.fireEvent('onOK', ood.toArr(arguments),this);
                            }
                        });
                    },null,null,true);
                    };
                fun();
//            }
        }
    }
});
ood.Class('RAD.TemplateSelector', 'ood.Module',{
    Instance:{
        customAppend:function(parent){
            var ns=this,
                prop = ns.properties,
                pp = prop.parent,
                dlg=ns.dialog;

            if(!dlg.get(0).renderId){   
                dlg.render();
            }
            dlg.setCaption(ood.adjustRes("$(RAD.tpl.Add file)$(RAD.tpl. to )" +"[" + prop.parentPath +"]"));
            //asy
            dlg.showModal(parent, null,null,function(){
                ns.ctl_buttonviews4.setUIValue(prop.fileType=="Module"?"module":"page", true);
            });
             var dft="page";
            ood.arr.each(ns.ctl_buttonviews4.getItems('min'),function(key){
                // only can upload image
                var show=false;
                if(prop.fileType=="root"){
                    show=true;
                }else if(prop.fileType=="oodOnly"){
                    show = key=="page" || key=="ood.page.js" || key=="/";
                }else{
                    if(prop.fileType=="Module"&& (key=="module" || key=="ood.page.js"|| key=="/")){
                        show=true;
                    }else if(prop.fileType=="App"&& (key=="page" || key=="/")){
                        show=true;
                    }else if(prop.fileType=="Data" && (key=="page" || key==".json"|| key=="/")){
                        show=true;
                    }else if(prop.fileType=="css" && (key=="page" || key==".css"|| key=="/")){
                        show=true;
                    }else if(prop.fileType=="img" && (key=="page" || key=="img"|| key=="/")){
                        show=true;
                    }else if(/^[\w]+$/.test(prop.fileType)){
                        show=true;
                    }
                }
                ns.ctl_buttonviews4.updateItem(key, { hidden: !show});
            });
 

            ns.ctl_tabs2.setUIValue("local");
            
            CONF.checkRegisterStatus(null,function(){
                if(CONF.ads2_url){
                    ns.ctl_ads.setIframeAutoLoad(CONF.ads2_url,true);
                    ns.ctl_ads.setHeight(CONF.ads2_height||80);
                }
            });
        },
        iniComponents:function(){

            var host=this, children=[], append=function(child){children.push(child.get(0));};
            
            append(
                ood.create("ood.UI.Dialog")
                .setHost(host,"dialog")
                .setDockMargin({
                    "left":10,
                    "top":10,
                    "right":10,
                    "bottom":10
                }
                )
                .setLeft("0em")
                .setTop("0em")
                .setWidth("41.625em")
                .setResizer(false)
                // 1. 替换对话框标题图标
                .setCaption("$(RAD.tpl.Add file)")
                .setImageClass("ri ri-file-text-line")
                .setMinBtn(false)
                .setStatus("max")
                .onHotKeydown("_dialog_onhotkey")
                .beforeClose("_dialog_beforeclose")
            );
            
            host.dialog.append(
                ood.create("ood.UI.Block")
                .setHost(host,"ctl_block10")
                .setDock("fill")
                .setBorderType("inset")
                );
            
            host.ctl_block10.append(
                ood.create("ood.UI.Div")
                .setHost(host,"ctl_pane56")
                .setClassName("ood-uibg-base")
                .setDock("fill")
                );
            
            host.ctl_pane56.append(
                ood.create("ood.UI.Tabs")
                .setHost(host,"ctl_tabs2")
                .setItems([{
                    "id":"local",
                    "caption":"$(RAD.tpl.Page Templates)",
                    "image":""
                }/*,
                {
                    "id":"online",
                    "caption":"$(RAD.tpl.Online Page Templates)",
                    "image":""
                }
                */])
                .setDock("top")
                .setDockOrder(3)
                .setHeight("auto")
                .setLazyAppend(false)
                .setNoPanel(true)
                .beforeUIValueSet("_ctl_tabs2_beforepage")
                .setCustomStyle({
                    "ITEMS":{
                        "padding-left":"4px"
                    }
                }
                )
                );
            
            host.ctl_pane56.append(
                ood.create("ood.UI.Layout")
                .setHost(host,"ctl_layout6")
                .setItems([{
                    "id":"before",
                    "pos":"before",
                    "size":132,
                    "min":10,
                    "locked":false,
                    "folded":false,
                    "hidden":false,
                    "cmd":true
                },
                {
                    "id":"main",
                    "min":10,
                    "size":524
                },
                {
                    "id":"after",
                    "pos":"after",
                    "size":80,
                    "min":10,
                    "locked":false,
                    "folded":false,
                    "hidden":true,
                    "cmd":false,
                    "itemDisplay":"display:none;"
                }])
                .setType("horizontal")
                );
            
            host.ctl_layout6.append(
                ood.create("ood.UI.Div")
                .setHost(host,"ctl_ads")
                .setDock("bottom")
                .setHeight("0em")
                , "main");
            
            host.ctl_layout6.append(
                ood.create("ood.UI.Gallery")
                .setHost(host,"ctl_gallery")
                .setDirtyMark(false)
                .setDisableTips(true)
                .setDock("fill")
                .setSelMode("none")
                .setBorderType("none")
                .setItemMargin(2)
                .setItemWidth(124)
                .setItemHeight(120)
                .setImgWidth(120)
                .setImgHeight(80)
                .onItemSelected("_ctl_gallery_onitemselected")
                .setCustomStyle({
                    "IMAGE":{
                        "border":"solid #dddddd 1px"
                    }
                }
                )
                , "main");
            
            host.ctl_layout6.append(
                ood.create("ood.UI.TreeView")
                .setHost(host,"ctl_list")
                .setDirtyMark(false)
        .onGetContent("_ctl_list_ongetcontent")
                .onItemSelected("_ctl_list_onitemselected")
                , "before");
            
            host.dialog.append(
                ood.create("ood.UI.ButtonViews")
                .setHost(host,"ctl_buttonviews4")
                .setItems([

                    {
                    "id":"page",
                    "caption":"<strong>$RAD.addfile.iXuiTpl</strong>"
                },
                {
                    "id":"module",
                    "caption":"<strong>$RAD.addfile.iModule</strong>"
                }])
                .setDock("top")
                .setHeight("2.6666666666666665em")
                .setNoPanel(true)
                .setBarSize(28)
                .beforeUIValueSet("_ctl_list1_beforeuivalueset")
                .onItemSelected("_ignoreMouseDown")
                .setCustomStyle({
                    "LIST":{
                        "border":"none"
                    }
                }
                )
                );
            
            return children;
            // ]]Code created by ESDUI RAD Studio
        },
        _ignoreMouseDown:function(){
            return false;
        },
        events:{"onReady":"_onready","onRender":"_onrender"},
        _onready:function(){
            var ns=this;
           
            ns._preview = new RAD.TemplatePreview();
            ns._preview.setEvents({onOK:function(){
                ns.dialog.hide();
                ns.fireEvent('onOK',ood.toArr(arguments),ns);
            }});
            ns._preview.render();
        },
        _onrender:function(){
            var ns=this, 
                preview=ns._preview,
                items=ns.ctl_gallery.getItems();
            ns.ctl_gallery.hoverPop(preview.blkMain,12,function(profile, node, e, src, item){
                preview.init(item, items, ns.properties);
            },function(){
                return !preview.isStopHover();
            });
        },
        _dialog_beforeclose:function(profile){
            this.ctl_tabs2.setUIValue(null); 
            profile.boxing().hide();
            return false;
        },
        _dialog_onhotkey:function(profile, key){
            if(key.key=='esc')
                profile.boxing().close();
        },
        getImagePreTag: function(type){
            return type=="online"? CONF.onlineTempalteLibPath:
                       type=="local"? CONF.serviceType=="node-webkit"  ? CONF.adjustProtocol('') : '' :
                        "";
       },
        _ctl_tabs2_beforepage:function (profile,oldValue, newValue){
            var ns = this,
                prop=ns.properties,
                item=profile.getItemByItemId(newValue),
                type = ns.ctl_buttonviews4.getUIValue(),
                name;
            switch(newValue){

                case "ood.page.js":
                    name="Name";//type=="module"?"ModuleName":"PageName";
                    ood.showModule("RAD.AddFile",function(){
                        this.setProperties({
                            fileName:name,
                            parentPath:prop.parentPath,
                            typeCaption:item.caption,
                            type:type,
                            forcedir:true,
                            blankmodule:1,
                            tailTag:".js"
                        });
                        this.setEvents({onOK:function(){
                            ns.dialog.hide();
                            ns.fireEvent('onOK',ood.toArr(arguments),ns);
                        }});
                    },null,null,true);
                    return false;

                case "internet":
                    var dlg=ood.prompt("$RAD.img.URL","$(RAD.img.Type picture URL here)",'http://',function(value){
                        if(CONF.isZipURL(value)){
                            CONF.callService({
                                key:CONF.requestKey,
                                curProjectPath:SPA.curProjectPath,
                                paras:{
                                    action:'fetchsavewebfile',
                                    hashCode:ood.id(),
                                    path:value,
                                    npath:SPA.curProjectPath + "/img",
                                    force:true
                                }
                            },function(txt){
                                var obj = txt;
                                if(obj && !obj.error){
                                    ood.tryF(ns.properties.onOK, [ns, obj.data.path], ns.host);
                                    ns.dialog.close();
                                }else ood.message(obj.error.message);
                            });
                            ns.dialog.close();
                        }else{
                            ood.alert("$(RAD.img.This is not a valid zip file URL address)");
                            return false;
                        }
                        dlg=null;
                    },null,null,null,null,null,ns.dialog);
                    dlg._$input.setMultiLines(false);//.setHeight(26);
                    return false;
            }

            ns.ctl_gallery.resetValue().clearItems();
            ns.ctl_list.resetValue().clearItems();

            ood.asyRun(function(){
                var callback=function(txt){
                    ns.ctl_list.free();
                    var obj = txt;
                    if(!obj || obj.error){
                        ood.message(ood.get(obj,['error','message'])||'no response!');
                    }else{
                        var items=[],
                              conf = obj.data.conf?ood.unserialize(obj.data.conf):false,
                              sortby={},
                              map={};
                        if(conf){
                            if(conf.list)
                                ood.arr.each(conf.list,function(o,i){
                                    map[o.id]=o;
                                    sortby[o.id]=i;
                                });
                        }
                        if(obj.data.files){
                            ood.arr.each(obj.data.files,function(o,i){
                                items.push({
                                    id: o.location,
                                    name:o.name, 
                                    sub:false,
                                    caption: ood.get(map,[o.name,'caption', ood.getLang()])||o.name
                                });
                            });
                        }
                        if(!ood.isEmpty(sortby)){
                            ood.arr.stableSort(items,function(x,y){
                                x=sortby[x.name]||-1;y=sortby[y.name]||-1;
                                 return x>y?1:x==y?0:-1;
                            });
                        }
                        ns.ctl_list.setItems(items);
                        if(items[0]){
                            ns.ctl_list.fireItemClickEvent(items[0].id);
                        }
                    }
                };
                var type = ns.ctl_buttonviews4.getUIValue();
                switch(newValue){
                    case "local":
                    case "self":
                        ns.ctl_list.busy(true);
                        ood.Ajax(
                            CONF.getProjectTemp,
                            {
                                path:type=="page"?CONF.myTempalteLibPath:CONF.localModlueLibPath,
                                curProjectPath:SPA.curProjectPath
                            }
                            ,callback
                        ).start();

                        break;

                }
            });
        },
        _ctl_list_onitemselected:function (profile, item, e, src, type){
            var ns = this,
                tabs = ns.ctl_tabs2,
                tabpage = tabs.getUIValue(),
                remote=tabpage=="online",
                type = ns.ctl_buttonviews4.getUIValue(),
                preTag = ns.getImagePreTag(tabpage),

                callback=function(txt){
                    ns.ctl_gallery.free();
                    var obj = txt;
                    if(!obj || obj.error)
                        ood.message(ood.get(obj,['error','message'])||'no response!');
                    else{
                        var items=[],
                              conf = obj.data.conf?ood.unserialize(obj.data.conf):false,
                              sortby={},
                              map={};
                        if(conf){
                            if(conf.list)
                                ood.arr.each(conf.list,function(o,i){
                                    map[o.id]=o;
                                    sortby[o.id]=i;
                                });
                        };
                        if(obj.data.files){
                            var tag = type=="page"?CONF.ood_page_tpl_tag:CONF.ood_module_tpl_tag;
                            ood.arr.each(obj.data.files,function(o,i){
                                if(CONF.getClientMode() == "project" ){
                                    var item={
                                        id:o.location,
                                        url:CONF.adjustFileAbsPath(preTag)+o.location,
                                        remote:remote,
                                        name:o.name,
                                        caption: null, 
                                        comment:ood.get(map,[o.name,'caption', ood.getLang()])||o.name.replace(tag+"_","").replace(tag+"code_",""),
                                        image:preTag+o.location+"/snapshot.png"
                                    };
                                    var prop=ood.get(map,[o.name,'prop']);
                                    if(prop&&prop.charged){
                                        item.flagStyle="top:0;font-size:1.5em;";
                                        item.prop=prop;
                                        item.flagClass = "ri ri-currency-line";
                                    }
                                    items.push(item);
                                }
                            });
                        }
                        
                        if(!ood.isEmpty(sortby)){
                            ood.arr.stableSort(items,function(x,y){
                                x=sortby[x.name]||-1;y=sortby[y.name]||-1;
                                 return x>y?1:x==y?0:-1;
                            });
                        }
                        
                        ns.ctl_gallery.resetValue();
                        ns.ctl_gallery.setItems(items);
                    }
                };
            ns.ctl_gallery.resetValue().clearItems();
            ns.ctl_gallery.busy(true);
            var type = ns.ctl_buttonviews4.getUIValue();
            switch(tabpage){
                case "local":
                case "self":

                    ood.Ajax(CONF.getProjectTemp,  {path:item.id},callback).start();

                    // CONF.callService({
                    //     key:CONF.requestKey,
                    //     curProjectPath:SPA.curProjectPath,
                    //     paras:{
                    //         action:'open',
                    //         pattern: "("+(type=="page" ? CONF.ood_page_tpl_tag: CONF.ood_module_tpl_tag)+").*",
                    //         withConfig:true,
                    //         hashCode:ood.id(),
                    //         type:0,
                    //         path:item.id
                    //     }
                    // } ,function(txt){
                    //     callback.call(ns,txt);
                    // });
                break;

            }
            if(item.sub && !item._checked)
                ns.ctl_list.toggleNode(item.id, true);
        },
        _ctl_list_ongetcontent:function (profile, item, setsub){
            var ns = this,
                tabs=ns.ctl_tabs2,
                tabpage = tabs.getUIValue(),
                type = ns.ctl_buttonviews4.getUIValue(),
                callback=function(txt){
                    var obj = txt;
                    if(!obj || obj.error)
                        ood.message(ood.get(obj,['error','message'])||'no response!');
                    else{
                        var items=[],
                              conf = obj.data.conf?ood.unserialize(obj.data.conf):false,
                              sortby={},
                              map={};
                        if(conf){
                            if(conf.list)
                                ood.arr.each(conf.list,function(o,i){
                                    map[o.id]=o;
                                    sortby[o.id]=i;
                                });
                        };
                        if(obj.data.files){
                            ood.arr.each(obj.data.files,function(o,i){
                                if(o.name.charAt(0)!=".'" && !ood.str.startWith(o.name, type=="page"?CONF.ood_page_tpl_tag:CONF.ood_module_tpl_tag) )
                                    items.push({id:o.location, name:o.name, sub:true, caption: ood.get(map,[o.name,'caption', ood.getLang()])||o.name});
                            });
                        }
                        if(!ood.isEmpty(sortby)){
                            ood.arr.stableSort(items,function(x,y){
                                x=sortby[x.name]||-1;y=sortby[y.name]||-1;
                                 return x>y?1:x==y?0:-1;
                            });
                        }
                        setsub(items.length===0?false:items);
                        //if(items&&items.length)
                        //    profile.boxing().fireItemClickEvent(items[0].id);
                    }
                };
            var type = ns.ctl_buttonviews4.getUIValue();
            switch(tabpage){
                case "self":
                case "local":
                 ood.Ajax(CONF.openFolderService, {path: item.id, hashCode:ood.id(), curProjectPath: SPA.curProjectPath}
                ,callback, null, null, {method: 'POST'});
                break;

            }
        },

        openUploadWin:function(path,closeFun){


        },
        _ctl_list1_beforeuivalueset:function (profile, oldValue, newValue){
            var ns=this,
                prop=this.properties,
                item=profile.getItemByItemId(newValue),
                name;
            switch(item.id){
                case "img":
                    var pPath=prop.parentPath.indexOf( SPA.curProjectPath + "/img/")!=-1 ? prop.parentPath : (SPA.curProjectPath + "/img");
                    var uploadPath=CONF.uploadPath;
                    var dio= ood.create("ood.UI.Dialog")
                        .setLeft("8.333333333333334em")
                        .setTop("5.833333333333333em")
                        .setWidth("40.833333333333336em")
                        .setHeight("30em")
                        .setIframeAutoLoad(uploadPath+"?uploadpath="+pPath+"&filter=jpg;gif;png")
                        .setCaption("添加文件")
                        .setMaxBtn(false)
                        .beforeClose(function(){
                            ns.fireEvent('onOK',[pPath, "", "", false],ns);
                        })
                        .setMaxBtn(false);

                    dio.show();

                case "img":

                case "page":
                    ns.ctl_tabs2.removeItems(["disk","empty","ood.page.js","hire"]);
                    ns.ctl_buttonviews4.removeItems("empty");

                    ns.ctl_tabs2.updateItem("local", {caption:"$(RAD.tpl.Page Templates)"});
//                    ns.ctl_tabs2.updateItem("online", {caption:"$(RAD.tpl.Online Page Templates)"});


                    ns.ctl_tabs2.insertItems([{"id":"ood.page.js", "caption":"$RAD.addfile.iNewPage"}]);

                    ns.ctl_tabs2.setUIValue("local", true);
                    return;
                case "module":
                    ns.ctl_tabs2.removeItems(["disk","empty","ood.page.js","hire"]);
                    ns.ctl_buttonviews4.removeItems("empty");

                    ns.ctl_tabs2.updateItem("local", {caption:"$(RAD.tpl.Modules Templates)"});
//                    ns.ctl_tabs2.updateItem("online", {caption:"$(RAD.tpl.Online Modules)"});

                    // add local disk
                    if(CONF.serviceType=="node-webkit"){
                        //ns.ctl_tabs2.insertItems([{"id":"self", "caption":"$(RAD.tpl.My Templates)"}]);
                        //ns.ctl_tabs2.insertItems([{"id":"disk", "caption":"$(RAD.tpl.From Local File)"}]);
                        ns.ctl_buttonviews4.insertItems([{"id":"empty", "caption":"$RAD.addfile.empty"}]);
                    }
                    ns.ctl_tabs2.insertItems([{"id":"ood.page.js", "caption":"$RAD.addfile.iNewModule"}]);
                    //ns.ctl_buttonviews4.insertItems([{"id":"file", "caption":"$RAD.addfile.iUpload"}]);

                    ns.ctl_tabs2.setUIValue("local", true);
                    return;

                case "/":
                    name="newPath";
                break;
                case "file":
                    name="";
                break;
                case "empty":
                    name="newEmptyFile";
                break;
                default:
                    name="newFileName";
            }
            ood.showModule("RAD.AddFile",function(){
                this.setProperties({
                    fileName:name,
                    parentPath:prop.parentPath,
                    typeCaption:item.caption,
                    type:item.id,
                    forcedir:true,
                    tailTag:item.id=="ood.page.js"?".js":(item.id=="/"||item.id=="file"||item.id=="empty")?"":item.id
                });
                this.setEvents({onOK:function(){
                    ns.dialog.hide();
                    ns.fireEvent('onOK',ood.toArr(arguments),ns);
                }});
            },null,null,true);
            return false;
        },
        _ctl_gallery_onitemselected:function (profile, item, e, src, type){
            this._preview._apply(item);
        }
    }
 });
ood.Class('RAD.ImageSelector', 'ood.Module', {
    Instance: {
        customAppend: function (parent) {
            var self = this,
                prop = self.properties,
                pp = prop.parent,
                dlg = self.dialog;
            if (!dlg.get(0).renderId) {
                dlg.render();
            }
            //asy
            dlg.show(parent, true);
            self.ctl_tabs2.setUIValue(null).setUIValue("inner");
        },
        _dialog_beforeclose: function (profile) {
            this.dialog.hide();
            return false;
        },
        iniComponents: function () {
            // [[Code created by ESDUI RAD Studio
            var host = this, children = [], append = function (child) {
                children.push(child.get(0));
            };

            append(
                ood.create("ood.UI.Dialog")
                    .setHost(host, "dialog")
                    .setLeft("3.125em")
                    .setTop("1.25em")
                    .setWidth("54.333333333333336em")
                    .setHeight("30em")
                    .setCaption("$(RAD.img.Image Selector)")
                    .setImageClass("spafont spa-icon-gallery")
                    .setMinBtn(false)
                    .onHotKeydown("_dialog_onhotkey")
                    .beforeClose("_dialog_beforeclose")
            );

            host.dialog.append(
                ood.create("ood.UI.Div")
                    .setHost(host, "ood_ui_div13")
                    .setDock("bottom")
                    .setLeft("5.833333333333333em")
                    .setHeight("3.1666666666666665em")
                    .setTop("0em")
                    .setRight("0em")
                    .setBottom("0em")
            );

            host.ood_ui_div13.append(
                ood.create("ood.UI.Button")
                    .setHost(host, "btnCancel")
                    .setTop("0.5833333333333334em")
                    .setWidth("7.75em")
                    .setRight("12em")
                    .setImageClass("spafont spa-icon-cancel")
                    .setCaption("$RAD.cancel")
                    .onClick("_btncancel_onclick")
            );

            host.ood_ui_div13.append(
                ood.create("ood.UI.Button")
                    .setHost(host, "btnOK")
                    .setTop("0.5833333333333334em")
                    .setWidth("7.75em")
                    .setRight("2em")
                    .setImageClass("spafont spa-icon-ok")
                    .setCaption("$RAD.ok")
                    .onClick("_btnok_onclick")
            );

            host.dialog.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ctl_block10")
                    .setDock("fill")
                    .setHeight("20.625em")
                    .setBorderType("inset")
            );

            host.ctl_block10.append(
                ood.create("ood.UI.ButtonViews")
                    .setHost(host, "ctl_tabs2")
                    .setItems([
                        {
                            "id": "inner",
                            "caption": "本地图片",
                            "image": ""
                        }

                    ])
                    .setNoHandler(true)
                    .setDock("top")
                    .setHeight("0em")
                    .setLazyAppend(false)
                    .setNoPanel(true)
                    .setTop("0em")
                    .setRight("0em")
                    .setBottom("0em")
                    .setValue(null)
                    .beforeUIValueSet("_ctl_tabs2_beforepage")
            );

            host.ctl_block10.append(
                ood.create("ood.UI.Layout")
                    .setHost(host, "ctl_layout6")
                    .setItems([{
                        "id": "before",
                        "pos": "before",
                        "size": 160,
                        "min": 10,
                        "locked": false,
                        "folded": false,
                        "hidden": false,
                        "cmd": true
                    },
                        {
                            "id": "main",
                            "min": 10,
                            "size": 540
                        },
                        {
                            "id": "after",
                            "pos": "after",
                            "size": 80,
                            "min": 10,
                            "locked": false,
                            "folded": false,
                            "hidden": true,
                            "cmd": false,
                            "itemDisplay": "display:none;"
                        }])
                    .setType("horizontal")
            );

            host.ctl_layout6.append(
                ood.create("ood.UI.Gallery")
                    .setHost(host, "ctl_gallery")
                    .setDirtyMark(false)
                    .setDock("fill")
                    .setBorderType("none")
                    .onDblclick("_ctl_gallery_ondblclick")
                    .setCustomStyle({
                            "ITEMS": {
                                "overflow": "overflow-x:hidden;overflow-y:auto"
                            }
                        }
                    )
                , "main");

            host.ctl_layout6.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "ctl_block12")
                    .setDock("top")
                    .setHeight("2.4166666666666665em")
                    .setOverflow("hidden")
                    .setTop("0em")
                    .setRight("0em")
                    .setBottom("0em")
                , "main");


            host.ctl_block12.append(
                ood.create("ood.UI.PageBar")
                    .setHost(host, "ctl_pagebar1")
                    .setTop("0.3333333333333333em")
                    .setRight("0.125em")
                    .setCaption("")
                    .onClick("_ctl_pagebar1_onclick")
            );

            host.ctl_block12.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host, "ctl_input1")
                    .setDirtyMark(false)
                    .setLeft("0.3125em")
                    .setTop("0.25em")
                    .setWidth("21.333333333333332em")
                    .setDynCheck(true)
                    .setLabelSize("10em")
                    .setLabelCaption("$(RAD.img.Search in Category)")
                    .setType("none")
                    .setImageClass("ood-icon-search")
                    .setCommandBtn("delete")
                    .onChange("_ctl_input1_onchange")
                    .onCommand("_ctl_input1_oncommand")
            );


            host.ctl_layout6.append(
                ood.create("ood.UI.Block")
                    .setHost(host, "leftPanle")
                    .setDock("fill")
                    .setLeft("0em")
                    .setBorderType("none")
                , "before");


            host.leftPanle.append(
                (new ood.UI.ToolBar())
                    .setHost(host, "servicetool")
                    .setHandler(false)
                    .onClick("_toolbar_onclick")
            );

            var items = [{
                id: 'any', sub: [
                    {id: 'refresh', imageClass: 'ri-refresh-line', caption: '刷新', tips: '$RAD.tool2.refresh'},
                    //{id: 'import', imageClass: 'ri-add-line', caption: '导入', tips: '导入图标'},
                    {id: 'upload', imageClass: "ri-upload-line", caption: '上传', tips: '上传图片'}
                ]
            }];

            host.servicetool.setItems(items);

            host.leftPanle.append(
                ood.create("ood.UI.TreeView")
                    .setHost(host, "ctl_list")
                    .setDirtyMark(false)
                    .onGetContent("_ctl_list_ongetcontent")
                    .onItemSelected("_ctl_list_onitemselected")
            );


            return children;
            // ]]Code created by ESDUI RAD Studio
        },
        _btncancel_onclick: function (profile, e, value) {
            this.dialog.close();
        },
        _btnok_onclick: function (profile, e, value) {
            this._selectImage();
        },
        _selectImage: function () {
            var ns = this,
                tabid = ns.ctl_tabs2.getUIValue();
            // check selected
            if (!ns.ctl_gallery.getUIValue()) {
                ood.alert(ood.adjustRes('$RAD.selFilePath'));
                return;
            }
            var value = ns.ctl_gallery.getUIValue();
            ns.dialog.busy(ood.adjustRes('$(RAD.img.Fechting image)...'));
            ood.tryF(ns.properties.onOK, [ns, value], ns.host);
            ns.dialog.free();
            ns.dialog.close();
        },
        _dialog_onhotkey: function (profile, key) {
            if (key.key == 'esc')
                profile.boxing().close();
        },
        _ctl_tabs2_beforepage: function (profile, oldValue, newValue) {
            var ns = this;
            ns.ctl_gallery.resetValue().clearItems();
            ns.ctl_list.resetValue().clearItems();
            ns.ctl_list.busy(true);
            var callback = function (txt) {
                    ns.ctl_list.free();
                    var obj = txt;
                    if (!obj || obj.requestStatus == -1 || obj.error)
                        ood.message(ood.get(obj, ['error', 'errdes']) || 'no response!');
                    else {
                        var items = [], outherItems = [],
                            conf = obj.data.config ? ood.unserialize(obj.data.config) : false,
                            sortby = {},
                            map = {};

                        if (obj.data.sub) {
                            ood.arr.each(obj.data.sub, function (o, i) {
                                outherItems.push({
                                    id: o.location ? o.location : o.id,
                                    name: o.name,
                                    caption: ood.get(map, [o.name, 'caption', ood.getLang()]) || o.name,
                                    imageWidth: ood.get(map, [o.name, 'width']) || ood.get(conf, ['imageSize', 'width']),
                                    imageHeight: ood.get(map, [o.name, 'height']) || ood.get(conf, ['imageSize', 'height'])
                                });
                            });
                        }


                        if (!ood.isEmpty(sortby)) {
                            ood.arr.stableSort(items, function (x, y) {
                                x = sortby[x.name] || -1;
                                y = sortby[y.name] || -1;
                                return x > y ? 1 : x == y ? 0 : -1;
                            });
                        } else {
                            ood.arr.stableSort(items, function (x, y) {
                                x = x.name;
                                y = y.name;
                                return x > y ? 1 : x == y ? 0 : -1;
                            });
                        }

                        var imgs = [];
                        if (obj.data.imgs) {
                            ood.arr.each(obj.data.imgs, function (o, i) {
                                imgs.push({
                                    id: o.location,
                                    caption: '',
                                    image: o.location,
                                    comment: o.name, tips: o.name
                                })
                            });
                        }
                    }
                    ns.ctl_gallery.setImgWidth(conf.imageWidth || 64);
                    ns.ctl_gallery.setImgHeight(conf.imageHeight || 64);
                    ns.ctl_gallery.resetValue();
                    ns.ctl_gallery.setItems(imgs);

                    items.push({id: obj.data.id, path: obj.data.location || obj.data.name, caption: "工程内图片"});
                    if (outherItems && outherItems.length > 0) {
                        items.push({id: 'all', caption: '本地图片', sub: items, initFold: false})
                    }
                    ns.ctl_list.setItems(items);
                    if (items[0]) {
                        ns.ctl_list.fireItemClickEvent(items[0].id);
                    }
                }
            ;

            ood.asyRun(function () {
                ood.Ajax(CONF.getInnerImgServcie, {
                    projectName: SPA.curProjectName,
                    path: 'img'
                }, callback, function (txt) {

                }, null, null, {method: 'POST'}).start();
            });
        },

        getImagePreTag: function (type) {
            return type == "online" ? CONF.onlineGalleryPath :
                type == "local" ? CONF.serviceType == "node-webkit" ? CONF.adjustProtocol('') : '' :
                    type == "inner" ? CONF.serviceType == "node-webkit" ? CONF.adjustProtocol('') : '' :
                        "";
        }
        ,
        _ctl_list_onitemselected: function (profile, item, e, src, type) {
            var ns = this;
            ns._curPage = 1;
            ns._item = item;
            ns._filter = null;
            ns._refreshContent();
        }
        ,
        _refreshContent: function () {
            var ns = this,
                curPage = ns._curPage || 1,
                item = ns._item,
                newValue = ns.ctl_input1.getValue(),
                tabs = ns.ctl_tabs2,
                tabpage = tabs.getUIValue(),
                pretag = ns.getImagePreTag(tabpage),
                callback = function (txt) {
                    ns.ctl_gallery.free();
                    var obj = txt;

                    var fillImgs = function (imgs) {
                        ood.arr.each(imgs, function (o, i) {
                            if (!/^.+\.(gif|jpg|jpeg|bmp|png)$/.test(o.name))
                                return;
                            if (newValue && !new RegExp(".*" + newValue + ".*").test(o.name)) {
                                return;
                            } else {
                                o.location = o.location ? o.location : o.path;
                                items.push({
                                    id: o.location,
                                    caption: '',
                                    image: o.location,
                                    comment: o.name, tips: o.name
                                });
                            }
                        });
                    };

                    if (!obj || obj.requestStatus == -1 || obj.error)
                        ood.message(ood.get(obj, ['error', 'errdes']) || 'no response!');
                    else {
                        var sum = obj.data && obj.data.sum;
                        if (sum) {
                            var pages = Math.ceil(sum / 100);
                            ns.ctl_pagebar1.setValue("1:" + curPage + ":" + pages);
                        }
                        var items = [];


                        if (obj.data.imgs) {
                            fillImgs(obj.data.imgs);
                        } else {
                            ood.arr.each(obj.data.sub || obj.data, function (sub, i) {
                                fillImgs(sub.imgs);
                            });
                        }


                        ns.ctl_gallery.resetValue();
                        ns.ctl_gallery.setItems(items);
                    }
                };


            ns.ctl_gallery.setImgWidth(item.imageWidth || 64);
            ns.ctl_gallery.setImgHeight(item.imageHeight || 64);
            ns.ctl_gallery.resetValue().clearItems();
            ns.ctl_gallery.busy(true);
            ood.Ajax(CONF.getSelImgByPathServcie, {
                projectName: SPA.curProjectName,
                imgConfigId: item.id,
                path: item.path,
            }, callback, function (txt) {

            }, null, null, {method: 'POST'}).start();
            if (item.sub && !item._checked)
                ns.ctl_list.toggleNode(item.id, true);
        }
        ,

        _reload: function (path) {

            var ns = this,
                tabs = ns.ctl_tabs2,
                tabpage = tabs.getUIValue(),
                callback = function (txt) {
                    var obj = txt;
                    if (!obj || obj.requestStatus == -1 || obj.error)
                        ood.message(ood.get(obj, ['error', 'errdes']) || 'no response!');
                    else {
                        var items = [],
                            conf = obj.data.conf ? ood.unserialize(obj.data.conf) : false,
                            sortby = {},
                            map = {};
                        if (conf) {
                            if (conf.list)
                                ood.arr.each(conf.list, function (o, i) {
                                    map[o.id] = o;
                                    sortby[o.id] = i;
                                });
                        }
                        ;
                        if (obj.data.files || obj.data.imgs || obj.data) {
                            ood.arr.each(obj.data.files || obj.data, function (o, i) {
                                if (o.name.charAt(0) != ".'" && !ood.str.startWith(o.name, CONF.ood_page_tpl_tag))
                                    items.push(
                                        {
                                            id: o.location,
                                            name: o.name,
                                            // sub: true,
                                            caption: ood.get(map, [o.name, 'caption', ood.getLang()]) || o.name,
                                            imageWidth: ood.get(map, [o.name, 'width']) || ood.get(conf, ['imageSize', 'width']),
                                            imageHeight: ood.get(map, [o.name, 'height']) || ood.get(conf, ['imageSize', 'height'])
                                        });
                            });
                        }
                        if (!ood.isEmpty(sortby)) {
                            ood.arr.stableSort(items, function (x, y) {
                                x = sortby[x.name] || -1;
                                y = sortby[y.name] || -1;
                                return x > y ? 1 : x == y ? 0 : -1;
                            });
                        } else {
                            ood.arr.stableSort(items, function (x, y) {
                                x = x.name;
                                y = y.name;
                                return x > y ? 1 : x == y ? 0 : -1;
                            });
                        }

                    }
                };

            if (path) {
                ood.Ajax(CONF.getSelImgByPathServcie, {
                    projectName: SPA.curProjectName,
                    path: (path),
                }, callback, function (txt) {

                })
            } else {
                ood.Ajax(CONF.getSelImgServcie, {
                    projectName: SPA.curProjectName
                }, callback, function (txt) {

                }, null, null, {method: 'POST'}).start();
            }


        }
        ,

        _toolbar_onclick: function (profile, item, group, e, src) {
            var ns = this;
            switch (item.id) {
                case 'import':
                    ood.showModule("RAD.resource.ImageTree", function () {
                        this.setData({projectName: SPA.curProjectName});
                        this.show();
                        this.initData();
                    });
                    break;
                case 'refresh':
                    ns._refreshContent();
                    break;
                case 'upload':
                    var pPath = "img";
                    var uploadPath = CONF.uploadPath;
                    var dio = ood.create("ood.UI.Dialog")
                        .setLeft("8.333333333333334em")
                        .setTop("5.833333333333333em")
                        .setWidth("40.833333333333336em")
                        .setHeight("30em")
                        .setIframeAutoLoad(uploadPath + "?uploadUrl=" + CONF.upload + "&filter=jpg;gif;png;jpeg;bmp&projectName=" + SPA.curProjectName + "&uploadpath=" + pPath)
                        .setCaption("添加文件")
                        .setMaxBtn(false)
                        .beforeClose(function () {
                            //ood.tryF(ns.properties.onOK, [ns, "{/}img/"], ns.host)
                            ns._refreshContent();
                            //ood.tryF(ns.properties.onOK, [ns, "img/"], ns.host)
                        })
                        .setMaxBtn(false);
                    dio.show();
            }

        }
        ,

        _ctl_list_ongetcontent: function (profile, item, setsub) {
            var ns = this,
                tabs = ns.ctl_tabs2,
                tabpage = tabs.getUIValue();
            if (item) {
                this._reload(item.id);
            } else {
                this._reload();
            }

        }
        ,
        _ctl_gallery_ondblclick: function (profile, item, e, src) {
            this._selectImage(item);
        }
        ,
        _ctl_pagebar1_onclick: function (profile, page) {
            var ns = this;
            // set to this page
            ns._curPage = page;
            ns._refreshContent();
        }
        ,
        _ctl_input1_onchange: function (profile, oldValue, newValue) {
            var ns = this, uictrl = profile.boxing();
            ood.resetRun("image_search", function () {
                ns._refreshContent();
            }, 1000);
        }
        ,
        _ctl_input1_oncommand: function (profile, src) {
            profile.boxing().setUIValue("");
        }
    }
})
;
ood.Class('RAD', 'ood.Module', {
    Constructor: function () {
        var ns = this,
            o = ood.message;
        arguments.callee.upper.apply(ns, arguments);
        SPA = ns;
        ns.spath = null;
        ns.tpath = null;
        ns.curProjectPath = null;
        ns.currentPage = null;
        ns.currentClassName = null;
        ns.currCom = null;
        ns.currentRootCls = null;
        ns.curProjectConfig = null;
        ns.ViewMenuBar = {};
        ns.componentMenuItems = [];
        ns.Message = [];
        ood.message = function (content) {
            if (!ns.Message)
                return;
            if (ns.Message.length > 20) ns.Message.pop();
            content = ood.stringify(content);
            if (/</.test(content))
                while (content != (content = content.replace(/<[^<>]*>/g, ""))) ;

            ns.Message.unshift({
                id: ood.id(),
                caption: content.length > 50 ? content.substr(0, 50) + '...' : content,
                tips: content,
                imageClass: 'ri-information-line'
            });

            // ns.toolbar.updateItem('info', {label: content.length > 50 ? content.substr(0, 50) + '...' : content});
            o.apply(null, ood.toArr(arguments));
        };

        ood('body').css({height: '100%', overflow: 'hidden'});
    },
    Instance: {
        fe: function (evtName, evtParams) {
            if (this.events[evtName]) return this.fireEvent(evtName, evtParams);
        },


        events: {
            beforeCreated: function () {
                if (window.loadingAnimationManager && false) {
                    window.loadingAnimationManager.showLoadingAnimation('Created');
                } else {
                    // 降级方案
                    ood.Dom.setCover('<img src="/RAD/img/loading.gif" border="0"/><div>Created</div>');
                }
                var ns = this;
            },
            onLoadBaseClass: function (module, threadid, key) {
                if (window.loadingAnimationManager && false) {
                    window.loadingAnimationManager.showLoadingAnimation('Load Base Class: ' + key);
                } else {
                    // 降级方案
                    ood.Dom.setCover('<img src="/RAD/img/loading.gif" border="0"/><div>' + 'Load Base Class: ' + key + '</div>');
                }
            },


            onReady: function (page) {
                var host = this;
                ood.ModuleFactory.setProfile(CONF.ModuleFactoryProfile);
            },
            onRender: function (page) {
                var ns = this;
                //use customApperance
                page.$infoList = new ood.UI.List({width: 400}).setCustomStyle('ITEM', 'border-bottom:dashed 1px gray');
                ns.openProject();
                ood.win.onKeypress(function (pro, e) {
                    var key = ood.Event.getKey(e),
                        ctrl = key.ctrlKey;
                    if (ctrl && k == 's') {
                        ns._menubar_onclick(ns.menubar.get(0), null, {id: "save"});
                        return false;
                    }
                });
            }
        },
        openProject: function () {
            var ns = this;
            if (currProjectName) {
                CONF.openProject(currProjectName, ns._openproject, ns._openclsfolder, function () {
                }, ns);
            } else {
                ood.ModuleFactory.getModule('prjSel', function () {
                    this.setProperties({
                        onOK1: ns._openproject,
                        onOK2: ns._openclsfolder,
                        namespace: ns
                    });
                    this.show(ood('body'));
                });
            }

        },

        reloadPage: function () {
            if (this.tabsMain.getSelectedItem()) {
                this.openCls(this.tabsMain.getSelectedItem());
            }


        },

        openCls: function (config) {
            var item = {
                id: config.id,
                value: config.id,
                reload: true,
                className: config.className,
                name: config.id
            }
            this._openfile(item)
        },

        showFirstPage: function () {
            var ns = this;
            ood.showModule("RAD.ProjectPro", function () {
                this.setProperties({
                    onOK1: ns._openproject,
                    onOK2: ns._openclsfolder,
                    namespace: ns
                });
            }, null, null, true);
        },
        _getpagename: function (name) {
            return name == "index.cls" ? ood.adjustRes('$(RAD.pm.Start Page)', true) :
                ood.str.endWith(name, '.cls') ? (name.replace(".cls", "") + " " + ood.adjustRes('$RAD.pm.Page', true)) :
                    name;
        },


        _addfile: function (pid, pathadd, name, type, openit) {
            var ns = this,
                tb1 = ns.treebarPrj,
                a = name.split('.'),
                imageClass = a[1] ? CONF.getImageTag(a[1]) : null,
                item = {
                    id: pathadd,
                    name: name,
                    caption: name,
                    imageClass: imageClass,
                    value: pathadd,
                    sub: type == '/' ? [] : null
                },
                items = [item];

            if (type !== '/' && openit !== false)
                ns._openfile(item);

            if (tb1 && tb1.getItemByItemId(pid))
                tb1.insertItems(items, pid);

            tb1.selectItem(item.id);

        },
        _delfile: function (id) {
            var ns = this,
                tree1 = this.treebarPrj,

                tab = this.tabsMain,
                arr = id.split(';'),
                a = [];
            ood.arr.each(arr, function (o, i) {
                a[i] = o;
            });


            ood.Ajax(CONF.delFile, {
                paths: id,
                projectName: SPA.curProjectName
            }, function (txt) {
                var obj = txt;
                if (obj && !obj.error && obj.requestStatus != -1) {
                    if (tree1) tree1.removeItems(arr);

                    var items = tab.getItems(), b = [];
                    ood.arr.each(items, function (o) {
                        if (ood.str.startWith(o.id, id))
                            b.push(o.id);
                    }, null, true);
                    tab.removeItems(b);

                    if (id == ns.curProjectPath) {
                        ns._closeproject(null, true);
                    }

                    if (tree1 && !tree1.getUIValue())
                        ns._updateFileToolbar(null, 'prj');

                } else
                    ood.message(ood.get(obj, ['error', 'errdes']) || obj || 'no response!');
            }, null, null, {method: 'POST'}).start();
        },

        _projecttool_onclick: function (profile, titem, group, e, src) {
            this._fileaction(null, titem.id, src, 'prj');

        },

        _fileaction: function (tbItem, action, src, type) {
            var ns = this,
                ins1 = ns.treebarPrj,
                ins = ins1;
            if (!this.curProjectPath) {
                ood.message(ood.getRes('RAD.ps.noprj'));
                return;
            }
            if (!tbItem) {
                var sv = ins.getUIValue();
                if (sv) tbItem = ins.getItemByItemId(sv);
            }
            if (!tbItem) {
                if (action != "del2" && action != "new2") {
                    var items = ins.getItems();
                    if (items[0]) {
                        tbItem = items[0];
                    }
                    if (!tbItem) {
                        return;
                    }
                }
            }

            switch (action) {
                case 'editastext':
                    ns._openfile(tbItem, src, false, true, true)
                    break;
                case 'explore':
                    CONF.showInExplore(tbItem ? tbItem.id : ns.curProjectPath);
                    break;
                case 'newFolder':
                    ood.showModule("RAD.AddFile", function () {
                        this.setProperties({
                            fileName: name,
                            parentPath: tbItem.id,
                            typeCaption: '$RAD.esdmenu.newFolder',
                            type: '/',
                            forcedir: true,
                            tailTag: ""
                        });
                        this.setEvents({
                            onOK: function (item) {
                                try {
                                    ns.dialog.hide();
                                } catch (e) {
                                }
                                item.sub = true;
                                item.id = item.location;
                                item.value = item.location
                                var insOther = ins1;
                                if (insOther && (tbItem = insOther.getItemByItemId(tbItem.id)))
                                    insOther.insertItems([item], tbItem.id, true);
                            }
                        });
                    }, null, null, true);
                    break;
                case 'newClass':
                    ood.showModule("RAD.AddFile", function () {
                        this.setProperties({
                            fileName: 'Page',
                            parentPath: tbItem.id,
                            typeCaption: '.cls',
                            type: 'class',
                            forcedir: true,
                            tailTag: ".cls"
                        });
                        this.setEvents({
                            onOK: function (item) {
                                try {
                                    ns.dialog.hide();
                                } catch (e) {

                                }

                                var insOther = ins1;
                                if (insOther && (tbItem = insOther.getItemByItemId(tbItem.id))) {
                                    item.caption = item.name ? item.name : item.caption;
                                    insOther.insertItems([item], tbItem.id, true);
                                }
                                item.value = item.id;
                                ns._openfile(item, item.path, false, true, false)

                            }
                        });
                    }, null, null, true);
                    break;
                case 'upload':
                    var pPath = tbItem.id;
                    var uploadPath = CONF.uploadPath;
                    var params = {
                        uploadUrl: CONF.upload,
                        projectName: SPA.curProjectName,
                        uploadpath: pPath
                    }

                    var dio = ood.create("ood.UI.Dialog")
                        .setLeft("8.333333333333334em")
                        .setTop("5.833333333333333em")
                        .setWidth("40.833333333333336em")
                        .setHeight("30em")
                        .setIframeAutoLoad(uploadPath + "?uploadUrl=" + CONF.upload + "&projectName=" + SPA.curProjectName + "&uploadpath=" + pPath)
                        .setCaption("$RAD.addfile.iUpload")
                        .setMaxBtn(false)
                        .beforeClose(function () {

                        })
                        .setMaxBtn(false);

                    if (window['postMessage']) {
                        self._msgcb = function (e) {
                            try {
                                e = e.data;
                                e = ood.unserialize(e);
                                if (e.data) {
                                    var item = e.data;
                                    var insOther = ins1;
                                    if (insOther && (tbItem = insOther.getItemByItemId(tbItem.id))) {
                                        var a = item.name.split('.');
                                        a = a.length == 1 ? "" : (a[a.length - 1].toLowerCase());
                                        item.imageClass = CONF.getImageTag(a);
                                        item.value = item.location;
                                        insOther.insertItems([item], tbItem.id, true);
                                    }
                                }
                            } catch (e) {

                            }

                        };
                        if (window.addEventListener) window.addEventListener('message', self._msgcb, false);
                        else window.attachEvent('onmessage', self._msgcb);
                    }
                    dio.show();
                    break;
                case  'import'   :
                    ood.showModule("RAD.ProjectTree", function () {
                        this.setData({
                            tpath: tbItem.id
                        });
                        this.setEvents({
                            onOK: function (sub) {
                                var insOther = ins1;
                                ood.each(sub, function (item) {
                                    if (insOther && (tbItem = insOther.getItemByItemId(tbItem.id)))
                                        insOther.insertItems([item], tbItem.id, false);
                                })
                            }
                        });
                        this.initData();
                        this._fireEvent('afterShow');
                    }, null, null, true);

                    break;
                case  'importModule'   :
                    ood.showModule("RAD.ProjectModuleTree", function () {
                        this.setData({
                            tpath: tbItem.id

                        });
                        this.setEvents({
                            onOK: function (sub) {
                                var insOther = ins1;
                                ood.each(sub, function (item) {
                                    if (insOther && (tbItem = insOther.getItemByItemId(tbItem.id)))
                                        insOther.insertItems([item], tbItem.id, false);
                                })
                            }
                        });
                        this.initData();
                        this._fireEvent('afterShow');
                    }, null, null, true);

                    break;


                case
                'paste2'
                :

                    ood.showModule("RAD.AddFile", function () {
                        this.setProperties({
                            fileName: 'Page',
                            parentPath: tbItem.id,
                            typeCaption: '.cls',
                            type: 'class',
                            forcedir: true,
                            tailTag: ".cls"
                        });
                        this.setEvents({
                            onOK: function (item) {
                                try {
                                    ns.dialog.hide();
                                } catch (e) {

                                }
                                var insOther = ins1;
                                if (insOther && (tbItem = insOther.getItemByItemId(tbItem.id))) {
                                    item.caption = item.name ? item.name : item.caption;
                                    insOther.insertItems([item], tbItem.id, true);
                                }
                                item.value = item.id;
                                ns._openfile(item, item.path, false, true, false)

                            }
                        });
                    }, null, null, true);
                    break;
                case
                'paste'
                :
                    ood.Ajax(CONF.copy, {
                        spath: ns.spath,
                        forcedir: true,
                        tpath: tbItem.id,
                        projectName: SPA.curProjectName
                    }, function (txt) {
                        var obj = txt;
                        if (obj && !obj.error && obj.requestStatus != -1) {

                            var data = obj.data;
                            item = {
                                id: data.location,
                                name: data.name,
                                caption: data.name,
                                className: data.className,
                                imageClass: data.imageClass,
                                value: data.location
                            };

                            if (ood.str.endWith(data.id, ".cls")) {

                                var insOther = ins1;
                                if (insOther && (tbItem = insOther.getItemByItemId(tbItem.id)))
                                    insOther.insertItems([item], tbItem.id);
                                ns._openfile(item, item.path, false, true, true)
                            } else if (ood.str.endWith(data.id, "/")) {
                                item.sub = true;
                                var insOther = ins1;
                                if (insOther && (tbItem = insOther.getItemByItemId(tbItem.id)))
                                    insOther.insertItems([item], tbItem.id);

                            } else {
                                var insOther = ins1;
                                if (insOther && (tbItem = insOther.getItemByItemId(tbItem.id)))
                                    insOther.insertItems([item], tbItem.id);
                            }

                            ns.spath = null;
                        } else
                            ood.message(ood.get(obj, ['error', 'errdes']) || obj || 'no response!');
                    }, function (obj) {
                        ood.message(ood.get(obj, ['error', 'errdes']) || obj || 'no response!');
                    }, null, {method: 'POST'}).start();

                    break;

                case
                'copy2'
                :
                    ns.spath = tbItem.id;

                    break;

                case
                'rename'
                :

                    var name = tbItem.name, tail = "";
                    if (!tbItem.sub) {
                        var a = name.split("."),
                            tail = "." + a.pop();
                        name = a.join(".");
                    }

                    var dlg = ood.prompt(ood.getRes("RAD.designer.Rename"), ood.getRes("RAD.Specify the new name") + (tail ? ("(" + tail + ")") : ""), name, function (nn) {

                        if (nn) nn = ood.str.trim(nn);
                        nn += tail;
                        if (!CONF.fileNames.test(nn)) {
                            ood.message(ood.getRes("RAD.addfile.filenameformat"));
                            return false;
                        } else {
                            var nid = tbItem._pid;
                            if (!ood.str.endWith(nid, "/")) {
                                nid = nid + "/";
                            }
                            var oid = tbItem.id,
                                nid = nid + nn,
                                name = nn,
                                imageClass;

                            ood.Ajax(CONF.reName, {
                                path: oid,
                                projectName: SPA.curProjectName,
                                newName: name
                            }, function (txt) {
                                var obj = txt;
                                if (obj && !obj.error && obj.requestStatus != -1) {
                                    var data = obj.data;
                                    var item = {
                                        id: data.location,
                                        name: data.name,
                                        caption: data.name,
                                        className: data.className,
                                        imageClass: data.imageClass,
                                        path: data.location,
                                        value: data.location
                                    };


                                    if (tbItem.sub) {
                                        // modify the project name
                                        if (SPA.curProjectPath == tbItem.id) {
                                            SPA.curProjectPath = nid;
                                            SPA.curProjectName = name;
                                        }

                                        // remove allsub first
                                        var arr = [],
                                            fun = function (sub) {
                                                var f = fun;
                                                if (ood.isArr(sub))
                                                    ood.arr.each(sub, function (o, i) {
                                                        arr.push(o.id);
                                                        if (o.sub) f(o.sub);
                                                    });
                                                f = null;
                                            };
                                        fun(tbItem.sub);
                                        ins.removeItems(arr);

                                        arr = [];
                                        var insOther = type == 'prj' ? ins2 : ins1;
                                        var itt = insOther.getItemByItemId(tbItem.id);
                                        if (itt && itt.sub && itt.sub.length) {
                                            fun(itt.sub);
                                            insOther.removeItems(arr);
                                        }

                                        if (ins1) ins1.updateItem(oid, {
                                            id: nid,
                                            value: nid,
                                            loacation: nid,
                                            name: name,
                                            caption: name,
                                            _inited: false,
                                            sub: true
                                        });
                                        ins2.updateItem(oid, {
                                            id: nid,
                                            value: nid,
                                            loacation: nid,
                                            name: name,
                                            caption: ns._getpagename(name),
                                            _inited: false,
                                            sub: true
                                        });

                                        // remove all modified tabs
                                        var items = ns.tabsMain.getItems(), b = [];
                                        ood.arr.each(items, function (o) {
                                            if (!ins.getSubIdByItemId(o.id))
                                                b.push(o.id);
                                        }, null, true);

                                        if (b && b.length)
                                            ns.tabsMain.removeItems(b);
                                    } else {
                                        item.imageClass = CONF.getImageTag(nid);
                                        // udpate file name
                                        if (ins1) ins1.updateItem(oid, ood.clone(item));
                                        ins2.updateItem(oid, ood.clone(item));
                                        // update tabs
                                        var aitem = ns.tabsMain.getItemByItemId(oid);
                                        if (aitem) {
                                            ns.closeFile(oid)
                                            ns._openfile(item, item.path, false, true, true)
                                        }
                                    }
                                    ood.message(ood.getRes("$RAD.designer.msg.renamefileok"));
                                } else
                                    ood.message(ood.get(obj, ['error', 'errdes']) || obj || 'no response!');
                            }, null, null, {method: 'POST'}).start();
                        }
                    });
                    dlg._$input.setMultiLines(false);//.setHeight(30);
                    dlg = null;
                    break;
                case

                'del2'
                :
                    if (tbItem) {
                        ood.confirm(ood.getRes('RAD.delfile.confirmdel'), ood.getRes('RAD.delfile.confirmdel2', "1"), function () {
                            ns._delfile(tbItem.id);
                        });
                    } else {
                        ood.ModuleFactory.getModule('delFile', function () {
                            this.host = ns;
                            this.setProperties({
                                fromRegion: ood(src).cssRegion(true),
                                parent: ns,
                                onOK: ns._delfile
                            });
                            this.show(ood('body'));
                        });
                    }
                    break;
                case   'refresh':
                    CONF.openProject(ns.curProjectName, ns._openproject, null, function () {
                        ood.message(ood.getRes('RAD.tool2.refreshOK'));
                    }, ns, true);
                    break;
            }

        }
        ,
        _dirtyWarn: function (callback) {
            var ns = this, dirty, tb = this.tabsMain, items = tb.getItems();
            ood.arr.each(items, function (o) {
                if (o._dirty) return !(dirty = true);
            });
            if (dirty)
                ood.UI.Dialog.confirm(ood.getRes('RAD.notsave'), ood.getRes('RAD.notsave3'), callback);
            else
                callback();
        }
        ,
        _setproject: function () {
            ood.getModule("RAD.project.ProjectInfo", function () {
                this.setData({projectName: SPA.curProjectName});
                this.show();
                this.initData();
                this._fireEvent('afterShow');
            });
            //  break;
        }
        ,
        _closeproject: function (callback, deleted) {
            var ns = this, dirty, tb = this.tabsMain, items = tb.getItems(),
                tree1 = this.treebarPrj;

            ood.arr.each(items, function (o) {
                if (o && o._dirty) return !(dirty = true);
            });
            var fun = function () {
                ns._resetPrjEnv();

                // save status first
                var hash = CONF.getStatus(),
                    prjs = hash.projects || (hash.projects = []),
                    index = ood.arr.subIndexOf(prjs, 'id', ns.curProjectPath);
                if (index != -1) ood.arr.removeFrom(prjs, index);
                if (!deleted) {
                    prjs.push({
                        caption: ns.curProjectName,
                        id: ns.curProjectPath,
                        file: tb.getUIValue(),
                        files: tb.getItems('min')
                    });
                    if (prjs.length >= 10) prjs.shift();
                }
                CONF.saveStatus(hash);

                tb.clearItems();
                if (tree1) tree1.clearItems();


                ood.Class.__gc("Module");
                ood.$cache.clsByURI = {};
                ood.$cache.fetching = {};

                ns.curProjectPath = ns.curProjectName = ns.currentPage = ns.currentRootCls = ns.curProjectConfig = null;


                if (typeof callback == 'function') callback();
                if (ns.projecttool)
                    ns.projecttool.setDock('none').setDisplay('none');
                if (tree1) tree1.adjustDock(true);


                if (ns._servicebox) {
                    ns._servicebox.clearContent();
                }

                window["/"] = undefined;

                // clear project
                document.title = document.title.replace(/\s*\[.*\]\s*$/, '');
            };

            if (dirty)
                ood.UI.Dialog.confirm(ood.getRes('RAD.notsave'), ood.getRes('RAD.notsave2'), fun);
            else
                fun();
        }
        ,
        _tabsmain_beforepageclose: function (profile, item, src) {
            if (item._dirty) {
                ood.UI.Dialog.confirm(ood.getRes('RAD.notsave'), ood.getRes('RAD.notsave2'), function () {
                    profile.boxing().removeItems(item.id);
                });
                return false;
            }
        }
        ,
        _tabsmain_afterpageclose: function (profile, item, src) {
            if (item.$obj) item.$obj.destroy();
            SPA.currentPage = "";
        }
        ,
        _tabsmain_beforeValueUpdated: function (profile, ov, nv) {
            var item = this.tabsMain.getItemByItemId(ov), t;
            if (!item) return;
            if (t = item.$obj) {
                if (t.checkEditorCode && t.checkEditorCode() === false) return false;
            }
        }
        ,
        _tabmain_onitemselected: function (profile, item, e, src) {
            if (item._inn) {
                profile.boxing().setDisabled(true);
                profile.boxing().append(item._inn, item.id);
                delete item._inn;
            }
            ood.tryF(function () {
                if (item.$obj) item.$obj.activate();
            });
            SPA.currentPage = item.id;
            SPA.currentClassName = item.className;
        }
        ,
        _treebarprj_oncontextmenu: function (profile, e, src, item) {
            if (item) {
                this._treebarprj_onshowopt(profile, item, e, src);
                return false;
            }
        }

        ,
        _treebarprj_onshowopt: function (profile, item, e, src) {
            var ns = this, ins = profile.boxing(), items;
            if (item) {
                items = [
                    {id: 'del2', imageClass: 'ri-subtract-line', caption: '$RAD.tool2.del2'},
                    {id: 'split', type: 'split'}
                ];
                if (item && !item.sub) {
                    items.push({
                        id: 'editastext',
                        imageClass: 'ri-edit-line',
                        caption: '$RAD.tool2.editastext'
                    });
                }
                items.push({id: 'refresh', imageClass: 'ri-refresh-line', caption: '$RAD.tool2.refresh'});
                items.unshift({id: 'rename', imageClass: 'ri-edit-line', caption: '$RAD.tool2.modify'});

                if (item.sub) {

                    items.unshift({id: 'upload', imageClass: 'ri-file-line', caption: '$RAD.esdmenu.upload'});
                    if (ood.str.startWith(item.id, 'Module')) {
                        items.unshift({
                            id: 'importModule',
                            imageClass: 'ri-file-line',
                            caption: '$RAD.esdmenu.importModule'
                        });
                    } else {
                        items.unshift({id: 'import', imageClass: 'ri-file-line', caption: '$RAD.esdmenu.import'});
                    }
                    items.unshift({id: 'newFolder', imageClass: 'ri-folder-line', caption: '$RAD.esdmenu.newFolder'});
                    items.unshift({
                        id: 'newClass',
                        imageClass: 'ri-add-line',
                        caption: '$RAD.esdmenu.newClass'
                    });
                    items.unshift({
                        id: 'copy2',
                        imageClass: 'ri-file-copy-line',
                        caption: '',
                        caption: '$RAD.tool2.copy2'
                    });

                    if (ns.spath) {
                        items.unshift({
                            id: 'paste',
                            imageClass: 'ri-clipboard-line',
                            caption: '$RAD.esdment.paste',
                            tip: '$RAD.esdment.paste'
                        });
                    }
                } else {

                    items.unshift({
                        id: 'copy2',
                        imageClass: 'ri-file-copy-line',
                        caption: '',
                        caption: '$RAD.tool2.copy2'
                    });
                }
            } else {
                items = [
                    {id: 'refresh', imageClass: 'ri-refresh-line', caption: '$RAD.tool2.refresh'},
                    {id: 'new', imageClass: 'ri-add-line', caption: '$RAD.tool2.new2'},
                    {id: 'del', imageClass: 'ri-subtract-line', caption: '$RAD.tool2.del2'}
                ];
            }
            var pop = new ood.UI.PopMenu({
                items: items
            });
            pop.onMenuSelected(function (prf, popitem, src) {
                ns._fileaction(item, popitem.id,
                    item ? ins.getSubNodeByItemId('BAR', item.id) : null,
                    "prj");
                pop.destroy();
            });
            pop.pop(ood.Event.getPos(e));
            return false;
        }
        ,
        _treebarprj_onGetContent: function (profile, item, callback) {
            var ns = this;
            ood.Ajax(CONF.openFolderService, {path: item.id, projectName: SPA.curProjectName}, function (txt) {
                var obj = txt;
                if (obj && !obj.error) {
                    isoodpage = false;
                    var root = ns.buildFileItems(item.id, obj.data.files || obj.data, isoodpage ? function (o) {
                        return !(o.type && !ood.str.endWith(o.name, ".js") && !ood.str.endWith(o.name, ".cls") && !ood.str.endWith(o.name, ".jsx") && !ood.str.endWith(o.name, ".html") && !ood.str.endWith(o.name, ".vv"));
                    } : null, isoodpage);
                    callback(root.sub);
                } else ood.message(ood.get(obj, ['error', 'errdes']) || obj || 'no response!');
            }, null, null, {method: 'POST'}).start();


        }
        ,
        _treebarprj_ondblclick: function (profile, item, e, src) {
            if (!item.sub) {
                this._openfile(item, src)
            }
        }
        ,
        openFile: function (path) {
            this._openfile({
                id: path,
                value: path,
                name: path.split('/').pop()
            });
        }
        ,
        closeFile: function (path) {
            var ns = this,
                tb = ns.tabsMain;
            if (tb.getItemByItemId(path)) {
                tb.removeItems([path]);
            }
        }
        ,

        getSelected: function () {
            return this._getSelected();
        },

        _openfile: function (item, src, stopseleted, dontshowerror, forceAsText) {
            if (!item.id || item.sub) return;

            var ns = this,
                tb1 = ns.treebarPrj,
                className = item.className;
            if (className && ood.str.endWith(className, ".cls")) {
                className = className.replace(".cls", "");
            }
            arr = item.name.split('.'),
                type = arr[arr.length - 1],
                isText = false;

            if (!forceAsText) {
                if (!isText) {
                    if (!CONF.getRenderMode(type) && type.indexOf("VVVERSION") == -1) {
                        CONF.openFile(item.id);
                        return;
                    }
                }
            }

            //item.value
            var value = item.value;
            if (!value) {
                value = item._pid + '/' + item.name;
            }

            var arr = value.split('/'),
                filename = arr[arr.length - 1],
                caption = ood.str.startWith(value, SPA.curProjectPath + "/" + ns.currentRootCls + "/js/") ? ns._getpagename(filename) : filename,
                filearr = filename.split('.'),
                filetype = filearr[filearr.length - 1],
                imageClass = CONF.getImageTag(filetype);
            var tb = ns.tabsMain, pro = tb.reBoxing().cssRegion(true);
            if (item.reload && tb.getItemByItemId(value)) {
                tb.removeItems([value]);
            }
            if (tb.getItemByItemId(value) && !tb._dirty) {
                tb.fireItemClickEvent(value);
            } else {
                var funOK = function (txt) {
                        if (txt.error) {
                            return;
                        }
                        if (!txt.data || !txt.data.content) {
                            return;
                        }


                        var filecon = txt.data.content;
                        if (ood.isSet(filecon)) {
                            var item = {
                                    id: value, tips: value,
                                    caption: caption,
                                    closeBtn: true,
                                    className: className,
                                    imageClass: imageClass,
                                    panelBgImgPos: "center center",
                                    panelBgImgRepeat: "no-repeat"//,

                                },
                                items = tb.getItems(),
                                itemid = item.id,
                                callback = function (pagprofile, b) {
                                    tb.markItemCaption(pagprofile.properties.keyId, b);
                                };

                            if (!tb.getItemByItemId(value)) {
                                tb.insertItems([item], items.length ? items[items.length - 1].id : null);
                            }

                            if (filetype != 'js' && filetype != 'cls') {
                                ood.ModuleFactory.newModule('RAD.PageEditor', function () {
                                    var inn = this;
                                    inn.host = ns;
                                    inn.setType(filetype);
                                    inn.setProperties({
                                        keyId: itemid
                                    });
                                    inn.setEvents('onValueChanged', callback);
                                    inn.setEvents('onCommandSave', function (pagprofile) {
                                        //pagprofile.properties.keyId
                                        ns._menubar_onclick(ns.menubar.get(0), null, {id: "save"});
                                    });
                                    inn.setEvents('afterRendered', function () {
                                        tb.setDisabled(false);
                                    });

                                    inn.setValue(filecon);

                                    var item = tb.getItemByItemId(itemid);
                                    item.$obj = inn;
                                    item._inn = inn;

                                    if (!stopseleted)
                                        tb.fireItemClickEvent(value);
                                });
                            } else {
                                ood.ModuleFactory.newModule('RAD.JSEditor', function () {
                                    var inn = this;
                                    inn.buttonview.setNoHandler(true);
                                    var tb = ns.tabsMain;
                                    inn.host = ns;
                                    inn.setProperties({
                                        keyId: itemid
                                    });
                                    inn.setEvents('onValueChanged', callback);
                                    inn.setEvents('onCommandSave', function (pagprofile) {
                                        //pagprofile.properties.keyId
                                        ns._menubar_onclick(ns.menubar.get(0), null, {id: "save"});
                                    });
                                    inn.setEvents('afterRendered', function () {
                                        tb.setDisabled(true);

                                        var des = inn._designer;

                                        var item = tb.getItemByItemId(itemid);
                                        item.$obj = inn;
                                        // item._inn = inn;
                                        ood.setTimeout(function () {
                                            try {
                                                if (des.getWidgets() && des.getWidgets().length > 0) {
                                                    var jscode = des.getJSCode(des.getWidgets(true));
                                                    // des.refreshView(jscode, true);
                                                    des.markDirty(true);
                                                    des.resetCodeFromDesigner(true);
                                                    des.refreshView(jscode, true);
                                                    des.markDirty(false);
                                                    tb.markItemCaption(itemid, false, true);
                                                }
                                            } catch (e) {
                                                console.warn(e);
                                            }
                                            tb.setDisabled(false);
                                        }, 500);


                                    });
                                    var clsname = RAD.ClassTool.getClassName(filecon),
                                        pclsname = RAD.ClassTool.getClassName(filecon, true);

                                    if (clsname && pclsname && !forceAsText) {
                                        inn.setDftPage('design');
                                    } else {
                                        inn.setDftPage('code');
                                    }
                                    inn.setValue(filecon);

                                    var item = tb.getItemByItemId(itemid);
                                    item.$obj = inn;
                                    item._inn = inn;

                                    if (!stopseleted)
                                        tb.fireItemClickEvent(value);
                                });
                            }
                            // try to select
                            if (tb1)
                                tb1.setUIValue(value);

                        }
                    },
                    funFail = function (msg) {
                        if (!dontshowerror)
                            ood.message(msg);
                    };

                ood.Ajax(CONF.getFileContent, {
                    path: value,
                    className: className,
                    projectName: SPA.curProjectName
                }, funOK, funFail, {method: 'POST'}).start();


            }
        }

        ,
        iniComponents: function () {
            // [[Code created by EU RAD Studio
            var host = this, ns = this, children = [], append = function (child) {
                children.push(child.get(0));
            };

            append(
                (new ood.UI.MenuBar())
                    .setHost(host, "menubar")
                    .setDockOrder("1")
                    .setAutoShowTime(100)
                    .onMenuSelected("_menubar_onMenuBtnClick")
                    .setValue('file')
                    .setItems(CONF.tompmenu)
            );

            append(
                (new ood.UI.ButtonViews())
                    .setHost(host, "mainLayout")
                    .setBarLocation("right")
                    .setSideBarSize("4.5em")
                    .setBarSize("7em")
                    .setSideBarStatus("fold")
                    .setItems([{
                        "id": "oodmain",
                        "caption": "页面编辑",
                        "imageClass": "ri-file-text-line"
                    }, {
                        "id": "java",
                        "caption": "代码工程",
                        "imageClass": "ri-calculator-line"
                    },
                        {
                            "id": "dsmDesigner",
                            "caption": "资源库",
                            "imageClass": "iconfont iconchucun"
                        },
                        {
                            "id": "dsmConfig",
                            "caption": "领域管理",
                            "imageClass": "ri-3d-box-line"

                        },
                        {
                            "id": "themeToggle",
                            "caption": "主题切换",
                            "imageClass": "ri-palette-line"
                        }
                    ])
                    .onItemSelected(function (profile, item) {
                        if (item.id == 'java' && !item.className) {
                            var className = 'Debug.dsmconfig.BuildTree';
                            ood.showModule2('Debug.dsmconfig.BuildTree', "mainLayout", "java", {
                                projectVersionName: currProjectName,
                                domainId: domainId,
                                projectName: currProjectName
                            });
                            item.className = className;
                        } else if (item.id == 'dsmDesigner' && !item.className) {
                            var className = 'Debug.dsmconfig.DSMInstNavTree';
                            ood.showModule2(className, "mainLayout", "dsmDesigner", {
                                projectVersionName: currProjectName,
                                domainId: domainId,
                                projectName: currProjectName
                            });
                            item.className = className;
                        } else if (item.id == 'dsmConfig' && !item.className) {
                            var className = 'Debug.dsmconfig.ModuleTree';
                            ood.showModule2(className, "mainLayout", "dsmConfig", {
                                projectVersionName: currProjectName,
                                domainId: domainId,
                                projectName: currProjectName
                            });
                            item.className = className;
                        } else if (item.id == 'themeToggle') {
                            // 主题切换功能
                            var themes = ['default', 'army', 'darkblue', 'electricity', 'lightblue', 'moonify', 'orange', 'pink', 'red', 'vista', 'classic', 'webflat'];
                            var currentTheme = ood.getTheme();
                            var currentIndex = themes.indexOf(currentTheme);
                            var nextIndex = (currentIndex + 1) % themes.length;
                            var nextTheme = themes[nextIndex];

                            ood.setTheme('light', true, function () {
                                // 更新当前主题状态
                                if (SPA) {
                                    SPA.$curTheme = nextTheme;
                                }
                                // 更新按钮标题显示当前主题
                                if (item && item.caption) {
                                    item.caption = "主题：" + nextTheme;
                                }
                            });
                        }

                    })
                    .setOverflow("none")
                    .setValue("oodmain")
                , "main"
            )


            host.mainLayout.append(
                (new ood.UI.Block())
                    .setHost(host, "mainPanel")
                    .setDock('fill')
                , "oodmain"
            );

            host.mainPanel.append(
                (new ood.UI.Layout())
                    .setHost(host, "layout")
                    .setItems([{
                        "id": "before",
                        "pos": "main",
                        "locked": false,
                        "size": 260,
                        "min": 50,
                        "max": 800,
                        "cmd": true,
                        "hide": false,
                        "folded": false,
                        "hidden": false
                    }, {
                        "id": "main",
                        "min": 10
                    }])

                    .setCustomStyle({
                        "MOVE": {
                            "background-color": "transparent"
                        }
                    })
                    .setType("horizontal")
            );


            var conview = [];
            conview.push({
                "id": "prj",
                "caption": "$RAD.toolbox.prj",
                "imageClass": "ri-folder-line"
            })
            ood.arr.each(CONF.widgets, function (item) {
                conview.push(item);
            })

            host.layout.append(
                (new ood.UI.ButtonViews())
                    .setHost(host, "prjtabs")
                    .setItems(conview)
                    .setAutoIconColor(false)
                    .setBarLocation("left")
                    .setSideBarSize("3.25em")
                    .setSideBarStatus("fold")
                    .setOverflow("none")
                    .setValue("prj")

                    .onItemSelected(function (profile, item, e, src, type) {
                        var ns = this, uictrl = profile.boxing(), sub = item.sub;
                        if (item.view == 'Gallery') {
                            var itemsub = [];
                            ood.arr.each(sub, function (o) {
                                if (o.sub && o.group && o.sub.length > 0) {
                                    ood.arr.each(o.sub, function (ows) {
                                        itemsub.push(ows);
                                    });
                                } else {
                                    itemsub.push(o)
                                }
                            });
                            uictrl.append(
                                (new ood.UI.Panel())
                                    .setHost(host, item.id + 'panel')
                                    .setLeft("0em")
                                    .setTop("0em")
                                    .setImageClass(item.imageClass)
                                    .setCaption(item.caption + "组件")
                                    .append(
                                        (new ood.UI.Gallery())
                                            .setHost(host, item.id + 'tree')
                                            .setDragKey("___iDesign")
                                            .setDock('fill')
                                            .setSelMode("single")
                                            .setIconFontSize("2em")
                                            .setColumns(2)
                                            .setItems(
                                                itemsub
                                            )
                                            .onStartDrag("_itembeforeMousedown")
                                            .setCustomStyle({
                                                    "CONTENT": {
                                                        "margin": "0.5em"
                                                    },

                                                    "ITEMFRAME": {
                                                        "background-color": "transparent",
                                                        "border-top": "dashed 1px #ababab",
                                                        "border-right": "dashed 1px #ababab",
                                                        "border-bottom": "dashed 1px #ababab",
                                                        "border-left": "dashed 1px #ababab",
                                                        "margin": "1px 1px 1px 1px"
                                                    },
                                                }, item.id
                                            )
                                    )
                            )

                        } else if (item.id != 'prj') {
                            var coypItem = ood.clone(item);
                            ood.arr.each(coypItem.sub, function (o) {
                                o.imageClass = '';
                                o.height = 80 * (o.sub.length / 2 + 1);
                                o.initFold = false;
                                o.closeDisplay = true;
                                o.popDisplay = false;
                                o._opt = false;
                                ood.arr.each(o.sub, function (ows) {
                                    ows.comment = ows.caption;
                                    ows.caption = '';
                                });
                            });

                            uictrl.append(
                                (new ood.UI.Panel())
                                    .setHost(host, coypItem.id + 'panel')
                                    .setLeft("0em")
                                    .setTop("0em")
                                    .setImageClass(coypItem.imageClass)
                                    .setCaption(coypItem.caption + "组件")
                                    .append(
                                        (new ood.UI.FoldingTabs())
                                            .setHost(host, coypItem.id + 'tree')
                                            .setDragKey("___iDesign")
                                            .setDock('fill')
                                            .setAutoIconColor(false)
                                            .setSelMode("multi")
                                            .setItems(
                                                coypItem.sub
                                            )
                                            .setUIValue(coypItem.sub[0].id)
                                            .onItemSelected(function (profile, item, e, src, type) {
                                                    var ns = this, uictrl = profile.boxing(), sub = item.sub;
                                                    uictrl.append(
                                                        (new ood.UI.Gallery())
                                                            .setHost(host, item.id + 'tree')
                                                            .setDragKey("___iDesign")
                                                            .setDock('fill')
                                                            .setSelMode("single")
                                                            .setIconFontSize("2em")
                                                            .setColumns(2)
                                                            .setItems(
                                                                item.sub
                                                            )
                                                            .onStartDrag("_itembeforeMousedown")
                                                            .setCustomStyle({
                                                                "CONTENT": {
                                                                    "margin": "0.5em"
                                                                },
                                                                "COMMENT": {
                                                                    "margin": "0.5em"
                                                                },
                                                                "ITEMFRAME": {
                                                                    "background-color": "transparent",
                                                                    "border-top": "dashed 1px #ababab",
                                                                    "border-right": "dashed 1px #ababab",
                                                                    "border-bottom": "dashed 1px #ababab",
                                                                    "border-left": "dashed 1px #ababab",
                                                                    "margin": "1px 1px 1px 1px"
                                                                },
                                                            }, item.id)
                                                    );


                                                }
                                            )
                                            .onStartDrag("_itembeforeMousedown")
                                    )
                            )
                        }
                    })
                , "before");


            host.prjtabs.append(
                (new ood.UI.ToolBar())
                    .setHost(host, "projecttool")
                    .setDisplay("none")
                    .setAutoIconColor(false)
                    .setHandler(false)
                    .onClick("_projecttool_onclick")
                    .setCustomStyle({
                        "ITEMS": {
                            "border-width": "0 0 1px 0"
                        },
                    })
                , "prj");


            host.prjtabs.append(
                (new ood.UI.TreeBar())
                    .setHost(host, "treebarPrj")
                    .setDynDestory(true)
                    .setAutoIconColor(false)
                    .setOptBtn('ood-uicmd-opt')
                    .setDropKeys("ood.builder.pfjm")
                    .setDragKey("ood.builder.pfjm")
                    .onContextmenu("_treebarprj_oncontextmenu")
                    .onDblclick("_treebarprj_ondblclick")
                    .onGetContent("_treebarprj_onGetContent")
                    .onShowOptions("_treebarprj_onshowopt")
                    .onClick("_treebarprj_onclick")
                    .onItemSelected("_treebarprj_onitemselected")
                    .afterFold("_treebarprj_fold")
                    .onDropTest("__ondroptest")
                    .onDrop("__ondrop")
                    .beforeDrop("__beforedrop")
                    .setCustomStyle({
                        "RULER": {
                            "font-size": "1.5em"
                        }
                    })
                , "prj");


            if (this.projecttool) {
                this.projecttool.setItems(CONF.projecttool);
            }


            host.layout.append(
                (new ood.UI.Tabs())
                    .setHost(host, "tabsMain")
                    .beforeUIValueSet("_tabsmain_beforeValueUpdated")
                    .beforePageClose("_tabsmain_beforepageclose")
                    .afterPageClose("_tabsmain_afterpageclose")
                    .onItemSelected("_tabmain_onitemselected")
                    .setCustomStyle({
                        "PANEL": "overflow:hidden;"
                    })
                , "main");


            return children;
        }
        ,


        _itembeforeMousedown: function (profile, e, src) {
            if (ood.Event.getBtn(e) != "left") return;
            if (profile.properties.disabled) return;
            // not resizable or drag
            if (!profile.properties.dragKey) return;

            // avoid nodraggable keys
            if (profile.behavior.NoDraggableKeys) {
                var sk = profile.getKey(ood.Event.getSrc(e).id || "").split('-')[1];
                if (sk && ood.arr.indexOf(profile.behavior.NoDraggableKeys, sk) != -1) return;
            }
            var id = ood.use(src).id(),
                itemId = profile.getSubId(id),
                properties = profile.properties,
                item = profile.getItemByDom(id),
                pos = ood.Event.getPos(e);
            var moduletype = item.className;
            if (item.className && item.key == 'ood.Module') {
                moduletype = item.className;
            } else {
                moduletype = item.key
            }


            if (item.draggable) {
                var csrc = ood(src).clone(true);
                csrc.css('width', '100%');
                profile.getSubNode('ITEMICON', itemId).startDrag(e, {
                    dragType: 'icon',
                    shadowFrom: csrc,
                    dragCursor: 'pointer',
                    targetLeft: pos.left - 12,
                    targetTop: pos.top + 12,
                    dragKey: item.dragKey || profile.properties.dragKey,
                    dragData: {
                        cls: item.cls || item.key,
                        type: moduletype,
                        children: item.sub,
                        caption: item.caption,
                        iniProp: item.iniProp,
                        iniEvents: item.iniEvents,
                        customRegion: item.customRegion,
                        image: item.image,
                        imagePos: item.imagePos,
                        imageClass: item.imageClass

                    }
                });
                ood.use(src).tagClass('-hover', false);
                ood.use(src).tagClass('-active', false);

                if (RAD.Designer) {
                    ood.each(RAD.Designer.getAllInstance(), function (page) {
                        if (page && !page.destroyed) {
                            page._clearSelect();
                            if (page.resizer)
                                page._setSelected([], true);
                        }
                    });
                }
                return false;
            }

        },

        _topmenu_onitemselected: function (profile, item, e, src, type) {
            var ns = this, uictrl = profile.boxing();
            this._menubar_onclick(null, null, item, src, false);
        },

        _treebarprj_fold: function (profile) {
            var tree = profile.boxing();
            if (!tree.getUIValue())
                this._updateFileToolbar(null, 'prj');
        }
        ,

        _treebarprj_onitemselected: function (profile, item, e, src, type) {
            this._updateFileToolbar(item, 'prj');
        }
        ,
        _treebarprj_onclick: function (profile, item) {
            if (item.sub)
                profile.boxing().toggleNode(item.id, true);
        }
        ,
        _ontvcmd: function (profile, item, cmdkey) {
            var w = ood.get(SPA.curProjectConfig, ['$DevEnv', 'designViewConf', 'width']) || 1280,
                h = ood.get(SPA.curProjectConfig, ['$DevEnv', 'designViewConf', 'height']) || 1024,
                touch = ood.get(SPA.curProjectConfig, ['$DevEnv', 'designViewConf', 'touchDevice']) || 0;


            CONF.debugApp("/debug/" + SPA.curProjectName + "/", ood.getClassName(item.id), {
                rand: ood.rand(),
                touch: touch,
                width: w,
                height: h,
                cls: ood.getClassName(item.id),
                theme: ood.getTheme(),
                lang: ood.getLang()
            }, true);
        }
        ,
        _treebarprj_onitemselected2: function (profile, item, e, src, type) {
            this._updateFileToolbar(item, 'cls');
        }
        ,
        _updateFileToolbar: function (item, type) {
            var ns = this, opt = {hidden: !item || !!item.sub},
                tool = ns.projecttool;
            tool.updateItem('rename', opt);
            tool.updateItem('copy2', opt);
            tool.updateItem('editastext', opt);
        }
        ,
        _toolbar_onclick: function (profile, titem, group, e, src) {
            var ns = this;
            if (titem.sub && titem.sub.length > 0) {
                var popMenu = new ood.UI.PopMenu({
                        items: titem.sub
                    }, {
                        onMenuSelected: function (p, item) {
                            ns._toolbar_onclick(p, item, group, src);
                        }
                    })
                ;
                popMenu.setCustomStyle({
                    "ICON": "font-size:1.2em;",
                    "ITEM": "background-color:#F6F6F6;"

                })
                popMenu.pop(src);

            } else if (ood.str.startWith(titem.id, "ood.") && titem.draggable) {
                this._addComponent(titem);
                return;
            } else {
                this._menubar_onclick(null, null, titem, src, false);
            }
        }
        ,
        buildFileItems: function (path, obj, filter, isoodpage) {
            obj = obj.files || obj;
            //root
            var ns = this,
                names = path.split('/'),
                name = names[names.length - 1],
                imagePos, imageClass, className
            hash = {
                '*': {
                    id: path,
                    name: name,
                    caption: name,
                    iconColor: "#1f8d9b",
                    imageClass: 'ri-building-line',
                    value: path,
                    sub: [],
                    initFold: false
                }
            };
            ood.arr.each(obj, function (o) {
                // filter
                if (filter && filter(o) === false) return;

                if (!o.type)
                    imagePos = undefined;
                else {
                    var a = o.name.split('.');
                    a = a.length == 1 ? "" : (a[a.length - 1].toLowerCase());
                    //  imageClass = CONF.getImageTag(a, isoodpage);
                }

                hash[o.id] = {
                    id: o.location,
                    name: o.name,
                    group: o.group,
                    autoItemColor: o.autoItemColor,
                    autoFontColor: o.autoFontColor,
                    autoIconColor: o.autoIconColor,
                    iconColor: o.iconColor,
                    fontColor: o.fontColor,
                    itemColor: o.itemColor,
                    caption: isoodpage ? ns._getpagename(o.name) : o.name,
                    imageClass: o.imageClass,
                    className: o.className,
                    value: o.location,
                    initFold: o.initFold,
                    sub: o.sub
                };
                if (!o.type) {
                    hash[o.id].sub = true;
                    hash[o.id].tips = "$(RAD.designer.Click to expand) " + o.name;
                } else {
                    hash[o.id].tips = "$(RAD.designer.Double click to open) " + o.name;
                }
                if (isoodpage && o.type)
                    hash[o.id].tagCmds = [{
                        id: "preview",
                        tips: "$RAD.JSEditor.Preview",
                        type: "text",
                        sub: true,
                        caption: '',
                        itemClass: "ri-eye-line"
                    }];
                if (!o.pid) {
                    o.pid = "*";
                }
                hash[o.pid].sub.push(hash[o.id]);
            });

            return hash['*'];
        }
        ,
        _resetPrjEnv: function () {
            var ns = this,
                dftHash = {
                    'background-image': 'url(' + ood.getPath('/RAD/img/designer/', 'bg.gif') + ')',
                    'background-position': 'left top',
                    'background-repeat': 'repeat',
                    "background-color": '',
                    "background-attachment": ''
                };
            //Page Appearance
            ns.tabsMain.setSandboxTheme("");
            ood.CSS.addStyleSheet(ood.UI.buildCSSText({
                '.ood-designer-root .ood-designer-canvas': dftHash
            }), 'ood.UI.design', null, true);

            // Font Icons CDN
            ood('head').querySelectorAll('link[id^="ood_app_fscdn-"]').remove(true);

            //Element Style
            ood.CSS.setStyleRules(".ood-desinger-canvas .ood-custom", null, true);

            //mobile frame
            try {
                ood.each(RAD.Designer.getAllInstance(), function (page) {
                    if (page.canvas)
                        page.setMobileFrame(false);
                });
            } catch (e) {

            }
            //Default Prop
            ood.UI.__resetDftProp_in_Desinger = null;
            ood.arr.each(ood.Class._all, function (cls) {
                if (/^ood.UI\./.test(cls)) {
                    if (cls = ood.get(window, cls.split('.'))) {
                        cls.__resetDftProp_in_Desinger = null;
                    }
                }
            });
        },


        refreshProjectConfig: function (setting, callback) {
            var ns = this,
                path = "oodconf.js",
                txt, json, arr, reg,
                dftHash = {
                    'background-image': 'url(' + ood.getPath('/RAD/img/designer/', 'bg.gif') + ')',
                    'background-position': 'left top',
                    'background-repeat': 'repeat',
                    "background-color": '',
                    "background-attachment": ''
                },
                cover = function (scr) {
                    scr = ood.replace(scr, [
                        [/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/, '$0'], //regexp
                        [/"(\\.|[^"\\])*"/, '$0'], //""
                        [/'(\\.|[^'\\])*'/, '$0'], //''
                        [/\/\*[^*]*\*+([^\/][^*]*\*+)*\//, '']
                    ]);
                    // Page Appearance
                    arr = scr.split(/\s*\/\/ \[\[Page Appearance\s*\n|\n\s*\/\/ \]\]Page Appearance\s*/);
                    if (arr.length == 3) {
                        txt = arr[1];
                        json = null;

                        try {
                            reg = /^\s*ood.ini\.\$PageAppearance\s*\=\s*/;
                            if (reg.test(txt)) {
                                txt = ood.replace(txt, [
                                    [/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/, '$0'],
                                    [/"(\\.|[^"\\])*"/, '$0'],
                                    [/'(\\.|[^'\\])*'/, '$0'],
                                    [reg, ''],
                                    [/;\s*$/, ''],
                                    [/\/\/[^\n]*/, '']
                                ]);
                                json = ood.unserialize(txt);
                            }
                        } catch (e) {
                            ood.alert(e + "<br\><br\>File => " + path + "<br\><br\>at : ood.ini.$PageAppearance = ...");
                            return;
                        }
                        if (typeof json === "object" && json !== null) {
                            ns.curProjectConfig.$PageAppearance = json;

                            if (json.theme) {
                                ns.tabsMain.setSandboxTheme(json.theme, true, '[class~="ood-designer-inner-control"]');
                            }
                            if (json.background && ood.isHash(json.background)) {
                                var hash = ood.clone(dftHash);
                                ood.each(json.background, function (o, i) {
                                    hash[i] = ood.adjustRes(o);
                                });

                                ood.CSS.addStyleSheet(ood.UI.buildCSSText({
                                    '.ood-designer-root .ood-designer-canvas': hash
                                }), 'ood.UI.design', null, true);
                            }
                        }
                    }


                    // Font Icons CDN
                    arr = scr.split(/\s*\/\/ \[\[Font Icons CDN\s*\n|\n\s*\/\/ \]\]Font Icons CDN\s*/);
                    if (arr.length == 3) {
                        txt = arr[1];
                        json = null;

                        try {
                            reg = /^\s*ood.ini\.\$FontIconsCDN\s*\=\s*/;
                            if (reg.test(txt)) {
                                txt = ood.replace(txt, [
                                    [/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/, '$0'],
                                    [/"(\\.|[^"\\])*"/, '$0'],
                                    [/'(\\.|[^'\\])*'/, '$0'],
                                    [reg, ''],
                                    [/;\s*$/, ''],
                                    [/\/\/[^\n]*/, '']
                                ]);
                                json = ood.unserialize(txt);
                            }
                        } catch (e) {
                            ood.alert(e + "<br\><br\>File => " + path + "<br\><br\>at : ood.ini.$FontIconsCDN = ...");
                            return;
                        }
                        if (typeof json === "object" && json !== null) {
                            ns.curProjectConfig.$FontIconsCDN = json;
                            // for CDN font icons
                            ood.each(json, function (o, i) {
                                if (o.href) {
                                    var attr = {crossorigin: 'anonymous'};
                                    ood.merge(attr, o, function (v, j) {
                                        return j !== 'href'
                                    });
                                    ood.CSS.includeLink(ood.adjustRes(o.href), 'ood_app_fscdn-' + i, false, attr);
                                }
                            });
                        }
                    }

                    // Element Style
                    arr = scr.split(/\s*\/\/ \[\[Element Style\s*\n|\n\s*\/\/ \]\]Element Style\s*/);
                    if (arr.length == 3) {
                        txt = arr[1];
                        json = null;

                        try {
                            reg = /^\s*ood.ini\.\$ElementStyle\s*\=\s*/;
                            if (reg.test(txt)) {
                                txt = ood.replace(txt, [
                                    [/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/, '$0'],
                                    [/"(\\.|[^"\\])*"/, '$0'],
                                    [/'(\\.|[^'\\])*'/, '$0'],
                                    [reg, ''],
                                    [/;\s*$/, ''],
                                    [/\/\/[^\n]*/, '']
                                ]);
                                json = ood.unserialize(txt);
                            }
                        } catch (e) {
                            ood.alert(e + "<br\><br\>File => " + path + "<br\><br\>at : ood.ini.$ElementStyle = ...");
                            return;
                        }
                        if (typeof json === "object" && json !== null) {
                            ns.curProjectConfig.$ElementStyle = json;
                            ood.CSS.setStyleRules(".ood-desinger-canvas .ood-custom", json, true);
                        }
                    }

                    // Default Prop
                    arr = scr.split(/\s*\/\/ \[\[Default Prop\s*\n|\n\s*\/\/ \]\]Default Prop\s*/);
                    if (arr.length == 3) {
                        txt = arr[1];
                        json = null;

                        try {
                            reg = /^\s*ood.ini\.\$DefaultProp\s*\=\s*/;
                            if (reg.test(txt)) {
                                txt = ood.replace(txt, [
                                    [/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/, '$0'],
                                    [/"(\\.|[^"\\])*"/, '$0'],
                                    [/'(\\.|[^'\\])*'/, '$0'],
                                    [reg, ''],
                                    [/;\s*$/, ''],
                                    [/\/\/[^\n]*/, '']
                                ]);
                                json = ood.unserialize(txt);
                            }
                        } catch (e) {
                            ood.alert(e + "<br\><br\>File => " + path + "<br\><br\>at : ood.ini.$DefaultProp = ...");
                            return;
                        }
                        if (typeof json === "object" && json !== null) {
                            ns.curProjectConfig.$DefaultProp = json;

                            var allp = {}, ctl;
                            ood.each(json, function (v, k) {
                                if (/^ood.UI\./.test(k) && ood.isHash(v) && (ctl = ood.get(window, k.split('.')))) {
                                    ctl.__resetDftProp_in_Desinger = v;
                                } else {
                                    allp[k] = v;
                                }
                            });
                            if (!ood.isEmpty(allp)) {
                                ood.UI.__resetDftProp_in_Desinger = allp;
                            }
                        }
                    }

                    // Develop Env Setting
                    arr = scr.split(/\s*\/\/ \[\[Develop Env Setting\s*\n|\n\s*\/\/ \]\]Develop Env Setting\s*/);
                    if (arr.length == 3) {
                        txt = arr[1];
                        json = null;

                        try {
                            reg = /^\s*ood.ini\.\$DevEnv\s*\=\s*/;
                            if (reg.test(txt)) {
                                txt = ood.replace(txt, [
                                    [/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/, '$0'],
                                    [/"(\\.|[^"\\])*"/, '$0'],
                                    [/'(\\.|[^'\\])*'/, '$0'],
                                    [reg, ''],
                                    [/;\s*$/, ''],
                                    [/\/\/[^\n]*/, '']
                                ]);
                                json = ood.unserialize(txt);
                            }
                        } catch (e) {
                            ood.alert(e + "<br\><br\>File => " + path + "<br\><br\>at : ood.ini.$DevEnv = ...");
                            return;
                        }
                        // cover
                        if (typeof json === "object" && json !== null) {
                            ns.curProjectConfig.$DevEnv = json;

                            //view size
                            var size = {}, mf, su;
                            if ((size.width = ood.get(json, ['designViewConf', 'width'])) &&
                                (size.height = ood.get(json, ['designViewConf', 'height']))
                            ) {
                                ood.each(RAD.Designer.getAllInstance(), function (page) {
                                    if (page.canvas) {
                                        page.setViewSize(size);
                                        // for themes: classic webflat
                                        if (page._cls) {
                                            ood.asyRun(function () {
                                                if (page._cls) page.refreshView(page._cls);
                                            }, 100);
                                        }
                                    }
                                });
                            }

                            if (mf = ood.get(json, ['designViewConf', 'touchDevice'])) {
                                ood.each(RAD.Designer.getAllInstance(), function (page) {
                                    if (page.canvas)
                                        page.setMobileFrame(mf);
                                });
                            }
                            if (su = ood.get(json, ['SpaceUnit'])) {
                                ood.each(RAD.Designer.getAllInstance(), function (page) {
                                    if (page.canvas) {
                                        // for themes: classic webflat
                                        if (page._cls) {
                                            ood.asyRun(function () {
                                                if (page._cls) page.refreshView(page._cls);
                                            }, 100);
                                        }
                                    }
                                });
                            }
                        }
                    }

                    // Global Functions
                    arr = scr.split(/\s*\/\/ \[\[Global Functions\s*\n|\n\s*\/\/ \]\]Global Functions\s*/);
                    if (arr.length == 3) {
                        txt = arr[1];
                        json = null;

                        try {
                            reg = /^\s*ood.\$cache\.functions\s*\=\s*/;
                            if (reg.test(txt)) {
                                txt = ood.replace(txt, [
                                    [/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/, '$0'],
                                    [/"(\\.|[^"\\])*"/, '$0'],
                                    [/'(\\.|[^'\\])*'/, '$0'],
                                    [reg, ''],
                                    [/;\s*$/, ''],
                                    [/\/\/[^\n]*/, '']
                                ]);
                                json = ood.unserialize(txt);
                            }
                        } catch (e) {
                            ood.alert(e + "<br\><br\>File => " + path + "<br\><br\>at : ood.$cache.functions = ...");
                            return;
                        }

                        // cover
                        if (typeof json === "object" && json !== null) {
                            ns.curProjectConfig.$GlobalFunctions = json;
                        }
                    }

                    // Global Data
                    arr = scr.split(/\s*\/\/ \[\[Global Data\s*\n|\n\s*\/\/ \]\]Global Data\s*/);
                    if (arr.length == 3) {
                        txt = arr[1];
                        json = null;

                        try {
                            reg = /^\s*ood.\$cache\.data\s*\=\s*/;
                            if (reg.test(txt)) {
                                txt = ood.replace(txt, [
                                    [/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/, '$0'],
                                    [/"(\\.|[^"\\])*"/, '$0'],
                                    [/'(\\.|[^'\\])*'/, '$0'],
                                    [reg, ''],
                                    [/;\s*$/, ''],
                                    [/\/\/[^\n]*/, '']
                                ]);
                                json = ood.unserialize(txt);
                            }
                        } catch (e) {
                            ood.alert(e + "<br\><br\>File => " + path + "<br\><br\>at : ood.$cache.data = ...");
                            return;
                        }

                        // cover
                        if (typeof json === "object" && json !== null) {
                            ns.curProjectConfig.$GlobalData = json;
                        }
                    }


                    // Constant Data
                    arr = scr.split(/\s*\/\/ \[\[Constant Data\s*\n|\n\s*\/\/ \]\]Constant Data\s*/);
                    if (arr.length == 3) {
                        txt = arr[1];
                        json = null;

                        try {
                            reg = /^\s*ood.constant\s*\=\s*/;
                            if (reg.test(txt)) {
                                txt = ood.replace(txt, [
                                    [/\/(\\[\/\\]|[^*\/])(\\.|[^\/\n\\])*\/[gim]*/, '$0'],
                                    [/"(\\.|[^"\\])*"/, '$0'],
                                    [/'(\\.|[^'\\])*'/, '$0'],
                                    [reg, ''],
                                    [/;\s*$/, ''],
                                    [/\/\/[^\n]*/, '']
                                ]);
                                json = ood.unserialize(txt);
                            }
                        } catch (e) {
                            ood.alert(e + "<br\><br\>File => " + path + "<br\><br\>at : ood.constant = ...");
                            return;
                        }

                        // cover
                        if (typeof json === "object" && json !== null) {
                            ns.curProjectConfig.$ConstantData = json;
                        }
                    }
                };

            // cached in memory
            ns.curProjectConfig = {};

            if (ood.isSet(setting)) {
                ns._resetPrjEnv();
                cover(setting || "");
                ood.tryF(callback);
            } else {
                // get file sync

                ood.Ajax(CONF.getProjectConfigService, {projectName: SPA.curProjectName}, function (scr) {
                    ns._resetPrjEnv();
                    cover(scr || "");
                    ood.tryF(callback);
                    //
                }, function (e) {

                    ns._resetPrjEnv();
                    ood.tryF(callback);
                    ood.alert("Missing file : '" + path + "'.");
                }, null, {rspType: "text", method: 'POST'}).start();
            }
            return ns.curProjectConfig;
        }
        ,
        _openproject: function (pm, obj, nomainjs, currentRootCls) {
            var ns = this, clsFiles = obj.files;
            pm = pm.replace(/\\/g, "/");
            window["/"] = CONF.getPrjPath(pm, true) + "/";
            window["/"] = CONF.adjustProtocol(window["/"]);
            ns.curProjectName = pm.substr(pm.lastIndexOf("/") + 1, pm.length);
            var projectName = pm, simProjectName = projectName;
            if (projectName.indexOf("VVVERSION") > -1) {
                simProjectName = projectName.substring(0, projectName.indexOf("VVVERSION"));
                projectName = projectName.replace("VVVERSION", "(V") + ")";
            }
            ns.currentRootCls = currentRootCls || simProjectName;
            //ns.currentRootCls = currentRootCls || "App";
            ns.curProjectPath = pm;

            if (ood.str.endWith(pm, "/")) {
                pm = pm.substr(0, pm.length - 1);
            }

            ood.arr.each(clsFiles, function (item) {
                delete item.iconColor;
                item.autoIconColor = true;
            });

            var root = ns.buildFileItems(projectName, clsFiles),
                tb = ns.treebarPrj,
                tabs = ns.tabsMain;
            tb.setItems(root.sub);
            ns.tabsMain.setDisabled(false);

            var hash = CONF.getStatus(),
                prjs = hash.projects,
                index = ood.arr.subIndexOf(prjs || [], 'id', ns.curProjectPath),
                files = index != -1 ? prjs[index].files : [],
                file = index != -1 ? prjs[index].file : null;
            if (!files) files = [];
            if (!file && files[0]) file = files[0];
            if (!file && !nomainjs) {
                file = obj.index ? obj.index + '.cls' : ns.currentRootCls + "/index.cls";
                if (ood.arr.subIndexOf(files, file) == -1) {
                    files.push(file);
                }
            }

            ns.refreshProjectConfig(null, function () {
                // add them to tabs
                if (files && files.length) {
                    ood.arr.each(files, function (o, i) {
                        i = o.substr(o.lastIndexOf("/") + 1, o.length);
                        var item = {
                            id: o,
                            value: o,
                            name: i,
                            className: o.replaceAll('/', '.'),
                            caption: ns._getpagename(i)
                        };

                        // open the 'file'
                        if (item.caption.indexOf('VVVERSION') == -1) {
                            ns._openfile(item, null, o != file, true);
                        }
                    });


                }
                // select one to expand
                if (file && tb) {
                    tb.setUIValue(null);
                    tb.setUIValue(file, true);
                }
            });

            if (ns.projecttool)
                ns.projecttool.setDock('none').setDisplay('').setDock('top');


            // add project path here
            document.title = document.title.replace(/\s*\[.*\]\s*$/, '') + " [" + pm + "]";
        }
        ,

        _checkEvent: function (events) {
            var ns = this;

            var subevents = {};
            ood.each(events, function (event, key, events) {

                var eventMap = events[key];
                if (eventMap) {
                    if (ood.isArr(eventMap)) {
                        aAction = [];
                        ood.each(eventMap, function (action) {
                            if (typeof(action) == "string") {
                                aAction.push({script: action, desc: '函数'});
                            } else if (ood.isHash(action)) {
                                aAction.push(action);
                            }
                        });
                        subevents[key] = {actions: aAction};
                    } else if (typeof(eventMap) == "string") {
                        subevents[key] = {actions: [{script: eventMap, desc: '函数'}]}
                    } else if (!eventMap.actions) {
                        delete  events[key];
                        var neweventMap = {actions: eventMap};
                        subevents[key] = neweventMap;
                    } else {
                        var subAction = [];
                        var actions = events[key].actions;
                        if (typeof(actions) == "string") {
                            subAction.push({script: actions.toString(), desc: '函数'})
                        } else {
                            ood.each(actions, function (action, k) {
                                if (!ood.isHash(action)) {
                                    subAction.push({script: action.toString(), desc: '函数'});
                                } else {
                                    var args = [];
                                    ood.each(action.args, function (arg, i) {
                                            if (typeof(arg) == "function") {
                                                args.push({script: arg.toString(), desc: '函数'});
                                            } else {
                                                args.push(arg);
                                            }

                                        }
                                    );
                                    if (!action.type) {
                                        action.type = 'page';
                                    }
                                    action.args = args;
                                    subAction.push(action);
                                }

                            });
                            subevents[key] = events[key];
                            subevents[key].actions = subAction;
                        }

                    }
                }
            });
            return subevents;
        },

        _getDesigner: function () {
            var tb = this.tabsMain,
                id = tb.getUIValue(),
                o = tb.getItemByItemId(id);
            return o.$obj._designer;
        }

        ,
        _saveFile: function (o, collections) {
            var ns = this, tb = this.tabsMain;
            if (o._dirty) {
                var newText = o.$obj.getValue(), isModule, cur, shouldbe;
                if (false === newText)
                    return false;

                if (ood.str.startWith(o.id, SPA.curProjectPath + "/" + ns.currentRootCls + "/") || (isModule = ood.str.startWith(o.id, SPA.curProjectPath + "/Module/js/"))) {
                    cur = RAD.ClassTool.getClassName(newText);
                    var currpath = o.id;
                    if (currpath.indexOf(SPA.curProjectPath) > -1) {
                        currpath = currpath.replace(SPA.curProjectPath + '/', '');
                    }
                    shouldbe = ood.getClassName(currpath);
                    if (cur != shouldbe) {
                        ood.pop(ood.getRes("RAD.designer.The class name in '$0' should be '$1', but it's '$2'", o.id, shouldbe, cur));
                        shouldbe = cur = null;
                    }
                }

                var paras = {
                    projectName: SPA.curProjectName,
                    hashCode: ood.id(),
                    curProjectPath: SPA.curProjectPath,
                    path: o.id,
                    fileType: 'EUFile',
                    content: newText,
                    jscontent: newText
                };
                var designer = o.$obj._designer;

                if (designer && designer.getWidgets() && designer.getWidgets().length > 0) {
                    var code = designer.getJSCode(designer.getWidgets());
                    var com = new ood.Module();
                    com.iniComponents = new Function([], code);
                    var hash = {}, t;
                    ood.each(designer.getNames(), function (prf) {
                        var parentName = prf.parent ? prf.parent.alias : 'this';
                        if (!prf.moduleClass) {
                            t = hash[prf.alias] = prf.serialize(false, false, false);
                            if (hash[prf.alias].events) {
                                hash[prf.alias].events = ns._checkEvent(hash[prf.alias].events);
                            }
                            hash[prf.alias].host = parentName;
                            if (prf.childrenId) {
                                hash[prf.alias].target = prf.childrenId;
                            }
                        } else {
                            var module = prf.host;
                            module.properties.className = prf.moduleClass;
                            if (!hash[module.alias]) {
                                t = hash[module.alias] = module.serialize(false, false, false);
                                if (hash[module.alias].events) {
                                    hash[module.alias].events = ns._checkEvent(hash[module.alias].events);
                                }
                                hash[module.alias].host = parentName;
                                if (prf.childrenId) {
                                    hash[module.alias].target = prf.childrenId;
                                }

                                hash[module.alias].className = prf.moduleClass;
                                hash[module.alias].key = 'ood.Module'
                            }


                        }

                        //delete t['ood.Module'];
                    });


                    //删除错误定义
                    if (designer._cls.Instance.functions) {
                        ood.each(designer._cls.Instance.functions, function (modulefunction) {
                            if (modulefunction.actions) {
                                var iactions = [];
                                ood.each(modulefunction.actions, function (action) {
                                    if (ood.isFun(action)) {
                                        iactions.push(
                                            {script: action.toString(), desc: '函数'}
                                        )
                                    } else if (action && ood.isObj(action)) {
                                        if (!action.type) {
                                            delete action.type;
                                        }
                                        iactions.push(action)
                                    }
                                    ;
                                });
                                modulefunction.actions = iactions;
                            }
                        })

                    }
                    ;

                    //初始化事件

                    designer._cls.Instance.events = ns._checkEvent(designer._cls.Instance.events);
                    var modulefunctions = {};
                    ood.each(designer._cls.Instance, function (action, key) {
                        var syskeys = ['iniComponents', 'initialize', 'customAppend'];
                        if (typeof(action) == 'function') {
                            if (ood.arr.indexOf(syskeys, key) == -1) {
                                modulefunctions[key] = action.toString();
                            }
                        }
                    });

                    var moduleVar = {};

                    ood.each(designer._cls.Instance, function (action, key) {
                        var syskeys = ['Dependencies', 'Required', 'properties', 'events', 'functions'];
                        if (typeof(action) != 'function') {
                            if (ood.arr.indexOf(syskeys, key) == -1) {
                                moduleVar[key] = ood.serialize(action);
                                ;
                            }
                        }
                    });

                    //初始化
                    var customAppend = designer._cls.Instance.customAppend, customAppendStr;
                    if (customAppend && typeof(customAppend) == 'function') {
                        customAppendStr = customAppend.toString();
                    }


                    var deffunctions = {};
                    if (!designer._cls.Instance.functions && ood.isHash(designer._cls.Instance.functions)) {
                        deffunctions = designer._cls.Instance.functions;
                    }

                    // var staticConfig = {
                    //     designViewConf: designer.$curViewSize || {},
                    //     viewStyles: designer._cls.Static?.viewStyles || {}
                    // };


                    var oodcode = {
                            components: hash,
                            'Static': designer._cls.Static || {},
                            events: ns._checkEvent(designer._cls.Instance.events),
                            customFunctions: modulefunctions,
                            moduleVar: moduleVar,
                            customAppend: customAppendStr,
                            dependencies:
                            designer._cls.Instance.dependencies || [],
                            properties:
                            designer._cls.Instance.properties || {},
                            required:
                            designer._cls.Instance.Required || []
                        }
                    ;


                    var code = ood.Coder.formatText(ood.stringify(oodcode), 'js');
                    paras.className = designer._className;
                    paras.content = code
                    paras.fileType = 'EUClass';
                    com.destroy();
                }


                if (CONF.grid_showPropBinder) {
                    var init = ood.get(RAD.ClassTool.getClassStruct(newText), ["sub", "Instance", "sub", "iniComponents"]);
                    if (init) {
                        var module = new ood.Module();
                        module.iniComponents = ood.unserialize(init.code);
                        paras.propKeys = module.getPropBinderKeys();
                    }
                }
                ;
                var onSuccess = function (txt) {
                    var obj = txt;
                    if (obj && !obj.error && obj.data && obj.requestStatus != -1) {
                        o.$obj.setValue(newText);
                        tb.markItemCaption(o.id, false, true);
                        if (isModule && shouldbe) {
                            var m = ood.SC(shouldbe);
                            if (m) {
                                // refresh Class first
                                m.refresh(newText);
                                // refresh  instances
                                var ins = m.getAllInstance();
                                if (!ood.isEmpty(ins)) {
                                    ood.each(ins, function (mi) {
                                        mi.refresh();
                                    });
                                }
                            }
                        }

                        if (o.id == SPA.curProjectPath + "/oodconf.js") {
                            ns.refreshProjectConfig(newText);
                        }
                        ood.message('  save success!   ');
                    } else
                        ood.message(ood.get(obj, ['error', 'errdes']) || obj || 'no response!');
                };
                var onFail = function (txt) {
                    ood.message(txt);
                };
                collections.push({id: o.id, paras: paras, onSuccess: onSuccess, onFail: onFail});

            }
            return collections;
        }

        ,
        _ann_onclick: function () {
            ood.ModuleFactory.getModule('about', function () {
                this.dialog.show(null, true);
            });
        },

        _getSelected: function () {
            var sel = this._getDesigner().tempSelected,
                out;
            if (sel && sel.length) {
                out = [];
                ood.arr.each(sel, function (o) {
                    out.push(ood.getObject(o));
                });
            }
            return out;
        },

        _updateComponent: function (item) {
            var designer = this._getDesigner(), currNode = designer.getByAlias(item.alias, true), ns = this;
            currNode = currNode || designer.canvas;
            if (!currNode.removeChildren) {
                currNode.boxing().removeChildren(true, true, true);
            } else {
                currNode.removeChildren(true, true, true);
            }

            if (item.children) {
                ood.each(item.children, function (o) {
                    ns._addComponent(o);
                })
            }

            var dirty = designer._dirty;
            designer.refreshView(designer.getJSCode(designer.getWidgets(true)), true);
            if (dirty) designer.markDirty();
        }

        ,
        _addComponent: function (item, parentId) {
            var designer = this._getDesigner();
            var selectNode = designer.getByCacheId(this.tempSelected);
            var parent;
            if (selectNode) {
                selectNode = ood.getObject(designer.tempSelected[0]);
                if (selectNode) {
                    selectNode = selectNode.boxing();
                } else if (parentId) {
                    selectNodes = ood.getObjectByAlias(parentId);
                    if (selectNodes && selectNodes.length > 1) {
                        selectNode = selectNodes[0].boxing();
                    }
                }
            } else {
                selectNode = selectNode.boxing();
            }
            parent = selectNode || designer.canvas;

            var obj = item, children = item.children || item.sub;
            if (!children || children.length == 0) {
                obj = {children: [item]}
            }

            if (ood.str.startWith(item.key, 'ood.svg.')) {
                var components = ood.addChild(obj, parent, designer.$host, designer.$host);
                var redo = function () {
                        var components = ood.addChild(obj, parent, designer.$host, designer.$host);
                        var go = components[0].get(0);
                        designer._designable(go);
                        designer.selectWidget([go.$xid]);
                    },
                    undo = function () {
                        var ins = designer.getByAlias(item.alias);
                        ins.destroy(true, true);
                    }

                designer.markDirty(undo, redo, "add commponents");


            } else if (ood.str.startWith(item.key, 'ood.UI.')) {
                var components = ood.addChild(obj, parent, designer.$host, designer.$host);
                var go = components[0].get(0), xid = go.$xid;
                designer._designable(go);
                designer.selectWidget([xid]);

                var redo = function () {
                        var components = ood.addChild(obj, parent, designer.$host, designer.$host);
                        var go = components[0].get(0);
                        designer._designable(go);
                        designer.selectWidget([go.$xid]);
                    },
                    undo = function () {
                        var ins = designer.getByAlias(item.alias);
                        ins.destroy(true, true);
                    }

                designer.markDirty(undo, redo, "add commponents");


            } else {
                var citem = item;
                var target = ood.create(citem.key)
                    .setHost(designer.$host, citem.alias)
                    .setAlias(citem.alias)
                    .setEvents(citem.events)
                    .setProperties(citem.properties);
                if (designer.$host) {
                    designer.$host[citem.alias] = target
                }

                designer.iconlist.insertItems([{
                    'id': target.get(0).$xid,
                    'imgWidth': '16',
                    'imgHeight': '16',
                    'tips': designer._bldTips(target, designer.$moduleInnerMode ? "" : CONF.enable_codeEdtor ? ("$(RAD.designer.Dblclick to edit the code)") : "")
                    , 'imgStyle': item.imgStyle,
                    'imageClass': item.imageClass
                }]);
                designer.iconlist.setUIValue(target.get(0).$xid);
                if (!children || children.length == 0) {
                    obj = {children: [item]}
                }
                var go = target.get(0), xid = go.$xid;
                designer._designable(go);
                designer.selectWidget([go.$xid]);
                ood.addChild(obj, parent, designer.$host, designer.$host);
                var redo = function () {
                        var target = ood.create(citem.key)
                            .setHost(designer.$host, citem.alias)
                            .setAlias(citem.alias)
                            .setEvents(citem.events)
                            .setProperties(citem.properties);
                        if (designer.$host) {
                            designer.$host[citem.alias] = target
                        }
                        designer.iconlist.insertItems([{
                            'id': xid,
                            'imgWidth': '16',
                            'imgHeight': '16',
                            'tips': designer._bldTips(target, designer.$moduleInnerMode ? "" : CONF.enable_codeEdtor ? ("$(RAD.designer.Dblclick to edit the code)") : "")
                            , 'imgStyle': item.imgStyle,
                            'imageClass': item.imageClass
                        }]);
                        designer.iconlist.setUIValue(xid);
                        if (!children || children.length == 0) {
                            obj = {children: [item]}
                        }
                        designer._designable(go);
                        designer.selectWidget([xid]);
                    },
                    undo = function () {
                        designer.iconlist.removeItems([xid]);
                        var ins = designer.getByAlias(citem.alias);
                        ins.destroy(true, true);
                    }
                designer.markDirty(undo, redo, "add commponents");
            }
        },
        _loadPluginsMenu: function (server) {
            var ns = this;
            var callback = function (data) {
                var menus = [];
                var allactions = [];

                //初始化API
                if (data && data.apis) {
                    ood.each(data.apis, function (citem) {
                        ood.create(citem.key)
                            .setAlias(citem.alias)
                            .setHost(ns, citem.alias)
                            .setEvents(ood.checkEvents(citem.events))
                            .setProperties(citem.properties);
                    });
                }
                var events = ns._checkEvent(SPA.menubar.getEvents())

                ood.each(data.events, function (event, key) {
                    var toolbarAction = events[key].actions;
                    ood.each(event.actions, function (action) {
                        toolbarAction.push(action);
                    })

                })
                SPA.toolbar.setEvents(ood.checkEvents(events));

                // scope, hash[i], i, hash

                //SPA.toolbar.setEvents(data.events);

                if (data.properties && data.properties.items && data.properties.items.length > 0) {
                    menus.push(data.properties.items[0]);
                }
                SPA.toolbar.setItems(CONF.chaneWidget(data.properties.items))
            };


            var params = server.params;
            ood.Ajax(server.baseUrl, params, function (txt) {
                var obj = txt;
                if (obj && !obj.error) {
                    callback(obj.data);
                }
            }, null, null, null, {method: 'POST', asy: true}).start();


        },

        _loadBarMenu: function (server) {
            var ns = this;
            var callback = function (data) {
                var menus = [];

                if (data && data.apis) {
                    ood.each(data.apis, function (citem) {
                        ood.create(citem.key)
                            .setAlias(citem.alias)
                            .setHost(ns, citem.alias)
                            .setEvents(ood.checkEvents(citem.events))
                            .setProperties(citem.properties);
                    });
                }

                var datas = data[0].sub || data.sub || data;
                SPA.toolbar.setItems(CONF.chaneWidget(datas))
            }

            var params = server.params;
            ood.Ajax(server.baseUrl, params, function (txt) {
                var obj = txt;
                if (obj && !obj.error) {
                    callback(obj.data);
                }
            }, null, null, null, {method: 'POST', asy: true}).start();


        }

        ,
        _menubar_onMenuBtnClick: function (profile, popPro, item, src) {
            var ns = this;
            ns.currSrc = src;
            if (item.toolbar && item.toolbar.length > 0) {
                this.toolbar.setItems(item.toolbar)
            }
            if (item.server && item.server.baseUrl) {
                this._loadBarMenu(item.server, src);
            } else if (item.plugins && item.plugins.baseUrl) {
                this._loadPluginsMenu(item.plugins, src);
            } else {
                this._menubar_onclick(null, null, item, src, false);
            }

            var item = ns.mainLayout.getSelectedItem();

            if (item.id != 'oodmain') {
                ns.mainLayout.selectItem('oodmain')
            } else {

            }

        }
        ,
        _menubar_onclick: function (profile, popPro, item, src, newinstance) {
            var ns = this;
            if (!ns._prjserial) ns._prjserial = 1;

            if (ood.str && ood.str.startWith(item.id, "ood.") && item.draggable) {
                this._addComponent(item);
                return;
            }
            if (item.root) {
                if (!ns.ViewMenuBar[item.id]) {
                    ood.Ajax("/radplugins/getActions", {viewBarId: item.id}, function (txt) {
                        var obj = txt;
                        if (item.apis) {
                            ood.each(item.apis, function (item) {
                                ood.create(item.key)
                                    .setAlias(item.alias)
                                    .setHost(ns, item.alias)
                                    .setEvents(ood.checkEvents(item.events))
                                    .setProperties(item.properties);
                            });

                        }
                        ns.ViewMenuBar[item.id] = ood.create(item.key)
                            .setAlias(item.alias)
                            .setHost(ns, item.alias)
                            .setEvents(ood.checkEvents(item.events))
                            .setProperties(item.properties);
                        ns.ViewMenuBar[item.id].pop(src);
                    }, function (obj) {
                        ood.message(ood.get(obj, ['error', 'errdes']) || obj || 'no response!');
                    }, null, null, {method: 'post'}).start();

                } else {
                    ns.ViewMenuBar[item.id].pop(src);
                }
            }


            if (item.menuType || item.root || item.euClassName) {
                var tagVar = item.tagVar;
                ood.each(getSPA().getSelected(), function (node) {
                    selectAlias.push(node.alias);
                });
                tagVar.currCom = selectAlias;
                ood.ModuleFactory.getModule(item.euClassName, function () {
                    tagVar.className =SPA.getCurrentClassName();
                    tagVar.currentClassName = SPA.getCurrentClassName();
                    this.setData(tagVar);
                    this.show(ood('body'));
                    this.initData();
                    this._fireEvent('afterShow');
                });
                return;
            }


            switch (item.id) {
                case 'setproject':
                    if (!this.curProjectPath) {
                        ood.message(ood.getRes('RAD.ps.noprj'));
                        return;
                    }
                    this._setproject();
                    break;
                case 'about':
                    ood.ModuleFactory.getModule('about', function () {
                        this.show(null, null, null, null);
                    });
                    break;
                case 'version':
                    var tb = ns.tabsMain,
                        id = tb.getUIValue(),
                        o = tb.getItemByItemId(id),
                        hash = {path: o.id};
                    ood.ModuleFactory.getModule('RAD.VersionManager', function () {
                            this.show(null, null, null, null, hash);
                        }
                    );

                    break;
                case 'remoteServer':
                    $ESD.exportRemoteServer();
                    break;

                case 'localServer':
                    $ESD.exportLocalServer();
                    break;
                case 'buildServer':
                    $ESD.download();
                    break;

                case 'startServer':
                    $ESD.startDebugServer();
                    break;
                case 'stopServer':
                    $ESD.stopDebugServer();
                    break;

                case 'exit':
                    $ESD.quit();
                    break;

                case 'pullCode':
                    $ESD.pull();
                    break;

                case 'pushCode':
                    $ESD.push();
                    break;
                case 'clearAll':
                    $ESD.clearAll();
                    break;
                case 'openBPD':
                    $BPD.open();
                    break;

                case 'customDebug':
                    $ESD.customDebug();
                    break;
                case 'activeBranch':
                    break;


                case 'openBranch':
                    // var callback = function () {
                    ood.ModuleFactory.getModule('prjVersionSel', function () {
                        this.setProperties({
                            fromRegion: ood(src).cssRegion(true),
                            onOK1: ns._openproject,
                            onOK2: ns._openclsfolder,
                            projectName: SPA.curProjectName,
                            namespace: ns
                        });
                        this.show(ood('body'));
                    });

                    break;

                case 'newProject':

                    ood.ModuleFactory.getModule('prjPro', function () {
                        this.setProperties({
                            fromRegion: ood(src).cssRegion(true),
                            onOK1: ns._openproject,
                            onOK2: ns._openclsfolder,
                            namespace: ns
                        });
                        this.show(ood('body'));
                    });

                    break;


                case 'openProject':
                    ood.ModuleFactory.getModule('prjSel', function () {
                        this.setProperties({
                            fromRegion: ood(src).cssRegion(true),
                            onOK1: ns._openproject,
                            onOK2: ns._openclsfolder,
                            namespace: ns
                        });
                        this.show(ood('body'));
                    });
                    break;
                case 'newfile':
                    if (!this.curProjectPath) {
                        ood.message(ood.getRes('RAD.ps.noprj'));
                        return;
                    }
                    var tab = this.tabsMain, type = tab.getUIValue();
                    this._fileaction(null, "new2", src, this.tabsMain.getUIValue());
                    break;

                case 'upload':
                    if (!this.curProjectPath) {
                        ood.message(ood.getRes('RAD.ps.noprj'));
                        return;
                    }
                    var tab = this.tabsMain, type = tab.getUIValue();
                    this._fileaction(null, "upload", src, this.tabsMain.getUIValue());
                    break;
                case 'newFolder':
                    if (!this.curProjectPath) {
                        ood.message(ood.getRes('RAD.ps.noprj'));
                        return;
                    }
                    var tab = this.tabsMain, type = tab.getUIValue();
                    this._fileaction(null, "newFolder", src, this.tabsMain.getUIValue());
                    break;

                case 'newClass':
                    if (!this.curProjectPath) {
                        ood.message(ood.getRes('RAD.ps.noprj'));
                        return;
                    }
                    var tab = this.tabsMain, type = tab.getUIValue();
                    this._fileaction(null, "newClass", src, this.tabsMain.getUIValue());
                    break;
                case 'closeall':
                    if (!this.curProjectPath) {
                        ood.message(ood.getRes('RAD.ps.noprj'));
                        return;
                    }
                    var tb = this.tabsMain,
                        count = 0,
                        items = tb.getItems(),
                        hash = {},
                        collections = [],
                        oneMoudleRefreshed;
                    tb.clearItems();
                    // ood.arr.each(items, function (o) {
                    //   tb.removeItem(o.id)
                    // });
                    break;

                case 'save':
                    if (!this.curProjectPath) {
                        ood.message(ood.getRes('RAD.ps.noprj'));
                        return;
                    }
                    var tb = this.tabsMain,
                        id = tb.getUIValue(),
                        ns = this,
                        o = tb.getItemByItemId(id),
                        hash = {},
                        collections = [];
                    this._saveFile(o, collections);
                    ood.resetRun("$RAD-save-last", function () {
                        CONF.saveFiles(collections);
                    });
                    break;

                case 'saveall':
                    if (!this.curProjectPath) {
                        ood.message(ood.getRes('RAD.ps.noprj'));
                        return;
                    }
                    var tb = this.tabsMain,
                        count = 0,
                        items = tb.getItems(),
                        hash = {},
                        ns = this,
                        collections = [],
                        oneMoudleRefreshed;
                    ood.arr.each(items, function (o) {
                        ns._saveFile(o, collections);
                        //  collections.push({id: o.id, paras: paras, onSuccess: onSuccess, onFail: onFail});
                    });

                    CONF.saveFiles(collections);

                    break;
                case 'ec':
                    if (!this.$dropmenulang || this.$dropmenulang.isDestroyed()) {
                        this.$dropmenulang = new ood.UI.PopMenu({
                            items: [
                                {id: 'en', caption: ood.wrapRes('RAD.en')},
                                {id: 'cn', caption: ood.wrapRes('RAD.cn')}

                            ]
                        }, {
                            onMenuSelected: function (p, item) {
                                var lang = item.id;
                                if (ood.getLang() != lang) {
                                    var fun = function () {
                                        ood.setLang(lang, null, function (c, l) {
                                            if (c == 0) {
                                                ood.include("ood.Locale.en.doc", CONF.getAPIPath() + "Locale/en.js", function () {
                                                    if (!ood.Locale[lang].doc)
                                                        ood.Locale[lang].doc = ood.Locale.en.doc;
                                                });
                                            }
                                            // ajust all popmenu

                                            try {
                                                ood.UI.MenuBar.getAll().clearPopCache();
                                                ood.UI.PopMenu.getAll().adjustSize();
                                            } catch (e) {

                                            }

                                        });
                                        var hash = CONF.getStatus();
                                        ood.merge(hash, {
                                            "lang": ood.getLang()
                                        }, 'all');
                                        CONF.saveStatus(hash);
                                    };
                                    //use no-exist id
                                    ood.include("ood.Locale." + lang + ".doc", CONF.getAPIPath() + "Locale/" + lang + ".js", fun, fun);
                                }
                            }
                        });
                    }
                    this.$dropmenulang.pop(src);
                    break;
                case 'theme':
                    var m;
                    if (!(m = this.$dropmenutheme) || m.isDestroyed()) {
                        m = this.$dropmenutheme = new ood.UI.PopMenu();
                        m.onMenuSelected(function (p, item) {
                            if (ood.getTheme() != item.id) {
                                ood.setTheme(item.id, true, function () {
                                    ood.UI.MenuBar.getAll().clearPopCache();
                                    ood.UI.PopMenu.getAll().adjustSize();
                                    // ns.toolbar.updateItem('ec',{'caption':ood.getRes('RAD.'+item.id)});
                                    var hash = CONF.getStatus();
                                    ood.merge(hash, {
                                        "theme": ood.getTheme()
                                    }, 'all');
                                    CONF.saveStatus(hash);
                                }, null, ':not(.ood-designer-inner-control)');
                            }
                        });
                    }
                    var callback = function () {
                        m.pop(src);
                    };

                    if (m.getTag()) {
                        callback();
                    } else {
                        var items = [];
                        ood.arr.each(CONF.designer_themes, function (o) {
                            if (o) items.push({"id": o, "caption": "$RAD.builder.themes." + o});
                        });
                        m.setItems(items);
                        m.setTag("Loaded");
                        callback(items);
                    }
                    break;
                case 'info':
                    if (!this.Message.length)
                        return;
                    var list = this.$infoList, node = list.reBoxing();
                    list.setItems(ood.copy(this.Message));
                    node.popToTop(src, 4);
                    var unFun = function () {
                        node.hide();
                        //unhook
                        ood.Event.keyboardHook('esc');
                    };
                    //for on blur disappear
                    node.setBlurTrigger(list.get(0).$xid, unFun);
                    //for esc
                    ood.Event.keyboardHook('esc', 0, 0, 0, unFun);

                    break;
                case 'debug':
                    if (!ns.curProjectPath) {
                        ood.message(ood.getRes('RAD.ps.noprj'));
                        return;
                    }
                    ns._dirtyWarn(function () {
                        var w = ood.get(SPA.curProjectConfig, ['$DevEnv', 'designViewConf', 'width']) || 800,
                            h = ood.get(SPA.curProjectConfig, ['$DevEnv', 'designViewConf', 'height']) || 600,
                            touch = ood.get(SPA.curProjectConfig, ['$DevEnv', 'designViewConf', 'touchDevice']) || 0;
                        CONF.debugApp("/debug/" + SPA.curProjectName + "/", ood.getClassName(SPA.currentPage.replace(SPA.curProjectPath + "/", "")) + ".cls", {
                            'rand': ood.rand(),
                            'width': w,
                            'height': h,
                            'theme': ood.get(SPA, ['curProjectConfig', '$PageAppearance', 'theme']) || '',
                            'ficdn': ood.get(SPA, ['curProjectConfig', '$FontIconsCDN']) || '',
                            'lang': ood.getLang()
                        }, newinstance !== false);

                    });
                    break;

                case 'release':

                    if (!this.$deploymenu) {
                        this.$deploymenu = new ood.UI.PopMenu({
                            items: [
                                {id: 'remoteServer', caption: '$(RAD.esdmenu.remoteServer)'},
                                {id: 'localServer', caption: '$(RAD.esdmenu.localServer)'},
                            ]
                        }, {
                            onMenuSelected: function (p, item) {
                                ns._menubar_onclick(ns.menubar.get(0), null, item, src);
                            }
                        });
                    }
                    this.$deploymenu.pop(src);
                    break;

                case 'saveasweb': {
                    if (!ns.curProjectPath) {
                        ood.message(ood.getRes('RAD.ps.noprj'));
                        return;
                    }
                    ood.showModule("RAD.CustomPackage", function () {
                        this.initData();
                        this._fireEvent('afterShow');
                        this.setEvents("onOK", function (lib, appearance, locale) {
                            var hash = {
                                key: CONF.requestKey,
                                curProjectPath: SPA.curProjectPath,
                                paras: {
                                    action: 'saveasweb',
                                    ver: 'advanced',
                                    path: ns.curProjectPath,
                                    theme: ood.getTheme(),
                                    lang: ood.getLang(),
                                    files_lib: lib,
                                    files_appearance: appearance,
                                    files_locale: locale
                                }
                            };
                            CONF.saveAS(hash);
                        });
                    });
                }
                    break;
                case 'servicetester':
                    ood.getModule('RAD.ServiceTester', function () {
                        this.init();
                        this.show();
                        this.initData();
                        this._fireEvent('afterShow');
                    });
                    break;
                case 'command':
                    ood.Debugger.log('Ready');
                    break;

                case 'localicon':
                    ood.getModule("RAD.SelFontAwesome", function () {
                        this.show();
                        this.initData();
                        this._fireEvent('afterShow');
                    });
                    break;
                case 'orgManager':
                    ood.getModule("RAD.org.Main", function () {
                        this.show();
                        this.initData();
                        this._fireEvent('afterShow');
                    });
                    break;


                case 'formulatool':
                    ood.ModuleFactory.getModule('esd.right.TabIndex', function () {
                        this.setData({baseType: 'RIGHT'});
                        this.show(ood('body'));
                        this.initData();
                        this._fireEvent('afterShow');
                    });
                    break;


                case 'ComRight':
                    ood.ModuleFactory.getModule('esd.right.ComRight', function () {
                        this.setData({baseType: 'RIGHT'});
                        this.show(ood('body'));
                        this.initData();
                        this._fireEvent('afterShow');
                    });
                    break;
                case 'imgmanager':
                    ood.getModule("RAD.ImageSelector", function () {
                        this.show();
                        this.initData();
                        this._fireEvent('afterShow');
                    });
                    break;


                case 'imgimport':
                    ood.getModule("RAD.resource.ImageTree", function () {
                        this.setEvents("onDestroy", function (lib, appearance, locale) {
                            //ns._reload();
                            ood.alert("添加成功，请刷新浏览器后查看！");

                        });
                        this.setData({projectName: SPA.curProjectName});
                        this.show();
                        this.initData();
                        this._fireEvent('afterShow');
                    });
                    break;

                case 'serviceManager':
                    var designer = this._getDesigner();
                    ood.getModule("RAD.api.WebAPIManager", function () {
                        this.setData({projectName: SPA.curProjectName, className: SPA.getCurrentClassName()});
                        this.show();
                        this.initData();
                        this._fireEvent('afterShow');
                        this.setDataToEditor(designer.$host, designer._cls, designer);

                    });
                    break;


                case 'expressionEditor':
                    var designer = this._getDesigner();
                    ood.getModule("RAD.expression.ExpressionTemp", function () {
                        this.setData({projectName: SPA.curProjectName, className: SPA.getCurrentClassName()});

                        this.setDataToEditor(designer.$host, designer._cls, {url: '', queryArgs: {expression: ''}});
                        this.show();
                        this.initData();
                        this._fireEvent('afterShow');
                    });
                    break;


                case 'serviceImport':
                    ood.getModule("RAD.api.APITree", function () {
                        this.setData({projectName: SPA.curProjectName});
                        this.show();
                        this.initData();
                        this._fireEvent('afterShow');
                    });
                    break;

                case 'OneCodeDsmConfig':
                    window.open('http://custom.raddev.cn/RAD/DSMdsm/Debug.Index.view?domainId=DSMdsm' + '&projectVersionName=DSMdsm');
                    break;
                case 'OneCodeConfig':
                    if (SPA.curProjectName.indexOf("VVVERSION") > -1) {
                        SPA.curProjectName = SPA.curProjectName.substring(0, SPA.curProjectName.indexOf("VVVERSION"));
                    }

                    window.open("/RAD/" + SPA.curProjectName + "/Debug.Index.view?domainId=" + SPA.curProjectName + "&projectVersionName=" + SPA.curProjectName);
                    break;
                case 'dsmDesigner':
                    window.open('/RAD/DSMdsm/projectManager');
                    break;

                case 'bpmtest':
                    window.open("/RAD/" + SPA.curProjectName + "/admin.Index.view?projectName=" + SPA.curProjectName);
                    break;
                case 'ESDServerList':
                    ood.getModule("RAD.server.ESDServerList", function () {
                        this.setData({projectName: SPA.curProjectName});
                        this.show();
                        this.initData();
                        this._fireEvent('afterShow');
                    });
                    break;

                case 'RemoteServerList':
                    ood.getModule("RAD.server.RemoteServerList", function () {
                        this.setData({projectName: SPA.curProjectName});
                        this.show();
                        this.initData();
                        this._fireEvent('afterShow');
                    });
                    break;

                case 'ProxyHostList':
                    ood.getModule("RAD.server.ProxyHostList", function () {
                        this.setData({projectName: SPA.curProjectName});
                        this.show();
                        this.initData();
                        this._fireEvent('afterShow');
                    });
                    break;


                case 'DBProviderList':
                    ood.getModule("RAD.db.DBProviderList", function () {
                        this.setData({projectName: SPA.curProjectName});
                        this.show();
                        this.initData();
                        this._fireEvent('afterShow');
                    });
                    break;

                case 'importTable':
                    ood.getModule("RAD.db.project.DataBaseConfigList", function () {
                        this.setData({projectName: SPA.curProjectName});
                        this.show();
                        this.initData();
                        this._fireEvent('afterShow');
                    });
                    break;

                case 'SqlConsole':
                    ood.getModule("RAD.db.console.SqlConsole", function () {
                        this.setData({projectName: SPA.curProjectName});
                        this.show();
                        this.initData();
                        this._fireEvent('afterShow');
                    });
                    break;


                case 'dbmodule':
                    $ESD.createDBModule();
                    break;


                case 'configLocalServer':
                    ood.getModule("RAD.server.ESDServerList", function () {
                        this.setData({projectName: SPA.curProjectName});
                        this.show();
                        this.initData();
                        this._fireEvent('afterShow');
                    });
                    break;

                case 'configRemoteServer':
                    ood.getModule("RAD.server.RemoteServerList", function () {
                        this.setData({projectName: SPA.curProjectName});
                        this.show();
                        this.initData();
                        this._fireEvent('afterShow');
                    });
                    break;


                case 'configProxy':
                    ood.getModule("RAD.server.ProxyHostList", function () {
                        this.setData({projectName: SPA.curProjectName});
                        this.show();
                        this.initData();
                        this._fireEvent('afterShow');
                    });
                    break;
                case 'teamRight':
                    ood.getModule("RAD.org.PersonList", function () {
                        this.setData({projectName: SPA.curProjectName});
                        this.show();
                        this.initData();
                        this._fireEvent('afterShow');

                    });
                    break;


                case 'iconfont.cn':
                    ood.openOtherWin("http://www.iconfont.cn");
                    break;

                case 'editorTheme':
                    ood.ModuleFactory.newModule('RAD.EditorTheme', function () {
                        this.show();
                        this.initData();
                        this.setEvents("onOK", function (theme, fs, wrap) {
                            var obj = CONF.getStatus();
                            obj.editorTheme = theme;
                            obj.editorFontSize = fs;
                            obj.lineWrapping = wrap;
                            CONF.saveStatus(obj);
                            if (ns.curProjectPath) {
                                var tb = ns.tabsMain,
                                    items = tb.getItems();
                                ood.arr.each(items, function (o) {
                                    if (o = o.$obj)
                                        o.resetEditorStyle(theme, fs, wrap);
                                });
                            }
                        });
                    });
                    break;
                case 'editxml':
                    if (!ns.curProjectPath) {
                        ood.message(ood.getRes('RAD.ps.noprj'));
                        return;
                    }
                    break;
                case 'editcfg':
                    if (!ns.curProjectPath) {
                        ood.message(ood.getRes('RAD.ps.noprj'));
                        return;
                    }
                    break;
                case 'movews':
                    var f = function () {
                        ood.ModuleFactory.getModule('RAD.SwitchWorkspace', function () {
                            this.init();
                            this.show();
                            this.initData();
                            this._fireEvent('afterShow');
                        })
                    };
                    if (this.curProjectPath) {
                        this._closeproject(f);
                    } else
                        f();
                    break;

                case 'download':
                    CONF.openURL(CONF.path_download);
                    break;
                case 'viewbtn':
                    ood.showModule2('action.action.CodeTemps', null, null, {
                        projectVersionName: currProjectName,
                        projectName: currProjectName
                    });

                    break;


                //
                // default:
                //     ood.message(ood.getRes('RAD.soon'));
            }
        }
        ,
        __ondroptest: function (profile, e, src, dragKey, dragData, item) {
            var id = ood(src).id(),
                rn = profile.getRootNode(),
                oitem = profile.getItemByDom(dragData.domId);
            if (item) {
                // stop no sub item, stop sibling adding
                if (!item.sub || profile.getKey(src) != profile.keys["TOGGLE"]) {
                    return false;
                }
            }
            // stop root
            else {
                return false;
            }
        }
        ,
        __ondroptest2: function (profile, e, src, dragKey, dragData, item) {
            var id = ood(src).id(),
                rn = profile.getRootNode(),
                oitem = profile.getItemByDom(dragData.domId);
            if (item) {
                // stop no sub item, stop sibling adding
                if (!item.sub || profile.getKey(src) != profile.keys["TOGGLE"]) {
                    return false;
                }
            }
            // stop root
            else {
//                return false;
            }
        }

        ,
        jdsicon_onclick: function (profile, e, src) {
            var ns = this, uictrl = profile.boxing();
            if (!this.curProjectPath) {
                ood.message(ood.getRes('RAD.ps.noprj'));
                return;
            }
            var tb = this.tabsMain,
                id = tb.getUIValue(),
                ns = this,
                o = tb.getItemByItemId(id),
                hash = {},
                collections = [];
            this._saveFile(o, collections);
            ood.resetRun("$RAD-save-last", function () {
                CONF.saveFiles(collections);
            });
        },

        __beforedrop: function (profile, e, src, dragKey, dragData, item) {
            var ns = this,
                ins = profile.boxing(),
                oitem = profile.getItemByDom(dragData.domId);
            if (!oitem) return;

            var oid = oitem.id,
                caption = oitem.name,
                nid = (item ? item.id : (ns.curProjectPath + "/" + ns.currentRootCls + "/js"));

            ood.Ajax(CONF.copy, {
                spath: oid,
                tpath: nid,
                packageName: ns.packageName
            }, function (txt) {
                var obj = txt;
                if (obj && !obj.error && obj.requestStatus != -1 && obj.data.path) {
                    var pathadd = obj.data.path,
                        name = pathadd.substr(pathadd.lastIndexOf("/") + 1);
                    item = {
                        id: pathadd,
                        name: name,
                        caption: name,
                        value: pathadd
                    };
                    item = ood.clone(item);
                    if (type == 'cls') {
                        item.caption = ns._getpagename(name);
                    }
                    if (type == 'prj') {
                        item.caption = ns._getpagename(name);
                    }
                    var insOther = type == 'prj' ? ins1 : ins2;
                    if (insOther && (tbItem = insOther.getItemByItemId(tbItem.id)))
                        insOther.insertItems([item], tbItem.id);
                    ns.spath = null;
                } else
                    ood.message(ood.get(obj, ['error', 'errdes']) || obj || 'no response!');
            }, function (obj) {
                ood.message(ood.get(obj, ['error', 'errdes']) || obj || 'no response!');
            }, null, null, {method: 'POST'}).start();

            return false;
        }
    }
})
;

// A wrap for codemirror(http://codemirror.net/)
ood.Class("RAD.expression.CodeEditor", ["ood.UI.Widget", "ood.absValue"], {
    Instance: {
        activate: function () {
            var profile = this.get(0);
            if (profile.$cm) profile.$cm.focus();
            if (profile.$cm) profile.$cm.doc.setCursor(profile.readonly_head || 0 + 1, 0);
            return this;
        },
        getCM: function () {
            return this.get(0).$cm;
        },
        resetEditorStyle: function (theme, fs, lineWrapping, cm) {
            this.addCMTheme(theme);

            var profile = this.get(0);
            if (!cm) cm = profile.$cm;
            if (cm) {
                cm.setOption("theme", theme);
                cm.setOption("lineWrapping", !!lineWrapping);
                var n = cm.getWrapperElement();
                if (n) {
                    n.style.fontSize = fs + "px";
                }
            }
        },
        showModeSelDlg: function (mm) {
            var ns = this,
                cm = ns.getCM(),
                profile = ns.get(0),
                callback = function (mode) {
                    // force to finish render
                    if (!mode || mode.mode === "none") {
                        if (!profile.$initialized)
                            profile.$initialized = true;
                        if (profile.onRendered)
                            profile.boxing().onRendered(profile, true);
                    } else {
                        cm.setOption('mode', mode.mime || mode.mode);
                        CodeMirror.autoLoadMode(cm, mode.mode);

                        if (profile.onCodeModeSet)
                            profile.boxing().onCodeModeSet(profile, mode);
                    }
                    profile = cm = null;
                };
            ood.ModuleFactory.newCom("RAD.expression.SelRenderMode", function () {
                this.setEvents("onSel", callback);
                this.mainDlg.showModal();
                this.modeList.setValue(mm.mime + ":" + mm.mode);
            });
        },
        addCMTheme: function (theme) {
            var profile = this.get(0);
            var id = "cm-theme-" + theme;
            if (theme != "default" && !ood.CSS.get("id", id)) {
                ood.CSS.includeLink("codemirror5/theme/" + theme + ".css", false, id)
            }
        },
        clearHistory: function () {
            var obj = this.get(0).$cm;
            if (obj) obj.clearHistory();
        },
        reindent: function () {
            var cm = this.get(0).$cm,
                doc = cm.doc;
            if (doc.somethingSelected()) {
                var p1 = doc.getCursor("start"),
                    p2 = doc.getCursor("end");
                for (var i = p1.line, l = p2.line; i <= l; i++)
                    cm.indentLine(i)
            } else {
                var p1 = doc.firstLine(),
                    p2 = doc.lastLine();
                for (var i = p1, l = p2; i <= l; i++)
                    cm.indentLine(i)
            }
        },
        callEditor: function (name, args, isDoc) {
            var obj = this.get(0).$cm;
            if (isDoc) obj = obj.doc;
            return obj[name].apply(obj, args || []);
        },
        searchCode: function (code) {
            var profile = this.get(0),
                cm = profile.$cm;
            if (cm) {
                var cursor = cm.getSearchCursor(code, cm.hasFocus() ? cm.doc.getCursor() : {pos: 0, line: 0}, true);
                if (cursor.findNext()) {
                    cm.focus();
                    cm.doc.setSelection(cursor.from(), cursor.to());
                }
            }
        },
        // locate to declare key
        locateTo: function (key1, key2, toSelect) {
            var ns = this,
                profile = this.get(0),
                cm = profile.$cm,
                struct, info, codefrom, codeto;
            if (cm) {
                struct = RAD.ClassTool.getClassStruct2(cm.doc.getValue());
                if (key1) {
                    if (key2 && (key1 == "Static" || key1 == "Instance"))
                        info = ood.get(struct, ["sub", key1, "sub", key2]);
                    else
                        info = ood.get(struct, ["sub", key1]);
                }
                if (info) {
                    if (toSelect)
                        cm.doc.setSelection(cm.doc.posFromIndex(info.from), cm.doc.posFromIndex(info.to));
                    else {
                        var pos = cm.doc.posFromIndex(info.from);
                        cm.focus();
                        cm.doc.setCursor(pos);
                        cm.scrollIntoView(pos);
                    }
                    return true;
                }
            }
            return false;
        },
        focusLine: function (line) {
            var ns = this,
                profile = this.get(0),
                cm = profile.$cm,
                pos = {line: line, ch: 0};
            if (cm) {
                cm.focus();
                cm.doc.setCursor(pos);
                cm.scrollIntoView(pos);
            }
        },
        getLine: function (key1, key2, toSelect) {
            var ns = this,
                profile = this.get(0),
                cm = profile.$cm,
                struct, info, codefrom, codeto;
            if (cm) {
                struct = RAD.ClassTool.getClassStruct2(cm.doc.getValue());
                if (key1) {
                    if (key2 && (key1 == "Static" || key1 == "Instance"))
                        info = ood.get(struct, ["sub", key1, "sub", key2]);
                    else
                        info = ood.get(struct, ["sub", key1]);
                }
                if (info) {
                    return cm.doc.posFromIndex(info.from);
                }
            }
            return null;
        },
        // add code to a hash, or replace the original one
        addCodeInto: function (key1, key2, code, isFun, comments) {
            comments = comments || "";
            var ns = this,
                profile = this.get(0),
                cm = profile.$cm;
            if (cm) {
                var struct = RAD.ClassTool.getClassStructWithScope(cm.getValue()),
                    fo = ood.get(struct, ["sub", key1, "sub", key2]),
                    fo2;
                // There is a function => replace code
                if (fo/* && (fo.type=='function'||fo.type=='object')*/) {
                    cm.doc.replaceRange(code, cm.doc.posFromIndex(fo.from), cm.doc.posFromIndex(fo.to));
                    //cm.doc.setSelection(cm.doc.posFromIndex(fo.from), cm.doc.posFromIndex(fo.from+code.length));
                    //ns.reindent();
                } else {
                    if (comments) comments += "\n";

                    fo = ood.get(struct, ["sub", key1]);
                    // add first layer
                    if (!fo) {
                        fo2 = ood.get(struct, ["sub", struct.arr[struct.arr.length - 1]]);
                        if (fo2)
                            code = ",\n" + comments + key1 + ":{\n" + key2 + ":" + (isFun ? 'function()' : '') + code + "\n" + "}";
                        else {
                            code = key1 + ":{\n" + comments + key2 + ":" + (isFun ? 'function()' : '') + code + "\n" + "}\n";
                            fo2 = struct;
                            fo2.to--;
                        }
                    } else {
                        // find the last one
                        fo2 = ood.get(fo, ["sub", fo.arr[fo.arr.length - 1]]);
                        if (fo2)
                            code = ",\n" + comments + key2 + ":" + (isFun ? 'function()' : '') + code;
                        else {
                            code = comments + key2 + ":" + (isFun ? 'function()' : '') + code + "\n";
                            fo2 = fo;
                            fo2.to--;
                        }
                    }
                    var pos = cm.doc.posFromIndex(fo2.to);
                    cm.doc.replaceRange(code, pos, pos);
                    cm.doc.setSelection(pos, cm.doc.posFromIndex(fo2.to + code.length));
                    ns.reindent();
                }
                //locate in the UI
                //ns.locateTo(key1,key2);
            }
        },
        getBlockInfo: function (key1, key2) {
            var ns = this,
                profile = this.get(0),
                cm = profile.$cm;
            return cm && ood.get(RAD.ClassTool.getClassStructWithScope(cm.getValue()), ["sub", key1, "sub", key2]);
        },
        _refreshCM: function () {
            if (this.get(0).$cm) this.get(0).$cm.refresh();
        },


        _setCtrlValue: function (value) {
            if (!ood.isSet(value)) value = '';
            return this.each(function (profile) {
                if (profile.$cm && profile.$cm.getValue() != value) {
                    profile.$cm.doc.setValue(value);
                    if (profile.$tm1) profile.$tm1.clear();
                    if (profile.$tm2) profile.$tm2.clear();
                    delete profile.$tm1;
                    delete profile.$tm2;
                    delete profile.readonly_head;
                    delete profile.readonly_tail;
                }
            });
        },


        _getCtrlValue: function () {
            var profile = this.get(0);
            if (profile.$cm)
                return profile.$cm.doc.getValue();
            else
                return profile.properties.$UIvalue;
        },
        setReadonlyLines: function (head, tail) {
            var profile = this.get(0), doc = profile.$cm.doc;
            if (profile.$tm1) profile.$tm1.clear();
            if (profile.$tm2) profile.$tm2.clear();

            if (head) {
                profile.$tm1 = doc.markText({line: 0, ch: 0}, {line: head, ch: 0}, {
                    atomic: true,
                    readOnly: true,
                    css: 'background-color:#ccc;'
                });
            }
            if (tail) {
                var last = doc.lastLine();
                profile.$tm2 = doc.markText({line: last - tail}, {line: last}, {
                    atomic: true,
                    readOnly: true,
                    css: 'background-color:#ccc;'
                });
            }
            profile.readonly_head = head;
            profile.readonly_tail = tail;
        }
    },
    Initialize: function () {
        //modify default template for shell
        var t = this.getTemplate();
        ood.merge(t.FRAME.BORDER, {
            BOX: {
                tagName: 'div'
            }
        }, 'all');
        this.setTemplate(t);

        this.__trim = function (s) {
            if (/[^\s\uFEFF\xA0]/.test(s)) {
                return ood.str.trim(s);
            } else
                return s;
        };
    },
    Static: {
        $tempsandbox: "_$temp_for_ood_sandbox",
        $tempsandbox2: "_$temp_for_ood_sandbox2",
        $temppool: "_$temp_for_ood_pool",
        Appearances: {
            BOX: {
                width: '100%',
                height: '100%',
                left: 0,
                top: 0,
                position: 'absolute',
                background: '#fff'
            }
        },
        Behaviors: {},
        DataModel: {
            left: 0,
            top: 0,
            width: 200,
            height: 200,
            position: 'absolute',
            codeType: {
                ini: 'js',
                action: function (codeType) {
                    if (this.$cm) {
                        var mode = CONF.getRenderMode(codeType);
                        if (!mode) mode = CONF.getRenderMode("txt");
                        this.$cm.setOption('mode', mode.mime || mode.mode);
                        if (this.onCodeModeSet) this.boxing().onCodeModeSet(this, mode);
                    }
                }
            },
            readonly: {
                ini: false,
                action: function (value) {
                    if (this.$cm)
                        this.$cm.setOption("readOnly", !!value);
                }
            }
        },
        EventHandlers: {
            onValueChanged: function (profile, flag) {
            },
            onRendered: function (profile) {
            },
            onGetHelpInfo: function (profile, key) {
            },
            onCodeModeSet: function (profile, mode) {
            },
            onSaveCommand: function () {
            }
        },
        RenderTrigger: function () {
            var key = this.box.$temppool,
                subkey = this.$xid;

            this.box._loadEditor(this);

            this.destroyTrigger = function () {
                this.$cm.clearGutter();
                this.$cm.clearHistory();
                delete this.$cm;
                delete this.$tm1;
                delete this.$tm2;
                delete this.$editor;

                // destroy related UI
                if (this.$popList) this.$popList.destroy();
                if (this.$popHelp) this.$popHelp.destroy();
                if (this.$popCustom) this.$popCustom.destroy();

                if (window[key]) delete window[key][subkey];
            };
        },
        clearSandbox: function (name) {
            for (var i = 1, n; i < 9; i++) {
                n = name + i;
                if (n && document.getElementById(n)) {
                    document.body.removeChild(document.getElementById(n));
                    try {
                        delete frames[n]
                    } catch (e) {
                    }
                }
            }
        },
        purge: function () {
            var ns = this, z;
            if ((z = window[ns.$temppool]) && z.Instance && z.Instance._ctrlpool) {
                ood.each(z.Instance._ctrlpool, function (o, i) {
                    if (o && !o.destroyed) {
                        if (o.destroy) o.destroy();
                        if (o.boxing && o.boxing()) o.boxing().destroy();
                    }
                });
                ood.breakO(z.Instance);
            }
        },
        _alias: 1,
        evalInSandbox: function (code, funScope, name, subCacheKey, purge, beforeCode, afterCode, cleanFun) {
            if (name && document.getElementById(name)) {
                document.body.removeChild(document.getElementById(name));
                try {
                    delete frames[name]
                } catch (e) {
                }
            }
            var ns = this,
                iframe = document.createElement("iframe"), result, wnd, line, errmsg, type;

            ns.purge();

            if (name) {
                iframe.name = name;
                iframe.id = name;
            }


            iframe.src = "about:blank";
            iframe.style.display = "none";
            document.body.appendChild(iframe);
            wnd = frames[frames.length - 1];
            wnd.document.open();
            wnd.document.write('<meta http-equiv="content-type" content="text/html; charset=utf-8" />');
            wnd.document.write("<script>\n");
            if (beforeCode) wnd.document.write(beforeCode);
            wnd.document.write(""
                // stop Node.js
                + "global=process=Buffer=require=module=exports=root=null;\n"

                // copy object
                + "window.ood=parent.ood;\n"
                + "window.Class=function(){return ood.Class.apply(ood,arguments);};\n"
                + "window.CONF={mixed_prop: ood.clone(parent.CONF.mixed_prop) };\n"

                + (CONF.SandBoxExtCode || "")

                //get this scope
                + "window.__cache={};window.__getThis=function(pname,type){\n"
                + "      if(__cache[pname+':'+type])return __cache[pname+':'+type];\n"
                + "      var obj=type==1?function(){}:{};\n"
                + "      if(pname){\n"
                + "          if(ood.isArr(pname)){\n"
                + "              ood.each(pname,function(cls){\n"
                + "                  cls=ood.SC(cls);\n"
                + "                  obj=ood.merge(obj, type==1?(cls||ood.Module):(cls?(new cls):(new ood.Module)),'all',true)\n"
                + "              });\n"
                + "          }else{\n"
                + "              pname=ood.SC(pname);\n"
                + "              obj=ood.merge(obj, type==1?(pname||ood.Module):(pname?(new pname):(new ood.Module)),'all',true)\n"
                + "          }\n"
                + "      }\n"
                + "      if(window['" + ns.$temppool + "'] && window['" + ns.$temppool + "']['" + subCacheKey + "']){\n"
                + "          obj=ood.merge(obj, window['" + ns.$temppool + "']['" + subCacheKey + "'][type==1?'Static':'Instance'],'all')\n"
                + "      }\n"
                + "      return __cache[pname+':'+type]=obj;\n"
                + "  };\n"

                + "window['" + ns.$temppool + "']=parent['" + ns.$temppool + "'];\n"
                // "var b=arguments.callee;" for fix firefox 3.5 bug
                + "parent['" + ns.$tempsandbox + "']=/*@cc_on !@*/0?this:{eval:function(s){return (function(){var b=arguments.callee;return window.eval.call(window,s)})()}};\n"
                + "parent['" + ns.$tempsandbox2 + "']={getErrLine:function(s,cb){window.onerror=function(){cb.apply(null,arguments);return true;};var n=document.createElement('script');n.type='text/javascript';if(/*@cc_on !@*/0){n.text=s;}else{n.appendChild(document.createTextNode(s));};document.body.appendChild(n);window.onerror=null;}};\n"
                + "try{top=parent=null;}catch(e){}"
            );
            if (afterCode) wnd.document.write(afterCode);
            wnd.document.write("<\/script><body><span id='abc'></span></body>");
            wnd.document.close();
            var bak = ood.Dom.pack,
                bak1 = ood.absProfile.prototype.$link,
                bak11 = ood.absObj.$pickAlias,
                bak12 = ood.UIProfile.prototype.setDomId,
                bak2 = ood.require,
                bak3 = ood.$cache,
                bak4 = ood.asyRun,
                bak5 = ood.resetRun,
                bak6 = ood.exec,
                bak7 = ood.pseudocode._callFunctions;

            try {
                // avoid lib or dom affected
                ood.Dom.pack = function () {
                    var o = new ood.Dom(false), d = document.getElementById('abc');
                    o._nodes = [d];
                    return o
                };
                ood.absProfile.prototype.$link = function () {
                    return this;
                };
                // stop all default events
                ood.Class.$instanceCreated = function (instance) {
                    instance.$inDesign = 1;
                };
                ood.absObj.$pickAlias = function () {
                    return ns._alias++
                };
                ood.UIProfile.prototype.setDomId = function () {
                    return this;
                };
                ood.require = function () {
                };
                ood.$cache = {};
                ood.each(bak3, function (o, i) {
                    ood.$cache[i] = ood.isArr(o) ? [] : {};
                });
                ood.asyRun = ood.resetRun = ood.exec = ood.pseudocode._callFunctions = function () {
                };

                result = window[ns.$tempsandbox].eval(code);
                if (funScope) {
                    if (typeof(result) == 'function') result.call(funScope);
                }

                type = (result === wnd || result === wnd.content) ? 'window' :
                    result === wnd.console ? 'console' :
                        result === wnd.history ? 'history' :
                            result === wnd.screen ? 'screen' :
                                result === wnd.location ? 'location' :
                                    result === wnd.navigator ? 'navigator' :
                                        result === wnd.document ? 'document' :
                                            null;
                // to avoid : Can't execute code from a freed script
                if (ood.browser.newie || (ood.browser.ie && ood.browser.ver >= 9)) {
                    var fun = function (hash) {
                        for (var i in hash) {
                            if (ood.isFun(hash[i])) hash[i]._____string = hash[i] + "";
                            else if (ood.isHash(hash[i])) fun(hash[i]);
                            else if (ood.isArr(hash[i])) fun(hash[i]);
                        }
                    };
                    if (type === null && (ood.isHash(result) || ood.isArr(result))) fun(result);
                }
            } catch (e) {
                //firefox or opera
                if (ood.isSet(e.line || e.lineNumber)) {
                    line = e.line || e.lineNumber;
                }
                // safari chrome IE
                else {
                    var base = 0;
                    if (ood.browser.ie) {
                        window[ns.$tempsandbox2].getErrLine("var _a={;", function (a, b, c) {
                            base = c - 1;
                            return true;
                        });
                    }
                    window[ns.$tempsandbox2].getErrLine(code, function (a, b, c) {
                        line = c - base;
                        return true;
                    });
                }
                errmsg = ((e.name ? e.name + ' : ' : '') + (e.description || e.message || '') + (line ? '\n line : ' + line : ''));
                if (!ood.isSet(line) && /.*at line ([\d]+).*/.test(errmsg))
                    line = errmsg.replace(/.*at line ([\d]+).*/, '$1');
            } finally {

                if (purge) ns.purge();

                delete ood.Class.$instanceCreated;

                ood.Dom.pack = bak;
                ood.absProfile.prototype.$link = bak1;
                ood.absObj.$pickAlias = bak11;
                ood.UIProfile.prototype.setDomId = bak12;
                ood.require = bak2;
                ood.$cache = bak3;
                ood.asyRun = bak4;
                ood.resetRun = bak5;
                ood.exec = bak6;
                ood.pseudocode._callFunctions = bak7;

                if (cleanFun) cleanFun(wnd, iframe);

                wnd.CONF = wnd.Class = wnd.ood = wnd[ns.$temppool] = wnd.__getThis = wnd.__cache = null;
                if (CONF.ClearSandBoxExtCode) {
                    CONF.ClearSandBoxExtCode(wnd);
                }
                window[ns.$tempsandbox] = null;
                window[ns.$tempsandbox2] = null;

                var rsl = {
                    ok: result,
                    type: type,
                    ko: errmsg,
                    line: line
                };

                ns = bak = result = line = errmsg = type = null;
                if (!name)
                    document.body.removeChild(iframe);
                iframe = null;

                return rsl;
            }
        },
        _buildItem: function (id, type, key, o, caption, value, order, itemStyle) {
            return {
                id: id,
                caption: caption || id,
                value: value || id,
                tag: (order || (type == 'property' ? 'b' : type == 'function' ? 'c' : type == 'class' ? 'd' : type == 'event' ? 'e' : 'a')) + ":" + id.toLowerCase(),
                path: (key ? (key + ".") : "") + id,
                itemStyle: itemStyle,
                imageClass: !type ? null :
                    (type == 'property' ?
                        (ood.isSet(o) && ood.isHash(o)) ? 'ri ri-code-box-line' :
                            (ood.isSet(o) && ood.isArr(o)) ? 'ri ri-list-unordered' :
                                'ri ri-code-line' :
                        type == 'var' ? 'ri ri-code-line' :
                            type == 'event' ? 'ri ri-flashlight-line' :
                                type == 'function' ? 'ri ri-code-line' :
                                    type == 'class' ? 'ri ri-file-code-line' :
                                        "ri ri-key-line")
            };
        },
        _intellcache: {},
        _enumKeys: function (target, key, normalObj, ownOnly) {
            // non-object or array return empty array
            if (!ood.isObj(target) || ood.isArr(target)) return [];

            // default is normal object
            normalObj = normalObj !== false;
            var ns = this,
                isoodobj = target.$ood$,
                o, isfun,
                list = [];

            for (var i in target) {
                if ('prototype' == i || 'constructor' == i)
                    continue;
                if (isoodobj) {
                    if ('upper' == i || 'After' == i || 'Before' == i || 'Instance' == i || 'Static' == i || 'Constructor' == i)
                        continue
                }
                try {
                    if (i.charAt(0) != "_" && i.charAt(0) != "$" && /^[\w_]+$/.test(i)) {
                        o = target[i];
                        if (normalObj && (o && o.$abstract)) {
                            continue;
                        }

                        isfun = typeof o == 'function' && (!(o && o.$ood$) || o.$asFunction);

                        if (ownOnly && (!target.hasOwnProperty(i) || !target.propertyIsEnumerable(i))) {
                            continue;
                        }
                        var value = i;
                        if (isfun) {
                            if (normalObj) {
                                var arr = ood.fun.args(o);
                                var isInstance = false;
                                if (ood.str.endWith(key, ".prototype")) {
                                    isInstance = true;
                                }
                                var paras = RAD.ClassTool.getArgsFromAPI(key.replace(".prototype", ""), i, isInstance);
                                if (paras) {
                                    // use doc's paramters
                                    arr = [];
                                    for (var k = 0, l = paras.length; k < l; k++) {
                                        arr[k] = paras[k] && paras[k].name;
                                    }
                                }
                                value = i + "(" + arr.join(", ") + ")";
//                                console.log(key.replace(".prototype",""), i , isInstance, arr, value);
                            } else {
                                value = i + "( )";
                            }
                        }
                        list.push(ns._buildItem(i,
                            (typeof o == 'function') ? (o && o.$ood$ && !o.$asFunction) ? 'class' : (o && o.$event$) ? "event" : 'function' : 'property',
                            key,
                            o,
                            value,
                            value
                        ));
                    }
                } catch (e) {
                    console.log(e);
                }

            }

            return list;
        },


        _getIntellisenseList: function (key, cachedata) {
            if (!key) return null;
            cachedata = cachedata !== false;

            var ns = this,
                cache = ns._intellcache,
                buildItem = ns._buildItem;

            if (cachedata && cache[key]) return cache[key];

            var list = [];
            if (key == ns.$temppool) {
                return [];
            }

            switch (key) {
                case ' variables ': {
                    list = [
                        // global
                        buildItem("ood", 0, 0, 0, 0, 0, 2, "font-weight:bold;color:#ff0000;"),
                        buildItem("ood()", 0, 0, 0, "ood()", "ood()", 2, "font-weight:bold;color:#ff0000;"),

                        buildItem("top", 0, 0, 0, 0, 0, 3, "font-weight:bold;"),
                        buildItem("parent", 0, 0, 0, 0, 0, 3, "font-weight:bold;"),
                        buildItem("window", 0, 0, 0, 0, 0, 3, "font-weight:bold;"),
                        buildItem("document", 0, 0, 0, 0, 0, 3, "font-weight:bold;"),
                        buildItem("navigator", 0, 0, 0, 0, 0, 3, "font-weight:bold;"),
                        buildItem("history", 0, 0, 0, 0, 0, 3, "font-weight:bold;"),
                        buildItem("location", 0, 0, 0, 0, 0, 3, "font-weight:bold;"),
                        buildItem("screen", 0, 0, 0, 0, 0, 3, "font-weight:bold;"),
                        buildItem("Math", 0, 0, 0, 0, 0, 3, "font-weight:bold;"),
                        buildItem("Number", 0, 0, 0, 0, 0, 3, "font-weight:bold;"),
                        buildItem("console", 0, 0, 0, 0, 0, 3, "font-weight:bold;"),
                        // js
                        buildItem("if  ", 0, 0, 0, "if...", "if(){\n\n}", 5),
                        buildItem("ifelse", 0, 0, 0, "if...else...", "if(){\n\n}else{\n\n}", 5),
                        buildItem("while", 0, 0, 0, "while...", "while(){\n\n};", 5),
                        buildItem("do  ", 0, 0, 0, "do...while", "do{\n\n}while();", 5),
                        buildItem("try  ", 0, 0, 0, "try...catch...finally", "try{\n\n}catch(e){\n\n}finally{\n\n}", 5),
                        buildItem("for  ", 0, 0, 0, "for...", "for(;;;){\n\n}", 5),
                        buildItem("forin  ", 0, 0, 0, "for...in", "for( in ){\n\n}", 5),
                        buildItem("function", 0, 0, 0, "function...", "function(){\n\n}", 5),
                        buildItem("switch", 0, 0, 0, "switch...", "switch(){\n  case : \n\n  break;\n  case : \n\n  break;\ndefault: \n\n}", 5),
                        buildItem("with", 0, 0, 0, "with...", "with(){\n\n}", 5),

                        buildItem("return", 0, 0, 0, "return", "return ", 4),
                        buildItem("break", 0, 0, 0, "break", "break;", 4),
                        buildItem("continue", 0, 0, 0, "continue", "continue;", 4),
                        buildItem("throw", 0, 0, 0, "throw", "throw ", 4),
                        buildItem("new ", 0, 0, 0, "new", "new ", 4),
                        buildItem("delete", 0, 0, 0, "delete", "delete ", 4),
                        buildItem("arguments", 0, 0, 0, "arguments", "arguments", 4),
                        buildItem("var", 0, 0, 0, "var", "var ", 4),
                        buildItem("case", 0, 0, 0, "case", "case :", 4),
                        buildItem("default", 0, 0, 0, "default", "default :", 4),

                        buildItem("typeof", 0, 0, 0, "typeof", "typeof ", 4),
                        buildItem("instanceof", 0, 0, 0, "instanceof", "instanceof ", 4),

                        buildItem("void", 0, 0, 0, "void", "void", 4),
                        buildItem("true", 0, 0, 0, "true", "true", 4),
                        buildItem("false", 0, 0, 0, "false", "false", 4),
                        buildItem("null", 0, 0, 0, "null", "null", 4),
                        buildItem("NaN", 0, 0, 0, "NaN", "NaN", 4),
                        buildItem("undefined", 0, 0, 0, "undefined", "undefined", 4),
                        buildItem("Infinity", 0, 0, 0, "Infinity", "Infinity", 4),


                        buildItem("decodeURI()", "function"),
                        buildItem("decodeURIComponent()", "function"),
                        buildItem("encodeURI()", "function"),
                        buildItem("encodeURIComponent()", "function"),
                        buildItem("escape()", "function"),
                        buildItem("eval()", "function"),
                        buildItem("isFinite()", "function"),
                        buildItem("parseFloat()", "function"),
                        buildItem("parseInt()", "function"),
                        buildItem("unescape()", "function"),
                        buildItem("Number()", "function"),
                        buildItem("String()", "function"),

                        //**********************
                        buildItem("keySet[", 0, 0, 0, "PK[0]", "PK[0]", 5),
                        buildItem("PK", 0, 0, 0, "PK['0']", "PK['0']", 4, "font-weight:bold;"),
                        buildItem("absField", 0, 0, 0, "absField()", "absField(filed1,filed2,value,units)", 5)
                    ];
                    break;
                }
                case 'new': {
                    list = [

                        buildItem("String", "class", 0, 0, 0, "String();", 1),
                        buildItem("Object", "class", 0, 0, 0, "Object();", 1),
                        buildItem("Array", "class", 0, 0, 0, "Array();", 1),
                        buildItem("RegExp", "class", 0, 0, 0, "RegExp();", 1),
                        buildItem("Boolean", "class", 0, 0, 0, "Boolean();", 1),
                        buildItem("Number", "class", 0, 0, 0, "Number();", 1),
                        buildItem("Date", "class", 0, 0, 0, "Date();", 1),

                        buildItem("ood.Dom", "class", 0, 0, 0, "ood.Dom();", 2),
                        buildItem("ood.UIProfile", "class", 0, 0, 0, "ood.UIProfile();", 2),
                        buildItem("ood.Module", "class", 0, 0, 0, "ood.Module();", 2),
                        buildItem("ood.Template", "class", 0, 0, 0, "ood.Template();", 2),
                        buildItem("ood.UI", "class", 0, 0, 0, "ood.UI();", 2),
                        buildItem("ood.DataBinder", "class", 0, 0, 0, "ood.DataBinder();", 2)
                    ];
                    for (var i in ood.UI) {
                        if (i != 'upper' && ood.UI[i].$ood$) {
                            list.push(buildItem("ood.UI." + i, "class", 0, 0, 0, " " + "ood.UI." + i + "();", 2));
                        }
                    }
                    break;
                }
                case 'history':
                case 'screen':
                    break;

                case 'PK[':
                    buildItem("PK['0']", 0, 0, 0, "PK['0']", "PK[0]", 5)
                    break;

                case 'console':
                    list = [
                        buildItem("log()", "function", key)
                    ];
                    break;
                case 'arguments': {
                    list = [
                        buildItem("callee", "property", key),
                        buildItem("length", "property", key)
                    ];
                    break;
                }
                case 'arguments.callee': {
                    list = [
                        buildItem("caller", "property", key),
                        buildItem("length", "property", key),
                        buildItem("call()", "function", key),
                        buildItem("apply()", "function", key)
                    ];
                    break;
                }
                case 'top':
                case 'parent':
                case 'window': {
                    var iframe = document.createElement("iframe");
                    iframe.style.display = "none";
                    document.body.appendChild(iframe);
                    var target = frames[frames.length - 1];
                    list = ns._enumKeys(target, key, false);
                    document.body.removeChild(iframe);
                    break;
                }
                case 'document': {
                    var iframe = document.createElement("iframe");
                    iframe.style.display = "none";
                    document.body.appendChild(iframe);
                    var target = frames[frames.length - 1];
                    list = ns._enumKeys(target.document, key, false);
                    document.body.removeChild(iframe);
                    break;
                }
                case 'Element.prototype': {
                    var iframe = document.createElement("iframe");
                    iframe.style.display = "none";
                    document.body.appendChild(iframe);
                    var target = frames[frames.length - 1];
                    target.document.write("<span>a</span>");
                    list = ns._enumKeys(target.document.body.firstChild, key, false);
                    document.body.removeChild(iframe);
                    break;
                }
                case 'Math': {
                    list = [
                        buildItem("E", "property", key),
                        buildItem("LN2", "property", key),
                        buildItem("LN10", "property", key),
                        buildItem("LOG2E", "property", key),
                        buildItem("LOG10E", "property", key),
                        buildItem("PI", "property", key),
                        buildItem("SQRT1_2", "property", key),
                        buildItem("SQRT2", "property", key),
                        buildItem("abs(x)", "function", key),
                        buildItem("acos(x)", "function", key),
                        buildItem("asin(x)", "function", key),
                        buildItem("atan(x)", "function", key),
                        buildItem("atan2(y,x)", "function", key),
                        buildItem("ceil(x)", "function", key),
                        buildItem("cos(x)", "function", key),
                        buildItem("exp(x)", "function", key),
                        buildItem("floor(x)", "function", key),
                        buildItem("log(x)", "function", key),
                        buildItem("max(x,y,z,...,n)", "function", key),
                        buildItem("min(x,y,z,...,n)", "function", key),
                        buildItem("pow(x,y)", "function", key),
                        buildItem("random()", "function", key),
                        buildItem("round(x)", "function", key),
                        buildItem("sin(x)", "function", key),
                        buildItem("sqrt(x)", "function", key),
                        buildItem("tan(x)", "function", key)
                    ];
                    break;
                }
                case 'Number': {
                    list = [
                        buildItem("MAX_VALUE", "property", key),
                        buildItem("MIN_VALUE", "property", key),
                        buildItem("NEGATIVE_INFINITY", "property", key),
                        buildItem("POSITIVE_INFINITY", "property", key)
                    ];
                    break;
                }
                case "Array.prototype": {
                    list = [
                        buildItem("length", "property", key),
                        buildItem("concat()", "function", key),
                        buildItem("join()", "function", key),
                        buildItem("pop()", "function", key),
                        buildItem("push()", "function", key),
                        buildItem("reverse()", "function", key),
                        buildItem("shift()", "function", key),
                        buildItem("sort()", "function", key),
                        buildItem("concat()", "function", key),
                        buildItem("splice()", "function", key),
                        buildItem("toString()", "function", key),
                        buildItem("unshift()", "function", key)
                    ];
                    break;
                }
                case "Date.prototype": {
                    list = [
                        buildItem("getDate()", "function", key),
                        buildItem("getDay()", "function", key),
                        buildItem("getFullYear()", "function", key),
                        buildItem("getHours()", "function", key),
                        buildItem("getMilliseconds()", "function", key),
                        buildItem("getMinutes()", "function", key),
                        buildItem("getMonth()", "function", key),
                        buildItem("getTime()", "function", key),
                        buildItem("getSeconds()", "function", key),
                        buildItem("getTimezoneOffset()", "function", key),
                        buildItem("getUTCDate()", "function", key),
                        buildItem("getUTCDay()", "function", key),
                        buildItem("getUTCFullYear()", "function", key),
                        buildItem("getUTCHours()", "function", key),
                        buildItem("getUTCMilliseconds()", "function", key),
                        buildItem("getUTCMinutes()", "function", key),
                        buildItem("getUTCMonth()", "function", key),
                        buildItem("getUTCSeconds()", "function", key),
                        buildItem("getYear()", "function", key),
                        buildItem("parse()", "function", key),
                        buildItem("setDate()", "function", key),
                        buildItem("setFullYear()", "function", key),
                        buildItem("setHours()", "function", key),
                        buildItem("setMilliseconds()", "function", key),
                        buildItem("setMinutes()", "function", key),
                        buildItem("setMonth()", "function", key),
                        buildItem("setSeconds()", "function", key),
                        buildItem("setTime()", "function", key),
                        buildItem("setUTCDate()", "function", key),
                        buildItem("setUTCFullYear()", "function", key),
                        buildItem("setUTCHours()", "function", key),
                        buildItem("setUTCMilliseconds()", "function", key),
                        buildItem("setUTCMinutes()", "function", key),
                        buildItem("setUTCSeconds()", "function", key),
                        buildItem("setUTCMonth()", "function", key),
                        buildItem("setYear()", "function", key),
                        buildItem("toDateString()", "function", key),
                        buildItem("toGMTString()", "function", key),
                        buildItem("toLocaleDateString()", "function", key),
                        buildItem("toLocaleTimeString()", "function", key),
                        buildItem("toLocaleString()", "function", key),
                        buildItem("toString()", "function", key),
                        buildItem("toUTCString()", "function", key),
                        buildItem("toTimeString()", "function", key),
                        buildItem("UTC()", "function", key)
                    ];
                    break;
                }
                case "Number.prototype": {
                    list = [
                    buildItem("toExponential()", "function", key),
                        buildItem("toFixed()", "function", key),
                        buildItem("toPrecision()", "function", key),
                        buildItem("toString()", "function", key)
                ]
                    ;
                    break;
                }
                case "Boolean.prototype": {
                    list = [
                        buildItem("toString()", "function", key)
                    ];
                    break;
                }
                case "Function.prototype": {
                    list = [
                        buildItem("toString()", "function", key),
                        buildItem("call()", "function", key),
                        buildItem("apply()", "function", key)
                    ];
                    break;
                }
                case "RegExp.prototype": {
                    list = [
                        buildItem("global", "property", key),
                        buildItem("ignoreCase", "property", key),
                        buildItem("multiline", "property", key),
                        buildItem("lastIndex", "property", key),
                        buildItem("source", "property", key),
                        buildItem("compile()", "function", key),
                        buildItem("exec()", "function", key),
                        buildItem("test()", "function", key)
                    ];
                    break;
                }
                case "String.prototype": {
                    list = [
                        buildItem("length", "property", key),
                        buildItem("charAt()", "function", key),
                        buildItem("charCodeAt()", "function", key),
                        buildItem("concat()", "function", key),
                        buildItem("fromCharCode()", "function", key),
                        buildItem("indexOf()", "function", key),
                        buildItem("lastIndexOf()", "function", key),
                        buildItem("match()", "function", key),
                        buildItem("replace()", "function", key),
                        buildItem("search()", "function", key),
                        buildItem("slice()", "function", key),
                        buildItem("split()", "function", key),
                        buildItem("substr()", "function", key),
                        buildItem("substring()", "function", key),
                        buildItem("toLowerCase()", "function", key),
                        buildItem("toUpperCase()", "function", key)
                    ];
                    break;
                }
                case "Object.prototype": {
                    list = [
                        buildItem("toString()", "function", key, 0, 0, 0, 'z'),
                        buildItem("toLocaleString()", "function", key, 0, 0, 0, 'z'),
                        buildItem("hasOwnProperty(key)", "function", key, 0, 0, 0, 'z'),
                        buildItem("propertyIsEnumerable(key)", "function", key, 0, 0, 0, 'z'),
                        buildItem("isPrototypeOf(obj)", "function", key, 0, 0, 0, 'z')
                    ];
                    break;
                }
                default: {
                    if (/\.prototype$/.test(key)) {
                        // [[[[[ bak
                        var bak = ood.Dom.pack,
                            bak1 = ood.absProfile.prototype.$link,
                            bak11 = ood.absObj.$pickAlias;

                        ood.Dom.pack = function () {
                            var o = new ood.Dom(false), d = document.getElementById('abc');
                            o._nodes = [d];
                            return o
                        };
                        ood.absProfile.prototype.$link = function () {
                            return this;
                        };
                        ood.absObj.$pickAlias = function () {
                            return ns._alias++
                        };
                        // ]]]]]
                        try {
                            var target = eval("new " + key.replace(/\.prototype$/, ''));
                            list = ns._enumKeys(target, key);
                        } catch (e) {
                        } finally {
                            //[[[[[ restore
                            ood.Dom.pack = bak;
                            ood.absProfile.prototype.$link = bak1;
                            ood.absObj.$pickAlias = bak11;
                            //]]]]]
                        }
                    }

                    if (!list.length) {
                        var target = ood.get(window, key.split("."));
                        list = ns._enumKeys(target, key);
                        cachedata = false;
                    }
                }
            }

            if (cachedata)
                cache[key] = list;

            return list;
        },


        _getFromFunctionExp: function (code) {
            var type;
            if (/toString\([^)]*\)$/.test(code))
                type = 'String.prototype';
            // functions patterns
            else if (/^\s*\(?\s*new\s+([\wood.]+)\s*\(?\s*[^)]*\)?\s*\)?(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/.test(code)) {
                code = code.replace(/^\s*\(?\s*new\s+([\wood.]+)\s*\(?\s*[^)]*\)?\s*\)?(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/, "$1");
                type = code + '.prototype';
            }
            else if (/.*\.reBoxing\(([^)]*)\)(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/.test(code)) {
                code = code.replace(/.*\.reBoxing\(([^)]*)\)(\s*\.\s*(set|on|before|after)[\w]+\s*\([^)]*\)\s*)*$/, "$1");
                if (code)
                    type = code.replace(/[\'\"]/g, "") + '.prototype';
                else
                    type = 'ood.Dom.prototype';
            }
            else if (code.indexOf("ood.alert(") == 0 || code.indexOf("ood.prompt(") == 0 || code.indexOf("ood.pop(") == 0 || code.indexOf("ood.confirm(") == 0)
                type = 'ood.UI.Dialog.prototype';
            else if (code.indexOf("ood(") == 0 || code.indexOf("ood.use(") == 0)
                type = 'ood.Dom.prototype';
            else if (code.indexOf("ood.Thread(") == 0 || code.indexOf("ood.Ajax(") == 0
                || code.indexOf("ood.SAjax(") == 0 || code.indexOf("ood.IAjax(") == 0
                || code.indexOf("ood.JSONP(") == 0 || code.indexOf("ood.XDMI(") == 0)
                type = 'ood.Thread.prototype';
            else if (/.*\.(getRoot|getSubNode|getSubNodes)\s*\(\s*[^\)]*\)\s*$/.test(code))
                type = 'ood.Dom.prototype';
            else if (/.*\.getElementById\s*\(\s*[^\)]*\)\s*$/.test(code))
                type = 'Element.prototype';
            return type;
        },
        _getFromObject: function (target) {
            if (!ood.isSet(target))
                return null;
            else if (target === ood.str)
                return "ood.str";
            else if (target === ood.arr)
                return "ood.arr";
            else if (target === ood)
                return "ood";
            else if (target.$ood$) {
                if (typeof target == 'function')
                    return target.KEY;
                else
                    return target.KEY + ".prototype";
            } else if (ood.isArr(target))
                return "Array.prototype";
            else if (ood.isDate(target))
                return "Date.prototype";
            else if (ood.isReg(target))
                return "RegExp.prototype";
            else if (ood.isNumb(target))
                return "Number.prototype";
            else if (ood.isStr(target))
                return "String.prototype";
            else if (ood.isBool(target))
                return "Boolean.prototype";
            else if (ood.isFun(target))
                return "Function.prototype";
            else if (ood.isObj(target)) {
                return "Object.prototype";
            }
            // dont use ood.isHash here
        },
        _findVars: function (profile, tonode, braceId) {
            var ns = this,
                cm = profile.$editor,
                arr = [];
            if (cm && tonode) {
                var doc = cm.win.document,
                    isBr = function (elem) {
                        return elem.tagName == "BR" || elem.tagName == "br"
                    },
                    isB = function (elem) {
                        return elem.tagName == "B" || elem.tagName == "b"
                    },
                    elem = doc.body.firstChild,
                    scope = "",
                    cls, txt, temp = [], cursor;

                cursor = arr;

                cursor.push(["this", ""]);

                while ((elem = elem.nextSibling) && elem != tonode) {
                    if (isB(elem) && elem._uid && elem.id.charAt(0) == 'b') {
                        // if sibling {, jump to it's }
                        if (!braceId || braceId.indexOf(elem.id) !== 0) {
                            elem = doc.getElementById('e' + elem.id.slice(1));
                        } else {
                            scope = elem._uid;
                            // reset scope
                            ood.arr.each(temp, function (o) {
                                o[1] = scope;
                            });
                            arr = arr.concat(temp);
                        }
                        temp = [];
                        cursor = arr;
                    }

                    cls = ns.__trim(elem.className);
                    txt = ns.__trim(elem.currentText);

                    if (cls == 'js-keyword' && txt == "function") {

                        // find "function abc(){}"
                        while ((elem = elem.nextSibling) && elem != tonode && (isBr(elem) || ns.__trim(elem.className) == "whitespace" || ns.__trim(elem.className) == "js-comment")) ;
                        cls = ns.__trim(elem.className);
                        txt = ns.__trim(elem.currentText);
                        if (cls == 'js-variabledef') {
                            cursor.push([txt, scope]);
                        }

                        // temp find
                        cursor = temp;
                        cursor.push(["this", scope]);
                    }

                    if (cls == 'js-variabledef')
                        cursor.push([txt, scope]);
                }
            }
            return arr;
        },

        _$key: function (key) {
            ns = this;
            list = [
                ns._buildItem("$currPerson", 0, 0, 0, "$currPerson", "$currPerson", 5),
                ns._buildItem("$currPerson.name", 0, 0, 0, "name", "name", 5)
            ]
            if (key == '$') {
                ood.Ajax("/admin/el/searchKey", {
                    projectName: SPA.curProjectName
                }, function (txt) {
                    var obj = txt;
                    if (!obj || obj.error) {
                        ood.message("No module in this project!");
                    } else {
                        ood.arr.each(obj.data, function (o) {
                            var item = ns._buildItem(o.id, 0, 0, 0, o.desc, o.expression, 5);
                            list.push(item);
                        });
                    }
                }, null, null, {method: 'post', asy: false}).start();
            }
            ;
            if (ood.str.startWith(key, '$') && ood.str.endWith(key, ".")) {
                ood.Ajax("/admin/el/searchMethod", {
                    projectName: SPA.curProjectName,
                    key: key
                }, function (txt) {
                    var obj = txt;
                    if (!obj || obj.error) {
                        ood.message("No module in this project!");
                    } else {
                        ood.arr.each(obj.data, function (o) {
                            var item = ns._buildItem(o.id, 0, 0, 0, o.desc, o.lastStr, 5);
                            list.push(item);
                        });
                    }
                }, null, null, {method: 'post', asy: false}).start();

            }
            ;
            return list;
        },

        _getIntellisense: function (profile, key, index, nolist) {
            var ns = this,
                _this = RAD.ClassTool._this;


            // get type

            if (ood.str.startWith(key, '$')) {
                type = "$";
            } else {
                if (key.indexOf('new ') == 0) {
                    type = 'new';
                } else if (key.charAt(key.length - 1) == '.') {
                    type = "properties";
                    key = key.slice(0, -1);
                } else {
                    if (key.indexOf('.') != -1) {
                        type = "properties";
                        key = key.slice(0, key.lastIndexOf('.'));
                    } else {
                        // return avialable var
                        type = "var";
                    }
                }
                if (type == "properties") {
                    if (key.indexOf('(') != -1) {
                        type = "function";
                    }
                }
            }


            var target, code,
                list = [],
                // object type string
                otype,
                // object code string
                ocode,
                // extra array
                oextra = [];
            switch (type) {
                case 'new':
                    otype = type;
                    break;
                case '$':
                    list = this._$key(key);
                    break;
                case "function":
                    type = ns._getFromFunctionExp(key);
                    if (type) {
                        otype = type;
                        break;
                    }
                case "properties":
                    if (key == "arguments" || key == "arguments.callee") {
                        otype = key;
                        break;
                    } else {
                        // try exec all code dir
                        var arrcode = [],
                            vars = [],
                            code = profile.$cm.getValue(),
                            allcode = RAD.ClassTool.getContextAssignments(code, index),
                            struct = RAD.ClassTool.getClassStructWithScope(code, index, ns.$temppool, profile.$xid);

                        arrcode.push("(function(){try{\n");
                        arrcode.push("var " + _this + "=window;\n");
                        vars.push(_this);
                        var added1 = false, added2 = false,
                            len = allcode.vars.length;
                        for (var i = 0; i < len; i++) {
                            arrcode.push("var " + allcode.vars[i] + "=undefined;\n");
                            vars.push(allcode.vars[i]);
                        }
                        // run once at least
                        for (var i = -1; i < len; i++) {
                            // no assignment, or assignment is in special scope
                            if (allcode.scopeS == -1 || i >= allcode.scopeS) {
                                // add only once
                                if (!added1) {
                                    added1 = true;
                                    var o;
                                    // get scope info
                                    if (allcode.secondKey && allcode.secondType == "function") {
                                        o = ood.get(struct, ['sub', allcode.firstKey, 'sub', allcode.secondKey]);
                                    } else if (allcode.firstKey && allcode.firstType == "function") {
                                        o = ood.get(struct, ['sub', allcode.firstKey]);
                                    }
                                    if (o) {
                                        // add scope code
                                        arrcode.push("try{" + _this + "=" + o._this + "}catch(e){};\n");
                                        // add args code
                                        ood.arr.each(o.argsv, function (arg, i) {
                                            // no matching argument
                                            if (!o.args || !o.args[i]) return false;

                                            // use dynamic code first
                                            if (arg.code) {
                                                arrcode.push("try{" + o.args[i] + "=" + arg.code + "}catch(e){};\n");
                                                vars.push(o.args[i]);
                                            } else {
                                                if (/\.prototype$/.test(arg.type)) {
                                                    arrcode.push("try{" + o.args[i] + "=" + arg.type.replace(/(.+)(\.prototype)$/, "new $1();") + "}catch(e){};\n");
                                                    vars.push(o.args[i]);
                                                } else {
                                                    arrcode.push("try{" + o.args[i] + "=" + arg.type + "}catch(e){};\n");
                                                    vars.push(o.args[i]);
                                                }
                                            }
                                        });
                                    }
                                }
                            }
                            // out of special scope
                            if (allcode.scopeS != -1 && i >= allcode.scopeE) {
                                if (!added2) {
                                    added2 = true;
                                    arrcode.push("try{" + _this + "=window;}catch(e){};\n");
                                }
                            }
                            // ignore when i is -1
                            if (i >= 0) {
                                arrcode.push("try{" + allcode.vars[i] + "=" + allcode.code[i] + ";}catch(e){};\n");
                                vars.push(allcode.vars[i]);
                            }
                        }
                        if (allcode.scopeS != -1 && allcode.outscope) {
                            if (!added2) {
                                arrcode.push("try{" + _this + "={};}catch(e){};\n");
                            }
                        }

                        arrcode.push("return (" + key + ");\n}catch(e){}finally{\n");
                        ood.arr.removeValue(vars, key);
                        arrcode.push(vars.join("=") + "=null;\n");
                        arrcode.push("}\n}).call({});\n");
                        ocode = arrcode.join('').replace(/\bthis\b/g, _this);
//console.log(ocode);
                    }
                    break;
                case "var":
                    otype = " variables ";

                    // caching according to line
                    /*
                    var hash,cache=ns.__varscache||(ns.__varscache={});
                    if(cache[index]){
                        hash=cache[index];
                    }else{
                        cache=ns.__varscache={};
                        cache[index]=hash=RAD.ClassTool.getContextVars(profile.$cm.getValue(),index);
                    }
                   */
                    var hash = RAD.ClassTool.getContextVars_fast(profile.$cm, index);

                    if (hash["this"]) {
                        oextra.push(ns._buildItem("this", 0, 0, 0, 0, 0, 1, "color:#ff0000;"));
                        delete hash["this"];
                    }
                    if (hash["arguments"]) {
                        oextra.push(ns._buildItem("arguments", 0, 0, 0, 0, 0, 1, "color:#ff0000;"));
                        delete hash["arguments"];
                    }

                    ood.each(hash, function (o, i) {
                        oextra.push(ns._buildItem(i, "var", 0, 0, 0, 0, 1, "color:#666;"));
                    });
                    break;
            }
            // from extra array
            if (oextra && oextra.length) {
                if (!nolist)
                    Array.prototype.push.apply(list, oextra);
            }
            // then "from code"
            if (ocode) {
                result = ns.evalInSandbox(ocode, false, null, profile.$xid);
                if (ood.isSet(result.ok)) {
                    // if result.type exists, igonre result.ok
                    if (result.type)
                        otype = result.type;
                    else {
                        otype = ns._getFromObject(result.ok);
                        if (!nolist)
                            Array.prototype.push.apply(list, ns._enumKeys(result.ok, otype, true, true));
                    }
                }
            }
            // the last one is "from type"
            if (otype) {
                if (!nolist)
                    Array.prototype.push.apply(list, ns._getIntellisenseList(otype));
            }

            if (list.length) {
                list = ood.arr.removeDuplicate(list, 'id');

                ood.arr.stableSort(list, function (x, y) {
                    return x.tag > y.tag ? 1 : x.tag == y.tag ? 0 : -1;
                });
            }

            return [otype, list, key];
        },
        _loadEditor: function (profile) {
            var ns = this,
                _this = RAD.ClassTool._this;

            // is suggestion window showed
            var $suggestionShowed = false,
                $suggestionBaseScope = null,
                $suggestionBaseScopeShadow = null,
                showSuggetionID = "CodeEditor.showSuggetion.resetRun",
                adjustSuggetionID = "CodeEditor.adjustSuggetion.resetRun",
                $currentText = "",
                $willshowDotHint = false,
                // suggestion window for
                $activeWord;

            // get short Suggestion code
            var getShortContentCode = function (index) {
                var reg = /\s+/g,
                    arr = [],
                    extxt = "",
                    cm = profile.$cm,
                    pos = cm.doc.posFromIndex(index),
                    line = pos.line,
                    elem = cm.getTokenAt(pos),
                    prev = function (elem) {
                        if (elem.start === 0) {
                            pos.line--;
                            if (pos.line === 0) {
                                return null;
                            }
                            var line = cm.doc.getLine(pos.line);
                            if (line) {
                                pos.ch = line.length;
                            } else {
                                return null;
                            }
                        } else {
                            pos.ch = elem.start;
                        }
                        return cm.getTokenAt(pos);
                    };

                // for dblclick case, find key text
                if (!(elem.type === null && elem.string == ".")) {
                    extxt = ns.__trim(elem.string);
                    elem = prev(elem);
                }
                // for dot case
                if (elem && (elem.type === null && elem.string == ".")) {
                    do {
                        if (elem.type === null && elem.string == ".") {
                            // ignore space and comments
                            while (elem = prev(elem)) {
                                if (!(!elem || elem.type == "comment" || elem.type == "tab" || (elem.type === null && /^\s+$/.test(elem.string)))) {
                                    break;
                                }
                            }
                            if (elem) {
                                // for (xxx)
                                var con1 = "";
                                if (elem.type === null && elem.string === ")") {
                                    var deep1 = 0;
                                    do {
                                        if (elem.type === null && elem.string === ")")
                                            deep1++;
                                        if (elem.type === null && elem.string === "(")
                                            deep1--;
                                        if (elem.string)
                                            con1 = elem.string + con1;
                                    } while ((elem = prev(elem)) && deep1 !== 0)
                                }
                                if (elem) {
                                    if (elem.type == "property" || elem.type == 'variable' || elem.type == 'variable-2'
                                        || elem.type == 'oodglobal'
                                        || (elem.type == "keyword" && elem.string == "this")) {
                                        arr.push(elem.string.replace(reg, '') + con1);
                                    } else if (con1) {
                                        arr.push(con1);
                                    } else {
                                        break;
                                    }

                                }
                            }
                        } else {
                            break;
                        }
                    } while (elem = prev(elem))
                }
                // for space case
                else if (elem && (elem.type == null && elem.string === " ")) {
                    // ignore space and comments
                    while (elem = prev(elem)) {
                        if (!(!elem || elem.type == "comment" || (elem.type == null && elem.string === " "))) {
                            break;
                        }
                    }
                    if (elem.type == "keyword" && elem.string == "new") {
                        extxt = "new " + extxt;
                    }
                }

                return (arr.length ? (arr.reverse().join('.') + '.') : "") + extxt;
            };

            var iniComponents = function () {
                // [[Code created by ESDUI RAD Studio
                var host = this, children = [], append = function (child) {
                    children.push(child.get(0))
                };

                append(
                    (new ood.UI.Pane)
                        .setHost(host, "$popList")
                        .setLeft(10)
                        .setTop(10)
                        .setWidth(300)
                        .setHeight(180)
                );

                host.$popList.append(
                    (new ood.UI.List)
                        .setHost(host, "$lstsug")
                        .setTheme("codemirror")
                        .setDirtyMark(false)
                        .setTop(18)
                        .setWidth(300)
                        .setHeight(162)
                        .setItemRow(true)
                        .setDisableHoverEffect(true)
                );

                host.$popList.append(
                    (new ood.UI.Block)
                        .setHost(host, "block1")
                        .setLeft(0)
                        .setTop(0)
                        .setWidth(300)
                        .setHeight(24)
                        .setBorderType("flat")
                );

                host.block1.append(
                    (new ood.UI.Label)
                        .setHost(host, "$objType")
                        .setLeft(6)
                        .setTop(2)
                        .setWidth(252)
                        .setCaption("")
                        .setHAlign("left")
                        .setCustomStyle({KEY: 'font-weight:bold;'})
                );

                append(
                    (new ood.UI.Block)
                        .setHost(host, "$popHelp")
                        .setLeft(410)
                        .setTop(10)
                        .setWidth(300)
                        .setHeight(180)
                        .setBorderType("flat")
                        .setOverflow('hidden')
                        .setBackground("#FFF8DC")
                );

                host.$popHelp.append(
                    (new ood.UI.Div)
                        .setHost(host, "$divhelp")
                        .setTheme("codemirror")
                        .setLeft(-1)
                        .setTop(19)
                        .setWidth(300)
                        .setHeight(160)
                        .setCustomStyle({"KEY": "overflow:auto; padding:4px;"})
                );

                host.$popHelp.append(
                    (new ood.UI.Block)
                        .setHost(host, "block3")
                        .setLeft(-1)
                        .setTop(-1)
                        .setWidth(300)
                        .setHeight(20)
                        .setBorderType("flat")
                );

                host.block3.append(
                    (new ood.UI.Link)
                        .setHost(host, "$linkAPI")
                        .setLeft('auto')
                        .setRight(2)
                        .setTop(1)
                        .setCaption("$RAD.JSEditor.clickapi")
                );

                host.block3.append(
                    (new ood.UI.Label)
                        .setHost(host, "$lblTips")
                        .setLeft(6)
                        .setTop(2)
                        .setWidth(133)
                        .setCaption("")
                        .setHAlign("left")
                );

                return children;

                // ]]Code created by ESDUI RAD Studio
            };

            var handle = {
                moveFocus: function (step) {
                    var list = profile.$lstsug,
                        items = list.get(0).properties.items,
                        length = items.length,
                        value = list.getUIValue(),
                        index = ood.arr.subIndexOf(items, 'id', value);
                    if (step === true) {
                        index = 0;
                    } else if (step === false) {
                        index = length - 1;
                    } else {
                        index += step;
                        if (index < 0) index = 0;
                        if (index > length - 1) index = length - 1;
                    }
                    if (items[index])
                        list.setUIValue(items[index].id, true);
                },
                close: function () {
                    hideSuggestion();
                },
                pick: function () {
                    var list = profile.$lstsug,
                        items = list.get(0).properties.items,
                        length = items.length,
                        value = list.getUIValue(),
                        index = ood.arr.subIndexOf(items, 'id', value);

                    if (items[index])
                        applySuggestion(items[index].value || items[index].caption);
                    hideSuggestion();
                }
            };
            var keyMap = {
                Up: function () {
                    handle.moveFocus(-1);
                },
                Down: function () {
                    handle.moveFocus(1);
                },
                PageUp: function () {
                    handle.moveFocus(-8, true);
                },
                PageDown: function () {
                    handle.moveFocus(8, true);
                },
                Home: function () {
                    handle.moveFocus(true);
                },
                End: function () {
                    handle.moveFocus(false);
                },
                Enter: function () {
                    handle.pick();
                },
                Tab: function () {
                    handle.pick();
                },
                Esc: function () {
                    handle.close();
                }
            };
            // show suggestion
            var showSuggestion = function (key, index, fromDot, dftTxt) {
                // get intellisense

                var rtn = profile.box._getIntellisense(profile, key, index),
                    keyword = rtn[0], ns = this,
                    items = rtn[1];
                dftTxt = dftTxt || key || "";

                if (!keyword && !(items && items.length)) {
                    hideSuggestion();
                    return;
                }


                if (!fromDot) {
                    var found = false, str = dftTxt.toLowerCase();
                    ood.arr.each(items, function (item) {
                        if (ood.str.startWith(item.id.toLowerCase(), str)) {
                            found = true;
                            return false;
                        }
                    });
                    if (!found) {
                        return;
                    }
                }
                var coordinates = cm.cursorCoords(true, "page"),
                    left = coordinates.left,
                    top = coordinates.top;

                if (!profile.$popList) {
                    iniComponents.call(profile);
                    ood('body').append(profile.$popList.setDisplay('none'));
                    ood('body').append(profile.$popHelp.setDisplay('none'));

                    profile.$divhelp.getRoot().setSelectable(true);

                    profile.$linkAPI.onClick(function (p) {
                        CONF.openAPI(p.properties.tag);
                    });
                    var out = true,
                        tryToClose = function () {
                            ood.resetRun("codemirror:aaa", function () {
                                if (out && profile.$popCustom) {
                                    profile.$popCustom.setDisplay('none');
                                }
                            });
                        };

                    profile.$lstsug.afterUIValueSet(function (profile, ov, v) {
                        showTips2(profile.getItemByItemId(v));
                    })
                        .onClick(function (profile, item) {
                            applySuggestion(item.value || item.caption);
                            hideSuggestion();
                        });
                }

                if ((items && items.length) || fromDot) {
                    $suggestionShowed = fromDot ? 1 : true;
                    if (items && items.length) {
                        profile.$lstsug.setItems(items);
                    }
                    var fun = function () {
                            hideSuggestion();
                        },
                        group = ood([profile.$popList.getRootNode(), profile.$popHelp.getRootNode(), profile.getSubNode("BOX").get(0)]);

                    profile.$popList.getRoot().popToTop({
                        region: {
                            left: left,
                            top: top,
                            width: 2,
                            height: 16
                        }
                    }, 1)
                        .setBlurTrigger(showSuggetionID, fun, group);
                    ood.Event.keyboardHook('esc', 0, 0, 0, fun);

                    profile.$popList.setDisplay('');

                    $activeWord = rtn[2] || null;

                    if (items && items.length) {
                        adjustSuggetion(left, top, dftTxt, "", true, true);
                    }
                }

                profile.$objType.setCaption(keyword || "none");

                // remove first
                profile.$cm.removeKeyMap(keyMap);
                profile.$cm.addKeyMap(keyMap);
            };

            // hide suggestion
            var hideSuggestion = function () {
                ood.Event.keyboardHook('esc', 0, 0, 0);

                profile.$cm.removeKeyMap(keyMap);

                ood.resetRun(showSuggetionID);
                ood.resetRun(adjustSuggetionID);

                $suggestionBaseScope = null;
                $suggestionBaseScopeShadow = null;
                $suggestionShowed = false;
                $willshowDotHint = false;

                if (profile.$popList) {
                    profile.$objType.setCaption('');
                    profile.$lstsug.setItems([]).setUIValue(null);
                    profile.$popList.setDisplay('none');

                    profile.$lblTips.setCaption('');
                    profile.$divhelp.setHtml("");
                    profile.$popHelp.setDisplay('none');

                    if (profile.$popCustom)
                        profile.$popCustom.setDisplay('none');

                    $currentText = null;
                }
            };

            // adjust selection and position for suggestion win
            var adjustSuggetion = function (left, top, txt, extxt, forVisibleOnly, asnyc) {
                if (!profile.$lstsug) return;
                var prf = profile.$lstsug.get(0),
                    items = prf.properties.items,
                    f = function () {
                        if (forVisibleOnly && !$suggestionShowed) return;

                        var fid;
                        if (extxt) txt += extxt;
                        if (!ood.isSet($currentText) || txt !== $currentText) {
                            $currentText = txt;
                            // try to find startWith
                            ood.arr.each(items, function (item) {
                                if (ood.str.startWith(item.id.toLowerCase(), $currentText.toLowerCase())) {
                                    fid = item.id;
                                    return false;
                                }
                            });
                            // try to find similiar
                            while (!fid && txt.length) {
                                txt = txt.substring(0, txt.length - 1);
                                if (!txt) break;
                                ood.arr.each(items, function (item) {
                                    if (ood.str.startWith(item.id.toLowerCase(), txt.toLowerCase())) {
                                        fid = item.id;
                                        return false;
                                    }
                                });
                            }
                            // the frist one
                            if (!fid) {
                                fid = items[0].id;
                            }
                        }
                        if (!prf.properties.$UIvalue && !fid && prf.properties.items && prf.properties.items.length)
                            fid = prf.properties.items[0].id;
                        if (fid)
                            prf.boxing().setUIValue(fid);
                        else {
                            hideSuggestion();
                            return;
                        }

                        // POSITION
                        profile.$popList.getRoot().popToTop({
                            region: {
                                left: left,
                                top: top,
                                width: 2,
                                height: 16
                            }
                        }, 1)
                        if (profile.$popHelp && profile.$popHelp.getDisplay() != 'none') {
                            profile.$popHelp.getRoot().popToTop(profile.$popList.getRoot(), 2)
                        }
                    };
                if (!asnyc)
                    f();
                else
                    ood.resetRun(adjustSuggetionID, f, 100);
            };

            var showTips = function (key, str) {
                if (!profile.$popHelp) return;
                if (profile.$popList.getDisplay() != 'none') {
                    profile.$linkAPI.setTag(key);
                    profile.$lblTips.setCaption(key);

                    profile.$divhelp.setHtml(str);
                    profile.$popHelp.getRoot().popToTop(profile.$popList.getRoot(), 2)
                    profile.$popHelp.setDisplay('');
                }
            };
            var hideTips = function (key, str) {
                if (!profile.$popHelp) return;

                profile.$linkAPI.setTag(null);
                profile.$lblTips.setCaption("");
                profile.$divhelp.setHtml("");
                profile.$popHelp.setDisplay("none");
            };
            // show tips
            var showTips1 = function (elem) {
                if (!profile.$popHelp) return;
                var key = getShortContentCode(elem);
                var str = profile.onGetHelpInfo && profile.boxing().onGetHelpInfo(profile, key.key);
//                if(!str)
//                    str=key.key;
                if (str) {
                    showTips(key.key, str);
                } else {
                    hideTips();
                }
            };
            var showTips2 = function (item) {
                if (!profile.$popHelp) return;
                if (!item) return;
                var str = profile.onGetHelpInfo && profile.boxing().onGetHelpInfo(profile, item.path);
//                if(!str)
//                   str=item.path;
                if (str) {
                    showTips(item.path, str);
                } else {
                    hideTips();
                }
            };

            // show Intellisense  from dot
            var showDotHint = function (index, scope, dftTxt, scopyShadow) {
                $suggestionBaseScope = $suggestionBaseScopeShadow = null;
                // hide list first
                //hideSuggestion();
                $willshowDotHint = true;
                ood.resetRun(showSuggetionID, function () {
                    var key = getShortContentCode(index);
                    if (!key) {
                        hideSuggestion();
                    } else {
                        $willshowDotHint = false;

                        if (key != dftTxt)
                            showSuggestion(key, index, true, dftTxt);
                    }
                }, 100);
                $suggestionBaseScope = scope;
                $suggestionBaseScopeShadow = scopyShadow;
            };
            // show vars hint
            var showVarsHint = function (key, index, scope) {
                ood.resetRun(showSuggetionID, function () {
                    showSuggestion(key, index);
                });
                // refresh
                $suggestionBaseScope = scope;
            };
            // show vars hint
            var tryToAdjustHint = function (key, index, scope) {
                var sc = $suggestionBaseScopeShadow || $suggestionBaseScope;
                if (sc && sc.line == scope.line && sc.start == scope.start) {
                    var coordinates = cm.cursorCoords(true, "page"),
                        left = coordinates.left,
                        top = coordinates.top;
                    adjustSuggetion(left, top, key, "", true);
                }
                // refresh
                $suggestionBaseScope = scope;
            };
            // apply suggestion to code
            var applySuggestion = function (value) {
                var editor = profile.$cm, o = $suggestionBaseScope;
                editor.replaceRange(value,
                    {line: o.line, ch: o.start},
                    {line: o.line, ch: o.end});

                // indentat multi line
                var line = o.line, hasE;
                value.replace(/\n/g, function () {
                    editor.indentLine(++line);
                    hasE = 1;
                });
                editor.setCursor({line: o.line + (hasE ? 1 : 0), ch: o.start + value.length});
                editor.execCommand("indentAuto");
            };
            var codeType = profile.properties.codeType,
                mode = CONF.getRenderMode(profile.properties.codeType);
            if (!mode) mode = CONF.getRenderMode("txt");

            // load codemirror
            var options = {
                value: profile.properties.value || "",
                smartIndent: true,
                indentUnit: 4,
                tabSize: 4,
                indentWithTabs: false,
                "mode": mode.mime,
                keyMap: "sublime",

                matchBrackets: true,
                continueComments: "Enter",
                autoCloseBrackets: true,
                lineNumbers: true,
                lint: (codeType == 'js' || codeType == 'json' || codeType == 'css' || codeType == 'html') ? true : false,
                readOnly: profile.properties.readonly,
                styleActiveLine: true,
                lineWrapping: false,
                flattenSpans: false,
                highlightSelectionMatches: {showToken: /^[$\w]\w*/},
                foldGutter: true,
                gutters: ["CodeMirror-lint-markers", "CodeMirror-linenumbers", "CodeMirror-foldgutter"],
                extraKeys: {
                    'Ctrl': function () {
                        hideSuggestion();
                    },
                    "Ctrl-Q": function (cm) {
                        cm.foldCode(cm.getCursor());
                    },
                    "Ctrl-S": function () {
                        hideSuggestion();
                        if (profile.onSaveCommand)
                            profile.boxing().onSaveCommand(profile);
                    },
                    "Ctrl-F": function (cm) {
                        hideSuggestion();
                        RAD.EditorTool.showFindWnd(null,profile.boxing(), {left: 0, top: 0}, cm.getSelection());
                    },
                    "Tab": function (cm) {
                        if (cm.doc.somethingSelected()) return CodeMirror.Pass;
                        var spaces = Array(cm.getOption("indentUnit") + 1).join(" ");
                        cm.replaceSelection(spaces, "end", "+input");
                    },
                    "Ctrl-D": function (cm) {
                        cm.execCommand("deleteLine");
                    }
                }
            };

            var obj = CONF.getStatus(),
                editorTheme = obj.editorTheme,
                editorFontSize = obj.editorFontSize,
                lineWrapping = obj.lineWrapping;

            if (editorTheme) {
                // include CSS first
                profile.boxing().addCMTheme(editorTheme);
                options.theme = editorTheme;
            }
            if (ood.isSet(lineWrapping)) {
                options.lineWrapping = !!lineWrapping;
            }

            var cm = profile.$cm = new CodeMirror(function (elt) {
                profile.getSubNode('BOX').append(elt);

                if (editorFontSize)
                    elt.style.fontSize = editorFontSize + "px";
            }, options);

            //cm.setOption("mode", mode);
            CodeMirror.modeURL = "/plugins/codemirror5/mode/%N/%N.js";

            CodeMirror.autoLoadMode(cm, mode.mode);

            if (profile.onCodeModeSet) {
                ood.asyRun(function () {
                    if (!profile.box) return;
                    profile.boxing().onCodeModeSet(profile, mode);
                });
            }

            if (mode.mode == "null") {
                if (!profile.$initialized)
                    profile.$initialized = true;
                if (profile.onRendered)
                    profile.boxing().onRendered(profile, true);
            } else {
                cm.on("rendered", function (cm, finished) {
                    if (!profile.$initialized)
                        profile.$initialized = true;
                    if (profile.onRendered)
                        profile.boxing().onRendered(profile, finished);
                });
            }
            cm.on("change", function (cm, obj) {
                if (profile.$initialized && profile.onValueChanged)
                    profile.boxing().onValueChanged(profile, cm.doc.getValue() != profile.properties.value);
                if (codeType != 'js' && codeType != 'html') return;

                var handled;
                if (obj.origin == "+input") {
                    // igore redo/undo
                    if (obj.text[0]) {
                        if (obj.text[0] == ".") {
                            // only for js file
                            if (codeType != 'js') return;

                            obj.to.ch++;
                            var token = cm.getTokenAt(obj.to), type = token.type;
                            if (type !== null)
                                return;
                            // show suggestion hint for : token.string
                            var pos = cm.getCursor();
                            showDotHint(cm.doc.indexFromPos(pos), {
                                start: ++token.start,
                                end: ++token.end,
                                line: pos.line
                            });
                            handled = true;
                        } else if (obj.text[0] !== " ") {
                            obj.to.ch++;
                            var token = cm.getTokenAt(obj.to), type = token.type;
                            if (type == "variable" || type == "variable-2" || type == "keyword" || type == "property") {
                                var pos = cm.getCursor();
                                if (pos.line == obj.to.line && pos.ch >= token.start && pos.ch <= token.end) {
                                    if ($suggestionShowed)
                                        tryToAdjustHint(token.string, cm.doc.indexFromPos(pos), {
                                            start: token.start,
                                            end: token.end,
                                            line: pos.line
                                        });
                                    else {
                                        if (type == 'property') {
                                            // only for js file
                                            if (codeType != 'js') return;
                                            var t2 = cm.getTokenAt({
                                                line: obj.to.line,
                                                ch: obj.to.ch - token.string.length
                                            });
                                            if (t2.type !== null || t2.string !== '.')
                                                return;
                                            // show suggestion hint for : token.string
                                            showDotHint(cm.doc.indexFromPos(pos) - obj.text.length - 1, null, token.string, {
                                                start: ++t2.start,
                                                end: ++t2.end,
                                                line: pos.line
                                            });
                                        } else {
                                            showVarsHint(token.string, cm.doc.indexFromPos(pos), {
                                                start: token.start,
                                                end: token.end,
                                                line: pos.line
                                            });
                                        }
                                    }
                                    handled = true;
                                }
                            }
                        }
                    }
                } else if (obj.origin == "+delete") {
                    if ($suggestionShowed) {
                        var token = cm.getTokenAt(obj.to), type = token.type, str = token.string;
                        if ($suggestionShowed === true) {
                            if (type == "variable" || type == "variable-2" || type == "keyword") {
                                var pos = cm.getCursor();
                                if (pos.line == obj.to.line && pos.ch >= token.start && pos.ch <= token.end) {
                                    tryToAdjustHint(token.string, cm.doc.indexFromPos(pos), {
                                        start: token.start,
                                        end: token.end,
                                        line: pos.line
                                    });
                                    handled = true;
                                }
                            }
                        } else if ($suggestionShowed === 1) {
                            if (type == "property") {
                                var pos = cm.getCursor();
                                tryToAdjustHint(token.string, cm.doc.indexFromPos(pos), {
                                    start: token.start,
                                    end: token.end,
                                    line: pos.line
                                });
                                handled = true;
                            } else if (type === null && str == ".") {
                                var pos = cm.getCursor();
                                showDotHint(cm.doc.indexFromPos(pos), {
                                    start: ++token.start,
                                    end: ++token.end,
                                    line: pos.line
                                });
                                handled = true;
                            }
                        }
                    }
                }
                if (!handled) {
                    //if hint/hint2 showed, hide it
                    hideSuggestion();
                }
            });
            cm.on("blur", function () {
                //hideSuggestion();
            });
            cm.on("keypress", function (cm, key) {
                if (codeType != 'js' && codeType != 'html') return;
                if ($willshowDotHint && ood.Event.getKey(key)[0] != ".") {
                    hideSuggestion();
                }
            });
            cm.on("keydown", function (cm, key) {
                if (codeType != 'js' && codeType != 'html') return;
                if ($willshowDotHint && ood.Event.getKey(key)[0] != ".") {
                    hideSuggestion();
                }
            });
            cm.on("cursorActivity", function (cm) {
                if (!cm.hasFocus()) return;

                if (codeType != 'js' && codeType != 'html') return;
                if ($suggestionBaseScope) {
                    var pos = cm.getCursor(),
                        scope = $suggestionBaseScope;
                    // not in region
                    if (pos.line !== scope.line || pos.ch < scope.start || pos.ch > scope.end) {
                        hideSuggestion();
                    }
                }
                ood.resetRun("cm_showtips", function () {
                    var state = cm.state.matchHighlighter;
                    if (state) {
                        //only for selection, and matchhighlight
                        if (state.overlay && state.style == "matchhighlight" && cm.doc.somethingSelected()) {
                            var cur = cm.getCursor(),
                                sel = cm.doc.getSelection(),
                                token = cm.getTokenAt(cur);
                            // only for whole word
                            if (sel === token.string) {
                                showDotHint(cm.doc.indexFromPos(cur), {
                                    start: token.start,
                                    end: token.end,
                                    line: cur.line
                                }, token.string);
                            }
                        }
                    }
                }, 200);
            });
        },
        _onresize: function (profile, width, height) {
            var size = arguments.callee.upper.apply(this, arguments);
            profile.getSubNode('BOX').cssSize(size);
            // have to use px here
            if (profile.$cm) profile.$cm.setSize(profile.$px(size.width), profile.$px(size.height));
        }
    }
});

ood.Class('RAD.expression.ExpressionTemp', 'ood.Module',{
    Instance:{
        initialize : function(){ },
        Dependencies:[],
        Required:[],
        properties : {
            "path":"form/myspace/versionspace/projectManager/0/RAD/expression/ExpressionTemp.cls",
            "personId":"devdev",
            "personName":"devdev",
            "projectName":"projectManager"
        },
        events:{
            "afterShow":  "_page_onrender"
        },
        functions:{},
        iniComponents : function(){
            // [[Code created by JDSEasy RAD Studio
            var host=this, children=[], properties={}, append=function(child){children.push(child.get(0));};
            ood.merge(properties, this.properties);

            append(
                ood.create("ood.APICaller")
                    .setHost(host,"loadapi")
                    .setName("loadapi")
                    .setAutoRun(true)
                    .setQueryURL("/admin/el/getServcieByType")
                    .setQueryMethod("POST")
                    .setRequestDataSource([
                        {
                            "name":"ood_ui_dialog9",
                            "path":"",
                            "type":"form"
                        }
                    ])
                    .setResponseDataTarget([
                        {
                            "name":"ood_ui_treeview19",
                            "path":"data",
                            "type":"treeview"
                        }
                    ])
                    .setResponseCallback([ ])
            );

            append(
                ood.create("ood.UI.Dialog")
                    .setHost(host,"ood_ui_dialog9")
                    .setLeft("1.6666666666666667em")
                    .setTop("3.3333333333333335em")
                    .setWidth("84.16666666666667em")
                    .setHeight("50.833333333333336em")
                    .setCaption("MIX代码编辑器")
                    .setImageClass("ri-code-line")
            );

            host.ood_ui_dialog9.append(
                ood.create("ood.UI.HiddenInput")
                    .setHost(host,"className")
                    .setName("className")
                    .setValue("")
            );

            host.ood_ui_dialog9.append(
                ood.create("ood.UI.Block")
                    .setHost(host,"ood_ui_block49")
                    .setName("buttongroup")
                    .setDock("bottom")
                    .setLeft("0em")
                    .setTop("0em")
                    .setHeight("3.5em")
            );

            host.ood_ui_block49.append(
                ood.create("ood.UI.Button")
                    .setHost(host,"savebutton")
                    .setName("savebutton")
                    .setLeft("32.416666666666664em")
                    .setTop("0.75em")
                    .setCaption("$RAD.widgets.esd.buttonsave")
                    .setImageClass("ood-icon-right")
            );

            host.ood_ui_block49.append(
                ood.create("ood.UI.Button")
                    .setHost(host,"closebutton")
                    .setName("closebutton")
                    .setLeft("42.416666666666664em")
                    .setTop("0.75em")
                    .setCaption("$RAD.widgets.esd.buttonclose")
                    .setImageClass("ri-close-line")
                    .onChange([
                        {
                            "args":[ ],
                            "desc":"动作 1",
                            "method":"destroy",
                            "target":"RAD.expression.ExpressionTemp",
                            "type":"page"
                        }
                    ])
            );

            host.ood_ui_dialog9.append(
                ood.create("ood.UI.Block")
                    .setHost(host,"resourcemain")
                    .setName("resourcemain")
                    .setDock("fill")
                    .setLeft("0em")
                    .setTop("0em")
            );

            host.resourcemain.append(
                ood.create("ood.UI.Layout")
                    .setHost(host,"resourcelayout")
                    .setName("resourcelayout")
                    .setItems([
                        {
                            "cmd":true,
                            "folded":false,
                            "id":"left",
                            "locked":false,
                            "min":10,
                            "pos":"before",
                            "size":200,
                            "hidden":false
                        },
                        {
                            "id":"main",
                            "min":10,
                            "size":80
                        }
                    ])
                    .setLeft("0em")
                    .setTop("0em")
                    .setType("horizontal")
            );

            host.resourcelayout.append(
                ood.create("ood.UI.Block")
                    .setHost(host,"content")
                    .setName("content")
                    .setBorderType("none")
                    .setDock("fill")
                    .setLeft("15.833333333333334em")
                    .setTop("13.333333333333334em"),
                "main"
            );

            host.resourcelayout.append(
                ood.create("ood.UI.Block")
                    .setHost(host,"ood_ui_block60")
                    .setDock("fill")
                    .setLeft("0em")
                    .setTop("0em"),
                "left"
            );

            host.ood_ui_block60.append(
                ood.create("ood.UI.HiddenInput")
                    .setHost(host,"projectName")
                    .setName("projectName")
                    .setValue("")
            );

            host.ood_ui_block60.append(
                ood.create("ood.UI.ComboInput")
                    .setHost(host,"pattern")
                    .setName("pattern")
                    .setDock("top")
                    .setLeft("3.6666666666666665em")
                    .setTop("2em")
                    .setWidth("18em")
                    .setLabelSize("6em")
                    .setLabelCaption("Expression:")
                    .setType("helpinput")
                    .setImageClass("ood-icon-code")
                    .onChange([
                        {
                            "args":[
                                "{page.loadapi.setQueryData()}",
                                null,
                                null,
                                "{args[2]}",
                                "pattern"
                            ],
                            "desc":"动作 1",
                            "method":"setQueryData",
                            "redirection":"other:callback:call",
                            "target":"loadapi",
                            "type":"control"
                        },
                        {
                            "args":[
                                "{page.loadapi.invoke()}",
                                null,
                                null,
                                null,
                                null,
                                ""
                            ],
                            "desc":"动作 2",
                            "koFlag":"_DI_fail",
                            "method":"invoke",
                            "okFlag":"_DI_succeed",
                            "redirection":"other:callback:call",
                            "target":"loadapi",
                            "type":"control"
                        }
                    ])
            );

            host.ood_ui_block60.append(
                ood.create("ood.UI.ToolBar")
                    .setHost(host,"servicetool")
                    .setItems([
                        {
                            "caption":"any",
                            "hidden":false,
                            "id":"any",
                            "sub":[
                                {
                                    "caption":"",
                                    "hidden":false,
                                    "iconFontSize":"",
                                    "id":"refresh",
                                    "imageClass":"ri-refresh-line",
                                    "position":"absolute",
                                    "tips":"$RAD.tool2.refresh"
                                },
                                {
                                    "caption":"",
                                    "hidden":false,
                                    "iconFontSize":"",
                                    "id":"import",
                                    "imageClass":"ood-uicmd-add",
                                    "position":"absolute",
                                    "tips":"$RAD.toolbox.importapi"
                                }
                            ]
                        }
                    ])
                    .onClick([
                        "_toolbar_onclick"
                    ])
                    .setCustomStyle({
                        "ITEMS":{
                            "border-top":"0",
                            "border-bottom":"0"
                        }
                    })
            );

            host.ood_ui_block60.append(
                ood.create("ood.UI.TreeBar")
                    .setHost(host,"treebarCom")
                    .setSelMode("none")
                    .onChange([
                        "_ood_ui_treeview19_onchange"
                    ])
                    .onGetContent([
                        "_treebarcom_ongetcontent"
                    ])
                    .onItemSelected([
                        "_ood_ui_treeview19_onitemselected"
                    ])
                    .setCustomStyle({
                        "KEY":{
                            "background-color":"#FFFFFF"
                        }
                    })
            );

            return children;
            // ]]Code created by JDSEasy RAD Studio
        },

        customAppend : function(parent, subId, left, top){
            return false;
        },

        _reload:function (profile, item) {
            ns = this;
            ns.treebarCom.setItems(ns._buildItems(this.topNodes));
            ns.treebarCom.fireItemClickEvent('pageService');

        },
        _ood_ui_treeview19_onitemselected:function (profile, item, e, src, type) {
            var ns = this, uictrl = profile.boxing(),
                prop = ns.properties, callback = function () {

                };
            ood.getModule("RAD.expression.ExpressionEditor").setDataToEditor(ns.$host , ns.$cls, item);
            // ood.showModule3("RAD.expression.ExpressionEditor","content",null,function () {
            //     this.setDataToEditor(ns.$host , ns.$cls, item);
            //     this.setEvents("onValueChanged", function (profile,expression) {
            //         ns.$api.queryArgs.expression=expression;
            //         ns.fireEvent("onchange", [this,expression]);
            //     });
            //
            // });

            // ood.getModule("RAD.expression.ExpressionEditor", function () {
            //
            //     this.setDataToEditor(ns.$host , ns.$cls, item);
            //     this.setEvents("onValueChanged", function (profile,expression) {
            //         ns.$api.queryArgs.expression=expression;
            //         ns.fireEvent("onchange", [this,expression]);
            //     });
            //
            //     //this.show();
            // });
        },
        _treebarcom_ongetcontent:function (profile, item, callback) {
            var ns = this;
            if (item.key == "jds.localService") {
                ood.Ajax(CONF.getLocalServiceToolBoxService, {
                    projectName: SPA.curProjectName,
                    pattern: ns.pattern.getUIValue()
                }, function (txt) {
                    var obj = txt;
                    if (!obj || obj.error) {
                        ood.message("No module in this project!");
                        callback(false);
                    } else {

                        callback(ns._buildItems(obj.data));
                    }
                }, function (txt) {
                    callback(false);
                }, null, {method: 'post'}).start();
            } else if (item.key == "jds.getPageServiceToolBoxService") {
                ood.Ajax(CONF.getPageServiceToolBoxService, {
                    projectName: SPA.curProjectName,
                    className:SPA.getCurrentClassName(),
                    pattern: ns.pattern.getUIValue()
                }, function (txt) {
                    var obj = txt;
                    if (!obj || obj.error) {
                        ood.message("No module in this project!");
                        callback(false);
                    } else {
                        callback(ns._buildItems(obj.data));
                    }
                }, function (txt) {
                    callback(false);
                }, null, {method: 'post'}).start();
            } else if (item.key == "jds.getProjectServiceToolBoxService") {
                ood.Ajax(CONF.getProjectServiceToolBoxService, {
                    projectName: SPA.curProjectName,
                    pattern: ns.pattern.getUIValue()
                }, function (txt) {
                    var obj = txt;
                    if (!obj || obj.error) {
                        ood.message("No module in this project!");
                        callback(false);
                    } else {
                        var items = [];

                        callback(ns._buildItems(obj.data));
                        //callback(obj.data);
                    }
                }, function (txt) {
                    callback(false);
                }, null, {method: 'post'}).start();
            } else if (item.key == "jds.Server") {
                ood.Ajax(CONF.getRemoteServiceByKeyService, {
                    projectName: SPA.curProjectName,
                    pattern: ns.pattern.getUIValue(),
                    serverId: item.id
                }, function (txt) {

                    var obj = txt;
                    if (!obj || obj.error) {
                        ood.message("No service in this project!");
                        callback(false);
                    } else {
                        var items = [];
                        callback(obj.data);
                    }
                }, function (txt) {
                    callback(false);
                }, null, {method: 'post'}).start();
            }


        },
        _toolbar_onclick:function (profile, item, group, e, src) {
            var ns = this;
            switch (item.id) {
                case 'refresh':
                    ns.treebarCom.setItems(ns._buildItems(this.topNodes));
                    break;

                case 'import':
                    ood.getModule("RAD.api.APITree", function () {
                        this.setData({projectName: SPA.curProjectName});
                        var ns=this;
                        var endFun = function () {
                            ns.initData();
                            ns._fireEvent('afterShow');
                        };

                        this.show(endFun);
                    });
                    break;

            }
        },
        _buildItems:function (items) {
            var nitems = [], ns = this;
            ood.each(items, function (item) {
                if (item.key && CONF.mapWidgets[item.key]) {
                    var p = CONF.mapWidgets[item.key];
                    item.imageClass = CONF.mapWidgets[item.key].imageClass;
                }
                item.children = item.sub;
                item.properties = item.iniProp;
                if (item.sub) {
                    item.sub = ns._buildItems(item.sub);
                };

                item.getProperties=function () {
                    return this.properties;
                }


            })
            return items;
        },
        _ood_ui_treeview19_onchange:function (profile, oldValue, newValue, force, tag) {
            var ns = this, uictrl = profile.boxing();
            ood.echo( ood.getModule("RAD.api.URLConfig").getDataFromEditor());
        },

        setDataToEditor:function (host,cls,api) {
            this.$cls = cls;
            this.$host = host;
            this.$api=api;
            this.treebarCom.setItems(this._buildItems(this.topNodes));

        },




        _page_onrender:function (module, threadid) {
            var ns=this;
            ood.showModule3("RAD.expression.ExpressionEditor","content",null,function () {
                this.setDataToEditor(ns.$host , ns.$cls, ns.$api);
                this.setEvents("onValueChanged", function (profile,expression) {
                    ns.$api.queryArgs.expression=expression;
                    ns.fireEvent("onchange", [this,expression]);
                });
            });


        },
        topNodes:[{"id":"pageService", "key":"jds.getPageServiceToolBoxService", "caption":"$RAD.toolbox.pageService", "group":true, "initFold":false, "imageClass":"spafont spa-icon-action1", "sub":true}, {"id":"projectService", "key":"jds.getProjectServiceToolBoxService", "caption":"$RAD.toolbox.projectService", "group":true, "initFold":false, "imageClass":"ri-3d-box-line", "sub":true}, {"id":"localService", "key":"jds.localService", "caption":"$RAD.toolbox.cls", "group":true, "initFold":true, "imageClass":"spafont spa-icon-options", "sub":true}]
    } ,
    Static:{
        "designViewConf":{
            "height":1024,
            "mobileFrame":false,
            "width":1280
        }
    }



});

ood.Class('RAD.expression.ExpressionEditor', 'ood.Module',{
    Instance:{
        initialize : function(){ },
        Dependencies:[],
        Required:[
            "ood.Module.JSONEditor"
        ],
        properties : {
            "path":"form/myspace/versionspace/projectManager/0/RAD/expression/ExpressionEditor.cls",
            "personId":"devdev",
            "personName":"devdev",
            "projectName":"projectManager"
        },
        events:{
            "onRender":{
                "actions":[
                    {
                        "args":[],
                        "desc":"函数",
                        "script":"_page_onrender",
                        "type":"page"
                    }
                ]
            }
        },
        functions:{},
        iniComponents : function(){
            // [[Code created by JDSEasy RAD Studio
            var host=this, children=[], properties={}, append=function(child){children.push(child.get(0));};
            ood.merge(properties, this.properties);

            append(
                ood.create("ood.UI.Block")
                    .setHost(host,"content")
                    .setDock("fill")
                    .setBorderType("none")
            );

            host.content.append(
                ood.create("ood.UI.Layout")
                    .setHost(host,"ood_ui_layout19")
                    .setType("vertical")
                    .setItems([
                        {
                            "cmd":true,
                            "folded":false,
                            "id":"before",
                            "locked":false,
                            "min":300,
                            "pos":"before",
                            "size":350,
                            "hidden":false
                        },
                        {
                            "id":"main",
                            "min":10,
                            "size":200
                        }
                    ])
                    .setLeft("0em")
                    .setTop("0em")
            );

            host.ood_ui_layout19.append(
                ood.create("ood.UI.Tabs")
                    .setHost(host,"ood_ui_tabs11")
                    .setName("centerdown")
                    .setItems([
                        {                            "caption":"结果",                            "hidden":false,                            "id":"result",                            "imageClass":"ri-eye-line"                        },                        {                            "caption":"动态参数",                            "hidden":false,                            "id":"params",                            "imageClass":"ri-calendar-line"                        },                        {                            "caption":"绑定视图",                            "hidden":false,                            "id":"viewbind",                            "imageClass":"ri-network-line"                        },                        {                            "caption":"日志",                            "hidden":false,                            "id":"log",                            "imageClass":"ri-time-line"                        }
                    ])
                    .setLeft("0em")
                    .setTop("0em")
                    .setValue("params"),
                "main"
            );

            host.ood_ui_tabs11.append(
                ood.create("ood.UI.Block")
                    .setHost(host,"ood_ui_group13")
                    .setDock("fill")
                    .setConLayoutColumns(2),
                "params"
            );

            host.ood_ui_group13.append(
                ood.create("ood.UI.Panel")
                    .setHost(host,"ood_ui_panel37")
                    .setLeft("19.58334em")
                    .setWidth("45.75em")
                    .setHeight("17.083333333333332em")
                    .setCaption("参数编码")
                    .setBorderType("none")
            );

            host.ood_ui_panel37.append(
                ood.create("ood.UI.Input")
                    .setHost(host,"ood_reqtext")
                    .setName("ood_reqtext")
                    .setDisabled(true)
                    .setDock("fill")
                    .setLeft("6.667em")
                    .setTop("4.1667em")
                    .setHeight("10em")
                    .setMultiLines(true)
            );

            host.ood_ui_group13.append(
                ood.create("ood.UI.Div")
                    .setHost(host,"ood_ui_div117")
                    .setDock("left")
                    .setTop("0.8334em")
                    .setWidth("30.75em")
                    .setHeight("8.334em")
            );

            host.ood_ui_div117.append(
                ood.create("ood.UI.Stacks")
                    .setHost(host,"ood_ui_stacks17")
                    .setItems([
                        {
                            "caption":"动态参数",
                            "hidden":false,
                            "id":"b"
                        },
                        {
                            "caption":"固定参数",
                            "hidden":false,
                            "id":"c",
                            "imageClass":""
                        }
                    ])
                    .setLeft("9.58334em")
                    .setTop("0em")
                    .setWidth("45.75em")
                    .setHeight("21em")
                    .setValue("b")
            );

            host.ood_ui_stacks17.append(
                ood.create("ood.UI.TreeGrid")
                    .setHost(host,"ood_reqds")
                    .setName("ood_reqds")
                    .setLeft("0em")
                    .setTop("0em")
                    .setSelMode("multibycheckbox")
                    .setEditable(true)
                    .setRowHandlerWidth("4em")
                    .setHeader([
                        {
                            "caption":"$(RAD.api_dlg.Datasource)",
                            "colResizer":true,
                            "editable":false,
                            "flexSize":false,
                            "hidden":false,
                            "id":"source",
                            "readonly":true,
                            "type":"label",
                            "width":"6.666666666666667em"
                        },
                        {
                            "caption":"$(RAD.api_dlg.To Data Path)",
                            "colResizer":true,
                            "editable":true,
                            "flexSize":true,
                            "hidden":false,
                            "id":"path",
                            "readonly":true,
                            "type":"input",
                            "width":"6.666666666666667em"
                        },
                        {
                            "caption":"参数用途",
                            "colResizer":true,
                            "editable":false,
                            "flexSize":true,
                            "hidden":false,
                            "id":"desc",
                            "readonly":true,
                            "type":"input",
                            "width":"6.666666666666667em"
                        }
                    ])
                    .setTreeMode("none")
                    .setValue("")
                    .onChange([
                        "_ood_reqds_onchange"
                    ])
                    .onRowSelected([
                        "_ontrows"
                    ])
                    .beforeRowActive([
                        "_tg_beforerowactive"
                    ])
                    .beforeCellUpdated([
                        "_acu"
                    ])
                    .afterCellUpdated([
                        "_ood_reqds_bcellupdated"
                    ]),
                "b"
            );

            host.ood_ui_stacks17.append(
                ood.create("ood.Module.JSONEditor", "ood.Module")
                    .setHost(host,"m_reqparams")
                    .setProperties({
                        "className":"ood.Module.JSONEditor"
                    })
                    .setEvents({
                        "onchange":[
                            "_m_reqparams_onchange"
                        ]
                    }),
                "c"
            );

            host.ood_ui_tabs11.append(
                ood.create("ood.UI.Block")
                    .setHost(host,"ood_ui_group23")
                    .setDock("fill")
                    .setLeft("7.5em")
                    .setWidth("8.334em")
                    .setHeight("19.1667em"),
                "viewbind"
            );

            host.ood_ui_group23.append(
                ood.create("ood.UI.Panel")
                    .setHost(host,"ood_ui_panel50")
                    .setDock("left")
                    .setTop("1.667em")
                    .setWidth("26em")
                    .setHeight("17.08333em")
                    .setCaption("视图")
                    .setBorderType("flat")
            );

            host.ood_ui_panel50.append(
                ood.create("ood.UI.TreeGrid")
                    .setHost(host,"ood_rsptarget")
                    .setName("ood_rsptarget")
                    .setLeft("0em")
                    .setTop("0em")
                    .setSelMode("multibycheckbox")
                    .setEditable(true)
                    .setRowHandlerWidth("4em")
                    .setHeader([
                        {
                            "caption":"$(RAD.api_dlg.Data Path)",
                            "colResizer":true,
                            "editable":true,
                            "flexSize":true,
                            "hidden":false,
                            "id":"path",
                            "readonly":true,
                            "type":"input",
                            "width":"6em"
                        },
                        {
                            "caption":"$(RAD.api_dlg.Target)",
                            "colResizer":true,
                            "editable":false,
                            "flexSize":true,
                            "hidden":false,
                            "id":"source",
                            "readonly":true,
                            "type":"label",
                            "width":"10em"
                        },
                        {
                            "caption":"参数用途",
                            "colResizer":true,
                            "editable":false,
                            "flexSize":true,
                            "hidden":false,
                            "id":"desc",
                            "readonly":true,
                            "type":"label",
                            "width":"10em"
                        }
                    ])
                    .setTreeMode("none")
                    .setValue("")
                    .onRowSelected([
                        "_ontrows2"
                    ])
                    .beforeRowActive([
                        "_tg_beforerowactive"
                    ])
                    .beforeCellUpdated([
                        "_acu"
                    ])
            );

            host.ood_ui_group23.append(
                ood.create("ood.UI.Panel")
                    .setHost(host,"ood_ui_panel49")
                    .setLeft("20.41667em")
                    .setTop("1.667em")
                    .setWidth("24.5em")
                    .setHeight("17.08333em")
                    .setCaption("$(RAD.api_dlg.Response Callback)")
            );

            host.ood_ui_panel49.append(
                ood.create("ood.UI.TreeGrid")
                    .setHost(host,"ood_rspfun")
                    .setName("ood_rspfun")
                    .setLeft("0em")
                    .setTop("0em")
                    .setSelMode("multibycheckbox")
                    .setEditable(true)
                    .setRowHandlerWidth("2em")
                    .setHeader([
                        {
                            "caption":"$(RAD.api_dlg.Callback Type)",
                            "colResizer":true,
                            "editable":false,
                            "flexSize":true,
                            "hidden":false,
                            "id":"type",
                            "readonly":true,
                            "type":"label",
                            "width":"6em"
                        },
                        {
                            "caption":"$(RAD.api_dlg.Callback)",
                            "colResizer":true,
                            "editable":false,
                            "flexSize":true,
                            "hidden":false,
                            "id":"source",
                            "readonly":true,
                            "type":"label",
                            "width":"12em"
                        }
                    ])
                    .setTreeMode("none")
                    .setValue("")
                    .onRowSelected([
                        "_ontrows"
                    ])
                    .beforeRowActive([
                        "_tg_beforerowactive"
                    ])
            );

            host.ood_ui_tabs11.append(
                ood.create("ood.UI.Block")
                    .setHost(host,"resultgrid")
                    .setName("resultgrid")
                    .setDock("fill")
                    .setLeft("15em")
                    .setTop("10em"),
                "result"
            );

            host.resultgrid.append(
                ood.create("ood.UI.Block")
                    .setHost(host,"ood_ui_block47")
                    .setDock("fill")
                    .setLeft("0em")
                    .setTop("0em")
            );

            host.ood_ui_block47.append(
                ood.create("ood.UI.Block")
                    .setHost(host,"ood_ui_block48")
                    .setDock("bottom")
                    .setHeight("2.5em")
            );

            host.ood_ui_block48.append(
                ood.create("ood.UI.PageBar")
                    .setHost(host,"ood_ui_pagebar1")
                    .setCaption("")
            );

            host.ood_ui_block47.append(
                ood.create("ood.UI.TreeGrid")
                    .setHost(host,"result")
                    .setName("result")
                    .setLeft("0em")
                    .setTop("0em")
                    .setRowNumbered(true)
                    .setHeader([
                        {
                            "caption":"col1",
                            "colResizer":true,
                            "editable":false,
                            "flexSize":false,
                            "hidden":false,
                            "id":"a",
                            "readonly":true,
                            "type":"input",
                            "width":"8em"
                        },
                        {
                            "caption":"col2",
                            "colResizer":false,
                            "editable":false,
                            "flexSize":false,
                            "hidden":false,
                            "id":"b",
                            "readonly":true,
                            "type":"input",
                            "width":"8em"
                        },
                        {
                            "caption":"col3",
                            "colResizer":false,
                            "editable":false,
                            "flexSize":false,
                            "hidden":false,
                            "id":"c",
                            "readonly":true,
                            "type":"input",
                            "width":"8em"
                        },
                        {
                            "caption":"col4",
                            "colResizer":false,
                            "editable":false,
                            "flexSize":true,
                            "hidden":false,
                            "id":"d",
                            "readonly":true,
                            "type":"input",
                            "width":"8em"
                        }
                    ])
            );

            host.ood_ui_block47.append(
                ood.create("ood.UI.ToolBar")
                    .setHost(host,"ood_ui_toolbar16")
                    .setItems([
                        {
                            "caption":"common",
                            "hidden":false,
                            "id":"common",
                            "sub":[
                                {
                                    "caption":"$RAD.widgets.esd.buttonnew",
                                    "hidden":false,
                                    "iconFontSize":"",
                                    "id":"new",
                                    "imageClass":"ri-calendar-event-line",
                                    "iconFontSize":"1.333em",
                                    "position":"absolute"
                                },
                                {
                                    "caption":"$RAD.widgets.esd.buttondelete",
                                    "hidden":false,
                                    "iconFontSize":"",
                                    "id":"delete",
                                    "imageClass":"ri-close-line",
                                    "iconFontSize":"1.333em",
                                    "position":"absolute"
                                },
                                {
                                    "caption":"$RAD.widgets.esd.buttonreload",
                                    "hidden":false,
                                    "iconFontSize":"",
                                    "id":"reload",
                                    "imageClass":"ri-loader-line",
                                    "iconFontSize":"1.333em",
                                    "position":"absolute"
                                }
                            ]
                        }
                    ])
            );

            host.ood_ui_layout19.append(
                ood.create("ood.UI.Block")
                    .setHost(host,"ood_ui_block63")
                    .setDock("fill")
                    .setLeft("13.333333333333334em")
                    .setTop("5.833333333333333em"),
                "before"
            );

            host.ood_ui_block63.append(
                ood.create("ood.UI.Block")
                    .setHost(host,"editor")
                    .setName("editor")
                    .setDock("fill")
                    .setLeft("2.5em")
                    .setTop("12.5em")
            );

            host.editor.append(
                ood.create("ood.UI.MenuBar")
                    .setHost(host,"ood_ui_menubar2")
                    .setItems([
                        {
                            "caption":"数据源",
                            "disabled":false,
                            "hidden":false,
                            "id":"data",
                            sub:[
                                {
                                    "caption":"JSON文件",
                                    "disabled":false,
                                    "hidden":false,
                                    "id":"loadJson"
                                },
                                {
                                    "caption":"Execl文件",
                                    "disabled":false,
                                    "hidden":false,
                                    "id":"loadExecl"
                                },
                                {
                                    "caption":"数据库",
                                    "disabled":false,
                                    "hidden":false,
                                    "id":"loadDb"
                                },
                            ]
                        },
                        {
                            "caption":"公式",
                            "disabled":false,
                            "hidden":false,
                            "id":"editor"
                        },
                        {
                            "caption":"模板",
                            "disabled":false,
                            "hidden":false,
                            "id":"temp"
                        },
                        {
                            "caption":"工具",
                            "disabled":false,
                            "hidden":false,
                            "id":"tool"
                        }
                    ])
                    .setTop("2.5em")
            );

            return children;
            // ]]Code created by JDSEasy RAD Studio
        },

        customAppend : function(parent, subId, left, top){
            return false;
        },
        setDataToEditor:function (host, cls, api) {
            var ns = this,
                prop = api,
                arr, v, values, t, m;
            this.$cls = cls;
            this.$host = host;
            this.$api = api;
            ns._oldprop = prop;
            ns._host = host;

            // requestDataSource
            (function () {
                arr = [];
                v = {};
                values = [];
                ood.arr.each(prop.requestDataSource, function (o) {
                    v[o.type + "-" + o.name] = o.path;
                });

                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.DataBinder'])
                        return;
                    t = db.getName();
                    m = "databinder" + "-" + t;

                    if (m in v) values.push(m);

                    arr.push({
                        id: m,
                        bindertype: "databinder",
                        cells: [t, v[m] || "", "自定义"]
                    });
                });


                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.PageBar'])
                        return;

                    t = db.getAlias();

                    m = "pagebar" + "-" + t;

                    if (m in v) values.push(m);

                    arr.push({
                        id: m,
                        bindertype: "pagebar",
                        cells: [t, v[m] || "", "分页参数"]
                    });
                });


                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.TreeView'])
                        return;
                    t = db.getAlias();

                    m = "treeview" + "-" + t;

                    if (m in v) values.push(m);

                    arr.push({
                        id: m,
                        bindertype: "treeview",
                        cells: [t, v[m] || "", "当前选中行"]
                    });
                });

                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.Gallery'])
                        return;
                    t = db.getAlias();

                    m = "gallery" + "-" + t;

                    if (m in v) values.push(m);

                    arr.push({
                        id: m,
                        bindertype: "gallery",
                        cells: [t, v[m] || "", "当前选中"]
                    });
                });


                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.Module'])
                        return;
                    t = db.getName();

                    m = "module" + "-" + t;

                    if (m in v) values.push(m);

                    arr.push({
                        id: m,
                        bindertype: "module",
                        cells: [t, v[m] || t, "子模块"]
                    });
                });


                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.TreeGrid'])
                        return;
                    t = db.getAlias();

                    m = "treegrid" + "-" + t;

                    if (m in v) values.push(m);

                    arr.push({
                        id: m,
                        bindertype: "treegrid",
                        cells: [t, v[m] || "", "当前选中行"]
                    });
                });


                ood.each(host, function (ui) {
                    if (!ui || !ui.Class || !ui.Class['ood.absContainer'] || ui.getFormElements().isEmpty())
                        return;
                    t = ui.getAlias();
                    m = "form" + "-" + t;

                    if (m in v) values.push(m);

                    arr.push({
                        id: m,
                        bindertype: "form",
                        cells: [t, v[m] || "", "表单数据"]
                    });
                });

                ns.ood_reqds.setRows(arr).setValue(values.join(";"));
            }());

            // responseDataTarget
            (function () {
                arr = [];
                v = {};
                values = [];
                ood.arr.each(prop.responseDataTarget, function (o) {
                    v[o.type + "-" + (o.name || "")] = o.path;
                });


                if (m in v) values.push(m);

                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.DataBinder'])
                        return;
                    t = db.getName();
                    m = "databinder" + "-" + t;

                    if (m in v) values.push(m);

                    arr.push({
                        id: m,
                        bindertype: "databinder",
                        cells: [v[m] || "", t, "数据绑定"]
                    });
                });

                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.TreeGrid'])
                        return;
                    t = db.getAlias();
                    m = "treegrid" + "-" + t;

                    if (m in v) values.push(m);

                    arr.push({
                        id: m,
                        bindertype: "treegrid",
                        cells: [v[m] || "data", t, "填充行数据"]
                    });
                });


                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.Dialog'])
                        return;
                    t = db.getAlias();
                    m = "component" + "-" + t;

                    if (m in v) values.push(m);

                    arr.push({
                        id: m,
                        bindertype: "component",
                        cells: [v[m] || "data", t, "动态装载"]
                    });
                });

                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.Block'])
                        return;
                    t = db.getAlias();
                    m = "component" + "-" + t;

                    if (m in v) values.push(m);

                    arr.push({
                        id: m,
                        bindertype: "component",
                        cells: [v[m] || "data", t, "动态装载"]
                    });
                });


                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.TreeView'])
                        return;
                    t = db.getAlias();
                    m = "treeview" + "-" + t;

                    if (m in v) values.push(m);

                    arr.push({
                        id: m,
                        bindertype: "treeview",
                        cells: [v[m] || "data", t, "装载树节点"]
                    });
                });

                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.Gallery'])
                        return;
                    t = db.getAlias();
                    m = "gallery" + "-" + t;

                    if (m in v) values.push(m);

                    arr.push({
                        id: m,
                        bindertype: "gallery",
                        cells: [v[m] || "data", t, "装载数据"]
                    });
                });

                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.SVGPaper'])
                        return;
                    t = db.getAlias();
                    m = "svgpagper" + "-" + t;

                    if (m in v) values.push(m);

                    arr.push({
                        id: m,
                        bindertype: "svgpaper",
                        cells: [v[m] || "data", t, "填充图形"]
                    });
                });
                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.UI.PageBar'])
                        return;
                    t = db.getAlias();
                    m = "pagebar" + "-" + t;

                    if (m in v) values.push(m);

                    arr.push({
                        id: m,
                        bindertype: "pagebar",
                        cells: [v[m] || "size", t, "设置最大记录数"]
                    });
                });

                ood.each(host, function (db) {
                    if (!db || !db.Class || !db.Class['ood.Module'])
                        return;
                    t = db.getName();
                    m = "module" + "-" + t;

                    if (m in v) values.push(m);

                    arr.push({
                        id: m,
                        bindertype: "module",
                        cells: [v[m] || 'data.' + t, t, "填充子组件数据"]
                    });
                });


                ood.each(host, function (ui) {
                    if (!ui || !ui.Class || !ui.Class['ood.absContainer'] || ui.getFormElements().isEmpty())
                        return;
                    t = ui.getAlias();
                    m = "form" + "-" + t;

                    if (m in v) values.push(m);

                    arr.push({
                        id: m,
                        bindertype: "form",
                        cells: [v[m] || "data", t, "填充表单数据"]
                    });
                });
                m = "log-console.log";
                arr.push({
                    id: m,
                    bindertype: "log",
                    cells: [v[m] || "", "console.log"]
                });
                if (m in v) values.push(m);

                m = "alert-alert";
                arr.push({
                    id: m,
                    bindertype: "alert",
                    cells: [v[m] || "", "alert"]
                });
                ns.ood_rsptarget.setRows(arr).setValue(values.join(";"));
            }());

            // responseCallback
            (function () {
                arr = [];
                v = {};
                values = [];
                ood.arr.each(prop.responseCallback, function (o) {
                    v[o.type + "-" + (o.name || "")] = o.type;
                });
                if (cls && cls.Instance && cls.Instance.functions) {
                    ood.each(cls.Instance.functions, function (conf, id) {
                        t = id;
                        m = "host" + "-" + t;
                        if (m in v) values.push(m);
                        arr.push({
                            id: m,
                            bindertype: "host",
                            cells: ["page", t]
                        });
                    });
                }
                ood.each(SPA.curProjectConfig.$GlobalFunctions, function (conf, id) {
                    t = id;
                    m = "global" + "-" + t;
                    if (m in v) values.push(m);
                    arr.push({
                        id: m,
                        bindertype: "global",
                        cells: ["global", t]
                    });
                });

                ns.ood_rspfun.setRows(arr).setValue(values.join(";"));
            }());

            // queryArgs
            ns.m_reqparams.setProperties("value", prop.queryArgs);
            // here, must give prop.queryArgs
            ns.updateRequestData(prop.queryArgs, prop.requestDataSource);
        },
        getExpression:function () {
            var ns = this;
            return ns.editor.getValue();
        },
        _ontrows2:function (profile, row, e, src, type) {
            //if (type == -1)
            //    profile.boxing().updateCell(row.cells[0], {value: ""}, false, false);
            this.updateRequestData();
        },
        setResult:function (data) {
            var ns = this;
            ns.ood_ui_tabs11.fireItemClickEvent('result');
            ns.resultgrid.setChildren([data]);
        },
        updateRequestData:function (queryArgs, requestDataSource) {
            var ns = this;

            queryArgs = queryArgs ? ood.clone(queryArgs) : ns.m_reqparams.getValue(true);
            requestDataSource = requestDataSource || [];
            if (!requestDataSource.length) {
                ood.arr.each(ns.ood_reqds.getRows(), function (o) {
                    if (o._selected) {
                        requestDataSource.push({
                            type: o.bindertype,
                            name: o.cells[0].value,
                            path: o.cells[1].value
                        });
                    }
                });
            }

            // merge request data
            if (requestDataSource && requestDataSource.length) {
                for (var i in requestDataSource) {
                    var o = requestDataSource[i], t, v, path;
                    switch (o.type) {
                        case "databinder":
                            if ((t = ns._host[o.name]) && t.Class['ood.DataBinder']) {
                                if (!t.updateDataFromUI()) {
                                    return;
                                } else {
                                    path = (o.path || "").split('.');
                                    if (ood.isHash(v = ood.get(queryArgs, path))) ood.merge(v, t.getData());
                                    else ood.set(queryArgs, o.path.split('.'), t.getData());
                                }
                            }
                            break;
                        case "pagebar":
                            if (t = ns._host[o.name]) {
                                var pageparams = {pageSize: t.getPageCount(), pageIndex: t.getPage()};
                                if (ood.isHash(v = ood.get(queryArgs, path))) ood.merge(v, pageparams);
                                else ood.set(queryArgs, path, pageparams);
                            }
                            break;

                        case "treegrid":
                            if (t = ns._host[o.name]) {
                                path = (o.path || t.getUidColumn()).split('.');
                                ood.set(queryArgs, path, t.getUIValue());
                            }
                            break;
                        case "treeview":
                            if (t = ns._host[o.name]) {
                                path = (o.path || "").split('.');
                                ood.set(queryArgs, path, t.getUIValue());
                            }
                            break;
                        case "form":
                            if ((t = ns._host[o.name]) && t.Class['ood.absContainer'] && t.getFormElements().size() && t.getRootNode()) {
                                // if(!t.checkValid() || !t.checkRequired()){
                                //     return;
                                // }else{
                                path = (o.path || "").split('.');
                                if (ood.isHash(v = ood.get(queryArgs, path))) ood.merge(v, t.getFormValues());
                                else ood.set(queryArgs, path, t.getFormValues());
                                //}
                            }
                            break;
                        case "module":
                            if ((t = ns._host[o.name]) && t.Class['ood.Module']) {
                                path = (o.path || o.name).split('.');
                                ood.set(queryArgs, path, t.getValue(true));

                            }
                            break;
                    }
                }
            }

            var code = ood.stringify(queryArgs);
            if (ood.Coder) {
                code = ood.Coder.formatText(code);
            }

            ns.ood_reqtext.setValue(code);
        },
        getDataFromEditor:function () {
            var ns = this,
                oldprop = ns._oldprop,
                hash = {
                    requestDataSource: oldprop.requestDataSource,
                    responseDataTarget: oldprop.responseDataTarget,
                    responseCallback: oldprop.responseCallback
                },
                arr, v;


            hash.queryAsync = ns.ood_asyn.getValue();
            hash.autoRun = ns.autoRun.getValue();
            hash.isAllform = ns.isAllform.getValue();


            // requestDataSource
            if (ns.ood_reqds.getRootNode()) {
                arr = [];
                ood.arr.each(ns.ood_reqds.getRows(), function (o) {
                    if (o._selected) {
                        arr.push({
                            type: o.bindertype,
                            name: o.cells[0].value,
                            path: o.cells[1].value
                        });
                    }
                });
                hash.requestDataSource = arr;
            }
            // responseDataTarget
            if (ns.ood_rsptarget.getRootNode()) {
                arr = [];
                ood.arr.each(ns.ood_rsptarget.getRows(), function (o) {
                    if (o._selected) {
                        arr.push({
                            type: o.bindertype,
                            name: o.cells[1].value,
                            path: o.bindertype == 'log' || o.bindertype == 'alert' ? "" : o.cells[0].value
                        });
                    }
                });
                hash.responseDataTarget = arr;
            }
            // responseCallback
            if (ns.ood_rspfun.getRootNode()) {
                arr = [];
                ood.arr.each(ns.ood_rspfun.getRows(), function (o) {
                    if (o._selected) {
                        arr.push({
                            type: o.bindertype,
                            name: o.cells[1].value
                        });
                    }
                });
                hash.responseCallback = arr;
            }

            // queryArgs
            // m_reqparams
            v = ns.m_reqparams.getValue(true);
            hash.queryArgs = v || {};

            return hash;
        },
        _acu:function (profile, cell, options) {
            if (!cell._row._selected && options.value) {
                var ins = profile.boxing();
                var arr = ins.getValue(true);
                arr.push(cell._row.id);
                ood.arr.removeDuplicate(arr);
                ood.arr.removeValue(arr, "");
                ins.setValue((arr && arr.length) ? arr.join(";") : null);
            }
            this.updateRequestData();
        },
        _page_onrender:function (module, threadid) {
            var ns = this;
            ood.showModule3("RAD.expression.PageEditor", "editor", null, function () {
                //this.setDataToEditor(ns.$host, ns.$cls, ns.$api);

                this.setEvents("onRunExpression", function (profile,expression) {
                    var data=  ood.execGrid(expression, {}, false);
                    ns.setResult(data);
                });
                this.setEvents("onValueChanged", function () {

                });

            })
        },
        _ontrows:function (profile, row, e, src, type) {
            //if (type == -1)
            //   profile.boxing().updateCell(row.cells[1], {value: ""}, false, false);
            this.updateRequestData();
        },
        _tg_beforerowactive:function () {
            return false;
        },
        _callCmd:function(expression) {
            return ood.execGrid(expression, {}, false);
        }  } ,
    Static:{
        "designViewConf":{
            "height":1024,
            "mobileFrame":false,
            "width":1280
        },
        viewStyles:{ }
    }



});
﻿ood.Class('RAD.expression.PageEditor', 'ood.Module', {
    Instance: {
        Initialize: function () {
            var ns = this;
            ns._ovalue = "";
            ns._dirty = false;
        },
        resetEditorStyle: function (theme, fs, wrap) {
            this.codeeditor.resetEditorStyle(theme, fs, wrap);
        },
        // notice: use it before rendered
        setType: function (type) {
            if (this.codeeditor) this.codeeditor.setCodeType(type, true);
            this._codetype = type && type.split(".")[0];
            if (this.toolbar4) {
                this.toolbar4.updateItem('jsoneditor', {
                    hidden: type != 'json'
                });
            }
        },

        activate: function () {
            this.codeeditor.activate();
        },
        getValue: function () {
            var ns = this;
            return ns._dirty ? ns.codeeditor.getUIValue() : ns._ovalue;
        },
        _refreshCM: function () {
            if (this.codeeditor) {
                this.codeeditor._refreshCM();
            }
        },
        setValue: function (value) {
            // adjust

            value = (value || '').replace(/\t/g, '    ').replace(/\u00A0/g, " ").replace(/\r\n?/g, "\n");

            var ns = this;
            if (ns._ovalue != value) {
                ns._ovalue = value;
                ns._dirty = false;

                if (ns.codeeditor) {
                    ns.codeeditor.setValue(ns._ovalue);
                }
            }
            return ns;
        },


        reindent: function () {
            this.codeeditor.reindent();
        },
        setReadonlyLines: function (head, tail) {
            this.codeeditor.setReadonlyLines(head, tail);
        },
        // 替换工具栏中的图标类
        iniComponents: function (com, threadid) {
            // [[Code created by EUSUI RAD Studio
            var host = this, children = [], append = function (child) {
                children.push(child.get(0))
            };

            append((new ood.UI.ToolBar)
                .setHost(host, "toolbar4")
                .setItems([
                    {
                        "id": "fun", "sub": [
                            {
                                "id": "searchreplace",
                                "caption": "$RAD.pageEditor.searchreplace",
                                "imageClass": "ri-search-line",
                                "type": "button",
                                "tips": "$RAD.pageEditor.replacetips"
                            },
                            {
                                "id": "jumpto",
                                "caption": "$RAD.pageEditor.jumpto",
                                "imageClass": "ri-arrow-right-up-line",
                                "type": "button",
                                "tips": "$RAD.pageEditor.jumptotips"
                            },
                            {
                                "id": "indentall",
                                "caption": "$RAD.pageEditor.indentall",
                                "imageClass": "ri-indent-increase",
                                "type": "button",
                                "tips": "$RAD.pageEditor.indentalltips"
                            },
                            {"id": "rendermode", caption: "mode", "imageClass": "ri-code-line"},
                            {"id": "debug", caption: "调试", "imageClass": "ri-bug-line"},
                            {
                                "id": "jsoneditor",
                                hidden: false,
                                caption: "$RAD.spabuilder.menubar.jsoneditor",
                                imageClass: "ri-braces-line",
                                type: 'button',
                                tips: '$(RAD.pageEditor.Edit in JSON Editor)'
                            },
                            {
                                "id": "progress",
                                "object": (new ood.UI.Image({src: CONF.img_progress})).setHost(host, "imgProgress")
                            }
                        ]
                    }
                ])
                .onClick("_toolbar_onclick")
            );

            append((new RAD.expression.CodeEditor)
                .setHost(host, "codeeditor")
                .setDock("fill")
                .setValue(host._ovalue || "")
                .onValueChanged("_codeeditor_onChange")
                .onSaveCommand("_codeeditor_onsave")
                .onGetHelpInfo("_codeeditor_ongett")
                .onRendered("_codeeditor_onrender")
                .onCodeModeSet("_codeeditor_oncodemodeset")
            );

            return children;
            // ]]Code created by EUSUI RAD Studio
        },
        events: {onReady: '_onready'},
        _onready: function (com) {
            if (com._codetype) {
                com.codeeditor.setCodeType(com._codetype, true);
            }

        },

        setDataToEditor: function (host, cls, api) {
            var ns=this;
            this.$cls = cls;
            this.$host = host;
            this.$api = api;
            if (ood.isStr(api)){
                ns.boxing().setValue(api);
            }else if (api.queryArgs && api.queryArgs.expression) {
                ns.boxing().setValue(api.queryArgs.expression);
            }
        },


        _codeeditor_onrender: function (profile, finished) {
            var ns = this;
            if (!ns.codeeditor) return;

            var id = ns.KEY + ":" + ns.$xid + ":progress";
            if (finished) {
                ood.resetRun(id);

                ns.toolbar4.setDisabled(false);
                ns.codeeditor.setReadonly(false);

                ns.imgProgress.setDisplay('none');

                if (!ns.$initializd) {
                    ns.$initializd = true;
                    ns.fireEvent('afterRendered');
                }
            } else {
                ood.resetRun(id, function () {
                    if (!ns.destroyed) {
                        ns.toolbar4.setDisabled(true);
                        ns.codeeditor.setReadonly(true);
                        ns.imgProgress.setDisplay('');
                    }
                });
            }
        },
        _codeeditor_ongett: function (profile, key) {
            ood.asyRun(function () {
                ood.Coder.applyById("doc:code", true);
            });
            return RAD.EditorTool.getDoc(key);
        },
        _codeeditor_oncodemodeset: function (profile, mode) {
            if (mode) {
                this.toolbar4.updateItem('rendermode', {
                    caption: "&nbsp;" + mode.name,
                    mime: mode.mime,
                    mode: mode.mode,
                    tips: 'Code was rendered as ' + "[" + mode.name + "]"
                });
            }
        },
        _codeeditor_onChange: function (profile, flag) {
            this._dirty = true;
            this.fireEvent("onValueChanged", [this, this.getValue()]);
        },
        _codeeditor_onsave: function (profile) {
            var ns = this;
            ns.fireEvent('onCommandSave', [ns]);
        },

        _toolbar_onclick: function (profile, item, grp, e, src) {
            var ns = this,
                editor = this.codeeditor,
                pos = ood.use(src).offset();
            switch (item.id) {
                case 'indentall':
                    editor.reindent();
                    break;
                case 'debug':
                    this.fireEvent("onRunExpression", [this, this.getValue()]);
                    break;
                case 'searchreplace':
                    RAD.EditorTool.showFindWnd(editor, pos, editor.getCM().getSelection());
                    break;
                case 'jumpto':
                    RAD.EditorTool.showJumpToWnd(editor, pos);
                    break;
                case 'rendermode':
                    editor.showModeSelDlg(item);
                    break;
                case 'jsoneditor':
                    var text = ns.getValue();
                    try {
                        ood.unserialize(text);
                    } catch (e) {
                        ood.alert(e);
                        return;
                    }
                    if (window.SPA && false === SPA.fe("beforeObjectEditorPop", [
                        "jsonEditor", null, text, function (txt) {
                            ns.setValue(typeof(txt) == 'string' ? txt : ood.stringify(txt));
                        },
                        "RAD.PageEditor", ns, ood(src).get(0), null, editor])) return;
                    ood.ModuleFactory.getCom('jsonEditor', function () {
                        this.setProperties({
                            caption: "$RAD.spabuilder.menubar.jsoneditor",
                            imageClass: "ri-braces-line",
                            text: text,
                            onOK: function (obj, txt) {
                                ns.setValue(txt);
                            }
                        });
                        this.show();
                    });
                    break;
            }
        }
    }
});
