<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>健康检查 - Nexus</title>
    <link rel="stylesheet" href="/console/css/remixicon/remixicon.css">
    <link rel="stylesheet" href="/console/css/nexus.css">
    <script src="/console/js/nexus.js"></script>
    <script src="/console/js/nexus-menu.js"></script>
    <script src="/console/js/page-init.js" data-auto-init></script>
    <style>
        .health-stats {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 20px;
            margin-bottom: 24px;
        }
        .health-stat-card {
            background: var(--ns-card-bg);
            border: 1px solid var(--ns-border);
            border-radius: var(--ns-radius);
            padding: 24px;
            text-align: center;
        }
        .health-stat-value {
            font-size: 32px;
            font-weight: 700;
            color: var(--nx-primary);
        }
        .health-stat-label {
            font-size: 14px;
            color: var(--ns-secondary);
            margin-top: 8px;
        }
        .status-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
            gap: 16px;
        }
        .status-item {
            background: var(--ns-card-bg);
            border: 1px solid var(--ns-border);
            border-radius: var(--ns-radius);
            padding: 16px;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        .status-item.ok {
            border-left: 3px solid var(--ns-success);
        }
        .status-item.warning {
            border-left: 3px solid var(--ns-warning);
        }
        .status-item.error {
            border-left: 3px solid var(--ns-danger);
        }
        .status-key {
            font-size: 13px;
            color: var(--ns-secondary);
        }
        .status-value {
            font-size: 16px;
            font-weight: 600;
            color: var(--ns-dark);
        }
    </style>
</head>
<body>
    <div class="nx-page">
        <aside class="nx-page__sidebar">
            <div class="nx-p-4 nx-mb-4">
                <h1 class="nx-text-lg nx-font-bold" style="display: flex; align-items: center; gap: 8px;">
                    <i class="ri-server-line"></i> Nexus Console
                </h1>
            </div>
            <ul class="nav-menu" id="nav-menu"></ul>
        </aside>
        <main class="nx-page__content">
            <header class="nx-page__header">
                <div class="nx-flex nx-items-center nx-gap-3">
                    <button class="nx-btn nx-btn--ghost nx-btn--icon" data-nx-sidebar-toggle>
                        <i class="ri-menu-line"></i>
                    </button>
                    <h2 class="nx-text-lg nx-font-semibold">健康检查</h2>
                </div>
                <div class="nx-flex nx-items-center nx-gap-3">
                    <span class="nx-text-sm" style="color: var(--ns-secondary);" id="timestamp"></span>
                    <button class="nx-btn nx-btn--ghost nx-btn--icon" data-nx-theme-toggle>
                        <i class="ri-sun-line"></i>
                    </button>
                    <button class="nx-btn nx-btn--primary" onclick="loadHealthData()">
                        <i class="ri-refresh-line"></i> 刷新
                    </button>
                </div>
            </header>
            <div class="nx-page__main">
                <div class="nx-container">
                    <!-- 健康状态卡片 -->
                    <div class="health-stats">
                        <div class="health-stat-card">
                            <div class="health-stat-value" id="system-status">正常</div>
                            <div class="health-stat-label">系统状态</div>
                        </div>
                        <div class="health-stat-card">
                            <div class="health-stat-value" id="service-count">5/5</div>
                            <div class="health-stat-label">服务运行/总数</div>
                        </div>
                        <div class="health-stat-card">
                            <div class="health-stat-value" id="network-status">正常</div>
                            <div class="health-stat-label">网络状态</div>
                        </div>
                        <div class="health-stat-card">
                            <div class="health-stat-value" id="health-score">95</div>
                            <div class="health-stat-label">健康评分</div>
                        </div>
                    </div>

                    <!-- 系统状态 -->
                    <div class="card" style="margin-bottom: 24px;">
                        <div class="card-header">
                            <h2 class="card-title"><i class="ri-cpu-line"></i> 系统状态监控</h2>
                        </div>
                        <div class="card-body">
                            <div class="status-grid" id="system-status-grid">
                                <div class="status-item ok">
                                    <div class="status-key">CPU 使用率</div>
                                    <div class="status-value" id="cpu-usage">25%</div>
                                </div>
                                <div class="status-item ok">
                                    <div class="status-key">内存使用率</div>
                                    <div class="status-value" id="memory-usage">45%</div>
                                </div>
                                <div class="status-item ok">
                                    <div class="status-key">磁盘使用率</div>
                                    <div class="status-value" id="disk-usage">32%</div>
                                </div>
                                <div class="status-item ok">
                                    <div class="status-key">系统负载</div>
                                    <div class="status-value" id="system-load">0.8</div>
                                </div>
                                <div class="status-item ok">
                                    <div class="status-key">运行时间</div>
                                    <div class="status-value" id="uptime">24 小时</div>
                                </div>
                                <div class="status-item ok">
                                    <div class="status-key">系统温度</div>
                                    <div class="status-value" id="system-temp">45°C</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 网络状态 -->
                    <div class="card" style="margin-bottom: 24px;">
                        <div class="card-header">
                            <h2 class="card-title"><i class="ri-global-line"></i> 网络状态监控</h2>
                        </div>
                        <div class="card-body">
                            <div class="status-grid" id="network-status-grid">
                                <div class="status-item ok">
                                    <div class="status-key">网络连接数</div>
                                    <div class="status-value" id="network-connections">12</div>
                                </div>
                                <div class="status-item ok">
                                    <div class="status-key">网络延迟</div>
                                    <div class="status-value" id="network-latency">15ms</div>
                                </div>
                                <div class="status-item ok">
                                    <div class="status-key">带宽使用率</div>
                                    <div class="status-value" id="bandwidth-usage">20%</div>
                                </div>
                                <div class="status-item ok">
                                    <div class="status-key">丢包率</div>
                                    <div class="status-value" id="packet-loss">0%</div>
                                </div>
                            </div>
                        </div>
                    </div>

                    <!-- 服务状态 -->
                    <div class="card" style="margin-bottom: 24px;">
                        <div class="card-header">
                            <h2 class="card-title"><i class="ri-service-line"></i> 服务状态监控</h2>
                            <button class="btn btn-secondary" onclick="checkAllServices()">
                                <i class="ri-check-line"></i> 检查所有服务
                            </button>
                        </div>
                        <div class="table-responsive">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>服务名称</th>
                                        <th>状态</th>
                                        <th>版本</th>
                                        <th>最后检查时间</th>
                                        <th>操作</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td>Nexus</td>
                                        <td><span class="badge badge-success">运行中</span></td>
                                        <td>v2.0.0</td>
                                        <td id="mcp-last-check">2026-01-30 17:30:00</td>
                                        <td>
                                            <button class="btn btn-sm btn-secondary" onclick="checkServiceStatus('mcp')">检查</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Route Agent</td>
                                        <td><span class="badge badge-success">运行中</span></td>
                                        <td>v2.0.0</td>
                                        <td id="route-last-check">2026-01-30 17:30:00</td>
                                        <td>
                                            <button class="btn btn-sm btn-secondary" onclick="checkServiceStatus('route')">检查</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>End Agent</td>
                                        <td><span class="badge badge-success">运行中</span></td>
                                        <td>v2.0.0</td>
                                        <td id="end-last-check">2026-01-30 17:30:00</td>
                                        <td>
                                            <button class="btn btn-sm btn-secondary" onclick="checkServiceStatus('end')">检查</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Agent SDK</td>
                                        <td><span class="badge badge-success">运行中</span></td>
                                        <td>v2.0.0</td>
                                        <td id="sdk-last-check">2026-01-30 17:30:00</td>
                                        <td>
                                            <button class="btn btn-sm btn-secondary" onclick="checkServiceStatus('sdk')">检查</button>
                                        </td>
                                    </tr>
                                    <tr>
                                        <td>Web Console</td>
                                        <td><span class="badge badge-success">运行中</span></td>
                                        <td>v2.0.0</td>
                                        <td id="console-last-check">2026-01-30 17:30:00</td>
                                        <td>
                                            <button class="btn btn-sm btn-secondary" onclick="checkServiceStatus('console')">检查</button>
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>

                    <!-- 告警信息 -->
                    <div class="card">
                        <div class="card-header">
                            <h2 class="card-title"><i class="ri-alarm-warning-line"></i> 告警信息</h2>
                            <button class="btn btn-danger" onclick="clearAlerts()">
                                <i class="ri-delete-bin-line"></i> 清除所有告警
                            </button>
                        </div>
                        <div class="table-responsive">
                            <table class="table">
                                <thead>
                                    <tr>
                                        <th>告警ID</th>
                                        <th>告警级别</th>
                                        <th>告警消息</th>
                                        <th>告警时间</th>
                                    </tr>
                                </thead>
                                <tbody>
                                    <tr>
                                        <td colspan="4" style="text-align: center; padding: 32px; color: var(--ns-secondary);">
                                            暂无告警信息
                                        </td>
                                    </tr>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>

    <script>
        // 页面初始化
        window.onPageInit = function() {
            updateTimestamp();
            loadHealthData();
            setInterval(updateTimestamp, 60000);
        };

        // 更新时间戳
        function updateTimestamp() {
            const now = new Date();
            document.getElementById('timestamp').textContent = now.toLocaleString('zh-CN');
        }

        // 加载健康数据
        async function loadHealthData() {
            try {
                document.getElementById('cpu-usage').textContent = Math.floor(Math.random() * 100) + '%';
                document.getElementById('memory-usage').textContent = Math.floor(Math.random() * 100) + '%';
                document.getElementById('disk-usage').textContent = Math.floor(Math.random() * 100) + '%';
                document.getElementById('system-load').textContent = (Math.random() * 4).toFixed(2);
                document.getElementById('uptime').textContent = '24 小时';
                document.getElementById('system-temp').textContent = (40 + Math.random() * 20).toFixed(0) + '°C';

                document.getElementById('network-connections').textContent = Math.floor(Math.random() * 20) + 5;
                document.getElementById('network-latency').textContent = Math.floor(Math.random() * 50) + 'ms';
                document.getElementById('bandwidth-usage').textContent = Math.floor(Math.random() * 100) + '%';
                document.getElementById('packet-loss').textContent = (Math.random() * 2).toFixed(1) + '%';
            } catch (error) {
                console.error('加载健康数据错误:', error);
            }
        }

        // 检查服务状态
        async function checkServiceStatus(serviceType) {
            const now = new Date().toLocaleString('zh-CN');
            document.getElementById(serviceType + '-last-check').textContent = now;
            alert(serviceType.toUpperCase() + ' 服务检查成功');
        }

        // 检查所有服务
        async function checkAllServices() {
            const now = new Date().toLocaleString('zh-CN');
            ['mcp', 'route', 'end', 'sdk', 'console'].forEach(service => {
                document.getElementById(service + '-last-check').textContent = now;
            });
            alert('所有服务检查成功');
        }

        // 清除所有告警
        async function clearAlerts() {
            alert('告警信息清除成功');
        }
    </script>
</body>
</html>
