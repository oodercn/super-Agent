<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Function Calling - Nexus Console</title>
    
    <link rel="stylesheet" href="/console/css/remixicon/remixicon.css">
    <link rel="stylesheet" href="/console/css/nexus.css">
    <style>
        .functions-container { display: flex; flex-direction: column; gap: 24px; }
        .functions-header { display: flex; justify-content: space-between; align-items: center; }
        .functions-title { display: flex; align-items: center; gap: 8px; font-size: 18px; font-weight: 600; }
        .functions-controls { display: flex; gap: 12px; }
        .functions-content { display: grid; grid-template-columns: 1fr 1fr; gap: 24px; }
        .left-panel, .right-panel { display: flex; flex-direction: column; gap: 24px; }
        .panel-section { background: var(--nx-bg-secondary); border-radius: 12px; padding: 16px; }
        .section-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px; }
        .section-header h3 { margin: 0; font-size: 14px; font-weight: 600; display: flex; align-items: center; gap: 8px; }
        .functions-list { display: flex; flex-direction: column; gap: 12px; max-height: 300px; overflow-y: auto; }
        .function-card { background: var(--nx-bg-color); border-radius: 8px; padding: 12px; border: 1px solid var(--nx-border-color); }
        .function-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 8px; }
        .function-name { font-weight: 600; color: var(--nx-primary-color); }
        .function-body { display: flex; flex-direction: column; gap: 12px; }
        .form-group { display: flex; flex-direction: column; gap: 4px; }
        .form-group label { font-size: 12px; color: var(--nx-text-secondary); }
        .form-input, .form-textarea { width: 100%; padding: 8px 12px; border-radius: 6px; border: 1px solid var(--nx-border-color); background: var(--nx-bg-secondary); color: var(--nx-text-color); }
        .form-textarea { min-height: 80px; resize: vertical; font-family: monospace; font-size: 12px; }
        .result-container { min-height: 200px; }
        .result-placeholder { display: flex; flex-direction: column; align-items: center; justify-content: center; height: 200px; color: var(--nx-text-secondary); }
        .result-placeholder i { font-size: 48px; margin-bottom: 12px; }
        .result-block { margin-bottom: 16px; padding: 12px; background: var(--nx-bg-color); border-radius: 8px; }
        .result-label { display: flex; align-items: center; gap: 8px; font-size: 12px; color: var(--nx-text-secondary); margin-bottom: 8px; }
        .result-text { font-size: 14px; line-height: 1.6; }
        .function-call-display, .function-result-display { font-family: monospace; font-size: 12px; background: var(--nx-bg-secondary); padding: 8px; border-radius: 4px; }
        .history-list { max-height: 150px; overflow-y: auto; }
        .history-empty { text-align: center; padding: 24px; color: var(--nx-text-secondary); }
    </style>
</head>
<body>
    <div class="nx-page">
        <aside class="nx-page__sidebar">
            <div class="nx-p-4 nx-mb-4">
                <h1 class="nx-text-lg nx-font-bold" style="display: flex; align-items: center; gap: 8px;">
                    <i class="ri-server-line"></i> Nexus Console
                </h1>
            </div>
            <ul class="nav-menu" id="nav-menu"></ul>
        </aside>
        
        <main class="nx-page__content">
            <header class="nx-page__header">
                <div class="nx-flex nx-items-center nx-gap-3">
                    <button class="nx-btn nx-btn--ghost nx-btn--icon" data-nx-sidebar-toggle>
                        <i class="ri-menu-line"></i>
                    </button>
                    <h2 class="nx-text-lg nx-font-semibold">Function Calling</h2>
                </div>
                <div class="nx-flex nx-items-center nx-gap-3">
                    <button class="nx-btn nx-btn--ghost nx-btn--icon" data-nx-theme-toggle>
                        <i class="ri-sun-line"></i>
                    </button>
                </div>
            </header>
            
            <div class="nx-page__main">
                <div class="nx-container">
                    <div class="functions-container">
                        <div class="functions-header">
                            <div class="functions-title">
                                <i class="ri-flashlight-line"></i>
                                <span>Function Calling</span>
                            </div>
                            <div class="functions-controls">
                                <button class="nx-btn nx-btn--primary" id="execute-btn">
                                    <i class="ri-play-line"></i>
                                    <span>执行</span>
                                </button>
                                <button class="nx-btn nx-btn--secondary" id="clear-btn">
                                    <i class="ri-delete-bin-line"></i>
                                    <span>清空</span>
                                </button>
                            </div>
                        </div>

                        <div class="functions-content">
                            <div class="left-panel">
                                <div class="panel-section">
                                    <div class="section-header">
                                        <h3><i class="ri-code-box-line"></i> 函数定义</h3>
                                        <button class="nx-btn nx-btn--ghost nx-btn--sm" id="add-function-btn">
                                            <i class="ri-add-line"></i>
                                            <span>添加函数</span>
                                        </button>
                                    </div>
                                    <div class="functions-list" id="functions-list">
                                        <div class="function-card" data-id="1">
                                            <div class="function-header">
                                                <span class="function-name">get_weather</span>
                                                <button class="nx-btn nx-btn--ghost nx-btn--sm function-delete" title="删除">
                                                    <i class="ri-close-line"></i>
                                                </button>
                                            </div>
                                            <div class="function-body">
                                                <div class="form-group">
                                                    <label>函数名称</label>
                                                    <input type="text" class="form-input function-name-input" value="get_weather" placeholder="函数名称">
                                                </div>
                                                <div class="form-group">
                                                    <label>描述</label>
                                                    <input type="text" class="form-input function-desc-input" value="获取指定城市的天气信息" placeholder="函数描述">
                                                </div>
                                                <div class="form-group">
                                                    <label>参数 (JSON Schema)</label>
                                                    <textarea class="form-textarea function-params-input" rows="4" placeholder='{"type": "object", "properties": {...}}'>{
  "type": "object",
  "properties": {
    "city": {
      "type": "string",
      "description": "城市名称"
    }
  },
  "required": ["city"]
}</textarea>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="panel-section">
                                    <div class="section-header">
                                        <h3><i class="ri-chat-3-line"></i> 提示词</h3>
                                    </div>
                                    <textarea class="form-textarea prompt-input" id="prompt-input" rows="4" placeholder="输入你的问题，例如：北京今天天气怎么样？"></textarea>
                                </div>
                            </div>

                            <div class="right-panel">
                                <div class="panel-section result-section">
                                    <div class="section-header">
                                        <h3><i class="ri-terminal-box-line"></i> 执行结果</h3>
                                        <div class="result-status" id="result-status"></div>
                                    </div>
                                    
                                    <div class="result-container">
                                        <div class="result-placeholder" id="result-placeholder">
                                            <i class="ri-flashlight-line"></i>
                                            <p>定义函数并输入提示词后点击"执行"</p>
                                        </div>
                                        
                                        <div class="result-content" id="result-content" style="display: none;">
                                            <div class="result-block">
                                                <div class="result-label">
                                                    <i class="ri-user-line"></i>
                                                    <span>用户输入</span>
                                                </div>
                                                <div class="result-text" id="user-input-display"></div>
                                            </div>
                                            
                                            <div class="result-block" id="function-call-block" style="display: none;">
                                                <div class="result-label">
                                                    <i class="ri-code-line"></i>
                                                    <span>函数调用</span>
                                                </div>
                                                <div class="function-call-display" id="function-call-display"></div>
                                            </div>
                                            
                                            <div class="result-block" id="function-result-block" style="display: none;">
                                                <div class="result-label">
                                                    <i class="ri-database-2-line"></i>
                                                    <span>函数返回</span>
                                                </div>
                                                <div class="function-result-display" id="function-result-display"></div>
                                            </div>
                                            
                                            <div class="result-block">
                                                <div class="result-label">
                                                    <i class="ri-robot-line"></i>
                                                    <span>AI 响应</span>
                                                </div>
                                                <div class="result-text ai-response" id="ai-response"></div>
                                            </div>
                                        </div>
                                    </div>
                                </div>

                                <div class="panel-section">
                                    <div class="section-header">
                                        <h3><i class="ri-history-line"></i> 执行历史</h3>
                                        <button class="nx-btn nx-btn--ghost nx-btn--sm" id="clear-history-btn">
                                            <i class="ri-delete-bin-line"></i>
                                            <span>清空</span>
                                        </button>
                                    </div>
                                    <div class="history-list" id="history-list">
                                        <div class="history-empty">暂无历史记录</div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </main>
    </div>
    
    <script src="/console/js/nexus.js"></script>
    <script src="/console/js/nexus-menu.js"></script>
    <script src="/console/js/page-init.js" data-auto-init></script>
    <script src="/console/js/pages/llm-functions.js"></script>
</body>
</html>
