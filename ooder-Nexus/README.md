# ooderNexus - P2P AI 能力分发枢纽

## 文档信息

| 项目 | 内容 |
|------|------|
| 版本 | v2.2.0 |
| 更新日期 | 2026-02-22 |
| SDK 版本 | Ooder Agent SDK v0.7.3 |

---

## 1. 项目简介

### 1.1 什么是 ooderNexus？

ooderNexus 是基于 **Ooder Agent SDK** 构建的 P2P AI 能力分发枢纽，采用 MIT 开源协议。它是 Agent 协议的具体实现应用，将去中心化的 P2P 网络技术与 AI 能力管理相结合，让用户能够在本地网络中构建私有的 AI 能力共享平台。

**核心定位**：
- 🎯 **Agent 协议实现** - Ooder Agent SDK 的完整应用实现
- 🤝 **P2P 去中心化** - 无需中心服务器，节点间直接通信
- 🧠 **AI 能力管理** - 技能发现、安装、授权、执行全流程
- 🔗 **场景组协作** - 支持多节点协同工作的场景管理

### 1.2 与 Ooder 生态的关系

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                           Ooder 生态系统                                     │
├─────────────────────────────────────────────────────────────────────────────┤
│                                                                             │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                        云服务层 (北向)                               │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                 │   │
│  │  │ SkillCenter │  │  AI Bridge  │  │  云端服务    │                 │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘                 │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                    │                                        │
│                                    │ AI Bridge Protocol                     │
│                                    ▼                                        │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                        ooderNexus                                    │   │
│  │  ┌─────────────────────────────────────────────────────────────┐   │   │
│  │  │                    Agent 协议层                              │   │   │
│  │  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐         │   │   │
│  │  │  │ MCP Agent   │  │ Route Agent │  │ End Agent   │         │   │   │
│  │  │  │ (主控节点)   │  │ (路由节点)   │  │ (终端节点)   │         │   │   │
│  │  │  └─────────────┘  └─────────────┘  └─────────────┘         │   │   │
│  │  └─────────────────────────────────────────────────────────────┘   │   │
│  │                                                                      │   │
│  │  ┌─────────────────────────────────────────────────────────────┐   │   │
│  │  │                    场景组协作层                              │   │   │
│  │  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐         │   │   │
│  │  │  │ SceneGroup  │  │ SceneGroup  │  │ SceneGroup  │         │   │   │
│  │  │  │ (auth场景)   │  │ (msg场景)    │  │ (vfs场景)   │         │   │   │
│  │  │  └─────────────┘  └─────────────┘  └─────────────┘         │   │   │
│  │  └─────────────────────────────────────────────────────────────┘   │   │
│  │                                                                      │   │
│  │  ┌─────────────────────────────────────────────────────────────┐   │   │
│  │  │                    技能服务层                                │   │   │
│  │  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐         │   │   │
│  │  │  │ Skill A     │  │ Skill B     │  │ Skill C     │         │   │   │
│  │  │  │ (飞书集成)   │  │ (文档处理)   │  │ (数据分析)   │         │   │   │
│  │  │  └─────────────┘  └─────────────┘  └─────────────┘         │   │   │
│  │  └─────────────────────────────────────────────────────────────┘   │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                    │                                        │
│                                    │ Agent Protocol (南向)                  │
│                                    ▼                                        │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                        存储与资源层                                  │   │
│  │  ┌─────────────┐  ┌─────────────┐  ┌─────────────┐                 │   │
│  │  │ VFS 存储    │  │ 本地文件系统 │  │ OpenWrt 设备 │                 │   │
│  │  └─────────────┘  └─────────────┘  └─────────────┘                 │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│                                                                             │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 1.3 核心概念

| 术语 | 英文 | 定义 |
|------|------|------|
| **MCP Agent** | Master Control Program Agent | 主控智能体，负责资源管理、任务调度、安全认证 |
| **Route Agent** | Route Agent | 路由智能体，负责消息路由、负载均衡、场景组管理 |
| **End Agent** | 终端智能体 | 与外部系统交互、技能执行、数据采集 |
| **Skill** | 技能 | 提供特定功能的服务单元 |
| **Capability** | 能力 | Skill 提供的具体功能点 |
| **Scene** | 场景 | 一组协作能力的集合，定义协作边界 |
| **SceneGroup** | 场景组 | 共享 KEY 和 VFS 资源的 Agent 集合 |
| **VFS** | Virtual File System | 虚拟文件系统，统一的文件存储抽象 |

### 1.4 适用场景

| 场景 | 部署设备 | Agent 角色 | 主要用途 |
|------|----------|------------|----------|
| 🏠 **家庭智能中枢** | OpenWrt 路由器 | Route Agent | 智能家居控制、网络管理 |
| 🏢 **企业 AI 平台** | 服务器/工控机 | MCP Agent | 内部 AI 能力共享 |
| 🌐 **边缘计算网络** | 树莓派/开发板 | End Agent | 分布式计算节点 |
| 💻 **开发测试平台** | PC/笔记本 | MCP Agent | 协议开发、技能调试 |

---

## 2. 功能模块

### 2.1 功能架构

```
┌─────────────────────────────────────────────────────────────────────────────────────┐
│                              ooderNexus 功能架构                                      │
├───────────────┬───────────────┬───────────────┬───────────────┬─────────────────────┤
│   我的能力    │   个人中心    │   协同协作    │   系统配置    │      资源管理        │
├───────────────┼───────────────┼───────────────┼───────────────┼─────────────────────┤
│ • 我的能力包  │ • 个人仪表盘  │ • 消息中心    │ • 能力约束    │ • 能力中心           │
│ • 网络概览    │ • 我的分享    │ • 联系人      │ • 协作关系    │ • LLM配置            │
│               │ • 身份管理    │ • 协同场景    │ • 健康检查    │ • 存储管理           │
│               │ • 执行记录    │ • 群组管理    │ • 审计日志    │                      │
│               │ • 帮助中心    │ • 文件管理    │               │                      │
├───────────────┼───────────────┼───────────────┼───────────────┼─────────────────────┤
│   网络管理    │   协议管理    │  Nexus管理   │   任务管理    │     管理后台         │
├───────────────┼───────────────┼───────────────┼───────────────┼─────────────────────┤
│ • IP管理      │ • 协作协议    │ • 仪表盘      │ • 数据抽取    │ • 管理仪表盘         │
│ • 流量监控    │ • 发现协议    │ • 系统状态    │ • 列表抽取    │ • 技能审核           │
│ • 网络配置    │ • 登录协议    │ • P2P管理     │               │ • 用户管理           │
│ • 设备管理    │ • 观察协议    │ • 安全管理    │               │ • 存储管理           │
│ • 远程终端    │ • 域管理协议  │ • 终端代理    │               │ • 远程管理           │
└───────────────┴───────────────┴───────────────┴───────────────┴─────────────────────┘
```

### 2.2 我的能力

个人用户的核心能力管理模块，管理本地资源和能力。

#### 我的能力包
- **技能安装预览**：安装前查看所需权限和依赖
- **权限确认流程**：资源权限、场景权限可视化确认
- **依赖解析**：自动解析技能依赖的场景、技能、资源
- **授权管理**：查看和管理已授权技能

#### 网络概览
- **网络拓扑**：可视化展示 P2P 网络结构
- **节点发现**：支持多种发现方法（UDP/DHT/mDNS/SkillCenter/GitHub/Gitee 等）
- **链路管理**：节点间链路创建、监控、断开

### 2.3 个人中心

个人信息和活动管理中心。

#### 个人仪表盘
- **数据统计**：技能数量、执行次数、资源使用统计
- **快捷操作**：常用功能快捷入口
- **状态概览**：系统状态、网络状态一览

#### 我的分享
- **分享管理**：管理已分享的文件和资源
- **分享链接**：生成和管理分享链接
- **权限控制**：分享权限设置

#### 身份管理
- **身份认证**：管理认证凭据
- **密钥管理**：公私钥对管理
- **安全设置**：访问权限配置

#### 执行记录
- **历史记录**：技能执行历史查询
- **执行详情**：查看执行参数和结果
- **统计分析**：执行次数、成功率统计

#### 帮助中心
- **使用指南**：系统使用说明
- **常见问题**：FAQ 快速解答
- **问题反馈**：提交问题和建议

### 2.4 协同协作

与其他节点和用户的协同功能模块。

#### 消息中心
- **消息收发**：消息接收和发送
- **消息分类**：消息分类和归档
- **通知管理**：消息通知管理

#### 联系人
- **联系人管理**：联系人列表管理
- **联系人分组**：联系人分组
- **在线状态**：在线状态显示

#### 协同场景
- **场景管理**：场景创建和配置
- **场景关联**：场景-群组-技能关联管理
- **协作可视化**：协同关系可视化展示

#### 群组管理
- **群组创建**：创建协作群组
- **成员管理**：群组成员邀请和管理
- **权限配置**：群组权限设置

#### 文件管理
- **文件共享**：群组内文件共享
- **版本管理**：文件版本控制
- **权限控制**：文件访问权限

### 2.5 系统配置

系统级别的配置和管理功能。

#### 能力约束
- **执行约束**：技能执行约束配置
- **资源限制**：资源访问限制
- **策略管理**：执行策略管理

#### 协作关系
- **关系管理**：场景-群组-技能关系管理
- **关系可视化**：协作关系可视化
- **关系图谱**：关系图谱展示

#### 健康检查
- **系统检查**：系统状态检查
- **服务监控**：服务健康监控
- **告警配置**：告警配置

#### 审计日志
- **操作审计**：AOP 自动记录关键操作
- **日志查询**：支持按时间、类型、模块过滤
- **统计分析**：按类型、模块统计操作次数
- **详情查看**：查看操作参数和结果

### 2.6 资源管理

系统资源的管理和配置。

#### 能力中心
- **技能市场**：浏览和发现技能
- **技能发布**：发布技能到网络
- **技能同步**：多节点间技能同步

#### LLM配置
- **模型配置**：大语言模型配置
- **参数管理**：模型参数管理
- **API 管理**：API 密钥管理

#### 存储管理
- **存储配置**：存储策略配置
- **容量监控**：存储空间监控
- **清理策略**：自动清理策略

### 2.7 网络管理

网络资源和设备管理模块。

#### IP管理
- **IP分配**：静态IP地址分配
- **DHCP租约**：DHCP租约管理
- **IP池管理**：IP地址池配置

#### 流量监控
- **实时监控**：网络流量实时统计
- **流量分析**：流量趋势分析
- **告警设置**：流量异常告警

#### 网络配置
- **接口管理**：网络接口配置
- **路由配置**：静态路由管理
- **DNS配置**：DNS服务器设置

#### 设备管理
- **设备资产**：设备信息管理
- **状态监控**：设备在线状态
- **设备分组**：按类型/位置分组

#### 远程终端
- **SSH连接**：远程SSH终端
- **命令执行**：批量命令执行
- **会话管理**：终端会话管理

### 2.8 协议管理

Agent 协议配置和管理（MCP角色专属）。

#### 协作协议
- **协议配置**：协作协议参数配置
- **场景绑定**：协议与场景绑定
- **权限设置**：协议访问权限

#### 发现协议
- **发现配置**：节点发现协议设置
- **发现方法**：UDP/DHT/mDNS等配置
- **节点过滤**：发现节点过滤规则

#### 登录协议
- **认证配置**：登录认证协议设置
- **令牌管理**：访问令牌管理
- **会话配置**：会话超时等设置

#### 观察协议
- **监控配置**：节点观察协议设置
- **事件订阅**：事件订阅管理
- **告警规则**：观察告警规则

#### 域管理协议
- **域配置**：管理域设置
- **域成员**：域成员管理
- **域策略**：域策略配置

### 2.9 Nexus管理

Nexus核心功能管理模块。

#### 仪表盘
- **系统概览**：Nexus整体状态
- **资源统计**：节点、技能、场景统计
- **活动监控**：最近活动记录

#### 系统状态
- **运行状态**：CPU、内存、磁盘使用
- **服务状态**：各服务运行状态
- **日志查看**：系统日志查看

#### P2P管理
- **节点管理**：P2P节点列表和管理
- **链路管理**：节点间链路状态
- **网络拓扑**：P2P网络拓扑图

#### 安全管理
- **安全策略**：安全策略配置
- **访问控制**：访问权限管理
- **安全审计**：安全事件审计

#### 终端代理
- **代理列表**：终端代理管理
- **代理配置**：代理参数配置
- **连接状态**：代理连接状态

### 2.10 任务管理

数据处理任务管理模块。

#### 数据抽取
- **任务创建**：创建数据抽取任务
- **任务执行**：执行抽取任务
- **结果查看**：查看抽取结果

#### 列表抽取
- **列表任务**：列表数据抽取任务
- **批量处理**：批量数据处理
- **进度监控**：任务进度监控

### 2.11 管理后台

管理员专属功能模块（MCP角色专属）。

#### 管理仪表盘
- **全局统计**：用户、技能、节点统计
- **系统健康**：系统健康度概览
- **告警信息**：系统告警列表

#### 技能审核
- **待审核列表**：待审核技能列表
- **审核流程**：技能审核和批准
- **审核记录**：审核历史记录

#### 用户管理
- **用户列表**：用户账户管理
- **角色分配**：用户角色分配
- **权限管理**：用户权限配置

#### 存储管理
- **存储配置**：全局存储策略
- **容量管理**：存储容量分配
- **备份管理**：数据备份配置

#### 远程管理
- **远程访问**：远程节点访问
- **批量操作**：批量节点操作
- **配置同步**：配置推送和同步

### 2.12 安全管理

系统安全功能模块（MCP角色专属）。

#### 防火墙
- **规则配置**：防火墙规则管理
- **端口管理**：端口开放控制
- **访问日志**：防火墙访问日志

#### 访问控制
- **ACL配置**：访问控制列表
- **权限策略**：访问权限策略
- **黑白名单**：IP黑白名单管理

---

## 3. 技术架构

### 3.1 系统架构图

```
┌─────────────────────────────────────────────────────────────────────────────┐
│                              用户界面层                                      │
│  ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐ ┌──────────┐         │
│  │ Web 控制台│ │ REST API │ │ 协议仿真 │ │ OpenWrt │ │ 审计日志 │         │
│  │(HTML/JS) │ │          │ │   界面   │ │ 管理界面│ │   界面   │         │
│  └────┬─────┘ └────┬─────┘ └────┬─────┘ └────┬─────┘ └────┬─────┘         │
└───────┼────────────┼────────────┼────────────┼────────────┼────────────────┘
        │            │            │            │            │
        └────────────┴────────────┴────────────┴────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                              应用服务层                                      │
│  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌──────────────┐       │
│  │  技能管理    │ │  场景管理    │ │  审计服务    │ │  协作服务    │       │
│  │  服务        │ │  服务        │ │              │ │              │       │
│  └──────────────┘ └──────────────┘ └──────────────┘ └──────────────┘       │
│  ┌──────────────┐ ┌──────────────┐ ┌──────────────┐ ┌──────────────┐       │
│  │ OpenWrt      │ │ 协议仿真     │ │ VFS 存储     │ │ 网络管理     │       │
│  │ 集成服务     │ │ 引擎         │ │ 服务         │ │ 服务         │       │
│  └──────────────┘ └──────────────┘ └──────────────┘ └──────────────┘       │
└─────────────────────────────────────────────────────────────────────────────┘
                                  │
                                  ▼
┌─────────────────────────────────────────────────────────────────────────────┐
│                              基础平台层                                      │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                    Ooder Agent SDK v0.7.3                           │   │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐   │   │
│  │  │ Discovery   │ │ Login       │ │Collaboration│ │ Offline     │   │   │
│  │  │ Protocol    │ │ Protocol    │ │ Protocol    │ │ Service     │   │   │
│  │  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘   │   │
│  │  ┌─────────────┐ ┌─────────────┐ ┌─────────────┐ ┌─────────────┐   │   │
│  │  │ P2P 网络    │ │ 场景组管理  │ │ 技能发现    │ │ 事件总线    │   │   │
│  │  └─────────────┘ └─────────────┘ └─────────────┘ └─────────────┘   │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
│  ┌─────────────────────────────────────────────────────────────────────┐   │
│  │                    Spring Boot 2.7.0 + Java 8                        │   │
│  └─────────────────────────────────────────────────────────────────────┘   │
└─────────────────────────────────────────────────────────────────────────────┘
```

### 3.2 技术栈

| 层次 | 技术 | 用途 |
|------|------|------|
| **前端** | HTML5, CSS3, JavaScript | Web 控制台界面 |
| **后端** | Spring Boot 2.7.0, Java 8 | 业务逻辑处理 |
| **P2P 网络** | Ooder Agent SDK v0.7.3 | 底层网络通信 |
| **场景引擎** | Scene Engine v0.7.3 | 场景定义与执行 |
| **存储** | VFS + 本地文件系统 | 数据和文件存储 |
| **配置** | UCI (OpenWrt) | 路由器配置管理 |

### 3.3 核心依赖

| 依赖 | 版本 | 用途 |
|------|------|------|
| Ooder Agent SDK | 0.7.3 | P2P网络通信 |
| Scene Engine | 0.7.3 | 场景引擎 |
| Ooder Org Web | 2.2 | 组织架构支持 |
| Ooder Common | 2.2 | 公共组件 |
| Spring Boot | 2.7.0 | 后端框架 |

### 3.4 Agent 角色说明

| 角色 | 适用场景 | 功能特点 |
|------|----------|----------|
| **MCP Agent** | 主控节点 | 资源管理、任务调度、安全认证、场景协调 |
| **Route Agent** | 路由节点 | 消息路由、负载均衡、场景组管理、故障接管 |
| **End Agent** | 终端节点 | 技能执行、数据采集、与外部系统交互 |

### 3.5 场景定义

ooderNexus 通过场景定义文件配置协作边界：

| 场景 | 文件 | 用途 |
|------|------|------|
| 认证场景 | auth-scene.yaml | 用户认证与授权 |
| 消息场景 | msg-scene.yaml | 即时消息通信 |
| 文件场景 | vfs-scene.yaml | 虚拟文件系统 |
| 组织场景 | org-scene.yaml | 人员组织架构 |
| 工作流场景 | workflow-scene.yaml | 任务流程编排 |
| A2UI场景 | a2ui-scene.yaml | AI界面生成 |
| 个人场景组 | personal-nexus-group.yaml | 个人节点协作组 |
| 企业场景组 | enterprise-nexus-group.yaml | 企业节点协作组 |

---

## 4. 快速开始

### 4.1 环境要求

- **操作系统**：Windows / Linux / macOS / OpenWrt
- **Java**：JDK 8 或更高（OpenWrt 除外）
- **内存**：最低 64MB，推荐 128MB+
- **存储**：最低 100MB，推荐 256MB+

### 4.2 安装方式

#### 方式一：Windows 安装

```bash
# 1. 下载 Windows 安装包
# GitHub: https://github.com/oodercn/super-Agent/releases
# Gitee（国内镜像）: https://gitee.com/ooderCN/ooder-agent/releases

# 2. 解压到任意目录

# 3. 双击运行 start.bat
```

访问：`http://localhost:8081/console/index.html`

#### 方式二：通用安装（Linux/macOS）

```bash
# 1. 下载安装包
wget https://github.com/oodercn/super-Agent/releases/download/v2.2.0/ooder-nexus-2.2.0.tar.gz

# 2. 解压
tar -xzf ooder-nexus-2.2.0.tar.gz
cd ooder-nexus-2.2.0

# 3. 启动
./bin/start.sh
```

访问：`http://localhost:8091/console/index.html`

#### 方式三：OpenWrt 一键安装

```bash
# 在路由器上执行
wget -O /tmp/install.sh https://github.com/oodercn/super-Agent/releases/download/v2.2.0/install-openwrt.sh
chmod +x /tmp/install.sh
/tmp/install.sh
```

访问：`http://路由器IP:8091/console/index.html`

#### 方式四：Docker 安装

```bash
docker run -d \
  --name ooder-nexus \
  -p 8091:8091 \
  -p 9876:9876 \
  -v ./data:/app/data \
  oodercn/ooder-nexus:2.2.0
```

#### 方式五：源码构建

```bash
# 克隆仓库
git clone https://github.com/oodercn/super-Agent.git
cd super-Agent/nexus

# 构建
mvn clean package -DskipTests

# 运行
java -jar target/independent-nexus-2.2.jar
```

### 4.3 配置说明

#### Mock 模式开关

```yaml
# config/application.yml
mock:
  enabled: false  # true: 模拟数据模式（无需真实设备）
                  # false: 真实设备模式（连接真实 OpenWrt）
```

#### 常用配置

```yaml
server:
  port: 8081  # Web 服务端口

ooder:
  agent:
    id: "mcp-agent-001"     # Agent ID
    name: "Nexus Agent"      # Agent 名称
    type: "mcp"              # Agent 类型: mcp/routeAgent/nexus
  udp:
    port: 9876               # UDP 通信端口
    host: 0.0.0.0            # 监听地址
```

---

## 5. 使用指南

### 5.1 Web 控制台

#### 界面布局

```
┌─────────────────────────────────────────────────────┐
│  Logo    搜索                    通知  用户  设置   │
├────────┬────────────────────────────────────────────┤
│        │                                            │
│  菜单   │              主内容区                      │
│        │                                            │
│  我的能力│                                            │
│  ├文档  │                                            │
│  ├能力包│                                            │
│  ├网络  │                                            │
│  ├安全  │                                            │
│  ├设备  │                                            │
│  └群组  │                                            │
│        │                                            │
│  协同协作│                                            │
│  ├消息  │                                            │
│  ├联系人│                                            │
│  ├场景  │                                            │
│  └文件  │                                            │
│        │                                            │
│  系统配置│                                            │
│  ├约束  │                                            │
│  ├协作  │                                            │
│  ├健康  │                                            │
│  └审计  │                                            │
│        │                                            │
│  资源管理│                                            │
│  ├能力  │                                            │
│  ├LLM   │                                            │
│  └存储  │                                            │
│        │                                            │
└────────┴────────────────────────────────────────────┘
```

### 5.2 典型操作

#### 安装技能

1. 进入「资源管理」→「能力中心」
2. 浏览或搜索需要的技能
3. 点击「安装」按钮
4. 查看安装预览（权限、依赖）
5. 确认权限后点击「确认安装」
6. 安装完成后在「我的能力包」中查看

#### 管理技能授权

1. 进入「我的能力」→「我的能力包」
2. 查看已安装技能列表
3. 点击技能查看详细授权信息
4. 可撤销特定权限或卸载技能

#### 查看协作关系

1. 进入「系统配置」→「协作关系」
2. 查看场景-群组-技能关系树
3. 点击节点查看关联详情
4. 可添加或删除关联关系

#### 审计日志查询

1. 进入「系统配置」→「审计日志」
2. 设置查询条件（时间、类型、模块）
3. 点击「查询」获取日志列表
4. 点击日志条目查看详细信息

---

## 6. API 文档

### 6.1 我的能力 API

```http
# 获取仪表盘统计
GET /api/personal/dashboard/stats

# 获取已安装技能列表
GET /api/skill/installed/list

# 技能安装预览
GET /api/skill/install/preview/{skillId}

# 确认安装技能
POST /api/skill/install/confirm
Content-Type: application/json
{
  "skillId": "skill-001",
  "acceptedPermissions": ["resource.read", "network.access"],
  "acceptedScenes": ["scene-001"]
}

# 执行技能
POST /api/personal/execution/execute/{skillId}

# 文件版本管理
GET /api/storage/version/list/{fileId}
POST /api/storage/version/archive/{versionId}
POST /api/storage/version/restore/{versionId}
```

### 6.2 协同协作 API

```http
# 获取协作关系树
GET /api/collaboration/tree

# 获取场景关联
GET /api/collaboration/scene/{sceneId}/relations

# 获取群组关联
GET /api/collaboration/group/{groupId}/relations
```

### 6.3 系统配置 API

```http
# 审计日志查询
GET /api/audit/logs?startDate=2026-02-01&endDate=2026-02-22&type=SKILL_EXECUTION

# 审计日志统计
GET /api/audit/stats?groupBy=type

# 健康检查
GET /api/health/check
```

### 6.4 网络管理 API

```http
# 获取节点列表
GET /api/network/nodes

# 发现网络
POST /api/network/discovery
```

### 6.5 OpenWrt API

```http
# 获取系统状态
GET /api/openwrt/status

# 执行命令
POST /api/openwrt/command
Content-Type: application/json
{
  "command": "uptime"
}
```

---

## 7. 数据存储

### 7.1 VFS 目录结构

```
storage/                          # 主存储目录
├── agents/                       # Agent 节点信息
├── devices/                      # 设备资产管理
├── network/                      # 网络配置数据
│   ├── ip-allocations.json      # IP 地址分配记录
│   ├── ip-pool.json             # IP 地址池配置
│   └── traffic-stats.json       # 流量统计信息
├── sdk/                          # Ooder SDK 核心数据
│   ├── capabilities/            # 能力定义
│   ├── devices/                 # 设备实例数据
│   ├── endagents/               # 终端代理详情
│   ├── routes/                  # 路由配置
│   └── system_status/           # 系统状态
├── sync/                         # 同步任务数据
├── tasks/                        # 数据提取任务
└── data/                         # VFS 文件存储
    └── cache/                    # 哈希文件缓存
```

### 7.2 VFS 存储特点

| 特点 | 说明 |
|------|------|
| **哈希去重** | 文件内容使用 MD5 哈希作为唯一标识，相同内容只存储一份 |
| **写时复制** | 文件修改时创建新版本，不覆盖原文件 |
| **原子操作** | 使用临时文件 + 重命名机制，防止数据损坏 |
| **内存缓存** | 热点文件缓存到内存，减少磁盘 I/O |

### 7.3 数据备份

```bash
# 备份所有数据
tar -czpf ooder-nexus-backup-$(date +%Y%m%d).tar.gz storage/ config/

# 恢复数据
tar -xzpf ooder-nexus-backup-20260222.tar.gz
```

---

## 8. OpenWrt 集成

### 8.1 自动角色设置

当 ooderNexus 部署在 OpenWrt 设备上时，系统会**自动将 Agent 角色设置为 `routeAgent`**：

```
启动日志示例：
[INFO] 检测到 OpenWrt 系统: /etc/openwrt_release 文件存在
[INFO] OpenWrt 系统检测到，自动将 Agent 角色设置为 'routeAgent'
```

### 8.2 OpenWrt 管理功能

- **系统监控**：CPU、内存、温度、运行时间
- **网络配置**：接口管理、DHCP、防火墙
- **IP 管理**：静态 IP 分配、DHCP 租约
- **访问控制**：黑白名单、MAC 过滤
- **命令执行**：Web 界面执行 Shell 命令

---

## 9. 版本历史

### v2.2.0 - 2026-02-22

- 完善功能模块：新增网络管理、协议管理、Nexus管理、任务管理、管理后台、安全管理模块
- 新增个人中心模块：个人仪表盘、我的分享、身份管理、执行记录、帮助中心
- 新增管理后台功能：管理仪表盘、技能审核、用户管理、存储管理、远程管理
- 新增安全管理功能：防火墙、访问控制
- 新增协议管理功能：协作协议、发现协议、登录协议、观察协议、域管理协议
- 更新功能架构图，完整展示12大功能模块
- 更新核心依赖版本

### v2.0.0 - 2026-02-20

- 功能架构重构：我的能力、协同协作、系统配置、资源管理四大模块
- 技能授权管理：安装预览、权限确认、依赖解析
- 审计日志系统：AOP 自动记录、日志查询、统计分析
- 协作关系管理：关系树展示、关联查询
- VFS 文件版本扩展：版本管理、元数据
- OpenWrt 集成：路由器发现、SSH管理、状态监控

---

## 10. 常见问题

### Q1: ooderNexus 和 Ooder Agent SDK 的关系？

**A**: ooderNexus 是 Ooder Agent SDK 的完整应用实现。SDK 提供底层 P2P 网络通信能力，ooderNexus 在此基础上构建完整的 Web 控制台和业务功能。

### Q2: 支持哪些 Agent 角色？

**A**: 支持三种角色：
- **MCP Agent**：主控节点，适合服务器部署
- **Route Agent**：路由节点，适合路由器/网关部署
- **End Agent**：终端节点，适合边缘设备部署

### Q3: 如何备份数据？

**A**: 备份 `storage/` 目录即可，包含所有业务数据和 VFS 文件。

### Q4: 是否必须运行在 OpenWrt 上？

**A**: 不是。ooderNexus 支持 Windows、Linux、macOS 等多种平台。OpenWrt 只是其中一个典型部署场景。

---

## 11. 社区与支持

### 获取帮助

- 📖 **文档**：https://github.com/oodercn/super-Agent/wiki
- 🐛 **Issue**：https://github.com/oodercn/super-Agent/issues
- 💬 **讨论**：https://github.com/oodercn/super-Agent/discussions

### 国内镜像

- 🪞 **Gitee 仓库**：https://gitee.com/ooderCN/ooder-agent
- 📥 **Gitee Releases**：https://gitee.com/ooderCN/ooder-agent/releases

### 许可证

本项目采用 MIT 开源许可证 - 详见 [LICENSE](LICENSE) 文件

---

## 12. 致谢

- [Ooder Agent SDK](https://github.com/oodercn/super-Agent) - 底层 P2P 网络通信框架
- [Spring Boot](https://spring.io/projects/spring-boot) - 后端开发框架
- [OpenWrt](https://openwrt.org/) - 开源路由器操作系统

---

<p align="center">
  <b>ooderNexus - 让 AI 能力无处不在</b><br>
  Made with ❤️ by ooder Team
</p>
