# Ooder Agent SDK 协议演变历史

> 本文档记录了从0.6.0到0.7.3版本的协议演变历史，作为协议整合的基础参考。

## 文档信息

- 版本：v0.7.3
- 创建日期：2026-02-20
- 状态：已更新

---

## 一、版本概览

| 版本 | 发布代号 | 核心特性 | 协议文档数量 |
|------|----------|----------|--------------|
| 0.6.0 | - | 基础Skill协议 | 10 |
| 0.6.2 | - | 协议优化 | 10 |
| 0.6.3 | - | SDK集成 | 12 |
| 0.6.5 | Nexus | P2P网络协议 | 13 |
| 0.7.0 | - | 技能闭环设计 | 6 |
| 0.7.2 | - | 场景组管理增强 | 8 |
| 0.7.3 | - | 场景管理全面升级 | 12 |

---

## 二、各版本协议结构

### 2.1 v0.7.0 协议结构（技能闭环）

```
protocol-release/v0.7.0/
├── agent/
│   ├── agent-protocol.md          # 更新：广域网优化
│   └── scene-group-protocol.md    # 新增：场景组协议
├── ai-bridge/
│   └── ai-bridge-protocol.md
├── main/
│   └── protocol-main.md
├── p2p/
│   ├── p2p-protocol.md
│   └── sdk-p2p-wan-solution.md    # 新增：广域网解决方案
└── skill/
    ├── scene-definition-spec.md   # 新增：场景定义规范
    ├── skill-discovery-protocol.md  # 新增：技能发现协议
    ├── skill-manifest-spec.md       # 新增：技能清单规范
    └── skill-package-protocol.md    # 新增：技能包协议
```

### 2.2 v0.7.3 协议结构（场景管理全面升级）

```
protocol-release/v0.7.3/
├── agent/
│   ├── agent-protocol.md          # 更新：新增发现/认证/协作/离线/事件总线
│   └── scene-group-protocol.md    # 更新：新增任务协作/状态同步/离线支持
├── ai-bridge/
│   └── ai-bridge-protocol.md      # 更新：新增离线支持/事件管理
├── main/
│   └── protocol-main.md           # 更新：新增云托管/驱动代理包/验证工具链
├── p2p/
│   └── p2p-protocol.md            # 更新：新增DiscoveryProtocol/LoginProtocol等
├── skill/
│   ├── skill-discovery-protocol.md  # 更新：新增GitHub/Gitee发现/离线发现
│   └── skill-package-protocol.md    # 更新：新增驱动代理包/验证工具链
└── cloud-hosting/
    └── cloud-hosting-protocol.md    # 新增：云托管协议
```

---

## 三、v0.7.3 新增特性

### 3.1 新增协议

| 协议 | 说明 |
|------|------|
| **DiscoveryProtocol** | 多路节点发现协议（UDP/DHT/SkillCenter/mDNS/GitHub/Gitee） |
| **LoginProtocol** | 本地认证协议，支持离线认证和会话管理 |
| **CollaborationProtocol** | 场景组协作协议，支持任务分配和状态同步 |
| **OfflineService** | 离线服务，支持网络断开时的场景运行和数据同步 |
| **EventBus** | 事件总线，统一事件管理和模块解耦 |
| **CloudHostingProtocol** | 云托管协议，支持 Kubernetes 集群部署和自动扩缩容 |

### 3.2 驱动代理包支持

| 组件 | 说明 |
|------|------|
| **SkillInfo.InterfaceLocation** | 接口文件位置信息 |
| **DriverLoader** | 驱动加载器，加载和缓存驱动代理包 |
| **InterfaceParser** | 接口解析器，解析 YAML/JSON 接口定义文件 |
| **ProxyFactory** | 代理工厂，创建远程调用代理和降级实现 |
| **FallbackHandler** | 降级处理器，处理离线降级实现 |

### 3.3 验证与开发工具链

| 工具 | 说明 |
|------|------|
| **SceneValidator** | 场景验证器，支持四层验证机制 |
| **TestRunner** | 测试运行器，支持单元/集成/系统测试 |
| **CodeGenerator** | 代码生成器，生成 Driver/Skill/Fallback 代码 |
| **SceneCli** | 命令行工具，提供 init/generate/validate/test 命令 |

---

## 四、协议演变详情

### 4.1 Skill协议演变

| 版本 | 变更内容 | 影响 |
|------|----------|------|
| 0.6.0 | 基础Skill协议定义 | 定义Skill-Capability关系、注册接口、执行接口 |
| 0.6.2 | 协议优化 | 格式规范化、接口完善 |
| 0.6.5 | 无重大变更 | 保持兼容 |
| 0.7.0 | 技能闭环设计 | 新增发现协议、包协议、清单规范 |
| 0.7.3 | 驱动代理包支持 | 新增接口定义、动态代理、离线降级 |

### 4.2 Agent协议演变

| 版本 | 变更内容 | 影响 |
|------|----------|------|
| 0.6.0 | 基础Agent协议 | 定义MCP/Route/End三层架构 |
| 0.6.5 | 无重大变更 | 保持兼容 |
| 0.7.0 | 广域网优化 | 增强安全认证、支持跨网络通信 |
| 0.7.3 | 场景管理升级 | 新增发现/认证/协作/离线/事件总线 |

### 4.3 P2P协议演变

| 版本 | 变更内容 | 影响 |
|------|----------|------|
| 0.6.5 | P2P网络协议 | 去中心化网络通信 |
| 0.7.0 | 广域网解决方案 | NAT穿透、安全认证 |
| 0.7.3 | 多路发现协议 | UDP/DHT/SkillCenter/mDNS/GitHub/Gitee |

### 4.4 新增协议

| 版本 | 新增协议 | 用途 |
|------|----------|------|
| 0.6.3 | SDK使用指南 | SDK集成说明 |
| 0.6.5 | P2P协议 | 去中心化网络通信 |
| 0.7.0 | 技能发现协议 | 零配置技能发现 |
| 0.7.0 | 技能包协议 | 技能打包和分发 |
| 0.7.0 | 技能清单规范 | skill.yaml定义 |
| 0.7.0 | 场景组协议 | PRIMARY/BACKUP角色 |
| 0.7.3 | 云托管协议 | Kubernetes集成 |
| 0.7.3 | 离线服务协议 | 离线运行和数据同步 |
| 0.7.3 | 事件总线协议 | 统一事件管理 |

---

## 五、协议内容对比

### 5.1 Skill注册接口对比

**v0.6.0:**
```json
{
  "skill_id": "string",
  "name": "string",
  "description": "string",
  "version": "string",
  "endpoints": [...],
  "capabilities": [...]
}
```

**v0.7.0:**
```
SKILL_REGISTER:{agentId};{skillId};{version};{skillType};{endpoint};{capabilities};{scenes};{timestamp};{signature}
```

**v0.7.3:**
```
SKILL_REGISTER:{agentId};{skillId};{version};{skillType};{endpoint};{capabilities};{scenes};{timestamp};{signature}
```

**变化：**
1. 新增agentId字段
2. 新增skillType字段
3. 新增scenes字段
4. 新增timestamp和signature字段（安全增强）
5. v0.7.3新增离线模式支持

### 5.2 Agent类型对比

| 版本 | Agent类型 | 描述 |
|------|-----------|------|
| 0.6.0 | MCP/Route/End | 三层架构定义 |
| 0.6.5 | MCP/Route/End + P2P节点 | 新增P2P角色 |
| 0.7.0 | MCP/Route/End + 场景组角色 | 新增PRIMARY/BACKUP角色 |
| 0.7.3 | MCP/Route/End + 场景组角色 + 离线支持 | 新增离线模式、任务协作 |

### 5.3 技能发现方式对比

| 版本 | 发现方式 | 说明 |
|------|----------|------|
| 0.6.0 | 注册中心 | 集中式注册发现 |
| 0.6.5 | P2P广播 | 去中心化发现 |
| 0.7.0 | 多协议发现 | UDP/DHT/SkillCenter/mDNS/本地 |
| 0.7.3 | 多协议发现 + Git仓库 | 新增GitHub/Gitee仓库发现、离线发现 |

---

## 六、版本历史

| 版本 | 日期 | 变更说明 |
|------|------|----------|
| v0.1 | 2026-02-15 | 初始版本，记录协议演变历史 |
| v0.7.3 | 2026-02-20 | 更新v0.7.3版本协议结构和新增特性 |
