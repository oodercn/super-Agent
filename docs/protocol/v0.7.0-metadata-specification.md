# Ooder Agent SDK 0.7.0 元数据规范

> 本文档定义了Ooder Agent SDK 0.7.0版本的所有元数据字段，包括字段定义、验证规则和默认值。

## 文档信息

- 版本：v0.7.0
- 创建日期：2026-02-15
- 状态：定义中

---

## 一、skill.yaml 元数据规范

### 1.1 根结构

| 字段 | 类型 | 必需 | 默认值 | 描述 |
|------|------|------|--------|------|
| apiVersion | string | 是 | - | API版本，固定为 skill.ooder.net/v1 |
| kind | string | 是 | - | 资源类型，固定为 Skill |
| metadata | object | 是 | - | 元数据部分 |
| spec | object | 是 | - | 规格部分 |

### 1.2 metadata 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| id | string | 是 | - | `^skill-[a-z0-9-]+$`，最大64字符 | 技能唯一标识 |
| name | string | 是 | - | 最大128字符，非空 | 技能名称 |
| version | string | 是 | - | 语义化版本 `^\d+\.\d+\.\d+$` | 技能版本 |
| description | string | 是 | - | 最大500字符 | 技能描述 |
| author | string | 否 | "" | 最大128字符 | 作者或团队名称 |
| license | string | 否 | "Apache-2.0" | SPDX许可证标识 | 许可证类型 |
| homepage | string | 否 | "" | URL格式 | 项目主页URL |
| repository | string | 否 | "" | URL格式 | 源代码仓库URL |
| documentation | string | 否 | "" | URL格式 | 文档URL |
| icon | string | 否 | "" | URL格式，SVG或PNG | 图标URL |
| keywords | array | 否 | [] | 数组元素为string，最大10个 | 搜索关键词 |
| maintainers | array | 否 | [] | 数组元素为object | 维护者列表 |

### 1.3 metadata.maintainers 元素

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| name | string | 是 | - | 最大64字符 | 维护者名称 |
| email | string | 否 | "" | 邮箱格式 | 维护者邮箱 |
| github | string | 否 | "" | GitHub用户名格式 | GitHub账号 |

### 1.4 spec 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| type | string | 是 | - | 枚举值 | 技能类型 |
| runtime | object | 是 | - | - | 运行时配置 |
| capabilities | array | 是 | - | 至少1个元素 | 能力列表 |
| scenes | object | 否 | {} | - | 场景配置 |
| dependencies | object | 否 | {} | - | 依赖配置 |
| config | object | 否 | {} | - | 配置需求 |
| endpoints | array | 否 | [] | - | API端点列表 |
| resources | object | 否 | {} | - | 资源需求 |
| deployment | object | 否 | {} | - | 部署配置 |

### 1.5 spec.type 枚举值

| 值 | 描述 | 单例 |
|----|------|------|
| enterprise-skill | 企业级能力 | 是 |
| tool-skill | 通用工具 | 否 |

### 1.6 spec.runtime 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| language | string | 是 | - | 枚举值 | 编程语言 |
| javaVersion | string | 否 | "8" | 枚举值 | Java版本 |
| framework | string | 否 | "" | - | 框架名称 |
| mainClass | string | 否 | "" | Java类名格式 | 主类名 |

### 1.7 spec.runtime.language 枚举值

| 值 | 描述 |
|----|------|
| java | Java语言 |
| bash | Bash脚本 |
| python | Python语言 |
| nodejs | Node.js |

### 1.8 spec.capabilities 元素

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| id | string | 是 | - | `^[a-z0-9-]+$`，最大64字符 | 能力ID |
| name | string | 是 | - | 最大128字符 | 能力名称 |
| description | string | 是 | - | 最大500字符 | 能力描述 |
| category | string | 否 | "general" | 最大64字符 | 能力分类 |
| version | string | 否 | "1.0" | 语义化版本 | 能力版本 |
| parameters | array | 否 | [] | - | 输入参数 |
| returns | object | 否 | {} | - | 返回值定义 |
| errors | array | 否 | [] | - | 错误定义 |
| permissions | array | 否 | [] | 字符串数组 | 所需权限 |
| rate | object | 否 | {} | - | 速率限制 |

### 1.9 spec.capabilities[].parameters 元素

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| name | string | 是 | - | 最大64字符 | 参数名称 |
| type | string | 是 | - | 类型枚举 | 参数类型 |
| required | boolean | 否 | false | - | 是否必需 |
| description | string | 否 | "" | 最大256字符 | 参数描述 |
| default | any | 否 | null | - | 默认值 |
| schema | object | 否 | {} | JSON Schema | 参数Schema |

### 1.10 spec.capabilities[].parameters[].type 枚举值

| 值 | 描述 |
|----|------|
| string | 字符串 |
| number | 数字 |
| integer | 整数 |
| boolean | 布尔值 |
| object | 对象 |
| array | 数组 |

### 1.11 spec.scenes 字段

| 字段 | 类型 | 必需 | 默认值 | 描述 |
|------|------|------|--------|------|
| primary | object | 否 | null | 主场景配置 |
| collaborative | array | 否 | [] | 协作场景列表 |

### 1.12 spec.scenes.primary 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| name | string | 是 | - | 场景名称格式 | 场景名称 |
| role | string | 是 | - | 枚举: provider, consumer | 角色 |
| capabilities | array | 否 | [] | 字符串数组 | 提供的能力 |

### 1.13 spec.scenes.collaborative[] 元素

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| name | string | 是 | - | 场景名称格式 | 场景名称 |
| role | string | 是 | - | 枚举: consumer | 角色 |
| required | boolean | 否 | true | - | 是否必需 |
| capabilities | array | 是 | - | 字符串数组，至少1个 | 需要的能力 |
| fallback | object | 否 | {} | - | 降级策略 |

### 1.14 spec.scenes.collaborative[].fallback 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| action | string | 否 | "fail" | 枚举: install, skip, fail | 降级动作 |
| prefer | string | 否 | "" | 技能ID格式 | 优先安装的技能 |
| message | string | 否 | "" | 最大256字符 | 提示信息 |

---

## 二、identity.yaml 元数据规范

### 2.1 根结构

| 字段 | 类型 | 必需 | 默认值 | 描述 |
|------|------|------|--------|------|
| apiVersion | string | 是 | - | API版本 |
| kind | string | 是 | - | 资源类型，固定为 SkillIdentity |
| metadata | object | 是 | - | 元数据部分 |
| source | object | 是 | - | 来源信息 |
| installation | object | 是 | - | 安装信息 |
| signature | object | 是 | - | 签名信息 |
| runtime | object | 否 | {} | 运行时信息 |

### 2.2 metadata 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| skillId | string | 是 | - | 技能ID格式 | 技能唯一标识 |
| version | string | 是 | - | 语义化版本 | 技能版本 |
| checksum | string | 是 | - | SHA256格式 | 技能包校验和 |

### 2.3 source 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| type | string | 是 | - | 枚举: skillcenter, p2p, local | 来源类型 |
| url | string | 是 | - | URL格式 | 来源地址 |
| downloadedAt | string | 是 | - | ISO 8601日期时间 | 下载时间 |
| nodeId | string | 否 | "" | - | P2P节点ID |
| nodePublicKey | string | 否 | "" | - | P2P节点公钥 |
| dhtKey | string | 否 | "" | - | DHT索引键 |

### 2.4 installation 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| installedAt | string | 是 | - | ISO 8601日期时间 | 安装时间 |
| installedBy | string | 是 | - | 最大128字符 | 安装者 |
| installPath | string | 是 | - | 文件路径格式 | 安装路径 |
| port | integer | 是 | - | 1024-65535 | 分配端口 |

### 2.5 signature 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| algorithm | string | 是 | - | 枚举: RS256, Ed25519 | 签名算法 |
| value | string | 是 | - | Base64格式 | 签名值 |
| certificate | string | 否 | "" | PEM格式 | 证书链 |

### 2.6 runtime 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| status | string | 否 | "stopped" | 枚举: running, stopped, error | 运行状态 |
| startedAt | string | 否 | "" | ISO 8601日期时间 | 启动时间 |
| lastHeartbeat | string | 否 | "" | ISO 8601日期时间 | 最后心跳 |
| resourceUsage | object | 否 | {} | - | 资源使用 |

---

## 三、config/config.yaml 元数据规范

### 3.1 根结构

| 字段 | 类型 | 必需 | 默认值 | 描述 |
|------|------|------|--------|------|
| apiVersion | string | 是 | - | API版本 |
| kind | string | 是 | - | 资源类型，固定为 SkillConfig |
| metadata | object | 是 | - | 元数据部分 |
| spec | object | 是 | - | 规格部分 |

### 3.2 spec 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| runtime | object | 否 | {} | - | 运行时配置 |
| resources | object | 否 | {} | - | 资源限制 |
| logging | object | 否 | {} | - | 日志配置 |
| network | object | 否 | {} | - | 网络配置 |
| features | object | 否 | {} | - | 功能开关 |
| dependencies | array | 否 | [] | - | 依赖服务 |

### 3.3 spec.runtime 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| port | integer | 否 | 8080 | 1024-65535 | 运行端口 |
| host | string | 否 | "0.0.0.0" | IP地址格式 | 绑定地址 |
| debug | boolean | 否 | false | - | 调试模式 |

### 3.4 spec.resources 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| cpu | string | 否 | "500m" | Kubernetes资源格式 | CPU限制 |
| memory | string | 否 | "256Mi" | Kubernetes资源格式 | 内存限制 |
| storage | string | 否 | "1Gi" | Kubernetes资源格式 | 存储限制 |

### 3.5 spec.logging 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| level | string | 否 | "INFO" | 枚举: DEBUG, INFO, WARN, ERROR | 日志级别 |
| path | string | 否 | "./logs" | 文件路径格式 | 日志路径 |

### 3.6 spec.network 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| timeout | integer | 否 | 30000 | 正整数，毫秒 | 超时时间 |
| retry | integer | 否 | 3 | 0-10 | 重试次数 |

---

## 四、vfs/vfs.yaml 元数据规范

### 4.1 根结构

| 字段 | 类型 | 必需 | 默认值 | 描述 |
|------|------|------|--------|------|
| apiVersion | string | 是 | - | API版本 |
| kind | string | 是 | - | 资源类型，固定为 VFSConfig |
| metadata | object | 是 | - | 元数据部分 |
| spec | object | 是 | - | 规格部分 |

### 4.2 spec 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| root | string | 是 | - | 文件路径格式 | VFS根目录 |
| volumes | array | 否 | [] | - | 卷定义列表 |
| permissions | object | 否 | {} | - | 权限控制 |
| encryption | object | 否 | {} | - | 加密配置 |

### 4.3 spec.volumes[] 元素

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| name | string | 是 | - | 最大64字符 | 卷名称 |
| path | string | 是 | - | 文件路径格式 | 卷路径 |
| type | string | 是 | - | 枚举: persistent, ephemeral, readonly | 卷类型 |
| size | string | 否 | "100Mi" | Kubernetes资源格式 | 卷大小 |

### 4.4 spec.permissions 字段

| 字段 | 类型 | 必需 | 默认值 | 描述 |
|------|------|------|--------|------|
| {volumeName} | object | 否 | - | 每个卷的权限配置 |

### 4.5 spec.permissions.{volumeName} 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| read | array | 否 | [] | 角色数组 | 读取权限角色 |
| write | array | 否 | [] | 角色数组 | 写入权限角色 |

### 4.6 spec.encryption 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| enabled | boolean | 否 | false | - | 是否启用加密 |
| algorithm | string | 否 | "AES-256-GCM" | 枚举: AES-256-GCM, AES-128-GCM | 加密算法 |
| keyFile | string | 否 | "" | 文件路径格式 | 密钥文件路径 |

---

## 五、auth/auth.yaml 元数据规范

### 5.1 根结构

| 字段 | 类型 | 必需 | 默认值 | 描述 |
|------|------|------|--------|------|
| apiVersion | string | 是 | - | API版本 |
| kind | string | 是 | - | 资源类型，固定为 AuthConfig |
| metadata | object | 是 | - | 元数据部分 |
| spec | object | 是 | - | 规格部分 |

### 5.2 spec 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| mode | string | 是 | - | 枚举: oauth2, api-key, basic, certificate, custom, none | 认证模式 |
| oauth2 | object | 否 | null | - | OAuth2配置 |
| apiKey | object | 否 | null | - | API Key配置 |
| basic | object | 否 | null | - | Basic认证配置 |
| certificate | object | 否 | null | - | 证书认证配置 |
| custom | object | 否 | null | - | 自定义认证配置 |
| tokenStorage | object | 否 | {} | - | Token存储配置 |
| keyManagement | object | 否 | {} | - | 密钥管理配置 |
| security | object | 否 | {} | - | 安全配置 |

### 5.3 spec.oauth2 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| clientId | string | 是 | - | 最大128字符 | 客户端ID |
| clientSecret | string | 是 | - | 最大256字符 | 客户端密钥 |
| authUrl | string | 是 | - | URL格式 | 授权URL |
| tokenUrl | string | 是 | - | URL格式 | Token URL |
| scopes | array | 否 | [] | 字符串数组 | 授权范围 |

### 5.4 spec.apiKey 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| key | string | 是 | - | 最大256字符 | API密钥 |
| header | string | 否 | "X-API-Key" | 最大64字符 | Header名称 |

### 5.5 spec.tokenStorage 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| type | string | 否 | "file" | 枚举: file, memory, encrypted | 存储类型 |
| path | string | 否 | "./auth/tokens/" | 文件路径格式 | 存储路径 |
| encrypt | boolean | 否 | true | - | 是否加密存储 |

### 5.6 spec.security 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| tokenExpiry | integer | 否 | 7200 | 正整数，秒 | Token过期时间 |
| refreshTokenExpiry | integer | 否 | 2592000 | 正整数，秒 | 刷新Token过期 |
| maxRetry | integer | 否 | 3 | 0-10 | 最大重试次数 |

---

## 六、scene.yaml 元数据规范

### 6.1 根结构

| 字段 | 类型 | 必需 | 默认值 | 描述 |
|------|------|------|--------|------|
| apiVersion | string | 是 | - | API版本 |
| kind | string | 是 | - | 资源类型，固定为 SceneDefinition |
| metadata | object | 是 | - | 元数据部分 |
| spec | object | 是 | - | 规格部分 |

### 6.2 metadata 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| name | string | 是 | - | 场景名称格式 | 场景名称 |
| version | string | 是 | - | 语义化版本 | 场景协议版本 |
| description | string | 是 | - | 最大500字符 | 场景描述 |

### 6.3 spec 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| type | string | 是 | - | 枚举: primary, collaborative | 场景类型 |
| capabilities | array | 是 | - | 至少1个元素 | 能力列表 |
| roles | array | 否 | [] | - | 角色定义 |
| protocols | object | 否 | {} | - | 通信协议 |
| security | object | 否 | {} | - | 安全策略 |

### 6.4 spec.roles[] 元素

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| name | string | 是 | - | 最大64字符 | 角色名称 |
| capabilities | array | 是 | - | 字符串数组 | 角色能力 |

### 6.5 spec.protocols 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| transport | string | 否 | "http" | 枚举: http, websocket, grpc | 传输协议 |
| format | string | 否 | "json" | 枚举: json, protobuf, msgpack | 数据格式 |
| encryption | string | 否 | "tls" | 枚举: tls, mtls, none | 加密方式 |

### 6.6 spec.security 字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| authRequired | boolean | 否 | true | - | 是否需要认证 |
| allowedRoles | array | 否 | [] | 字符串数组 | 允许的角色 |

---

## 七、SceneGroupKey 元数据规范

### 7.1 结构

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| groupId | string | 是 | - | `^scene-[a-z0-9-]+-[a-z0-9]+$` | 场景组唯一标识 |
| sceneName | string | 是 | - | 场景名称格式 | 场景名称 |
| version | integer | 是 | - | 正整数 | KEY版本 |
| masterKey | string | 是 | - | Base64格式，加密存储 | 主密钥 |
| accessKey | string | 是 | - | Base64格式 | 访问密钥 |
| permissions | object | 是 | - | - | 权限定义 |
| members | array | 是 | - | 至少1个元素 | 成员列表 |
| createdAt | string | 是 | - | ISO 8601日期时间 | 创建时间 |
| expiresAt | string | 是 | - | ISO 8601日期时间 | 过期时间 |
| signature | string | 是 | - | Base64格式 | MCP Agent签名 |

### 7.2 permissions 字段

| 字段 | 类型 | 必需 | 默认值 | 描述 |
|------|------|------|--------|------|
| vfs | object | 否 | {} | VFS权限映射 |
| capabilities | object | 否 | {} | 能力权限映射 |

### 7.3 members[] 元素

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| agentId | string | 是 | - | Agent ID格式 | Agent标识 |
| role | string | 是 | - | 枚举: PRIMARY, BACKUP | 角色 |
| publicKey | string | 是 | - | Base64格式 | 公钥 |
| keyShare | string | 是 | - | Base64格式 | 密钥分片 |

---

## 八、验证规则汇总

### 8.1 格式验证

| 格式 | 正则表达式 | 示例 |
|------|------------|------|
| 技能ID | `^skill-[a-z0-9-]+$` | skill-org-feishu |
| 场景名称 | `^[a-z][a-z0-9-]*$` | auth, messaging |
| 语义化版本 | `^\d+\.\d+\.\d+$` | 0.7.0 |
| SHA256 | `^sha256:[a-f0-9]{64}$` | sha256:abc123... |
| Base64 | `^[A-Za-z0-9+/]+=*$` | - |
| ISO 8601 | `^\d{4}-\d{2}-\d{2}T\d{2}:\d{2}:\d{2}Z$` | 2026-02-15T10:00:00Z |
| Kubernetes资源 | `^\d+(m|Ki|Mi|Gi|Ti)?$` | 500m, 256Mi |
| 邮箱 | `^[^@]+@[^@]+\.[^@]+$` | user@example.com |
| URL | `^https?://.+$` | https://example.com |

### 8.2 长度限制

| 字段类型 | 最大长度 | 最小长度 |
|----------|----------|----------|
| 技能ID | 64 | 1 |
| 技能名称 | 128 | 1 |
| 描述 | 500 | 1 |
| 参数名称 | 64 | 1 |
| 角色名称 | 64 | 1 |
| 维护者名称 | 64 | 1 |

### 8.3 数量限制

| 字段类型 | 最大数量 | 最小数量 |
|----------|----------|----------|
| 关键词 | 10 | 0 |
| 维护者 | 10 | 0 |
| 能力 | 无限制 | 1 |
| 参数 | 无限制 | 0 |
| 角色 | 10 | 0 |

---

## 九、四维元数据扩展

### 9.1 四维元数据框架

基于"谁、在哪、什么时间、做什么"四维原则，扩展元数据定义：

| 维度 | 字段名 | 描述 | 适用对象 |
|------|--------|------|----------|
| WHO | who | 标识对象主体 | Skill, Scene, SceneGroup |
| WHERE | where | 标识对象位置 | Skill, Scene, SceneGroup |
| WHEN | when | 标识对象时间线 | Skill, Scene, SceneGroup |
| WHAT | what | 标识对象功能 | Skill, Scene, SceneGroup |

### 9.2 Skill四维元数据

#### 9.2.1 who字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| type | string | 是 | - | 枚举: enterprise-skill, tool-skill | 技能类型 |
| sceneRole.primary | string | 否 | "" | 场景名称格式 | 主场景名称 |
| sceneRole.collaborative | array | 否 | [] | 场景名称数组 | 协作场景列表 |
| provider | string | 否 | "" | 最大128字符 | 技能提供者 |
| author | string | 否 | "" | 最大128字符 | 作者 |

#### 9.2.2 where字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| deployment | string | 否 | "local" | 枚举: local, cloud, edge | 部署位置 |
| endpoint | string | 否 | "" | IP:Port格式 | 服务端点 |
| vfsRoot | string | 否 | "" | 文件路径格式 | VFS根目录 |
| sceneGroupId | string | 否 | "" | 场景组ID格式 | 所属场景组 |
| sceneGroupRole | string | 否 | "" | 枚举: PRIMARY, BACKUP | 场景组角色 |

#### 9.2.3 when字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| discoveredAt | string | 否 | "" | ISO 8601日期时间 | 发现时间 |
| discoveredFrom | string | 否 | "" | URL格式 | 发现来源 |
| installedAt | string | 否 | "" | ISO 8601日期时间 | 安装时间 |
| joinedSceneAt | string | 否 | "" | ISO 8601日期时间 | 加入场景时间 |
| runningSince | string | 否 | "" | ISO 8601日期时间 | 运行开始时间 |
| lastHeartbeat | string | 否 | "" | ISO 8601日期时间 | 最后心跳时间 |

#### 9.2.4 what字段

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| description | string | 是 | - | 最大500字符 | 功能描述 |
| usage | array | 否 | [] | 使用说明数组 | 使用说明 |
| result | object | 否 | {} | 结果统计对象 | 执行结果统计 |
| status | string | 否 | "stopped" | 枚举: running, stopped, error | 运行状态 |

### 9.3 SceneGroup四维元数据

#### 9.3.1 who.members[]扩展

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| sceneRole | string | 否 | "user" | 场景角色名称 | 场景角色 |
| skills | array | 否 | [] | 技能ID数组 | 携带的技能 |
| joinedAt | string | 否 | "" | ISO 8601日期时间 | 加入时间 |

#### 9.3.2 where扩展

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| primaryEndpoint | string | 是 | - | IP:Port格式 | 主节点端点 |
| backupEndpoints | array | 否 | [] | IP:Port数组 | 备节点端点 |
| vfsRoot | string | 否 | "" | 文件路径格式 | VFS根目录 |

#### 9.3.3 when扩展

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| lastModified | string | 否 | "" | ISO 8601日期时间 | 最后修改时间 |
| lastFailover | string | 否 | "" | ISO 8601日期时间 | 最后切换时间 |
| keyExpiresAt | string | 是 | - | ISO 8601日期时间 | KEY过期时间 |

#### 9.3.4 what扩展

| 字段 | 类型 | 必需 | 默认值 | 验证规则 | 描述 |
|------|------|------|--------|----------|------|
| description | string | 否 | "" | 最大500字符 | 场景组描述 |
| capabilities | array | 否 | [] | 能力ID数组 | 可用能力 |
| status | string | 否 | "active" | 枚举: active, inactive, degraded | 状态 |
| healthScore | number | 否 | 1.0 | 0.0-1.0 | 健康分数 |

---

## 十、变更记录规范

### 10.1 变更类型

| 变更类型 | 触发场景 | 影响对象 | 备注 |
|----------|----------|----------|------|
| SKILL_INSTALL | 技能安装 | Skill | 记录安装时间和来源 |
| SKILL_UNINSTALL | 技能卸载 | Skill | 记录卸载原因 |
| SCENE_JOIN | 加入场景 | SceneGroup.members | 记录角色分配 |
| SCENE_LEAVE | 离开场景 | SceneGroup.members | 记录离开原因 |
| ROLE_CHANGE | 角色变更 | SceneGroup.members[].role | 记录变更原因 |
| FAILOVER | 故障切换 | SceneGroup.primary | 记录切换时间 |
| KEY_ROTATE | 密钥轮换 | SceneGroup.masterKey | 记录轮换原因 |
| CAP_ADD | 能力新增 | Scene.capabilities | 记录新增能力 |
| CAP_REMOVE | 能力移除 | Scene.capabilities | 记录移除原因 |

### 10.2 变更记录格式

| 字段 | 类型 | 必需 | 描述 |
|------|------|------|------|
| timestamp | string | 是 | 变更时间（ISO 8601） |
| changeType | string | 是 | 变更类型 |
| objectId | string | 是 | 变更对象ID |
| objectType | string | 是 | 变更对象类型 |
| changes | array | 是 | 变更详情列表 |
| changes[].field | string | 是 | 变更字段 |
| changes[].oldValue | any | 否 | 旧值 |
| changes[].newValue | any | 是 | 新值 |
| reason | string | 是 | 变更原因 |
| operator | string | 是 | 操作者 |
| notes | string | 否 | 备注 |

### 10.3 变更记录示例

```yaml
changeLog:
  - timestamp: "2026-02-15T10:05:00Z"
    changeType: "SKILL_INSTALL"
    objectId: "skill-msg-feishu"
    objectType: "Skill"
    changes:
      - field: "status"
        oldValue: null
        newValue: "installed"
      - field: "installedAt"
        oldValue: null
        newValue: "2026-02-15T10:05:00Z"
    reason: "用户请求安装"
    operator: "user-001"
    notes: "首次安装消息服务技能"
  
  - timestamp: "2026-02-15T10:30:00Z"
    changeType: "FAILOVER"
    objectId: "scene-messaging-001"
    objectType: "SceneGroup"
    changes:
      - field: "members[0].role"
        oldValue: "PRIMARY"
        newValue: "OFFLINE"
      - field: "members[1].role"
        oldValue: "BACKUP"
        newValue: "PRIMARY"
    reason: "Route Agent A硬件故障"
    operator: "mcp-agent"
    notes: "PRIMARY故障，BACKUP自动接管，切换时间30秒"
```

---

## 十一、版本历史

| 版本 | 日期 | 变更说明 |
|------|------|----------|
| v0.1 | 2026-02-15 | 初始版本，定义核心元数据规范 |
| v0.2 | 2026-02-15 | 新增四维元数据扩展和变更记录规范 |
