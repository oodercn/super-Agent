<!DOCTYPE html>
<html>
<head>
    <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
    <meta name="viewport" content="user-scalable=no, initial-scale=1.0, minimum-scale=0.5, maximum-scale=2.0,width=device-width, height=device-height"/>
    <title>ooderAI Architecture Diagram</title>
    <link rel="stylesheet" type="text/css" href="ood/css/default.css"/>
    <link rel="stylesheet" type="text/css" href="ood/appearance/dark/theme.css" id="theme-style"/>
    <link rel="stylesheet" type="text/css" href="ood/css/remixicon/remixicon.css"/>
    <style>
        body {
            margin: 0;
            padding: 20px;
            background-color: #1a1a1a;
            color: #ffffff;
            font-family: Arial, sans-serif;
        }
        #architecture-diagram {
            width: 100%;
            height: 800px;
            border: 1px solid #333;
            background-color: #222;
        }
        .title {
            text-align: center;
            margin-bottom: 20px;
            font-size: 24px;
            font-weight: bold;
            color: #4CAF50;
        }
    </style>
</head>
<body>
    <div class="title">ooderAI Architecture Diagram</div>
    <div id="architecture-diagram"></div>

    <script type="text/javascript" src="ood/js/ood.js"></script>
    <script type="text/javascript" src="conf.js"></script>
    <script type="text/javascript" src="ood/js/Event.js"></script>
    <script type="text/javascript" src="ood/js/Dom.js"></script>
    <script type="text/javascript" src="ood/js/CSS.js"></script>
    <script type="text/javascript" src="ood/js/Module.js"></script>
    <script type="text/javascript" src="ood/js/UI.js"></script>
    <script type="text/javascript" src="ood/js/UI/SVGPaper.js"></script>

    <script type="text/javascript">
        var svgPaper;

        // 绘制架构图
        function drawArchitectureDiagram() {
            // 清空画布
            svgPaper.clear();

            // 定义组件位置和大小
            var components = [
                {
                    id: 'frontend',
                    name: 'ooderUI (前端)',
                    x: 100,
                    y: 100,
                    width: 200,
                    height: 100,
                    color: '#3498db'
                },
                {
                    id: 'skillsA2UI',
                    name: 'skills-a2ui',
                    x: 400,
                    y: 100,
                    width: 200,
                    height: 100,
                    color: '#9b59b6'
                },
                {
                    id: 'agentSDK',
                    name: 'Agent SDK',
                    x: 700,
                    y: 100,
                    width: 200,
                    height: 100,
                    color: '#f39c12'
                },
                {
                    id: 'skillA',
                    name: 'Skill A',
                    x: 400,
                    y: 250,
                    width: 150,
                    height: 80,
                    color: '#e74c3c'
                },
                {
                    id: 'skillB',
                    name: 'Skill B',
                    x: 600,
                    y: 250,
                    width: 150,
                    height: 80,
                    color: '#e74c3c'
                },
                {
                    id: 'skillVFS',
                    name: 'Skill VFS',
                    x: 500,
                    y: 380,
                    width: 150,
                    height: 80,
                    color: '#e74c3c'
                },
                {
                    id: 'vfs',
                    name: 'VFS (虚拟文件系统)',
                    x: 700,
                    y: 380,
                    width: 200,
                    height: 100,
                    color: '#1abc9c'
                }
            ];

            // 绘制组件
            components.forEach(function(component) {
                // 绘制矩形
                svgPaper.rect({
                    x: component.x,
                    y: component.y,
                    width: component.width,
                    height: component.height,
                    fill: component.color,
                    stroke: '#ffffff',
                    strokeWidth: 2,
                    rx: 5,
                    ry: 5
                });

                // 绘制文本
                svgPaper.text({
                    x: component.x + component.width / 2,
                    y: component.y + component.height / 2 + 5,
                    text: component.name,
                    fontSize: 14,
                    fill: '#ffffff',
                    textAlign: 'center'
                });
            });

            // 定义连接线
            var connections = [
                { from: 'frontend', to: 'skillsA2UI' },
                { from: 'skillsA2UI', to: 'agentSDK' },
                { from: 'skillsA2UI', to: 'skillA' },
                { from: 'skillsA2UI', to: 'skillB' },
                { from: 'skillsA2UI', to: 'skillVFS' },
                { from: 'agentSDK', to: 'skillA' },
                { from: 'agentSDK', to: 'skillB' },
                { from: 'skillVFS', to: 'vfs' }
            ];

            // 绘制连接线
            connections.forEach(function(connection) {
                var fromComp = components.find(c => c.id === connection.from);
                var toComp = components.find(c => c.id === connection.to);

                if (fromComp && toComp) {
                    // 计算连接线的起点和终点
                    var fromX = fromComp.x + fromComp.width;
                    var fromY = fromComp.y + fromComp.height / 2;
                    var toX = toComp.x;
                    var toY = toComp.y + toComp.height / 2;

                    // 绘制箭头
                    var arrowSize = 10;
                    var angle = Math.atan2(toY - fromY, toX - fromX);
                    var arrowX = toX - arrowSize * Math.cos(angle);
                    var arrowY = toY - arrowSize * Math.sin(angle);

                    // 绘制直线
                    svgPaper.line({
                        x1: fromX,
                        y1: fromY,
                        x2: toX,
                        y2: toY,
                        stroke: '#ffffff',
                        strokeWidth: 2
                    });

                    // 绘制箭头
                    svgPaper.polygon({
                        points: [
                            toX, toY,
                            arrowX - arrowSize * Math.sin(angle), arrowY + arrowSize * Math.cos(angle),
                            arrowX + arrowSize * Math.sin(angle), arrowY - arrowSize * Math.cos(angle)
                        ],
                        fill: '#ffffff'
                    });
                }
            });

            // 添加标题
            svgPaper.text({
                x: 500,
                y: 50,
                text: 'ooderAI Architecture',
                fontSize: 20,
                fill: '#4CAF50',
                textAlign: 'center',
                fontWeight: 'bold'
            });

            // 添加说明
            svgPaper.text({
                x: 900,
                y: 550,
                text: 'Created with ooderUI SVGPaper',
                fontSize: 12,
                fill: '#999999',
                textAlign: 'right'
            });
        }

        // 当页面加载完成后绘制架构图
        window.onload = function() {
            // 初始化SVG画布
            svgPaper = ood({
                type: 'SVGPaper',
                renderTo: 'architecture-diagram',
                width: '100%',
                height: '100%',
                backgroundColor: '#222222'
            });
            
            // 绘制架构图
            drawArchitectureDiagram();
        };

        // 当窗口大小改变时重新绘制
        window.onresize = function() {
            drawArchitectureDiagram();
        };
    </script>
</body>
</html>